endp
_main		proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '19Ch']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_19C]']
mov ['ecx,', '67h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_75],', '0']
mov ['[ebp+var_84],', '0']
mov ['eax,', '[ebp+argv]']
mov ['ecx,', '[eax]']
mov ['ds:?progname@@3PBDB,', 'ecx']
mov ['ds:dword_310,', 'offset', '??_C@_06DBHEJNGA@common?$AA@']
push ['offset', '_options']
push ['14h']
mov ['eax,', '[ebp+argv]']
push ['eax']
mov ['ecx,', '[ebp+argc]']
push ['ecx']
call ['_u_parseArgs']
add ['esp,', '10h']
mov ['[ebp+argc],', 'eax']
movsx ['eax,', 'ds:byte_332']
test ['eax,', 'eax']
jnz ['short', 'loc_2238']
movsx ['eax,', 'ds:byte_346']
test ['eax,', 'eax']
jz ['short', 'loc_2241']
mov ['[ebp+var_75],', '1']
jmp ['loc_23A9']
movsx ['eax,', '[ebp+var_75]']
test ['eax,', 'eax']
jnz ['short', 'loc_22C5']
cmp ['[ebp+argc],', '0']
jge ['short', 'loc_22C5']
mov ['eax,', '[ebp+argc]']
neg ['eax']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+argv]']
mov ['edx,', '[ecx+eax*4]']
push ['edx']
mov ['eax,', 'ds:?progname@@3PBDB']
push ['eax']
push ['offset', '??_C@_0CJ@POHEAINE@?$CFs?3?5error?5in?5command?5line?5argume@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'ds:?progname@@3PBDB']
push ['eax']
push ['offset', '??_C@_0BL@FGMGBFMF@Run?5?8?$CFs?5?9?9help?8?5for?5help?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2AF2']
movsx ['eax,', 'ds:byte_30A']
test ['eax,', 'eax']
jz ['short', 'loc_22FA']
mov ['esi,', 'esp']
push ['offset', '??_C@_0FF@CKKEEOLA@Warning?3?5You?5are?5using?5the?5?9O?5op@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
movsx ['eax,', 'ds:byte_2F6']
test ['eax,', 'eax']
jnz ['short', 'loc_2369']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CE@OMJFHKKK@?5required?5parameter?5?9p?5is?5missin@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', 'ds:?progname@@3PBDB']
push ['eax']
push ['offset', '??_C@_0BL@FGMGBFMF@Run?5?8?$CFs?5?9?9help?8?5for?5help?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2AF2']
cmp ['[ebp+argc],', '1']
jnz ['short', 'loc_23A9']
mov ['esi,', 'esp']
mov ['eax,', 'ds:?progname@@3PBDB']
push ['eax']
push ['offset', '??_C@_0DF@DJLHBNPA@No?5input?5files?5specified?4?6Run?5?8?$CF@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_2AF2']
cmp ['[ebp+argc],', '0']
jl ['short', 'loc_23BB']
movsx ['eax,', '[ebp+var_75]']
test ['eax,', 'eax']
jz ['loc_266C']
mov ['esi,', 'esp']
mov ['eax,', 'ds:?progname@@3PBDB']
push ['eax']
push ['offset', '??_C@_0ND@JPBMOOEO@usage?3?5?$CFs?5?$FL?9options?$FN?5?$FL?9?$FN?5?$FLpackag@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '??_C@_0M@HLMDKHEP@?6?5options?3?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_90],', '0']
jmp ['short', 'loc_2430']
mov ['eax,', '[ebp+var_90]']
add ['eax,', '1']
mov ['[ebp+var_90],', 'eax']
cmp ['[ebp+var_90],', '14h']
jnb ['loc_251F']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '14h']
cmp ['ds:_options[eax],', '0']
jz ['short', 'loc_2466']
mov ['ecx,', '[ebp+var_90]']
imul ['ecx,', '14h']
mov ['edx,', 'ds:_options[ecx]']
mov ['[ebp+var_194],', 'edx']
jmp ['short', 'loc_2470']
mov ['[ebp+var_194],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '14h']
cmp ['ds:_options[eax],', '0']
jz ['short', 'loc_248E']
mov ['[ebp+var_198],', 'offset', '??_C@_05IEAAHABO@or?5?9?9?$AA@']
jmp ['short', 'loc_2498']
mov ['[ebp+var_198],', 'offset', '??_C@_05IFKLLJBC@?5?5?5?5?5?$AA@']
cmp ['[ebp+var_90],', '1']
jnb ['short', 'loc_24AD']
mov ['[ebp+var_19C],', 'offset', '??_C@_05KEAGPFFC@?$FLREQ?$FN?$AA@']
jmp ['short', 'loc_24B7']
mov ['[ebp+var_19C],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
mov ['ecx,', '[ebp+var_90]']
imul ['ecx,', '140h']
add ['ecx,', 'offset', '_options_help']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_194]']
push ['edx']
mov ['eax,', '[ebp+var_198]']
push ['eax']
mov ['ecx,', '[ebp+var_90]']
imul ['ecx,', '14h']
movsx ['edx,', 'ds:byte_2F4[ecx]']
push ['edx']
mov ['eax,', '[ebp+var_19C]']
push ['eax']
push ['offset', '??_C@_0BG@BPNIFCDI@?$CF?95s?5?9?$CFc?5?$CFs?$CF?910s?5?5?$CFs?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '1Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_2421']
mov ['esi,', 'esp']
push ['offset', '??_C@_0BE@BEGGIDHH@modes?3?5?$CI?9m?5option?$CJ?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_90],', '0']
jmp ['short', 'loc_2564']
mov ['eax,', '[ebp+var_90]']
add ['eax,', '1']
mov ['[ebp+var_90],', 'eax']
cmp ['[ebp+var_90],', '4']
jnb ['loc_2662']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:_modes[eax]']
push ['ecx']
push ['offset', '??_C@_08INOMAIII@?5?5?5?$CF?99s?5?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '0Ch']
cmp ['ds:dword_2B8[eax],', '0']
jz ['short', 'loc_25F9']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:dword_2B8[eax]']
push ['ecx']
push ['offset', '??_C@_06CIBLEPHP@?1?5?$CF?99s?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_2623']
mov ['esi,', 'esp']
push ['offset', '??_C@_0M@CKHGFAEI@?5?5?5?5?5?5?5?5?5?5?5?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_90]']
imul ['eax,', '0Ch']
mov ['esi,', 'esp']
mov ['ecx,', 'ds:off_2BC[eax]']
push ['ecx']
push ['offset', '??_C@_05LDOEBFOB@?5?5?$CFs?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_2555']
mov ['eax,', '1']
jmp ['loc_2AF2']
push ['50h']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset']
add ['esp,', '0Ch']
mov ['eax,', 'ds:dword_310']
mov ['[ebp+var_30],', 'eax']
movsx ['eax,', 'ds:byte_40E']
neg ['eax']
sbb ['eax,', 'eax']
and ['eax,', 'ds:dword_400']
mov ['[ebp+var_2C],', 'eax']
mov ['eax,', 'ds:dword_2E8']
mov ['[ebp+Str],', 'eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_A8],', 'eax']
mov ['eax,', '[ebp+var_A8]']
add ['eax,', '2']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['[ebp+var_B4],', 'eax']
mov ['ecx,', '[ebp+var_B4]']
mov ['[ebp+var_C0],', 'ecx']
mov ['eax,', '[ebp+Str]']
mov ['[ebp+var_CC],', 'eax']
mov ['ecx,', '[ebp+var_CC]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['loc_27C7']
mov ['eax,', '[ebp+var_CC]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
mov ['esi,', 'esp']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__isalpha']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_2720']
mov ['edx,', '[ebp+var_CC]']
mov ['al,', '[edx]']
mov ['byte', 'ptr', '[ebp+var_194+3],', 'al']
jmp ['short', 'loc_2727']
mov ['byte', 'ptr', '[ebp+var_194+3],', '5Fh']
mov ['ecx,', '[ebp+var_C0]']
mov ['dl,', 'byte', 'ptr', '[ebp+var_194+3]']
mov ['[ecx],', 'dl']
mov ['eax,', '[ebp+var_C0]']
add ['eax,', '1']
mov ['[ebp+var_C0],', 'eax']
mov ['eax,', '[ebp+var_CC]']
add ['eax,', '1']
mov ['[ebp+var_CC],', 'eax']
jmp ['short', 'loc_2764']
mov ['eax,', '[ebp+var_CC]']
add ['eax,', '1']
mov ['[ebp+var_CC],', 'eax']
mov ['eax,', '[ebp+var_CC]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_27C7']
mov ['eax,', '[ebp+var_CC]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
mov ['esi,', 'esp']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__isalnum']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_27A1']
mov ['edx,', '[ebp+var_CC]']
mov ['al,', '[edx]']
mov ['byte', 'ptr', '[ebp+var_194+3],', 'al']
jmp ['short', 'loc_27A8']
mov ['byte', 'ptr', '[ebp+var_194+3],', '5Fh']
mov ['ecx,', '[ebp+var_C0]']
mov ['dl,', 'byte', 'ptr', '[ebp+var_194+3]']
mov ['[ecx],', 'dl']
mov ['eax,', '[ebp+var_C0]']
add ['eax,', '1']
mov ['[ebp+var_C0],', 'eax']
jmp ['short', 'loc_2755']
mov ['eax,', '[ebp+var_C0]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['eax,', '[ebp+var_B4]']
mov ['[ebp+var_4C],', 'eax']
movsx ['eax,', 'ds:byte_436']
test ['eax,', 'eax']
jz ['short', 'loc_27EE']
mov ['eax,', 'ds:dword_428']
mov ['[ebp+var_1C],', 'eax']
jmp ['short', 'loc_27F4']
mov ['eax,', '[ebp+Str]']
mov ['[ebp+var_1C],', 'eax']
movsx ['eax,', 'ds:byte_44A']
test ['eax,', 'eax']
jz ['short', 'loc_2805']
mov ['[ebp+var_16],', '1']
jmp ['short', 'loc_2809']
mov ['[ebp+var_16],', '0']
movsx ['eax,', 'ds:byte_472']
test ['eax,', 'eax']
jz ['short', 'loc_2844']
mov ['[ebp+var_14],', '0']
mov ['esi,', 'esp']
push ['offset', '??_C@_0EA@DLAPCBNN@Warning?3?5You?5are?5using?5the?5?9z?5op@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_2848']
mov ['[ebp+var_14],', '0']
mov ['al,', 'ds:byte_35A']
mov ['[ebp+var_17],', 'al']
movsx ['eax,', 'ds:byte_36E']
test ['eax,', 'eax']
jz ['short', 'loc_2864']
mov ['[ebp+var_28],', 'offset', '??_C@_0GD@IBBFEJOD@?5Copyright?5?$CIC?$CJ?52015?0?5Internation@']
jmp ['short', 'loc_2877']
movsx ['eax,', 'ds:byte_382']
test ['eax,', 'eax']
jz ['short', 'loc_2877']
mov ['eax,', 'ds:dword_374']
mov ['[ebp+var_28],', 'eax']
movsx ['eax,', 'ds:byte_396']
test ['eax,', 'eax']
jz ['short', 'loc_288C']
mov ['eax,', 'ds:dword_388']
mov ['[ebp+var_44],', 'eax']
jmp ['short', 'loc_2893']
mov ['[ebp+var_44],', 'offset', '??_C@_01LFCBOECM@?4?$AA@']
mov ['al,', 'ds:byte_3AA']
mov ['[ebp+var_18],', 'al']
movsx ['eax,', 'ds:byte_3BE']
test ['eax,', 'eax']
jz ['short', 'loc_28B0']
mov ['eax,', 'ds:dword_3B0']
mov ['[ebp+var_3C],', 'eax']
jmp ['short', 'loc_28B6']
mov ['eax,', '[ebp+var_44]']
mov ['[ebp+var_3C],', 'eax']
movsx ['eax,', 'ds:byte_3D2']
test ['eax,', 'eax']
jz ['short', 'loc_28CB']
mov ['eax,', 'ds:dword_3C4']
mov ['[ebp+var_24],', 'eax']
jmp ['short', 'loc_28D2']
mov ['[ebp+var_24],', '0']
movsx ['eax,', 'ds:byte_3E6']
test ['eax,', 'eax']
jz ['short', 'loc_28E7']
mov ['eax,', 'ds:dword_3D8']
mov ['[ebp+var_38],', 'eax']
jmp ['short', 'loc_28EE']
mov ['[ebp+var_38],', 'offset', '??_C@_01LFCBOECM@?4?$AA@']
movsx ['eax,', 'ds:byte_3FA']
test ['eax,', 'eax']
jz ['short', 'loc_2903']
mov ['eax,', 'ds:dword_3EC']
mov ['[ebp+var_48],', 'eax']
jmp ['short', 'loc_2909']
mov ['eax,', '[ebp+var_4C]']
mov ['[ebp+var_48],', 'eax']
mov ['[ebp+var_15],', '0']
movsx ['eax,', 'ds:byte_45E']
test ['eax,', 'eax']
jz ['short', 'loc_296C']
mov ['esi,', 'esp']
push ['offset', '??_C@_0GL@ENCJOGLG@Warning?3?5You?5are?5using?5the?5optio@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CH@BIBBALKP@Warning?3?5This?5option?5will?5be?5ign@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_6C],', '0']
mov ['[ebp+var_9C],', '1']
jmp ['short', 'loc_298E']
mov ['eax,', '[ebp+var_9C]']
add ['eax,', '1']
mov ['[ebp+var_9C],', 'eax']
mov ['eax,', '[ebp+var_9C]']
cmp ['eax,', '[ebp+argc]']
jge ['short', 'loc_29C4']
mov ['eax,', '[ebp+var_9C]']
mov ['ecx,', '[ebp+argv]']
mov ['edx,', '[ecx+eax*4]']
push ['edx']
call ['_uprv_strdup_56']
add ['esp,', '4']
push ['eax']
lea ['eax,', '[ebp+var_6C]']
push ['eax']
mov ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['_pkg_appendToList']
add ['esp,', '0Ch']
mov ['[ebp+Dst],', 'eax']
jmp ['short', 'loc_297F']
lea ['eax,', '[ebp+var_84]']
push ['eax']
lea ['ecx,', '[ebp+Dst]']
push ['ecx']
call ['?loadLists@@YAXPAUUPKGOptions_@@PAW4UErrorCode@@@Z']
add ['esp,', '8']
mov ['eax,', '[ebp+var_84]']
push ['eax']
call ['?U_FAILURE@@YACW4UErrorCode@@@Z']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_2A31']
mov ['eax,', '[ebp+var_84]']
push ['eax']
call ['_u_errorName_56']
add ['esp,', '4']
mov ['esi,', 'esp']
push ['eax']
push ['offset', '??_C@_0CE@ICOMKHEM@error?5loading?5input?5file?5lists?3?5@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '2']
jmp ['loc_2AF2']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['?pkg_executeOptions@@YAHPAUUPKGOptions_@@@Z']
add ['esp,', '4']
mov ['[ebp+var_8],', 'eax']
cmp ['ds:_pkgDataFlags,', '0']
jz ['short', 'loc_2AA7']
mov ['[ebp+var_9C],', '0']
jmp ['short', 'loc_2A64']
mov ['eax,', '[ebp+var_9C]']
add ['eax,', '1']
mov ['[ebp+var_9C],', 'eax']
cmp ['[ebp+var_9C],', '11h']
jge ['short', 'loc_2A99']
mov ['eax,', '[ebp+var_9C]']
mov ['ecx,', 'ds:_pkgDataFlags']
cmp ['dword', 'ptr', '[ecx+eax*4],', '0']
jz ['short', 'loc_2A97']
mov ['eax,', '[ebp+var_9C]']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+eax*4]']
push ['edx']
call ['_uprv_free_56']
add ['esp,', '4']
jmp ['short', 'loc_2A55']
mov ['eax,', 'ds:_pkgDataFlags']
push ['eax']
call ['_uprv_free_56']
add ['esp,', '4']
cmp ['[ebp+var_4C],', '0']
jz ['short', 'loc_2AB9']
mov ['eax,', '[ebp+var_4C]']
push ['eax']
call ['_uprv_free_56']
add ['esp,', '4']
cmp ['[ebp+Dst],', '0']
jz ['short', 'loc_2ACB']
mov ['eax,', '[ebp+Dst]']
push ['eax']
call ['_pkg_deleteList']
add ['esp,', '4']
cmp ['[ebp+var_5C],', '0']
jz ['short', 'loc_2ADD']
mov ['eax,', '[ebp+var_5C]']
push ['eax']
call ['_pkg_deleteList']
add ['esp,', '4']
cmp ['[ebp+var_58],', '0']
jz ['short', 'loc_2AEF']
mov ['eax,', '[ebp+var_58]']
push ['eax']
call ['_pkg_deleteList']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN71']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
add ['esp,', '19Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN70']
dd ['offset', '$LN67']
dd ['0FFFFFF94h,', '4']
dd ['offset', '$LN68']
dd ['0FFFFFF7Ch,', '4']
dd ['offset', '$LN69']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CE@ICOMKHEM@error?5loading?5input?5file?5lists?3?5@']
assume ['cs:_rdata']
public ['??_C@_0CH@BIBBALKP@Warning?3?5This?5option?5will?5be?5ign@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0GL@ENCJOGLG@Warning?3?5You?5are?5using?5the?5optio@']
db ["'which", 'is', 'not', 'supported', 'on', 'this', "platform.',0Ah,0"]
align ['4']
assume ['cs:_rdata']
public ['??_C@_01LFCBOECM@?4?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0GD@IBBFEJOD@?5Copyright?5?$CIC?$CJ?52015?0?5Internation@']
db ["'and", 'others.', 'All', 'Rights', 'Reserved.', "',0"]
align ['4']
assume ['cs:_rdata']
public ['??_C@_0EA@DLAPCBNN@Warning?3?5You?5are?5using?5the?5?9z?5op@']
assume ['cs:_rdata']
public ['??_C@_05LDOEBFOB@?5?5?$CFs?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0M@CKHGFAEI@?5?5?5?5?5?5?5?5?5?5?5?$AA@']
assume ['cs:_rdata']
public ['??_C@_06CIBLEPHP@?1?5?$CF?99s?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_08INOMAIII@?5?5?5?$CF?99s?5?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BE@BEGGIDHH@modes?3?5?$CI?9m?5option?$CJ?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0BG@BPNIFCDI@?$CF?95s?5?9?$CFc?5?$CFs?$CF?910s?5?5?$CFs?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_05KEAGPFFC@?$FLREQ?$FN?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_05IFKLLJBC@?5?5?5?5?5?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_05IEAAHABO@or?5?9?9?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_00CNPNBAHC@?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0M@HLMDKHEP@?6?5options?3?6?$AA@']
db ["'", "options:',0Ah,0"]
assume ['cs:_rdata']
public ['??_C@_0ND@JPBMOOEO@usage?3?5?$CFs?5?$FL?9options?$FN?5?$FL?9?$FN?5?$FLpackag@']
db ["9,'Produce", 'packaged', 'ICU', 'data', 'from', 'the', 'given', 'list(s)', 'of', "files.',0Ah"]
db ["9,27h,'-',27h,'", 'by', 'itself', 'means', 'to', 'read', 'from', "stdin.',0Ah"]
db ["9,'packageFile", 'is', 'a', 'text', 'file', 'containing', 'the', 'list', 'of', 'files', 'to', "packa'"]
db ["'ge.',0Ah,0"]
align ['4']
assume ['cs:_rdata']
public ['??_C@_0DF@DJLHBNPA@No?5input?5files?5specified?4?6Run?5?8?$CF@']
db ["'Run", "',27h,'%s", "--help',27h,'", 'for', "help.',0Ah,0"]
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CE@OMJFHKKK@?5required?5parameter?5?9p?5is?5missin@']
assume ['cs:_rdata']
public ['??_C@_0FF@CKKEEOLA@Warning?3?5You?5are?5using?5the?5?9O?5op@']
db ["'", 'build', 'on', "Windows.',0Ah,0"]
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BL@FGMGBFMF@Run?5?8?$CFs?5?9?9help?8?5for?5help?4?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CJ@POHEAINE@?$CFs?3?5error?5in?5command?5line?5argume@']
align ['10h']
assume ['cs:_rtc$TMZ']
assume ['cs:_rtc$IMZ']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?U_FAILURE@@YACW4UErrorCode@@@Z	proc near 
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C0]']
mov ['ecx,', '30h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
cmp ['[ebp+arg_0],', '0']
setnle ['al']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_executeOptions@@YAHPAUUPKGOptions_@@@Z proc near 
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '2160h']
call ['__chkstk']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2160]']
mov ['ecx,', '858h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+30h]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_15],', 'dl']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Dest],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Source],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_427]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_630],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_62F]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Str1],', 'al']
push ['7FFh']
push ['0']
lea ['eax,', '[ebp+var_E37]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_1640],', 'al']
push ['7FFh']
push ['0']
lea ['eax,', '[ebp+var_163F]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['?initializePkgDataFlags@@YAHPAUUPKGOptions_@@@Z']
add ['esp,', '4']
movsx ['eax,', '[ebp+var_15]']
cmp ['eax,', '66h']
jnz ['loc_30F0']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['loc_30E3']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+10h],', '0']
jz ['short', 'loc_3086']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_30C2']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0CO@DNJANFCH@?$CD?5Install?3?5Files?5mode?0?5copying?5f@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['?pkg_installFileMode@@YAHPBD00@Z']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
jmp ['loc_376F']
mov ['[ebp+var_1649],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+1Ch]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
lea ['edx,', '[ebp+Source]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
lea ['eax,', '[ebp+Source]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+10h]']
push ['ecx']
lea ['edx,', '[ebp+var_630]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '??_C@_04PBCOOEDG@?4dat?$AA@']
lea ['eax,', '[ebp+var_630]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
lea ['eax,', '[ebp+var_630]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_31DD']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str1]']
push ['eax']
push ['offset', '??_C@_0BO@DPFFGHIO@?$CD?5Writing?5package?5file?5?$CFs?5?4?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['6Ch']
push ['0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['edx,', '[ecx]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+38h]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_writePackageDatFile']
add ['esp,', '18h']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3241']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CB@FKNDPKKO@Error?5writing?5package?5dat?5file?4?6@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
movsx ['eax,', '[ebp+var_15]']
cmp ['eax,', '61h']
jz ['short', 'loc_3257']
movsx ['eax,', '[ebp+var_15]']
cmp ['eax,', '63h']
jnz ['loc_3407']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Str2],', 'al']
push ['7FFh']
push ['0']
lea ['eax,', '[ebp+var_1E53]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
lea ['eax,', '[ebp+Dest]']
push ['eax']
lea ['ecx,', '[ebp+Str2]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
lea ['eax,', '[ebp+var_630]']
push ['eax']
lea ['ecx,', '[ebp+Str2]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
lea ['eax,', '[ebp+Str2]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jz ['loc_33D8']
lea ['eax,', '[ebp+Str2]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_3333']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str2]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__remove']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3333']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str2]']
push ['eax']
push ['offset', '??_C@_0CD@CPNAIILI@Unable?5to?5remove?5old?5dat?5file?3?5?$CF@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str2]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__rename']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_3392']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str2]']
push ['eax']
push ['offset', '??_C@_0CA@KOCNCMBB@?$CD?5Moving?5package?5file?5to?5?$CFs?5?4?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_33D8']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str2]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
push ['offset', '??_C@_0DH@GPJAJKAG@Unable?5to?5move?5dat?5file?5?$CI?$CFs?$CJ?5to?5@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['short', 'loc_33FA']
lea ['eax,', '[ebp+Str2]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+3Ch]']
push ['edx']
call ['?pkg_installCommonMode@@YAHPBD0@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
jmp ['loc_376F']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_205C],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_205B]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_2070],', 'al']
xor ['eax,', 'eax']
mov ['[ebp+var_206F],', 'eax']
mov ['[ebp+var_206B],', 'eax']
mov ['[ebp+var_2067],', 'al']
mov ['[ebp+var_2079],', '0']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+4Bh]']
test ['ecx,', 'ecx']
jnz ['loc_3636']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jz ['loc_3636']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax]']
mov ['[ebp+Str],', 'ecx']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_34BF']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
lea ['ecx,', '[ebp+var_205C]']
push ['ecx']
push ['offset', '??_C@_0CN@KAPBMKIE@?$CD?5Generating?5assembly?5code?5?$CFs?5of@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+Str],', '0']
jz ['loc_35F8']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
cmp ['eax,', '3']
jbe ['loc_35F8']
mov ['eax,', '[ebp+Str]']
add ['eax,', '3']
push ['eax']
call ['_checkAssemblyHeaderName']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['loc_35F8']
lea ['eax,', '[ebp+var_205C]']
push ['eax']
push ['0']
mov ['ecx,', '[ebp+arg_0]']
mov ['edx,', '[ecx+18h]']
push ['edx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
lea ['edx,', '[ebp+Str1]']
push ['edx']
call ['_writeAssemblyCode']
add ['esp,', '14h']
lea ['eax,', '[ebp+var_205C]']
push ['eax']
movzx ['ecx,', '[ebp+var_15]']
push ['ecx']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['?pkg_createWithAssemblyCode@@YAHPBDD0@Z']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_357F']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CK@JFDNIOCJ@Error?5generating?5assembly?5code?5f@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
jmp ['short', 'loc_35F6']
movsx ['eax,', '[ebp+var_15]']
cmp ['eax,', '73h']
jnz ['short', 'loc_35F6']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+3Ch],', '0']
jz ['short', 'loc_35EE']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_35CD']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
push ['offset', '??_C@_0CF@OPOHPGMP@?$CD?5Installing?5static?5library?5into@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
movzx ['eax,', '[ebp+var_1649]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+3Ch]']
push ['eax']
call ['?pkg_installLibrary@@YAHPBD0C@Z']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_3772']
jmp ['short', 'loc_3631']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '??_C@_0CA@LDKEGMIE@Assembly?5type?5?$CC?$CFs?$CC?5is?5unknown?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_3772']
jmp ['loc_376F']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_3672']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_205C]']
push ['eax']
push ['offset', '??_C@_0CA@JDIILMBD@?$CD?5Writing?5object?5code?5to?5?$CFs?5?4?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+4Bh]']
test ['ecx,', 'ecx']
jz ['short', 'loc_36AC']
mov ['esi,', 'esp']
push ['offset', '??_C@_0EE@JODDODMN@Error?9?5BUILD_DATA_WITHOUT_ASSEMB@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_373A']
mov ['[ebp+var_209C],', '0']
xor ['eax,', 'eax']
mov ['[ebp+var_209B],', 'eax']
mov ['[ebp+var_2097],', 'eax']
mov ['[ebp+var_2093],', 'al']
lea ['eax,', '[ebp+var_209C]']
push ['eax']
call ['?pkg_createOptMatchArch@@YAXPAD@Z']
add ['esp,', '4']
lea ['eax,', '[ebp+var_205C]']
push ['eax']
push ['0']
movsx ['ecx,', '[ebp+var_209C]']
neg ['ecx']
sbb ['ecx,', 'ecx']
lea ['edx,', '[ebp+var_209C]']
and ['ecx,', 'edx']
push ['ecx']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+24h]']
push ['eax']
lea ['ecx,', '[ebp+Str1]']
push ['ecx']
call ['_writeObjectCode']
add ['esp,', '18h']
lea ['eax,', '[ebp+var_209C]']
push ['eax']
call ['?pkg_destroyOptMatchArch@@YAXPAD@Z']
add ['esp,', '4']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
lea ['ecx,', '[ebp+var_205C]']
push ['ecx']
movzx ['edx,', '[ebp+var_15]']
push ['edx']
call ['?pkg_createWindowsDLL@@YAHDPBDPAUUPKGOptions_@@@Z']
add ['esp,', '0Ch']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_376F']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CA@GBONNIL@Error?5generating?5package?5data?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['short', 'loc_3772']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN43']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2160h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN42']
dd ['offset', '$LN33']
dd ['0FFFFFBD8h,', '200h']
dd ['offset', '$LN34']
dd ['0FFFFF9D0h,', '200h']
dd ['offset', '$LN35']
dd ['0FFFFF1C8h,', '800h']
dd ['offset', '$LN36']
dd ['0FFFFE9C0h,', '800h']
dd ['offset', '$LN37']
dd ['0FFFFE1ACh,', '800h']
dd ['offset', '$LN38']
dd ['0FFFFDFA4h,', '200h']
dd ['offset', '$LN39']
db ['90h']
db ['0DFh,', '2', 'dup(0FFh)']
dd ['0Ah']
dd ['offset', '$LN40']
dd ['0FFFFDF64h,', '0Ah']
dd ['offset', '$LN41']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CA@GBONNIL@Error?5generating?5package?5data?4?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0EE@JODDODMN@Error?9?5BUILD_DATA_WITHOUT_ASSEMB@']
db ["'.',0Ah,0"]
assume ['cs:_rdata']
public ['??_C@_0CA@JDIILMBD@?$CD?5Writing?5object?5code?5to?5?$CFs?5?4?4?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0CA@LDKEGMIE@Assembly?5type?5?$CC?$CFs?$CC?5is?5unknown?4?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0CF@OPOHPGMP@?$CD?5Installing?5static?5library?5into@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CK@JFDNIOCJ@Error?5generating?5assembly?5code?5f@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CN@KAPBMKIE@?$CD?5Generating?5assembly?5code?5?$CFs?5of@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0DH@GPJAJKAG@Unable?5to?5move?5dat?5file?5?$CI?$CFs?$CJ?5to?5@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CA@KOCNCMBB@?$CD?5Moving?5package?5file?5to?5?$CFs?5?4?4?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0CD@CPNAIILI@Unable?5to?5remove?5old?5dat?5file?3?5?$CF@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CB@FKNDPKKO@Error?5writing?5package?5dat?5file?4?6@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BO@DPFFGHIO@?$CD?5Writing?5package?5file?5?$CFs?5?4?4?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_04PBCOOEDG@?4dat?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CO@DNJANFCH@?$CD?5Install?3?5Files?5mode?0?5copying?5f@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_01KICIPPFI@?2?$AA@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?initializePkgDataFlags@@YAHPAUUPKGOptions_@@@Z	proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '114h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_114]']
mov ['ecx,', '45h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_8],', '0']
mov ['[ebp+var_14],', '0']
mov ['[ebp+var_20],', '200h']
mov ['[ebp+var_2C],', '0']
push ['44h']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['ds:_pkgDataFlags,', 'eax']
cmp ['ds:_pkgDataFlags,', '0']
jz ['loc_3BC3']
mov ['[ebp+var_38],', '0']
jmp ['short', 'loc_3B1C']
mov ['eax,', '[ebp+var_38]']
add ['eax,', '1']
mov ['[ebp+var_38],', 'eax']
cmp ['[ebp+var_38],', '11h']
jge ['loc_3BC1']
mov ['eax,', '[ebp+var_20]']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['ecx,', '[ebp+var_38]']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['[edx+ecx*4],', 'eax']
mov ['eax,', '[ebp+var_38]']
mov ['ecx,', 'ds:_pkgDataFlags']
cmp ['dword', 'ptr', '[ecx+eax*4],', '0']
jz ['short', 'loc_3B5E']
mov ['eax,', '[ebp+var_38]']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+eax*4]']
mov ['byte', 'ptr', '[edx],', '0']
jmp ['short', 'loc_3BBC']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CL@EFCHDGAC@Error?5allocating?5memory?5for?5pkgD@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_38]']
add ['eax,', '1']
mov ['[ebp+var_44],', 'eax']
jmp ['short', 'loc_3B9C']
mov ['eax,', '[ebp+var_44]']
add ['eax,', '1']
mov ['[ebp+var_44],', 'eax']
cmp ['[ebp+var_44],', '11h']
jge ['short', 'loc_3BB4']
mov ['eax,', '[ebp+var_44]']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['dword', 'ptr', '[ecx+eax*4],', '0']
jmp ['short', 'loc_3B93']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_3CCC']
jmp ['loc_3B13']
jmp ['short', 'loc_3BF5']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CL@EFCHDGAC@Error?5allocating?5memory?5for?5pkgD@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_3CCC']
mov ['eax,', '[ebp+arg_0]']
cmp ['dword', 'ptr', '[eax+2Ch],', '0']
jnz ['short', 'loc_3C06']
mov ['eax,', '[ebp+var_14]']
jmp ['loc_3CCC']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['loc_3CC9']
mov ['esi,', 'esp']
push ['offset', '??_C@_0BB@BICCNADP@?$CD?5pkgDataFlags?$DN?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_50],', '0']
jmp ['short', 'loc_3C51']
mov ['eax,', '[ebp+var_50]']
add ['eax,', '1']
mov ['[ebp+var_50],', 'eax']
cmp ['[ebp+var_50],', '11h']
jge ['short', 'loc_3C9F']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_50]']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+eax*4]']
push ['edx']
mov ['eax,', '[ebp+var_50]']
mov ['ecx,', 'ds:_FLAG_NAMES[eax*4]']
push ['ecx']
mov ['edx,', '[ebp+var_50]']
push ['edx']
push ['offset', '??_C@_0BA@IGIMNNGF@?5?5?$FL?$CFd?$FN?5?$CFs?3?5?5?$CFs?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_3C48']
mov ['esi,', 'esp']
push ['offset', '??_C@_01EEMJAFIK@?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_14]']
pop ['edi']
pop ['esi']
pop ['ebx']
add ['esp,', '114h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
assume ['cs:_rdata']
public ['??_C@_01EEMJAFIK@?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BA@IGIMNNGF@?5?5?$FL?$CFd?$FN?5?$CFs?3?5?5?$CFs?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0BB@BICCNADP@?$CD?5pkgDataFlags?$DN?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CL@EFCHDGAC@Error?5allocating?5memory?5for?5pkgD@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_installLibrary@@YAHPBD0C@Z	proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2D8h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2D8]']
mov ['ecx,', '0B6h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['eax,', 'offset', 'Str1']
mov ['esi,', 'esp']
push ['eax']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', 'Str1']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+40h]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
push ['offset', '??_C@_0BG@MJNMHHBK@cd?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CFs?$CFs?$CFs?$AA@']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '20h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_3DF3']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0CO@JDGNJAIA@Error?5installing?5library?4?5Failed@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['short', 'loc_3E10']
movsx ['eax,', '[ebp+arg_8]']
test ['eax,', 'eax']
jz ['short', 'loc_3E02']
mov ['eax,', '[ebp+var_C]']
jmp ['short', 'loc_3E10']
jmp ['short', 'loc_3E10']
push ['1']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['?pkg_createSymLinks@@YAHPBDC@Z']
add ['esp,', '8']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN8']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2D8h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['10h']
dd ['offset', '$LN7']
dd ['offset', '$LN6']
assume ['cs:_rdata']
public ['??_C@_0CO@JDGNJAIA@Error?5installing?5library?4?5Failed@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BG@MJNMHHBK@cd?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CFs?$CFs?$CFs?$AA@']
align ['10h']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?runCommand@@YAHPBDC@Z proc near	
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2F0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2F0]']
mov ['ecx,', '0BCh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+Command],', '0']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_220],', 'eax']
cmp ['[ebp+var_220],', '0']
jnz ['short', 'loc_3EF1']
xor ['eax,', 'eax']
jmp ['loc_3F9D']
movsx ['eax,', '[ebp+arg_4]']
test ['eax,', 'eax']
jnz ['short', '$normal_command_mode$11289']
jmp ['short', '$normal_command_mode$11289']
jmp ['short', '$normal_command_mode$11289']
jmp ['short', 'loc_3F05']
mov ['eax,', '[ebp+Str]']
mov ['[ebp+Command],', 'eax']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Command]']
push ['eax']
push ['offset', '??_C@_0N@KDALANNC@pkgdata?3?5?$CFs?6?$AA@']
call ['dword', 'ptr', 'ds:__imp__printf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Command]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__system']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_22C],', 'eax']
cmp ['[ebp+var_22C],', '0']
jz ['short', 'loc_3F76']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_22C]']
push ['eax']
push ['offset', '??_C@_0BH@IDKKFBIN@?9?9?5return?5status?5?$DN?5?$CFd?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+Command]']
lea ['ecx,', '[ebp+var_214]']
cmp ['eax,', 'ecx']
jz ['short', 'loc_3F97']
mov ['eax,', '[ebp+Command]']
cmp ['eax,', '[ebp+Str]']
jz ['short', 'loc_3F97']
mov ['eax,', '[ebp+Command]']
push ['eax']
call ['_uprv_free_56']
add ['esp,', '4']
mov ['eax,', '[ebp+var_22C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN11']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2F0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
dd ['offset', '$LN10']
dd ['offset', '$LN9']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BH@IDKKFBIN@?9?9?5return?5status?5?$DN?5?$CFd?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0N@KDALANNC@pkgdata?3?5?$CFs?6?$AA@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_createSymLinks@@YAHPBDC@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0CF8h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_CF8]']
mov ['ecx,', '33Eh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+4]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_4064']
mov ['[ebp+var_CF8],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
jmp ['short', 'loc_406E']
mov ['[ebp+var_CF8],', 'offset', '??_C@_01LFCBOECM@?4?$AA@']
mov ['edx,', '[ebp+var_CF8]']
mov ['[ebp+var_C30],', 'edx']
push ['offset', 'Str1']
call ['_strlen']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_40B2']
push ['offset', 'Str2']
call ['_strlen']
add ['esp,', '4']
test ['eax,', 'eax']
jz ['short', 'loc_40B2']
push ['offset', 'Str2']
push ['offset', 'Str1']
call ['_strcmp']
add ['esp,', '8']
test ['eax,', 'eax']
jnz ['short', 'loc_40BA']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_4206']
mov ['eax,', 'offset', 'Str2']
mov ['esi,', 'esp']
push ['eax']
push ['offset', 'Str1']
push ['offset', '??_C@_05IDLMAIOJ@ln?5?9s?$AA@']
push ['offset', 'Str2']
push ['offset', '??_C@_05MKHFPHMG@rm?5?9f?$AA@']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '??_C@_0BL@CJMEOBIK@cd?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CFs?$AA@']
lea ['edx,', '[ebp+Dest]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '20h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_4149']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0DD@FMCHNCJN@Error?5creating?5symbolic?5links?4?5F@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
jmp ['loc_4206']
movsx ['eax,', '[ebp+arg_4]']
test ['eax,', 'eax']
jz ['short', '$normal_symlink_mode$11438']
jmp ['short', '$normal_symlink_mode$11438']
jmp ['short', '$normal_symlink_mode$11438']
jmp ['short', 'loc_41AE']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+4]']
push ['ecx']
mov ['edx,', '[ebp+var_C30]']
push ['edx']
push ['offset', '_libFileNames']
push ['offset', '??_C@_06DIJPEION@?$CFs?$CFs?$CFs?$AA@']
lea ['eax,', '[ebp+var_A1C]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', 'offset', 'Str1']
mov ['esi,', 'esp']
push ['eax']
push ['offset', '??_C@_02DKCKIIND@?$CFs?$AA@']
lea ['ecx,', '[ebp+var_C24]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_A1C]']
push ['eax']
lea ['ecx,', '[ebp+var_C24]']
push ['ecx']
push ['offset', '??_C@_05IDLMAIOJ@ln?5?9s?$AA@']
lea ['edx,', '[ebp+var_A1C]']
push ['edx']
push ['offset', '??_C@_05MKHFPHMG@rm?5?9f?$AA@']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '??_C@_0BL@CJMEOBIK@cd?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CFs?$AA@']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '20h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN15']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '0CF8h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN14']
dd ['offset', '$LN11_0']
dd ['0FFFFF5E4h,', '200h']
dd ['offset', '$LN12']
dd ['0FFFFF3DCh,', '200h']
dd ['offset', '$LN13']
assume ['cs:_rdata']
public ['??_C@_02DKCKIIND@?$CFs?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_06DIJPEION@?$CFs?$CFs?$CFs?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0DD@FMCHNCJN@Error?5creating?5symbolic?5links?4?5F@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BL@CJMEOBIK@cd?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CG?$CG?5?$CFs?5?$CFs?5?$CFs?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_05MKHFPHMG@rm?5?9f?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_05IDLMAIOJ@ln?5?9s?$AA@']
align ['10h']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_installCommonMode@@YAHPBD0@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2E4h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2E4]']
mov ['ecx,', '0B9h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Dest],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jnz ['short', 'loc_43A9']
mov ['[ebp+var_220],', '0']
lea ['eax,', '[ebp+var_220]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_uprv_mkdir']
add ['esp,', '8']
mov ['eax,', '[ebp+var_220]']
push ['eax']
call ['?U_FAILURE@@YACW4UErrorCode@@@Z']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_43A9']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '??_C@_0CL@PFOHAPNF@Error?5creating?5installation?5dire@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['short', 'loc_4427']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+40h]']
push ['eax']
push ['offset', '??_C@_08EPEHIMMI@?$CFs?5?$CFs?5?$CFs?$AA@']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_4424']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0CO@FGLGBMHN@Failed?5to?5install?5data?5file?5with@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN9_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2E4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN8_0']
dd ['offset', '$LN6_0']
dd ['0FFFFFDE0h,', '4']
dd ['offset', '$LN7_0']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CO@FGLGBMHN@Failed?5to?5install?5data?5file?5with@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_08EPEHIMMI@?$CFs?5?$CFs?5?$CFs?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CL@PFOHAPNF@Error?5creating?5installation?5dire@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_installFileMode@@YAHPBD00@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '504h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_504]']
mov ['ecx,', '141h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Dest],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jnz ['short', 'loc_45B8']
mov ['[ebp+var_220],', '0']
lea ['eax,', '[ebp+var_220]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
call ['_uprv_mkdir']
add ['esp,', '8']
mov ['eax,', '[ebp+var_220]']
push ['eax']
call ['?U_FAILURE@@YACW4UErrorCode@@@Z']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_45B8']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '??_C@_0CL@PFOHAPNF@Error?5creating?5installation?5dire@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_4785']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Str],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_427]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['[ebp+var_434],', '0']
push ['offset', '??_C@_01KDCPPGHE@r?$AA@']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
call ['_T_FileStream_open']
add ['esp,', '8']
mov ['[ebp+var_440],', 'eax']
cmp ['[ebp+var_440],', '0']
jz ['loc_474D']
push ['200h']
lea ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_440]']
push ['ecx']
call ['_T_FileStream_readLine']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['loc_46ED']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+var_434],', 'eax']
cmp ['[ebp+var_434],', '0']
jle ['short', 'loc_4656']
mov ['eax,', '[ebp+var_434]']
mov ['[ebp+eax+var_429],', '0']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
lea ['edx,', '[ebp+Str]']
push ['edx']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+40h]']
push ['edx']
push ['offset', '??_C@_0BB@PIPNEKBK@?$CFs?5?$CFs?$CFs?$CFs?5?$CFs?$CFs?$CFs?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '24h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_46EB']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0CO@FGLGBMHN@Failed?5to?5install?5data?5file?5with@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_473C']
jmp ['short', 'loc_4737']
mov ['eax,', '[ebp+var_440]']
push ['eax']
call ['_T_FileStream_eof']
add ['esp,', '4']
test ['eax,', 'eax']
jnz ['short', 'loc_4735']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', '??_C@_0CD@KDIPABJM@Failed?5to?5read?5line?5from?5file?3?5?$CF@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_C],', '0FFFFFFFFh']
jmp ['short', 'loc_473C']
jmp ['loc_4607']
mov ['eax,', '[ebp+var_440]']
push ['eax']
call ['_T_FileStream_close']
add ['esp,', '4']
jmp ['short', 'loc_4782']
mov ['[ebp+var_C],', '0FFFFFFFFh']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', '??_C@_0BO@GPHOLIOB@Unable?5to?5open?5list?5file?3?5?$CFs?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN18']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '504h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
dd ['offset', '$LN17']
dd ['offset', '$LN14_0']
dd ['0FFFFFDE0h,', '4']
dd ['offset', '$LN15_0']
dd ['0FFFFFBD8h,', '200h']
dd ['offset', '$LN16']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BO@GPHOLIOB@Unable?5to?5open?5list?5file?3?5?$CFs?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CD@KDIPABJM@Failed?5to?5read?5line?5from?5file?3?5?$CF@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BB@PIPNEKBK@?$CFs?5?$CFs?$CFs?$CFs?5?$CFs?$CFs?$CFs?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_01KDCPPGHE@r?$AA@']
align ['10h']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_createWithAssemblyCode@@YAHPBDD0@Z	proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '2F0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_2F0]']
mov ['ecx,', '0BCh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Dest],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['[ebp+var_220],', '0']
mov ['[ebp+var_22C],', '0']
mov ['eax,', '[ebp+Source]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
mov ['[ebp+eax+var_209],', '6Fh']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+18h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+1Ch]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['edx,', '[ebp+Source]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
lea ['eax,', '[esi+eax+14h]']
mov ['[ebp+var_22C],', 'eax']
mov ['eax,', '[ebp+var_22C]']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['[ebp+Str],', 'eax']
cmp ['[ebp+Str],', '0']
jnz ['short', 'loc_494B']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_4A0C']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Source]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+1Ch]']
push ['eax']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+18h]']
push ['edx']
push ['offset', '??_C@_0P@NIGMNLEJ@?$CFs?5?$CFs?5?9o?5?$CFs?5?$CFs?$AA@']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_220],', 'eax']
mov ['eax,', '[ebp+Str]']
push ['eax']
call ['_uprv_free_56']
add ['esp,', '4']
cmp ['[ebp+var_220],', '0']
jz ['short', 'loc_49F0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '??_C@_0DH@NCDADFHJ@Error?5creating?5with?5assembly?5cod@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_220]']
jmp ['short', 'loc_4A0C']
push ['0']
push ['0']
lea ['eax,', '[ebp+Dest]']
push ['eax']
movzx ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
call ['?pkg_generateLibraryFile@@YAHPBDD0PADC@Z']
add ['esp,', '14h']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN7_1']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '2F0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN6_1']
dd ['offset', '$LN5']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0DH@NCDADFHJ@Error?5creating?5with?5assembly?5cod@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0P@NIGMNLEJ@?$CFs?5?$CFs?5?9o?5?$CFs?5?$CFs?$AA@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_generateLibraryFile@@YAHPBDD0PADC@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0F4h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_F4]']
mov ['ecx,', '3Dh']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['[ebp+var_8],', '0']
mov ['[ebp+Dest],', '0']
mov ['[ebp+var_1D],', '0']
mov ['[ebp+var_2C],', '0']
cmp ['[ebp+arg_C],', '0']
jz ['short', 'loc_4AEB']
mov ['eax,', '[ebp+arg_C]']
mov ['[ebp+Dest],', 'eax']
movsx ['eax,', '[ebp+arg_4]']
cmp ['eax,', '73h']
jnz ['loc_4C4F']
cmp ['[ebp+Dest],', '0']
jnz ['loc_4BB7']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+34h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+38h]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
push ['offset', 'Str1']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+3Ch]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
lea ['edx,', '[esi+eax+14h]']
mov ['[ebp+var_2C],', 'edx']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['[ebp+Dest],', 'eax']
cmp ['[ebp+Dest],', '0']
jnz ['short', 'loc_4BB3']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CI@GHNPGNOL@Unable?5to?5allocate?5memory?5for?5co@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_4E4E']
mov ['[ebp+var_1D],', '1']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_8]']
push ['eax']
push ['offset', 'Str1']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+38h]']
push ['eax']
mov ['ecx,', 'ds:_pkgDataFlags']
mov ['edx,', '[ecx+34h]']
push ['edx']
push ['offset', '??_C@_0O@PGLGNIM@?$CFs?5?$CFs?5?$CFs?$CFs?5?$CFs?$AA@']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '1Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_4C4A']
mov ['eax,', 'offset', 'Str1']
mov ['esi,', 'esp']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+3Ch]']
push ['eax']
push ['offset', '??_C@_07LLFIICBM@?$CFs?5?$CFs?$CFs?$AA@']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
jmp ['loc_4E03']
cmp ['[ebp+Dest],', '0']
jnz ['loc_4D6E']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+28h]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_4C74']
mov ['[ebp+var_F4],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
jmp ['short', 'loc_4C7E']
mov ['[ebp+var_F4],', 'offset', 'Str2']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+20h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+24h]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['edi,', 'eax']
push ['offset', 'byte_7BC']
call ['_strlen']
add ['esp,', '4']
add ['edi,', 'eax']
lea ['esi,', '[esi+edi*2]']
mov ['edx,', '[ebp+arg_8]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+28h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['edx,', '[ebp+var_F4]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+2Ch]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
add ['esi,', 'eax']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+30h]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
lea ['ecx,', '[esi+eax+14h]']
mov ['[ebp+var_2C],', 'ecx']
mov ['eax,', '[ebp+var_2C]']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['[ebp+Dest],', 'eax']
cmp ['[ebp+Dest],', '0']
jnz ['short', 'loc_4D6A']
mov ['esi,', 'esp']
push ['offset', '??_C@_0CI@GHNPGNOL@Unable?5to?5allocate?5memory?5for?5co@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
or ['eax,', '0FFFFFFFFh']
jmp ['loc_4E4E']
mov ['[ebp+var_1D],', '1']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+28h]']
movsx ['edx,', 'byte', 'ptr', '[ecx]']
test ['edx,', 'edx']
jnz ['short', 'loc_4D89']
mov ['[ebp+var_F4],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
jmp ['short', 'loc_4D93']
mov ['[ebp+var_F4],', 'offset', 'Str2']
mov ['esi,', 'esp']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+30h]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+2Ch]']
push ['eax']
mov ['ecx,', '[ebp+var_F4]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+28h]']
push ['eax']
mov ['ecx,', '[ebp+arg_8]']
push ['ecx']
push ['offset', 'byte_7BC']
mov ['edx,', '[ebp+Str]']
push ['edx']
mov ['eax,', 'ds:_pkgDataFlags']
mov ['ecx,', '[eax+24h]']
push ['ecx']
mov ['edx,', 'ds:_pkgDataFlags']
mov ['eax,', '[edx+20h]']
push ['eax']
push ['offset', '??_C@_0BM@BLHAKFDE@?$CFs?5?$CFs?5?9o?5?$CFs?$CFs?5?$CFs?5?$CFs?$CFs?5?$CFs?5?$CFs?$AA@']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '2Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['0']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0']
jz ['short', 'loc_4E37']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Dest]']
push ['eax']
push ['offset', '??_C@_0DD@JEKGCDDE@Error?5generating?5library?5file?4?5F@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
movsx ['eax,', '[ebp+var_1D]']
test ['eax,', 'eax']
jz ['short', 'loc_4E4B']
mov ['eax,', '[ebp+Dest]']
push ['eax']
call ['_uprv_free_56']
add ['esp,', '4']
mov ['eax,', '[ebp+var_8]']
pop ['edi']
pop ['esi']
pop ['ebx']
add ['esp,', '0F4h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
assume ['cs:_rdata']
public ['??_C@_0DD@JEKGCDDE@Error?5generating?5library?5file?4?5F@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BM@BLHAKFDE@?$CFs?5?$CFs?5?9o?5?$CFs?$CFs?5?$CFs?5?$CFs?$CFs?5?$CFs?5?$CFs?$AA@']
assume ['cs:_rdata']
public ['??_C@_07LLFIICBM@?$CFs?5?$CFs?$CFs?$AA@']
assume ['cs:_rdata']
public ['??_C@_0O@PGLGNIM@?$CFs?5?$CFs?5?$CFs?$CFs?5?$CFs?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CI@GHNPGNOL@Unable?5to?5allocate?5memory?5for?5co@']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_createWindowsDLL@@YAHDPBDPAUUPKGOptions_@@@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '1304h']
call ['__chkstk']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_1304]']
mov ['ecx,', '4C1h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_C],', '0']
movsx ['eax,', '[ebp+arg_0]']
cmp ['eax,', '73h']
jnz ['loc_4FFD']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Dest],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+Dst]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['esi,', 'esp']
push ['offset', '??_C@_05OHDIICPD@icudt?$AA@']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+44h]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__strstr']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_4F83']
mov ['[ebp+var_1304],', 'offset', '??_C@_01LKDEMHDF@s?$AA@']
jmp ['short', 'loc_4F8D']
mov ['[ebp+var_1304],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
mov ['esi,', 'esp']
push ['offset', '??_C@_04CGBBCILG@?4lib?$AA@']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx+44h]']
push ['eax']
mov ['ecx,', '[ebp+var_1304]']
push ['ecx']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
mov ['edx,', '[ebp+arg_8]']
mov ['eax,', '[edx+1Ch]']
push ['eax']
push ['offset', '??_C@_0L@MOHIGKOO@?$CFs?$CFs?$CFs?$CFs?$CFs?$AA@']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '1Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
push ['offset', '??_C@_0BG@EHGJCDPF@LIB?4exe?5?1nologo?5?1out?3?$AA@']
push ['offset', '??_C@_0M@EAAPLNDK@?$CFs?$CC?$CFs?$CC?5?$CC?$CFs?$CC?$AA@']
lea ['edx,', '[ebp+Str]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_52BD']
movsx ['eax,', '[ebp+arg_0]']
cmp ['eax,', '64h']
jz ['short', 'loc_5013']
movsx ['eax,', '[ebp+arg_0]']
cmp ['eax,', '6Ch']
jnz ['loc_52BD']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+Source],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_C23]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_E2C],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_E2B]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_1034],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_1033]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['al,', 'ds:??_C@_00CNPNBAHC@?$AA@']
mov ['[ebp+var_123C],', 'al']
push ['1FFh']
push ['0']
lea ['eax,', '[ebp+var_123B]']
push ['eax']
call ['_memset_0']
add ['esp,', '0Ch']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
lea ['edx,', '[ebp+Source]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
lea ['eax,', '[ebp+Source]']
push ['eax']
lea ['ecx,', '[ebp+var_E2C]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
mov ['esi,', 'esp']
push ['offset', '??_C@_05OHDIICPD@icudt?$AA@']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+44h]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__strstr']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_510F']
push ['offset', '??_C@_09EAFPJNND@icudt?4lib?$AA@']
lea ['eax,', '[ebp+var_E2C]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
jmp ['short', 'loc_5139']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+44h]']
push ['ecx']
lea ['edx,', '[ebp+var_E2C]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
push ['offset', '??_C@_04CGBBCILG@?4lib?$AA@']
lea ['eax,', '[ebp+var_E2C]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+18h]']
push ['ecx']
lea ['edx,', '[ebp+Source]']
push ['edx']
call ['_strcat']
add ['esp,', '8']
push ['offset', '??_C@_04HLONOPDM@?4dll?$AA@']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_8]']
mov ['ecx,', '[eax+24h]']
push ['ecx']
lea ['edx,', '[ebp+var_123C]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+var_123C]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
push ['offset', '??_C@_0M@NLAPFDCK@icudata?4res?$AA@']
lea ['eax,', '[ebp+var_123C]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
lea ['eax,', '[ebp+var_123C]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_51DC']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_123C]']
push ['eax']
push ['offset', '??_C@_04OEDFLLKD@?$CC?$CFs?$CC?$AA@']
lea ['ecx,', '[ebp+var_1034]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax+48h]']
test ['ecx,', 'ecx']
jnz ['loc_527C']
lea ['eax,', '[ebp+Source]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_527C']
push ['0']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
lea ['ecx,', '[ebp+Source]']
push ['ecx']
call ['_isFileModTimeLater']
add ['esp,', '0Ch']
movsx ['edx,', 'al']
test ['edx,', 'edx']
jz ['short', 'loc_527C']
lea ['eax,', '[ebp+var_E2C]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_527C']
push ['0']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
lea ['ecx,', '[ebp+var_E2C]']
push ['ecx']
call ['_isFileModTimeLater']
add ['esp,', '0Ch']
movsx ['edx,', 'al']
test ['edx,', 'edx']
jz ['short', 'loc_527C']
mov ['eax,', '[ebp+arg_8]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_5275']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_4]']
push ['eax']
push ['offset', '??_C@_0CD@FPKOLHEB@?$CD?5Not?5rebuilding?5?$CFs?5?9?5up?5to?5date@']
call ['dword', 'ptr', 'ds:__imp__printf']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
jmp ['loc_530B']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+var_1034]']
push ['eax']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
lea ['edx,', '[ebp+var_E2C]']
push ['edx']
push ['offset', '??_C@_0DG@OEHPCOLA@?1DLL?5?1NOENTRY?5?1MANIFEST?3NO?5?5?1bas@']
lea ['eax,', '[ebp+Source]']
push ['eax']
push ['offset', '??_C@_0CA@JEBMKBKG@link?4exe?5?1nologo?5?1release?5?1out?3?$AA@']
push ['offset', '??_C@_0BG@JLMDMOAD@?$CFs?$CC?$CFs?$CC?5?$CFs?$CC?$CFs?$CC?5?$CC?$CFs?$CC?5?$CFs?$AA@']
lea ['ecx,', '[ebp+Str]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__sprintf']
add ['esp,', '20h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['1']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['?runCommand@@YAHPBDC@Z']
add ['esp,', '8']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_5308']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Str]']
push ['eax']
push ['offset', '??_C@_0DI@PLIAOADB@Error?5creating?5Windows?5DLL?5libra@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_C]']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN22']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '1304h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN21']
dd ['offset', '$LN15_1']
dd ['0FFFFF5E4h,', '200h']
dd ['offset', '$LN16_0']
dd ['0FFFFF3DCh,', '200h']
dd ['offset', '$LN17_0']
dd ['0FFFFF1D4h,', '200h']
dd ['offset', '$LN18_0']
db ['0CCh']
db ['0EFh,', '2', 'dup(0FFh)']
dd ['offset', '??_C@_0EF@JEPMEHH@Generates?5one?5common?5data?5file?5a@']
dd ['offset', '$LN19']
dd ['0FFFFEDC4h,', '200h']
dd ['offset', '$LN20']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0DI@PLIAOADB@Error?5creating?5Windows?5DLL?5libra@']
assume ['cs:_rdata']
public ['??_C@_0BG@JLMDMOAD@?$CFs?$CC?$CFs?$CC?5?$CFs?$CC?$CFs?$CC?5?$CC?$CFs?$CC?5?$CFs?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CA@JEBMKBKG@link?4exe?5?1nologo?5?1release?5?1out?3?$AA@']
assume ['cs:_rdata']
public ['??_C@_0DG@OEHPCOLA@?1DLL?5?1NOENTRY?5?1MANIFEST?3NO?5?5?1bas@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CD@FPKOLHEB@?$CD?5Not?5rebuilding?5?$CFs?5?9?5up?5to?5date@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_04OEDFLLKD@?$CC?$CFs?$CC?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0M@NLAPFDCK@icudata?4res?$AA@']
assume ['cs:_rdata']
public ['??_C@_04HLONOPDM@?4dll?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_09EAFPJNND@icudt?4lib?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0M@EAAPLNDK@?$CFs?$CC?$CFs?$CC?5?$CC?$CFs?$CC?$AA@']
assume ['cs:_rdata']
public ['??_C@_0BG@EHGJCDPF@LIB?4exe?5?1nologo?5?1out?3?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0L@MOHIGKOO@?$CFs?$CFs?$CFs?$CFs?$CFs?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_04CGBBCILG@?4lib?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_01LKDEMHDF@s?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_05OHDIICPD@icudt?$AA@']
align ['10h']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?loadLists@@YAXPAUUPKGOptions_@@PAW4UErrorCode@@@Z proc	near 
push ['ebp']
mov ['ebp,', 'esp']
mov ['eax,', '4154h']
call ['__chkstk']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+Source]']
mov ['ecx,', '1055h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['[ebp+var_18],', '0']
mov ['[ebp+var_24],', '0']
mov ['[ebp+var_405C],', '3FACh']
mov ['[ebp+var_4074],', '0']
mov ['[ebp+var_408C],', '0']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax]']
mov ['[ebp+var_C],', 'ecx']
jmp ['short', 'loc_557B']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax+4]']
mov ['[ebp+var_C],', 'ecx']
cmp ['[ebp+var_C],', '0']
jz ['loc_5B18']
mov ['eax,', '[ebp+arg_0]']
movsx ['ecx,', 'byte', 'ptr', '[eax+49h]']
test ['ecx,', 'ecx']
jz ['short', 'loc_55C0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['offset', '??_C@_0BJ@IOHHLMMD@?$CD?5pkgdata?3?5Reading?5?$CFs?4?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '20h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
push ['offset', '??_C@_01KDCPPGHE@r?$AA@']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
push ['ecx']
call ['_T_FileStream_open']
add ['esp,', '8']
mov ['[ebp+var_30],', 'eax']
cmp ['[ebp+var_30],', '0']
jnz ['short', 'loc_561A']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_C]']
mov ['ecx,', '[eax]']
push ['ecx']
push ['offset', '??_C@_0BF@CNPBAPEJ@Error?5opening?5?$DM?$CFs?$DO?4?6?$AA@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_4]']
mov ['dword', 'ptr', '[eax],', '4']
jmp ['loc_5B18']
push ['4000h']
lea ['eax,', '[ebp+Str]']
push ['eax']
mov ['ecx,', '[ebp+var_30]']
push ['ecx']
call ['_T_FileStream_readLine']
add ['esp,', '0Ch']
test ['eax,', 'eax']
jz ['loc_5B07']
mov ['eax,', '[ebp+var_408C]']
add ['eax,', '1']
mov ['[ebp+var_408C],', 'eax']
lea ['eax,', '[ebp+Str]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
cmp ['eax,', '3FACh']
jbe ['short', 'loc_56AC']
mov ['esi,', 'esp']
push ['3FACh']
mov ['eax,', '[ebp+var_408C]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx]']
push ['edx']
push ['offset', '??_C@_0CH@KPJKOLO@?$CFs?3?$CFd?5?9?5line?5too?5long?5?$CIover?5?$CFd?5c@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '14h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__exit']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
lea ['eax,', '[ebp+Str]']
mov ['[ebp+var_4044],', 'eax']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
mov ['esi,', 'esp']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__isspace']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
test ['eax,', 'eax']
jz ['short', 'loc_56E9']
mov ['eax,', '[ebp+var_4044]']
add ['eax,', '1']
mov ['[ebp+var_4044],', 'eax']
jmp ['short', 'loc_56B8']
mov ['eax,', '[ebp+var_4044]']
mov ['[ebp+var_4080],', 'eax']
mov ['eax,', '[ebp+var_4080]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_573A']
mov ['eax,', '[ebp+var_4080]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '0Dh']
jz ['short', 'loc_571E']
mov ['eax,', '[ebp+var_4080]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '0Ah']
jnz ['short', 'loc_5729']
mov ['eax,', '[ebp+var_4080]']
mov ['byte', 'ptr', '[eax],', '0']
jmp ['short', 'loc_573A']
mov ['eax,', '[ebp+var_4080]']
add ['eax,', '1']
mov ['[ebp+var_4080],', 'eax']
jmp ['short', 'loc_56F5']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_5755']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '23h']
jnz ['short', 'loc_575A']
jmp ['loc_561A']
mov ['[ebp+var_4050],', '0']
cmp ['[ebp+var_4044],', '0']
jz ['loc_5B02']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['loc_5B02']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '20h']
jnz ['short', 'loc_57A1']
mov ['eax,', '[ebp+var_4044]']
add ['eax,', '1']
mov ['[ebp+var_4044],', 'eax']
jmp ['short', 'loc_5782']
mov ['eax,', '[ebp+var_4044]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '22h']
jnz ['loc_58F2']
push ['22h']
mov ['eax,', '[ebp+var_4044]']
add ['eax,', '1']
push ['eax']
call ['?strchr@@YAPADPADH@Z']
add ['esp,', '8']
mov ['[ebp+var_4050],', 'eax']
cmp ['[ebp+var_4050],', '0']
jnz ['short', 'loc_5823']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_408C]']
push ['eax']
mov ['ecx,', '[ebp+var_C]']
mov ['edx,', '[ecx]']
push ['edx']
push ['offset', '??_C@_0CL@EDGDBDDC@?$CFs?3?$CFd?5?9?5missing?5trailing?5double?5@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__exit']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['loc_58F0']
mov ['eax,', '[ebp+var_4050]']
add ['eax,', '1']
mov ['[ebp+var_4050],', 'eax']
mov ['eax,', '[ebp+var_4050]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['loc_58F0']
mov ['eax,', '[ebp+var_4050]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '20h']
jz ['loc_58D8']
mov ['eax,', '[ebp+var_4050]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_5872']
mov ['edx,', '[ebp+var_4050]']
mov ['al,', '[edx]']
mov ['byte', 'ptr', '[ebp+Source+3],', 'al']
jmp ['short', 'loc_5879']
mov ['byte', 'ptr', '[ebp+Source+3],', '30h']
movsx ['ecx,', 'byte', 'ptr', '[ebp+Source+3]']
mov ['esi,', 'esp']
push ['ecx']
mov ['edx,', '[ebp+var_4050]']
lea ['eax,', '[ebp+Str]']
sub ['edx,', 'eax']
push ['edx']
mov ['ecx,', '[ebp+var_408C]']
push ['ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[edx]']
push ['eax']
push ['offset', '??_C@_0EF@KKAOIKDN@?$CFs?3?$CFd?5?9?5malformed?5quoted?5line?5at@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '18h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__exit']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_4050]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['eax,', '[ebp+var_4050]']
add ['eax,', '1']
mov ['[ebp+var_4050],', 'eax']
jmp ['short', 'loc_592A']
push ['20h']
mov ['eax,', '[ebp+var_4044]']
push ['eax']
call ['?strchr@@YAPADPADH@Z']
add ['esp,', '8']
mov ['[ebp+var_4050],', 'eax']
cmp ['[ebp+var_4050],', '0']
jz ['short', 'loc_592A']
mov ['eax,', '[ebp+var_4050]']
mov ['byte', 'ptr', '[eax],', '0']
mov ['eax,', '[ebp+var_4050]']
add ['eax,', '1']
mov ['[ebp+var_4050],', 'eax']
mov ['eax,', '[ebp+var_4044]']
push ['eax']
call ['_getLongPathname']
add ['esp,', '4']
mov ['[ebp+var_4080],', 'eax']
mov ['eax,', '[ebp+var_4044]']
push ['eax']
call ['_uprv_strdup_56']
add ['esp,', '4']
push ['eax']
lea ['ecx,', '[ebp+var_18]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+8]']
push ['eax']
call ['_pkg_appendToList']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+8],', 'eax']
mov ['eax,', '[ebp+var_4080]']
push ['eax']
call ['_uprv_pathIsAbsolute_56']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jnz ['short', 'loc_598C']
mov ['eax,', '[ebp+var_4080]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
cmp ['ecx,', '2Eh']
jnz ['short', 'loc_59D0']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4080]']
push ['eax']
push ['5Ch']
push ['offset', '??_C@_0JM@OGPADHEG@pkgdata?3?5Error?3?5absolute?5path?5en@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['1']
call ['dword', 'ptr', 'ds:__imp__exit']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['esi,', 'eax']
mov ['edx,', '[ebp+var_4080]']
push ['edx']
call ['_strlen']
add ['esp,', '4']
lea ['eax,', '[esi+eax+5]']
mov ['[ebp+var_4074],', 'eax']
mov ['eax,', '[ebp+var_4074]']
push ['eax']
call ['_uprv_malloc_56']
add ['esp,', '4']
mov ['[ebp+Dest],', 'eax']
cmp ['[ebp+Dest],', '0']
jnz ['short', 'loc_5A5A']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_4074]']
push ['eax']
push ['offset', '??_C@_0DI@NAANFHLO@pkgdata?3?5Error?3?5Unable?5to?5alloca@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
push ['7']
call ['dword', 'ptr', 'ds:__imp__exit']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
mov ['edx,', '[ebp+Dest]']
push ['edx']
call ['_strcpy']
add ['esp,', '8']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+28h]']
push ['ecx']
call ['_strlen']
add ['esp,', '4']
mov ['edx,', '[ebp+arg_0]']
mov ['ecx,', '[edx+28h]']
movsx ['edx,', 'byte', 'ptr', '[ecx+eax-1]']
cmp ['edx,', '5Ch']
jnz ['short', 'loc_5A9B']
mov ['[ebp+Source],', 'offset', '??_C@_00CNPNBAHC@?$AA@']
jmp ['short', 'loc_5AA5']
mov ['[ebp+Source],', 'offset', '??_C@_01KICIPPFI@?2?$AA@']
mov ['eax,', '[ebp+Source]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+var_4080]']
push ['eax']
mov ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcat']
add ['esp,', '8']
mov ['eax,', '[ebp+Dest]']
push ['eax']
lea ['ecx,', '[ebp+var_24]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+4]']
push ['eax']
call ['_pkg_appendToList']
add ['esp,', '0Ch']
mov ['ecx,', '[ebp+arg_0]']
mov ['[ecx+4],', 'eax']
mov ['eax,', '[ebp+var_4050]']
mov ['[ebp+var_4044],', 'eax']
jmp ['loc_5764']
jmp ['loc_561A']
mov ['eax,', '[ebp+var_30]']
push ['eax']
call ['_T_FileStream_close']
add ['esp,', '4']
jmp ['loc_5572']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN42_0']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '4154h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN41_0']
dd ['offset', '$LN38_0']
dd ['0FFFFFFDCh,', '4']
dd ['offset', '$LN39_0']
dd ['0FFFFBFC8h,', '4000h']
dd ['offset', '$LN40_0']
assume ['cs:_rdata']
public ['??_C@_0DI@NAANFHLO@pkgdata?3?5Error?3?5Unable?5to?5alloca@']
assume ['cs:_rdata']
public ['??_C@_0JM@OGPADHEG@pkgdata?3?5Error?3?5absolute?5path?5en@']
db ["'t", 'supported.', 'Use', 'relative', 'paths', 'such', 'as', "',27h,'fur.res',27h,'", 'or', "',27h,'tr'"]
db ["'anslit%cfur.res',27h,'.',0Ah"]
db ["9,'Bad", 'path:', "',27h,'%s',27h,0Ah,0"]
assume ['cs:_rdata']
public ['??_C@_0EF@KKAOIKDN@?$CFs?3?$CFd?5?9?5malformed?5quoted?5line?5at@']
db ["'got", "',27h,'%c',27h,0Ah,0"]
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0CL@EDGDBDDC@?$CFs?3?$CFd?5?9?5missing?5trailing?5double?5@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CH@KPJKOLO@?$CFs?3?$CFd?5?9?5line?5too?5long?5?$CIover?5?$CFd?5c@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BF@CNPBAPEJ@Error?5opening?5?$DM?$CFs?$DO?4?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BJ@IOHHLMMD@?$CD?5pkgdata?3?5Reading?5?$CFs?4?4?6?$AA@']
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?strchr@@YAPADPADH@Z proc near		
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C0]']
mov ['ecx,', '30h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+Val]']
push ['eax']
mov ['ecx,', '[ebp+Str]']
push ['ecx']
call ['dword', 'ptr', 'ds:__imp__strchr']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['edi']
pop ['esi']
pop ['ebx']
add ['esp,', '0C0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_createOptMatchArch@@YAXPAD@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C0]']
mov ['ecx,', '30h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
?pkg_destroyOptMatchArch@@YAXPAD@Z proc	near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0C0h']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_C0]']
mov ['ecx,', '30h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_T_FileStream_file_exists']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_5E0E']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
call ['_T_FileStream_remove']
add ['esp,', '4']
movsx ['ecx,', 'al']
test ['ecx,', 'ecx']
jnz ['short', 'loc_5E0E']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
push ['offset', '??_C@_0CJ@OGOMALKJ@T_FileStream_remove?5failed?5to?5de@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '0Ch']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
pop ['edi']
pop ['esi']
pop ['ebx']
add ['esp,', '0C0h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CJ@OGOMALKJ@T_FileStream_remove?5failed?5to?5de@']
extrn ['_pkg_deleteList:near']
extrn ['_uprv_free_56:near']
extrn ['_u_errorName_56:near']
extrn ['_pkg_appendToList:near']
extrn ['_uprv_strdup_56:near']
extrn ['__imp__isalnum:near']
extrn ['__imp__isalpha:near']
extrn ['_uprv_malloc_56:near']
extrn ['_strlen:near']
extrn ['_memset:near']
extrn ['__imp__fprintf:near']
extrn ['__imp____iob_func:near']
extrn ['_u_parseArgs:near']
extrn ['@_RTC_CheckStackVars@8:near']
extrn ['__RTC_CheckEsp:near']
extrn ['__RTC_Shutdown:near']
extrn ['__RTC_InitBase:near']
extrn ['_writeObjectCode:near']
extrn ['_writeAssemblyCode:near']
extrn ['_checkAssemblyHeaderName:near']
extrn ['__imp__rename:near']
extrn ['__imp__remove:near']
extrn ['_T_FileStream_file_exists:near']
extrn ['_strcmp:near']
extrn ['_writePackageDatFile:near']
extrn ['_strcat:near']
extrn ['_strcpy:near']
extrn ['___security_cookie:near']
extrn ['@__security_check_cookie@4:near']
extrn ['__chkstk:near']
extrn ['_memset_0:near']
extrn ['__imp__sprintf:near']
extrn ['__imp__system:near']
extrn ['__imp__printf:near']
extrn ['_uprv_mkdir:near']
extrn ['_T_FileStream_close:near']
extrn ['_T_FileStream_eof:near']
extrn ['_T_FileStream_readLine:near']
extrn ['_T_FileStream_open:near']
extrn ['_isFileModTimeLater:near']
extrn ['__imp__strstr:near']
extrn ['_uprv_pathIsAbsolute_56:near']
extrn ['_getLongPathname:near']
extrn ['__imp__isspace:near']
extrn ['__imp__exit:near']
extrn ['__imp__strchr:near']
extrn ['_T_FileStream_remove:near']
end
