endp
_FT_Get_WinFNT_Header proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '18h']
push ['esi']
mov ['eax,', '0CCCCCCCCh']
mov ['[ebp+var_18],', 'eax']
mov ['[ebp+var_14],', 'eax']
mov ['[ebp+var_10],', 'eax']
mov ['[ebp+var_C],', 'eax']
mov ['[ebp+var_8],', 'eax']
mov ['[ebp+var_4],', 'eax']
cmp ['[ebp+arg_0],', '0']
jnz ['short', 'loc_A9']
push ['offset', '$SG7026']
push ['25h']
push ['23h']
call ['_FT_Throw']
add ['esp,', '0Ch']
or ['eax,', '23h']
jmp ['loc_1A5']
cmp ['[ebp+arg_4],', '0']
jnz ['short', 'loc_C8']
push ['offset', '$SG7028']
push ['28h']
push ['6']
call ['_FT_Throw']
add ['esp,', '0Ch']
or ['eax,', '6']
jmp ['loc_1A5']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+80h]']
mov ['edx,', '[ecx+2Ch]']
mov ['[ebp+var_C],', 'edx']
cmp ['[ebp+var_C],', '0FFFFFFFEh']
jnz ['short', 'loc_E6']
mov ['[ebp+var_C],', '0']
jmp ['short', 'loc_157']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_157']
mov ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[eax+60h]']
mov ['[ebp+var_10],', 'ecx']
mov ['[ebp+var_14],', '0']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx]']
cmp ['dword', 'ptr', '[eax+20h],', '0']
jz ['short', 'loc_129']
mov ['esi,', 'esp']
push ['offset', '$SG7050']
mov ['ecx,', '[ebp+var_10]']
push ['ecx']
mov ['edx,', '[ebp+var_10]']
mov ['eax,', '[edx]']
mov ['ecx,', '[eax+20h]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_14],', 'eax']
mov ['edx,', '[ebp+var_14]']
mov ['[ebp+var_C],', 'edx']
xor ['eax,', 'eax']
jnz ['short', 'loc_EC']
cmp ['[ebp+var_C],', '0']
jz ['short', 'loc_141']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_18],', 'ecx']
jmp ['short', 'loc_148']
mov ['[ebp+var_18],', '0FFFFFFFEh']
mov ['edx,', '[ebp+arg_0]']
mov ['eax,', '[edx+80h]']
mov ['ecx,', '[ebp+var_18]']
mov ['[eax+2Ch],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['[ebp+var_4],', 'edx']
xor ['eax,', 'eax']
jnz ['loc_C8']
cmp ['[ebp+var_4],', '0']
jz ['short', 'loc_18B']
mov ['esi,', 'esp']
mov ['ecx,', '[ebp+arg_4]']
push ['ecx']
mov ['edx,', '[ebp+arg_0]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax]']
call ['ecx']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_8],', 'eax']
jmp ['short', 'loc_1A2']
push ['offset', '$SG7058']
push ['2Fh']
push ['6']
call ['_FT_Throw']
add ['esp,', '0Ch']
or ['eax,', '6']
mov ['[ebp+var_8],', 'eax']
mov ['eax,', '[ebp+var_8]']
pop ['esi']
add ['esp,', '18h']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
assume ['cs:_rtc$IMZ']
assume ['cs:_rtc$TMZ']
extrn ['_FT_Throw:near']
extrn ['__RTC_CheckEsp:near']
extrn ['__RTC_InitBase:near']
extrn ['__RTC_Shutdown:near']
end
