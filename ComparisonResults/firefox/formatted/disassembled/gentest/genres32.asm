endp
_genres32	proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '30Ch']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_30C]']
mov ['ecx,', '0C3h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', 'dword', 'ptr', 'ds:___security_cookie']
xor ['eax,', 'ebp']
mov ['[ebp+var_4],', 'eax']
mov ['eax,', 'ds:??_C@_0BC@GCCPAB@ooooooooooooooooo?$AA@']
mov ['[ebp+var_1C],', 'eax']
mov ['ecx,', 'ds:dword_328']
mov ['[ebp+var_18],', 'ecx']
mov ['edx,', 'ds:dword_32C']
mov ['[ebp+var_14],', 'edx']
mov ['eax,', 'ds:dword_330']
mov ['[ebp+var_10],', 'eax']
mov ['cx,', 'ds:word_334']
mov ['[ebp+var_C],', 'cx']
xor ['eax,', 'eax']
mov ['[ebp+var_A],', 'ax']
mov ['eax,', '[ebp+Source]']
push ['eax']
lea ['ecx,', '[ebp+Dest]']
push ['ecx']
call ['_strcpy']
add ['esp,', '8']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strlen']
add ['esp,', '4']
movsx ['ecx,', '[ebp+eax+var_23D]']
cmp ['ecx,', '5Ch']
jz ['short', 'loc_9E']
push ['offset', '??_C@_01KICIPPFI@?2?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
push ['offset', '??_C@_0BA@JPJFPBFM@testtable32?4txt?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['_strcat']
add ['esp,', '8']
mov ['esi,', 'esp']
push ['offset', '??_C@_01NOFIACDB@w?$AA@']
lea ['eax,', '[ebp+Dest]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fopen']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+File],', 'eax']
mov ['esi,', 'esp']
push ['offset', '??_C@_0BL@GHFHLNEL@Generating?5testtable32?4txt?$AA@']
call ['dword', 'ptr', 'ds:__imp__puts']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
cmp ['[ebp+File],', '0']
jnz ['short', 'loc_135']
mov ['esi,', 'esp']
lea ['eax,', '[ebp+Dest]']
push ['eax']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
push ['offset', '??_C@_0CL@JEAIBBLK@?$CFs?3?5Couldn?8t?5create?5resource?5tes@']
mov ['edi,', 'esp']
call ['dword', 'ptr', 'ds:__imp____iob_func']
cmp ['edi,', 'esp']
call ['__RTC_CheckEsp']
add ['eax,', '40h']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '1']
jmp ['loc_236']
lea ['eax,', '[ebp+var_1C]']
mov ['[ebp+var_28],', 'eax']
jmp ['short', 'loc_146']
mov ['eax,', '[ebp+var_28]']
add ['eax,', '1']
mov ['[ebp+var_28],', 'eax']
mov ['eax,', '[ebp+var_28]']
movsx ['ecx,', 'byte', 'ptr', '[eax]']
test ['ecx,', 'ecx']
jz ['short', 'loc_152']
jmp ['short', 'loc_13D']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+File]']
push ['eax']
push ['offset', '??_C@_0O@KJAKBKEE@testtable32?5?$HL?$AA@']
call ['dword', 'ptr', 'ds:__imp__fputs']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['[ebp+var_34],', '0']
jmp ['short', 'loc_182']
mov ['eax,', '[ebp+var_34]']
add ['eax,', '1']
mov ['[ebp+var_34],', 'eax']
cmp ['[ebp+var_34],', '101D0h']
jge ['short', 'loc_1FD']
mov ['eax,', '[ebp+var_34]']
cdq
mov ['ecx,', '0Ah']
idiv ['ecx']
test ['edx,', 'edx']
jnz ['short', 'loc_1C2']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_34]']
push ['eax']
lea ['ecx,', '[ebp+var_1C]']
push ['ecx']
push ['offset', '??_C@_0O@OEPLGCEG@?$CFs?$HL?$CC?2U?$CF08x?$CC?$HN?6?$AA@']
mov ['edx,', '[ebp+File]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
jmp ['short', 'loc_1E8']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+var_34]']
push ['eax']
lea ['ecx,', '[ebp+var_1C]']
push ['ecx']
push ['offset', '??_C@_0M@ELGJOMJO@?$CFs?3int?$HL?$CFd?$HN?6?$AA@']
mov ['edx,', '[ebp+File]']
push ['edx']
call ['dword', 'ptr', 'ds:__imp__fprintf']
add ['esp,', '10h']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['eax,', '[ebp+var_28]']
push ['eax']
lea ['ecx,', '[ebp+var_1C]']
push ['ecx']
call ['_incKey']
add ['esp,', '8']
jmp ['loc_179']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+File]']
push ['eax']
push ['offset', '??_C@_01CELHOKLL@?$HN?$AA@']
call ['dword', 'ptr', 'ds:__imp__fputs']
add ['esp,', '8']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
mov ['esi,', 'esp']
mov ['eax,', '[ebp+File]']
push ['eax']
call ['dword', 'ptr', 'ds:__imp__fclose']
add ['esp,', '4']
cmp ['esi,', 'esp']
call ['__RTC_CheckEsp']
xor ['eax,', 'eax']
push ['edx']
mov ['ecx,', 'ebp']
push ['eax']
lea ['edx,', '$LN16']
call ['@_RTC_CheckStackVars@8']
pop ['eax']
pop ['edx']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['ecx,', '[ebp+var_4]']
xor ['ecx,', 'ebp']
call ['@__security_check_cookie@4']
add ['esp,', '30Ch']
cmp ['ebp,', 'esp']
call ['__RTC_CheckEsp']
mov ['esp,', 'ebp']
pop ['ebp']
retn
align ['4']
dd ['offset', '$LN15']
dd ['offset', '$LN13']
dd ['0FFFFFDC4h,', '200h']
dd ['offset', '$LN14']
align ['4']
assume ['cs:_rdata']
public ['??_C@_01CELHOKLL@?$HN?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0M@ELGJOMJO@?$CFs?3int?$HL?$CFd?$HN?6?$AA@']
assume ['cs:_rdata']
public ['??_C@_0O@OEPLGCEG@?$CFs?$HL?$CC?2U?$CF08x?$CC?$HN?6?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0O@KJAKBKEE@testtable32?5?$HL?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0CL@JEAIBBLK@?$CFs?3?5Couldn?8t?5create?5resource?5tes@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0BL@GHFHLNEL@Generating?5testtable32?4txt?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_01NOFIACDB@w?$AA@']
align ['10h']
assume ['cs:_rdata']
public ['??_C@_0BA@JPJFPBFM@testtable32?4txt?$AA@']
assume ['cs:_rdata']
public ['??_C@_01KICIPPFI@?2?$AA@']
align ['4']
assume ['cs:_rdata']
public ['??_C@_0BC@GCCPAB@ooooooooooooooooo?$AA@']
align ['4']
assume ['cs:_rtc$TMZ']
assume ['cs:_rtc$IMZ']
assume ['cs:_text']
assume ['es:nothing,', 'ss:nothing,', 'ds:_rdata,', 'fs:nothing,', 'gs:nothing']
endp
_incKey		proc near		
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0CCh']
push ['ebx']
push ['esi']
push ['edi']
lea ['edi,', '[ebp+var_CC]']
mov ['ecx,', '33h']
mov ['eax,', '0CCCCCCCCh']
rep ['stosd']
mov ['eax,', '[ebp+arg_4]']
cmp ['eax,', '[ebp+arg_0]']
jbe ['short', 'loc_392']
mov ['eax,', '[ebp+arg_4]']
sub ['eax,', '1']
mov ['[ebp+arg_4],', 'eax']
mov ['ecx,', '[ebp+arg_4]']
mov ['dl,', '[ecx]']
mov ['[ebp+var_5],', 'dl']
movsx ['eax,', '[ebp+var_5]']
cmp ['eax,', '6Fh']
jnz ['short', 'loc_38A']
mov ['eax,', '[ebp+arg_4]']
mov ['byte', 'ptr', '[eax],', '31h']
jmp ['short', 'loc_392']
jmp ['short', 'loc_390']
mov ['eax,', '[ebp+arg_4]']
mov ['byte', 'ptr', '[eax],', '6Fh']
jmp ['short', 'loc_35E']
pop ['edi']
pop ['esi']
pop ['ebx']
mov ['esp,', 'ebp']
pop ['ebp']
retn
extrn ['__imp__fclose:near']
extrn ['__imp__fputs:near']
extrn ['__imp__fprintf:near']
extrn ['__imp____iob_func:near']
extrn ['__imp__puts:near']
extrn ['__imp__fopen:near']
extrn ['_strcat:near']
extrn ['_strlen:near']
extrn ['_strcpy:near']
extrn ['___security_cookie:near']
extrn ['@__security_check_cookie@4:near']
extrn ['@_RTC_CheckStackVars@8:near']
extrn ['__RTC_CheckEsp:near']
extrn ['__RTC_Shutdown:near']
extrn ['__RTC_InitBase:near']
end
