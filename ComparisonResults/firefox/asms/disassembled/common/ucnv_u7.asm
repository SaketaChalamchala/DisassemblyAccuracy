;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	18EB1DF51FF202E1E7665AA5FDA8F21B
; Input	CRC32 :	6AC64EE4

; File Name   :	D:\compspace\objfiles\firefox\common\ucnv_u7.obj
; Format      :	COFF (X386MAGIC)
; includelib "msvcprtd"
; includelib "MSVCRTD"
; includelib "OLDNAMES"

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
_encodeDirectlyMaximum dd 2 dup(0)	; DATA XREF: __UTF7FromUnicodeWithOffsets+6Co
		dd 10100h, 100h, 4 dup(0)
dword_20	dd 2 dup(1010101h), 10101h, 0Ch	dup(1010101h), 1010100h
					; DATA XREF: .rdata:__IMAPImplo
		dd 7 dup(1010101h), 101h
_encodeDirectlyRestricted dd 2 dup(0)	; DATA XREF: __UTF7FromUnicodeWithOffsets:loc_C58o
		dd 10100h, 100h, 4 dup(0)
		dd 1, 1000000h,	101h, 3	dup(1010101h), 10101h, 1000000h
		dd 1010100h, 5 dup(1010101h), 10101h, 0
dword_E0	dd 1010100h, 5 dup(1010101h), 10101h, 0	; DATA XREF: .rdata:__UTF7Data_56o
					; .rdata:__IMAPData_56o
_toBase64	db 41h			; DATA XREF: __UTF7FromUnicodeWithOffsets+30Er
					; __UTF7FromUnicodeWithOffsets+3E0r ...
		db 42h,	43h, 44h
		dd 48474645h, 4C4B4A49h, 504F4E4Dh, 54535251h, 58575655h
		dd 62615A59h, 66656463h, 6A696867h, 6E6D6C6Bh, 7271706Fh
		dd 76757473h, 7A797877h, 33323130h, 37363534h, 2F2B3938h
_fromBase64	db 0FDh			; DATA XREF: __UTF7ToUnicodeWithOffsets+28Ar
					; __UTF7FromUnicodeWithOffsets+33Dr ...
		db 3 dup(0FDh)
		dd 0FDFDFDFDh, 0FDFFFFFDh, 0FDFDFFFDh, 4 dup(0FDFDFDFDh)
		dd 2 dup(0FFFFFFFFh), 3EFFFFFFh, 3FFFFEFFh, 37363534h
		dd 3B3A3938h, 0FFFF3D3Ch, 0FFFFFFFFh, 20100FFh,	6050403h
		dd 0A090807h, 0E0D0C0Bh, 1211100Fh, 16151413h, 0FF191817h
		dd 0FFFFFFFDh, 1C1B1AFFh, 201F1E1Dh, 24232221h,	28272625h
		dd 2C2B2A29h, 302F2E2Dh, 0FF333231h, 0FDFDFFFFh
__UTF7Impl	dd 1Bh,	0		; DATA XREF: .rdata:00000284o
		db 2 dup(0)
word_1CA	dw 0			; DATA XREF: .data:?__LINE__Var@?1??_UTF7FromUnicodeWithOffsets@@9@9@a23a0f5eo
		dd offset __UTF7Open
		dd 0
		dd offset __UTF7Reset
		dd offset __UTF7ToUnicodeWithOffsets
		dd offset __UTF7ToUnicodeWithOffsets
		dd offset __UTF7FromUnicodeWithOffsets
		dd offset __UTF7FromUnicodeWithOffsets
		align 10h
		dd offset __UTF7GetName
		dd 2 dup(0)
		dd offset _ucnv_getCompleteUnicodeSet_56
		dd 2 dup(0)
__UTF7StaticData dd offset dword_20+44h	; DATA XREF: .rdata:0000027Co
aUtf7		db 'UTF-7',0
		align 4
		dd 0Eh dup(0)
		dd 4011B00h, 3Fh, 1, 6 dup(0)
		public __UTF7Data_56
__UTF7Data_56	dd offset dword_E0+4
		dd 0FFFFFFFFh, 0
		dd offset __UTF7StaticData
		dd 0
		dd offset __UTF7Impl
		dd 34h dup(0)
__IMAPImpl	dd offset dword_20	; DATA XREF: .rdata:0000041Co
		dd 2 dup(0)
		dd offset __UTF7Open
		dd 0
		dd offset __UTF7Reset
		dd offset __IMAPToUnicodeWithOffsets
		dd offset __IMAPToUnicodeWithOffsets
		dd offset __IMAPFromUnicodeWithOffsets
		dd offset __IMAPFromUnicodeWithOffsets
		dd 5 dup(0)
		dd offset _ucnv_getCompleteUnicodeSet_56
		align 10h
__IMAPStaticData dd offset dword_20+44h	; DATA XREF: .rdata:00000414o
aImapMailboxNam	db 'IMAP-mailbox-name',0
		align 4
		dd 0Bh dup(0)
		dd 4012000h, 3Fh, 1, 6 dup(0)
		public __IMAPData_56
__IMAPData_56	dd offset dword_E0+4
		dd 0FFFFFFFFh, 0
		dd offset __IMAPStaticData
		dd 0
		dd offset __IMAPImpl
		dd 33h dup(0)
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 4ECh
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__UTF7Reset	proc near		; CODE XREF: __UTF7Open+44p
					; DATA XREF: .rdata:000001D4o ...

var_C0		= byte ptr -0C0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C0]
		mov	ecx, 30h ; '0'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_4], 1
		jg	short loc_521
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+2Ch], 1000000h
		mov	eax, [ebp+arg_0]
		mov	byte ptr [eax+24h], 0

loc_521:				; CODE XREF: __UTF7Reset+22j
		cmp	[ebp+arg_4], 1
		jz	short loc_53F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		and	ecx, 0F0000000h
		or	ecx, 1000000h
		mov	edx, [ebp+arg_0]
		mov	[edx+34h], ecx

loc_53F:				; CODE XREF: __UTF7Reset+39j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__UTF7Reset	endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$TMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$TMZ
		;org 548h
__RTC_Shutdown_rtc$TMZ dd offset __RTC_Shutdown
_rtc$TMZ	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$IMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$IMZ
		;org 54Ch
__RTC_InitBase_rtc$IMZ dd offset __RTC_InitBase
_rtc$IMZ	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 550h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__UTF7Open	proc near		; DATA XREF: .rdata:000001CCo
					; .rdata:00000364o

var_C0		= byte ptr -0C0h
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C0]
		mov	ecx, 30h ; '0'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		and	ecx, 0Fh
		cmp	ecx, 1
		ja	short loc_59E
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+1Ch]
		and	ecx, 0Fh
		shl	ecx, 1Ch
		mov	edx, [ebp+arg_0]
		mov	[edx+34h], ecx
		push	0
		mov	eax, [ebp+arg_0]
		push	eax
		call	__UTF7Reset
		add	esp, 8
		jmp	short loc_5A7
; ---------------------------------------------------------------------------

loc_59E:				; CODE XREF: __UTF7Open+2Aj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1

loc_5A7:				; CODE XREF: __UTF7Open+4Cj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0C0h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
__UTF7Open	endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 5BCh
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__UTF7ToUnicodeWithOffsets proc	near	; DATA XREF: .rdata:000001D8o
					; .rdata:000001DCo

var_19C		= dword	ptr -19Ch
var_D4		= dword	ptr -0D4h
var_C5		= byte ptr -0C5h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A1		= byte ptr -0A1h
var_95		= byte ptr -95h
var_89		= byte ptr -89h
var_80		= word ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_59		= byte ptr -59h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 19Ch
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_19C]
		mov	ecx, 67h ; 'g'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+18h]
		mov	[ebp+var_44], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+2Ch]
		mov	[ebp+var_D4], ecx
		mov	eax, [ebp+var_D4]
		shr	eax, 18h
		and	eax, 1
		mov	[ebp+var_95], al
		mov	eax, [ebp+var_D4]
		shr	eax, 10h
		mov	[ebp+var_89], al
		mov	ax, word ptr [ebp+var_D4]
		mov	[ebp+var_80], ax
		mov	eax, [ebp+var_8]
		add	eax, 25h ; '%'
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_8]
		mov	cl, [eax+24h]
		mov	[ebp+var_59], cl
		movzx	eax, [ebp+var_59]
		neg	eax
		sbb	eax, eax
		mov	[ebp+var_B0], eax
		mov	[ebp+var_BC], 0
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	$unicodeMode$7753

$directMode$7738:			; CODE XREF: __UTF7ToUnicodeWithOffsets+345j
					; __UTF7ToUnicodeWithOffsets+575j
		mov	[ebp+var_59], 0
		mov	eax, [ebp+var_20]
		sub	eax, [ebp+var_14]
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_38]
		sub	eax, [ebp+var_2C]
		sar	eax, 1
		mov	[ebp+var_74], eax
		mov	eax, [ebp+var_68]
		cmp	eax, [ebp+var_74]
		jle	short loc_6A7
		mov	eax, [ebp+var_74]
		mov	[ebp+var_68], eax

loc_6A7:				; CODE XREF: __UTF7ToUnicodeWithOffsets+E3j
					; __UTF7ToUnicodeWithOffsets+1F9j
		cmp	[ebp+var_68], 0
		jle	loc_7BA
		mov	eax, [ebp+var_14]
		mov	cl, [eax]
		mov	[ebp+var_C5], cl
		mov	edx, [ebp+var_14]
		add	edx, 1
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_C5]
		sub	eax, 20h ; ' '
		movzx	ecx, al
		cmp	ecx, 5Eh ; '^'
		jge	short loc_6E3
		movzx	eax, [ebp+var_C5]
		cmp	eax, 5Ch ; '\'
		jnz	short loc_729

loc_6E3:				; CODE XREF: __UTF7ToUnicodeWithOffsets+119j
		movzx	eax, [ebp+var_C5]
		cmp	eax, 0Dh
		jz	short loc_729
		movzx	eax, [ebp+var_C5]
		cmp	eax, 0Ah
		jz	short loc_729
		movzx	eax, [ebp+var_C5]
		cmp	eax, 9
		jz	short loc_729
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_C5]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	loc_7BA
; ---------------------------------------------------------------------------
		jmp	loc_7AC
; ---------------------------------------------------------------------------

loc_729:				; CODE XREF: __UTF7ToUnicodeWithOffsets+125j
					; __UTF7ToUnicodeWithOffsets+131j ...
		movzx	eax, [ebp+var_C5]
		cmp	eax, 2Bh ; '+'
		jz	short loc_777
		movzx	ax, [ebp+var_C5]
		mov	ecx, [ebp+var_2C]
		mov	[ecx], ax
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_775
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax

loc_775:				; CODE XREF: __UTF7ToUnicodeWithOffsets+194j
		jmp	short loc_7AC
; ---------------------------------------------------------------------------

loc_777:				; CODE XREF: __UTF7ToUnicodeWithOffsets+177j
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax
		mov	ecx, [ebp+var_B0]
		mov	[ebp+var_BC], ecx
		mov	[ebp+var_95], 0
		mov	[ebp+var_59], 0
		xor	eax, eax
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 0FFh
		jmp	short $unicodeMode$7753
; ---------------------------------------------------------------------------

loc_7AC:				; CODE XREF: __UTF7ToUnicodeWithOffsets+168j
					; __UTF7ToUnicodeWithOffsets:loc_775j
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		jmp	loc_6A7
; ---------------------------------------------------------------------------

loc_7BA:				; CODE XREF: __UTF7ToUnicodeWithOffsets+EFj
					; __UTF7ToUnicodeWithOffsets+163j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	short loc_7D3
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jb	short loc_7D3
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_7D3:				; CODE XREF: __UTF7ToUnicodeWithOffsets+204j
					; __UTF7ToUnicodeWithOffsets+20Cj
		jmp	loc_B48
; ---------------------------------------------------------------------------

$unicodeMode$7753:			; CODE XREF: __UTF7ToUnicodeWithOffsets+BFj
					; __UTF7ToUnicodeWithOffsets+1EEj ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	loc_B48
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_B38
		mov	eax, [ebp+var_14]
		mov	cl, [eax]
		mov	[ebp+var_C5], cl
		movzx	edx, [ebp+var_59]
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_C5]
		mov	[eax+edx], cl
		mov	dl, [ebp+var_59]
		add	dl, 1
		mov	[ebp+var_59], dl
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_BC]
		add	eax, 1
		mov	[ebp+var_BC], eax
		mov	[ebp+var_A1], 0FDh ; 'ý'
		movzx	eax, [ebp+var_C5]
		cmp	eax, 7Eh ; '~'
		jge	short loc_86E
		movzx	eax, [ebp+var_C5]
		mov	cl, _fromBase64[eax]
		mov	[ebp+var_A1], cl
		movsx	edx, [ebp+var_A1]
		cmp	edx, 0FFFFFFFDh
		jz	short loc_86E
		movsx	eax, [ebp+var_A1]
		cmp	eax, 0FFFFFFFFh
		jnz	loc_90B

loc_86E:				; CODE XREF: __UTF7ToUnicodeWithOffsets+281j
					; __UTF7ToUnicodeWithOffsets+2A0j
		mov	[ebp+var_95], 1
		movsx	eax, [ebp+var_89]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_8A4
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_50]
		mov	byte ptr [eax],	2Bh ; '+'
		mov	[ebp+var_59], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	loc_B48
; ---------------------------------------------------------------------------
		jmp	short loc_906
; ---------------------------------------------------------------------------

loc_8A4:				; CODE XREF: __UTF7ToUnicodeWithOffsets+2C3j
		movzx	eax, [ebp+var_80]
		test	eax, eax
		jz	short loc_8CD
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	al, [ebp+var_59]
		sub	al, 1
		mov	[ebp+var_59], al
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	loc_B48
; ---------------------------------------------------------------------------
		jmp	short loc_906
; ---------------------------------------------------------------------------

loc_8CD:				; CODE XREF: __UTF7ToUnicodeWithOffsets+2EEj
		movsx	eax, [ebp+var_A1]
		cmp	eax, 0FFFFFFFDh
		jnz	short loc_8E9
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	loc_B48
; ---------------------------------------------------------------------------
		jmp	short loc_906
; ---------------------------------------------------------------------------

loc_8E9:				; CODE XREF: __UTF7ToUnicodeWithOffsets+31Bj
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_BC]
		sub	eax, 1
		mov	[ebp+var_B0], eax
		jmp	$directMode$7738
; ---------------------------------------------------------------------------

loc_906:				; CODE XREF: __UTF7ToUnicodeWithOffsets+2E6j
					; __UTF7ToUnicodeWithOffsets+30Fj ...
		jmp	loc_B36
; ---------------------------------------------------------------------------

loc_90B:				; CODE XREF: __UTF7ToUnicodeWithOffsets+2ACj
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jl	loc_ACC
		movsx	eax, [ebp+var_89]
		mov	[ebp+var_19C], eax
		mov	ecx, [ebp+var_19C]
		add	ecx, 1
		mov	[ebp+var_19C], ecx
		cmp	[ebp+var_19C], 8 ; switch 9 cases
		ja	loc_ACA		; jumptable 00000949 default case
		mov	edx, [ebp+var_19C]
		jmp	ds:$LN46[edx*4]	; switch jump
; ---------------------------------------------------------------------------

$LN16:					; CODE XREF: __UTF7ToUnicodeWithOffsets+38Dj
					; DATA XREF: .text:$LN46o
		movsx	ax, [ebp+var_A1] ; jumptable 00000949 cases 0,1
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 1
		jmp	loc_ACA		; jumptable 00000949 default case
; ---------------------------------------------------------------------------

$LN15:					; CODE XREF: __UTF7ToUnicodeWithOffsets+38Dj
					; DATA XREF: .text:$LN46o
		movzx	eax, [ebp+var_80] ; jumptable 00000949 cases 2,4,5,7
		shl	eax, 6
		movsx	ecx, [ebp+var_A1]
		or	eax, ecx
		mov	[ebp+var_80], ax
		mov	al, [ebp+var_89]
		add	al, 1
		mov	[ebp+var_89], al
		jmp	loc_ACA		; jumptable 00000949 default case
; ---------------------------------------------------------------------------

$LN14:					; CODE XREF: __UTF7ToUnicodeWithOffsets+38Dj
					; DATA XREF: .text:$LN46o
		movzx	eax, [ebp+var_80] ; jumptable 00000949 case 3
		shl	eax, 4
		movsx	ecx, [ebp+var_A1]
		sar	ecx, 2
		or	eax, ecx
		mov	edx, [ebp+var_2C]
		mov	[edx], ax
		mov	eax, [ebp+var_2C]
		add	eax, 2
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_9DA
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		sub	eax, 1
		mov	[ebp+var_B0], eax

loc_9DA:				; CODE XREF: __UTF7ToUnicodeWithOffsets+3F9j
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_C5]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		movsx	eax, [ebp+var_A1]
		and	eax, 3
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 3
		jmp	loc_ACA		; jumptable 00000949 default case
; ---------------------------------------------------------------------------

$LN12:					; CODE XREF: __UTF7ToUnicodeWithOffsets+38Dj
					; DATA XREF: .text:$LN46o
		movzx	eax, [ebp+var_80] ; jumptable 00000949 case 6
		shl	eax, 2
		movsx	ecx, [ebp+var_A1]
		sar	ecx, 4
		or	eax, ecx
		mov	edx, [ebp+var_2C]
		mov	[edx], ax
		mov	eax, [ebp+var_2C]
		add	eax, 2
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_A4E
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		sub	eax, 1
		mov	[ebp+var_B0], eax

loc_A4E:				; CODE XREF: __UTF7ToUnicodeWithOffsets+46Dj
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_C5]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		movsx	eax, [ebp+var_A1]
		and	eax, 0Fh
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 6
		jmp	short loc_ACA	; jumptable 00000949 default case
; ---------------------------------------------------------------------------

$LN10:					; CODE XREF: __UTF7ToUnicodeWithOffsets+38Dj
					; DATA XREF: .text:$LN46o
		movzx	eax, [ebp+var_80] ; jumptable 00000949 case 8
		shl	eax, 6
		movsx	ecx, [ebp+var_A1]
		or	eax, ecx
		mov	edx, [ebp+var_2C]
		mov	[edx], ax
		mov	eax, [ebp+var_2C]
		add	eax, 2
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_AB9
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_B0], eax

loc_AB9:				; CODE XREF: __UTF7ToUnicodeWithOffsets+4DBj
		mov	[ebp+var_59], 0
		xor	eax, eax
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 0

loc_ACA:				; CODE XREF: __UTF7ToUnicodeWithOffsets+381j
					; __UTF7ToUnicodeWithOffsets+3A7j ...
		jmp	short loc_B36	; jumptable 00000949 default case
; ---------------------------------------------------------------------------

loc_ACC:				; CODE XREF: __UTF7ToUnicodeWithOffsets+358j
		mov	[ebp+var_95], 1
		movsx	eax, [ebp+var_89]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_B12
		mov	eax, 2Bh ; '+'
		mov	ecx, [ebp+var_2C]
		mov	[ecx], ax
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_B10
		mov	eax, [ebp+var_B0]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_B10:				; CODE XREF: __UTF7ToUnicodeWithOffsets+53Bj
		jmp	short loc_B25
; ---------------------------------------------------------------------------

loc_B12:				; CODE XREF: __UTF7ToUnicodeWithOffsets+521j
		movzx	eax, [ebp+var_80]
		test	eax, eax
		jz	short loc_B25
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	short loc_B48
; ---------------------------------------------------------------------------

loc_B25:				; CODE XREF: __UTF7ToUnicodeWithOffsets:loc_B10j
					; __UTF7ToUnicodeWithOffsets+55Cj
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_B0], eax
		jmp	$directMode$7738
; ---------------------------------------------------------------------------

loc_B36:				; CODE XREF: __UTF7ToUnicodeWithOffsets:loc_906j
					; __UTF7ToUnicodeWithOffsets:loc_ACAj
		jmp	short loc_B43
; ---------------------------------------------------------------------------

loc_B38:				; CODE XREF: __UTF7ToUnicodeWithOffsets+22Ej
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short loc_B48
; ---------------------------------------------------------------------------

loc_B43:				; CODE XREF: __UTF7ToUnicodeWithOffsets:loc_B36j
		jmp	$unicodeMode$7753
; ---------------------------------------------------------------------------

loc_B48:				; CODE XREF: __UTF7ToUnicodeWithOffsets:loc_7D3j
					; __UTF7ToUnicodeWithOffsets+222j ...
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jg	short loc_B6F
		mov	eax, [ebp+arg_0]
		movsx	ecx, byte ptr [eax+2]
		test	ecx, ecx
		jz	short loc_B6F
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnz	short loc_B6F
		movzx	eax, [ebp+var_80]
		test	eax, eax
		jnz	short loc_B6F
		mov	[ebp+var_59], 0

loc_B6F:				; CODE XREF: __UTF7ToUnicodeWithOffsets+592j
					; __UTF7ToUnicodeWithOffsets+59Dj ...
		movsx	eax, [ebp+var_95]
		shl	eax, 18h
		movzx	ecx, [ebp+var_89]
		shl	ecx, 10h
		or	eax, ecx
		movzx	edx, [ebp+var_80]
		or	eax, edx
		mov	ecx, [ebp+var_8]
		mov	[ecx+2Ch], eax
		mov	eax, [ebp+var_8]
		mov	cl, [ebp+var_59]
		mov	[eax+24h], cl
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[eax+8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_2C]
		mov	[eax+10h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_44]
		mov	[eax+18h], ecx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__UTF7ToUnicodeWithOffsets endp

; ---------------------------------------------------------------------------
$LN46		dd offset $LN16		; DATA XREF: __UTF7ToUnicodeWithOffsets+38Dr
		dd offset $LN16		; jump table for switch	statement
		dd offset $LN15
		dd offset $LN14
		dd offset $LN15
		dd offset $LN15
		dd offset $LN12
		dd offset $LN15
		dd offset $LN10
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 0BE0h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__UTF7FromUnicodeWithOffsets proc near	; DATA XREF: .rdata:000001E0o
					; .rdata:000001E4o

var_178		= dword	ptr -178h
var_B0		= dword	ptr -0B0h
var_A1		= byte ptr -0A1h
var_95		= byte ptr -95h
var_89		= byte ptr -89h
var_80		= dword	ptr -80h
var_74		= word ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 178h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_178]
		mov	ecx, 5Eh ; '^'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+18h]
		mov	[ebp+var_44], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		mov	[ebp+var_B0], ecx
		cmp	[ebp+var_B0], 10000000h
		jnb	short loc_C58
		mov	[ebp+var_178], offset _encodeDirectlyMaximum
		jmp	short loc_C62
; ---------------------------------------------------------------------------

loc_C58:				; CODE XREF: __UTF7FromUnicodeWithOffsets+6Aj
		mov	[ebp+var_178], offset _encodeDirectlyRestricted

loc_C62:				; CODE XREF: __UTF7FromUnicodeWithOffsets+76j
		mov	eax, [ebp+var_178]
		mov	[ebp+var_80], eax
		mov	eax, [ebp+var_B0]
		shr	eax, 18h
		and	eax, 1
		mov	[ebp+var_A1], al
		mov	eax, [ebp+var_B0]
		shr	eax, 10h
		mov	[ebp+var_95], al
		mov	al, byte ptr [ebp+var_B0]
		mov	[ebp+var_89], al
		movzx	eax, [ebp+var_89]
		cmp	eax, 40h ; '@'
		jbe	short loc_CCA
		mov	ecx, ds:?__LINE__Var@?1??_UTF7FromUnicodeWithOffsets@@9@9@a23a0f5e
		add	ecx, 20h ; ' '
		mov	esi, esp
		push	ecx		; Line
		push	offset ??_C@_1FI@ONKPPLIA@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@ ; "d:\\mozilla\\intl\\icu\\source\\common\"...
		push	offset ??_C@_1FG@DHKPIIEL@?$AAb?$AAi?$AAt?$AAs?$AA?$DM?$AA?$DN?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo?$AAB?$AAa?$AAs?$AAe?$AA6?$AA4?$AA?$CJ?$AA?1?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo@ ; "bits<=sizeof(toBase64)/sizeof(toBase64["...
		call	dword ptr ds:__imp___wassert
		add	esp, 0Ch
		cmp	esi, esp
		call	__RTC_CheckEsp

loc_CCA:				; CODE XREF: __UTF7FromUnicodeWithOffsets+C2j
		mov	[ebp+var_68], 0
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jz	$unicodeMode$7858

$directMode$7836:			; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_DD1j
					; __UTF7FromUnicodeWithOffsets:loc_F78j
		mov	eax, [ebp+var_20]
		sub	eax, [ebp+var_14]
		sar	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_38]
		sub	eax, [ebp+var_2C]
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_50]
		cmp	eax, [ebp+var_5C]
		jle	short loc_D02
		mov	eax, [ebp+var_5C]
		mov	[ebp+var_50], eax

loc_D02:				; CODE XREF: __UTF7FromUnicodeWithOffsets+11Aj
					; __UTF7FromUnicodeWithOffsets+27Bj
		cmp	[ebp+var_50], 0
		jle	loc_E60
		mov	eax, [ebp+var_14]
		mov	cx, [eax]
		mov	[ebp+var_74], cx
		mov	edx, [ebp+var_14]
		add	edx, 2
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_74]
		cmp	eax, 7Fh ; ''
		jg	short loc_D6D
		movzx	eax, [ebp+var_74]
		mov	ecx, [ebp+var_80]
		movsx	edx, byte ptr [ecx+eax]
		test	edx, edx
		jz	short loc_D6D
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_74]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_D68
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_D68:				; CODE XREF: __UTF7FromUnicodeWithOffsets+16Cj
		jmp	loc_E52
; ---------------------------------------------------------------------------

loc_D6D:				; CODE XREF: __UTF7FromUnicodeWithOffsets+146j
					; __UTF7FromUnicodeWithOffsets+155j
		movzx	eax, [ebp+var_74]
		cmp	eax, 2Bh ; '+'
		jnz	loc_E13
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Bh ; '+'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_DD8
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_DD1
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_DD1:				; CODE XREF: __UTF7FromUnicodeWithOffsets+1C4j
		jmp	$directMode$7836
; ---------------------------------------------------------------------------
		jmp	short loc_E11
; ---------------------------------------------------------------------------

loc_DD8:				; CODE XREF: __UTF7FromUnicodeWithOffsets+1AFj
		cmp	[ebp+var_44], 0
		jz	short loc_DF8
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_DF8:				; CODE XREF: __UTF7FromUnicodeWithOffsets+1FCj
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+4Ch], 2Dh	; '-'
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short loc_E60
; ---------------------------------------------------------------------------

loc_E11:				; CODE XREF: __UTF7FromUnicodeWithOffsets+1F6j
		jmp	short loc_E52
; ---------------------------------------------------------------------------

loc_E13:				; CODE XREF: __UTF7FromUnicodeWithOffsets+194j
		mov	eax, [ebp+var_14]
		sub	eax, 2
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Bh ; '+'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_E42
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_E42:				; CODE XREF: __UTF7FromUnicodeWithOffsets+24Fj
		mov	[ebp+var_A1], 0
		mov	[ebp+var_95], 0
		jmp	short $unicodeMode$7858
; ---------------------------------------------------------------------------

loc_E52:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_D68j
					; __UTF7FromUnicodeWithOffsets:loc_E11j
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_50], eax
		jmp	loc_D02
; ---------------------------------------------------------------------------

loc_E60:				; CODE XREF: __UTF7FromUnicodeWithOffsets+126j
					; __UTF7FromUnicodeWithOffsets+22Fj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	short loc_E79
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jb	short loc_E79
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_E79:				; CODE XREF: __UTF7FromUnicodeWithOffsets+286j
					; __UTF7FromUnicodeWithOffsets+28Ej
		jmp	loc_1399
; ---------------------------------------------------------------------------

$unicodeMode$7858:			; CODE XREF: __UTF7FromUnicodeWithOffsets+FAj
					; __UTF7FromUnicodeWithOffsets+270j ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	loc_1399
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_1389
		mov	eax, [ebp+var_14]
		mov	cx, [eax]
		mov	[ebp+var_74], cx
		mov	edx, [ebp+var_14]
		add	edx, 2
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_74]
		cmp	eax, 7Fh ; ''
		jg	loc_F82
		movzx	eax, [ebp+var_74]
		mov	ecx, [ebp+var_80]
		movsx	edx, byte ptr [ecx+eax]
		test	edx, edx
		jz	loc_F82
		mov	[ebp+var_A1], 1
		mov	eax, [ebp+var_14]
		sub	eax, 2
		mov	[ebp+var_14], eax
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	short loc_F19
		movzx	eax, [ebp+var_89]
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_F19
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_F19:				; CODE XREF: __UTF7FromUnicodeWithOffsets+302j
					; __UTF7FromUnicodeWithOffsets+323j
		movzx	eax, [ebp+var_74]
		movsx	ecx, _fromBase64[eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_F78
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_F5C
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_F5A
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_F5A:				; CODE XREF: __UTF7FromUnicodeWithOffsets+364j
		jmp	short loc_F78
; ---------------------------------------------------------------------------

loc_F5C:				; CODE XREF: __UTF7FromUnicodeWithOffsets+34Fj
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+4Ch], 2Dh	; '-'
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	loc_1399
; ---------------------------------------------------------------------------

loc_F78:				; CODE XREF: __UTF7FromUnicodeWithOffsets+347j
					; __UTF7FromUnicodeWithOffsets:loc_F5Aj
		jmp	$directMode$7836
; ---------------------------------------------------------------------------
		jmp	loc_1387
; ---------------------------------------------------------------------------

loc_F82:				; CODE XREF: __UTF7FromUnicodeWithOffsets+2D0j
					; __UTF7FromUnicodeWithOffsets+2E3j
		mov	al, [ebp+var_95]
		mov	byte ptr [ebp+var_178],	al
		cmp	byte ptr [ebp+var_178],	0
		jz	short loc_FB6
		cmp	byte ptr [ebp+var_178],	1
		jz	loc_108C
		cmp	byte ptr [ebp+var_178],	2
		jz	loc_1215
		jmp	loc_1387
; ---------------------------------------------------------------------------

loc_FB6:				; CODE XREF: __UTF7FromUnicodeWithOffsets+3B5j
		movzx	eax, [ebp+var_74]
		sar	eax, 0Ah
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_102A
		movzx	eax, [ebp+var_74]
		sar	eax, 4
		and	eax, 3Fh
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_1028
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1028:				; CODE XREF: __UTF7FromUnicodeWithOffsets+41Bj
		jmp	short loc_1070
; ---------------------------------------------------------------------------

loc_102A:				; CODE XREF: __UTF7FromUnicodeWithOffsets+3F7j
		cmp	[ebp+var_44], 0
		jz	short loc_104A
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_104A:				; CODE XREF: __UTF7FromUnicodeWithOffsets+44Ej
		movzx	eax, [ebp+var_74]
		sar	eax, 4
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Ch], dl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_1070:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_1028j
		movzx	eax, [ebp+var_74]
		and	eax, 0Fh
		shl	eax, 2
		mov	[ebp+var_89], al
		mov	[ebp+var_95], 1
		jmp	loc_1387
; ---------------------------------------------------------------------------

loc_108C:				; CODE XREF: __UTF7FromUnicodeWithOffsets+3BEj
		movzx	eax, [ebp+var_89]
		movzx	ecx, [ebp+var_74]
		sar	ecx, 0Eh
		or	eax, ecx
		mov	edx, [ebp+var_2C]
		mov	al, _toBase64[eax]
		mov	[edx], al
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_119D
		movzx	eax, [ebp+var_74]
		sar	eax, 8
		and	eax, 3Fh
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_1144
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_1142
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1142:				; CODE XREF: __UTF7FromUnicodeWithOffsets+524j
		jmp	short loc_119B
; ---------------------------------------------------------------------------

loc_1144:				; CODE XREF: __UTF7FromUnicodeWithOffsets+500j
		cmp	[ebp+var_44], 0
		jz	short loc_1175
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1175:				; CODE XREF: __UTF7FromUnicodeWithOffsets+568j
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Ch], dl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_119B:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_1142j
		jmp	short loc_11F9
; ---------------------------------------------------------------------------

loc_119D:				; CODE XREF: __UTF7FromUnicodeWithOffsets+4D6j
		cmp	[ebp+var_44], 0
		jz	short loc_11BD
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_11BD:				; CODE XREF: __UTF7FromUnicodeWithOffsets+5C1j
		movzx	eax, [ebp+var_74]
		sar	eax, 8
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Ch], dl
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Dh], dl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 2
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_11F9:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_119Bj
		movzx	eax, [ebp+var_74]
		and	eax, 3
		shl	eax, 4
		mov	[ebp+var_89], al
		mov	[ebp+var_95], 2
		jmp	loc_1387
; ---------------------------------------------------------------------------

loc_1215:				; CODE XREF: __UTF7FromUnicodeWithOffsets+3CBj
		movzx	eax, [ebp+var_89]
		movzx	ecx, [ebp+var_74]
		sar	ecx, 0Ch
		or	eax, ecx
		mov	edx, [ebp+var_2C]
		mov	al, _toBase64[eax]
		mov	[edx], al
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_1320
		movzx	eax, [ebp+var_74]
		sar	eax, 6
		and	eax, 3Fh
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_12CA
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_12C8
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_12C8:				; CODE XREF: __UTF7FromUnicodeWithOffsets+6AAj
		jmp	short loc_131E
; ---------------------------------------------------------------------------

loc_12CA:				; CODE XREF: __UTF7FromUnicodeWithOffsets+689j
		cmp	[ebp+var_44], 0
		jz	short loc_12FB
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_12FB:				; CODE XREF: __UTF7FromUnicodeWithOffsets+6EEj
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Ch], dl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_131E:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_12C8j
		jmp	short loc_1379
; ---------------------------------------------------------------------------

loc_1320:				; CODE XREF: __UTF7FromUnicodeWithOffsets+65Fj
		cmp	[ebp+var_44], 0
		jz	short loc_1340
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1340:				; CODE XREF: __UTF7FromUnicodeWithOffsets+744j
		movzx	eax, [ebp+var_74]
		sar	eax, 6
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Ch], dl
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	ecx, [ebp+var_8]
		mov	dl, _toBase64[eax]
		mov	[ecx+4Dh], dl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 2
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_1379:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_131Ej
		mov	[ebp+var_89], 0
		mov	[ebp+var_95], 0

loc_1387:				; CODE XREF: __UTF7FromUnicodeWithOffsets+39Dj
					; __UTF7FromUnicodeWithOffsets+3D1j ...
		jmp	short loc_1394
; ---------------------------------------------------------------------------

loc_1389:				; CODE XREF: __UTF7FromUnicodeWithOffsets+2B0j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short loc_1399
; ---------------------------------------------------------------------------

loc_1394:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_1387j
		jmp	$unicodeMode$7858
; ---------------------------------------------------------------------------

loc_1399:				; CODE XREF: __UTF7FromUnicodeWithOffsets:loc_E79j
					; __UTF7FromUnicodeWithOffsets+2A4j ...
		mov	eax, [ebp+arg_0]
		movsx	ecx, byte ptr [eax+2]
		test	ecx, ecx
		jz	loc_14B4
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jb	loc_14B4
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jnz	loc_149A
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	short loc_1440
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_140D
		movzx	eax, [ebp+var_89]
		mov	ecx, [ebp+var_2C]
		mov	dl, _toBase64[eax]
		mov	[ecx], dl
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		cmp	[ebp+var_44], 0
		jz	short loc_140B
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_140B:				; CODE XREF: __UTF7FromUnicodeWithOffsets+815j
		jmp	short loc_1440
; ---------------------------------------------------------------------------

loc_140D:				; CODE XREF: __UTF7FromUnicodeWithOffsets+7F4j
		movzx	eax, [ebp+var_89]
		mov	ecx, [ebp+var_8]
		movsx	edx, byte ptr [ecx+3Fh]
		mov	ecx, [ebp+var_8]
		mov	al, _toBase64[eax]
		mov	[ecx+edx+4Ch], al
		mov	ecx, [ebp+var_8]
		mov	dl, [ecx+3Fh]
		add	dl, 1
		mov	eax, [ebp+var_8]
		mov	[eax+3Fh], dl
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_1440:				; CODE XREF: __UTF7FromUnicodeWithOffsets+7ECj
					; __UTF7FromUnicodeWithOffsets:loc_140Bj
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_1473
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_1471
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_1471:				; CODE XREF: __UTF7FromUnicodeWithOffsets+87Bj
		jmp	short loc_149A
; ---------------------------------------------------------------------------

loc_1473:				; CODE XREF: __UTF7FromUnicodeWithOffsets+866j
		mov	eax, [ebp+var_8]
		movsx	ecx, byte ptr [eax+3Fh]
		mov	edx, [ebp+var_8]
		mov	byte ptr [edx+ecx+4Ch],	2Dh ; '-'
		mov	eax, [ebp+var_8]
		mov	cl, [eax+3Fh]
		add	cl, 1
		mov	edx, [ebp+var_8]
		mov	[edx+3Fh], cl
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_149A:				; CODE XREF: __UTF7FromUnicodeWithOffsets+7DDj
					; __UTF7FromUnicodeWithOffsets:loc_1471j
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		and	ecx, 0F0000000h
		or	ecx, 1000000h
		mov	edx, [ebp+var_8]
		mov	[edx+34h], ecx
		jmp	short loc_14E7
; ---------------------------------------------------------------------------

loc_14B4:				; CODE XREF: __UTF7FromUnicodeWithOffsets+7C2j
					; __UTF7FromUnicodeWithOffsets+7CEj
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		and	ecx, 0F0000000h
		movsx	edx, [ebp+var_A1]
		shl	edx, 18h
		or	ecx, edx
		movsx	eax, [ebp+var_95]
		shl	eax, 10h
		or	ecx, eax
		movzx	edx, [ebp+var_89]
		or	ecx, edx
		mov	eax, [ebp+var_8]
		mov	[eax+34h], ecx

loc_14E7:				; CODE XREF: __UTF7FromUnicodeWithOffsets+8D2j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[eax+8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_2C]
		mov	[eax+10h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_44]
		mov	[eax+18h], ecx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 178h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
__UTF7FromUnicodeWithOffsets endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1518h
		public ??_C@_1FG@DHKPIIEL@?$AAb?$AAi?$AAt?$AAs?$AA?$DM?$AA?$DN?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo?$AAB?$AAa?$AAs?$AAe?$AA6?$AA4?$AA?$CJ?$AA?1?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo@
; wchar_t `string'
??_C@_1FG@DHKPIIEL@?$AAb?$AAi?$AAt?$AAs?$AA?$DM?$AA?$DN?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo?$AAB?$AAa?$AAs?$AAe?$AA6?$AA4?$AA?$CJ?$AA?1?$AAs?$AAi?$AAz?$AAe?$AAo?$AAf?$AA?$CI?$AAt?$AAo@:
					; DATA XREF: __UTF7FromUnicodeWithOffsets+D5o
		unicode	0, <bits>
		dw 3Ch
		unicode	0, <=sizeof(toBase64)/sizeof(toBase64[0])>,0
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1570h
		public ??_C@_1FI@ONKPPLIA@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@
; wchar_t `string'
??_C@_1FI@ONKPPLIA@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@:
					; DATA XREF: __UTF7FromUnicodeWithOffsets+D0o
		unicode	0, <d:\mozilla\intl\icu\source\common\ucnv_u7.c>,0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 15C8h
		public ?__LINE__Var@?1??_UTF7FromUnicodeWithOffsets@@9@9@a23a0f5e
?__LINE__Var@?1??_UTF7FromUnicodeWithOffsets@@9@9@a23a0f5e dd offset word_1CA
					; DATA XREF: __UTF7FromUnicodeWithOffsets+C4r
_data		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 15CCh
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__UTF7GetName	proc near		; DATA XREF: .rdata:000001F0o

var_C4		= dword	ptr -0C4h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0C4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C4]
		mov	ecx, 31h ; '1'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		shr	ecx, 1Ch
		mov	[ebp+var_C4], ecx
		cmp	[ebp+var_C4], 1
		jz	short loc_1604
		jmp	short loc_160B
; ---------------------------------------------------------------------------

loc_1604:				; CODE XREF: __UTF7GetName+34j
		mov	eax, offset ??_C@_0BA@NPGHFHPO@UTF?97?0version?$DN1?$AA@ ; "UTF-7,version=1"
		jmp	short loc_1610
; ---------------------------------------------------------------------------

loc_160B:				; CODE XREF: __UTF7GetName+36j
		mov	eax, offset ??_C@_05MBAANMHF@UTF?97?$AA@ ; "UTF-7"

loc_1610:				; CODE XREF: __UTF7GetName+3Dj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__UTF7GetName	endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1618h
		public ??_C@_05MBAANMHF@UTF?97?$AA@
; `string'
??_C@_05MBAANMHF@UTF?97?$AA@ db	'UTF-7',0 ; DATA XREF: __UTF7GetName:loc_160Bo
		align 10h
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1620h
		public ??_C@_0BA@NPGHFHPO@UTF?97?0version?$DN1?$AA@
; `string'
??_C@_0BA@NPGHFHPO@UTF?97?0version?$DN1?$AA@ db	'UTF-7,version=1',0
					; DATA XREF: __UTF7GetName:loc_1604o
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1630h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__IMAPToUnicodeWithOffsets proc	near	; DATA XREF: .rdata:00000370o
					; .rdata:00000374o

var_1AC		= dword	ptr -1ACh
var_1A8		= dword	ptr -1A8h
var_E0		= dword	ptr -0E0h
var_D1		= byte ptr -0D1h
var_C8		= word ptr -0C8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A1		= byte ptr -0A1h
var_95		= byte ptr -95h
var_89		= byte ptr -89h
var_80		= word ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_59		= byte ptr -59h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1ACh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_1AC]
		mov	ecx, 6Bh ; 'k'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+18h]
		mov	[ebp+var_44], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+2Ch]
		mov	[ebp+var_E0], ecx
		mov	eax, [ebp+var_E0]
		shr	eax, 18h
		and	eax, 1
		mov	[ebp+var_95], al
		mov	eax, [ebp+var_E0]
		shr	eax, 10h
		mov	[ebp+var_89], al
		mov	ax, word ptr [ebp+var_E0]
		mov	[ebp+var_80], ax
		mov	eax, [ebp+var_8]
		add	eax, 25h ; '%'
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_8]
		mov	cl, [eax+24h]
		mov	[ebp+var_59], cl
		movzx	eax, [ebp+var_59]
		neg	eax
		sbb	eax, eax
		mov	[ebp+var_B0], eax
		mov	[ebp+var_BC], 0
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	$unicodeMode$8017

$directMode$8003:			; CODE XREF: __IMAPToUnicodeWithOffsets+5D8j
		mov	[ebp+var_59], 0
		mov	eax, [ebp+var_20]
		sub	eax, [ebp+var_14]
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_38]
		sub	eax, [ebp+var_2C]
		sar	eax, 1
		mov	[ebp+var_74], eax
		mov	eax, [ebp+var_68]
		cmp	eax, [ebp+var_74]
		jle	short loc_171B
		mov	eax, [ebp+var_74]
		mov	[ebp+var_68], eax

loc_171B:				; CODE XREF: __IMAPToUnicodeWithOffsets+E3j
					; __IMAPToUnicodeWithOffsets+1CFj
		cmp	[ebp+var_68], 0
		jle	loc_1804
		mov	eax, [ebp+var_14]
		mov	cl, [eax]
		mov	[ebp+var_D1], cl
		mov	edx, [ebp+var_14]
		add	edx, 1
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_D1]
		cmp	eax, 20h ; ' '
		jl	short loc_1751
		movzx	eax, [ebp+var_D1]
		cmp	eax, 7Eh ; '~'
		jle	short loc_1773

loc_1751:				; CODE XREF: __IMAPToUnicodeWithOffsets+113j
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_D1]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	loc_1804
; ---------------------------------------------------------------------------
		jmp	loc_17F6
; ---------------------------------------------------------------------------

loc_1773:				; CODE XREF: __IMAPToUnicodeWithOffsets+11Fj
		movzx	eax, [ebp+var_D1]
		cmp	eax, 26h ; '&'
		jz	short loc_17C1
		movzx	ax, [ebp+var_D1]
		mov	ecx, [ebp+var_2C]
		mov	[ecx], ax
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_17BF
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax

loc_17BF:				; CODE XREF: __IMAPToUnicodeWithOffsets+16Aj
		jmp	short loc_17F6
; ---------------------------------------------------------------------------

loc_17C1:				; CODE XREF: __IMAPToUnicodeWithOffsets+14Dj
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax
		mov	ecx, [ebp+var_B0]
		mov	[ebp+var_BC], ecx
		mov	[ebp+var_95], 0
		mov	[ebp+var_59], 0
		xor	eax, eax
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 0FFh
		jmp	short $unicodeMode$8017
; ---------------------------------------------------------------------------

loc_17F6:				; CODE XREF: __IMAPToUnicodeWithOffsets+13Ej
					; __IMAPToUnicodeWithOffsets:loc_17BFj
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	[ebp+var_68], eax
		jmp	loc_171B
; ---------------------------------------------------------------------------

loc_1804:				; CODE XREF: __IMAPToUnicodeWithOffsets+EFj
					; __IMAPToUnicodeWithOffsets+139j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	short loc_181D
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jb	short loc_181D
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_181D:				; CODE XREF: __IMAPToUnicodeWithOffsets+1DAj
					; __IMAPToUnicodeWithOffsets+1E2j
		jmp	$endloop$8037
; ---------------------------------------------------------------------------

$unicodeMode$8017:			; CODE XREF: __IMAPToUnicodeWithOffsets+BFj
					; __IMAPToUnicodeWithOffsets+1C4j ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	$endloop$8037
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_1C54
		mov	eax, [ebp+var_14]
		mov	cl, [eax]
		mov	[ebp+var_D1], cl
		movzx	edx, [ebp+var_59]
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_D1]
		mov	[eax+edx], cl
		mov	dl, [ebp+var_59]
		add	dl, 1
		mov	[ebp+var_59], dl
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_BC]
		add	eax, 1
		mov	[ebp+var_BC], eax
		movzx	eax, [ebp+var_D1]
		cmp	eax, 7Eh ; '~'
		jle	short loc_189C
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	$endloop$8037
; ---------------------------------------------------------------------------
		jmp	loc_1C52
; ---------------------------------------------------------------------------

loc_189C:				; CODE XREF: __IMAPToUnicodeWithOffsets+250j
		movzx	eax, [ebp+var_D1]
		cmp	eax, 2Ch ; ','
		jnz	short loc_18B4
		mov	[ebp+var_1A8], 3Fh ; '?'
		jmp	short loc_18EC
; ---------------------------------------------------------------------------

loc_18B4:				; CODE XREF: __IMAPToUnicodeWithOffsets+276j
		movzx	ecx, [ebp+var_D1]
		cmp	ecx, 2Fh ; '/'
		jnz	short loc_18CC
		mov	[ebp+var_1AC], 0FFFFFFFFh
		jmp	short loc_18E0
; ---------------------------------------------------------------------------

loc_18CC:				; CODE XREF: __IMAPToUnicodeWithOffsets+28Ej
		movzx	edx, [ebp+var_D1]
		movsx	eax, _fromBase64[edx]
		mov	[ebp+var_1AC], eax

loc_18E0:				; CODE XREF: __IMAPToUnicodeWithOffsets+29Aj
		mov	ecx, [ebp+var_1AC]
		mov	[ebp+var_1A8], ecx

loc_18EC:				; CODE XREF: __IMAPToUnicodeWithOffsets+282j
		mov	dl, byte ptr [ebp+var_1A8]
		mov	[ebp+var_A1], dl
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jl	loc_1B70
		movsx	eax, [ebp+var_89]
		mov	[ebp+var_1A8], eax
		mov	ecx, [ebp+var_1A8]
		add	ecx, 1
		mov	[ebp+var_1A8], ecx
		cmp	[ebp+var_1A8], 8 ; switch 9 cases
		ja	loc_1B6B	; jumptable 00001936 default case
		mov	edx, [ebp+var_1A8]
		jmp	ds:$LN51[edx*4]	; switch jump
; ---------------------------------------------------------------------------

$LN24:					; CODE XREF: __IMAPToUnicodeWithOffsets+306j
					; DATA XREF: .text:$LN51o
		movsx	ax, [ebp+var_A1] ; jumptable 00001936 cases 0,1
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 1
		jmp	loc_1B6B	; jumptable 00001936 default case
; ---------------------------------------------------------------------------

$LN23:					; CODE XREF: __IMAPToUnicodeWithOffsets+306j
					; DATA XREF: .text:$LN51o
		movzx	eax, [ebp+var_80] ; jumptable 00001936 cases 2,4,5,7
		shl	eax, 6
		movsx	ecx, [ebp+var_A1]
		or	eax, ecx
		mov	[ebp+var_80], ax
		mov	al, [ebp+var_89]
		add	al, 1
		mov	[ebp+var_89], al
		jmp	loc_1B6B	; jumptable 00001936 default case
; ---------------------------------------------------------------------------

$LN22:					; CODE XREF: __IMAPToUnicodeWithOffsets+306j
					; DATA XREF: .text:$LN51o
		movzx	eax, [ebp+var_80] ; jumptable 00001936 case 3
		shl	eax, 4
		movsx	ecx, [ebp+var_A1]
		sar	ecx, 2
		or	eax, ecx
		mov	[ebp+var_C8], ax
		movzx	eax, [ebp+var_C8]
		cmp	eax, 20h ; ' '
		jl	short loc_19C3
		movzx	eax, [ebp+var_C8]
		cmp	eax, 7Eh ; '~'
		jg	short loc_19C3
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	$endloop$8037
; ---------------------------------------------------------------------------

loc_19C3:				; CODE XREF: __IMAPToUnicodeWithOffsets+370j
					; __IMAPToUnicodeWithOffsets+37Cj
		mov	eax, [ebp+var_2C]
		mov	cx, [ebp+var_C8]
		mov	[eax], cx
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_1A02
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		sub	eax, 1
		mov	[ebp+var_B0], eax

loc_1A02:				; CODE XREF: __IMAPToUnicodeWithOffsets+3ADj
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_D1]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		movsx	eax, [ebp+var_A1]
		and	eax, 3
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 3
		jmp	loc_1B6B	; jumptable 00001936 default case
; ---------------------------------------------------------------------------

$LN19:					; CODE XREF: __IMAPToUnicodeWithOffsets+306j
					; DATA XREF: .text:$LN51o
		movzx	eax, [ebp+var_80] ; jumptable 00001936 case 6
		shl	eax, 2
		movsx	ecx, [ebp+var_A1]
		sar	ecx, 4
		or	eax, ecx
		mov	[ebp+var_C8], ax
		movzx	eax, [ebp+var_C8]
		cmp	eax, 20h ; ' '
		jl	short loc_1A72
		movzx	eax, [ebp+var_C8]
		cmp	eax, 7Eh ; '~'
		jg	short loc_1A72
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	$endloop$8037
; ---------------------------------------------------------------------------

loc_1A72:				; CODE XREF: __IMAPToUnicodeWithOffsets+41Fj
					; __IMAPToUnicodeWithOffsets+42Bj
		mov	eax, [ebp+var_2C]
		mov	cx, [ebp+var_C8]
		mov	[eax], cx
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_1AB1
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		sub	eax, 1
		mov	[ebp+var_B0], eax

loc_1AB1:				; CODE XREF: __IMAPToUnicodeWithOffsets+45Cj
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_D1]
		mov	[eax], cl
		mov	[ebp+var_59], 1
		movsx	eax, [ebp+var_A1]
		and	eax, 0Fh
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 6
		jmp	loc_1B6B	; jumptable 00001936 default case
; ---------------------------------------------------------------------------

$LN16_0:				; CODE XREF: __IMAPToUnicodeWithOffsets+306j
					; DATA XREF: .text:$LN51o
		movzx	eax, [ebp+var_80] ; jumptable 00001936 case 8
		shl	eax, 6
		movsx	ecx, [ebp+var_A1]
		or	eax, ecx
		mov	[ebp+var_C8], ax
		movzx	eax, [ebp+var_C8]
		cmp	eax, 20h ; ' '
		jl	short loc_1B1E
		movzx	eax, [ebp+var_C8]
		cmp	eax, 7Eh ; '~'
		jg	short loc_1B1E
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	$endloop$8037
; ---------------------------------------------------------------------------

loc_1B1E:				; CODE XREF: __IMAPToUnicodeWithOffsets+4CBj
					; __IMAPToUnicodeWithOffsets+4D7j
		mov	eax, [ebp+var_2C]
		mov	cx, [ebp+var_C8]
		mov	[eax], cx
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_1B5A
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_B0]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_B0], eax

loc_1B5A:				; CODE XREF: __IMAPToUnicodeWithOffsets+508j
		mov	[ebp+var_59], 0
		xor	eax, eax
		mov	[ebp+var_80], ax
		mov	[ebp+var_89], 0

loc_1B6B:				; CODE XREF: __IMAPToUnicodeWithOffsets+2FAj
					; __IMAPToUnicodeWithOffsets+320j ...
		jmp	loc_1C52	; jumptable 00001936 default case
; ---------------------------------------------------------------------------

loc_1B70:				; CODE XREF: __IMAPToUnicodeWithOffsets+2D1j
		movsx	eax, [ebp+var_A1]
		cmp	eax, 0FFFFFFFEh
		jnz	loc_1C0F
		mov	[ebp+var_95], 1
		movsx	eax, [ebp+var_89]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1BC6
		mov	eax, 26h ; '&'
		mov	ecx, [ebp+var_2C]
		mov	[ecx], ax
		mov	edx, [ebp+var_2C]
		add	edx, 2
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_1BC4
		mov	eax, [ebp+var_B0]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_1BC4:				; CODE XREF: __IMAPToUnicodeWithOffsets+57Bj
		jmp	short loc_1BFC
; ---------------------------------------------------------------------------

loc_1BC6:				; CODE XREF: __IMAPToUnicodeWithOffsets+561j
		movzx	eax, [ebp+var_80]
		test	eax, eax
		jnz	short loc_1BF1
		movsx	eax, [ebp+var_89]
		test	eax, eax
		jz	short loc_1BFC
		movsx	eax, [ebp+var_89]
		cmp	eax, 3
		jz	short loc_1BFC
		movsx	eax, [ebp+var_89]
		cmp	eax, 6
		jz	short loc_1BFC

loc_1BF1:				; CODE XREF: __IMAPToUnicodeWithOffsets+59Cj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	short $endloop$8037
; ---------------------------------------------------------------------------

loc_1BFC:				; CODE XREF: __IMAPToUnicodeWithOffsets:loc_1BC4j
					; __IMAPToUnicodeWithOffsets+5A7j ...
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_B0], eax
		jmp	$directMode$8003
; ---------------------------------------------------------------------------
		jmp	short loc_1C52
; ---------------------------------------------------------------------------

loc_1C0F:				; CODE XREF: __IMAPToUnicodeWithOffsets+54Aj
		movsx	eax, [ebp+var_89]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1C40
		mov	eax, [ebp+var_B0]
		sub	eax, 1
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+var_50]
		mov	byte ptr [eax],	26h ; '&'
		mov	eax, [ebp+var_50]
		mov	cl, [ebp+var_D1]
		mov	[eax+1], cl
		mov	[ebp+var_59], 2

loc_1C40:				; CODE XREF: __IMAPToUnicodeWithOffsets+5E9j
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Ch
		jmp	short $endloop$8037
; ---------------------------------------------------------------------------

loc_1C52:				; CODE XREF: __IMAPToUnicodeWithOffsets+267j
					; __IMAPToUnicodeWithOffsets:loc_1B6Bj	...
		jmp	short loc_1C5F
; ---------------------------------------------------------------------------

loc_1C54:				; CODE XREF: __IMAPToUnicodeWithOffsets+204j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short $endloop$8037
; ---------------------------------------------------------------------------

loc_1C5F:				; CODE XREF: __IMAPToUnicodeWithOffsets:loc_1C52j
		jmp	$unicodeMode$8017
; ---------------------------------------------------------------------------

$endloop$8037:				; CODE XREF: __IMAPToUnicodeWithOffsets:loc_181Dj
					; __IMAPToUnicodeWithOffsets+1F8j ...
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jg	short loc_1CB8
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jnz	short loc_1CB8
		movzx	eax, [ebp+var_59]
		test	eax, eax
		jnz	short loc_1CB8
		mov	eax, [ebp+arg_0]
		movsx	ecx, byte ptr [eax+2]
		test	ecx, ecx
		jz	short loc_1CB8
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jb	short loc_1CB8
		movsx	eax, [ebp+var_89]
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1CA8
		mov	eax, [ebp+var_50]
		mov	byte ptr [eax],	26h ; '&'
		mov	[ebp+var_59], 1

loc_1CA8:				; CODE XREF: __IMAPToUnicodeWithOffsets+66Cj
		mov	[ebp+var_95], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Bh

loc_1CB8:				; CODE XREF: __IMAPToUnicodeWithOffsets+63Aj
					; __IMAPToUnicodeWithOffsets+645j ...
		movsx	eax, [ebp+var_95]
		shl	eax, 18h
		movzx	ecx, [ebp+var_89]
		shl	ecx, 10h
		or	eax, ecx
		movzx	edx, [ebp+var_80]
		or	eax, edx
		mov	ecx, [ebp+var_8]
		mov	[ecx+2Ch], eax
		mov	eax, [ebp+var_8]
		mov	cl, [ebp+var_59]
		mov	[eax+24h], cl
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[eax+8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_2C]
		mov	[eax+10h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_44]
		mov	[eax+18h], ecx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__IMAPToUnicodeWithOffsets endp

; ---------------------------------------------------------------------------
		align 4
$LN51		dd offset $LN24		; DATA XREF: __IMAPToUnicodeWithOffsets+306r
		dd offset $LN24		; jump table for switch	statement
		dd offset $LN23
		dd offset $LN22
		dd offset $LN23
		dd offset $LN23
		dd offset $LN19
		dd offset $LN23
		dd offset $LN16_0
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1D2Ch
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

__IMAPFromUnicodeWithOffsets proc near	; DATA XREF: .rdata:00000378o
					; .rdata:0000037Co

var_178		= dword	ptr -178h
var_B0		= dword	ptr -0B0h
var_A1		= byte ptr -0A1h
var_95		= byte ptr -95h
var_89		= byte ptr -89h
var_7D		= byte ptr -7Dh
var_74		= word ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 178h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_178]
		mov	ecx, 5Eh ; '^'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0Ch]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+18h]
		mov	[ebp+var_44], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		mov	[ebp+var_B0], ecx
		mov	eax, [ebp+var_B0]
		shr	eax, 18h
		and	eax, 1
		mov	[ebp+var_A1], al
		mov	eax, [ebp+var_B0]
		shr	eax, 10h
		mov	[ebp+var_95], al
		mov	al, byte ptr [ebp+var_B0]
		mov	[ebp+var_89], al
		mov	[ebp+var_68], 0
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jz	$unicodeMode$8120

$directMode$8098:			; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_1EC3j
					; __IMAPFromUnicodeWithOffsets:loc_2079j
		mov	eax, [ebp+var_20]
		sub	eax, [ebp+var_14]
		sar	eax, 1
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_38]
		sub	eax, [ebp+var_2C]
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_50]
		cmp	eax, [ebp+var_5C]
		jle	short loc_1DF1
		mov	eax, [ebp+var_5C]
		mov	[ebp+var_50], eax

loc_1DF1:				; CODE XREF: __IMAPFromUnicodeWithOffsets+BDj
					; __IMAPFromUnicodeWithOffsets+221j
		cmp	[ebp+var_50], 0
		jle	loc_1F52
		mov	eax, [ebp+var_14]
		mov	cx, [eax]
		mov	[ebp+var_74], cx
		mov	edx, [ebp+var_14]
		add	edx, 2
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_74]
		cmp	eax, 20h ; ' '
		jl	short loc_1E5F
		movzx	eax, [ebp+var_74]
		cmp	eax, 7Eh ; '~'
		jg	short loc_1E5F
		movzx	eax, [ebp+var_74]
		cmp	eax, 26h ; '&'
		jz	short loc_1E5F
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_74]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_1E5A
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1E5A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+112j
		jmp	loc_1F44
; ---------------------------------------------------------------------------

loc_1E5F:				; CODE XREF: __IMAPFromUnicodeWithOffsets+E9j
					; __IMAPFromUnicodeWithOffsets+F2j ...
		movzx	eax, [ebp+var_74]
		cmp	eax, 26h ; '&'
		jnz	loc_1F05
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	26h ; '&'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_1ECA
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_1EC3
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1EC3:				; CODE XREF: __IMAPFromUnicodeWithOffsets+16Aj
		jmp	$directMode$8098
; ---------------------------------------------------------------------------
		jmp	short loc_1F03
; ---------------------------------------------------------------------------

loc_1ECA:				; CODE XREF: __IMAPFromUnicodeWithOffsets+155j
		cmp	[ebp+var_44], 0
		jz	short loc_1EEA
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_1EEA:				; CODE XREF: __IMAPFromUnicodeWithOffsets+1A2j
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+4Ch], 2Dh	; '-'
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short loc_1F52
; ---------------------------------------------------------------------------

loc_1F03:				; CODE XREF: __IMAPFromUnicodeWithOffsets+19Cj
		jmp	short loc_1F44
; ---------------------------------------------------------------------------

loc_1F05:				; CODE XREF: __IMAPFromUnicodeWithOffsets+13Aj
		mov	eax, [ebp+var_14]
		sub	eax, 2
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	26h ; '&'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_1F34
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_1F34:				; CODE XREF: __IMAPFromUnicodeWithOffsets+1F5j
		mov	[ebp+var_A1], 0
		mov	[ebp+var_95], 0
		jmp	short $unicodeMode$8120
; ---------------------------------------------------------------------------

loc_1F44:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_1E5Aj
					; __IMAPFromUnicodeWithOffsets:loc_1F03j
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_50], eax
		jmp	loc_1DF1
; ---------------------------------------------------------------------------

loc_1F52:				; CODE XREF: __IMAPFromUnicodeWithOffsets+C9j
					; __IMAPFromUnicodeWithOffsets+1D5j
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	short loc_1F6B
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jb	short loc_1F6B
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_1F6B:				; CODE XREF: __IMAPFromUnicodeWithOffsets+22Cj
					; __IMAPFromUnicodeWithOffsets+234j
		jmp	loc_2712
; ---------------------------------------------------------------------------

$unicodeMode$8120:			; CODE XREF: __IMAPFromUnicodeWithOffsets+9Dj
					; __IMAPFromUnicodeWithOffsets+216j ...
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jnb	loc_2712
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_2702
		mov	eax, [ebp+var_14]
		mov	cx, [eax]
		mov	[ebp+var_74], cx
		mov	edx, [ebp+var_14]
		add	edx, 2
		mov	[ebp+var_14], edx
		movzx	eax, [ebp+var_74]
		cmp	eax, 20h ; ' '
		jl	loc_2083
		movzx	eax, [ebp+var_74]
		cmp	eax, 7Eh ; '~'
		jg	loc_2083
		mov	[ebp+var_A1], 1
		mov	eax, [ebp+var_14]
		sub	eax, 2
		mov	[ebp+var_14], eax
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	short loc_202A
		movzx	eax, [ebp+var_89]
		cmp	eax, 3Fh ; '?'
		jge	short loc_1FF2
		movzx	ecx, [ebp+var_89]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_1FFC
; ---------------------------------------------------------------------------

loc_1FF2:				; CODE XREF: __IMAPFromUnicodeWithOffsets+2AEj
		mov	[ebp+var_178], 2Ch ; ','

loc_1FFC:				; CODE XREF: __IMAPFromUnicodeWithOffsets+2C4j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_202A
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_202A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+2A2j
					; __IMAPFromUnicodeWithOffsets+2E8j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_205D
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_205B
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_205B:				; CODE XREF: __IMAPFromUnicodeWithOffsets+319j
		jmp	short loc_2079
; ---------------------------------------------------------------------------

loc_205D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+304j
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+4Ch], 2Dh	; '-'
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	loc_2712
; ---------------------------------------------------------------------------

loc_2079:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_205Bj
		jmp	$directMode$8098
; ---------------------------------------------------------------------------
		jmp	loc_2700
; ---------------------------------------------------------------------------

loc_2083:				; CODE XREF: __IMAPFromUnicodeWithOffsets+276j
					; __IMAPFromUnicodeWithOffsets+283j
		mov	al, [ebp+var_95]
		mov	byte ptr [ebp+var_178],	al
		cmp	byte ptr [ebp+var_178],	0
		jz	short loc_20B7
		cmp	byte ptr [ebp+var_178],	1
		jz	loc_2208
		cmp	byte ptr [ebp+var_178],	2
		jz	loc_2491
		jmp	loc_2700
; ---------------------------------------------------------------------------

loc_20B7:				; CODE XREF: __IMAPFromUnicodeWithOffsets+36Aj
		movzx	eax, [ebp+var_74]
		sar	eax, 0Ah
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_20DD
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_20E7
; ---------------------------------------------------------------------------

loc_20DD:				; CODE XREF: __IMAPFromUnicodeWithOffsets+39Cj
		mov	[ebp+var_178], 2Ch ; ','

loc_20E7:				; CODE XREF: __IMAPFromUnicodeWithOffsets+3AFj
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_217D
		movzx	eax, [ebp+var_74]
		sar	eax, 4
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_212C
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_2136
; ---------------------------------------------------------------------------

loc_212C:				; CODE XREF: __IMAPFromUnicodeWithOffsets+3EBj
		mov	[ebp+var_178], 2Ch ; ','

loc_2136:				; CODE XREF: __IMAPFromUnicodeWithOffsets+3FEj
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_217B
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_217B:				; CODE XREF: __IMAPFromUnicodeWithOffsets+422j
		jmp	short loc_21EC
; ---------------------------------------------------------------------------

loc_217D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+3D5j
		cmp	[ebp+var_44], 0
		jz	short loc_219D
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_219D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+455j
		movzx	eax, [ebp+var_74]
		sar	eax, 4
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_21C6
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_21D0
; ---------------------------------------------------------------------------

loc_21C6:				; CODE XREF: __IMAPFromUnicodeWithOffsets+485j
		mov	[ebp+var_178], 2Ch ; ','

loc_21D0:				; CODE XREF: __IMAPFromUnicodeWithOffsets+498j
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Ch], cl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_21EC:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_217Bj
		movzx	eax, [ebp+var_74]
		and	eax, 0Fh
		shl	eax, 2
		mov	[ebp+var_89], al
		mov	[ebp+var_95], 1
		jmp	loc_2700
; ---------------------------------------------------------------------------

loc_2208:				; CODE XREF: __IMAPFromUnicodeWithOffsets+373j
		movzx	eax, [ebp+var_89]
		movzx	ecx, [ebp+var_74]
		sar	ecx, 0Eh
		or	eax, ecx
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2237
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_2241
; ---------------------------------------------------------------------------

loc_2237:				; CODE XREF: __IMAPFromUnicodeWithOffsets+4F6j
		mov	[ebp+var_178], 2Ch ; ','

loc_2241:				; CODE XREF: __IMAPFromUnicodeWithOffsets+509j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_23C7
		movzx	eax, [ebp+var_74]
		sar	eax, 8
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_228A
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_2294
; ---------------------------------------------------------------------------

loc_228A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+549j
		mov	[ebp+var_178], 2Ch ; ','

loc_2294:				; CODE XREF: __IMAPFromUnicodeWithOffsets+55Cj
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_2342
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_22DD
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_22E7
; ---------------------------------------------------------------------------

loc_22DD:				; CODE XREF: __IMAPFromUnicodeWithOffsets+59Cj
		mov	[ebp+var_178], 2Ch ; ','

loc_22E7:				; CODE XREF: __IMAPFromUnicodeWithOffsets+5AFj
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_233D
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_233D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+5D3j
		jmp	loc_23C2
; ---------------------------------------------------------------------------

loc_2342:				; CODE XREF: __IMAPFromUnicodeWithOffsets+582j
		cmp	[ebp+var_44], 0
		jz	short loc_2373
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_2373:				; CODE XREF: __IMAPFromUnicodeWithOffsets+61Aj
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_239C
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_23A6
; ---------------------------------------------------------------------------

loc_239C:				; CODE XREF: __IMAPFromUnicodeWithOffsets+65Bj
		mov	[ebp+var_178], 2Ch ; ','

loc_23A6:				; CODE XREF: __IMAPFromUnicodeWithOffsets+66Ej
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Ch], cl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_23C2:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_233Dj
		jmp	loc_2475
; ---------------------------------------------------------------------------

loc_23C7:				; CODE XREF: __IMAPFromUnicodeWithOffsets+52Fj
		cmp	[ebp+var_44], 0
		jz	short loc_23E7
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_23E7:				; CODE XREF: __IMAPFromUnicodeWithOffsets+69Fj
		movzx	eax, [ebp+var_74]
		sar	eax, 8
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2410
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_241A
; ---------------------------------------------------------------------------

loc_2410:				; CODE XREF: __IMAPFromUnicodeWithOffsets+6CFj
		mov	[ebp+var_178], 2Ch ; ','

loc_241A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+6E2j
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Ch], cl
		movzx	eax, [ebp+var_74]
		sar	eax, 2
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_244F
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_2459
; ---------------------------------------------------------------------------

loc_244F:				; CODE XREF: __IMAPFromUnicodeWithOffsets+70Ej
		mov	[ebp+var_178], 2Ch ; ','

loc_2459:				; CODE XREF: __IMAPFromUnicodeWithOffsets+721j
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Dh], cl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 2
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_2475:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_23C2j
		movzx	eax, [ebp+var_74]
		and	eax, 3
		shl	eax, 4
		mov	[ebp+var_89], al
		mov	[ebp+var_95], 2
		jmp	loc_2700
; ---------------------------------------------------------------------------

loc_2491:				; CODE XREF: __IMAPFromUnicodeWithOffsets+380j
		movzx	eax, [ebp+var_89]
		movzx	ecx, [ebp+var_74]
		sar	ecx, 0Ch
		or	eax, ecx
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_24C0
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_24CA
; ---------------------------------------------------------------------------

loc_24C0:				; CODE XREF: __IMAPFromUnicodeWithOffsets+77Fj
		mov	[ebp+var_178], 2Ch ; ','

loc_24CA:				; CODE XREF: __IMAPFromUnicodeWithOffsets+792j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_2647
		movzx	eax, [ebp+var_74]
		sar	eax, 6
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2513
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_251D
; ---------------------------------------------------------------------------

loc_2513:				; CODE XREF: __IMAPFromUnicodeWithOffsets+7D2j
		mov	[ebp+var_178], 2Ch ; ','

loc_251D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+7E5j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	loc_25C5
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2563
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_256D
; ---------------------------------------------------------------------------

loc_2563:				; CODE XREF: __IMAPFromUnicodeWithOffsets+822j
		mov	[ebp+var_178], 2Ch ; ','

loc_256D:				; CODE XREF: __IMAPFromUnicodeWithOffsets+835j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_25C3
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_25C3:				; CODE XREF: __IMAPFromUnicodeWithOffsets+859j
		jmp	short loc_2642
; ---------------------------------------------------------------------------

loc_25C5:				; CODE XREF: __IMAPFromUnicodeWithOffsets+80Bj
		cmp	[ebp+var_44], 0
		jz	short loc_25F6
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_25F6:				; CODE XREF: __IMAPFromUnicodeWithOffsets+89Dj
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_261C
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_2626
; ---------------------------------------------------------------------------

loc_261C:				; CODE XREF: __IMAPFromUnicodeWithOffsets+8DBj
		mov	[ebp+var_178], 2Ch ; ','

loc_2626:				; CODE XREF: __IMAPFromUnicodeWithOffsets+8EEj
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Ch], cl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 1
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_2642:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_25C3j
		jmp	loc_26F2
; ---------------------------------------------------------------------------

loc_2647:				; CODE XREF: __IMAPFromUnicodeWithOffsets+7B8j
		cmp	[ebp+var_44], 0
		jz	short loc_2667
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_68]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_2667:				; CODE XREF: __IMAPFromUnicodeWithOffsets+91Fj
		movzx	eax, [ebp+var_74]
		sar	eax, 6
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2690
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_269A
; ---------------------------------------------------------------------------

loc_2690:				; CODE XREF: __IMAPFromUnicodeWithOffsets+94Fj
		mov	[ebp+var_178], 2Ch ; ','

loc_269A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+962j
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Ch], cl
		movzx	eax, [ebp+var_74]
		and	eax, 3Fh
		mov	[ebp+var_7D], al
		movzx	eax, [ebp+var_7D]
		cmp	eax, 3Fh ; '?'
		jge	short loc_26CC
		movzx	ecx, [ebp+var_7D]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_26D6
; ---------------------------------------------------------------------------

loc_26CC:				; CODE XREF: __IMAPFromUnicodeWithOffsets+98Bj
		mov	[ebp+var_178], 2Ch ; ','

loc_26D6:				; CODE XREF: __IMAPFromUnicodeWithOffsets+99Ej
		mov	eax, [ebp+var_8]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax+4Dh], cl
		mov	eax, [ebp+var_8]
		mov	byte ptr [eax+3Fh], 2
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_26F2:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_2642j
		mov	[ebp+var_89], 0
		mov	[ebp+var_95], 0

loc_2700:				; CODE XREF: __IMAPFromUnicodeWithOffsets+352j
					; __IMAPFromUnicodeWithOffsets+386j ...
		jmp	short loc_270D
; ---------------------------------------------------------------------------

loc_2702:				; CODE XREF: __IMAPFromUnicodeWithOffsets+256j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh
		jmp	short loc_2712
; ---------------------------------------------------------------------------

loc_270D:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_2700j
		jmp	$unicodeMode$8120
; ---------------------------------------------------------------------------

loc_2712:				; CODE XREF: __IMAPFromUnicodeWithOffsets:loc_1F6Bj
					; __IMAPFromUnicodeWithOffsets+24Aj ...
		mov	eax, [ebp+arg_0]
		movsx	ecx, byte ptr [eax+2]
		test	ecx, ecx
		jz	loc_287B
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_20]
		jb	loc_287B
		movsx	eax, [ebp+var_A1]
		test	eax, eax
		jnz	loc_2861
		movsx	eax, [ebp+var_95]
		test	eax, eax
		jz	loc_2807
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_27AF
		movzx	eax, [ebp+var_89]
		cmp	eax, 3Fh ; '?'
		jge	short loc_2775
		movzx	ecx, [ebp+var_89]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_277F
; ---------------------------------------------------------------------------

loc_2775:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A31j
		mov	[ebp+var_178], 2Ch ; ','

loc_277F:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A47j
		mov	eax, [ebp+var_2C]
		mov	cl, byte ptr [ebp+var_178]
		mov	[eax], cl
		mov	edx, [ebp+var_2C]
		add	edx, 1
		mov	[ebp+var_2C], edx
		cmp	[ebp+var_44], 0
		jz	short loc_27AD
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_27AD:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A6Bj
		jmp	short loc_2807
; ---------------------------------------------------------------------------

loc_27AF:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A25j
		movzx	eax, [ebp+var_89]
		cmp	eax, 3Fh ; '?'
		jge	short loc_27D1
		movzx	ecx, [ebp+var_89]
		movzx	edx, _toBase64[ecx]
		mov	[ebp+var_178], edx
		jmp	short loc_27DB
; ---------------------------------------------------------------------------

loc_27D1:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A8Dj
		mov	[ebp+var_178], 2Ch ; ','

loc_27DB:				; CODE XREF: __IMAPFromUnicodeWithOffsets+AA3j
		mov	eax, [ebp+var_8]
		movsx	ecx, byte ptr [eax+3Fh]
		mov	edx, [ebp+var_8]
		mov	al, byte ptr [ebp+var_178]
		mov	[edx+ecx+4Ch], al
		mov	ecx, [ebp+var_8]
		mov	dl, [ecx+3Fh]
		add	dl, 1
		mov	eax, [ebp+var_8]
		mov	[eax+3Fh], dl
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_2807:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A19j
					; __IMAPFromUnicodeWithOffsets:loc_27ADj
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnb	short loc_283A
		mov	eax, [ebp+var_2C]
		mov	byte ptr [eax],	2Dh ; '-'
		mov	ecx, [ebp+var_2C]
		add	ecx, 1
		mov	[ebp+var_2C], ecx
		cmp	[ebp+var_44], 0
		jz	short loc_2838
		mov	eax, [ebp+var_68]
		sub	eax, 1
		mov	ecx, [ebp+var_44]
		mov	[ecx], eax
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx

loc_2838:				; CODE XREF: __IMAPFromUnicodeWithOffsets+AF6j
		jmp	short loc_2861
; ---------------------------------------------------------------------------

loc_283A:				; CODE XREF: __IMAPFromUnicodeWithOffsets+AE1j
		mov	eax, [ebp+var_8]
		movsx	ecx, byte ptr [eax+3Fh]
		mov	edx, [ebp+var_8]
		mov	byte ptr [edx+ecx+4Ch],	2Dh ; '-'
		mov	eax, [ebp+var_8]
		mov	cl, [eax+3Fh]
		add	cl, 1
		mov	edx, [ebp+var_8]
		mov	[edx+3Fh], cl
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 0Fh

loc_2861:				; CODE XREF: __IMAPFromUnicodeWithOffsets+A0Aj
					; __IMAPFromUnicodeWithOffsets:loc_2838j
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		and	ecx, 0F0000000h
		or	ecx, 1000000h
		mov	edx, [ebp+var_8]
		mov	[edx+34h], ecx
		jmp	short loc_28AE
; ---------------------------------------------------------------------------

loc_287B:				; CODE XREF: __IMAPFromUnicodeWithOffsets+9EFj
					; __IMAPFromUnicodeWithOffsets+9FBj
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+34h]
		and	ecx, 0F0000000h
		movsx	edx, [ebp+var_A1]
		shl	edx, 18h
		or	ecx, edx
		movsx	eax, [ebp+var_95]
		shl	eax, 10h
		or	ecx, eax
		movzx	edx, [ebp+var_89]
		or	ecx, edx
		mov	eax, [ebp+var_8]
		mov	[eax+34h], ecx

loc_28AE:				; CODE XREF: __IMAPFromUnicodeWithOffsets+B4Dj
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[eax+8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_2C]
		mov	[eax+10h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_44]
		mov	[eax+18h], ecx
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
__IMAPFromUnicodeWithOffsets endp

_text		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _ucnv_getCompleteUnicodeSet_56:near ; DATA XREF: .rdata:000001FCo
					; .rdata:00000394o
		extrn __RTC_Shutdown:near ; DATA XREF: .rtc$TMZ:__RTC_Shutdown_rtc$TMZo
		extrn __RTC_InitBase:near ; DATA XREF: .rtc$IMZ:__RTC_InitBase_rtc$IMZo
		extrn __RTC_CheckEsp:near ; CODE XREF: __UTF7Open+62p
					; __UTF7FromUnicodeWithOffsets+E5p ...
; void __cdecl __wassert(const wchar_t *Message, const wchar_t *File, unsigned int Line)
		extrn __imp___wassert:near ; CODE XREF:	__UTF7FromUnicodeWithOffsets+DAp
					; DATA XREF: __UTF7FromUnicodeWithOffsets+DAr


		end
