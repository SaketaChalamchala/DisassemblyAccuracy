;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	F13E34E7843F01FD7084D51E9F279B0F
; Input	CRC32 :	089113D1

; File Name   :	D:\compspace\objfiles\firefox\common\ubidiln.obj
; Format      :	COFF (X386MAGIC)
; includelib "msvcprtd"
; includelib "MSVCRTD"
; includelib "OLDNAMES"
;
; Exported entry
;

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_setLine_56
_ubidi_setLine_56 proc near

var_10C		= dword	ptr -10Ch
var_41		= byte ptr -41h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 10Ch
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_10C]
		mov	ecx, 43h ; 'C'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_10], 0
		jz	short loc_2C
		mov	eax, [ebp+arg_10]
		cmp	dword ptr [eax], 0
		jle	short loc_31

loc_2C:					; CODE XREF: _ubidi_setLine_56+22j
					; DATA XREF: .rdata:`string'o
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_31:					; CODE XREF: _ubidi_setLine_56+2Aj
		cmp	[ebp+arg_0], 0
		jz	short loc_41
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_4F

loc_41:					; CODE XREF: _ubidi_setLine_56+35j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1Bh
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_4F:					; CODE XREF: _ubidi_setLine_56+3Fj
		cmp	[ebp+arg_4], 0
		jl	short loc_5D
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+arg_8]
		jl	short loc_6B

loc_5D:					; CODE XREF: _ubidi_setLine_56+53j
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_6B:					; CODE XREF: _ubidi_setLine_56+5Bj
		cmp	[ebp+arg_8], 0
		jl	short loc_7F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		add	ecx, 1
		cmp	[ebp+arg_8], ecx
		jl	short loc_8D

loc_7F:					; CODE XREF: _ubidi_setLine_56+6Fj
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_8D:					; CODE XREF: _ubidi_setLine_56+7Dj
		cmp	[ebp+arg_C], 0
		jnz	short loc_A1
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_A1:					; CODE XREF: _ubidi_setLine_56+91j
		mov	eax, [ebp+arg_10]
		push	eax
		push	0
		push	0
		push	0
		mov	ecx, [ebp+arg_4]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_ubidi_getParagraph_56
		add	esp, 18h
		mov	esi, eax
		mov	eax, [ebp+arg_10]
		push	eax
		push	0
		push	0
		push	0
		mov	ecx, [ebp+arg_8]
		sub	ecx, 1
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_ubidi_getParagraph_56
		add	esp, 18h
		cmp	esi, eax
		jz	short loc_EC
		mov	eax, [ebp+arg_10]
		mov	dword ptr [eax], 1
		jmp	loc_41E
; ---------------------------------------------------------------------------

loc_EC:					; CODE XREF: _ubidi_setLine_56+DCj
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+arg_4]
		lea	eax, [ecx+edx*2]
		mov	ecx, [ebp+arg_C]
		mov	[ecx+8], eax
		mov	eax, [ebp+arg_8]
		sub	eax, [ebp+arg_4]
		mov	[ebp+var_10C], eax
		mov	ecx, [ebp+arg_C]
		mov	edx, [ebp+var_10C]
		mov	[ecx+10h], edx
		mov	eax, [ebp+var_10C]
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+var_8]
		mov	[eax+0Ch], ecx
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+var_8]
		mov	[edx+14h], eax
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+62h]
		test	ecx, ecx
		jz	short loc_170
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+8Ch]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax]
		jl	short loc_170
		mov	edx, [ebp+arg_4]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_ubidi_getParaLevelAtIndex_56
		add	esp, 8
		movzx	ecx, al
		mov	[ebp+var_10C], ecx
		jmp	short loc_17D
; ---------------------------------------------------------------------------

loc_170:				; CODE XREF: _ubidi_setLine_56+143j
					; _ubidi_setLine_56+153j
		mov	edx, [ebp+arg_0]
		movzx	eax, byte ptr [edx+61h]
		mov	[ebp+var_10C], eax

loc_17D:				; CODE XREF: _ubidi_setLine_56+16Ej
		mov	ecx, [ebp+arg_C]
		mov	dl, byte ptr [ebp+var_10C]
		mov	[ecx+61h], dl
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+88h]
		mov	[eax+88h], edx
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+0E4h], 0
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+7Ch], 0
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+58h]
		mov	[eax+58h], edx
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+5Ch]
		mov	[eax+5Ch], edx
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+160h], 0
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_271
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_14], eax
		jmp	short loc_1F8
; ---------------------------------------------------------------------------

loc_1EF:				; CODE XREF: _ubidi_setLine_56:loc_25Aj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax

loc_1F8:				; CODE XREF: _ubidi_setLine_56+1EDj
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_8]
		jge	short loc_25C
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_14]
		movzx	eax, word ptr [ecx+edx*2]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_245
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_14]
		movzx	eax, word ptr [ecx+edx*2]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_245
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_14]
		movzx	eax, word ptr [ecx+edx*2]
		sub	eax, 2066h
		cmp	eax, 4
		jnb	short loc_25A

loc_245:				; CODE XREF: _ubidi_setLine_56+215j
					; _ubidi_setLine_56+22Cj
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax+160h]
		add	ecx, 1
		mov	edx, [ebp+arg_C]
		mov	[edx+160h], ecx

loc_25A:				; CODE XREF: _ubidi_setLine_56+243j
		jmp	short loc_1EF
; ---------------------------------------------------------------------------

loc_25C:				; CODE XREF: _ubidi_setLine_56+1FEj
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_C]
		mov	edx, [eax+14h]
		sub	edx, [ecx+160h]
		mov	eax, [ebp+arg_C]
		mov	[eax+14h], edx

loc_271:				; CODE XREF: _ubidi_setLine_56+1E1j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4Ch]
		add	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[edx+4Ch], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		add	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[edx+50h], ecx
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+0E0h], 0FFFFFFFFh
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 2
		jz	short loc_304
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+78h]
		mov	[eax+78h], edx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+84h]
		cmp	ecx, [ebp+arg_4]
		jg	short loc_2CE
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+84h], 0
		jmp	short loc_2FF
; ---------------------------------------------------------------------------

loc_2CE:				; CODE XREF: _ubidi_setLine_56+2BDj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+84h]
		cmp	ecx, [ebp+arg_8]
		jge	short loc_2F3
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+84h]
		sub	ecx, [ebp+arg_4]
		mov	edx, [ebp+arg_C]
		mov	[edx+84h], ecx
		jmp	short loc_2FF
; ---------------------------------------------------------------------------

loc_2F3:				; CODE XREF: _ubidi_setLine_56+2DAj
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+var_8]
		mov	[eax+84h], ecx

loc_2FF:				; CODE XREF: _ubidi_setLine_56+2CCj
					; _ubidi_setLine_56+2F1j
		jmp	loc_416
; ---------------------------------------------------------------------------

loc_304:				; CODE XREF: _ubidi_setLine_56+2A3j
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax+50h]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_C]
		push	eax
		call	_setTrailingWSStart
		add	esp, 4
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax+84h]
		mov	[ebp+var_38], ecx
		cmp	[ebp+var_38], 0
		jnz	short loc_33D
		mov	eax, [ebp+arg_C]
		movzx	ecx, byte ptr [eax+61h]
		and	ecx, 1
		mov	edx, [ebp+arg_C]
		mov	[edx+78h], ecx
		jmp	short loc_3B7
; ---------------------------------------------------------------------------

loc_33D:				; CODE XREF: _ubidi_setLine_56+329j
		mov	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax]
		and	ecx, 1
		mov	[ebp+var_41], cl
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_8]
		jge	short loc_36F
		mov	eax, [ebp+arg_C]
		movzx	ecx, byte ptr [eax+61h]
		and	ecx, 1
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jz	short loc_36F
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+78h], 2
		jmp	short loc_3B7
; ---------------------------------------------------------------------------

loc_36F:				; CODE XREF: _ubidi_setLine_56+34Fj
					; _ubidi_setLine_56+361j
		mov	[ebp+var_2C], 1

loc_376:				; CODE XREF: _ubidi_setLine_56+3B5j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jnz	short loc_38C
		movzx	eax, [ebp+var_41]
		mov	ecx, [ebp+arg_C]
		mov	[ecx+78h], eax
		jmp	short loc_3B7
; ---------------------------------------------------------------------------
		jmp	short loc_3AC
; ---------------------------------------------------------------------------

loc_38C:				; CODE XREF: _ubidi_setLine_56+37Cj
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_2C]
		movzx	ecx, byte ptr [eax]
		and	ecx, 1
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jz	short loc_3AC
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+78h], 2
		jmp	short loc_3B7
; ---------------------------------------------------------------------------

loc_3AC:				; CODE XREF: _ubidi_setLine_56+38Aj
					; _ubidi_setLine_56+39Ej
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		jmp	short loc_376
; ---------------------------------------------------------------------------

loc_3B7:				; CODE XREF: _ubidi_setLine_56+33Bj
					; _ubidi_setLine_56+36Dj ...
		mov	eax, [ebp+arg_C]
		mov	ecx, [eax+78h]
		mov	[ebp+var_10C], ecx
		cmp	[ebp+var_10C], 0
		jz	short loc_3D7
		cmp	[ebp+var_10C], 1
		jz	short loc_3F9
		jmp	short loc_416
; ---------------------------------------------------------------------------

loc_3D7:				; CODE XREF: _ubidi_setLine_56+3CAj
		mov	eax, [ebp+arg_C]
		movzx	ecx, byte ptr [eax+61h]
		add	ecx, 1
		and	ecx, 0FFFFFFFEh
		mov	edx, [ebp+arg_C]
		mov	[edx+61h], cl
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+84h], 0
		jmp	short loc_416
; ---------------------------------------------------------------------------

loc_3F9:				; CODE XREF: _ubidi_setLine_56+3D3j
		mov	eax, [ebp+arg_C]
		movzx	ecx, byte ptr [eax+61h]
		or	ecx, 1
		mov	edx, [ebp+arg_C]
		mov	[edx+61h], cl
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax+84h], 0

loc_416:				; CODE XREF: _ubidi_setLine_56:loc_2FFj
					; _ubidi_setLine_56+3D5j ...
		mov	eax, [ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		mov	[eax], ecx

loc_41E:				; CODE XREF: _ubidi_setLine_56:loc_2Cj
					; _ubidi_setLine_56+4Aj ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10Ch
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_setLine_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$TMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$TMZ
		;org 434h
__RTC_Shutdown_rtc$TMZ dd offset __RTC_Shutdown
_rtc$TMZ	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$IMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$IMZ
		;org 438h
__RTC_InitBase_rtc$IMZ dd offset __RTC_InitBase
_rtc$IMZ	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 43Ch
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_setTrailingWSStart proc near		; CODE XREF: _ubidi_setLine_56+311p

var_F0		= byte ptr -0F0h
var_29		= byte ptr -29h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0F0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_F0]
		mov	ecx, 3Ch ; '<'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4Ch]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		mov	cl, [eax+61h]
		mov	[ebp+var_29], cl
		mov	eax, [ebp+var_8]
		add	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax-1]
		cmp	ecx, 7
		jnz	short loc_49B
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_20]
		mov	[eax+84h], ecx
		jmp	short loc_4F4
; ---------------------------------------------------------------------------

loc_49B:				; CODE XREF: _setTrailingWSStart+4Fj
					; _setTrailingWSStart+87j
		cmp	[ebp+var_20], 0
		jle	short loc_4C5
		mov	eax, [ebp+var_8]
		add	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax-1]
		mov	edx, 1
		shl	edx, cl
		and	edx, 7DDB80h
		jz	short loc_4C5
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_20], eax
		jmp	short loc_49B
; ---------------------------------------------------------------------------

loc_4C5:				; CODE XREF: _setTrailingWSStart+63j
					; _setTrailingWSStart+7Cj ...
		cmp	[ebp+var_20], 0
		jle	short loc_4E8
		mov	eax, [ebp+var_14]
		add	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax-1]
		movzx	edx, [ebp+var_29]
		cmp	ecx, edx
		jnz	short loc_4E8
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_20], eax
		jmp	short loc_4C5
; ---------------------------------------------------------------------------

loc_4E8:				; CODE XREF: _setTrailingWSStart+8Dj
					; _setTrailingWSStart+9Fj
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_20]
		mov	[eax+84h], ecx

loc_4F4:				; CODE XREF: _setTrailingWSStart+5Dj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_setTrailingWSStart endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 4FCh
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getLevelAt_56
_ubidi_getLevelAt_56 proc near

var_C4		= dword	ptr -0C4h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0C4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C4]
		mov	ecx, 31h ; '1'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_0], 0
		jz	short loc_551
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_540
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_551
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_551

loc_540:				; CODE XREF: _ubidi_getLevelAt_56+2Cj
		cmp	[ebp+arg_4], 0
		jl	short loc_551
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		cmp	ecx, [ebp+arg_4]
		jg	short loc_557

loc_551:				; CODE XREF: _ubidi_getLevelAt_56+22j
					; _ubidi_getLevelAt_56+34j ...
		xor	al, al
		jmp	short loc_5C7
; ---------------------------------------------------------------------------
		jmp	short loc_5C7
; ---------------------------------------------------------------------------

loc_557:				; CODE XREF: _ubidi_getLevelAt_56+53j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 2
		jnz	short loc_56E
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+84h]
		jl	short loc_5BB

loc_56E:				; CODE XREF: _ubidi_getLevelAt_56+62j
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+62h]
		test	ecx, ecx
		jz	short loc_5A4
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+8Ch]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax]
		jl	short loc_5A4
		mov	edx, [ebp+arg_4]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_ubidi_getParaLevelAtIndex_56
		add	esp, 8
		movzx	ecx, al
		mov	[ebp+var_C4], ecx
		jmp	short loc_5B1
; ---------------------------------------------------------------------------

loc_5A4:				; CODE XREF: _ubidi_getLevelAt_56+7Bj
					; _ubidi_getLevelAt_56+8Bj
		mov	edx, [ebp+arg_0]
		movzx	eax, byte ptr [edx+61h]
		mov	[ebp+var_C4], eax

loc_5B1:				; CODE XREF: _ubidi_getLevelAt_56+A6j
		mov	al, byte ptr [ebp+var_C4]
		jmp	short loc_5C7
; ---------------------------------------------------------------------------
		jmp	short loc_5C7
; ---------------------------------------------------------------------------

loc_5BB:				; CODE XREF: _ubidi_getLevelAt_56+70j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	edx, [ebp+arg_4]
		mov	al, [ecx+edx]

loc_5C7:				; CODE XREF: _ubidi_getLevelAt_56+57j
					; _ubidi_getLevelAt_56+59j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0C4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getLevelAt_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 5DCh
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getLevels_56
_ubidi_getLevels_56 proc near

var_E4		= byte ptr -0E4h
Dst		= dword	ptr -20h
var_14		= dword	ptr -14h
Size		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0E4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_E4]
		mov	ecx, 39h ; '9'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_4], 0
		jz	short loc_608
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jle	short loc_60F

loc_608:				; CODE XREF: _ubidi_getLevels_56+22j
		xor	eax, eax
		jmp	loc_733
; ---------------------------------------------------------------------------

loc_60F:				; CODE XREF: _ubidi_getLevels_56+2Aj
		cmp	[ebp+arg_0], 0
		jz	short loc_635
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_645
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_635
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jz	short loc_645

loc_635:				; CODE XREF: _ubidi_getLevels_56+37j
					; _ubidi_getLevels_56+49j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1Bh
		xor	eax, eax
		jmp	loc_733
; ---------------------------------------------------------------------------

loc_645:				; CODE XREF: _ubidi_getLevels_56+41j
					; _ubidi_getLevels_56+57j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_14], ecx
		cmp	[ebp+var_14], 0
		jg	short loc_664
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1
		xor	eax, eax
		jmp	loc_733
; ---------------------------------------------------------------------------

loc_664:				; CODE XREF: _ubidi_getLevels_56+76j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+84h]
		mov	[ebp+Size], ecx
		mov	edx, [ebp+Size]
		cmp	edx, [ebp+var_14]
		jnz	short loc_683
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+50h]
		jmp	loc_733
; ---------------------------------------------------------------------------

loc_683:				; CODE XREF: _ubidi_getLevels_56+9Aj
		mov	eax, [ebp+var_14]
		push	eax
		mov	ecx, [ebp+arg_0]
		movzx	edx, byte ptr [ecx+48h]
		push	edx
		mov	eax, [ebp+arg_0]
		add	eax, 1Ch
		push	eax
		mov	ecx, [ebp+arg_0]
		add	ecx, 34h ; '4'
		push	ecx
		call	_ubidi_getMemory_56
		add	esp, 10h
		movsx	edx, al
		test	edx, edx
		jz	short loc_728
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+34h]
		mov	[ebp+Dst], ecx
		cmp	[ebp+Size], 0
		jle	short loc_6EE
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+Dst]
		cmp	ecx, [eax+50h]
		jz	short loc_6EE
		push	1
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		push	ecx
		call	_uprv_checkValidMemory
		add	esp, 8
		mov	edx, [ebp+Size]
		push	edx		; Size
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		push	ecx		; Src
		mov	edx, [ebp+Dst]
		push	edx		; Dst
		call	_memcpy
		add	esp, 0Ch

loc_6EE:				; CODE XREF: _ubidi_getLevels_56+DDj
					; _ubidi_getLevels_56+E8j
		mov	eax, [ebp+var_14]
		sub	eax, [ebp+Size]
		push	eax		; Size
		mov	ecx, [ebp+arg_0]
		movzx	edx, byte ptr [ecx+61h]
		push	edx		; Val
		mov	eax, [ebp+Dst]
		add	eax, [ebp+Size]
		push	eax		; Dst
		call	_memset
		add	esp, 0Ch
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_14]
		mov	[eax+84h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+Dst]
		mov	[eax+50h], ecx
		mov	eax, [ebp+Dst]
		jmp	short loc_733
; ---------------------------------------------------------------------------
		jmp	short loc_733
; ---------------------------------------------------------------------------

loc_728:				; CODE XREF: _ubidi_getLevels_56+CEj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 7
		xor	eax, eax

loc_733:				; CODE XREF: _ubidi_getLevels_56+2Ej
					; _ubidi_getLevels_56+64j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0E4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getLevels_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 748h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getLogicalRun_56
_ubidi_getLogicalRun_56	proc near

var_124		= dword	ptr -124h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_48		= dword	ptr -48h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_24		= dword	ptr -24h
var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 124h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_124]
		mov	ecx, 49h ; 'I'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	[ebp+var_C], 0
		cmp	[ebp+arg_4], 0
		jl	short loc_788
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+10h]
		jl	short loc_794

loc_788:				; CODE XREF: _ubidi_getLogicalRun_56+33j
		mov	[ebp+var_C], 1
		jmp	loc_8EC
; ---------------------------------------------------------------------------

loc_794:				; CODE XREF: _ubidi_getLogicalRun_56+3Ej
		lea	eax, [ebp+var_C]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_countRuns_56
		add	esp, 8
		mov	[ebp+var_18], eax
		cmp	[ebp+var_C], 0
		jle	short loc_7B2
		jmp	loc_8EC
; ---------------------------------------------------------------------------

loc_7B2:				; CODE XREF: _ubidi_getLogicalRun_56+63j
		mov	[ebp+var_30], 0
		mov	eax, [ebp+var_30]
		mov	[ebp+var_24], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	edx, [ecx]
		mov	[ebp+var_5C], edx
		mov	eax, [ecx+4]
		mov	[ebp+var_58], eax
		mov	ecx, [ecx+8]
		mov	[ebp+var_54], ecx
		mov	[ebp+var_48], 0
		jmp	short loc_7EB
; ---------------------------------------------------------------------------

loc_7E2:				; CODE XREF: _ubidi_getLogicalRun_56+FCj
		mov	eax, [ebp+var_48]
		add	eax, 1
		mov	[ebp+var_48], eax

loc_7EB:				; CODE XREF: _ubidi_getLogicalRun_56+98j
		mov	eax, [ebp+var_48]
		cmp	eax, [ebp+var_18]
		jge	short loc_846
		mov	eax, [ebp+var_48]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		add	edx, eax
		mov	eax, [edx]
		mov	[ebp+var_5C], eax
		mov	ecx, [edx+4]
		mov	[ebp+var_58], ecx
		mov	edx, [edx+8]
		mov	[ebp+var_54], edx
		mov	eax, [ebp+var_5C]
		and	eax, 7FFFFFFFh
		mov	[ebp+var_3C], eax
		mov	eax, [ebp+var_3C]
		add	eax, [ebp+var_58]
		sub	eax, [ebp+var_24]
		mov	[ebp+var_30], eax
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_3C]
		jl	short loc_83E
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_30]
		jge	short loc_83E
		jmp	short loc_846
; ---------------------------------------------------------------------------

loc_83E:				; CODE XREF: _ubidi_getLogicalRun_56+EAj
					; _ubidi_getLogicalRun_56+F2j
		mov	eax, [ebp+var_58]
		mov	[ebp+var_24], eax
		jmp	short loc_7E2
; ---------------------------------------------------------------------------

loc_846:				; CODE XREF: _ubidi_getLogicalRun_56+A9j
					; _ubidi_getLogicalRun_56+F4j
		cmp	[ebp+arg_8], 0
		jz	short loc_854
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+var_30]
		mov	[eax], ecx

loc_854:				; CODE XREF: _ubidi_getLogicalRun_56+102j
		cmp	[ebp+arg_C], 0
		jz	loc_8EC
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+58h], 3
		jnz	short loc_874
		mov	eax, [ebp+var_5C]
		shr	eax, 1Fh
		mov	ecx, [ebp+arg_C]
		mov	[ecx], al
		jmp	short loc_8EC
; ---------------------------------------------------------------------------

loc_874:				; CODE XREF: _ubidi_getLogicalRun_56+11Dj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 2
		jnz	short loc_88B
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+84h]
		jl	short loc_8DB

loc_88B:				; CODE XREF: _ubidi_getLogicalRun_56+133j
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+62h]
		test	ecx, ecx
		jz	short loc_8C1
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+8Ch]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax]
		jl	short loc_8C1
		mov	edx, [ebp+arg_4]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_ubidi_getParaLevelAtIndex_56
		add	esp, 8
		movzx	ecx, al
		mov	[ebp+var_124], ecx
		jmp	short loc_8CE
; ---------------------------------------------------------------------------

loc_8C1:				; CODE XREF: _ubidi_getLogicalRun_56+14Cj
					; _ubidi_getLogicalRun_56+15Cj
		mov	edx, [ebp+arg_0]
		movzx	eax, byte ptr [edx+61h]
		mov	[ebp+var_124], eax

loc_8CE:				; CODE XREF: _ubidi_getLogicalRun_56+177j
		mov	ecx, [ebp+arg_C]
		mov	dl, byte ptr [ebp+var_124]
		mov	[ecx], dl
		jmp	short loc_8EC
; ---------------------------------------------------------------------------

loc_8DB:				; CODE XREF: _ubidi_getLogicalRun_56+141j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	edx, [ebp+arg_C]
		mov	eax, [ebp+arg_4]
		mov	cl, [ecx+eax]
		mov	[edx], cl

loc_8EC:				; CODE XREF: _ubidi_getLogicalRun_56+47j
					; _ubidi_getLogicalRun_56+65j ...
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN22
		call	@_RTC_CheckStackVars@8 ; _RTC_CheckStackVars(x,x)
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 124h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getLogicalRun_56	endp

; ---------------------------------------------------------------------------
		align 4
$LN22		dd 2			; DATA XREF: _ubidi_getLogicalRun_56+1A8o
		dd offset $LN21
$LN21		dd 0FFFFFFF4h, 4	; DATA XREF: .text:00000920o
		dd offset $LN19		; "errorCode"
		dd 0FFFFFFA4h, 0Ch
		dd offset $LN20		; "iRun"
$LN20		db 'iRun',0             ; DATA XREF: .text:00000938o
$LN19		db 'errorCode',0        ; DATA XREF: .text:0000092Co
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 94Ch
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_countRuns_56
_ubidi_countRuns_56 proc near		; CODE XREF: _ubidi_getLogicalRun_56+54p
					; _ubidi_getLogicalMap_56+39p ...

var_C0		= byte ptr -0C0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C0]
		mov	ecx, 30h ; '0'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_4], 0
		jz	short loc_978
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jle	short loc_97D

loc_978:				; CODE XREF: _ubidi_countRuns_56+22j
		or	eax, 0FFFFFFFFh
		jmp	short loc_9D7
; ---------------------------------------------------------------------------

loc_97D:				; CODE XREF: _ubidi_countRuns_56+2Aj
		cmp	[ebp+arg_0], 0
		jz	short loc_9A3
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_9B1
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_9A3
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jz	short loc_9B1

loc_9A3:				; CODE XREF: _ubidi_countRuns_56+35j
					; _ubidi_countRuns_56+47j
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 1Bh
		or	eax, 0FFFFFFFFh
		jmp	short loc_9D7
; ---------------------------------------------------------------------------

loc_9B1:				; CODE XREF: _ubidi_countRuns_56+3Fj
					; _ubidi_countRuns_56+55j
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_getRuns_56
		add	esp, 8
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jle	short loc_9CE
		or	eax, 0FFFFFFFFh
		jmp	short loc_9D7
; ---------------------------------------------------------------------------

loc_9CE:				; CODE XREF: _ubidi_countRuns_56+7Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+0E0h]

loc_9D7:				; CODE XREF: _ubidi_countRuns_56+2Fj
					; _ubidi_countRuns_56+63j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0C0h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_countRuns_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 9ECh
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getVisualRun_56
_ubidi_getVisualRun_56 proc near

var_D8		= byte ptr -0D8h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 0D8h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_D8]
		mov	ecx, 36h ; '6'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_14], 0
		cmp	[ebp+arg_0], 0
		jz	short loc_A37
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_A45
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_A37
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jz	short loc_A45

loc_A37:				; CODE XREF: _ubidi_getVisualRun_56+29j
					; _ubidi_getVisualRun_56+3Bj
		mov	[ebp+var_14], 1Bh
		xor	eax, eax
		jmp	loc_AFC
; ---------------------------------------------------------------------------

loc_A45:				; CODE XREF: _ubidi_getVisualRun_56+33j
					; _ubidi_getVisualRun_56+49j
		lea	eax, [ebp+var_14]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_getRuns_56
		add	esp, 8
		cmp	[ebp+var_14], 0
		jle	short loc_A62
		xor	eax, eax
		jmp	loc_AFC
; ---------------------------------------------------------------------------

loc_A62:				; CODE XREF: _ubidi_getVisualRun_56+6Dj
		cmp	[ebp+arg_4], 0
		jl	short loc_A76
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+0E0h]
		jl	short loc_A81

loc_A76:				; CODE XREF: _ubidi_getVisualRun_56+7Aj
		mov	[ebp+var_14], 1
		xor	eax, eax
		jmp	short loc_AFC
; ---------------------------------------------------------------------------

loc_A81:				; CODE XREF: _ubidi_getVisualRun_56+88j
		mov	eax, [ebp+arg_4]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		mov	eax, [eax+edx]
		mov	[ebp+var_8], eax
		cmp	[ebp+arg_8], 0
		jz	short loc_AA9
		mov	eax, [ebp+var_8]
		and	eax, 7FFFFFFFh
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax

loc_AA9:				; CODE XREF: _ubidi_getVisualRun_56+AEj
		cmp	[ebp+arg_C], 0
		jz	short loc_AF6
		cmp	[ebp+arg_4], 0
		jle	short loc_AE5
		mov	eax, [ebp+arg_4]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		mov	ecx, [ebp+arg_4]
		sub	ecx, 1
		imul	ecx, 0Ch
		mov	esi, [ebp+arg_0]
		mov	esi, [esi+0E4h]
		mov	edx, [edx+eax+4]
		sub	edx, [esi+ecx+4]
		mov	eax, [ebp+arg_C]
		mov	[eax], edx
		jmp	short loc_AF6
; ---------------------------------------------------------------------------

loc_AE5:				; CODE XREF: _ubidi_getVisualRun_56+C7j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	edx, [ebp+arg_C]
		mov	eax, [ecx+4]
		mov	[edx], eax

loc_AF6:				; CODE XREF: _ubidi_getVisualRun_56+C1j
					; _ubidi_getVisualRun_56+F7j
		mov	eax, [ebp+var_8]
		shr	eax, 1Fh

loc_AFC:				; CODE XREF: _ubidi_getVisualRun_56+54j
					; _ubidi_getVisualRun_56+71j ...
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN15
		call	@_RTC_CheckStackVars@8 ; _RTC_CheckStackVars(x,x)
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0D8h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getVisualRun_56 endp

; ---------------------------------------------------------------------------
		align 4
$LN15		dd 1			; DATA XREF: _ubidi_getVisualRun_56+114o
		dd offset $LN14
$LN14		dd 0FFFFFFECh, 4	; DATA XREF: .text:00000B28o
		dd offset $LN13		; "errorCode"
$LN13		db 'errorCode',0        ; DATA XREF: .text:00000B34o
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 0B44h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getRuns_56
_ubidi_getRuns_56 proc near		; CODE XREF: _ubidi_countRuns_56+6Dp
					; _ubidi_getVisualRun_56+61p ...

var_1B4		= dword	ptr -1B4h
var_EC		= dword	ptr -0ECh
var_E0		= dword	ptr -0E0h
var_D4		= dword	ptr -0D4h
var_C8		= dword	ptr -0C8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A4		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_8C		= dword	ptr -8Ch
var_7D		= byte ptr -7Dh
var_71		= byte ptr -71h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_41		= byte ptr -41h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 1B4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_1B4]
		mov	ecx, 6Dh ; 'm'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+0E0h], 0
		jl	short loc_B75
		mov	al, 1
		jmp	loc_101D
; ---------------------------------------------------------------------------

loc_B75:				; CODE XREF: _ubidi_getRuns_56+28j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 2
		jz	short loc_B97
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+61h]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_getSingleRun
		add	esp, 8
		jmp	loc_E6E
; ---------------------------------------------------------------------------

loc_B97:				; CODE XREF: _ubidi_getRuns_56+38j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	[ebp+var_20], ecx
		mov	[ebp+var_41], 0FEh ; 'þ'
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+84h]
		mov	[ebp+var_14], ecx
		mov	[ebp+var_38], 0
		mov	[ebp+var_2C], 0
		jmp	short loc_BD2
; ---------------------------------------------------------------------------

loc_BC9:				; CODE XREF: _ubidi_getRuns_56:loc_BFFj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_BD2:				; CODE XREF: _ubidi_getRuns_56+83j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_14]
		jge	short loc_C01
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_2C]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jz	short loc_BFF
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_2C]
		mov	cl, [eax]
		mov	[ebp+var_41], cl

loc_BFF:				; CODE XREF: _ubidi_getRuns_56+A5j
		jmp	short loc_BC9
; ---------------------------------------------------------------------------

loc_C01:				; CODE XREF: _ubidi_getRuns_56+94j
		cmp	[ebp+var_38], 1
		jnz	short loc_C27
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_8]
		jnz	short loc_C27
		mov	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_getSingleRun
		add	esp, 8
		jmp	loc_E6E
; ---------------------------------------------------------------------------

loc_C27:				; CODE XREF: _ubidi_getRuns_56+C1j
					; _ubidi_getRuns_56+C9j
		mov	[ebp+var_71], 7Eh ; '~'
		mov	[ebp+var_7D], 0
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_8]
		jge	short loc_C40
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax

loc_C40:				; CODE XREF: _ubidi_getRuns_56+F1j
		mov	eax, [ebp+var_38]
		imul	eax, 0Ch
		push	eax
		mov	ecx, [ebp+arg_0]
		movzx	edx, byte ptr [ecx+49h]
		push	edx
		mov	eax, [ebp+arg_0]
		add	eax, 28h ; '('
		push	eax
		mov	ecx, [ebp+arg_0]
		add	ecx, 40h ; '@'
		push	ecx
		call	_ubidi_getMemory_56
		add	esp, 10h
		movsx	edx, al
		test	edx, edx
		jz	short loc_C77
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+40h]
		mov	[ebp+var_50], ecx
		jmp	short loc_C7E
; ---------------------------------------------------------------------------

loc_C77:				; CODE XREF: _ubidi_getRuns_56+126j
		xor	al, al
		jmp	loc_101D
; ---------------------------------------------------------------------------

loc_C7E:				; CODE XREF: _ubidi_getRuns_56+131j
		mov	[ebp+var_5C], 0
		mov	[ebp+var_2C], 0

loc_C8C:				; CODE XREF: _ubidi_getRuns_56+1E3j
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_68], eax
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_2C]
		mov	cl, [eax]
		mov	[ebp+var_41], cl
		movzx	eax, [ebp+var_41]
		movzx	ecx, [ebp+var_71]
		cmp	eax, ecx
		jge	short loc_CAF
		mov	al, [ebp+var_41]
		mov	[ebp+var_71], al

loc_CAF:				; CODE XREF: _ubidi_getRuns_56+163j
		movzx	eax, [ebp+var_41]
		movzx	ecx, [ebp+var_7D]
		cmp	eax, ecx
		jle	short loc_CC1
		mov	al, [ebp+var_41]
		mov	[ebp+var_7D], al

loc_CC1:				; CODE XREF: _ubidi_getRuns_56+175j
					; _ubidi_getRuns_56+19Fj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		cmp	ecx, [ebp+var_14]
		jge	short loc_CE5
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_2C]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jnz	short loc_CE5
		jmp	short loc_CC1
; ---------------------------------------------------------------------------

loc_CE5:				; CODE XREF: _ubidi_getRuns_56+18Cj
					; _ubidi_getRuns_56+19Dj
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+var_68]
		mov	[ecx+eax], edx
		mov	eax, [ebp+var_2C]
		sub	eax, [ebp+var_68]
		mov	ecx, [ebp+var_5C]
		imul	ecx, 0Ch
		mov	edx, [ebp+var_50]
		mov	[edx+ecx+4], eax
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	dword ptr [ecx+eax+8], 0
		mov	eax, [ebp+var_5C]
		add	eax, 1
		mov	[ebp+var_5C], eax
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_14]
		jl	loc_C8C
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+var_8]
		jge	short loc_D6F
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+var_14]
		mov	[ecx+eax], edx
		mov	eax, [ebp+var_8]
		sub	eax, [ebp+var_14]
		mov	ecx, [ebp+var_5C]
		imul	ecx, 0Ch
		mov	edx, [ebp+var_50]
		mov	[edx+ecx+4], eax
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+61h]
		movzx	edx, [ebp+var_71]
		cmp	ecx, edx
		jge	short loc_D6F
		mov	eax, [ebp+arg_0]
		mov	cl, [eax+61h]
		mov	[ebp+var_71], cl

loc_D6F:				; CODE XREF: _ubidi_getRuns_56+1EFj
					; _ubidi_getRuns_56+220j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_50]
		mov	[eax+0E4h], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_38]
		mov	[eax+0E0h], ecx
		movzx	eax, [ebp+var_7D]
		push	eax
		movzx	ecx, [ebp+var_71]
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_reorderLine
		add	esp, 0Ch
		mov	[ebp+var_14], 0
		mov	[ebp+var_2C], 0
		jmp	short loc_DB6
; ---------------------------------------------------------------------------

loc_DAD:				; CODE XREF: _ubidi_getRuns_56+2CBj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_DB6:				; CODE XREF: _ubidi_getRuns_56+267j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_38]
		jge	short loc_E11
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_2C]
		imul	ecx, 0Ch
		mov	edx, [ebp+var_50]
		mov	ecx, [edx+ecx]
		mov	edx, [ebp+var_20]
		movzx	ecx, byte ptr [edx+ecx]
		shl	ecx, 1Fh
		mov	edx, [ebp+var_50]
		or	ecx, [edx+eax]
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	edx, [ebp+var_50]
		mov	[edx+eax], ecx
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+var_14]
		add	edx, [ecx+eax+4]
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+var_14]
		mov	[ecx+eax+4], edx
		jmp	short loc_DAD
; ---------------------------------------------------------------------------

loc_E11:				; CODE XREF: _ubidi_getRuns_56+278j
		mov	eax, [ebp+var_5C]
		cmp	eax, [ebp+var_38]
		jge	short loc_E6E
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+61h]
		and	ecx, 1
		jz	short loc_E31
		mov	[ebp+var_1B4], 0
		jmp	short loc_E3A
; ---------------------------------------------------------------------------

loc_E31:				; CODE XREF: _ubidi_getRuns_56+2DFj
		mov	edx, [ebp+var_5C]
		mov	[ebp+var_1B4], edx

loc_E3A:				; CODE XREF: _ubidi_getRuns_56+2EBj
		mov	eax, [ebp+var_1B4]
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_8C]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		movzx	edx, byte ptr [ecx+61h]
		shl	edx, 1Fh
		mov	ecx, [ebp+var_50]
		or	edx, [ecx+eax]
		mov	eax, [ebp+var_8C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	[ecx+eax], edx

loc_E6E:				; CODE XREF: _ubidi_getRuns_56+4Ej
					; _ubidi_getRuns_56+DEj ...
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jle	loc_F26
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+15Ch]
		mov	[ebp+var_A4], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+150h]
		mov	edx, [ebp+var_A4]
		lea	eax, [edx+ecx*8]
		mov	[ebp+var_B0], eax
		mov	eax, [ebp+var_A4]
		mov	[ebp+var_98], eax
		jmp	short loc_EC2
; ---------------------------------------------------------------------------

loc_EB3:				; CODE XREF: _ubidi_getRuns_56+3E0j
		mov	eax, [ebp+var_98]
		add	eax, 8
		mov	[ebp+var_98], eax

loc_EC2:				; CODE XREF: _ubidi_getRuns_56+36Dj
		mov	eax, [ebp+var_98]
		cmp	eax, [ebp+var_B0]
		jnb	short loc_F26
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_getRunFromLogicalIndex
		add	esp, 0Ch
		mov	[ebp+var_BC], eax
		mov	eax, [ebp+var_BC]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		mov	ecx, [ebp+var_98]
		mov	edx, [edx+eax+8]
		or	edx, [ecx+4]
		mov	eax, [ebp+var_BC]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	ecx, [ecx+0E4h]
		mov	[ecx+eax+8], edx
		jmp	short loc_EB3
; ---------------------------------------------------------------------------

loc_F26:				; CODE XREF: _ubidi_getRuns_56+334j
					; _ubidi_getRuns_56+38Aj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_101B
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_D4], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		mov	edx, [ebp+var_D4]
		lea	eax, [edx+ecx*2]
		mov	[ebp+var_E0], eax
		mov	eax, [ebp+var_D4]
		mov	[ebp+var_EC], eax
		jmp	short loc_F74
; ---------------------------------------------------------------------------

loc_F65:				; CODE XREF: _ubidi_getRuns_56:loc_1016j
		mov	eax, [ebp+var_EC]
		add	eax, 2
		mov	[ebp+var_EC], eax

loc_F74:				; CODE XREF: _ubidi_getRuns_56+41Fj
		mov	eax, [ebp+var_EC]
		cmp	eax, [ebp+var_E0]
		jnb	loc_101B
		mov	eax, [ebp+var_EC]
		movzx	ecx, word ptr [eax]
		and	ecx, 0FFFFFFFCh
		cmp	ecx, 200Ch
		jz	short loc_FC2
		mov	eax, [ebp+var_EC]
		movzx	ecx, word ptr [eax]
		sub	ecx, 202Ah
		cmp	ecx, 5
		jb	short loc_FC2
		mov	eax, [ebp+var_EC]
		movzx	ecx, word ptr [eax]
		sub	ecx, 2066h
		cmp	ecx, 4
		jnb	short loc_1016

loc_FC2:				; CODE XREF: _ubidi_getRuns_56+454j
					; _ubidi_getRuns_56+468j
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+var_EC]
		sub	ecx, [ebp+var_D4]
		sar	ecx, 1
		push	ecx
		mov	edx, [ebp+arg_0]
		push	edx
		call	_getRunFromLogicalIndex
		add	esp, 0Ch
		mov	[ebp+var_C8], eax
		mov	eax, [ebp+var_C8]
		imul	eax, 0Ch
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		mov	eax, [edx+eax+8]
		sub	eax, 1
		mov	ecx, [ebp+var_C8]
		imul	ecx, 0Ch
		mov	edx, [ebp+arg_0]
		mov	edx, [edx+0E4h]
		mov	[edx+ecx+8], eax

loc_1016:				; CODE XREF: _ubidi_getRuns_56+47Cj
		jmp	loc_F65
; ---------------------------------------------------------------------------

loc_101B:				; CODE XREF: _ubidi_getRuns_56+3ECj
					; _ubidi_getRuns_56+43Cj
		mov	al, 1

loc_101D:				; CODE XREF: _ubidi_getRuns_56+2Cj
					; _ubidi_getRuns_56+135j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1B4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getRuns_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1034h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_getSingleRun	proc near		; CODE XREF: _ubidi_getRuns_56+46p
					; _ubidi_getRuns_56+D6p

var_C0		= byte ptr -0C0h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C0]
		mov	ecx, 30h ; '0'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		add	eax, 0E8h ; 'è'
		mov	ecx, [ebp+arg_0]
		mov	[ecx+0E4h], eax
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax+0E0h], 1
		movzx	eax, [ebp+arg_4]
		shl	eax, 1Fh
		mov	ecx, [ebp+arg_0]
		mov	edx, [ecx+0E4h]
		mov	[edx], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	edx, [ebp+arg_0]
		mov	eax, [edx+10h]
		mov	[ecx+4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	dword ptr [ecx+8], 0
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_getSingleRun	endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10ACh
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_reorderLine	proc near		; CODE XREF: _ubidi_getRuns_56+251p

var_120		= byte ptr -120h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 120h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_120]
		mov	ecx, 48h ; 'H'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, dword ptr ds:___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		movzx	eax, [ebp+arg_8]
		movzx	ecx, [ebp+arg_4]
		or	ecx, 1
		cmp	eax, ecx
		jg	short loc_10E8
		jmp	loc_12F3
; ---------------------------------------------------------------------------

loc_10E8:				; CODE XREF: _reorderLine+35j
		mov	al, [ebp+arg_4]
		add	al, 1
		mov	[ebp+arg_4], al
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+50h]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_5C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_0]
		mov	edx, [eax+84h]
		cmp	edx, [ecx+10h]
		jge	short loc_112B
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_5C], eax

loc_112B:				; CODE XREF: _reorderLine+74j
					; _reorderLine:loc_124Ej
		mov	al, [ebp+arg_8]
		sub	al, 1
		mov	[ebp+arg_8], al
		movzx	ecx, [ebp+arg_8]
		movzx	edx, [ebp+arg_4]
		cmp	ecx, edx
		jl	loc_1253
		mov	[ebp+var_38], 0

loc_114A:				; CODE XREF: _reorderLine+CAj
					; _reorderLine:loc_1249j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_5C]
		jge	short loc_1178
		mov	eax, [ebp+var_38]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+eax]
		mov	eax, [ebp+var_2C]
		movzx	ecx, byte ptr [eax+edx]
		movzx	edx, [ebp+arg_8]
		cmp	ecx, edx
		jge	short loc_1178
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax
		jmp	short loc_114A
; ---------------------------------------------------------------------------

loc_1178:				; CODE XREF: _reorderLine+A4j
					; _reorderLine+BFj
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_5C]
		jl	short loc_1185
		jmp	loc_124E
; ---------------------------------------------------------------------------

loc_1185:				; CODE XREF: _reorderLine+D2j
		mov	eax, [ebp+var_38]
		mov	[ebp+var_50], eax

loc_118B:				; CODE XREF: _reorderLine+10Bj
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_50], eax
		mov	ecx, [ebp+var_50]
		cmp	ecx, [ebp+var_5C]
		jge	short loc_11B9
		mov	eax, [ebp+var_50]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_C]
		mov	edx, [ecx+eax]
		mov	eax, [ebp+var_2C]
		movzx	ecx, byte ptr [eax+edx]
		movzx	edx, [ebp+arg_8]
		cmp	ecx, edx
		jl	short loc_11B9
		jmp	short loc_118B
; ---------------------------------------------------------------------------

loc_11B9:				; CODE XREF: _reorderLine+EEj
					; _reorderLine+109j
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_44], eax

loc_11C2:				; CODE XREF: _reorderLine+186j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_44]
		jge	short loc_1234
		mov	eax, [ebp+var_38]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [eax]
		mov	[ebp+var_20], ecx
		mov	edx, [eax+4]
		mov	[ebp+var_1C], edx
		mov	eax, [eax+8]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_44]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [ebp+var_38]
		imul	ecx, 0Ch
		add	ecx, [ebp+var_C]
		mov	edx, [eax]
		mov	[ecx], edx
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		mov	eax, [eax+8]
		mov	[ecx+8], eax
		mov	eax, [ebp+var_44]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [ebp+var_20]
		mov	[eax], ecx
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_18]
		mov	[eax+8], ecx
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_44]
		sub	eax, 1
		mov	[ebp+var_44], eax
		jmp	short loc_11C2
; ---------------------------------------------------------------------------

loc_1234:				; CODE XREF: _reorderLine+11Cj
		mov	eax, [ebp+var_50]
		cmp	eax, [ebp+var_5C]
		jnz	short loc_1240
		jmp	short loc_124E
; ---------------------------------------------------------------------------
		jmp	short loc_1249
; ---------------------------------------------------------------------------

loc_1240:				; CODE XREF: _reorderLine+18Ej
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_38], eax

loc_1249:				; CODE XREF: _reorderLine+192j
		jmp	loc_114A
; ---------------------------------------------------------------------------

loc_124E:				; CODE XREF: _reorderLine+D4j
					; _reorderLine+190j
		jmp	loc_112B
; ---------------------------------------------------------------------------

loc_1253:				; CODE XREF: _reorderLine+91j
		movzx	eax, [ebp+arg_4]
		and	eax, 1
		jnz	loc_12F3
		mov	[ebp+var_38], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_0]
		mov	edx, [eax+84h]
		cmp	edx, [ecx+10h]
		jnz	short loc_1281
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_5C], eax

loc_1281:				; CODE XREF: _reorderLine+1CAj
					; _reorderLine+245j
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_5C]
		jge	short loc_12F3
		mov	eax, [ebp+var_38]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [eax]
		mov	[ebp+var_20], ecx
		mov	edx, [eax+4]
		mov	[ebp+var_1C], edx
		mov	eax, [eax+8]
		mov	[ebp+var_18], eax
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [ebp+var_38]
		imul	ecx, 0Ch
		add	ecx, [ebp+var_C]
		mov	edx, [eax]
		mov	[ecx], edx
		mov	edx, [eax+4]
		mov	[ecx+4], edx
		mov	eax, [eax+8]
		mov	[ecx+8], eax
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		add	eax, [ebp+var_C]
		mov	ecx, [ebp+var_20]
		mov	[eax], ecx
		mov	edx, [ebp+var_1C]
		mov	[eax+4], edx
		mov	ecx, [ebp+var_18]
		mov	[eax+8], ecx
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_5C], eax
		jmp	short loc_1281
; ---------------------------------------------------------------------------

loc_12F3:				; CODE XREF: _reorderLine+37j
					; _reorderLine+1AEj ...
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN24
		call	@_RTC_CheckStackVars@8 ; _RTC_CheckStackVars(x,x)
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
_reorderLine	endp

; ---------------------------------------------------------------------------
		align 4
$LN24		dd 1			; DATA XREF: _reorderLine+24Bo
		dd offset $LN23
$LN23		dd 0FFFFFFE0h, 0Ch	; DATA XREF: .text:0000131Co
		dd offset $LN22_0	; "tempRun"
$LN22_0		db 'tempRun',0          ; DATA XREF: .text:00001328o
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1334h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_getRunFromLogicalIndex	proc near	; CODE XREF: _ubidi_getRuns_56+39Dp
					; _ubidi_getRuns_56+495p

var_108		= byte ptr -108h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 108h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_108]
		mov	ecx, 42h ; 'B'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_14], ecx
		mov	[ebp+var_20], 0
		mov	[ebp+var_2C], 0
		jmp	short loc_1383
; ---------------------------------------------------------------------------

loc_137A:				; CODE XREF: _getRunFromLogicalIndex+A0j
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_1383:				; CODE XREF: _getRunFromLogicalIndex+44j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_14]
		jge	short loc_13D6
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_20]
		mov	[ebp+var_38], edx
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax]
		and	edx, 7FFFFFFFh
		mov	[ebp+var_44], edx
		mov	eax, [ebp+arg_4]
		cmp	eax, [ebp+var_44]
		jl	short loc_13CB
		mov	eax, [ebp+var_44]
		add	eax, [ebp+var_38]
		cmp	[ebp+arg_4], eax
		jge	short loc_13CB
		mov	eax, [ebp+var_2C]
		jmp	short loc_140B
; ---------------------------------------------------------------------------

loc_13CB:				; CODE XREF: _getRunFromLogicalIndex+85j
					; _getRunFromLogicalIndex+90j
		mov	eax, [ebp+var_20]
		add	eax, [ebp+var_38]
		mov	[ebp+var_20], eax
		jmp	short loc_137A
; ---------------------------------------------------------------------------

loc_13D6:				; CODE XREF: _getRunFromLogicalIndex+55j
		xor	eax, eax
		jnz	short loc_1400
		mov	ecx, ds:?__LINE__Var@?1??getRunFromLogicalIndex@@9@9@8534d2d2
		add	ecx, 0Dh
		mov	esi, esp
		push	ecx		; Line
		push	offset ??_C@_1FI@BCBOJMPO@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@ ; "d:\\mozilla\\intl\\icu\\source\\common\"...
		push	offset ??_C@_13COJANIEC@?$AA0?$AA?$AA@ ; Message
		call	dword ptr ds:__imp___wassert
		add	esp, 0Ch
		cmp	esi, esp
		call	__RTC_CheckEsp

loc_1400:				; CODE XREF: _getRunFromLogicalIndex+A4j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1Bh
		xor	eax, eax

loc_140B:				; CODE XREF: _getRunFromLogicalIndex+95j
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 108h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_getRunFromLogicalIndex	endp

; ---------------------------------------------------------------------------
		align 10h
_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1420h
		public ??_C@_13COJANIEC@?$AA0?$AA?$AA@
; wchar_t `string'
??_C@_13COJANIEC@?$AA0?$AA?$AA@	dd offset loc_2C+4 ; DATA XREF:	_getRunFromLogicalIndex+B7o
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
; Segment alignment 'qword' can not be represented in assembly
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1424h
		public ??_C@_1FI@BCBOJMPO@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@
; wchar_t `string'
??_C@_1FI@BCBOJMPO@?$AAd?$AA?3?$AA?2?$AAm?$AAo?$AAz?$AAi?$AAl?$AAl?$AAa?$AA?2?$AAi?$AAn?$AAt?$AAl?$AA?2?$AAi?$AAc?$AAu?$AA?2?$AAs?$AAo?$AAu?$AAr?$AAc?$AAe?$AA?2?$AAc?$AAo?$AAm?$AAm?$AAo@:
					; DATA XREF: _getRunFromLogicalIndex+B2o
		unicode	0, <d:\mozilla\intl\icu\source\common\ubidiln.c>,0
_rdata		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 147Ch
		public ?__LINE__Var@?1??getRunFromLogicalIndex@@9@9@8534d2d2
?__LINE__Var@?1??getRunFromLogicalIndex@@9@9@8534d2d2 dd 206h
					; DATA XREF: _getRunFromLogicalIndex+A6r
_data		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1480h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_reorderLogical_56
_ubidi_reorderLogical_56 proc near

var_FC		= byte ptr -0FCh
var_35		= byte ptr -35h
var_29		= byte ptr -29h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0FCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_FC]
		mov	ecx, 3Fh ; '?'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_29], 0
		mov	[ebp+var_35], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_14CF
		lea	eax, [ebp+var_35]
		push	eax
		lea	ecx, [ebp+var_29]
		push	ecx
		mov	edx, [ebp+arg_8]
		push	edx
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_prepareReorder
		add	esp, 14h
		movsx	edx, al
		test	edx, edx
		jnz	short loc_14D4

loc_14CF:				; CODE XREF: _ubidi_reorderLogical_56+2Aj
		jmp	loc_15BC
; ---------------------------------------------------------------------------

loc_14D4:				; CODE XREF: _ubidi_reorderLogical_56+4Dj
		movzx	eax, [ebp+var_29]
		movzx	ecx, [ebp+var_35]
		cmp	eax, ecx
		jnz	short loc_14EE
		movzx	eax, [ebp+var_29]
		and	eax, 1
		jnz	short loc_14EE
		jmp	loc_15BC
; ---------------------------------------------------------------------------

loc_14EE:				; CODE XREF: _ubidi_reorderLogical_56+5Ej
					; _ubidi_reorderLogical_56+67j
		movzx	eax, [ebp+var_29]
		or	eax, 1
		mov	[ebp+var_29], al

loc_14F8:				; CODE XREF: _ubidi_reorderLogical_56+136j
		mov	[ebp+var_8], 0

loc_14FF:				; CODE XREF: _ubidi_reorderLogical_56+A1j
					; _ubidi_reorderLogical_56:loc_159Fj
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jge	short loc_1523
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_8]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_35]
		cmp	ecx, edx
		jge	short loc_1523
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		jmp	short loc_14FF
; ---------------------------------------------------------------------------

loc_1523:				; CODE XREF: _ubidi_reorderLogical_56+85j
					; _ubidi_reorderLogical_56+96j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jl	short loc_152D
		jmp	short loc_15A4
; ---------------------------------------------------------------------------

loc_152D:				; CODE XREF: _ubidi_reorderLogical_56+A9j
		mov	eax, [ebp+var_8]
		mov	[ebp+var_14], eax

loc_1533:				; CODE XREF: _ubidi_reorderLogical_56+D5j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+var_14]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_1557
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_14]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_35]
		cmp	ecx, edx
		jl	short loc_1557
		jmp	short loc_1533
; ---------------------------------------------------------------------------

loc_1557:				; CODE XREF: _ubidi_reorderLogical_56+C2j
					; _ubidi_reorderLogical_56+D3j
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+var_8]
		lea	edx, [ecx+eax-1]
		mov	[ebp+var_20], edx

loc_1564:				; CODE XREF: _ubidi_reorderLogical_56+108j
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_8]
		mov	edx, [ebp+var_20]
		sub	edx, [ecx+eax*4]
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_8]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		cmp	ecx, [ebp+var_14]
		jl	short loc_1564
		mov	eax, [ebp+var_14]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_1596
		jmp	short loc_15A4
; ---------------------------------------------------------------------------
		jmp	short loc_159F
; ---------------------------------------------------------------------------

loc_1596:				; CODE XREF: _ubidi_reorderLogical_56+110j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_8], eax

loc_159F:				; CODE XREF: _ubidi_reorderLogical_56+114j
		jmp	loc_14FF
; ---------------------------------------------------------------------------

loc_15A4:				; CODE XREF: _ubidi_reorderLogical_56+ABj
					; _ubidi_reorderLogical_56+112j
		mov	al, [ebp+var_35]
		sub	al, 1
		mov	[ebp+var_35], al
		movzx	ecx, [ebp+var_35]
		movzx	edx, [ebp+var_29]
		cmp	ecx, edx
		jge	loc_14F8

loc_15BC:				; CODE XREF: _ubidi_reorderLogical_56:loc_14CFj
					; _ubidi_reorderLogical_56+69j
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN24_0
		call	@_RTC_CheckStackVars@8 ; _RTC_CheckStackVars(x,x)
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0FCh
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_reorderLogical_56 endp

; ---------------------------------------------------------------------------
		align 4
$LN24_0		dd 2			; DATA XREF: _ubidi_reorderLogical_56+140o
		dd offset $LN23_0
$LN23_0		dd 0FFFFFFD7h, 1	; DATA XREF: .text:000015E8o
		dd offset $LN21_0	; "minLevel"
; ---------------------------------------------------------------------------
		retf
; ---------------------------------------------------------------------------
		db 3 dup(0FFh)
		dd 1
		dd offset $LN22_1	; "maxLevel"
$LN22_1		db 'maxLevel',0         ; DATA XREF: .text:00001600o
$LN21_0		db 'minLevel',0         ; DATA XREF: .text:000015F4o
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1618h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_prepareReorder	proc near		; CODE XREF: _ubidi_reorderLogical_56+40p
					; _ubidi_reorderVisual_56+40p

var_F0		= byte ptr -0F0h
var_29		= byte ptr -29h
var_1D		= byte ptr -1Dh
var_11		= byte ptr -11h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		sub	esp, 0F0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_F0]
		mov	ecx, 3Ch ; '<'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_0], 0
		jz	short loc_1642
		cmp	[ebp+arg_4], 0
		jg	short loc_1649

loc_1642:				; CODE XREF: _prepareReorder+22j
		xor	al, al
		jmp	loc_16D9
; ---------------------------------------------------------------------------

loc_1649:				; CODE XREF: _prepareReorder+28j
		mov	[ebp+var_1D], 7Eh ; '~'
		mov	[ebp+var_29], 0
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax

loc_1657:				; CODE XREF: _prepareReorder:loc_16A2j
		cmp	[ebp+var_8], 0
		jle	short loc_16A4
		mov	eax, [ebp+var_8]
		sub	eax, 1
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+arg_0]
		add	ecx, [ebp+var_8]
		mov	dl, [ecx]
		mov	[ebp+var_11], dl
		movzx	eax, [ebp+var_11]
		cmp	eax, 7Eh ; '~'
		jle	short loc_167E
		xor	al, al
		jmp	short loc_16D9
; ---------------------------------------------------------------------------

loc_167E:				; CODE XREF: _prepareReorder+60j
		movzx	eax, [ebp+var_11]
		movzx	ecx, [ebp+var_1D]
		cmp	eax, ecx
		jge	short loc_1690
		mov	al, [ebp+var_11]
		mov	[ebp+var_1D], al

loc_1690:				; CODE XREF: _prepareReorder+70j
		movzx	eax, [ebp+var_11]
		movzx	ecx, [ebp+var_29]
		cmp	eax, ecx
		jle	short loc_16A2
		mov	al, [ebp+var_11]
		mov	[ebp+var_29], al

loc_16A2:				; CODE XREF: _prepareReorder+82j
		jmp	short loc_1657
; ---------------------------------------------------------------------------

loc_16A4:				; CODE XREF: _prepareReorder+43j
		mov	eax, [ebp+arg_C]
		mov	cl, [ebp+var_1D]
		mov	[eax], cl
		mov	eax, [ebp+arg_10]
		mov	cl, [ebp+var_29]
		mov	[eax], cl
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax

loc_16BA:				; CODE XREF: _prepareReorder+BDj
		cmp	[ebp+var_8], 0
		jle	short loc_16D7
		mov	eax, [ebp+var_8]
		sub	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_8]
		mov	edx, [ebp+var_8]
		mov	[ecx+eax*4], edx
		jmp	short loc_16BA
; ---------------------------------------------------------------------------

loc_16D7:				; CODE XREF: _prepareReorder+A6j
		mov	al, 1

loc_16D9:				; CODE XREF: _prepareReorder+2Cj
					; _prepareReorder+64j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_prepareReorder	endp

_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 16E0h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_reorderVisual_56
_ubidi_reorderVisual_56	proc near

var_108		= byte ptr -108h
var_41		= byte ptr -41h
var_35		= byte ptr -35h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 108h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_108]
		mov	ecx, 42h ; 'B'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_35], 0
		mov	[ebp+var_41], 0
		cmp	[ebp+arg_8], 0
		jz	short loc_172F
		lea	eax, [ebp+var_41]
		push	eax
		lea	ecx, [ebp+var_35]
		push	ecx
		mov	edx, [ebp+arg_8]
		push	edx
		mov	eax, [ebp+arg_4]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_prepareReorder
		add	esp, 14h
		movsx	edx, al
		test	edx, edx
		jnz	short loc_1734

loc_172F:				; CODE XREF: _ubidi_reorderVisual_56+2Aj
		jmp	loc_183B
; ---------------------------------------------------------------------------

loc_1734:				; CODE XREF: _ubidi_reorderVisual_56+4Dj
		movzx	eax, [ebp+var_35]
		movzx	ecx, [ebp+var_41]
		cmp	eax, ecx
		jnz	short loc_174E
		movzx	eax, [ebp+var_35]
		and	eax, 1
		jnz	short loc_174E
		jmp	loc_183B
; ---------------------------------------------------------------------------

loc_174E:				; CODE XREF: _ubidi_reorderVisual_56+5Ej
					; _ubidi_reorderVisual_56+67j
		movzx	eax, [ebp+var_35]
		or	eax, 1
		mov	[ebp+var_35], al

loc_1758:				; CODE XREF: _ubidi_reorderVisual_56+155j
		mov	[ebp+var_8], 0

loc_175F:				; CODE XREF: _ubidi_reorderVisual_56+A1j
					; _ubidi_reorderVisual_56:loc_181Ej
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jge	short loc_1783
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_8]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jge	short loc_1783
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		jmp	short loc_175F
; ---------------------------------------------------------------------------

loc_1783:				; CODE XREF: _ubidi_reorderVisual_56+85j
					; _ubidi_reorderVisual_56+96j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_4]
		jl	short loc_1790
		jmp	loc_1823
; ---------------------------------------------------------------------------

loc_1790:				; CODE XREF: _ubidi_reorderVisual_56+A9j
		mov	eax, [ebp+var_8]
		mov	[ebp+var_20], eax

loc_1796:				; CODE XREF: _ubidi_reorderVisual_56+D8j
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_20]
		cmp	ecx, [ebp+arg_4]
		jge	short loc_17BA
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_20]
		movzx	ecx, byte ptr [eax]
		movzx	edx, [ebp+var_41]
		cmp	ecx, edx
		jl	short loc_17BA
		jmp	short loc_1796
; ---------------------------------------------------------------------------

loc_17BA:				; CODE XREF: _ubidi_reorderVisual_56+C5j
					; _ubidi_reorderVisual_56+D6j
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_14], eax

loc_17C3:				; CODE XREF: _ubidi_reorderVisual_56+127j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jge	short loc_1809
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_8]
		mov	edx, [ecx+eax*4]
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_8]
		mov	ecx, [ebp+arg_8]
		mov	edx, [ebp+var_14]
		mov	esi, [ebp+arg_8]
		mov	edx, [esi+edx*4]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+arg_8]
		mov	edx, [ebp+var_2C]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		jmp	short loc_17C3
; ---------------------------------------------------------------------------

loc_1809:				; CODE XREF: _ubidi_reorderVisual_56+E9j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+arg_4]
		jnz	short loc_1815
		jmp	short loc_1823
; ---------------------------------------------------------------------------
		jmp	short loc_181E
; ---------------------------------------------------------------------------

loc_1815:				; CODE XREF: _ubidi_reorderVisual_56+12Fj
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_8], eax

loc_181E:				; CODE XREF: _ubidi_reorderVisual_56+133j
		jmp	loc_175F
; ---------------------------------------------------------------------------

loc_1823:				; CODE XREF: _ubidi_reorderVisual_56+ABj
					; _ubidi_reorderVisual_56+131j
		mov	al, [ebp+var_41]
		sub	al, 1
		mov	[ebp+var_41], al
		movzx	ecx, [ebp+var_41]
		movzx	edx, [ebp+var_35]
		cmp	ecx, edx
		jge	loc_1758

loc_183B:				; CODE XREF: _ubidi_reorderVisual_56:loc_172Fj
					; _ubidi_reorderVisual_56+69j
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN23_1
		call	@_RTC_CheckStackVars@8 ; _RTC_CheckStackVars(x,x)
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 108h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_reorderVisual_56	endp

; ---------------------------------------------------------------------------
$LN23_1		dd 2			; DATA XREF: _ubidi_reorderVisual_56+15Fo
		dd offset $LN22_2

; =============== S U B	R O U T	I N E =======================================


$LN22_2		proc far		; DATA XREF: .text:00001864o
		retf
$LN22_2		endp

; ---------------------------------------------------------------------------
		db 3 dup(0FFh)
		dd 1
		dd offset $LN20_0	; "minLevel"
		dd 0FFFFFFBFh, 1
		dd offset $LN21_1	; "maxLevel"
$LN21_1		db 'maxLevel',0         ; DATA XREF: .text:0000187Co
$LN20_0		db 'minLevel',0         ; DATA XREF: .text:00001870o
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1894h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getVisualIndex_56
_ubidi_getVisualIndex_56 proc near

var_1CC		= dword	ptr -1CCh
var_104		= word ptr -104h
var_F8		= dword	ptr -0F8h
var_EC		= dword	ptr -0ECh
var_E0		= dword	ptr -0E0h
var_D4		= dword	ptr -0D4h
var_C8		= dword	ptr -0C8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A4		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1CCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_1CC]
		mov	ecx, 73h ; 's'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_8], 0FFFFFFFFh
		cmp	[ebp+arg_8], 0
		jz	short loc_18C7
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jle	short loc_18CF

loc_18C7:				; CODE XREF: _ubidi_getVisualIndex_56+29j
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_18CF:				; CODE XREF: _ubidi_getVisualIndex_56+31j
		cmp	[ebp+arg_0], 0
		jz	short loc_18F5
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_1906
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_18F5
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jz	short loc_1906

loc_18F5:				; CODE XREF: _ubidi_getVisualIndex_56+3Fj
					; _ubidi_getVisualIndex_56+51j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1Bh
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1906:				; CODE XREF: _ubidi_getVisualIndex_56+49j
					; _ubidi_getVisualIndex_56+5Fj
		cmp	[ebp+arg_4], 0
		jl	short loc_1917
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+10h]
		jl	short loc_1928

loc_1917:				; CODE XREF: _ubidi_getVisualIndex_56+76j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1928:				; CODE XREF: _ubidi_getVisualIndex_56+81j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+78h]
		mov	[ebp+var_1CC], ecx
		cmp	[ebp+var_1CC], 0
		jz	short loc_1948
		cmp	[ebp+var_1CC], 1
		jz	short loc_1953
		jmp	short loc_1967
; ---------------------------------------------------------------------------

loc_1948:				; CODE XREF: _ubidi_getVisualIndex_56+A7j
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_8], eax
		jmp	loc_1A5A
; ---------------------------------------------------------------------------

loc_1953:				; CODE XREF: _ubidi_getVisualIndex_56+B0j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		sub	ecx, [ebp+arg_4]
		sub	ecx, 1
		mov	[ebp+var_8], ecx
		jmp	loc_1A5A
; ---------------------------------------------------------------------------

loc_1967:				; CODE XREF: _ubidi_getVisualIndex_56+B2j
		mov	eax, [ebp+arg_8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_getRuns_56
		add	esp, 8
		movsx	edx, al
		test	edx, edx
		jnz	short loc_1994
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 7
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------
		jmp	loc_1A5A
; ---------------------------------------------------------------------------

loc_1994:				; CODE XREF: _ubidi_getVisualIndex_56+E8j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_14], ecx
		mov	[ebp+var_2C], 0
		mov	[ebp+var_20], 0
		jmp	short loc_19B9
; ---------------------------------------------------------------------------

loc_19B0:				; CODE XREF: _ubidi_getVisualIndex_56+1ABj
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax

loc_19B9:				; CODE XREF: _ubidi_getVisualIndex_56+11Aj
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_20]
		cmp	ecx, [eax+0E0h]
		jge	short loc_1A44
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_2C]
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+eax]
		and	edx, 7FFFFFFFh
		mov	eax, [ebp+arg_4]
		sub	eax, edx
		mov	[ebp+var_38], eax
		js	short loc_1A36
		mov	eax, [ebp+var_38]
		cmp	eax, [ebp+var_44]
		jge	short loc_1A36
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_14]
		mov	edx, [ecx+eax]
		and	edx, 80000000h
		setz	al
		movsx	ecx, al
		test	ecx, ecx
		jz	short loc_1A25
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+var_38]
		mov	[ebp+var_8], eax
		jmp	short loc_1A34
; ---------------------------------------------------------------------------

loc_1A25:				; CODE XREF: _ubidi_getVisualIndex_56+184j
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+var_44]
		sub	eax, [ebp+var_38]
		sub	eax, 1
		mov	[ebp+var_8], eax

loc_1A34:				; CODE XREF: _ubidi_getVisualIndex_56+18Fj
		jmp	short loc_1A44
; ---------------------------------------------------------------------------

loc_1A36:				; CODE XREF: _ubidi_getVisualIndex_56+160j
					; _ubidi_getVisualIndex_56+168j
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+var_44]
		mov	[ebp+var_2C], eax
		jmp	loc_19B0
; ---------------------------------------------------------------------------

loc_1A44:				; CODE XREF: _ubidi_getVisualIndex_56+131j
					; _ubidi_getVisualIndex_56:loc_1A34j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_20]
		cmp	ecx, [eax+0E0h]
		jl	short loc_1A5A
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1A5A:				; CODE XREF: _ubidi_getVisualIndex_56+BAj
					; _ubidi_getVisualIndex_56+CEj	...
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jle	loc_1B1D
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_50], ecx
		mov	[ebp+var_80], 0
		mov	[ebp+var_8C], 0
		mov	[ebp+var_5C], 0
		jmp	short loc_1AA2
; ---------------------------------------------------------------------------

loc_1A90:				; CODE XREF: _ubidi_getVisualIndex_56:loc_1B13j
		mov	eax, [ebp+var_5C]
		add	eax, 1
		mov	[ebp+var_5C], eax
		mov	ecx, [ebp+var_80]
		add	ecx, [ebp+var_68]
		mov	[ebp+var_80], ecx

loc_1AA2:				; CODE XREF: _ubidi_getVisualIndex_56+1FAj
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_80]
		mov	[ebp+var_68], edx
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_74], edx
		mov	eax, [ebp+var_74]
		and	eax, 5
		jz	short loc_1ADC
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax

loc_1ADC:				; CODE XREF: _ubidi_getVisualIndex_56+237j
		mov	eax, [ebp+var_5C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_50]
		mov	edx, [ebp+var_8]
		cmp	edx, [ecx+eax+4]
		jge	short loc_1AFC
		mov	eax, [ebp+var_8]
		add	eax, [ebp+var_8C]
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1AFC:				; CODE XREF: _ubidi_getVisualIndex_56+258j
		mov	eax, [ebp+var_74]
		and	eax, 0Ah
		jz	short loc_1B13
		mov	eax, [ebp+var_8C]
		add	eax, 1
		mov	[ebp+var_8C], eax

loc_1B13:				; CODE XREF: _ubidi_getVisualIndex_56+26Ej
		jmp	loc_1A90
; ---------------------------------------------------------------------------
		jmp	loc_1D55
; ---------------------------------------------------------------------------

loc_1B1D:				; CODE XREF: _ubidi_getVisualIndex_56+1D0j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_1D55
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_98], ecx
		mov	[ebp+var_EC], 0
		mov	[ebp+var_F8], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+arg_4]
		mov	ax, [ecx+edx*2]
		mov	[ebp+var_104], ax
		movzx	eax, [ebp+var_104]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_1B97
		movzx	eax, [ebp+var_104]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_1B97
		movzx	eax, [ebp+var_104]
		sub	eax, 2066h
		cmp	eax, 4
		jnb	short loc_1B9F

loc_1B97:				; CODE XREF: _ubidi_getVisualIndex_56+2DFj
					; _ubidi_getVisualIndex_56+2F0j
		or	eax, 0FFFFFFFFh
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1B9F:				; CODE XREF: _ubidi_getVisualIndex_56+301j
		mov	[ebp+var_A4], 0
		jmp	short loc_1BCC
; ---------------------------------------------------------------------------

loc_1BAB:				; CODE XREF: _ubidi_getVisualIndex_56+39Aj
					; _ubidi_getVisualIndex_56+4BCj
		mov	eax, [ebp+var_A4]
		add	eax, 1
		mov	[ebp+var_A4], eax
		mov	ecx, [ebp+var_EC]
		add	ecx, [ebp+var_D4]
		mov	[ebp+var_EC], ecx

loc_1BCC:				; CODE XREF: _ubidi_getVisualIndex_56+315j
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_EC]
		mov	[ebp+var_D4], edx
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_E0], edx
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ebp+var_8]
		cmp	edx, [ecx+eax+4]
		jl	short loc_1C33
		mov	eax, [ebp+var_F8]
		sub	eax, [ebp+var_E0]
		mov	[ebp+var_F8], eax
		jmp	loc_1BAB
; ---------------------------------------------------------------------------

loc_1C33:				; CODE XREF: _ubidi_getVisualIndex_56+386j
		cmp	[ebp+var_E0], 0
		jnz	short loc_1C4A
		mov	eax, [ebp+var_8]
		sub	eax, [ebp+var_F8]
		jmp	loc_1D58
; ---------------------------------------------------------------------------

loc_1C4A:				; CODE XREF: _ubidi_getVisualIndex_56+3A6j
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx+eax]
		and	edx, 80000000h
		setz	al
		movsx	ecx, al
		test	ecx, ecx
		jz	short loc_1C8F
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx+eax]
		mov	[ebp+var_BC], edx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_C8], eax
		jmp	short loc_1CBF
; ---------------------------------------------------------------------------

loc_1C8F:				; CODE XREF: _ubidi_getVisualIndex_56+3D6j
		mov	eax, [ebp+arg_4]
		add	eax, 1
		mov	[ebp+var_BC], eax
		mov	eax, [ebp+var_A4]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_98]
		mov	edx, [ecx+eax]
		and	edx, 7FFFFFFFh
		add	edx, [ebp+var_D4]
		mov	[ebp+var_C8], edx

loc_1CBF:				; CODE XREF: _ubidi_getVisualIndex_56+3F9j
		mov	eax, [ebp+var_BC]
		mov	[ebp+var_B0], eax
		jmp	short loc_1CDC
; ---------------------------------------------------------------------------

loc_1CCD:				; CODE XREF: _ubidi_getVisualIndex_56:loc_1D43j
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax

loc_1CDC:				; CODE XREF: _ubidi_getVisualIndex_56+437j
		mov	eax, [ebp+var_B0]
		cmp	eax, [ebp+var_C8]
		jge	short loc_1D45
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_B0]
		mov	ax, [ecx+edx*2]
		mov	[ebp+var_104], ax
		movzx	eax, [ebp+var_104]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_1D34
		movzx	eax, [ebp+var_104]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_1D34
		movzx	eax, [ebp+var_104]
		sub	eax, 2066h
		cmp	eax, 4
		jnb	short loc_1D43

loc_1D34:				; CODE XREF: _ubidi_getVisualIndex_56+47Cj
					; _ubidi_getVisualIndex_56+48Dj
		mov	eax, [ebp+var_F8]
		add	eax, 1
		mov	[ebp+var_F8], eax

loc_1D43:				; CODE XREF: _ubidi_getVisualIndex_56+49Ej
		jmp	short loc_1CCD
; ---------------------------------------------------------------------------

loc_1D45:				; CODE XREF: _ubidi_getVisualIndex_56+454j
		mov	eax, [ebp+var_8]
		sub	eax, [ebp+var_F8]
		jmp	short loc_1D58
; ---------------------------------------------------------------------------
		jmp	loc_1BAB
; ---------------------------------------------------------------------------

loc_1D55:				; CODE XREF: _ubidi_getVisualIndex_56+284j
					; _ubidi_getVisualIndex_56+293j
		mov	eax, [ebp+var_8]

loc_1D58:				; CODE XREF: _ubidi_getVisualIndex_56+36j
					; _ubidi_getVisualIndex_56+6Dj	...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1CCh
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getVisualIndex_56 endp

_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1D6Ch
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getLogicalIndex_56
_ubidi_getLogicalIndex_56 proc near

var_1B4		= dword	ptr -1B4h
var_EC		= dword	ptr -0ECh
var_E0		= dword	ptr -0E0h
var_D1		= byte ptr -0D1h
var_C8		= word ptr -0C8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A4		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1B4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_1B4]
		mov	ecx, 6Dh ; 'm'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_8], 0
		jz	short loc_1D98
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jle	short loc_1DA0

loc_1D98:				; CODE XREF: _ubidi_getLogicalIndex_56+22j
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1DA0:				; CODE XREF: _ubidi_getLogicalIndex_56+2Aj
		cmp	[ebp+arg_0], 0
		jz	short loc_1DC6
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		cmp	ecx, [ebp+arg_0]
		jz	short loc_1DD7
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax], 0
		jz	short loc_1DC6
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax]
		mov	edx, [ebp+arg_0]
		mov	eax, [ecx]
		cmp	eax, [edx]
		jz	short loc_1DD7

loc_1DC6:				; CODE XREF: _ubidi_getLogicalIndex_56+38j
					; _ubidi_getLogicalIndex_56+4Aj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1Bh
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1DD7:				; CODE XREF: _ubidi_getLogicalIndex_56+42j
					; _ubidi_getLogicalIndex_56+58j
		cmp	[ebp+arg_4], 0
		jl	short loc_1DE8
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		cmp	ecx, [eax+14h]
		jl	short loc_1DF9

loc_1DE8:				; CODE XREF: _ubidi_getLogicalIndex_56+6Fj
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1DF9:				; CODE XREF: _ubidi_getLogicalIndex_56+7Aj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jnz	short loc_1E3E
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jnz	short loc_1E3E
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 0
		jnz	short loc_1E24
		mov	eax, [ebp+arg_4]
		jmp	loc_222C
; ---------------------------------------------------------------------------
		jmp	short loc_1E3E
; ---------------------------------------------------------------------------

loc_1E24:				; CODE XREF: _ubidi_getLogicalIndex_56+ACj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+78h], 1
		jnz	short loc_1E3E
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+10h]
		sub	eax, [ebp+arg_4]
		sub	eax, 1
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1E3E:				; CODE XREF: _ubidi_getLogicalIndex_56+97j
					; _ubidi_getLogicalIndex_56+A3j ...
		mov	eax, [ebp+arg_8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_getRuns_56
		add	esp, 8
		movsx	edx, al
		test	edx, edx
		jnz	short loc_1E66
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 7
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1E66:				; CODE XREF: _ubidi_getLogicalIndex_56+E7j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jle	loc_1F5B
		mov	[ebp+var_38], 0
		mov	[ebp+var_50], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	[ebp+var_14], 0
		jmp	short loc_1EC3
; ---------------------------------------------------------------------------

loc_1EB1:				; CODE XREF: _ubidi_getLogicalIndex_56:loc_1F51j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+var_50]
		add	ecx, [ebp+var_5C]
		mov	[ebp+var_50], ecx

loc_1EC3:				; CODE XREF: _ubidi_getLogicalIndex_56+143j
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_50]
		mov	[ebp+var_5C], edx
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		and	eax, 5
		jz	short loc_1F0A
		mov	eax, [ebp+var_50]
		add	eax, [ebp+var_38]
		cmp	[ebp+arg_4], eax
		jg	short loc_1F01
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1F01:				; CODE XREF: _ubidi_getLogicalIndex_56+18Bj
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax

loc_1F0A:				; CODE XREF: _ubidi_getLogicalIndex_56+180j
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		add	edx, [ebp+var_38]
		cmp	[ebp+arg_4], edx
		jge	short loc_1F2A
		mov	eax, [ebp+arg_4]
		sub	eax, [ebp+var_38]
		mov	[ebp+arg_4], eax
		jmp	short loc_1F56
; ---------------------------------------------------------------------------

loc_1F2A:				; CODE XREF: _ubidi_getLogicalIndex_56+1B1j
		mov	eax, [ebp+var_44]
		and	eax, 0Ah
		jz	short loc_1F51
		mov	eax, [ebp+var_50]
		add	eax, [ebp+var_5C]
		add	eax, [ebp+var_38]
		cmp	[ebp+arg_4], eax
		jnz	short loc_1F48
		or	eax, 0FFFFFFFFh
		jmp	loc_222C
; ---------------------------------------------------------------------------

loc_1F48:				; CODE XREF: _ubidi_getLogicalIndex_56+1D2j
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_38], eax

loc_1F51:				; CODE XREF: _ubidi_getLogicalIndex_56+1C4j
		jmp	loc_1EB1
; ---------------------------------------------------------------------------

loc_1F56:				; CODE XREF: _ubidi_getLogicalIndex_56+1BCj
		jmp	loc_212B
; ---------------------------------------------------------------------------

loc_1F5B:				; CODE XREF: _ubidi_getLogicalIndex_56+11Cj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_212B
		mov	[ebp+var_68], 0
		mov	[ebp+var_A4], 0
		mov	[ebp+var_14], 0
		jmp	short loc_1F9D
; ---------------------------------------------------------------------------

loc_1F85:				; CODE XREF: _ubidi_getLogicalIndex_56+278j
					; _ubidi_getLogicalIndex_56+3BAj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	ecx, [ebp+var_A4]
		add	ecx, [ebp+var_80]
		mov	[ebp+var_A4], ecx

loc_1F9D:				; CODE XREF: _ubidi_getLogicalIndex_56+217j
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_A4]
		mov	[ebp+var_80], edx
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_74], edx
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_68]
		add	edx, [ebp+var_74]
		cmp	[ebp+arg_4], edx
		jl	short loc_1FE6
		mov	eax, [ebp+var_68]
		sub	eax, [ebp+var_74]
		mov	[ebp+var_68], eax
		jmp	short loc_1F85
; ---------------------------------------------------------------------------

loc_1FE6:				; CODE XREF: _ubidi_getLogicalIndex_56+26Dj
		cmp	[ebp+var_74], 0
		jnz	short loc_1FFA
		mov	eax, [ebp+arg_4]
		add	eax, [ebp+var_68]
		mov	[ebp+arg_4], eax
		jmp	loc_212B
; ---------------------------------------------------------------------------

loc_1FFA:				; CODE XREF: _ubidi_getLogicalIndex_56+27Ej
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax]
		mov	[ebp+var_8C], edx
		mov	eax, [ebp+var_8C]
		and	eax, 80000000h
		setz	cl
		mov	[ebp+var_D1], cl
		mov	eax, [ebp+var_8C]
		and	eax, 7FFFFFFFh
		mov	[ebp+var_8C], eax
		mov	eax, [ebp+var_80]
		mov	ecx, [ebp+var_8C]
		lea	edx, [ecx+eax-1]
		mov	[ebp+var_98], edx
		mov	[ebp+var_B0], 0
		jmp	short loc_205F
; ---------------------------------------------------------------------------

loc_2050:				; CODE XREF: _ubidi_getLogicalIndex_56:loc_2116j
		mov	eax, [ebp+var_B0]
		add	eax, 1
		mov	[ebp+var_B0], eax

loc_205F:				; CODE XREF: _ubidi_getLogicalIndex_56+2E2j
		mov	eax, [ebp+var_B0]
		cmp	eax, [ebp+var_80]
		jge	loc_211B
		movsx	eax, [ebp+var_D1]
		test	eax, eax
		jz	short loc_208D
		mov	ecx, [ebp+var_8C]
		add	ecx, [ebp+var_B0]
		mov	[ebp+var_1B4], ecx
		jmp	short loc_209F
; ---------------------------------------------------------------------------

loc_208D:				; CODE XREF: _ubidi_getLogicalIndex_56+30Bj
		mov	edx, [ebp+var_98]
		sub	edx, [ebp+var_B0]
		mov	[ebp+var_1B4], edx

loc_209F:				; CODE XREF: _ubidi_getLogicalIndex_56+31Fj
		mov	eax, [ebp+var_1B4]
		mov	[ebp+var_BC], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_BC]
		mov	ax, [ecx+edx*2]
		mov	[ebp+var_C8], ax
		movzx	eax, [ebp+var_C8]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_20F5
		movzx	eax, [ebp+var_C8]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_20F5
		movzx	eax, [ebp+var_C8]
		sub	eax, 2066h
		cmp	eax, 4
		jnb	short loc_20FE

loc_20F5:				; CODE XREF: _ubidi_getLogicalIndex_56+365j
					; _ubidi_getLogicalIndex_56+376j
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_20FE:				; CODE XREF: _ubidi_getLogicalIndex_56+387j
		mov	eax, [ebp+arg_4]
		add	eax, [ebp+var_68]
		mov	ecx, [ebp+var_A4]
		add	ecx, [ebp+var_B0]
		cmp	eax, ecx
		jnz	short loc_2116
		jmp	short loc_211B
; ---------------------------------------------------------------------------

loc_2116:				; CODE XREF: _ubidi_getLogicalIndex_56+3A6j
		jmp	loc_2050
; ---------------------------------------------------------------------------

loc_211B:				; CODE XREF: _ubidi_getLogicalIndex_56+2FCj
					; _ubidi_getLogicalIndex_56+3A8j
		mov	eax, [ebp+arg_4]
		add	eax, [ebp+var_68]
		mov	[ebp+arg_4], eax
		jmp	short loc_212B
; ---------------------------------------------------------------------------
		jmp	loc_1F85
; ---------------------------------------------------------------------------

loc_212B:				; CODE XREF: _ubidi_getLogicalIndex_56:loc_1F56j
					; _ubidi_getLogicalIndex_56+1F9j ...
		cmp	[ebp+var_20], 0Ah
		jg	short loc_2159
		mov	[ebp+var_14], 0
		jmp	short loc_2143
; ---------------------------------------------------------------------------

loc_213A:				; CODE XREF: _ubidi_getLogicalIndex_56+3E9j
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax

loc_2143:				; CODE XREF: _ubidi_getLogicalIndex_56+3CCj
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		cmp	edx, [ecx+eax+4]
		jl	short loc_2157
		jmp	short loc_213A
; ---------------------------------------------------------------------------

loc_2157:				; CODE XREF: _ubidi_getLogicalIndex_56+3E7j
		jmp	short loc_21CA
; ---------------------------------------------------------------------------

loc_2159:				; CODE XREF: _ubidi_getLogicalIndex_56+3C3j
		mov	[ebp+var_E0], 0
		mov	eax, [ebp+var_20]
		mov	[ebp+var_EC], eax

loc_216C:				; CODE XREF: _ubidi_getLogicalIndex_56:loc_21C8j
		mov	eax, [ebp+var_E0]
		add	eax, [ebp+var_EC]
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		cmp	edx, [ecx+eax+4]
		jl	short loc_21A0
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_E0], eax
		jmp	short loc_21C8
; ---------------------------------------------------------------------------

loc_21A0:				; CODE XREF: _ubidi_getLogicalIndex_56+424j
		cmp	[ebp+var_14], 0
		jz	short loc_21BB
		mov	eax, [ebp+var_14]
		sub	eax, 1
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		cmp	edx, [ecx+eax+4]
		jl	short loc_21BF

loc_21BB:				; CODE XREF: _ubidi_getLogicalIndex_56+438j
		jmp	short loc_21CA
; ---------------------------------------------------------------------------
		jmp	short loc_21C8
; ---------------------------------------------------------------------------

loc_21BF:				; CODE XREF: _ubidi_getLogicalIndex_56+44Dj
		mov	eax, [ebp+var_14]
		mov	[ebp+var_EC], eax

loc_21C8:				; CODE XREF: _ubidi_getLogicalIndex_56+432j
					; _ubidi_getLogicalIndex_56+451j
		jmp	short loc_216C
; ---------------------------------------------------------------------------

loc_21CA:				; CODE XREF: _ubidi_getLogicalIndex_56:loc_2157j
					; _ubidi_getLogicalIndex_56:loc_21BBj
		mov	eax, [ebp+var_14]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax]
		mov	[ebp+var_2C], edx
		mov	eax, [ebp+var_2C]
		and	eax, 80000000h
		setz	cl
		movsx	edx, cl
		test	edx, edx
		jz	short loc_2211
		cmp	[ebp+var_14], 0
		jle	short loc_2207
		mov	eax, [ebp+var_14]
		sub	eax, 1
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ebp+arg_4]
		sub	edx, [ecx+eax+4]
		mov	[ebp+arg_4], edx

loc_2207:				; CODE XREF: _ubidi_getLogicalIndex_56+483j
		mov	eax, [ebp+var_2C]
		add	eax, [ebp+arg_4]
		jmp	short loc_222C
; ---------------------------------------------------------------------------
		jmp	short loc_222C
; ---------------------------------------------------------------------------

loc_2211:				; CODE XREF: _ubidi_getLogicalIndex_56+47Dj
		mov	eax, [ebp+var_2C]
		and	eax, 7FFFFFFFh
		mov	ecx, [ebp+var_14]
		imul	ecx, 0Ch
		mov	edx, [ebp+var_8]
		add	eax, [edx+ecx+4]
		sub	eax, [ebp+arg_4]
		sub	eax, 1

loc_222C:				; CODE XREF: _ubidi_getLogicalIndex_56+2Fj
					; _ubidi_getLogicalIndex_56+66j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1B4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getLogicalIndex_56 endp

_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 2240h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ubidi_getLogicalMap_56(int, void *Dst, int)
		public _ubidi_getLogicalMap_56
_ubidi_getLogicalMap_56	proc near

var_19C		= dword	ptr -19Ch
var_D4		= word ptr -0D4h
var_C5		= byte ptr -0C5h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A4		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 19Ch
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_19C]
		mov	ecx, 67h ; 'g'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_8], 0
		jz	short loc_226C
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jle	short loc_2271

loc_226C:				; CODE XREF: _ubidi_getLogicalMap_56+22j
		jmp	loc_2697
; ---------------------------------------------------------------------------

loc_2271:				; CODE XREF: _ubidi_getLogicalMap_56+2Aj
		mov	eax, [ebp+arg_8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_countRuns_56
		add	esp, 8
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jle	short loc_228E
		jmp	loc_2697
; ---------------------------------------------------------------------------

loc_228E:				; CODE XREF: _ubidi_getLogicalMap_56+47j
		cmp	[ebp+Dst], 0
		jnz	short loc_22A2
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		jmp	loc_2697
; ---------------------------------------------------------------------------

loc_22A2:				; CODE XREF: _ubidi_getLogicalMap_56+52j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_5C], ecx
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+10h], 0
		jg	short loc_22BC
		jmp	loc_2697
; ---------------------------------------------------------------------------

loc_22BC:				; CODE XREF: _ubidi_getLogicalMap_56+75j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_0]
		mov	edx, [eax+10h]
		cmp	edx, [ecx+14h]
		jle	short loc_22E5
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+10h]
		shl	ecx, 2
		push	ecx		; Size
		push	0FFh		; Val
		mov	edx, [ebp+Dst]
		push	edx		; Dst
		call	_memset
		add	esp, 0Ch

loc_22E5:				; CODE XREF: _ubidi_getLogicalMap_56+88j
		mov	[ebp+var_8], 0
		mov	[ebp+var_2C], 0
		jmp	short loc_22FE
; ---------------------------------------------------------------------------

loc_22F5:				; CODE XREF: _ubidi_getLogicalMap_56:loc_23ABj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_22FE:				; CODE XREF: _ubidi_getLogicalMap_56+B3j
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+var_2C]
		cmp	ecx, [eax+0E0h]
		jge	loc_23B0
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax]
		and	edx, 7FFFFFFFh
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax+4]
		mov	[ebp+var_14], edx
		mov	eax, [ebp+var_2C]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax]
		and	edx, 80000000h
		setz	al
		movsx	ecx, al
		test	ecx, ecx
		jz	short loc_2379

loc_2351:				; CODE XREF: _ubidi_getLogicalMap_56+135j
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+Dst]
		mov	edx, [ebp+var_8]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_44]
		add	eax, 1
		mov	[ebp+var_44], eax
		mov	ecx, [ebp+var_8]
		add	ecx, 1
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jl	short loc_2351
		jmp	short loc_23AB
; ---------------------------------------------------------------------------

loc_2379:				; CODE XREF: _ubidi_getLogicalMap_56+10Fj
		mov	eax, [ebp+var_14]
		sub	eax, [ebp+var_8]
		add	eax, [ebp+var_44]
		mov	[ebp+var_44], eax

loc_2385:				; CODE XREF: _ubidi_getLogicalMap_56+169j
		mov	eax, [ebp+var_44]
		sub	eax, 1
		mov	[ebp+var_44], eax
		mov	ecx, [ebp+var_44]
		mov	edx, [ebp+Dst]
		mov	eax, [ebp+var_8]
		mov	[edx+ecx*4], eax
		mov	ecx, [ebp+var_8]
		add	ecx, 1
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jl	short loc_2385

loc_23AB:				; CODE XREF: _ubidi_getLogicalMap_56+137j
		jmp	loc_22F5
; ---------------------------------------------------------------------------

loc_23B0:				; CODE XREF: _ubidi_getLogicalMap_56+CAj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jle	loc_24AD
		mov	[ebp+var_68], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_74], ecx
		mov	[ebp+var_8], 0
		mov	[ebp+var_20], 0
		jmp	short loc_23F5
; ---------------------------------------------------------------------------

loc_23E3:				; CODE XREF: _ubidi_getLogicalMap_56:loc_24A3j
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_8]
		add	ecx, [ebp+var_80]
		mov	[ebp+var_8], ecx

loc_23F5:				; CODE XREF: _ubidi_getLogicalMap_56+1A1j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_74]
		jge	loc_24A8
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_8]
		mov	[ebp+var_80], edx
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_8C], edx
		mov	eax, [ebp+var_8C]
		and	eax, 5
		jz	short loc_243B
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_243B:				; CODE XREF: _ubidi_getLogicalMap_56+1F0j
		cmp	[ebp+var_68], 0
		jle	short loc_248F
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax]
		and	edx, 7FFFFFFFh
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		add	eax, [ebp+var_80]
		mov	[ebp+var_50], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+var_2C], eax
		jmp	short loc_2470
; ---------------------------------------------------------------------------

loc_2467:				; CODE XREF: _ubidi_getLogicalMap_56+24Dj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_2470:				; CODE XREF: _ubidi_getLogicalMap_56+225j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_50]
		jge	short loc_248F
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+eax*4]
		add	edx, [ebp+var_68]
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+Dst]
		mov	[ecx+eax*4], edx
		jmp	short loc_2467
; ---------------------------------------------------------------------------

loc_248F:				; CODE XREF: _ubidi_getLogicalMap_56+1FFj
					; _ubidi_getLogicalMap_56+236j
		mov	eax, [ebp+var_8C]
		and	eax, 0Ah
		jz	short loc_24A3
		mov	eax, [ebp+var_68]
		add	eax, 1
		mov	[ebp+var_68], eax

loc_24A3:				; CODE XREF: _ubidi_getLogicalMap_56+258j
		jmp	loc_23E3
; ---------------------------------------------------------------------------

loc_24A8:				; CODE XREF: _ubidi_getLogicalMap_56+1BBj
		jmp	loc_2697
; ---------------------------------------------------------------------------

loc_24AD:				; CODE XREF: _ubidi_getLogicalMap_56+17Aj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_2697
		mov	[ebp+var_98], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_A4], ecx
		mov	[ebp+var_8], 0
		mov	[ebp+var_20], 0
		jmp	short loc_24FB
; ---------------------------------------------------------------------------

loc_24E6:				; CODE XREF: _ubidi_getLogicalMap_56+301j
					; _ubidi_getLogicalMap_56:loc_25B6j ...
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_8]
		add	ecx, [ebp+var_B0]
		mov	[ebp+var_8], ecx

loc_24FB:				; CODE XREF: _ubidi_getLogicalMap_56+2A4j
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_A4]
		jge	loc_2697
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_8]
		mov	[ebp+var_B0], edx
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_BC], edx
		mov	eax, [ebp+var_98]
		sub	eax, [ebp+var_BC]
		jnz	short loc_2543
		jmp	short loc_24E6
; ---------------------------------------------------------------------------

loc_2543:				; CODE XREF: _ubidi_getLogicalMap_56+2FFj
		mov	eax, [ebp+var_20]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_5C]
		mov	edx, [ecx+eax]
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_44]
		and	eax, 80000000h
		setz	cl
		mov	[ebp+var_C5], cl
		mov	eax, [ebp+var_44]
		and	eax, 7FFFFFFFh
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_44]
		add	eax, [ebp+var_B0]
		mov	[ebp+var_50], eax
		cmp	[ebp+var_BC], 0
		jnz	short loc_25BB
		mov	eax, [ebp+var_44]
		mov	[ebp+var_2C], eax
		jmp	short loc_2594
; ---------------------------------------------------------------------------

loc_258B:				; CODE XREF: _ubidi_getLogicalMap_56+374j
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_2594:				; CODE XREF: _ubidi_getLogicalMap_56+349j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_50]
		jge	short loc_25B6
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+eax*4]
		sub	edx, [ebp+var_98]
		mov	eax, [ebp+var_2C]
		mov	ecx, [ebp+Dst]
		mov	[ecx+eax*4], edx
		jmp	short loc_258B
; ---------------------------------------------------------------------------

loc_25B6:				; CODE XREF: _ubidi_getLogicalMap_56+35Aj
		jmp	loc_24E6
; ---------------------------------------------------------------------------

loc_25BB:				; CODE XREF: _ubidi_getLogicalMap_56+341j
		mov	[ebp+var_2C], 0
		jmp	short loc_25CD
; ---------------------------------------------------------------------------

loc_25C4:				; CODE XREF: _ubidi_getLogicalMap_56+430j
					; _ubidi_getLogicalMap_56+44Dj
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax

loc_25CD:				; CODE XREF: _ubidi_getLogicalMap_56+382j
		mov	eax, [ebp+var_2C]
		cmp	eax, [ebp+var_B0]
		jge	loc_2692
		movsx	eax, [ebp+var_C5]
		test	eax, eax
		jz	short loc_25F5
		mov	ecx, [ebp+var_44]
		add	ecx, [ebp+var_2C]
		mov	[ebp+var_19C], ecx
		jmp	short loc_2604
; ---------------------------------------------------------------------------

loc_25F5:				; CODE XREF: _ubidi_getLogicalMap_56+3A5j
		mov	edx, [ebp+var_50]
		sub	edx, [ebp+var_2C]
		sub	edx, 1
		mov	[ebp+var_19C], edx

loc_2604:				; CODE XREF: _ubidi_getLogicalMap_56+3B3j
		mov	eax, [ebp+var_19C]
		mov	[ebp+var_38], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_38]
		mov	ax, [ecx+edx*2]
		mov	[ebp+var_D4], ax
		movzx	eax, [ebp+var_D4]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_2654
		movzx	eax, [ebp+var_D4]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_2654
		movzx	eax, [ebp+var_D4]
		sub	eax, 2066h
		cmp	eax, 4
		jnb	short loc_2675

loc_2654:				; CODE XREF: _ubidi_getLogicalMap_56+3F0j
					; _ubidi_getLogicalMap_56+401j
		mov	eax, [ebp+var_98]
		add	eax, 1
		mov	[ebp+var_98], eax
		mov	eax, [ebp+var_38]
		mov	ecx, [ebp+Dst]
		mov	dword ptr [ecx+eax*4], 0FFFFFFFFh
		jmp	loc_25C4
; ---------------------------------------------------------------------------

loc_2675:				; CODE XREF: _ubidi_getLogicalMap_56+412j
		mov	eax, [ebp+var_38]
		mov	ecx, [ebp+Dst]
		mov	edx, [ecx+eax*4]
		sub	edx, [ebp+var_98]
		mov	eax, [ebp+var_38]
		mov	ecx, [ebp+Dst]
		mov	[ecx+eax*4], edx
		jmp	loc_25C4
; ---------------------------------------------------------------------------

loc_2692:				; CODE XREF: _ubidi_getLogicalMap_56+396j
		jmp	loc_24E6
; ---------------------------------------------------------------------------

loc_2697:				; CODE XREF: _ubidi_getLogicalMap_56:loc_226Cj
					; _ubidi_getLogicalMap_56+49j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 19Ch
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getLogicalMap_56	endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 26ACh
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _ubidi_getVisualMap_56
_ubidi_getVisualMap_56 proc near

var_1CC		= dword	ptr -1CCh
var_101		= byte ptr -101h
var_F8		= word ptr -0F8h
var_EC		= dword	ptr -0ECh
var_E0		= dword	ptr -0E0h
var_D4		= dword	ptr -0D4h
var_C8		= dword	ptr -0C8h
var_BC		= dword	ptr -0BCh
var_B0		= dword	ptr -0B0h
var_A4		= dword	ptr -0A4h
var_98		= dword	ptr -98h
var_8C		= dword	ptr -8Ch
var_80		= dword	ptr -80h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 1CCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_1CC]
		mov	ecx, 73h ; 's'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_8], 0
		jz	short loc_26D8
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jle	short loc_26DD

loc_26D8:				; CODE XREF: _ubidi_getVisualMap_56+22j
		jmp	loc_2BFD
; ---------------------------------------------------------------------------

loc_26DD:				; CODE XREF: _ubidi_getVisualMap_56+2Aj
		cmp	[ebp+arg_4], 0
		jnz	short loc_26F1
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 1
		jmp	loc_2BFD
; ---------------------------------------------------------------------------

loc_26F1:				; CODE XREF: _ubidi_getVisualMap_56+35j
		mov	eax, [ebp+arg_8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_ubidi_countRuns_56
		add	esp, 8
		mov	eax, [ebp+arg_8]
		cmp	dword ptr [eax], 0
		jg	loc_2BFD
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		imul	ecx, 0Ch
		add	ecx, [ebp+var_8]
		mov	[ebp+var_14], ecx
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_44], eax
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+14h], 0
		jg	short loc_273F
		jmp	loc_2BFD
; ---------------------------------------------------------------------------

loc_273F:				; CODE XREF: _ubidi_getVisualMap_56+8Cj
		mov	[ebp+var_2C], 0
		jmp	short loc_2751
; ---------------------------------------------------------------------------

loc_2748:				; CODE XREF: _ubidi_getVisualMap_56:loc_27EFj
		mov	eax, [ebp+var_8]
		add	eax, 0Ch
		mov	[ebp+var_8], eax

loc_2751:				; CODE XREF: _ubidi_getVisualMap_56+9Aj
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jnb	loc_27F4
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax+4]
		mov	[ebp+var_38], ecx
		mov	eax, [ebp+var_20]
		and	eax, 80000000h
		setz	cl
		movsx	edx, cl
		test	edx, edx
		jz	short loc_27AD

loc_2780:				; CODE XREF: _ubidi_getVisualMap_56+FDj
		mov	eax, [ebp+var_44]
		mov	ecx, [ebp+var_20]
		mov	[eax], ecx
		mov	edx, [ebp+var_44]
		add	edx, 4
		mov	[ebp+var_44], edx
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		cmp	ecx, [ebp+var_38]
		jl	short loc_2780
		jmp	short loc_27EF
; ---------------------------------------------------------------------------

loc_27AD:				; CODE XREF: _ubidi_getVisualMap_56+D2j
		mov	eax, [ebp+var_20]
		and	eax, 7FFFFFFFh
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_38]
		sub	eax, [ebp+var_2C]
		add	eax, [ebp+var_20]
		mov	[ebp+var_20], eax

loc_27C4:				; CODE XREF: _ubidi_getVisualMap_56+141j
		mov	eax, [ebp+var_20]
		sub	eax, 1
		mov	[ebp+var_20], eax
		mov	ecx, [ebp+var_44]
		mov	edx, [ebp+var_20]
		mov	[ecx], edx
		mov	eax, [ebp+var_44]
		add	eax, 4
		mov	[ebp+var_44], eax
		mov	eax, [ebp+var_2C]
		add	eax, 1
		mov	[ebp+var_2C], eax
		mov	ecx, [ebp+var_2C]
		cmp	ecx, [ebp+var_38]
		jl	short loc_27C4

loc_27EF:				; CODE XREF: _ubidi_getVisualMap_56+FFj
		jmp	loc_2748
; ---------------------------------------------------------------------------

loc_27F4:				; CODE XREF: _ubidi_getVisualMap_56+ABj
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+150h], 0
		jle	loc_29A2
		mov	[ebp+var_50], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_5C], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	[ebp+var_74], 0
		jmp	short loc_2835
; ---------------------------------------------------------------------------

loc_282C:				; CODE XREF: _ubidi_getVisualMap_56:loc_286Fj
		mov	eax, [ebp+var_74]
		add	eax, 1
		mov	[ebp+var_74], eax

loc_2835:				; CODE XREF: _ubidi_getVisualMap_56+17Ej
		mov	eax, [ebp+var_74]
		cmp	eax, [ebp+var_5C]
		jge	short loc_2871
		mov	eax, [ebp+var_74]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_68], edx
		mov	eax, [ebp+var_68]
		and	eax, 5
		jz	short loc_285E
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_50], eax

loc_285E:				; CODE XREF: _ubidi_getVisualMap_56+1A7j
		mov	eax, [ebp+var_68]
		and	eax, 0Ah
		jz	short loc_286F
		mov	eax, [ebp+var_50]
		add	eax, 1
		mov	[ebp+var_50], eax

loc_286F:				; CODE XREF: _ubidi_getVisualMap_56+1B8j
		jmp	short loc_282C
; ---------------------------------------------------------------------------

loc_2871:				; CODE XREF: _ubidi_getVisualMap_56+18Fj
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+14h]
		mov	[ebp+var_8C], ecx
		mov	eax, [ebp+var_5C]
		sub	eax, 1
		mov	[ebp+var_74], eax
		jmp	short loc_2891
; ---------------------------------------------------------------------------

loc_2888:				; CODE XREF: _ubidi_getVisualMap_56:loc_2998j
		mov	eax, [ebp+var_74]
		sub	eax, 1
		mov	[ebp+var_74], eax

loc_2891:				; CODE XREF: _ubidi_getVisualMap_56+1DAj
		cmp	[ebp+var_74], 0
		jl	loc_299D
		cmp	[ebp+var_50], 0
		jle	loc_299D
		mov	eax, [ebp+var_74]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_68], edx
		mov	eax, [ebp+var_68]
		and	eax, 0Ah
		jz	short loc_28E5
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	ecx, [ebp+var_8C]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [edx+ecx*4], 0FFFFFFFFh
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_50], eax

loc_28E5:				; CODE XREF: _ubidi_getVisualMap_56+20Fj
		cmp	[ebp+var_74], 0
		jle	short loc_2903
		mov	eax, [ebp+var_74]
		sub	eax, 1
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		mov	[ebp+var_1CC], edx
		jmp	short loc_290D
; ---------------------------------------------------------------------------

loc_2903:				; CODE XREF: _ubidi_getVisualMap_56+23Dj
		mov	[ebp+var_1CC], 0

loc_290D:				; CODE XREF: _ubidi_getVisualMap_56+255j
		mov	eax, [ebp+var_1CC]
		mov	[ebp+var_2C], eax
		mov	eax, [ebp+var_74]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, 1
		mov	[ebp+var_80], edx
		jmp	short loc_2934
; ---------------------------------------------------------------------------

loc_292B:				; CODE XREF: _ubidi_getVisualMap_56+2BAj
		mov	eax, [ebp+var_80]
		sub	eax, 1
		mov	[ebp+var_80], eax

loc_2934:				; CODE XREF: _ubidi_getVisualMap_56+27Dj
		mov	eax, [ebp+var_80]
		cmp	eax, [ebp+var_2C]
		jl	short loc_2968
		cmp	[ebp+var_50], 0
		jle	short loc_2968
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	ecx, [ebp+var_8C]
		mov	edx, [ebp+arg_4]
		mov	eax, [ebp+var_80]
		mov	esi, [ebp+arg_4]
		mov	eax, [esi+eax*4]
		mov	[edx+ecx*4], eax
		jmp	short loc_292B
; ---------------------------------------------------------------------------

loc_2968:				; CODE XREF: _ubidi_getVisualMap_56+28Ej
					; _ubidi_getVisualMap_56+294j
		mov	eax, [ebp+var_68]
		and	eax, 5
		jz	short loc_2998
		mov	eax, [ebp+var_8C]
		sub	eax, 1
		mov	[ebp+var_8C], eax
		mov	ecx, [ebp+var_8C]
		mov	edx, [ebp+arg_4]
		mov	dword ptr [edx+ecx*4], 0FFFFFFFFh
		mov	eax, [ebp+var_50]
		sub	eax, 1
		mov	[ebp+var_50], eax

loc_2998:				; CODE XREF: _ubidi_getVisualMap_56+2C2j
		jmp	loc_2888
; ---------------------------------------------------------------------------

loc_299D:				; CODE XREF: _ubidi_getVisualMap_56+1E9j
					; _ubidi_getVisualMap_56+1F3j
		jmp	loc_2BFD
; ---------------------------------------------------------------------------

loc_29A2:				; CODE XREF: _ubidi_getVisualMap_56+152j
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+160h], 0
		jle	loc_2BFD
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E0h]
		mov	[ebp+var_98], ecx
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+0E4h]
		mov	[ebp+var_8], ecx
		mov	[ebp+var_2C], 0
		mov	[ebp+var_E0], 0
		mov	[ebp+var_C8], 0
		jmp	short loc_2A05
; ---------------------------------------------------------------------------

loc_29EA:				; CODE XREF: _ubidi_getVisualMap_56+3C0j
					; _ubidi_getVisualMap_56:loc_2ADBj ...
		mov	eax, [ebp+var_C8]
		add	eax, 1
		mov	[ebp+var_C8], eax
		mov	ecx, [ebp+var_2C]
		add	ecx, [ebp+var_BC]
		mov	[ebp+var_2C], ecx

loc_2A05:				; CODE XREF: _ubidi_getVisualMap_56+33Cj
		mov	eax, [ebp+var_C8]
		cmp	eax, [ebp+var_98]
		jge	loc_2BFD
		mov	eax, [ebp+var_C8]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		sub	edx, [ebp+var_2C]
		mov	[ebp+var_BC], edx
		mov	eax, [ebp+var_C8]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+8]
		mov	[ebp+var_B0], edx
		cmp	[ebp+var_B0], 0
		jnz	short loc_2A71
		mov	eax, [ebp+var_E0]
		cmp	eax, [ebp+var_2C]
		jnz	short loc_2A71
		mov	eax, [ebp+var_E0]
		add	eax, [ebp+var_BC]
		mov	[ebp+var_E0], eax
		jmp	loc_29EA
; ---------------------------------------------------------------------------

loc_2A71:				; CODE XREF: _ubidi_getVisualMap_56+3A1j
					; _ubidi_getVisualMap_56+3ACj
		cmp	[ebp+var_B0], 0
		jnz	short loc_2AE0
		mov	eax, [ebp+var_C8]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax+4]
		mov	[ebp+var_38], edx
		mov	eax, [ebp+var_2C]
		mov	[ebp+var_D4], eax
		jmp	short loc_2AA7
; ---------------------------------------------------------------------------

loc_2A98:				; CODE XREF: _ubidi_getVisualMap_56+42Dj
		mov	eax, [ebp+var_D4]
		add	eax, 1
		mov	[ebp+var_D4], eax

loc_2AA7:				; CODE XREF: _ubidi_getVisualMap_56+3EAj
		mov	eax, [ebp+var_D4]
		cmp	eax, [ebp+var_38]
		jge	short loc_2ADB
		mov	eax, [ebp+var_E0]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+var_D4]
		mov	esi, [ebp+arg_4]
		mov	edx, [esi+edx*4]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_E0]
		add	eax, 1
		mov	[ebp+var_E0], eax
		jmp	short loc_2A98
; ---------------------------------------------------------------------------

loc_2ADB:				; CODE XREF: _ubidi_getVisualMap_56+404j
		jmp	loc_29EA
; ---------------------------------------------------------------------------

loc_2AE0:				; CODE XREF: _ubidi_getVisualMap_56+3CCj
		mov	eax, [ebp+var_C8]
		imul	eax, 0Ch
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax]
		mov	[ebp+var_20], edx
		mov	eax, [ebp+var_20]
		and	eax, 80000000h
		setz	cl
		mov	[ebp+var_101], cl
		mov	eax, [ebp+var_20]
		and	eax, 7FFFFFFFh
		mov	[ebp+var_20], eax
		mov	eax, [ebp+var_BC]
		mov	ecx, [ebp+var_20]
		lea	edx, [ecx+eax-1]
		mov	[ebp+var_A4], edx
		mov	[ebp+var_D4], 0
		jmp	short loc_2B3C
; ---------------------------------------------------------------------------

loc_2B2D:				; CODE XREF: _ubidi_getVisualMap_56:loc_2BF3j
		mov	eax, [ebp+var_D4]
		add	eax, 1
		mov	[ebp+var_D4], eax

loc_2B3C:				; CODE XREF: _ubidi_getVisualMap_56+47Fj
		mov	eax, [ebp+var_D4]
		cmp	eax, [ebp+var_BC]
		jge	loc_2BF8
		movsx	eax, [ebp+var_101]
		test	eax, eax
		jz	short loc_2B6A
		mov	ecx, [ebp+var_20]
		add	ecx, [ebp+var_D4]
		mov	[ebp+var_1CC], ecx
		jmp	short loc_2B7C
; ---------------------------------------------------------------------------

loc_2B6A:				; CODE XREF: _ubidi_getVisualMap_56+4ABj
		mov	edx, [ebp+var_A4]
		sub	edx, [ebp+var_D4]
		mov	[ebp+var_1CC], edx

loc_2B7C:				; CODE XREF: _ubidi_getVisualMap_56+4BCj
		mov	eax, [ebp+var_1CC]
		mov	[ebp+var_EC], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	edx, [ebp+var_EC]
		mov	ax, [ecx+edx*2]
		mov	[ebp+var_F8], ax
		movzx	eax, [ebp+var_F8]
		and	eax, 0FFFFFFFCh
		cmp	eax, 200Ch
		jz	short loc_2BF3
		movzx	eax, [ebp+var_F8]
		sub	eax, 202Ah
		cmp	eax, 5
		jb	short loc_2BF3
		movzx	eax, [ebp+var_F8]
		sub	eax, 2066h
		cmp	eax, 4
		jb	short loc_2BF3
		mov	eax, [ebp+var_E0]
		mov	ecx, [ebp+arg_4]
		mov	edx, [ebp+var_EC]
		mov	[ecx+eax*4], edx
		mov	eax, [ebp+var_E0]
		add	eax, 1
		mov	[ebp+var_E0], eax

loc_2BF3:				; CODE XREF: _ubidi_getVisualMap_56+502j
					; _ubidi_getVisualMap_56+513j ...
		jmp	loc_2B2D
; ---------------------------------------------------------------------------

loc_2BF8:				; CODE XREF: _ubidi_getVisualMap_56+49Cj
		jmp	loc_29EA
; ---------------------------------------------------------------------------

loc_2BFD:				; CODE XREF: _ubidi_getVisualMap_56:loc_26D8j
					; _ubidi_getVisualMap_56+40j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 1CCh
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_getVisualMap_56 endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

;
; Exported entry
;
; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 2C14h
		assume es:nothing, ss:nothing, ds:_rtc$TMZ, fs:nothing,	gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl ubidi_invertMap_56(int, void *Dst, int)
		public _ubidi_invertMap_56
_ubidi_invertMap_56 proc near

var_E4		= byte ptr -0E4h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0E4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_E4]
		mov	ecx, 39h ; '9'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_0], 0
		jz	loc_2D10
		cmp	[ebp+Dst], 0
		jz	loc_2D10
		cmp	[ebp+arg_8], 0
		jle	loc_2D10
		mov	[ebp+var_14], 0FFFFFFFFh
		mov	[ebp+var_20], 0
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_0]
		lea	edx, [ecx+eax*4]
		mov	[ebp+var_8], edx

loc_2C6A:				; CODE XREF: _ubidi_invertMap_56:loc_2C9Ej
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+arg_0]
		jbe	short loc_2CA0
		mov	eax, [ebp+var_8]
		sub	eax, 4
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx]
		cmp	edx, [ebp+var_14]
		jle	short loc_2C8D
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+var_14], ecx

loc_2C8D:				; CODE XREF: _ubidi_invertMap_56+6Fj
		mov	eax, [ebp+var_8]
		cmp	dword ptr [eax], 0
		jl	short loc_2C9E
		mov	eax, [ebp+var_20]
		add	eax, 1
		mov	[ebp+var_20], eax

loc_2C9E:				; CODE XREF: _ubidi_invertMap_56+7Fj
		jmp	short loc_2C6A
; ---------------------------------------------------------------------------

loc_2CA0:				; CODE XREF: _ubidi_invertMap_56+5Cj
		mov	eax, [ebp+var_14]
		add	eax, 1
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_14]
		jge	short loc_2CC9
		mov	eax, [ebp+var_14]
		shl	eax, 2
		push	eax		; Size
		push	0FFh		; Val
		mov	ecx, [ebp+Dst]
		push	ecx		; Dst
		call	_memset
		add	esp, 0Ch

loc_2CC9:				; CODE XREF: _ubidi_invertMap_56+9Bj
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+arg_0]
		lea	edx, [ecx+eax*4]
		mov	[ebp+var_8], edx

loc_2CD5:				; CODE XREF: _ubidi_invertMap_56:loc_2D0Ej
		cmp	[ebp+arg_8], 0
		jle	short loc_2D10
		mov	eax, [ebp+var_8]
		sub	eax, 4
		mov	[ebp+var_8], eax
		mov	ecx, [ebp+var_8]
		cmp	dword ptr [ecx], 0
		jl	short loc_2D05
		mov	eax, [ebp+arg_8]
		sub	eax, 1
		mov	[ebp+arg_8], eax
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx]
		mov	eax, [ebp+Dst]
		mov	ecx, [ebp+arg_8]
		mov	[eax+edx*4], ecx
		jmp	short loc_2D0E
; ---------------------------------------------------------------------------

loc_2D05:				; CODE XREF: _ubidi_invertMap_56+D6j
		mov	eax, [ebp+arg_8]
		sub	eax, 1
		mov	[ebp+arg_8], eax

loc_2D0E:				; CODE XREF: _ubidi_invertMap_56+EFj
		jmp	short loc_2CD5
; ---------------------------------------------------------------------------

loc_2D10:				; CODE XREF: _ubidi_invertMap_56+22j
					; _ubidi_invertMap_56+2Cj ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0E4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_ubidi_invertMap_56 endp

_text		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn _ubidi_getParaLevelAtIndex_56:near ; CODE	XREF: _ubidi_setLine_56+15Dp
					; _ubidi_getLevelAt_56+95p ...
		extrn _ubidi_getParagraph_56:near ; CODE XREF: _ubidi_setLine_56+B3p
					; _ubidi_setLine_56+D2p
		extrn __RTC_CheckEsp:near ; CODE XREF: _ubidi_setLine_56+429p
					; _ubidi_getLevelAt_56+D6p ...
		extrn __RTC_Shutdown:near ; DATA XREF: .rtc$TMZ:__RTC_Shutdown_rtc$TMZo
		extrn __RTC_InitBase:near ; DATA XREF: .rtc$IMZ:__RTC_InitBase_rtc$IMZo
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn _memset:near	; CODE XREF: _ubidi_getLevels_56+128p
					; _ubidi_getLogicalMap_56+9Dp ...
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn _memcpy:near	; CODE XREF: _ubidi_getLevels_56+10Ap
		extrn _uprv_checkValidMemory:near ; CODE XREF: _ubidi_getLevels_56+F3p
		extrn _ubidi_getMemory_56:near ; CODE XREF: _ubidi_getLevels_56+C1p
					; _ubidi_getRuns_56+119p
		extrn ___security_cookie:near ;	DATA XREF: _ubidi_getLogicalRun_56+1Er
					; _reorderLine+1Er
; __fastcall __security_check_cookie(x)
		extrn @__security_check_cookie@4:near
					; CODE XREF: _ubidi_getLogicalRun_56+1BDp
					; _reorderLine+260p
; __fastcall _RTC_CheckStackVars(x, x)
		extrn @_RTC_CheckStackVars@8:near ; CODE XREF: _ubidi_getLogicalRun_56+1AEp
					; _ubidi_getVisualRun_56+11Ap ...
; void __cdecl __wassert(const wchar_t *Message, const wchar_t *File, unsigned int Line)
		extrn __imp___wassert:near ; CODE XREF:	_getRunFromLogicalIndex+BCp
					; DATA XREF: _getRunFromLogicalIndex+BCr


		end
