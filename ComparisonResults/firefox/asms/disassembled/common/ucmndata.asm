;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	D00CE29802E2BC2D1EFF1E2ADEAAC712
; Input	CRC32 :	0D8590AD

; File Name   :	D:\compspace\objfiles\firefox\common\ucmndata.obj
; Format      :	COFF (X386MAGIC)
; includelib "msvcprtd"
; includelib "MSVCRTD"
; includelib "OLDNAMES"

		.686p
		.mmx
		.model flat
.intel_syntax noprefix

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
_CmnDFuncs	dd offset _offsetTOCLookupFn ; DATA XREF: _udata_checkCommonData_56+E1o
		dd offset _offsetTOCEntryCount
_ToCPFuncs	dd offset _pointerTOCLookupFn ;	DATA XREF: _udata_checkCommonData_56+155o
		dd offset _pointerTOCEntryCount
_rdata		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _udata_getHeaderSize_56
_udata_getHeaderSize_56	proc near	; CODE XREF: _udata_checkCommonData_56+EEp
					; _udata_checkCommonData_56+162p

var_CC		= byte ptr -0CCh
var_8		= word ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0CCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_CC]
		mov	ecx, 33h ; '3'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_0], 0
		jnz	short loc_3A
		xor	eax, eax
		jmp	short loc_69
; ---------------------------------------------------------------------------
		jmp	short loc_69
; ---------------------------------------------------------------------------

loc_3A:					; CODE XREF: _udata_getHeaderSize_56+22j
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+8]
		test	ecx, ecx
		jnz	short loc_4F
		mov	eax, [ebp+arg_0]
		mov	ax, [eax]
		jmp	short loc_69
; ---------------------------------------------------------------------------
		jmp	short loc_69
; ---------------------------------------------------------------------------

loc_4F:					; CODE XREF: _udata_getHeaderSize_56+33j
		mov	eax, [ebp+arg_0]
		mov	cx, [eax]
		mov	[ebp+var_8], cx
		movzx	eax, [ebp+var_8]
		shl	eax, 8
		movzx	ecx, [ebp+var_8]
		sar	ecx, 8
		or	eax, ecx

loc_69:					; CODE XREF: _udata_getHeaderSize_56+26j
					; _udata_getHeaderSize_56+28j ...
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_udata_getHeaderSize_56	endp

_text		ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$TMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$TMZ
		;org 70h
__RTC_Shutdown_rtc$TMZ dd offset __RTC_Shutdown
_rtc$TMZ	ends

; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rtc$IMZ	segment	dword public 'DATA' use32
		assume cs:_rtc$IMZ
		;org 74h
__RTC_InitBase_rtc$IMZ dd offset __RTC_InitBase
_rtc$IMZ	ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 78h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _udata_getInfoSize_56
_udata_getInfoSize_56 proc near

var_CC		= byte ptr -0CCh
var_8		= word ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0CCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_CC]
		mov	ecx, 33h ; '3'
		mov	eax, 0CCCCCCCCh
		rep stosd
		cmp	[ebp+arg_0], 0
		jnz	short loc_A2
		xor	eax, eax
		jmp	short loc_D1
; ---------------------------------------------------------------------------
		jmp	short loc_D1
; ---------------------------------------------------------------------------

loc_A2:					; CODE XREF: _udata_getInfoSize_56+22j
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax+4]
		test	ecx, ecx
		jnz	short loc_B7
		mov	eax, [ebp+arg_0]
		mov	ax, [eax]
		jmp	short loc_D1
; ---------------------------------------------------------------------------
		jmp	short loc_D1
; ---------------------------------------------------------------------------

loc_B7:					; CODE XREF: _udata_getInfoSize_56+33j
		mov	eax, [ebp+arg_0]
		mov	cx, [eax]
		mov	[ebp+var_8], cx
		movzx	eax, [ebp+var_8]
		shl	eax, 8
		movzx	ecx, [ebp+var_8]
		sar	ecx, 8
		or	eax, ecx

loc_D1:					; CODE XREF: _udata_getInfoSize_56+26j
					; _udata_getInfoSize_56+28j ...
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_udata_getInfoSize_56 endp

_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 0D8h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_offsetTOCEntryCount proc near		; DATA XREF: .rdata:00000004o

var_D8		= byte ptr -0D8h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0D8h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_D8]
		mov	ecx, 36h ; '6'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_8], 0
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_14], ecx
		cmp	[ebp+var_14], 0
		jz	short loc_114
		mov	eax, [ebp+var_14]
		mov	ecx, [eax]
		mov	[ebp+var_8], ecx

loc_114:				; CODE XREF: _offsetTOCEntryCount+32j
		mov	eax, [ebp+var_8]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_offsetTOCEntryCount endp

; ---------------------------------------------------------------------------
		align 10h
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 120h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_offsetTOCLookupFn proc	near		; DATA XREF: .rdata:_CmnDFuncso

var_FC		= byte ptr -0FCh
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0FCh
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_FC]
		mov	ecx, 3Fh ; '?'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_8], ecx
		cmp	[ebp+var_8], 0
		jz	short loc_1C8
		mov	eax, [ebp+var_8]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+var_2C], ecx
		mov	eax, [ebp+var_2C]
		push	eax
		mov	ecx, [ebp+var_8]
		add	ecx, 4
		push	ecx
		mov	edx, [ebp+var_14]
		push	edx
		mov	eax, [ebp+arg_4]
		push	eax
		call	_offsetTOCPrefixBinarySearch
		add	esp, 10h
		mov	[ebp+var_20], eax
		cmp	[ebp+var_20], 0
		jl	short loc_1C2
		mov	eax, [ebp+var_20]
		mov	ecx, [ebp+var_8]
		lea	edx, [ecx+eax*8+4]
		mov	[ebp+var_38], edx
		mov	eax, [ebp+var_20]
		add	eax, 1
		cmp	eax, [ebp+var_2C]
		jge	short loc_1AA
		mov	eax, [ebp+var_38]
		mov	ecx, [ebp+var_38]
		mov	edx, [eax+0Ch]
		sub	edx, [ecx+4]
		mov	eax, [ebp+arg_8]
		mov	[eax], edx
		jmp	short loc_1B3
; ---------------------------------------------------------------------------

loc_1AA:				; CODE XREF: _offsetTOCLookupFn+75j
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh

loc_1B3:				; CODE XREF: _offsetTOCLookupFn+88j
		mov	eax, [ebp+var_38]
		mov	ecx, [ebp+var_14]
		add	ecx, [eax+4]
		mov	eax, ecx
		jmp	short loc_1CE
; ---------------------------------------------------------------------------
		jmp	short loc_1C6
; ---------------------------------------------------------------------------

loc_1C2:				; CODE XREF: _offsetTOCLookupFn+5Dj
		xor	eax, eax
		jmp	short loc_1CE
; ---------------------------------------------------------------------------

loc_1C6:				; CODE XREF: _offsetTOCLookupFn+A0j
		jmp	short loc_1CE
; ---------------------------------------------------------------------------

loc_1C8:				; CODE XREF: _offsetTOCLookupFn+2Bj
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]

loc_1CE:				; CODE XREF: _offsetTOCLookupFn+9Ej
					; _offsetTOCLookupFn+A4j ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0FCh
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_offsetTOCLookupFn endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 1E4h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_offsetTOCPrefixBinarySearch proc near	; CODE XREF: _offsetTOCLookupFn+4Ep

var_118		= dword	ptr -118h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 118h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_118]
		mov	ecx, 46h ; 'F'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_8], 0
		mov	eax, [ebp+arg_C]
		mov	[ebp+var_14], eax
		mov	[ebp+var_20], 0
		mov	[ebp+var_2C], 0
		cmp	[ebp+arg_C], 0
		jnz	short loc_22B
		or	eax, 0FFFFFFFFh
		jmp	loc_321
; ---------------------------------------------------------------------------

loc_22B:				; CODE XREF: _offsetTOCPrefixBinarySearch+3Dj
		lea	eax, [ebp+var_20]
		push	eax
		mov	ecx, [ebp+arg_8]
		mov	edx, [ebp+arg_4]
		add	edx, [ecx]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_24F
		xor	eax, eax
		jmp	loc_321
; ---------------------------------------------------------------------------

loc_24F:				; CODE XREF: _offsetTOCPrefixBinarySearch+62j
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_2C]
		push	eax
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_4]
		add	eax, [edx+ecx*8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_28A
		mov	eax, [ebp+var_14]
		jmp	loc_321
; ---------------------------------------------------------------------------

loc_28A:				; CODE XREF: _offsetTOCPrefixBinarySearch+9Cj
					; _offsetTOCPrefixBinarySearch:loc_319j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jge	loc_31E
		mov	eax, [ebp+var_8]
		add	eax, [ebp+var_14]
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_2C]
		jge	short loc_2B7
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_118], ecx
		jmp	short loc_2C0
; ---------------------------------------------------------------------------

loc_2B7:				; CODE XREF: _offsetTOCPrefixBinarySearch+C6j
		mov	edx, [ebp+var_2C]
		mov	[ebp+var_118], edx

loc_2C0:				; CODE XREF: _offsetTOCPrefixBinarySearch+D1j
		mov	eax, [ebp+var_118]
		mov	[ebp+var_44], eax
		lea	eax, [ebp+var_44]
		push	eax
		mov	ecx, [ebp+var_38]
		mov	edx, [ebp+arg_8]
		mov	eax, [ebp+arg_4]
		add	eax, [edx+ecx*8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		mov	[ebp+var_50], eax
		cmp	[ebp+var_50], 0
		jge	short loc_2FD
		mov	eax, [ebp+var_38]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+var_2C], eax
		jmp	short loc_319
; ---------------------------------------------------------------------------

loc_2FD:				; CODE XREF: _offsetTOCPrefixBinarySearch+109j
		cmp	[ebp+var_50], 0
		jnz	short loc_30A
		mov	eax, [ebp+var_38]
		jmp	short loc_321
; ---------------------------------------------------------------------------
		jmp	short loc_319
; ---------------------------------------------------------------------------

loc_30A:				; CODE XREF: _offsetTOCPrefixBinarySearch+11Dj
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+var_20], eax

loc_319:				; CODE XREF: _offsetTOCPrefixBinarySearch+117j
					; _offsetTOCPrefixBinarySearch+124j
		jmp	loc_28A
; ---------------------------------------------------------------------------

loc_31E:				; CODE XREF: _offsetTOCPrefixBinarySearch+ACj
		or	eax, 0FFFFFFFFh

loc_321:				; CODE XREF: _offsetTOCPrefixBinarySearch+42j
					; _offsetTOCPrefixBinarySearch+66j ...
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN18
		call	@_RTC_CheckStackVars@8
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 118h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_offsetTOCPrefixBinarySearch endp

; ---------------------------------------------------------------------------
		align 4
$LN18		dd 3			; DATA XREF: _offsetTOCPrefixBinarySearch+141o
		dd offset $LN17
$LN17		dd 0FFFFFFE0h, 4	; DATA XREF: .text:0000034Co
		dd offset $LN14		; "startPrefixLength"
		dd 0FFFFFFD4h, 4
		dd offset $LN15		; "limitPrefixLength"
		dd 0FFFFFFBCh, 4
		dd offset $LN16		; "prefixLength"
$LN16		db 'prefixLength',0     ; DATA XREF: .text:00000370o
$LN15		db 'limitPrefixLength',0 ; DATA XREF: .text:00000364o
$LN14		db 'startPrefixLength',0 ; DATA XREF: .text:00000358o
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 3A8h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_strcmpAfterPrefix proc	near		; CODE XREF: _offsetTOCPrefixBinarySearch+58p
					; _offsetTOCPrefixBinarySearch+92p ...

var_F0		= byte ptr -0F0h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0F0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_F0]
		mov	ecx, 3Ch ; '<'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_8]
		mov	ecx, [eax]
		mov	[ebp+var_8], ecx
		mov	[ebp+var_14], 0
		mov	eax, [ebp+arg_0]
		add	eax, [ebp+var_8]
		mov	[ebp+arg_0], eax
		mov	eax, [ebp+arg_4]
		add	eax, [ebp+var_8]
		mov	[ebp+arg_4], eax

loc_3E7:				; CODE XREF: _strcmpAfterPrefix+7Fj
		mov	eax, [ebp+arg_0]
		movzx	ecx, byte ptr [eax]
		mov	[ebp+var_20], ecx
		mov	edx, [ebp+arg_0]
		add	edx, 1
		mov	[ebp+arg_0], edx
		mov	eax, [ebp+arg_4]
		movzx	ecx, byte ptr [eax]
		mov	[ebp+var_2C], ecx
		mov	edx, [ebp+arg_4]
		add	edx, 1
		mov	[ebp+arg_4], edx
		mov	eax, [ebp+var_20]
		sub	eax, [ebp+var_2C]
		mov	[ebp+var_14], eax
		jnz	short loc_41C
		cmp	[ebp+var_20], 0
		jnz	short loc_41E

loc_41C:				; CODE XREF: _strcmpAfterPrefix+6Cj
		jmp	short loc_429
; ---------------------------------------------------------------------------

loc_41E:				; CODE XREF: _strcmpAfterPrefix+72j
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		jmp	short loc_3E7
; ---------------------------------------------------------------------------

loc_429:				; CODE XREF: _strcmpAfterPrefix:loc_41Cj
		mov	eax, [ebp+arg_8]
		mov	ecx, [ebp+var_8]
		mov	[eax], ecx
		mov	eax, [ebp+var_14]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_strcmpAfterPrefix endp

; ---------------------------------------------------------------------------
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 43Ch
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_pointerTOCEntryCount proc near		; DATA XREF: .rdata:0000000Co

var_D0		= dword	ptr -0D0h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0D0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_D0]
		mov	ecx, 34h ; '4'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_8], ecx
		cmp	[ebp+var_8], 0
		jz	short loc_476
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+var_D0], ecx
		jmp	short loc_480
; ---------------------------------------------------------------------------

loc_476:				; CODE XREF: _pointerTOCEntryCount+2Bj
		mov	[ebp+var_D0], 0

loc_480:				; CODE XREF: _pointerTOCEntryCount+38j
		mov	eax, [ebp+var_D0]
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
_pointerTOCEntryCount endp

; ---------------------------------------------------------------------------
		align 10h
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 490h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_pointerTOCLookupFn proc near		; DATA XREF: .rdata:_ToCPFuncso

var_E4		= byte ptr -0E4h
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 0E4h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_E4]
		mov	ecx, 39h ; '9'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+8], 0
		jz	short loc_50E
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+8]
		mov	[ebp+var_8], ecx
		mov	eax, [ebp+var_8]
		mov	ecx, [eax]
		mov	[ebp+var_20], ecx
		mov	eax, [ebp+var_20]
		push	eax
		mov	ecx, [ebp+var_8]
		add	ecx, 8
		push	ecx
		mov	edx, [ebp+arg_4]
		push	edx
		call	_pointerTOCPrefixBinarySearch
		add	esp, 0Ch
		mov	[ebp+var_14], eax
		cmp	[ebp+var_14], 0
		jl	short loc_508
		mov	eax, [ebp+arg_8]
		mov	dword ptr [eax], 0FFFFFFFFh
		mov	eax, [ebp+var_14]
		mov	ecx, [ebp+var_8]
		mov	edx, [ecx+eax*8+0Ch]
		push	edx
		call	_UDataMemory_normalizeDataPointer_56
		add	esp, 4
		jmp	short loc_514
; ---------------------------------------------------------------------------
		jmp	short loc_50C
; ---------------------------------------------------------------------------

loc_508:				; CODE XREF: _pointerTOCLookupFn+56j
		xor	eax, eax
		jmp	short loc_514
; ---------------------------------------------------------------------------

loc_50C:				; CODE XREF: _pointerTOCLookupFn+76j
		jmp	short loc_514
; ---------------------------------------------------------------------------

loc_50E:				; CODE XREF: _pointerTOCLookupFn+25j
		mov	eax, [ebp+arg_0]
		mov	eax, [eax+4]

loc_514:				; CODE XREF: _pointerTOCLookupFn+74j
					; _pointerTOCLookupFn+7Aj ...
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0E4h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_pointerTOCLookupFn endp

_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 528h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

_pointerTOCPrefixBinarySearch proc near	; CODE XREF: _pointerTOCLookupFn+47p

var_118		= dword	ptr -118h
var_50		= dword	ptr -50h
var_44		= dword	ptr -44h
var_38		= dword	ptr -38h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 118h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_118]
		mov	ecx, 46h ; 'F'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	[ebp+var_8], 0
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_14], eax
		mov	[ebp+var_20], 0
		mov	[ebp+var_2C], 0
		cmp	[ebp+arg_8], 0
		jnz	short loc_56F
		or	eax, 0FFFFFFFFh
		jmp	loc_65C
; ---------------------------------------------------------------------------

loc_56F:				; CODE XREF: _pointerTOCPrefixBinarySearch+3Dj
		lea	eax, [ebp+var_20]
		push	eax
		mov	ecx, [ebp+arg_4]
		mov	edx, [ecx]
		push	edx
		mov	eax, [ebp+arg_0]
		push	eax
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_590
		xor	eax, eax
		jmp	loc_65C
; ---------------------------------------------------------------------------

loc_590:				; CODE XREF: _pointerTOCPrefixBinarySearch+5Fj
		mov	eax, [ebp+var_8]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_14]
		sub	eax, 1
		mov	[ebp+var_14], eax
		lea	eax, [ebp+var_2C]
		push	eax
		mov	ecx, [ebp+var_14]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+ecx*8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_5C8
		mov	eax, [ebp+var_14]
		jmp	loc_65C
; ---------------------------------------------------------------------------

loc_5C8:				; CODE XREF: _pointerTOCPrefixBinarySearch+96j
					; _pointerTOCPrefixBinarySearch:loc_654j
		mov	eax, [ebp+var_8]
		cmp	eax, [ebp+var_14]
		jge	loc_659
		mov	eax, [ebp+var_8]
		add	eax, [ebp+var_14]
		cdq
		sub	eax, edx
		sar	eax, 1
		mov	[ebp+var_38], eax
		mov	eax, [ebp+var_20]
		cmp	eax, [ebp+var_2C]
		jge	short loc_5F5
		mov	ecx, [ebp+var_20]
		mov	[ebp+var_118], ecx
		jmp	short loc_5FE
; ---------------------------------------------------------------------------

loc_5F5:				; CODE XREF: _pointerTOCPrefixBinarySearch+C0j
		mov	edx, [ebp+var_2C]
		mov	[ebp+var_118], edx

loc_5FE:				; CODE XREF: _pointerTOCPrefixBinarySearch+CBj
		mov	eax, [ebp+var_118]
		mov	[ebp+var_44], eax
		lea	eax, [ebp+var_44]
		push	eax
		mov	ecx, [ebp+var_38]
		mov	edx, [ebp+arg_4]
		mov	eax, [edx+ecx*8]
		push	eax
		mov	ecx, [ebp+arg_0]
		push	ecx
		call	_strcmpAfterPrefix
		add	esp, 0Ch
		mov	[ebp+var_50], eax
		cmp	[ebp+var_50], 0
		jge	short loc_638
		mov	eax, [ebp+var_38]
		mov	[ebp+var_14], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+var_2C], eax
		jmp	short loc_654
; ---------------------------------------------------------------------------

loc_638:				; CODE XREF: _pointerTOCPrefixBinarySearch+100j
		cmp	[ebp+var_50], 0
		jnz	short loc_645
		mov	eax, [ebp+var_38]
		jmp	short loc_65C
; ---------------------------------------------------------------------------
		jmp	short loc_654
; ---------------------------------------------------------------------------

loc_645:				; CODE XREF: _pointerTOCPrefixBinarySearch+114j
		mov	eax, [ebp+var_38]
		add	eax, 1
		mov	[ebp+var_8], eax
		mov	eax, [ebp+var_44]
		mov	[ebp+var_20], eax

loc_654:				; CODE XREF: _pointerTOCPrefixBinarySearch+10Ej
					; _pointerTOCPrefixBinarySearch+11Bj
		jmp	loc_5C8
; ---------------------------------------------------------------------------

loc_659:				; CODE XREF: _pointerTOCPrefixBinarySearch+A6j
		or	eax, 0FFFFFFFFh

loc_65C:				; CODE XREF: _pointerTOCPrefixBinarySearch+42j
					; _pointerTOCPrefixBinarySearch+63j ...
		push	edx
		mov	ecx, ebp
		push	eax
		lea	edx, $LN18_0
		call	@_RTC_CheckStackVars@8
		pop	eax
		pop	edx
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 118h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_pointerTOCPrefixBinarySearch endp

; ---------------------------------------------------------------------------
		align 4
$LN18_0		dd 3			; DATA XREF: _pointerTOCPrefixBinarySearch+138o
		dd offset $LN17_0
$LN17_0		dd 0FFFFFFE0h, 4	; DATA XREF: .text:00000688o
		dd offset $LN14_0	; "startPrefixLength"
		dd 0FFFFFFD4h, 4
		dd offset $LN15_0	; "limitPrefixLength"
		dd 0FFFFFFBCh, 4
		dd offset $LN16_0	; "prefixLength"
$LN16_0		db 'prefixLength',0     ; DATA XREF: .text:000006ACo
$LN15_0		db 'limitPrefixLength',0 ; DATA XREF: .text:000006A0o
$LN14_0		db 'startPrefixLength',0 ; DATA XREF: .text:00000694o
		align 4
_text		ends

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 6E4h
		assume es:nothing, ss:nothing, ds:_rdata, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

		public _udata_checkCommonData_56
_udata_checkCommonData_56 proc near

var_C0		= byte ptr -0C0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		push	edi
		lea	edi, [ebp+var_C0]
		mov	ecx, 30h ; '0'
		mov	eax, 0CCCCCCCCh
		rep stosd
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jle	short loc_70F
		jmp	loc_87C
; ---------------------------------------------------------------------------

loc_70F:				; CODE XREF: _udata_checkCommonData_56+24j
		cmp	[ebp+arg_0], 0
		jz	short loc_71E
		mov	eax, [ebp+arg_0]
		cmp	dword ptr [eax+4], 0
		jnz	short loc_72C

loc_71E:				; CODE XREF: _udata_checkCommonData_56+2Fj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	loc_868
; ---------------------------------------------------------------------------

loc_72C:				; CODE XREF: _udata_checkCommonData_56+38j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+2]
		cmp	edx, 0DAh ; 'Ú'
		jnz	short loc_769
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+3]
		cmp	edx, 27h ; '''
		jnz	short loc_769
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+8]
		test	edx, edx
		jnz	short loc_769
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+9]
		test	edx, edx
		jz	short loc_777

loc_769:				; CODE XREF: _udata_checkCommonData_56+58j
					; _udata_checkCommonData_56+67j ...
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3
		jmp	loc_868
; ---------------------------------------------------------------------------

loc_777:				; CODE XREF: _udata_checkCommonData_56+83j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Ch]
		cmp	edx, 43h ; 'C'
		jnz	short loc_7EB
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Dh]
		cmp	edx, 6Dh ; 'm'
		jnz	short loc_7EB
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Eh]
		cmp	edx, 6Eh ; 'n'
		jnz	short loc_7EB
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Fh]
		cmp	edx, 44h ; 'D'
		jnz	short loc_7EB
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+10h]
		cmp	edx, 1
		jnz	short loc_7EB
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], offset	_CmnDFuncs
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		push	ecx
		call	_udata_getHeaderSize_56
		add	esp, 4
		movzx	edx, ax
		mov	eax, [ebp+arg_0]
		add	edx, [eax+4]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], edx
		jmp	short loc_868
; ---------------------------------------------------------------------------

loc_7EB:				; CODE XREF: _udata_checkCommonData_56+A0j
					; _udata_checkCommonData_56+AFj ...
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Ch]
		cmp	edx, 54h ; 'T'
		jnz	short loc_85F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Dh]
		cmp	edx, 6Fh ; 'o'
		jnz	short loc_85F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Eh]
		cmp	edx, 43h ; 'C'
		jnz	short loc_85F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+0Fh]
		cmp	edx, 50h ; 'P'
		jnz	short loc_85F
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		movzx	edx, byte ptr [ecx+10h]
		cmp	edx, 1
		jnz	short loc_85F
		mov	eax, [ebp+arg_0]
		mov	dword ptr [eax], offset	_ToCPFuncs
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+4]
		push	ecx
		call	_udata_getHeaderSize_56
		add	esp, 4
		movzx	edx, ax
		mov	eax, [ebp+arg_0]
		add	edx, [eax+4]
		mov	ecx, [ebp+arg_0]
		mov	[ecx+8], edx
		jmp	short loc_868
; ---------------------------------------------------------------------------

loc_85F:				; CODE XREF: _udata_checkCommonData_56+114j
					; _udata_checkCommonData_56+123j ...
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], 3

loc_868:				; CODE XREF: _udata_checkCommonData_56+43j
					; _udata_checkCommonData_56+8Ej ...
		mov	eax, [ebp+arg_4]
		cmp	dword ptr [eax], 0
		jle	short loc_87C
		mov	eax, [ebp+arg_0]
		push	eax
		call	_udata_close_56
		add	esp, 4

loc_87C:				; CODE XREF: _udata_checkCommonData_56+26j
					; _udata_checkCommonData_56+18Aj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 0C0h
		cmp	ebp, esp
		call	__RTC_CheckEsp
		mov	esp, ebp
		pop	ebp
		retn
_udata_checkCommonData_56 endp

_text		ends

; ===========================================================================

; Segment type:	Externs
; UNDEF
		extrn __RTC_Shutdown:near ; DATA XREF: .rtc$TMZ:__RTC_Shutdown_rtc$TMZo
		extrn __RTC_InitBase:near ; DATA XREF: .rtc$IMZ:__RTC_InitBase_rtc$IMZo
		extrn __RTC_CheckEsp:near ; CODE XREF: _offsetTOCLookupFn+B9p
					; _offsetTOCPrefixBinarySearch+159p ...
		extrn @_RTC_CheckStackVars@8:near
					; CODE XREF: _offsetTOCPrefixBinarySearch+147p
					; _pointerTOCPrefixBinarySearch+13Ep
		extrn _UDataMemory_normalizeDataPointer_56:near
					; CODE XREF: _pointerTOCLookupFn+6Cp
		extrn _udata_close_56:near ; CODE XREF:	_udata_checkCommonData_56+190p


		end
