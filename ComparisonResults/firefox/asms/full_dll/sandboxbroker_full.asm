;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	8067FBF73DA60722237CAE1121F02170
; Input	CRC32 :	926A39D4

; File Name   :	D:\compspace\dlls\firefox\dll\full\sandboxbroker_full.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 000187F7 ( 100343.)
; Section size in file		: 00018800 ( 100352.)
; Offset to raw	data for section: 00000400
; Flags	60300020: Text Executable Readable
; Alignment	: 4 bytes
; PDB File Name	: c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\obj-firefox\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb
; OS type	  :  MS	Windows
; Application type:  DLL 32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	dword public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; DATA XREF: .rdata:1001A374o
		push	offset sub_100197D6 ; Func
		call	sub_10018E36
		pop	ecx
		retn
sub_10001000	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000100C	proc near		; DATA XREF: .rdata:1001A378o
		push	offset sub_100197CB ; Func
		call	sub_10018E36
		pop	ecx
		retn
sub_1000100C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001018	proc near		; DATA XREF: .rdata:1001A37Co
		push	offset sub_100197C0 ; Func
		call	sub_10018E36
		pop	ecx
		retn
sub_10001018	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001024	proc near		; DATA XREF: .rdata:1001A380o
		push	7D0h		; dwSpinCount
		push	offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		push	offset sub_100197E1 ; Func
		call	sub_10018E36
		pop	ecx
		retn
sub_10001024	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001040	proc near		; DATA XREF: .rdata:1001A370o
		push	offset sub_100197ED ; Func
		call	sub_10018E36
		pop	ecx
		retn
sub_10001040	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. ??0SandboxBroker@mozilla@@QAE@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *this,	const struct mozilla::SandboxBroker *)
		public ??0SandboxBroker@mozilla@@QAE@ABV01@@Z
??0SandboxBroker@mozilla@@QAE@ABV01@@Z proc near ; DATA	XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [ecx], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??0SandboxBroker@mozilla@@QAE@ABV01@@Z endp

; Exported entry   4. ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; public: class	mozilla::SandboxBroker & __thiscall mozilla::SandboxBroker::operator=(class mozilla::SandboxBroker const &)
		public ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z proc near ;	DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z endp


; =============== S U B	R O U T	I N E =======================================


sub_10001074	proc near		; DATA XREF: .rdata:const mozilla::SandboxBroker::`vftable'o

arg_0		= byte ptr  4

		test	[esp+arg_0], 2
		push	esi
		mov	esi, ecx
		jz	short loc_100010AC
		push	ebx
		lea	ebx, [esi-4]
		push	edi
		mov	edi, [ebx]
		lea	esi, [esi+edi*8]
		jmp	short loc_10001094
; ---------------------------------------------------------------------------

loc_1000108A:				; CODE XREF: sub_10001074+21j
		sub	esi, 8
		mov	ecx, esi	; this
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)

loc_10001094:				; CODE XREF: sub_10001074+14j
		dec	edi
		jns	short loc_1000108A
		test	[esp+0Ch+arg_0], 1
		jz	short loc_100010A6
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100010A6:				; CODE XREF: sub_10001074+28j
		pop	edi
		mov	eax, ebx
		pop	ebx
		jmp	short loc_100010C2
; ---------------------------------------------------------------------------

loc_100010AC:				; CODE XREF: sub_10001074+8j
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)
		test	[esp+4+arg_0], 1
		jz	short loc_100010C0
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100010C0:				; CODE XREF: sub_10001074+42j
		mov	eax, esi

loc_100010C2:				; CODE XREF: sub_10001074+36j
		pop	esi
		retn	4
sub_10001074	endp


; =============== S U B	R O U T	I N E =======================================


sub_100010C6	proc near		; CODE XREF: sub_100017BF+15p
					; sub_10002830+19p ...
		cmp	byte ptr [ecx],	0
		jnz	short loc_100010CF
		xor	ecx, ecx
		jmp	short loc_100010DB
; ---------------------------------------------------------------------------

loc_100010CF:				; CODE XREF: sub_100010C6+3j
		lea	edx, [ecx+1]

loc_100010D2:				; CODE XREF: sub_100010C6+11j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_100010D2
		sub	ecx, edx

loc_100010DB:				; CODE XREF: sub_100010C6+7j
		mov	eax, ecx
		retn
sub_100010C6	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100010DE@<eax>(void *Dst@<ecx>, void *Src@<edx>, size_t Size)
sub_100010DE	proc near		; CODE XREF: sub_100017EB+76p
					; sub_10001883+1Fp ...

Size		= dword	ptr  4

		cmp	[esp+Size], 0
		jz	short loc_100010F5
		push	[esp+Size]	; Size
		push	edx		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	ecx, eax

loc_100010F5:				; CODE XREF: sub_100010DE+5j
		mov	eax, ecx
		retn
sub_100010DE	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100010F8@<eax>(void *Dst@<ecx>, void *Src@<edx>, size_t Size)
sub_100010F8	proc near		; CODE XREF: sub_10001936+36p
					; sub_100022B3+15p ...

Size		= dword	ptr  4

		cmp	[esp+Size], 0
		jz	short loc_10001110
		push	[esp+Size]	; Size
		push	edx		; Src
		push	ecx		; Dst
		call	ds:memmove
		add	esp, 0Ch
		mov	ecx, eax

loc_10001110:				; CODE XREF: sub_100010F8+5j
		mov	eax, ecx
		retn
sub_100010F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001113	proc near		; DATA XREF: .rdata:off_1001A8E4o
					; .rdata:off_1001A8FCo	...

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001A92C
		jz	short loc_1000112B
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000112B:				; CODE XREF: sub_10001113+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10001113	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001131	proc near		; DATA XREF: .rdata:1001A8F0o
					; .rdata:1001A920o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	[eax], edx
		mov	[eax+4], ecx
		retn	8
sub_10001131	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001141	proc near		; DATA XREF: .rdata:1001A8F8o
					; .rdata:1001A910o ...

var_8		= byte ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	[ebp+arg_0]
		mov	eax, [ecx]
		lea	edx, [ebp+var_8]
		push	edx
		call	dword ptr [eax+0Ch]
		mov	edx, [ebp+arg_4]
		mov	ecx, [eax+4]
		cmp	ecx, [edx+4]
		jnz	short loc_10001168
		mov	eax, [eax]
		cmp	eax, [edx]
		jnz	short loc_10001168
		xor	eax, eax
		inc	eax
		jmp	short loc_1000116A
; ---------------------------------------------------------------------------

loc_10001168:				; CODE XREF: sub_10001141+1Aj
					; sub_10001141+20j
		xor	eax, eax

loc_1000116A:				; CODE XREF: sub_10001141+25j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10001141	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001170	proc near		; DATA XREF: .rdata:1001A8F4o
					; .rdata:1001A90Co ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	ecx, [eax+4]
		jnz	short loc_10001186
		mov	eax, [eax]
		cmp	eax, [esp+arg_4]
		jnz	short loc_10001186
		xor	eax, eax
		inc	eax
		jmp	short locret_10001188
; ---------------------------------------------------------------------------

loc_10001186:				; CODE XREF: sub_10001170+7j
					; sub_10001170+Fj
		xor	eax, eax

locret_10001188:			; CODE XREF: sub_10001170+14j
		retn	8
sub_10001170	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000118B	proc near		; DATA XREF: .rdata:1001A8E8o
		mov	eax, offset aGeneric ; "generic"
		retn
sub_1000118B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001191(void *Dst,	int)
sub_10001191	proc near		; CODE XREF: sub_100011BC+1Ep
					; DATA XREF: .rdata:1001A8ECo

Dst		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_100011A5
		mov	eax, offset aUnknownError ; "unknown error"

loc_100011A5:				; CODE XREF: sub_10001191+Dj
		mov	ecx, [esp+Dst]	; Dst
		push	eax		; Src
		call	sub_100017BF
		mov	eax, [esp+Dst]
		retn	8
sub_10001191	endp


; =============== S U B	R O U T	I N E =======================================


sub_100011B6	proc near		; DATA XREF: .rdata:1001A918o
		mov	eax, offset aIostream ;	"iostream"
		retn
sub_100011B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100011BC(void *Dst,	int)
sub_100011BC	proc near		; DATA XREF: .rdata:1001A91Co

Dst		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_100011D4
		mov	ecx, [ebp+Dst]	; Dst
		push	offset aIostreamStream ; "iostream stream error"
		call	sub_100017BF
		jmp	short loc_100011DF
; ---------------------------------------------------------------------------

loc_100011D4:				; CODE XREF: sub_100011BC+7j
		push	[ebp+arg_4]	; int
		push	[ebp+Dst]	; Dst
		call	sub_10001191

loc_100011DF:				; CODE XREF: sub_100011BC+16j
		mov	eax, [ebp+Dst]
		pop	ebp
		retn	8
sub_100011BC	endp


; =============== S U B	R O U T	I N E =======================================


sub_100011E6	proc near		; DATA XREF: .rdata:1001A900o
		mov	eax, offset aSystem ; "system"
		retn
sub_100011E6	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100011EC(void *Dst,	int)
sub_100011EC	proc near		; DATA XREF: .rdata:1001A904o

Dst		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Winerror_map@std@@YAPBDH@Z	; std::_Winerror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_10001200
		mov	eax, offset aUnknownError ; "unknown error"

loc_10001200:				; CODE XREF: sub_100011EC+Dj
		mov	ecx, [esp+Dst]	; Dst
		push	eax		; Src
		call	sub_100017BF
		mov	eax, [esp+Dst]
		retn	8
sub_100011EC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001211	proc near		; DATA XREF: .rdata:1001A908o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		test	eax, eax
		mov	eax, [esp+8+arg_0]
		pop	ecx
		mov	[eax], esi
		jz	short loc_10001231
		mov	dword ptr [eax+4], offset off_10031020
		jmp	short loc_10001238
; ---------------------------------------------------------------------------

loc_10001231:				; CODE XREF: sub_10001211+15j
		mov	dword ptr [eax+4], offset off_1003101C

loc_10001238:				; CODE XREF: sub_10001211+1Ej
		pop	esi
		retn	8
sub_10001211	endp

; Exported entry   2. ??0SandboxBroker@mozilla@@QAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??0SandboxBroker@mozilla@@QAE@XZ
??0SandboxBroker@mozilla@@QAE@XZ proc near ; DATA XREF:	.rdata:off_1002E058o
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jnz	short loc_10001287
		cmp	g_shared_section, ecx
		jnz	short loc_10001281
		mov	byte_10031CB9, 1
		call	sub_1000D76A
		mov	ecx, eax
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jz	short loc_10001287
		mov	eax, [ecx]
		call	dword ptr [eax]
		mov	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		and	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService

loc_10001281:				; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+19j
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService

loc_10001287:				; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+11j
					; mozilla::SandboxBroker::SandboxBroker(void)+31j
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn
??0SandboxBroker@mozilla@@QAE@XZ endp

; Exported entry  10. ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; bool __thiscall mozilla::SandboxBroker::LaunchApp(mozilla::SandboxBroker *this, const	wchar_t	*, const wchar_t *, bool, void **)
		public ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z proc near
					; DATA XREF: .rdata:off_1002E058o

var_10		= dword	ptr -10h
hThread		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, 0	; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		push	ebx
		push	esi
		mov	ebx, ecx
		jz	loc_1000132A
		mov	esi, [ebx+4]
		test	esi, esi
		jz	short loc_1000132A
		mov	esi, [esi]
		push	edi
		mov	edi, ds:GetStdHandle
		push	0FFFFFFF5h	; nStdHandle
		call	edi ; GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+54h]
		mov	eax, [ebx+4]
		push	0FFFFFFF4h	; nStdHandle
		mov	esi, [eax]
		call	edi ; GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+58h]
		cmp	[ebp+arg_8], 0
		jz	short loc_100012E3
		mov	ecx, [ebx+4]
		call	sub_10002977

loc_100012E3:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+46j
		and	[ebp+var_10], 0
		lea	edi, [ebp+hThread]
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		lea	edx, [ebp+var_10]
		xor	eax, eax
		stosd
		push	edx
		push	dword ptr [ebx+4]
		push	[ebp+arg_4]
		stosd
		push	[ebp+arg_0]
		stosd
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		pop	edi
		test	eax, eax
		jnz	short loc_1000132A
		push	[ebp+hThread]	; hThread
		call	ds:ResumeThread
		push	[ebp+hThread]	; hObject
		call	ds:CloseHandle
		mov	ecx, [ebp+arg_C]
		mov	eax, [ebp+var_10]
		mov	[ecx], eax
		mov	al, 1
		jmp	short loc_1000132C
; ---------------------------------------------------------------------------

loc_1000132A:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+11j
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+1Cj	...
		xor	al, al

loc_1000132C:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+95j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z endp

; Exported entry  14. ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(mozilla::SandboxBroker *this, int)
		public ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z proc near
					; DATA XREF: .rdata:off_1002E058o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= byte ptr  10h

		push	ecx
		push	edi
		mov	edi, ecx
		mov	edx, [edi+4]
		test	edx, edx
		jnz	short loc_10001346
		xor	al, al
		jmp	loc_100014B8
; ---------------------------------------------------------------------------

loc_10001346:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+9j
		push	ebx
		push	ebp
		push	esi
		push	2
		pop	esi
		cmp	[esp+14h+arg_0], esi
		jle	short loc_10001359
		push	4
		pop	ecx
		mov	ebp, esi
		jmp	short loc_10001361
; ---------------------------------------------------------------------------

loc_10001359:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+1Cj
		jnz	short loc_1000136A
		push	4
		pop	ecx
		push	3
		pop	ebp

loc_10001361:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+23j
		push	4
		pop	esi
		mov	[esp+14h+var_4], esi
		jmp	short loc_10001374
; ---------------------------------------------------------------------------

loc_1000136A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int):loc_10001359j
		push	5
		pop	ecx
		push	4
		pop	ebp
		mov	[esp+14h+var_4], esi

loc_10001374:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+34j
		mov	eax, [edx]
		push	0
		push	ecx
		mov	ecx, edx
		call	dword ptr [eax+14h]
		mov	ecx, [edi+4]
		mov	ebx, eax
		push	ebp
		push	5
		pop	ebp
		mov	edx, [ecx]
		neg	ebx
		push	ebp
		sbb	bl, bl
		call	dword ptr [edx+8]
		inc	bl
		jz	short loc_100013A2
		test	eax, eax
		jnz	short loc_100013A2
		xor	ebx, ebx
		inc	ebx
		mov	[esp+8+arg_C], bl
		jmp	short loc_100013AA
; ---------------------------------------------------------------------------

loc_100013A2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+5Fj
					; mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+63j
		xor	ebx, ebx
		mov	[esp+8+arg_C], 0
		inc	ebx

loc_100013AA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+6Cj
		mov	ecx, [edi+4]
		push	esi
		mov	eax, [ecx]
		call	dword ptr [eax+2Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_100013C2
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_100013C7

loc_100013C2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+84j
		mov	[esp+8+arg_C], 0

loc_100013C7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+8Cj
		mov	ecx, [edi+4]
		push	[esp+8+arg_4]
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	[esp+8+arg_C], 0
		jz	short loc_100013E2
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_100013E7

loc_100013E2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+A4j
		mov	[esp+8+arg_C], 0

loc_100013E7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+ACj
		mov	ecx, [edi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001402
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001407

loc_10001402:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+C4j
		mov	[esp+8+arg_C], 0

loc_10001407:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+CCj
		mov	ecx, [edi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001427
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_1000142C

loc_10001427:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+E9j
		mov	[esp+8+arg_C], 0

loc_1000142C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+F1j
		mov	ecx, [edi+4]
		push	offset a??PipeGeckoCra ; "\\??\\pipe\\gecko-crash-server-pipe.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_1000144C
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001451

loc_1000144C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+10Ej
		mov	[esp+8+arg_C], 0

loc_10001451:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+116j
		mov	ecx, [edi+4]
		mov	esi, offset aSection ; "Section"
		push	esi
		push	4
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001471
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001476

loc_10001471:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+133j
		mov	[esp+8+arg_C], 0

loc_10001476:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+13Bj
		mov	ecx, [edi+4]
		push	esi
		push	ebp
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001490
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001495

loc_10001490:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+152j
		mov	[esp+8+arg_C], 0

loc_10001495:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+15Aj
		mov	ecx, [edi+4]
		push	offset a??PipeJpi2_pid ; "\\??\\pipe\\jpi2_pid*_pipe*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+14h+arg_0], 0
		jz	short loc_100014B1
		test	eax, eax
		jz	short loc_100014B3

loc_100014B1:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+177j
		xor	bl, bl

loc_100014B3:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+17Bj
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_100014B8:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+Dj
		pop	edi
		pop	ecx
		retn	4
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z endp

; Exported entry  13. ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(mozilla::SandboxBroker	*__hidden this)
		public ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_1002E058o
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_100014CB
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100014CB:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+8j
		mov	eax, [ecx]
		push	ebx
		push	0
		push	5
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	5
		neg	ebx
		push	5
		mov	eax, [ecx]
		sbb	bl, bl
		call	dword ptr [eax+8]
		inc	bl
		pop	ebx
		jz	short loc_100014F4
		test	eax, eax
		jnz	short loc_100014F4
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100014F4:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+2Dj
					; mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+31j
		xor	eax, eax
		pop	esi
		retn
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry  12. ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(mozilla::SandboxBroker *this)
		public ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_1002E058o

var_1		= byte ptr -1
arg_7		= byte ptr  0Bh

		push	ecx
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_1000150A
		xor	al, al
		jmp	loc_10001742
; ---------------------------------------------------------------------------

loc_1000150A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+9j
		mov	eax, [ecx]
		push	ebx
		push	0
		push	0
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	0
		neg	ebx
		push	5
		mov	edx, [ecx]
		sbb	bl, bl
		call	dword ptr [edx+8]
		inc	bl
		jz	short loc_10001537
		test	eax, eax
		jnz	short loc_10001537
		xor	ebx, ebx
		inc	ebx
		mov	[esp+0Bh], bl
		jmp	short loc_1000153F
; ---------------------------------------------------------------------------

loc_10001537:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+30j
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+34j
		xor	ebx, ebx
		mov	byte ptr [esp+0Bh], 0
		inc	ebx

loc_1000153F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+3Dj
		mov	ecx, [esi+4]
		push	ebx
		mov	eax, [ecx]
		call	dword ptr [eax+1Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001557
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_1000155C

loc_10001557:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+55j
		mov	byte ptr [esp+0Bh], 0

loc_1000155C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+5Dj
		mov	ecx, [esi+4]
		push	4
		mov	eax, [ecx]
		call	dword ptr [eax+2Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001575
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_1000157A

loc_10001575:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+73j
		mov	byte ptr [esp+0Bh], 0

loc_1000157A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+7Bj
		mov	ecx, [esi+4]
		push	6
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_10001593
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_10001598

loc_10001593:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+91j
		mov	byte ptr [esp+0Bh], 0

loc_10001598:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+99j
		mov	ecx, [esi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_100015B3
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_100015B8

loc_100015B3:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+B1j
		mov	byte ptr [esp+0Bh], 0

loc_100015B8:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+B9j
		mov	ecx, [esi+4]
		push	ebx
		push	100h
		mov	eax, [ecx]
		call	dword ptr [eax+48h]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_100015D5
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_100015DA

loc_100015D5:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+D3j
		mov	byte ptr [esp+0Bh], 0

loc_100015DA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+DBj
		mov	ecx, [esi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_100015FA
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_100015FF

loc_100015FA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+F8j
		mov	byte ptr [esp+0Bh], 0

loc_100015FF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+100j
		mov	ecx, [esi+4]
		push	offset a??PipeGeckoCra ; "\\??\\pipe\\gecko-crash-server-pipe.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+0Bh], 0
		jz	short loc_1000161F
		mov	[esp+0Bh], bl
		test	eax, eax
		jz	short loc_10001624

loc_1000161F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+11Dj
		mov	byte ptr [esp+0Bh], 0

loc_10001624:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+125j
		mov	ecx, [esi+4]
		push	ebp
		push	edi
		push	offset aHkey_current_u ; "HKEY_CURRENT_USER"
		mov	eax, [ecx]
		push	0Bh
		pop	edi
		push	edi
		push	3
		pop	ebp
		push	ebp
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_1000164A
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_1000164F

loc_1000164A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+148j
		mov	[esp+8+arg_7], 0

loc_1000164F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+150j
		mov	ecx, [esi+4]
		push	offset aHkey_current_0 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_1000166D
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001672

loc_1000166D:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+16Bj
		mov	[esp+8+arg_7], 0

loc_10001672:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+173j
		mov	ecx, [esi+4]
		push	offset aHkey_current_1 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_10001690
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001695

loc_10001690:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+18Ej
		mov	[esp+8+arg_7], 0

loc_10001695:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+196j
		mov	ecx, [esi+4]
		push	offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100016B3
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_100016B8

loc_100016B3:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1B1j
		mov	[esp+8+arg_7], 0

loc_100016B8:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1B9j
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_0 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100016D6
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_100016DB

loc_100016D6:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1D4j
		mov	[esp+8+arg_7], 0

loc_100016DB:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1DCj
		mov	ecx, [esi+4]
		push	offset aHkey_current_2 ; "HKEY_CURRENT_USER\\Software\\Policies\\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_100016F9
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_100016FE

loc_100016F9:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1F7j
		mov	[esp+8+arg_7], 0

loc_100016FE:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1FFj
		mov	ecx, [esi+4]
		push	offset aHkey_current_3 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_7], 0
		jz	short loc_1000171C
		mov	[esp+8+arg_7], bl
		test	eax, eax
		jz	short loc_10001721

loc_1000171C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+21Aj
		mov	[esp+8+arg_7], 0

loc_10001721:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+222j
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_1 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+14h+var_1], 0
		pop	edi
		pop	ebp
		jz	short loc_1000173D
		test	eax, eax
		jz	short loc_1000173F

loc_1000173D:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+23Fj
		xor	bl, bl

loc_1000173F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+243j
		mov	al, bl
		pop	ebx

loc_10001742:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+Dj
		pop	esi
		pop	ecx
		retn
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry   8. ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	1
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   9. ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadWriteFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	0
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   7. ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowDirectory(mozilla::SandboxBroker	*this, const wchar_t *)
		public ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z proc	near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	3
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   6. ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AddTargetPeer(mozilla::SandboxBroker *this, void *)
		public ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z
?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z proc near ; DATA XREF:	.rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		push	[esp+arg_0]
		mov	eax, [ecx]
		call	dword ptr [eax+10h]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z endp

; Exported entry   3. ??1SandboxBroker@mozilla@@UAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::~SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??1SandboxBroker@mozilla@@UAE@XZ
??1SandboxBroker@mozilla@@UAE@XZ proc near ; CODE XREF:	sub_10001074+1Bp
					; sub_10001074:loc_100010ACp
					; DATA XREF: ...
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		test	ecx, ecx
		jz	short loc_100017BD
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		and	dword ptr [esi+4], 0

loc_100017BD:				; CODE XREF: mozilla::SandboxBroker::~SandboxBroker(void)+Ej
		pop	esi
		retn
??1SandboxBroker@mozilla@@UAE@XZ endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100017BF(void *Dst, void *Src)
sub_100017BF	proc near		; CODE XREF: sub_10001191+19p
					; sub_100011BC+11p ...

Src		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+Src]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_100010C6
		push	eax		; Size
		push	[esp+8+Src]	; Src
		mov	ecx, esi	; Dst
		call	sub_100018C4
		mov	eax, esi
		pop	esi
		retn	4
sub_100017BF	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100017EB(void *Dst, int, int, int)
sub_100017EB	proc near		; CODE XREF: sub_100018C4+28p
					; sub_1000344B+18p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_1000180B

loc_10001800:				; CODE XREF: sub_100017EB+36j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000180B:				; CODE XREF: sub_100017EB+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_10001817
		mov	edi, [esp+10h+arg_8]

loc_10001817:				; CODE XREF: sub_100017EB+26j
		cmp	esi, ebx
		jnz	short loc_1000183D
		lea	eax, [edi+ebp]
		cmp	[esi+10h], eax
		jb	short loc_10001800
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], eax
		jb	short loc_1000182E
		mov	ecx, [esi]

loc_1000182E:				; CODE XREF: sub_100017EB+3Fj
		push	ebp
		mov	byte ptr [ecx+eax], 0
		push	ecx
		mov	ecx, esi
		call	sub_10001936
		jmp	short loc_1000187A
; ---------------------------------------------------------------------------

loc_1000183D:				; CODE XREF: sub_100017EB+2Ej
		push	0
		push	edi
		call	sub_1000198C
		test	al, al
		jz	short loc_1000187A
		cmp	dword ptr [ebx+14h], 10h
		jb	short loc_10001851
		mov	ebx, [ebx]

loc_10001851:				; CODE XREF: sub_100017EB+62j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000185B
		mov	ecx, [esi]
		jmp	short loc_1000185D
; ---------------------------------------------------------------------------

loc_1000185B:				; CODE XREF: sub_100017EB+6Aj
		mov	ecx, esi	; Dst

loc_1000185D:				; CODE XREF: sub_100017EB+6Ej
		push	edi		; Size
		lea	edx, [ebx+ebp]	; Src
		call	sub_100010DE
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], edi
		jb	short loc_10001874
		mov	eax, [esi]
		jmp	short loc_10001876
; ---------------------------------------------------------------------------

loc_10001874:				; CODE XREF: sub_100017EB+83j
		mov	eax, esi

loc_10001876:				; CODE XREF: sub_100017EB+87j
		mov	byte ptr [eax+edi], 0

loc_1000187A:				; CODE XREF: sub_100017EB+50j
					; sub_100017EB+5Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100017EB	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001883(char, size_t Size)
sub_10001883	proc near		; CODE XREF: sub_1000198C+3Dp
					; sub_10001A26+6Bp ...

arg_0		= byte ptr  4
Size		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		push	edi
		mov	edi, [esp+8+Size]
		mov	esi, ecx
		jz	short loc_100018B1
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100018B1
		push	ebx
		mov	ebx, [esi]
		test	edi, edi
		jz	short loc_100018A8
		push	edi		; Size
		mov	edx, ebx	; Src
		call	sub_100010DE
		pop	ecx

loc_100018A8:				; CODE XREF: sub_10001883+1Aj
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ebx

loc_100018B1:				; CODE XREF: sub_10001883+Dj
					; sub_10001883+13j
		mov	[esi+10h], edi
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [edi+esi], 0
		pop	edi
		pop	esi
		retn	8
sub_10001883	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100018C4(void *Dst, void *Src, size_t Size)
sub_100018C4	proc near		; CODE XREF: sub_100017BF+21p
					; sub_10002784+49p ...

Src		= dword	ptr  4
Size		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+Src]
		mov	esi, ecx
		push	edi
		call	sub_100019EE
		test	al, al
		jz	short loc_100018F3
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100018E0
		mov	eax, [esi]
		jmp	short loc_100018E2
; ---------------------------------------------------------------------------

loc_100018E0:				; CODE XREF: sub_100018C4+16j
		mov	eax, esi

loc_100018E2:				; CODE XREF: sub_100018C4+1Aj
		push	[esp+8+Size]	; int
		sub	edi, eax
		mov	ecx, esi	; Dst
		push	edi		; int
		push	esi		; int
		call	sub_100017EB
		jmp	short loc_10001931
; ---------------------------------------------------------------------------

loc_100018F3:				; CODE XREF: sub_100018C4+10j
		push	ebx
		mov	ebx, [esp+0Ch+Size]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_1000198C
		test	al, al
		jz	short loc_1000192E
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001910
		mov	ecx, [esi]
		jmp	short loc_10001912
; ---------------------------------------------------------------------------

loc_10001910:				; CODE XREF: sub_100018C4+46j
		mov	ecx, esi	; Dst

loc_10001912:				; CODE XREF: sub_100018C4+4Aj
		push	ebx		; Size
		mov	edx, edi	; Src
		call	sub_100010DE
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], ebx
		jb	short loc_10001928
		mov	eax, [esi]
		jmp	short loc_1000192A
; ---------------------------------------------------------------------------

loc_10001928:				; CODE XREF: sub_100018C4+5Ej
		mov	eax, esi

loc_1000192A:				; CODE XREF: sub_100018C4+62j
		mov	byte ptr [eax+ebx], 0

loc_1000192E:				; CODE XREF: sub_100018C4+40j
		mov	eax, esi
		pop	ebx

loc_10001931:				; CODE XREF: sub_100018C4+2Dj
		pop	edi
		pop	esi
		retn	8
sub_100018C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001936	proc near		; CODE XREF: sub_100017EB+4Bp

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_1000195A
		and	dword ptr [esi+10h], 0
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001953
		mov	eax, [esi]
		jmp	short loc_10001955
; ---------------------------------------------------------------------------

loc_10001953:				; CODE XREF: sub_10001936+17j
		mov	eax, esi

loc_10001955:				; CODE XREF: sub_10001936+1Bj
		mov	byte ptr [eax],	0
		jmp	short loc_10001985
; ---------------------------------------------------------------------------

loc_1000195A:				; CODE XREF: sub_10001936+Dj
		test	eax, eax
		jz	short loc_10001985
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001966
		mov	ecx, [esi]	; Dst

loc_10001966:				; CODE XREF: sub_10001936+2Cj
		sub	edi, eax
		lea	edx, [ecx+eax]	; Src
		push	edi		; Size
		call	sub_100010F8
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], edi
		jb	short loc_1000197F
		mov	eax, [esi]
		jmp	short loc_10001981
; ---------------------------------------------------------------------------

loc_1000197F:				; CODE XREF: sub_10001936+43j
		mov	eax, esi

loc_10001981:				; CODE XREF: sub_10001936+47j
		mov	byte ptr [eax+edi], 0

loc_10001985:				; CODE XREF: sub_10001936+22j
					; sub_10001936+26j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10001936	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000198C	proc near		; CODE XREF: sub_100017EB+55p
					; sub_100018C4+39p ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 0FFFFFFFEh
		jbe	short loc_100019A1
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100019A1:				; CODE XREF: sub_1000198C+8j
		cmp	[ecx+14h], esi
		jnb	short loc_100019B1
		push	dword ptr [ecx+10h] ; Size
		push	esi		; int
		call	sub_10001A26
		jmp	short loc_100019E2
; ---------------------------------------------------------------------------

loc_100019B1:				; CODE XREF: sub_1000198C+18j
		cmp	[esp+4+arg_4], 0
		jz	short loc_100019D0
		cmp	esi, 10h
		jnb	short loc_100019D0
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_100019C6
		mov	eax, esi

loc_100019C6:				; CODE XREF: sub_1000198C+36j
		push	eax		; Size
		push	1		; char
		call	sub_10001883
		jmp	short loc_100019E2
; ---------------------------------------------------------------------------

loc_100019D0:				; CODE XREF: sub_1000198C+2Aj
					; sub_1000198C+2Fj
		test	esi, esi
		jnz	short loc_100019E2
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_100019DF
		mov	ecx, [ecx]

loc_100019DF:				; CODE XREF: sub_1000198C+4Fj
		mov	byte ptr [ecx],	0

loc_100019E2:				; CODE XREF: sub_1000198C+23j
					; sub_1000198C+42j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_1000198C	endp


; =============== S U B	R O U T	I N E =======================================


sub_100019EE	proc near		; CODE XREF: sub_100018C4+9p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_10001A21
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10001A00
		mov	eax, [ecx]
		jmp	short loc_10001A02
; ---------------------------------------------------------------------------

loc_10001A00:				; CODE XREF: sub_100019EE+Cj
		mov	eax, ecx

loc_10001A02:				; CODE XREF: sub_100019EE+10j
		cmp	edx, eax
		jb	short loc_10001A21
		cmp	dword ptr [ecx+14h], 10h
		push	esi
		jb	short loc_10001A11
		mov	esi, [ecx]
		jmp	short loc_10001A13
; ---------------------------------------------------------------------------

loc_10001A11:				; CODE XREF: sub_100019EE+1Dj
		mov	esi, ecx

loc_10001A13:				; CODE XREF: sub_100019EE+21j
		mov	eax, [ecx+10h]
		add	eax, esi
		pop	esi
		cmp	eax, edx
		jbe	short loc_10001A21
		mov	al, 1
		jmp	short locret_10001A23
; ---------------------------------------------------------------------------

loc_10001A21:				; CODE XREF: sub_100019EE+6j
					; sub_100019EE+16j ...
		xor	al, al

locret_10001A23:			; CODE XREF: sub_100019EE+31j
		retn	4
sub_100019EE	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001A26(void *Src, int, size_t Size)
sub_10001A26	proc near		; CODE XREF: sub_1000198C+1Ep

arg_0		= dword	ptr  4
Size		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	esi, ecx
		or	edi, 0Fh
		cmp	edi, 0FFFFFFFEh
		jbe	short loc_10001A3E
		mov	edi, [esp+10h+arg_0]
		jmp	short loc_10001A63
; ---------------------------------------------------------------------------

loc_10001A3E:				; CODE XREF: sub_10001A26+10j
		push	3
		xor	edx, edx
		mov	ebx, [esi+14h]
		mov	eax, edi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_10001A63
		push	0FFFFFFFEh
		pop	eax
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_10001A60
		lea	edi, [ecx+ebx]
		jmp	short loc_10001A63
; ---------------------------------------------------------------------------

loc_10001A60:				; CODE XREF: sub_10001A26+33j
		push	0FFFFFFFEh
		pop	edi

loc_10001A63:				; CODE XREF: sub_10001A26+16j
					; sub_10001A26+2Aj ...
		lea	eax, [edi+1]
		push	eax
		call	sub_10001AB4
		mov	ebx, [esp+10h+Size]
		mov	ebp, eax
		test	ebx, ebx
		jz	short loc_10001A8B
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001A80
		mov	edx, [esi]
		jmp	short loc_10001A82
; ---------------------------------------------------------------------------

loc_10001A80:				; CODE XREF: sub_10001A26+54j
		mov	edx, esi	; Src

loc_10001A82:				; CODE XREF: sub_10001A26+58j
		push	ebx		; Size
		mov	ecx, ebp	; Dst
		call	sub_100010DE
		pop	ecx

loc_10001A8B:				; CODE XREF: sub_10001A26+4Ej
		push	0		; Size
		push	1		; char
		mov	ecx, esi
		call	sub_10001883
		test	esi, esi
		jz	short loc_10001A9C
		mov	[esi], ebp

loc_10001A9C:				; CODE XREF: sub_10001A26+72j
		mov	[esi+14h], edi
		mov	[esi+10h], ebx
		cmp	edi, 10h
		jb	short loc_10001AA9
		mov	esi, [esi]

loc_10001AA9:				; CODE XREF: sub_10001A26+7Fj
		pop	edi
		mov	byte ptr [esi+ebx], 0
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10001A26	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001AB4	proc near		; CODE XREF: sub_10001A26+41p
					; sub_10001D73+B7p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10001AD7
		cmp	eax, 0FFFFFFFFh
		ja	short loc_10001AD1
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10001AD7

loc_10001AD1:				; CODE XREF: sub_10001AB4+Dj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10001AD7:				; CODE XREF: sub_10001AB4+8j
					; sub_10001AB4+1Bj
		mov	eax, ecx
		retn	4
sub_10001AB4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001ADC	proc near		; CODE XREF: sub_10001C68+17p
					; sub_10006831+54p ...
		xor	edx, edx
		cmp	[ecx], dx
		jz	short loc_10001AF9
		push	esi
		lea	esi, [ecx+2]

loc_10001AE7:				; CODE XREF: sub_10001ADC+14j
		mov	ax, [ecx]
		add	ecx, 2
		cmp	ax, dx
		jnz	short loc_10001AE7
		mov	edx, ecx
		sub	edx, esi
		sar	edx, 1
		pop	esi

loc_10001AF9:				; CODE XREF: sub_10001ADC+5j
		mov	eax, edx
		retn
sub_10001ADC	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10001AFC@<eax>(void *Dst@<ecx>, void *Src@<edx>, int)
sub_10001AFC	proc near		; CODE XREF: sub_100022FA+20p
					; sub_1000233F+53p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001B13
		add	eax, eax
		push	eax		; Size
		push	edx		; Src
		push	ecx		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	ecx, eax

loc_10001B13:				; CODE XREF: sub_10001AFC+6j
		mov	eax, ecx
		retn
sub_10001AFC	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10001B16@<eax>(void *Dst@<ecx>, void *Src@<edx>, int)
sub_10001B16	proc near		; CODE XREF: sub_10002559+47p
					; sub_10003490+15p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001B2E
		add	eax, eax
		push	eax		; Size
		push	edx		; Src
		push	ecx		; Dst
		call	ds:memmove
		add	esp, 0Ch
		mov	ecx, eax

loc_10001B2E:				; CODE XREF: sub_10001B16+6j
		mov	eax, ecx
		retn
sub_10001B16	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B31	proc near		; CODE XREF: sub_10005908+27p
					; sub_10005952+9Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, ecx
		push	ecx
		push	ecx
		lea	ecx, [esi+8]
		mov	[esi], eax
		call	sub_10001C96
		mov	eax, [esp+4+arg_0]
		mov	[esi+0A4h], eax
		mov	eax, [esp+4+arg_4]
		mov	[esi+0A8h], eax
		call	ds:GetLastError
		mov	[esi+0ACh], eax
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10001B31	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B6A	proc near		; CODE XREF: sub_10001BD6+13j
					; sub_1000296F-6F3p
		push	esi
		lea	esi, [ecx+50h]
		mov	ecx, esi
		call	sub_10001CF8
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::~basic_ios<char,std::char_traits<char>>(void)
sub_10001B6A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B7E	proc near		; CODE XREF: sub_1000D7E3+39p

arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, ecx
		push	ecx
		push	ecx
		lea	ecx, [esi+8]
		mov	dword ptr [esi], 3
		call	sub_10001C96
		mov	dword ptr [esi+0A4h], offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		mov	dword ptr [esi+0A8h], 24h
		call	ds:GetLastError
		cmp	[esp+4+arg_8], 0
		mov	[esi+0ACh], eax
		jz	short loc_10001BD0
		mov	ecx, [esp+4+arg_8]
		push	0		; Size
		push	1		; char
		call	sub_10001883
		push	[esp+4+arg_8]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001BD0:				; CODE XREF: sub_10001B7E+38j
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10001B7E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001BD6	proc near		; CODE XREF: sub_10005908+3Fp
					; sub_10005952+B0p ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi+0ACh] ; dwErrCode
		call	ds:SetLastError
		lea	ecx, [esi+8]
		pop	esi
		jmp	sub_10001B6A
sub_10001BD6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001BEE	proc near		; CODE XREF: sub_10014BB5+B3p

Dst		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+Dst]	; Dst
		push	edx		; Src
		call	sub_10001C68
		mov	edx, eax
		lea	ecx, [ebp+var_1C]
		call	sub_10004368
		mov	edx, eax
		mov	ecx, esi
		call	sub_1000266C
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+var_1C]
		mov	esi, eax
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10001BEE	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001C48(void *Src)
sub_10001C48	proc near		; CODE XREF: sub_10004905+4Ap

Src		= dword	ptr  4

		push	esi
		push	[esp+4+Src]	; Src
		mov	esi, ecx
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_100022B3
		mov	eax, esi
		pop	esi
		retn	4
sub_10001C48	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001C68(void *Dst, void *Src)
sub_10001C68	proc near		; CODE XREF: sub_10001BEE+17p
					; sub_100029E7+20p ...

Src		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		mov	ecx, [esp+4+Src]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10001ADC
		push	eax		; int
		push	[esp+8+Src]	; Src
		mov	ecx, esi	; Dst
		call	sub_1000233F
		mov	eax, esi
		pop	esi
		retn	4
sub_10001C68	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001C96	proc near		; CODE XREF: sub_10001B31+Ep
					; sub_10001B7E+Ep ...

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		mov	[esp+10h+var_4], ebx
		lea	ecx, [edi+50h]
		mov	dword ptr [edi], offset	dword_1001A994
		call	ds:??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::basic_ios<char,std::char_traits<char>>(void)
		push	ebx
		push	ebx
		lea	esi, [edi+4]
		mov	ecx, edi
		push	esi
		call	ds:??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z ; std::basic_ostream<char,std::char_traits<char>>::basic_ostream<char,std::char_traits<char>>(std::basic_streambuf<char,std::char_traits<char>> *,bool)
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1001A954
		mov	eax, [edi]
		mov	ecx, [eax+4]
		lea	eax, [ecx-50h]
		mov	[ecx+edi-4], eax
		mov	ecx, esi
		call	ds:??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::basic_streambuf<char,std::char_traits<char>>(void)
		mov	eax, edi
		mov	[esi+38h], ebx
		pop	edi
		mov	dword ptr [esi], offset	off_1001A958
		mov	dword ptr [esi+3Ch], 4
		pop	esi
		pop	ebx
		pop	ecx
		retn	8
sub_10001C96	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001CF8	proc near		; CODE XREF: sub_10001B6A+6p
					; sub_10003248+82p
		push	esi
		mov	esi, ecx
		mov	eax, [esi-50h]
		lea	ecx, [esi-4Ch]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-50h], offset	off_1001A954
		mov	eax, [esi-50h]
		mov	edx, [eax+4]
		lea	eax, [edx-50h]
		mov	[edx+esi-54h], eax
		call	sub_10001D28
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_ostream<char,std::char_traits<char>>::~basic_ostream<char,std::char_traits<char>>(void)
sub_10001CF8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001D28	proc near		; CODE XREF: sub_10001CF8+21p
					; sub_10002296+3p
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 1
		mov	dword ptr [esi], offset	off_1001A958
		jz	short loc_10001D43
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001D43:				; CODE XREF: sub_10001D28+Dj
		mov	eax, [esi+0Ch]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], ecx
		mov	eax, [esi+10h]
		mov	[eax], ecx
		mov	eax, [esi+20h]
		mov	[eax], ecx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		and	dword ptr [esi+3Ch], 0FFFFFFFEh
		mov	[esi+38h], ecx
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::~basic_streambuf<char,std::char_traits<char>>(void)
sub_10001D28	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001D73	proc near		; DATA XREF: .rdata:1001A964o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10001D85
		or	eax, 0FFFFFFFFh
		jmp	loc_10001F02
; ---------------------------------------------------------------------------

loc_10001D85:				; CODE XREF: sub_10001D73+8j
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_10001D96
		xor	eax, eax
		jmp	loc_10001F01
; ---------------------------------------------------------------------------

loc_10001D96:				; CODE XREF: sub_10001D73+1Aj
		test	byte ptr [esi+3Ch], 8
		push	edi
		jz	short loc_10001DBC
		mov	edi, [esi+20h]
		cmp	dword ptr [edi], 0
		jz	short loc_10001DBC
		mov	edx, [esi+38h]
		cmp	[edi], edx
		jnb	short loc_10001DBC
		mov	eax, [esi+30h]
		mov	ecx, [eax]
		add	ecx, [edi]
		mov	[edi], edx
		sub	ecx, edx
		mov	eax, [esi+30h]
		mov	[eax], ecx

loc_10001DBC:				; CODE XREF: sub_10001D73+28j
					; sub_10001D73+30j ...
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10001DE5
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		add	ecx, edx
		cmp	edx, ecx
		jnb	short loc_10001DE1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	[eax], bl
		mov	eax, ebx
		jmp	loc_10001F00
; ---------------------------------------------------------------------------

loc_10001DE1:				; CODE XREF: sub_10001D73+5Bj
		test	edx, edx
		jnz	short loc_10001DE9

loc_10001DE5:				; CODE XREF: sub_10001D73+50j
		xor	ebx, ebx
		jmp	short loc_10001DF5
; ---------------------------------------------------------------------------

loc_10001DE9:				; CODE XREF: sub_10001D73+70j
		mov	eax, [esi+30h]
		mov	ecx, [esi+0Ch]
		mov	ebx, [eax]
		sub	ebx, [ecx]
		add	ebx, edx

loc_10001DF5:				; CODE XREF: sub_10001D73+74j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_10001E06
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10001E19

loc_10001E06:				; CODE XREF: sub_10001D73+8Bj
					; sub_10001D73+A0j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_10001E15
		shr	ecx, 1
		jnz	short loc_10001E06

loc_10001E15:				; CODE XREF: sub_10001D73+9Cj
		test	ecx, ecx
		jnz	short loc_10001E21

loc_10001E19:				; CODE XREF: sub_10001D73+91j
		or	eax, 0FFFFFFFFh
		jmp	loc_10001F00
; ---------------------------------------------------------------------------

loc_10001E21:				; CODE XREF: sub_10001D73+A4j
		lea	eax, [ecx+ebx]
		push	ebp
		push	eax
		mov	[esp+18h+var_4], eax
		call	sub_10001AB4
		mov	ecx, [esi+0Ch]
		mov	edi, eax
		mov	ebp, [ecx]
		test	ebx, ebx
		jz	short loc_10001E49
		push	ebx		; Size
		mov	edx, ebp	; Src
		mov	ecx, edi	; Dst
		call	sub_100010DE
		pop	ecx
		test	ebx, ebx
		jnz	short loc_10001E7A

loc_10001E49:				; CODE XREF: sub_10001D73+C5j
		mov	eax, [esi+10h]
		mov	edx, [esp+14h+var_4]
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], edx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_10001EB3
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	short loc_10001EDD
; ---------------------------------------------------------------------------

loc_10001E7A:				; CODE XREF: sub_10001D73+D4j
		mov	ecx, [esi+10h]
		mov	eax, edi
		sub	eax, ebp
		add	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, edi
		sub	eax, ebp
		sub	edx, ebp
		add	[ecx], eax
		add	edx, edi
		mov	eax, [esi+20h]
		mov	ecx, edi
		sub	ecx, edx
		add	ecx, [esp+14h+var_4]
		mov	[eax], edx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10001EBD
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_10001EB3:				; CODE XREF: sub_10001D73+F8j
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		mov	[eax], edi
		jmp	short loc_10001EDD
; ---------------------------------------------------------------------------

loc_10001EBD:				; CODE XREF: sub_10001D73+136j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		mov	eax, [esi+0Ch]
		sub	ecx, ebp
		add	ecx, edi
		sub	edx, ecx
		inc	edx
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10001EDD:				; CODE XREF: sub_10001D73+105j
					; sub_10001D73+148j
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10001EEB
		push	ebp
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001EEB:				; CODE XREF: sub_10001D73+16Ej
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	ecx, [esp+14h+arg_0]
		pop	ebp
		mov	[eax], cl
		mov	eax, ecx

loc_10001F00:				; CODE XREF: sub_10001D73+69j
					; sub_10001D73+A9j
		pop	edi

loc_10001F01:				; CODE XREF: sub_10001D73+1Ej
		pop	ebx

loc_10001F02:				; CODE XREF: sub_10001D73+Dj
		pop	esi
		pop	ecx
		retn	4
sub_10001D73	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F07	proc near		; DATA XREF: .rdata:1001A968o

arg_0		= dword	ptr  4

		mov	edx, ecx
		push	esi
		mov	eax, [edx+1Ch]
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_10001F4C
		mov	eax, [edx+0Ch]
		cmp	esi, [eax]
		jbe	short loc_10001F4C
		mov	ecx, [esp+4+arg_0]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10001F2E
		cmp	cl, [esi-1]
		jz	short loc_10001F2E
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_10001F4C

loc_10001F2E:				; CODE XREF: sub_10001F07+1Aj
					; sub_10001F07+1Fj
		mov	eax, [edx+2Ch]
		inc	dword ptr [eax]
		mov	eax, [edx+1Ch]
		dec	dword ptr [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10001F46
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	[eax], cl
		jmp	short loc_10001F48
; ---------------------------------------------------------------------------

loc_10001F46:				; CODE XREF: sub_10001F07+34j
		xor	ecx, ecx

loc_10001F48:				; CODE XREF: sub_10001F07+3Dj
		mov	eax, ecx
		jmp	short loc_10001F4F
; ---------------------------------------------------------------------------

loc_10001F4C:				; CODE XREF: sub_10001F07+Aj
					; sub_10001F07+11j ...
		or	eax, 0FFFFFFFFh

loc_10001F4F:				; CODE XREF: sub_10001F07+43j
		pop	esi
		retn	4
sub_10001F07	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F53	proc near		; DATA XREF: .rdata:1001A970o
		push	esi
		mov	esi, [ecx+1Ch]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_10001F62
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001F62:				; CODE XREF: sub_10001F53+8j
		push	edi
		mov	edi, [ecx+2Ch]
		mov	eax, [edi]
		add	eax, edx
		cmp	edx, eax
		jnb	short loc_10001F73
		movzx	eax, byte ptr [edx]
		jmp	short loc_10001FA7
; ---------------------------------------------------------------------------

loc_10001F73:				; CODE XREF: sub_10001F53+19j
		test	byte ptr [ecx+3Ch], 4
		jnz	short loc_10001FA4
		mov	eax, [ecx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10001FA4
		cmp	eax, edx
		ja	short loc_10001F8B
		cmp	[ecx+38h], edx
		jbe	short loc_10001FA4

loc_10001F8B:				; CODE XREF: sub_10001F53+31j
		cmp	[ecx+38h], eax
		jnb	short loc_10001F93
		mov	[ecx+38h], eax

loc_10001F93:				; CODE XREF: sub_10001F53+3Bj
		mov	eax, [ecx+38h]
		sub	eax, [esi]
		mov	[edi], eax
		mov	eax, [ecx+1Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		jmp	short loc_10001FA7
; ---------------------------------------------------------------------------

loc_10001FA4:				; CODE XREF: sub_10001F53+24j
					; sub_10001F53+2Dj ...
		or	eax, 0FFFFFFFFh

loc_10001FA7:				; CODE XREF: sub_10001F53+1Ej
					; sub_10001F53+4Fj
		pop	edi
		pop	esi
		retn
sub_10001F53	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001FAA	proc near		; DATA XREF: .rdata:1001A980o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	ecx, [ebx+20h]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_10001FC2
		cmp	[ebx+38h], eax
		jnb	short loc_10001FC2
		mov	[ebx+38h], eax

loc_10001FC2:				; CODE XREF: sub_10001FAA+Ej
					; sub_10001FAA+13j
		test	byte ptr [esp+14h+arg_10], 1
		jz	loc_10002098
		mov	eax, [ebx+1Ch]
		mov	edx, [eax]
		mov	[esp+14h+var_4], edx
		test	edx, edx
		jz	loc_10002098
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10001FF2
		mov	eax, [ebx+38h]
		jmp	short loc_10002000
; ---------------------------------------------------------------------------

loc_10001FF2:				; CODE XREF: sub_10001FAA+41j
		cmp	eax, 1
		jnz	short loc_10002014
		test	byte ptr [esp+14h+arg_10], 2
		jnz	short loc_10002018
		mov	eax, edx

loc_10002000:				; CODE XREF: sub_10001FAA+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10002028
; ---------------------------------------------------------------------------

loc_10002014:				; CODE XREF: sub_10001FAA+4Bj
		test	eax, eax
		jz	short loc_10002020

loc_10002018:				; CODE XREF: sub_10001FAA+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002028
; ---------------------------------------------------------------------------

loc_10002020:				; CODE XREF: sub_10001FAA+6Cj
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10002028:				; CODE XREF: sub_10001FAA+68j
					; sub_10001FAA+74j
		test	edi, edi
		jl	loc_10002121
		jg	short loc_1000203A
		test	esi, esi
		jb	loc_10002121

loc_1000203A:				; CODE XREF: sub_10001FAA+86j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	loc_10002121
		jl	short loc_10002057
		cmp	esi, eax
		ja	loc_10002121

loc_10002057:				; CODE XREF: sub_10001FAA+A3j
		mov	eax, [ebx+2Ch]
		sub	ecx, [esp+14h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002141
		mov	edx, [ebx+20h]
		cmp	dword ptr [edx], 0
		jz	loc_10002141
		mov	eax, [ebx+30h]
		mov	ecx, [eax]
		mov	eax, [ebx+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		mov	[eax], ecx
		jmp	loc_10002141
; ---------------------------------------------------------------------------

loc_10002098:				; CODE XREF: sub_10001FAA+1Dj
					; sub_10001FAA+2Ej
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002129
		mov	edx, [ecx]
		mov	[esp+14h+arg_10], edx
		test	edx, edx
		jz	short loc_10002129
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_100020C1
		mov	eax, [ebx+38h]
		jmp	short loc_100020C8
; ---------------------------------------------------------------------------

loc_100020C1:				; CODE XREF: sub_10001FAA+110j
		cmp	eax, 1
		jnz	short loc_100020DC
		mov	eax, edx

loc_100020C8:				; CODE XREF: sub_10001FAA+115j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_100020F0
; ---------------------------------------------------------------------------

loc_100020DC:				; CODE XREF: sub_10001FAA+11Aj
		test	eax, eax
		jz	short loc_100020E8
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_100020F0
; ---------------------------------------------------------------------------

loc_100020E8:				; CODE XREF: sub_10001FAA+134j
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_100020F0:				; CODE XREF: sub_10001FAA+130j
					; sub_10001FAA+13Cj
		test	edi, edi
		jl	short loc_10002121
		jg	short loc_100020FA
		test	esi, esi
		jb	short loc_10002121

loc_100020FA:				; CODE XREF: sub_10001FAA+14Aj
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	short loc_10002121
		jl	short loc_1000210F
		cmp	esi, eax
		ja	short loc_10002121

loc_1000210F:				; CODE XREF: sub_10001FAA+15Fj
		mov	eax, [ebx+30h]
		sub	ecx, [esp+14h+arg_10]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+20h]
		add	[eax], ecx
		jmp	short loc_10002141
; ---------------------------------------------------------------------------

loc_10002121:				; CODE XREF: sub_10001FAA+80j
					; sub_10001FAA+8Aj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002141
; ---------------------------------------------------------------------------

loc_10002129:				; CODE XREF: sub_10001FAA+F3j
					; sub_10001FAA+101j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_10002141
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_10002141:				; CODE XREF: sub_10001FAA+C2j
					; sub_10001FAA+CEj ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_10001FAA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000215D	proc near		; DATA XREF: .rdata:1001A984o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= dword	ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_10]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_C]
		add	esi, [esp+14h+arg_4]
		push	edi
		adc	ebx, [esp+18h+arg_8]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_10002186
		cmp	[edi+38h], eax
		jnb	short loc_10002186
		mov	[edi+38h], eax

loc_10002186:				; CODE XREF: sub_1000215D+1Fj
					; sub_1000215D+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_100021A2
		cmp	ebx, ebp
		jz	loc_10002259

loc_100021A2:				; CODE XREF: sub_1000215D+3Bj
		test	byte ptr [esp+18h+arg_1C], 1
		jz	short loc_10002213
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_10002211
		test	ebx, ebx
		jl	short loc_1000220B
		jg	short loc_100021C0
		test	esi, esi
		jb	short loc_1000220B

loc_100021C0:				; CODE XREF: sub_1000215D+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_1000220B
		jl	short loc_100021D5
		cmp	esi, eax
		ja	short loc_1000220B

loc_100021D5:				; CODE XREF: sub_1000215D+72j
		mov	eax, [edi+2Ch]
		sub	ecx, [esp+18h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_10002259
		mov	edx, [edi+20h]
		cmp	dword ptr [edx], 0
		jz	short loc_10002259
		mov	eax, [edi+30h]
		mov	ecx, [eax]
		mov	eax, [edi+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		mov	[eax], ecx
		jmp	short loc_10002259
; ---------------------------------------------------------------------------

loc_1000220B:				; CODE XREF: sub_1000215D+5Bj
					; sub_1000215D+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_10002257
; ---------------------------------------------------------------------------

loc_10002211:				; CODE XREF: sub_1000215D+57j
		mov	eax, ecx

loc_10002213:				; CODE XREF: sub_1000215D+4Aj
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_10002255
		mov	ecx, [edx]
		mov	[esp+18h+arg_1C], ecx
		test	ecx, ecx
		jz	short loc_10002255
		test	ebx, ebx
		jl	short loc_1000220B
		jg	short loc_1000222E
		test	esi, esi
		jb	short loc_1000220B

loc_1000222E:				; CODE XREF: sub_1000215D+CBj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_1000220B
		jl	short loc_10002243
		cmp	esi, eax
		ja	short loc_1000220B

loc_10002243:				; CODE XREF: sub_1000215D+E0j
		mov	eax, [edi+30h]
		sub	ecx, [esp+18h+arg_1C]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+20h]
		add	[eax], ecx
		jmp	short loc_10002259
; ---------------------------------------------------------------------------

loc_10002255:				; CODE XREF: sub_1000215D+BBj
					; sub_1000215D+C5j
		mov	esi, eax

loc_10002257:				; CODE XREF: sub_1000215D+B2j
		mov	ebx, ebp

loc_10002259:				; CODE XREF: sub_1000215D+3Fj
					; sub_1000215D+8Dj ...
		mov	eax, [esp+18h+arg_0]
		xor	ecx, ecx
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_1000215D	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000296F

loc_10002276:				; CODE XREF: sub_1000296F+3j
		push	esi
		lea	esi, [ecx-50h]
		mov	ecx, esi
		call	sub_10001B6A
		test	[esp+4+arg_0], 1
		jz	short loc_10002290
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10002290:				; CODE XREF: sub_1000296F-6E9j
		mov	eax, esi
		pop	esi
		retn	4
; END OF FUNCTION CHUNK	FOR sub_1000296F

; =============== S U B	R O U T	I N E =======================================


sub_10002296	proc near		; DATA XREF: .rdata:off_1001A958o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10001D28
		test	[esp+4+arg_0], 1
		jz	short loc_100022AD
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100022AD:				; CODE XREF: sub_10002296+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10002296	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100022B3(void *Src)
sub_100022B3	proc near		; CODE XREF: sub_10001C48+15p
					; sub_10002784+87p ...

Src		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Src]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 10h
		jnb	short loc_100022D0
		mov	eax, [esi+10h]
		mov	edx, esi	; Src
		inc	eax
		push	eax		; Size
		call	sub_100010F8
		pop	ecx
		jmp	short loc_100022DB
; ---------------------------------------------------------------------------

loc_100022D0:				; CODE XREF: sub_100022B3+Cj
		test	edi, edi
		jz	short loc_100022D8
		mov	eax, [esi]
		mov	[edi], eax

loc_100022D8:				; CODE XREF: sub_100022B3+1Fj
		and	dword ptr [esi], 0

loc_100022DB:				; CODE XREF: sub_100022B3+1Bj
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		pop	edi
		mov	byte ptr [esi],	0
		pop	esi
		retn	4
sub_100022B3	endp


; =============== S U B	R O U T	I N E =======================================


sub_100022FA	proc near		; CODE XREF: sub_10001BEE+44p
					; sub_10002447+40p ...

arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		mov	esi, ecx
		jz	short loc_10002329
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002329
		cmp	[esp+4+arg_4], 0
		push	ebx
		mov	ebx, [esi]
		jbe	short loc_10002320
		push	[esp+8+arg_4]	; int
		mov	edx, ebx	; Src
		call	sub_10001AFC
		pop	ecx

loc_10002320:				; CODE XREF: sub_100022FA+18j
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ebx

loc_10002329:				; CODE XREF: sub_100022FA+8j
					; sub_100022FA+Ej
		push	[esp+4+arg_4]
		mov	ecx, esi
		mov	dword ptr [esi+14h], 7
		call	sub_100023AA
		pop	esi
		retn	8
sub_100022FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000233F(void *Dst, void *Src, int)
sub_1000233F	proc near		; CODE XREF: sub_10001C68+23p
					; sub_10002BC9+1Bp ...

Src		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+Src]
		mov	esi, ecx
		push	edi
		call	sub_100024AE
		test	al, al
		jz	short loc_10002371
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000235D
		mov	eax, [esi]
		jmp	short loc_1000235F
; ---------------------------------------------------------------------------

loc_1000235D:				; CODE XREF: sub_1000233F+18j
		mov	eax, esi

loc_1000235F:				; CODE XREF: sub_1000233F+1Cj
		push	[ebp+arg_4]	; int
		sub	edi, eax
		mov	ecx, esi	; Dst
		sar	edi, 1
		push	edi		; int
		push	esi		; int
		call	sub_100023C2
		jmp	short loc_100023A4
; ---------------------------------------------------------------------------

loc_10002371:				; CODE XREF: sub_1000233F+12j
		push	0
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_10002447
		test	al, al
		jz	short loc_100023A2
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000238B
		mov	ecx, [esi]
		jmp	short loc_1000238D
; ---------------------------------------------------------------------------

loc_1000238B:				; CODE XREF: sub_1000233F+46j
		mov	ecx, esi	; Dst

loc_1000238D:				; CODE XREF: sub_1000233F+4Aj
		push	[ebp+arg_4]	; int
		mov	edx, edi	; Src
		call	sub_10001AFC
		pop	ecx
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_100023AA

loc_100023A2:				; CODE XREF: sub_1000233F+40j
		mov	eax, esi

loc_100023A4:				; CODE XREF: sub_1000233F+30j
		pop	edi
		pop	esi
		pop	ebp
		retn	8
sub_1000233F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100023AA	proc near		; CODE XREF: sub_100022FA+3Cp
					; sub_1000233F+5Ep ...

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		mov	eax, [esp+arg_0]
		mov	[ecx+10h], eax
		jb	short loc_100023B9
		mov	ecx, [ecx]

loc_100023B9:				; CODE XREF: sub_100023AA+Bj
		xor	edx, edx
		mov	[ecx+eax*2], dx
		retn	4
sub_100023AA	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100023C2(void *Dst, int, int, int)
sub_100023C2	proc near		; CODE XREF: sub_1000233F+2Bp
					; sub_100034D9+65p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_100023E2

loc_100023D7:				; CODE XREF: sub_100023C2+36j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100023E2:				; CODE XREF: sub_100023C2+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_100023EE
		mov	edi, [esp+10h+arg_8]

loc_100023EE:				; CODE XREF: sub_100023C2+26j
		cmp	esi, ebx
		jnz	short loc_1000240C
		lea	eax, [edi+ebp]
		cmp	[esi+10h], eax
		jb	short loc_100023D7
		push	eax
		call	sub_100023AA
		push	ebp
		push	0
		mov	ecx, esi
		call	sub_10002559
		jmp	short loc_1000243E
; ---------------------------------------------------------------------------

loc_1000240C:				; CODE XREF: sub_100023C2+2Ej
		push	0
		push	edi
		call	sub_10002447
		test	al, al
		jz	short loc_1000243E
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_10002420
		mov	ebx, [ebx]

loc_10002420:				; CODE XREF: sub_100023C2+5Aj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000242A
		mov	ecx, [esi]
		jmp	short loc_1000242C
; ---------------------------------------------------------------------------

loc_1000242A:				; CODE XREF: sub_100023C2+62j
		mov	ecx, esi	; Dst

loc_1000242C:				; CODE XREF: sub_100023C2+66j
		push	edi		; int
		lea	edx, [ebx+ebp*2] ; Src
		call	sub_10001AFC
		pop	ecx
		push	edi
		mov	ecx, esi
		call	sub_100023AA

loc_1000243E:				; CODE XREF: sub_100023C2+48j
					; sub_100023C2+54j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100023C2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002447	proc near		; CODE XREF: sub_1000233F+39p
					; sub_100023C2+4Dp ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 7FFFFFFEh
		jbe	short loc_1000245F
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000245F:				; CODE XREF: sub_10002447+Bj
		cmp	[ecx+14h], esi
		jnb	short loc_1000246F
		push	dword ptr [ecx+10h] ; int
		push	esi		; int
		call	sub_100025B6
		jmp	short loc_100024A2
; ---------------------------------------------------------------------------

loc_1000246F:				; CODE XREF: sub_10002447+1Bj
		cmp	[esp+4+arg_4], 0
		jz	short loc_1000248E
		cmp	esi, 8
		jnb	short loc_1000248E
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_10002484
		mov	eax, esi

loc_10002484:				; CODE XREF: sub_10002447+39j
		push	eax
		push	1
		call	sub_100022FA
		jmp	short loc_100024A2
; ---------------------------------------------------------------------------

loc_1000248E:				; CODE XREF: sub_10002447+2Dj
					; sub_10002447+32j
		test	esi, esi
		jnz	short loc_100024A2
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000249D
		mov	ecx, [ecx]

loc_1000249D:				; CODE XREF: sub_10002447+52j
		xor	eax, eax
		mov	[ecx], ax

loc_100024A2:				; CODE XREF: sub_10002447+26j
					; sub_10002447+45j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_10002447	endp


; =============== S U B	R O U T	I N E =======================================


sub_100024AE	proc near		; CODE XREF: sub_1000233F+Bp
					; sub_10003375+9p ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_100024E2
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100024C0
		mov	eax, [ecx]
		jmp	short loc_100024C2
; ---------------------------------------------------------------------------

loc_100024C0:				; CODE XREF: sub_100024AE+Cj
		mov	eax, ecx

loc_100024C2:				; CODE XREF: sub_100024AE+10j
		cmp	edx, eax
		jb	short loc_100024E2
		cmp	dword ptr [ecx+14h], 8
		push	esi
		jb	short loc_100024D1
		mov	esi, [ecx]
		jmp	short loc_100024D3
; ---------------------------------------------------------------------------

loc_100024D1:				; CODE XREF: sub_100024AE+1Dj
		mov	esi, ecx

loc_100024D3:				; CODE XREF: sub_100024AE+21j
		mov	eax, [ecx+10h]
		lea	eax, [esi+eax*2]
		pop	esi
		cmp	eax, edx
		jbe	short loc_100024E2
		mov	al, 1
		jmp	short locret_100024E4
; ---------------------------------------------------------------------------

loc_100024E2:				; CODE XREF: sub_100024AE+6j
					; sub_100024AE+16j ...
		xor	al, al

locret_100024E4:			; CODE XREF: sub_100024AE+32j
		retn	4
sub_100024AE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100024E7	proc near		; CODE XREF: sub_1000266C+3Ap
					; sub_10002830+52p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		mov	[edi], esi
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	ecx, [eax+esi+38h]
		test	ecx, ecx
		jz	short loc_10002503
		mov	eax, [ecx]
		call	dword ptr [eax+4]

loc_10002503:				; CODE XREF: sub_100024E7+15j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_10002521
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_10002521
		cmp	ecx, esi
		jz	short loc_10002521
		call	ds:?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<char,std::char_traits<char>>::flush(void)

loc_10002521:				; CODE XREF: sub_100024E7+26j
					; sub_100024E7+2Ej ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100024E7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002538	proc near		; CODE XREF: sub_1000266C+109p
					; sub_10002830+130p
		push	esi
		mov	esi, ecx
		mov	ecx, [esi]
		call	ds:?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ ;	std::basic_ostream<char,std::char_traits<char>>::_Osfx(void)
		mov	ecx, [esi]
		pop	esi
		mov	eax, [ecx]
		mov	eax, [eax+4]
		mov	ecx, [eax+ecx+38h]
		test	ecx, ecx
		jz	short locret_10002558
		mov	eax, [ecx]
		jmp	dword ptr [eax+8]
; ---------------------------------------------------------------------------

locret_10002558:			; CODE XREF: sub_10002538+19j
		retn
sub_10002538	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002559	proc near		; CODE XREF: sub_100023C2+43p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, edx
		jnb	short loc_10002573
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10002573:				; CODE XREF: sub_10002559+Dj
		mov	eax, edi
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		sub	eax, edx
		cmp	eax, ebx
		ja	short loc_10002583
		push	edx
		jmp	short loc_100025A9
; ---------------------------------------------------------------------------

loc_10002583:				; CODE XREF: sub_10002559+25j
		test	ebx, ebx
		jz	short loc_100025AE
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002591
		mov	eax, [esi]
		jmp	short loc_10002593
; ---------------------------------------------------------------------------

loc_10002591:				; CODE XREF: sub_10002559+32j
		mov	eax, esi

loc_10002593:				; CODE XREF: sub_10002559+36j
		lea	ecx, [eax+edx*2] ; Dst
		sub	edi, ebx
		mov	eax, edi
		sub	eax, edx
		lea	edx, [ecx+ebx*2] ; Src
		push	eax		; int
		call	sub_10001B16
		pop	ecx
		push	edi
		mov	ecx, esi

loc_100025A9:				; CODE XREF: sub_10002559+28j
		call	sub_100023AA

loc_100025AE:				; CODE XREF: sub_10002559+2Cj
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10002559	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100025B6(void *Src, int, int)
sub_100025B6	proc near		; CODE XREF: sub_10002447+21p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	esi, ecx
		or	edi, 7
		cmp	edi, 7FFFFFFEh
		jbe	short loc_100025D1
		mov	edi, [esp+10h+arg_0]
		jmp	short loc_100025F5
; ---------------------------------------------------------------------------

loc_100025D1:				; CODE XREF: sub_100025B6+13j
		push	3
		xor	edx, edx
		mov	ebx, [esi+14h]
		mov	eax, edi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_100025F5
		mov	edi, 7FFFFFFEh
		mov	eax, edi
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_100025F5
		lea	edi, [ecx+ebx]

loc_100025F5:				; CODE XREF: sub_100025B6+19j
					; sub_100025B6+2Dj ...
		lea	eax, [edi+1]
		push	eax
		call	sub_10002640
		mov	ebx, [esp+10h+arg_4]
		mov	ebp, eax
		test	ebx, ebx
		jz	short loc_1000261D
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002612
		mov	edx, [esi]
		jmp	short loc_10002614
; ---------------------------------------------------------------------------

loc_10002612:				; CODE XREF: sub_100025B6+56j
		mov	edx, esi	; Src

loc_10002614:				; CODE XREF: sub_100025B6+5Aj
		push	ebx		; int
		mov	ecx, ebp	; Dst
		call	sub_10001AFC
		pop	ecx

loc_1000261D:				; CODE XREF: sub_100025B6+50j
		push	0
		push	1
		mov	ecx, esi
		call	sub_100022FA
		test	esi, esi
		jz	short loc_1000262E
		mov	[esi], ebp

loc_1000262E:				; CODE XREF: sub_100025B6+74j
		push	ebx
		mov	ecx, esi
		mov	[esi+14h], edi
		call	sub_100023AA
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_100025B6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002640	proc near		; CODE XREF: sub_100025B6+43p
					; sub_10004130+A4p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10002667
		cmp	eax, 7FFFFFFFh
		ja	short loc_10002661
		add	eax, eax
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10002667

loc_10002661:				; CODE XREF: sub_10002640+Fj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10002667:				; CODE XREF: sub_10002640+8j
					; sub_10002640+1Fj
		mov	eax, ecx
		retn	4
sub_10002640	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000266C	proc near		; CODE XREF: sub_10001BEE+2Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		push	edi
		xor	ebx, ebx
		mov	eax, [esi]
		mov	ecx, [ebp+10h]
		mov	[esp+24h+var_14], ecx
		mov	edi, [eax+4]
		cmp	[edi+esi+24h], ebx
		jl	short loc_1000269F
		jg	short loc_10002693
		cmp	[edi+esi+20h], ebx
		jbe	short loc_1000269F

loc_10002693:				; CODE XREF: sub_1000266C+1Fj
		mov	edi, [edi+esi+20h]
		cmp	edi, ecx
		jbe	short loc_1000269F
		sub	edi, ecx
		jmp	short loc_100026A1
; ---------------------------------------------------------------------------

loc_1000269F:				; CODE XREF: sub_1000266C+1Dj
					; sub_1000266C+25j ...
		xor	edi, edi

loc_100026A1:				; CODE XREF: sub_1000266C+31j
		push	esi
		lea	ecx, [esp+28h+var_C]
		call	sub_100024E7
		cmp	[esp+24h+var_8], bl
		jnz	short loc_100026B9
		push	4
		pop	ebx
		jmp	loc_10002761
; ---------------------------------------------------------------------------

loc_100026B9:				; CODE XREF: sub_1000266C+43j
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	eax, [eax+esi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100026F3
		test	edi, edi
		jz	short loc_100026F3

loc_100026D0:				; CODE XREF: sub_1000266C+85j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	al, [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		mov	byte ptr [esp+24h+var_10], al
		push	[esp+24h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10002745
		dec	edi
		jnz	short loc_100026D0

loc_100026F3:				; CODE XREF: sub_1000266C+5Ej
					; sub_1000266C+62j
		cmp	dword ptr [ebp+14h], 10h
		jb	short loc_100026FC
		mov	ebp, [ebp+0]

loc_100026FC:				; CODE XREF: sub_1000266C+8Bj
		mov	eax, [esi]
		push	0
		push	[esp+28h+var_14]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+esi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+24h+var_14]
		jnz	short loc_1000274F
		test	edx, edx
		jnz	short loc_1000274F

loc_1000271C:				; CODE XREF: sub_1000266C+DCj
		test	edi, edi
		jz	short loc_10002752

loc_10002720:				; CODE XREF: sub_1000266C+D5j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	al, [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		mov	byte ptr [esp+24h+var_10], al
		push	[esp+24h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000274A
		dec	edi
		jnz	short loc_10002720
		jmp	short loc_10002752
; ---------------------------------------------------------------------------

loc_10002745:				; CODE XREF: sub_1000266C+82j
		push	4
		pop	ebx
		jmp	short loc_1000271C
; ---------------------------------------------------------------------------

loc_1000274A:				; CODE XREF: sub_1000266C+D2j
		or	ebx, 4
		jmp	short loc_10002752
; ---------------------------------------------------------------------------

loc_1000274F:				; CODE XREF: sub_1000266C+AAj
					; sub_1000266C+AEj
		push	4
		pop	ebx

loc_10002752:				; CODE XREF: sub_1000266C+B2j
					; sub_1000266C+D7j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		and	dword ptr [eax+esi+20h], 0
		and	dword ptr [eax+esi+24h], 0

loc_10002761:				; CODE XREF: sub_1000266C+48j
		mov	eax, [esi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, esi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_10002538
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1000266C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002784	proc near		; CODE XREF: sub_10003248+75p

Src		= byte ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	edx, ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		test	byte ptr [edx+3Ch], 2
		push	edi
		jnz	short loc_100027D4
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_100027D4
		cmp	[edx+38h], ecx
		jb	short loc_100027B3
		mov	ecx, [edx+38h]

loc_100027B3:				; CODE XREF: sub_10002784+2Aj
		mov	eax, [edx+10h]

loc_100027B6:				; CODE XREF: sub_10002784+69j
		mov	eax, [eax]
		xor	ebx, ebx
		push	0Fh
		pop	edi
		sub	ecx, eax
		mov	[ebp+var_C], edi
		push	ecx		; Size
		push	eax		; Src
		lea	ecx, [ebp+Src]	; Dst
		mov	[ebp+var_10], ebx
		mov	[ebp+Src], bl
		call	sub_100018C4
		jmp	short loc_100027FD
; ---------------------------------------------------------------------------

loc_100027D4:				; CODE XREF: sub_10002784+1Cj
					; sub_10002784+25j
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_100027EF
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_100027EF
		mov	eax, [edx+2Ch]
		mov	ecx, [eax]
		mov	eax, [edx+0Ch]
		add	ecx, edi
		jmp	short loc_100027B6
; ---------------------------------------------------------------------------

loc_100027EF:				; CODE XREF: sub_10002784+54j
					; sub_10002784+5Dj
		push	0Fh
		xor	ebx, ebx
		pop	edi
		mov	[ebp+var_C], edi
		mov	[ebp+var_10], ebx
		mov	[ebp+Src], bl

loc_100027FD:				; CODE XREF: sub_10002784+4Ej
		lea	eax, [ebp+Src]
		mov	[esi+14h], edi
		mov	[esi+10h], ebx
		mov	ecx, esi
		push	eax		; Src
		mov	[esi], bl
		call	sub_100022B3
		push	ebx		; Size
		push	1		; char
		lea	ecx, [ebp+Src]
		call	sub_10001883
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10002784	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002830	proc near		; CODE XREF: sub_10003248+28p
					; sub_10003248+34p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= byte ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		mov	eax, edx
		xor	ebp, ebp
		push	edi
		mov	edi, ecx
		mov	[esp+28h+var_C], eax
		mov	ecx, eax
		call	sub_100010C6
		mov	esi, [edi]
		mov	[esp+28h+var_14], eax
		mov	edx, [esi+4]
		mov	ebx, [edx+edi+24h]
		mov	esi, [edx+edi+20h]
		test	ebx, ebx
		jl	short loc_10002879
		jg	short loc_10002873
		test	esi, esi
		jz	short loc_10002879
		test	ebx, ebx
		jl	short loc_10002879
		jg	short loc_10002873
		cmp	esi, eax
		jbe	short loc_10002879

loc_10002873:				; CODE XREF: sub_10002830+33j
					; sub_10002830+3Dj
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_1000287D
; ---------------------------------------------------------------------------

loc_10002879:				; CODE XREF: sub_10002830+31j
					; sub_10002830+37j ...
		xor	esi, esi
		xor	ebx, ebx

loc_1000287D:				; CODE XREF: sub_10002830+47j
		push	edi
		lea	ecx, [esp+2Ch+var_8]
		call	sub_100024E7
		cmp	[esp+28h+var_4], 0
		jnz	short loc_10002896
		push	4
		pop	ebp
		jmp	loc_1000294C
; ---------------------------------------------------------------------------

loc_10002896:				; CODE XREF: sub_10002830+5Cj
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100028DF
		test	ebx, ebx
		jl	short loc_100028DF
		jle	short loc_100028DB

loc_100028AF:				; CODE XREF: sub_10002830+A7j
					; sub_10002830+ADj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+28h+var_10], al
		push	[esp+28h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000293A
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100028AF
		jl	short loc_100028DF

loc_100028DB:				; CODE XREF: sub_10002830+7Dj
		test	esi, esi
		jnz	short loc_100028AF

loc_100028DF:				; CODE XREF: sub_10002830+77j
					; sub_10002830+7Bj ...
		mov	eax, [edi]
		push	0
		push	[esp+2Ch+var_14]
		mov	eax, [eax+4]
		push	[esp+30h+var_C]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+28h+var_14]
		jnz	short loc_1000293A
		test	edx, edx
		jnz	short loc_1000293A
		test	ebx, ebx
		jl	short loc_1000293D
		jle	short loc_10002934

loc_10002908:				; CODE XREF: sub_10002830+100j
					; sub_10002830+106j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+28h+var_C], al
		push	[esp+28h+var_C]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000293A
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_10002908
		jl	short loc_1000293D

loc_10002934:				; CODE XREF: sub_10002830+D6j
		test	esi, esi
		jnz	short loc_10002908
		jmp	short loc_1000293D
; ---------------------------------------------------------------------------

loc_1000293A:				; CODE XREF: sub_10002830+9Dj
					; sub_10002830+CCj ...
		push	4
		pop	ebp

loc_1000293D:				; CODE XREF: sub_10002830+D4j
					; sub_10002830+102j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_1000294C:				; CODE XREF: sub_10002830+61j
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		lea	ecx, [esp+28h+var_8]
		call	sub_10002538
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10002830	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000296F	proc near		; DATA XREF: .rdata:off_1001A954o

arg_0		= byte ptr  4

; FUNCTION CHUNK AT 10002276 SIZE 00000020 BYTES

		sub	ecx, [ecx-4]
		jmp	loc_10002276
sub_1000296F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002977	proc near		; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+4Bp
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, offset aDummy ; "dummy"
		push	edi
		push	6
		push	1
		mov	eax, [esi]
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	7
		push	2
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	offset aHkey_current_4 ; "HKEY_CURRENT_USER\\dummy"
		push	0Bh
		push	3
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	0Ah
		push	4
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	5
		push	5
		call	dword ptr [eax+5Ch]
		pop	edi
		pop	esi
		retn
sub_10002977	endp

; Exported entry  11. ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z

; =============== S U B	R O U T	I N E =======================================


; void __cdecl mozilla::sandboxing::ProvideLogFunction(mozilla::sandboxing *this, void (__cdecl	*)(const char *, const char *, const char *, bool, unsigned int))
		public ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z proc near
					; DATA XREF: .rdata:off_1002E058o

this		= dword	ptr  4

		mov	eax, [esp+this]
		mov	dword_10031378,	eax
		retn
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z endp


; =============== S U B	R O U T	I N E =======================================


sub_100029CB	proc near		; CODE XREF: sub_100029E7+3Ep
					; sub_10002A52+4Cp ...

arg_0		= dword	ptr  4

		mov	eax, dword_10031378
		test	eax, eax
		jz	short locret_100029E6
		push	[esp+arg_0]
		push	1
		push	edx
		push	ecx
		push	offset aBlocked	; "BLOCKED"
		call	eax ; dword_10031378
		add	esp, 14h

locret_100029E6:			; CODE XREF: sub_100029CB+7j
		retn
sub_100029CB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100029E7	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+8Ap
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+82p

var_34		= byte ptr -34h
Dst		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10031378,	0
		push	esi
		mov	esi, ecx
		jz	short loc_10002A43
		push	edx		; Src
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_10001C68
		lea	edx, [ebp+Dst]
		lea	ecx, [ebp+var_34]
		call	sub_10004368
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002A1F
		mov	eax, [eax]

loc_10002A1F:				; CODE XREF: sub_100029E7+34j
		push	3
		mov	edx, eax
		mov	ecx, esi
		call	sub_100029CB
		pop	ecx
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+var_34]
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA

loc_10002A43:				; CODE XREF: sub_100029E7+1Aj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100029E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002A52	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+5Ap
					; TargetNtOpenFile(x,x,x,x,x,x,x)+49p ...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		cmp	dword_10031378,	0
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		movzx	eax, ax
		jz	short loc_10002ABE
		shr	eax, 1
		lea	ecx, [esp+38h+var_1C]
		push	eax		; int
		push	edx		; Src
		call	sub_10002BC9
		mov	edx, eax
		lea	ecx, [esp+38h+var_34]
		call	sub_10004368
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002A98
		mov	eax, [eax]

loc_10002A98:				; CODE XREF: sub_10002A52+42j
		push	3
		mov	edx, eax
		mov	ecx, esi
		call	sub_100029CB
		pop	ecx
		push	0		; Size
		push	1		; char
		lea	ecx, [esp+40h+var_34]
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_100022FA

loc_10002ABE:				; CODE XREF: sub_10002A52+24j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002A52	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002ACE	proc near		; CODE XREF: sub_10002AE8+3Cp
					; sub_10002B50+4Ap ...
		mov	eax, dword_10031378
		test	eax, eax
		jz	short locret_10002AE7
		push	0
		push	0
		push	edx
		push	ecx
		push	offset aBrokerAllowed ;	"Broker	ALLOWED"
		call	eax ; dword_10031378
		add	esp, 14h

locret_10002AE7:			; CODE XREF: sub_10002ACE+7j
		retn
sub_10002ACE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002AE8	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+15Cp
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+160p

var_34		= byte ptr -34h
Dst		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10031378,	0
		push	esi
		mov	esi, ecx
		jz	short loc_10002B41
		push	edx		; Src
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_10001C68
		lea	edx, [ebp+Dst]
		lea	ecx, [ebp+var_34]
		call	sub_10004368
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002B20
		mov	eax, [eax]

loc_10002B20:				; CODE XREF: sub_10002AE8+34j
		mov	edx, eax
		mov	ecx, esi
		call	sub_10002ACE
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+var_34]
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA

loc_10002B41:				; CODE XREF: sub_10002AE8+1Aj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002AE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002B50	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1ADp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+190p	...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		cmp	dword_10031378,	0
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		movzx	eax, ax
		jz	short loc_10002BB9
		shr	eax, 1
		lea	ecx, [esp+38h+var_1C]
		push	eax		; int
		push	edx		; Src
		call	sub_10002BC9
		mov	edx, eax
		lea	ecx, [esp+38h+var_34]
		call	sub_10004368
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002B96
		mov	eax, [eax]

loc_10002B96:				; CODE XREF: sub_10002B50+42j
		mov	edx, eax
		mov	ecx, esi
		call	sub_10002ACE
		push	0		; Size
		push	1		; char
		lea	ecx, [esp+40h+var_34]
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_100022FA

loc_10002BB9:				; CODE XREF: sub_10002B50+24j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002B50	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002BC9(void *Src,	int)
sub_10002BC9	proc near		; CODE XREF: sub_10002A52+2Ep
					; sub_10002B50+2Ep ...

Src		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_4]	; int
		mov	esi, ecx
		xor	eax, eax
		push	[esp+8+Src]	; Src
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_1000233F
		mov	eax, esi
		pop	esi
		retn	8
sub_10002BC9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002BEF	proc near		; CODE XREF: sub_100053AA+2Ap
					; sub_100055C9+14p
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, ecx
		push	offset aUnknown	; "unknown"
		lea	ecx, [esi+28h]	; Dst
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+10h], ebx
		mov	[esi+14h], ebx
		mov	[esi+18h], ebx
		mov	[esi+1Ch], ebx
		mov	[esi+20h], ebx
		mov	[esi+24h], ebx
		call	sub_100017BF
		mov	dword ptr [esi+54h], 0Fh
		mov	ecx, esi
		mov	[esi+50h], ebx
		mov	[esi+40h], bl
		call	sub_10002C38
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10002BEF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002C38	proc near		; CODE XREF: sub_10002BEF+3Fp

var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
Src		= byte ptr -34h
var_4		= dword	ptr -4

		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		or	[esp+50h+var_50], 0FFFFFFFFh
		xor	eax, eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		lea	edi, [esp+60h+var_4C]
		mov	ebp, ecx
		stosd
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	[esp+60h+var_38], ebp
		push	0Ch		; Size
		stosd
		stosd
		xor	eax, eax
		cpuid
		mov	[esi], eax
		lea	edi, [esp+64h+Src]
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		lea	esi, [esp+64h+var_4C]
		mov	ecx, [esp+64h+var_48]
		mov	eax, [esp+64h+var_44]
		mov	[esp+64h+var_48], eax
		lea	eax, [esp+64h+Src]
		mov	[esp+64h+var_44], ecx
		lea	ecx, [ebp+28h]	; Dst
		movsd
		push	eax		; Src
		movsd
		movsd
		call	sub_100018C4
		cmp	[esp+60h+var_50], 0
		jle	loc_10002D99
		xor	eax, eax
		lea	esi, [esp+60h+var_50]
		inc	eax
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	esi, [esp+60h+var_50]
		mov	eax, esi
		push	0Fh
		pop	edi
		and	eax, edi
		mov	ebx, [esp+60h+var_48]
		mov	[ebp+10h], eax
		mov	edx, esi
		sar	edx, 0Ch
		mov	ecx, esi
		sar	ecx, 4
		mov	eax, edx
		and	eax, 0F0h
		mov	[ebp+0], esi
		and	ecx, edi
		and	edx, 3
		add	ecx, eax
		mov	[ebp+4], edx
		mov	eax, esi
		mov	[ebp+0Ch], ecx
		sar	eax, 8
		mov	ecx, [esp+60h+var_44]
		and	eax, edi
		mov	[ebp+8], eax
		mov	eax, esi
		sar	eax, 10h
		and	eax, edi
		sar	esi, 14h
		mov	[ebp+14h], eax
		and	esi, 0FFh
		mov	eax, ecx
		mov	[ebp+18h], esi
		shr	eax, 17h
		and	al, 1
		mov	[ebp+1Ch], al
		mov	eax, ecx
		shr	eax, 19h
		and	al, 1
		shr	ecx, 1Ah
		mov	[ebp+1Dh], al
		and	cl, 1
		mov	al, bl
		mov	[ebp+1Eh], cl
		and	al, 1
		mov	[ebp+1Fh], al
		mov	eax, ebx
		shr	eax, 9
		and	al, 1
		mov	[ebp+20h], al
		mov	eax, ebx
		shr	eax, 13h
		and	al, 1
		mov	[ebp+21h], al
		mov	eax, ebx
		shr	eax, 14h
		and	al, 1
		mov	[ebp+22h], al
		mov	eax, ebx
		shr	eax, 1Ch
		and	al, 1
		push	0
		mov	[ebp+24h], al
		pop	eax
		jz	short loc_10002D8D
		test	ebx, 4000000h
		jz	short loc_10002D8D
		test	ebx, 8000000h
		jz	short loc_10002D8D
		xor	ecx, ecx
		xgetbv
		and	eax, 6
		cmp	eax, 6
		jnz	short loc_10002D8B
		xor	eax, eax
		cmp	eax, eax
		jnz	short loc_10002D8D
		inc	eax
		jmp	short loc_10002D8D
; ---------------------------------------------------------------------------

loc_10002D8B:				; CODE XREF: sub_10002C38+148j
		xor	eax, eax

loc_10002D8D:				; CODE XREF: sub_10002C38+12Bj
					; sub_10002C38+133j ...
		shr	ebx, 19h
		and	bl, 1
		mov	[ebp+23h], al
		mov	[ebp+25h], bl

loc_10002D99:				; CODE XREF: sub_10002C38+69j
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	eax, 80000000h
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	ebx, [esp+60h+var_50]
		mov	[esp+60h+var_3C], ebx
		cmp	ebx, 80000004h
		jl	short loc_10002E1A
		mov	eax, 80000002h
		lea	ebp, [esp+60h+Src]
		mov	[esp+60h+var_40], eax

loc_10002DCE:				; CODE XREF: sub_10002C38+1C8j
		lea	ecx, [esp+60h+var_4]
		cmp	ebp, ecx
		jnb	short loc_10002E02
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	edi, ebp
		mov	eax, [esp+60h+var_40]
		add	ebp, 10h
		mov	[esi+4], ebx
		inc	eax
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		movsd
		mov	[esp+60h+var_40], eax
		movsd
		movsd
		movsd
		cmp	eax, 80000004h
		jle	short loc_10002DCE

loc_10002E02:				; CODE XREF: sub_10002C38+19Cj
		lea	eax, [esp+60h+Src]
		sub	ebp, eax
		push	ebp		; Size
		mov	ebp, [esp+64h+var_38]
		push	eax		; Src
		lea	ecx, [ebp+40h]	; Dst
		call	sub_100018C4
		mov	ebx, [esp+60h+var_3C]

loc_10002E1A:				; CODE XREF: sub_10002C38+187j
		mov	eax, 80000007h
		cmp	ebx, eax
		jl	short loc_10002E42
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	eax, [esp+60h+var_44]
		shr	eax, 8
		and	al, 1
		mov	[ebp+26h], al

loc_10002E42:				; CODE XREF: sub_10002C38+1E9j
		mov	ecx, [esp+60h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
sub_10002C38	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002E55	proc near		; CODE XREF: sub_10005952+87p
					; sub_10005A18+8Dp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_10002E55	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002E5A	proc near		; DATA XREF: .rdata:off_1001AA20o

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001AA20
		jz	short loc_10002E72
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10002E72:				; CODE XREF: sub_10002E5A+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10002E5A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002E78	proc near		; CODE XREF: sub_1000457F+59p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		mov	ecx, dword_10031F40
		test	ecx, ecx
		jnz	short loc_10002EC9
		push	offset Str	; ".thunks"
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], 10000000h
		call	sub_100056E6
		test	eax, eax
		jz	short loc_10002EC0
		push	offset a_syzygy	; ".syzygy"
		lea	ecx, [ebp+var_8]
		call	sub_100056E6
		test	eax, eax
		jz	short loc_10002EC0
		xor	ecx, ecx
		inc	ecx
		jmp	short loc_10002EC3
; ---------------------------------------------------------------------------

loc_10002EC0:				; CODE XREF: sub_10002E78+30j
					; sub_10002E78+41j
		push	2
		pop	ecx

loc_10002EC3:				; CODE XREF: sub_10002E78+46j
		mov	dword_10031F40,	ecx

loc_10002EC9:				; CODE XREF: sub_10002E78+11j
		xor	eax, eax
		cmp	ecx, 1
		setz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_10002E78	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002ED5	proc near		; CODE XREF: sub_10005C64+1Ap
		test	ecx, ecx
		jz	short loc_10002F21
		movzx	edx, word ptr [ecx]
		movzx	ecx, word ptr [ecx+2]
		add	edx, 4
		mov	eax, edx
		shl	eax, 5
		xor	ecx, eax
		shl	ecx, 0Bh
		xor	edx, ecx
		mov	eax, edx
		shr	eax, 0Bh
		add	edx, eax
		mov	eax, edx
		shl	eax, 3
		xor	edx, eax
		mov	eax, edx
		shr	eax, 5
		add	edx, eax
		mov	eax, edx
		shl	eax, 4
		xor	edx, eax
		mov	eax, edx
		shr	eax, 11h
		add	edx, eax
		mov	eax, edx
		shl	eax, 19h
		xor	edx, eax
		mov	eax, edx
		shr	eax, 6
		add	eax, edx
		retn
; ---------------------------------------------------------------------------

loc_10002F21:				; CODE XREF: sub_10002ED5+2j
		xor	eax, eax
		retn
sub_10002ED5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F24	proc near		; CODE XREF: sub_10005533+12p
					; sub_10005AF6+12p ...
		xor	edx, edx
		xor	eax, eax
		push	esi
		mov	esi, ecx
		inc	edx
		lock cmpxchg [esi], edx
		test	eax, eax
		jnz	short loc_10002F40
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002F38:				; CODE XREF: sub_10002F24+21j
		push	0		; dwMilliseconds
		call	ds:Sleep

loc_10002F40:				; CODE XREF: sub_10002F24+Ej
		mov	eax, [esi]
		cmp	eax, 1
		jz	short loc_10002F38
		xor	al, al
		pop	esi
		retn
sub_10002F24	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F4B	proc near		; CODE XREF: sub_100045FD+1Cp
		mov	eax, [esp+0]
		retn
sub_10002F4B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F4F	proc near		; CODE XREF: sub_10004257+Ep

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10002F59
		mov	edx, [ecx]
		jmp	short loc_10002F5B
; ---------------------------------------------------------------------------

loc_10002F59:				; CODE XREF: sub_10002F4F+4j
		mov	edx, ecx

loc_10002F5B:				; CODE XREF: sub_10002F4F+8j
		mov	eax, [ecx+10h]
		add	eax, edx
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10002F6A
		mov	edx, [ecx]
		jmp	short loc_10002F6C
; ---------------------------------------------------------------------------

loc_10002F6A:				; CODE XREF: sub_10002F4F+15j
		mov	edx, ecx

loc_10002F6C:				; CODE XREF: sub_10002F4F+19j
		test	eax, eax
		jz	short loc_10002F72
		sub	eax, edx

loc_10002F72:				; CODE XREF: sub_10002F4F+1Fj
		push	[esp+arg_0]
		push	ecx
		push	eax
		call	sub_10002F80
		retn	4
sub_10002F4F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F80	proc near		; CODE XREF: sub_10002F4F+29p

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		cmp	ecx, edi
		jnb	short loc_10002F9A
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10002F9A:				; CODE XREF: sub_10002F80+Dj
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, 1
		ja	short loc_10002FAF
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10002FAF:				; CODE XREF: sub_10002F80+22j
		push	ebx
		lea	ebx, [ecx+1]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_1000198C
		test	al, al
		jz	short loc_1000300B
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10002FCB
		mov	edx, [esi]
		jmp	short loc_10002FCD
; ---------------------------------------------------------------------------

loc_10002FCB:				; CODE XREF: sub_10002F80+45j
		mov	edx, esi

loc_10002FCD:				; CODE XREF: sub_10002F80+49j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10002FD7
		mov	ecx, [esi]
		jmp	short loc_10002FD9
; ---------------------------------------------------------------------------

loc_10002FD7:				; CODE XREF: sub_10002F80+51j
		mov	ecx, esi

loc_10002FD9:				; CODE XREF: sub_10002F80+55j
		mov	eax, [esi+10h]
		inc	ecx
		sub	eax, edi
		add	edx, edi	; Src
		push	eax		; Size
		add	ecx, edi	; Dst
		call	sub_100010F8
		pop	ecx
		push	[esp+0Ch+arg_8]	; int
		mov	ecx, esi
		push	1		; Size
		push	edi		; int
		call	sub_10003013
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebx
		jb	short loc_10003005
		mov	eax, [esi]
		jmp	short loc_10003007
; ---------------------------------------------------------------------------

loc_10003005:				; CODE XREF: sub_10002F80+7Fj
		mov	eax, esi

loc_10003007:				; CODE XREF: sub_10002F80+83j
		mov	byte ptr [eax+ebx], 0

loc_1000300B:				; CODE XREF: sub_10002F80+3Fj
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10002F80	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10003013(int, size_t Size, int)
sub_10003013	proc near		; CODE XREF: sub_10002F80+73p
					; sub_10003055+3Fp

arg_0		= dword	ptr  8
Size		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+Size], 1
		mov	edx, ecx
		jnz	short loc_10003031
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_10003026
		mov	edx, [edx]

loc_10003026:				; CODE XREF: sub_10003013+Fj
		mov	eax, [ebp+arg_0]
		mov	cl, byte ptr [ebp+arg_8]
		mov	[edx+eax], cl
		jmp	short loc_10003051
; ---------------------------------------------------------------------------

loc_10003031:				; CODE XREF: sub_10003013+9j
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_10003039
		mov	edx, [edx]

loc_10003039:				; CODE XREF: sub_10003013+22j
		push	[ebp+Size]	; Size
		mov	eax, [ebp+arg_8]
		movsx	eax, al
		push	eax		; Val
		mov	eax, [ebp+arg_0]
		add	eax, edx
		push	eax		; Dst
		call	memset
		add	esp, 0Ch

loc_10003051:				; CODE XREF: sub_10003013+1Cj
		pop	ebp
		retn	0Ch
sub_10003013	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003055(size_t Size, int)
sub_10003055	proc near		; CODE XREF: sub_10003AFB+20p
					; sub_100044D9+43p

Size		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+Size]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_10003074
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003074:				; CODE XREF: sub_10003055+12j
		test	edi, edi
		jz	short loc_100030AD
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_1000198C
		test	al, al
		jz	short loc_100030AC
		push	[esp+0Ch+arg_4]	; int
		mov	ecx, esi
		push	edi		; Size
		push	dword ptr [esi+10h] ; int
		call	sub_10003013
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebx
		jb	short loc_100030A6
		mov	eax, [esi]
		jmp	short loc_100030A8
; ---------------------------------------------------------------------------

loc_100030A6:				; CODE XREF: sub_10003055+4Bj
		mov	eax, esi

loc_100030A8:				; CODE XREF: sub_10003055+4Fj
		mov	byte ptr [eax+ebx], 0

loc_100030AC:				; CODE XREF: sub_10003055+33j
		pop	ebx

loc_100030AD:				; CODE XREF: sub_10003055+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10003055	endp


; =============== S U B	R O U T	I N E =======================================


sub_100030B4	proc near		; CODE XREF: sub_10003B46+17p
					; sub_1000FB2D+AAp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_100030D3
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100030D3:				; CODE XREF: sub_100030B4+12j
		test	edi, edi
		jz	short loc_10003101
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_10002447
		test	al, al
		jz	short loc_10003100
		push	[esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+10h]
		call	sub_10003108
		push	ebx
		mov	ecx, esi
		call	sub_100023AA

loc_10003100:				; CODE XREF: sub_100030B4+33j
		pop	ebx

loc_10003101:				; CODE XREF: sub_100030B4+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_100030B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003108	proc near		; CODE XREF: sub_100030B4+3Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, ecx
		mov	ecx, [ebp+arg_4]
		cmp	ecx, 1
		jnz	short loc_1000312A
		cmp	dword ptr [edx+14h], 8
		jb	short loc_1000311D
		mov	edx, [edx]

loc_1000311D:				; CODE XREF: sub_10003108+11j
		mov	ecx, [ebp+arg_0]
		mov	ax, word ptr [ebp+arg_8]
		mov	[edx+ecx*2], ax
		jmp	short loc_10003154
; ---------------------------------------------------------------------------

loc_1000312A:				; CODE XREF: sub_10003108+Bj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10003132
		mov	edx, [edx]

loc_10003132:				; CODE XREF: sub_10003108+26j
		mov	eax, [ebp+arg_0]
		push	edi
		lea	edi, [edx+eax*2]
		test	ecx, ecx
		jz	short loc_10003153
		mov	eax, [ebp+arg_8]
		movzx	edx, ax
		mov	eax, edx
		shl	edx, 10h
		or	eax, edx
		shr	ecx, 1
		rep stosd
		adc	ecx, ecx
		rep stosw

loc_10003153:				; CODE XREF: sub_10003108+33j
		pop	edi

loc_10003154:				; CODE XREF: sub_10003108+20j
		pop	ebp
		retn	0Ch
sub_10003108	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003158	proc near		; CODE XREF: sub_1000CCAA+1Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi+8]
		mov	eax, esi
		mov	ecx, [edi+4]
		sub	eax, ecx
		cmp	eax, [esp+8+arg_0]
		jnb	short loc_100031E2
		mov	eax, [edi]
		sub	eax, ecx
		dec	eax
		cmp	eax, [esp+8+arg_0]
		jnb	short loc_10003182
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003182:				; CODE XREF: sub_10003158+1Dj
		sub	esi, [edi]
		or	eax, 0FFFFFFFFh
		sub	ecx, [edi]
		mov	edx, esi
		add	ecx, [esp+8+arg_0]
		shr	edx, 1
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_1000319B
		xor	esi, esi
		jmp	short loc_1000319D
; ---------------------------------------------------------------------------

loc_1000319B:				; CODE XREF: sub_10003158+3Dj
		add	esi, edx

loc_1000319D:				; CODE XREF: sub_10003158+41j
		cmp	esi, ecx
		jnb	short loc_100031A3
		mov	esi, ecx

loc_100031A3:				; CODE XREF: sub_10003158+47j
		push	ebx
		push	ebp
		push	esi
		call	sub_10001AB4
		mov	ecx, [edi+4]
		mov	ebx, eax
		sub	ecx, [edi]
		push	ecx		; Size
		push	dword ptr [edi]	; Src
		push	ebx		; Dst
		call	ds:memmove
		mov	ebp, [edi+4]
		add	esp, 0Ch
		sub	ebp, [edi]
		cmp	dword ptr [edi], 0
		jz	short loc_100031D2
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100031D2:				; CODE XREF: sub_10003158+6Fj
		lea	eax, [ebx+esi]
		mov	[edi], ebx
		mov	[edi+8], eax
		lea	eax, [ebx+ebp]
		pop	ebp
		mov	[edi+4], eax
		pop	ebx

loc_100031E2:				; CODE XREF: sub_10003158+12j
		pop	edi
		pop	esi
		retn	4
sub_10003158	endp


; =============== S U B	R O U T	I N E =======================================


sub_100031E7	proc near		; CODE XREF: sub_10004332:loc_10004361p
					; sub_100044D9+23p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10003216
		cmp	[esi+14h], eax
		jz	short loc_10003216
		push	1
		push	eax
		call	sub_1000198C
		test	al, al
		jz	short loc_10003216
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		jb	short loc_10003212
		mov	esi, [esi]

loc_10003212:				; CODE XREF: sub_100031E7+27j
		mov	byte ptr [esi+edi], 0

loc_10003216:				; CODE XREF: sub_100031E7+Dj
					; sub_100031E7+12j ...
		pop	edi
		pop	esi
		retn	4
sub_100031E7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000321B	proc near		; CODE XREF: sub_100184A4+1A1p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10003243
		cmp	[esi+14h], eax
		jz	short loc_10003243
		push	1
		push	eax
		call	sub_10002447
		test	al, al
		jz	short loc_10003243
		push	edi
		mov	ecx, esi
		call	sub_100023AA

loc_10003243:				; CODE XREF: sub_1000321B+Dj
					; sub_1000321B+12j ...
		pop	edi
		pop	esi
		retn	4
sub_1000321B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003248	proc near		; CODE XREF: sub_1000D7E3+26p

var_98		= byte ptr -98h
var_94		= byte ptr -94h
var_48		= byte ptr -48h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 98h
		push	esi
		push	edi
		push	ecx
		mov	edi, ecx
		mov	esi, edx
		push	ecx
		lea	ecx, [esp+0A8h+var_98]
		call	sub_10001C96
		push	dword ptr [esi]
		mov	edx, [ebp+arg_0]
		lea	ecx, [esp+0A4h+var_98]
		push	dword ptr [edi]
		call	sub_10002830
		mov	edx, offset asc_1001A950 ; " ("
		mov	ecx, eax
		call	sub_10002830
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		mov	edx, offset aVs_ ; " vs. "
		mov	ecx, eax
		call	sub_10002830
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		mov	edx, offset dword_1001A944
		mov	ecx, eax
		call	sub_10002830
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100032C4
		push	esi
		lea	ecx, [esp+0A4h+var_94]
		call	sub_10002784
		jmp	short loc_100032C6
; ---------------------------------------------------------------------------

loc_100032C4:				; CODE XREF: sub_10003248+6Ej
		xor	esi, esi

loc_100032C6:				; CODE XREF: sub_10003248+7Aj
		lea	ecx, [esp+0A0h+var_48]
		call	sub_10001CF8
		lea	ecx, [esp+0A0h+var_48]
		call	ds:??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::~basic_ios<char,std::char_traits<char>>(void)
		pop	edi
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10003248	endp


; =============== S U B	R O U T	I N E =======================================


sub_100032E1	proc near		; CODE XREF: sub_10003375+2Ap
					; sub_10011C50+37p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	eax, [ebx+10h]
		mov	esi, ecx
		cmp	eax, ebp
		jnb	short loc_10003300
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003300:				; CODE XREF: sub_100032E1+12j
		push	edi
		mov	edi, [esp+10h+arg_8]
		sub	eax, ebp
		cmp	eax, edi
		jnb	short loc_1000330D
		mov	edi, eax

loc_1000330D:				; CODE XREF: sub_100032E1+28j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_10003324
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003324:				; CODE XREF: sub_100032E1+36j
		test	edi, edi
		jz	short loc_1000336C
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_0], eax
		call	sub_10002447
		test	al, al
		jz	short loc_1000336C
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_10003345
		mov	ebx, [ebx]

loc_10003345:				; CODE XREF: sub_100032E1+60j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000334F
		mov	ecx, [esi]
		jmp	short loc_10003351
; ---------------------------------------------------------------------------

loc_1000334F:				; CODE XREF: sub_100032E1+68j
		mov	ecx, esi

loc_10003351:				; CODE XREF: sub_100032E1+6Cj
		mov	eax, [esi+10h]
		lea	edx, [ebx+ebp*2] ; Src
		push	edi		; int
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001AFC
		pop	ecx
		push	[esp+10h+arg_0]
		mov	ecx, esi
		call	sub_100023AA

loc_1000336C:				; CODE XREF: sub_100032E1+45j
					; sub_100032E1+5Aj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100032E1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003375(void *Src,	int)
sub_10003375	proc near		; CODE XREF: sub_10004130+7Ep
					; sub_10004130+101p ...

Src		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+Src]
		mov	esi, ecx
		push	edi
		call	sub_100024AE
		test	al, al
		jz	short loc_100033A6
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003391
		mov	eax, [esi]
		jmp	short loc_10003393
; ---------------------------------------------------------------------------

loc_10003391:				; CODE XREF: sub_10003375+16j
		mov	eax, esi

loc_10003393:				; CODE XREF: sub_10003375+1Aj
		push	[esp+8+arg_4]
		sub	edi, eax
		mov	ecx, esi
		sar	edi, 1
		push	edi
		push	esi
		call	sub_100032E1
		jmp	short loc_100033FF
; ---------------------------------------------------------------------------

loc_100033A6:				; CODE XREF: sub_10003375+10j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_100033C2
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100033C2:				; CODE XREF: sub_10003375+40j
		test	ebx, ebx
		jz	short loc_100033FC
		push	ebp
		lea	ebp, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_10002447
		test	al, al
		jz	short loc_100033FB
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100033E2
		mov	ecx, [esi]
		jmp	short loc_100033E4
; ---------------------------------------------------------------------------

loc_100033E2:				; CODE XREF: sub_10003375+67j
		mov	ecx, esi

loc_100033E4:				; CODE XREF: sub_10003375+6Bj
		mov	eax, [esi+10h]
		mov	edx, edi	; Src
		push	ebx		; int
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001AFC
		pop	ecx
		push	ebp
		mov	ecx, esi
		call	sub_100023AA

loc_100033FB:				; CODE XREF: sub_10003375+61j
		pop	ebp

loc_100033FC:				; CODE XREF: sub_10003375+4Fj
		mov	eax, esi
		pop	ebx

loc_100033FF:				; CODE XREF: sub_10003375+2Fj
		pop	edi
		pop	esi
		retn	8
sub_10003375	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003404	proc near		; CODE XREF: sub_100036C4+47p
					; sub_10003F01+3Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jmp	short loc_1000341C
; ---------------------------------------------------------------------------

loc_1000340D:				; CODE XREF: sub_10003404:loc_1000341Cj
		mov	ax, [ecx]
		cmp	ax, [edx]
		jnz	short loc_10003422
		add	ecx, 2
		add	edx, 2
		dec	esi

loc_1000341C:				; CODE XREF: sub_10003404+7j
		jnz	short loc_1000340D
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003422:				; CODE XREF: sub_10003404+Fj
		movzx	eax, word ptr [ecx]
		cmp	ax, [edx]
		pop	esi
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax
		retn
sub_10003404	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003430	proc near		; CODE XREF: sub_100036C4+6Fp
					; sub_10003B65+3Cp ...

arg_0		= dword	ptr  4

		test	edx, edx
		jz	short loc_10003446
		mov	eax, [esp+arg_0]
		movzx	eax, word ptr [eax]

loc_1000343B:				; CODE XREF: sub_10003430+14j
		cmp	[ecx], ax
		jz	short loc_10003448
		add	ecx, 2
		dec	edx
		jnz	short loc_1000343B

loc_10003446:				; CODE XREF: sub_10003430+2j
		xor	ecx, ecx

loc_10003448:				; CODE XREF: sub_10003430+Ej
		mov	eax, ecx
		retn
sub_10003430	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000344B	proc near		; CODE XREF: sub_10004805+89p
					; sub_10004976+4Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh	; int
		push	eax		; int
		push	[esp+0Ch+arg_0]	; int
		mov	dword ptr [esi+14h], 0Fh
		mov	[esi+10h], eax
		mov	[esi], al
		call	sub_100017EB
		mov	eax, esi
		pop	esi
		retn	4
sub_1000344B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000346E(void *Src)
sub_1000346E	proc near		; CODE XREF: sub_100035CD+3Ap
					; sub_100035CD+5Ap ...

Src		= dword	ptr  4

		push	esi
		push	[esp+4+Src]	; Src
		mov	esi, ecx
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10003490
		mov	eax, esi
		pop	esi
		retn	4
sub_1000346E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003490(void *Src)
sub_10003490	proc near		; CODE XREF: sub_1000346E+17p
					; sub_10003B23+18p

Src		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+Src]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 8
		jnb	short loc_100034AD
		mov	eax, [esi+10h]
		mov	edx, esi	; Src
		inc	eax
		push	eax		; int
		call	sub_10001B16
		pop	ecx
		jmp	short loc_100034B8
; ---------------------------------------------------------------------------

loc_100034AD:				; CODE XREF: sub_10003490+Cj
		test	edi, edi
		jz	short loc_100034B5
		mov	eax, [esi]
		mov	[edi], eax

loc_100034B5:				; CODE XREF: sub_10003490+1Fj
		and	dword ptr [esi], 0

loc_100034B8:				; CODE XREF: sub_10003490+1Bj
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		pop	edi
		mov	[esi], ax
		pop	esi
		retn	4
sub_10003490	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100034D9@<eax>(int@<ecx>, int, int)
sub_100034D9	proc near		; CODE XREF: sub_1000E953+5Ep
					; sub_1000E953+92p

var_26		= word ptr -26h
var_24		= dword	ptr -24h
Dst		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		mov	ebx, [esp+30h+arg_4]
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+3Ch+var_26], dx
		mov	ecx, ebx
		call	sub_1000369D
		mov	ebp, [edi+10h]
		xor	esi, esi
		xor	ecx, ecx
		cmp	esi, ebp

loc_10003506:				; CODE XREF: sub_100034D9+B0j
		jz	short loc_1000351F
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003512
		mov	eax, [edi]
		jmp	short loc_10003514
; ---------------------------------------------------------------------------

loc_10003512:				; CODE XREF: sub_100034D9+33j
		mov	eax, edi

loc_10003514:				; CODE XREF: sub_100034D9+37j
		mov	dx, [esp+3Ch+var_26]
		cmp	[eax+esi*2], dx
		jnz	short loc_10003586

loc_1000351F:				; CODE XREF: sub_100034D9:loc_10003506j
		and	[esp+3Ch+var_10], 0
		xor	eax, eax
		mov	[esp+3Ch+Dst], ax
		mov	eax, esi
		sub	eax, ecx
		mov	[esp+3Ch+var_C], 7
		push	eax		; int
		push	ecx		; int
		push	edi		; int
		lea	ecx, [esp+48h+Dst] ; Dst
		call	sub_100023C2
		lea	eax, [esp+3Ch+Dst]
		push	eax
		mov	ecx, eax
		call	sub_100038D1
		pop	ecx
		cmp	esi, ebp
		jnz	short loc_10003562
		mov	eax, [ebx]
		cmp	eax, [ebx+4]
		jnz	short loc_10003562
		cmp	[esp+3Ch+var_10], 0
		jz	short loc_1000356E

loc_10003562:				; CODE XREF: sub_100034D9+79j
					; sub_100034D9+80j
		lea	eax, [esp+3Ch+Dst]
		mov	ecx, ebx
		push	eax
		call	sub_10003635

loc_1000356E:				; CODE XREF: sub_100034D9+87j
		push	0
		lea	eax, [esi+1]
		push	1
		lea	ecx, [esp+44h+Dst]
		mov	[esp+44h+var_24], eax
		call	sub_100022FA
		mov	ecx, [esp+3Ch+var_24]

loc_10003586:				; CODE XREF: sub_100034D9+44j
		inc	esi
		cmp	esi, ebp
		jbe	loc_10003506
		mov	ecx, [esp+3Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_100034D9	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100035A2(int, void	*Dst, int, int)
sub_100035A2	proc near		; CODE XREF: sub_100039C2+5Cp
					; sub_100107C8+9Cp ...

Dst		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	[esp+4+arg_8]	; int
		mov	esi, [esp+8+Dst]
		xor	eax, eax
		push	[esp+8+arg_4]	; int
		push	ecx		; int
		and	dword ptr [esi+10h], 0
		mov	ecx, esi	; Dst
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100023C2
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_100035A2	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100035CD(void *Src)
sub_100035CD	proc near		; CODE XREF: sub_10013563+1C6p
					; sub_10013563+26Ep ...

Src		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+Src]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_10003612
		cmp	[esi], edi
		ja	short loc_10003612
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_100035FA
		push	ecx
		mov	ecx, esi
		call	sub_10003759

loc_100035FA:				; CODE XREF: sub_100035CD+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_1000360C
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax		; Src
		call	sub_1000346E

loc_1000360C:				; CODE XREF: sub_100035CD+32j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_10003630
; ---------------------------------------------------------------------------

loc_10003612:				; CODE XREF: sub_100035CD+Dj
					; sub_100035CD+11j
		cmp	ecx, [esi+8]
		jnz	short loc_1000361F
		push	ecx
		mov	ecx, esi
		call	sub_10003759

loc_1000361F:				; CODE XREF: sub_100035CD+48j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_1000362C
		push	edi		; Src
		call	sub_1000346E

loc_1000362C:				; CODE XREF: sub_100035CD+57j
		add	dword ptr [esi+4], 18h

loc_10003630:				; CODE XREF: sub_100035CD+43j
		pop	edi
		pop	esi
		retn	4
sub_100035CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003635	proc near		; CODE XREF: sub_100034D9+90p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_1000367A
		cmp	[esi], edi
		ja	short loc_1000367A
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_10003662
		push	ecx
		mov	ecx, esi
		call	sub_10003759

loc_10003662:				; CODE XREF: sub_10003635+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003674
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax
		call	sub_1000388D

loc_10003674:				; CODE XREF: sub_10003635+32j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_10003698
; ---------------------------------------------------------------------------

loc_1000367A:				; CODE XREF: sub_10003635+Dj
					; sub_10003635+11j
		cmp	ecx, [esi+8]
		jnz	short loc_10003687
		push	ecx
		mov	ecx, esi
		call	sub_10003759

loc_10003687:				; CODE XREF: sub_10003635+48j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003694
		push	edi
		call	sub_1000388D

loc_10003694:				; CODE XREF: sub_10003635+57j
		add	dword ptr [esi+4], 18h

loc_10003698:				; CODE XREF: sub_10003635+43j
		pop	edi
		pop	esi
		retn	4
sub_10003635	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000369D	proc near		; CODE XREF: sub_100034D9+1Fp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, [edi+4]
		mov	esi, [edi]
		jmp	short loc_100036B7
; ---------------------------------------------------------------------------

loc_100036A9:				; CODE XREF: sub_1000369D+1Cj
		push	0
		push	1
		mov	ecx, esi
		call	sub_100022FA
		add	esi, 18h

loc_100036B7:				; CODE XREF: sub_1000369D+Aj
		cmp	esi, ebx
		jnz	short loc_100036A9
		mov	eax, [edi]
		mov	[edi+4], eax
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_1000369D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100036C4	proc near		; CODE XREF: sub_100107C8+4Fp
					; sub_100107C8+74p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	esi
		mov	esi, ecx
		mov	ecx, [esp+8+arg_4]
		test	ebp, ebp
		jnz	short loc_100036DD
		cmp	ecx, [esi+10h]
		ja	short loc_100036DD
		mov	eax, ecx
		jmp	short loc_10003744
; ---------------------------------------------------------------------------

loc_100036DD:				; CODE XREF: sub_100036C4+Ej
					; sub_100036C4+13j
		push	ebx
		mov	ebx, [esi+10h]
		push	edi
		cmp	ecx, ebx
		jnb	short loc_1000373F
		sub	ebx, ecx
		cmp	ebp, ebx
		ja	short loc_1000373F
		xor	eax, eax
		inc	eax
		sub	eax, ebp
		add	ebx, eax
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100036FD
		mov	eax, [esi]
		jmp	short loc_100036FF
; ---------------------------------------------------------------------------

loc_100036FD:				; CODE XREF: sub_100036C4+33j
		mov	eax, esi

loc_100036FF:				; CODE XREF: sub_100036C4+37j
		lea	eax, [eax+ecx*2]
		jmp	short loc_10003727
; ---------------------------------------------------------------------------

loc_10003704:				; CODE XREF: sub_100036C4+79j
		mov	edx, [esp+10h+arg_0]
		mov	ecx, edi
		push	ebp
		call	sub_10003404
		pop	ecx
		test	eax, eax
		jz	short loc_10003749
		mov	ecx, edi
		or	eax, 0FFFFFFFFh
		sub	ecx, [esp+10h+arg_8]
		sar	ecx, 1
		sub	eax, ecx
		add	ebx, eax
		lea	eax, [edi+2]

loc_10003727:				; CODE XREF: sub_100036C4+3Ej
		push	[esp+10h+arg_0]
		mov	edx, ebx
		mov	[esp+14h+arg_8], eax
		mov	ecx, eax
		call	sub_10003430
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_10003704

loc_1000373F:				; CODE XREF: sub_100036C4+20j
					; sub_100036C4+26j
		or	eax, 0FFFFFFFFh

loc_10003742:				; CODE XREF: sub_100036C4+93j
		pop	edi
		pop	ebx

loc_10003744:				; CODE XREF: sub_100036C4+17j
		pop	esi
		pop	ebp
		retn	0Ch
; ---------------------------------------------------------------------------

loc_10003749:				; CODE XREF: sub_100036C4+4Fj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003751
		mov	esi, [esi]

loc_10003751:				; CODE XREF: sub_100036C4+89j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10003742
sub_100036C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003759	proc near		; CODE XREF: sub_100035CD+28p
					; sub_100035CD+4Dp ...
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	18h
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_100037BD
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 0AAAAAAAh
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_10003794
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003794:				; CODE XREF: sub_10003759+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_100037AC
		xor	eax, eax
		jmp	short loc_100037AE
; ---------------------------------------------------------------------------

loc_100037AC:				; CODE XREF: sub_10003759+4Dj
		add	eax, edx

loc_100037AE:				; CODE XREF: sub_10003759+51j
		cmp	eax, ecx
		jnb	short loc_100037B4
		mov	eax, ecx

loc_100037B4:				; CODE XREF: sub_10003759+57j
		push	eax
		mov	ecx, esi
		call	sub_100037C3
		pop	ebx

loc_100037BD:				; CODE XREF: sub_10003759+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_10003759	endp


; =============== S U B	R O U T	I N E =======================================


sub_100037C3	proc near		; CODE XREF: sub_10003759+5Ep

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		push	edi
		mov	esi, ecx
		xor	edi, edi
		mov	[esp+18h+var_4], esi
		test	ebp, ebp
		jz	short loc_100037F8
		cmp	ebp, 0AAAAAAAh
		ja	short loc_100037F2
		imul	eax, ebp, 18h
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_100037F8

loc_100037F2:				; CODE XREF: sub_100037C3+1Cj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100037F8:				; CODE XREF: sub_100037C3+14j
					; sub_100037C3+2Dj
		mov	ecx, [esi+4]
		push	ebx
		mov	ebx, [esi]
		mov	[esp+1Ch+var_C], ecx
		push	18h
		pop	eax
		mov	[esp+1Ch+var_8], eax
		cmp	ebx, ecx
		jz	short loc_1000382E
		mov	ebp, edi

loc_1000380F:				; CODE XREF: sub_100037C3+65j
		test	ebp, ebp
		jz	short loc_10003822
		push	ebx		; Src
		mov	ecx, ebp
		call	sub_1000346E
		mov	ecx, [esp+1Ch+var_C]
		push	18h
		pop	eax

loc_10003822:				; CODE XREF: sub_100037C3+4Ej
		add	ebx, eax
		add	ebp, eax
		cmp	ebx, ecx
		jnz	short loc_1000380F
		mov	ebp, [esp+1Ch+arg_0]

loc_1000382E:				; CODE XREF: sub_100037C3+48j
		mov	ecx, [esi+4]
		mov	eax, ecx
		mov	ebx, [esi]
		sub	eax, ebx
		cdq
		idiv	[esp+1Ch+var_8]
		mov	[esp+1Ch+var_8], eax
		test	ebx, ebx
		jz	short loc_1000386F
		cmp	ebx, ecx
		jz	short loc_10003866
		push	18h
		mov	ebp, ecx
		pop	esi

loc_1000384D:				; CODE XREF: sub_100037C3+99j
		push	0
		push	1
		mov	ecx, ebx
		call	sub_100022FA
		add	ebx, esi
		cmp	ebx, ebp
		jnz	short loc_1000384D
		mov	esi, [esp+1Ch+var_4]
		mov	ebp, [esp+1Ch+arg_0]

loc_10003866:				; CODE XREF: sub_100037C3+83j
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000386F:				; CODE XREF: sub_100037C3+7Fj
		imul	eax, ebp, 18h
		pop	ebx
		mov	[esi], edi
		add	eax, edi
		mov	[esi+8], eax
		imul	eax, [esp+18h+var_8], 18h
		add	eax, edi
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn	4
sub_100037C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000388D	proc near		; CODE XREF: sub_10003635+3Ap
					; sub_10003635+5Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh	; int
		push	eax		; int
		push	[esp+0Ch+arg_0]	; int
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100023C2
		mov	eax, esi
		pop	esi
		retn	4
sub_1000388D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100038B2	proc near		; CODE XREF: sub_10004437+63p
		cmp	ecx, 0D800h
		jb	short loc_100038CD
		cmp	ecx, 0E000h
		jb	short loc_100038CA
		cmp	ecx, 10FFFFh
		jbe	short loc_100038CD

loc_100038CA:				; CODE XREF: sub_100038B2+Ej
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100038CD:				; CODE XREF: sub_100038B2+6j
					; sub_100038B2+16j
		xor	eax, eax
		inc	eax
		retn
sub_100038B2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100038D1	proc near		; CODE XREF: sub_100034D9+71p

Dst		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		push	esi
		push	eax
		push	ecx
		mov	esi, ecx
		lea	ecx, [ebp+Dst]	; Dst
		push	offset asc_1001AA7C ; "\t\n\v"
		call	sub_10001C68
		mov	edx, eax
		mov	ecx, esi
		call	sub_100039C2
		pop	ecx
		pop	ecx
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		mov	esi, eax
		call	sub_100022FA
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100038D1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003920	proc near		; CODE XREF: sub_1000BF62+A1p

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000392A
		mov	edx, [ecx]
		jmp	short loc_1000392C
; ---------------------------------------------------------------------------

loc_1000392A:				; CODE XREF: sub_10003920+4j
		mov	edx, ecx

loc_1000392C:				; CODE XREF: sub_10003920+8j
		mov	eax, [ecx+10h]
		lea	ecx, [edx+eax*2]
		mov	eax, [esp+arg_0]
		mov	[eax], ecx
		retn	4
sub_10003920	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000393B	proc near		; CODE XREF: sub_1000E953+1D6p
					; sub_1000E953+1DFp ...
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi]
		test	edi, edi
		jz	short loc_10003972
		push	ebx
		mov	ebx, [esi+4]
		push	ebp
		xor	ebp, ebp
		jmp	short loc_1000395B
; ---------------------------------------------------------------------------

loc_1000394E:				; CODE XREF: sub_1000393B+22j
		push	ebp
		push	1
		mov	ecx, edi
		call	sub_100022FA
		add	edi, 18h

loc_1000395B:				; CODE XREF: sub_1000393B+11j
		cmp	edi, ebx
		jnz	short loc_1000394E
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	[esi], ebp
		mov	[esi+4], ebp
		mov	[esi+8], ebp
		pop	ebp
		pop	ebx

loc_10003972:				; CODE XREF: sub_1000393B+8j
		pop	edi
		pop	esi
		retn
sub_1000393B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10003975(void *Buf1, int, size_t Size, void *Buf2,	int)
sub_10003975	proc near		; CODE XREF: sub_10004A9A+19p
					; sub_10005383+11p ...

Size		= dword	ptr  0Ch
Buf2		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+Size]
		cmp	[ecx+10h], esi
		jnb	short loc_10003984
		mov	esi, [ecx+10h]

loc_10003984:				; CODE XREF: sub_10003975+Aj
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_1000398E
		mov	eax, [ebp+arg_C]

loc_1000398E:				; CODE XREF: sub_10003975+14j
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10003996
		mov	ecx, [ecx]

loc_10003996:				; CODE XREF: sub_10003975+1Dj
		test	eax, eax
		jz	short loc_100039AB
		push	eax		; Size
		push	[ebp+Buf2]	; Buf2
		push	ecx		; Buf1
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100039BD

loc_100039AB:				; CODE XREF: sub_10003975+23j
		cmp	esi, [ebp+arg_C]
		jnb	short loc_100039B5
		or	eax, 0FFFFFFFFh
		jmp	short loc_100039BD
; ---------------------------------------------------------------------------

loc_100039B5:				; CODE XREF: sub_10003975+39j
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_100039BD:				; CODE XREF: sub_10003975+34j
					; sub_10003975+3Ej
		pop	esi
		pop	ebp
		retn	10h
sub_10003975	endp


; =============== S U B	R O U T	I N E =======================================


sub_100039C2	proc near		; CODE XREF: sub_100038D1+29p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Dst		= byte ptr -20h
var_8		= dword	ptr -8
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		mov	eax, ecx
		push	ebx
		push	ebp
		push	esi
		mov	ebp, [eax+10h]
		mov	esi, edx
		push	edi
		mov	edi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_28], eax
		lea	ecx, [ebp-1]
		push	ecx
		mov	[esp+40h+var_24], ecx
		mov	ecx, eax
		push	esi
		call	sub_10003B65
		push	ecx
		mov	ecx, [esp+40h+var_28]
		mov	ebx, eax
		push	esi
		call	sub_10003BD0
		mov	esi, eax
		test	ebp, ebp
		jz	short loc_10003A50
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10003A4E
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10003A4E
		mov	ecx, [esp+3Ch+var_28] ;	int
		sub	eax, ebx
		inc	eax
		push	eax		; int
		push	ebx		; int
		lea	eax, [esp+44h+Dst]
		push	eax		; Dst
		call	sub_100035A2
		push	eax		; Src
		mov	ecx, edi
		call	sub_10003B23
		push	0
		push	1
		lea	ecx, [esp+44h+Dst]
		call	sub_100022FA
		sub	esi, [esp+3Ch+var_24]
		neg	esi
		sbb	esi, esi
		xor	eax, eax
		and	esi, 2
		test	ebx, ebx
		setnz	al
		or	eax, esi
		jmp	short loc_10003A6D
; ---------------------------------------------------------------------------

loc_10003A4E:				; CODE XREF: sub_100039C2+47j
					; sub_100039C2+4Cj
		test	ebp, ebp

loc_10003A50:				; CODE XREF: sub_100039C2+42j
		setz	cl
		and	dword ptr [edi+10h], 0
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003A5F
		mov	edi, [edi]

loc_10003A5F:				; CODE XREF: sub_100039C2+99j
		xor	eax, eax
		test	cl, cl
		mov	[edi], ax
		setnz	al
		dec	eax
		and	eax, 3

loc_10003A6D:				; CODE XREF: sub_100039C2+8Aj
		mov	ecx, [esp+3Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_100039C2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003A80	proc near		; CODE XREF: sub_10004368+29p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		mov	[esp+10h+var_4], ecx
		lea	edi, [ecx+edx*2]
		mov	ebx, esi
		mov	edx, ecx
		jmp	short loc_10003A9F
; ---------------------------------------------------------------------------

loc_10003A93:				; CODE XREF: sub_10003A80+22j
		cmp	edx, edi
		jz	short loc_10003AA4
		movzx	eax, word ptr [edx]
		or	ebx, eax
		add	edx, 2

loc_10003A9F:				; CODE XREF: sub_10003A80+11j
		test	dl, 3
		jnz	short loc_10003A93

loc_10003AA4:				; CODE XREF: sub_10003A80+15j
		mov	ecx, edi
		and	ecx, 0FFFFFFFCh
		mov	eax, ecx
		sub	eax, edx
		add	eax, 3
		shr	eax, 2
		cmp	ecx, edx
		push	ebp
		sbb	ecx, ecx
		mov	ebp, esi
		not	ecx
		and	ecx, eax
		jbe	short loc_10003ACA

loc_10003AC0:				; CODE XREF: sub_10003A80+48j
		or	ebx, [edx]
		add	edx, 4
		inc	ebp
		cmp	ebp, ecx
		jb	short loc_10003AC0

loc_10003ACA:				; CODE XREF: sub_10003A80+3Ej
		mov	eax, edi
		sub	eax, edx
		inc	eax
		shr	eax, 1
		cmp	edi, edx
		pop	ebp
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		jz	short loc_10003AE9

loc_10003ADC:				; CODE XREF: sub_10003A80+67j
		movzx	eax, word ptr [edx]
		lea	edx, [edx+2]
		or	ebx, eax
		inc	esi
		cmp	esi, ecx
		jnz	short loc_10003ADC

loc_10003AE9:				; CODE XREF: sub_10003A80+5Aj
		and	ebx, 0FF80FF80h
		neg	ebx
		pop	edi
		sbb	ebx, ebx
		pop	esi
		lea	eax, [ebx+1]
		pop	ebx
		pop	ecx
		retn
sub_10003A80	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003AFB	proc near		; CODE XREF: sub_10004257+26p
					; sub_10004257+CDp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_10003B15
		cmp	dword ptr [ecx+14h], 10h
		mov	[ecx+10h], eax
		jb	short loc_10003B0F
		mov	ecx, [ecx]

loc_10003B0F:				; CODE XREF: sub_10003AFB+10j
		mov	byte ptr [ecx+eax], 0
		jmp	short locret_10003B20
; ---------------------------------------------------------------------------

loc_10003B15:				; CODE XREF: sub_10003AFB+7j
		sub	eax, [ecx+10h]
		push	0		; int
		push	eax		; Size
		call	sub_10003055

locret_10003B20:			; CODE XREF: sub_10003AFB+18j
		retn	4
sub_10003AFB	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003B23(void *Src)
sub_10003B23	proc near		; CODE XREF: sub_100039C2+64p
					; sub_1000B390+80p ...

Src		= dword	ptr  4

		push	esi
		mov	esi, ecx
		cmp	esi, [esp+4+Src]
		jz	short loc_10003B40
		push	0
		push	1
		call	sub_100022FA
		push	[esp+4+Src]	; Src
		mov	ecx, esi
		call	sub_10003490

loc_10003B40:				; CODE XREF: sub_10003B23+7j
		mov	eax, esi
		pop	esi
		retn	4
sub_10003B23	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B46	proc near		; CODE XREF: sub_10006831+107p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_10003B57
		push	eax
		call	sub_100023AA
		jmp	short locret_10003B62
; ---------------------------------------------------------------------------

loc_10003B57:				; CODE XREF: sub_10003B46+7j
		sub	eax, [ecx+10h]
		push	0
		push	eax
		call	sub_100030B4

locret_10003B62:			; CODE XREF: sub_10003B46+Fj
		retn	4
sub_10003B46	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B65	proc near		; CODE XREF: sub_100039C2+2Cp

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+14h], 8
		mov	edi, ecx
		mov	edx, [ebx+10h]
		mov	[esp+10h+arg_0], edx
		jb	short loc_10003B7E
		mov	ebx, [ebx]

loc_10003B7E:				; CODE XREF: sub_10003B65+15j
		mov	eax, [edi+10h]
		test	eax, eax
		jz	short loc_10003BB6
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003B8D
		mov	ecx, [edi]

loc_10003B8D:				; CODE XREF: sub_10003B65+24j
		cmp	dword ptr [edi+14h], 8
		lea	ebp, [ecx+eax*2]
		jb	short loc_10003B9A
		mov	esi, [edi]
		jmp	short loc_10003BB2
; ---------------------------------------------------------------------------

loc_10003B9A:				; CODE XREF: sub_10003B65+2Fj
		mov	esi, edi
		jmp	short loc_10003BB2
; ---------------------------------------------------------------------------

loc_10003B9E:				; CODE XREF: sub_10003B65+4Fj
		push	esi
		mov	ecx, ebx
		call	sub_10003430
		pop	ecx
		test	eax, eax
		jz	short loc_10003BC2
		mov	edx, [esp+10h+arg_0]
		add	esi, 2

loc_10003BB2:				; CODE XREF: sub_10003B65+33j
					; sub_10003B65+37j
		cmp	esi, ebp
		jb	short loc_10003B9E

loc_10003BB6:				; CODE XREF: sub_10003B65+1Ej
		or	esi, 0FFFFFFFFh

loc_10003BB9:				; CODE XREF: sub_10003B65+69j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
; ---------------------------------------------------------------------------

loc_10003BC2:				; CODE XREF: sub_10003B65+44j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003BCA
		mov	edi, [edi]

loc_10003BCA:				; CODE XREF: sub_10003B65+61j
		sub	esi, edi
		sar	esi, 1
		jmp	short loc_10003BB9
sub_10003B65	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003BD0	proc near		; CODE XREF: sub_100039C2+39p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+14h], 8
		mov	edi, ecx
		mov	ebp, [ebx+10h]
		jb	short loc_10003BE5
		mov	ebx, [ebx]

loc_10003BE5:				; CODE XREF: sub_10003BD0+11j
		mov	eax, [edi+10h]
		test	eax, eax
		jz	short loc_10003C3A
		cmp	eax, 0FFFFFFFFh
		jbe	short loc_10003BF6
		or	ecx, 0FFFFFFFFh
		jmp	short loc_10003BF9
; ---------------------------------------------------------------------------

loc_10003BF6:				; CODE XREF: sub_10003BD0+1Fj
		lea	ecx, [eax-1]

loc_10003BF9:				; CODE XREF: sub_10003BD0+24j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C03
		mov	eax, [edi]
		jmp	short loc_10003C05
; ---------------------------------------------------------------------------

loc_10003C03:				; CODE XREF: sub_10003BD0+2Dj
		mov	eax, edi

loc_10003C05:				; CODE XREF: sub_10003BD0+31j
		lea	esi, [eax+ecx*2]
		jmp	short loc_10003C1D
; ---------------------------------------------------------------------------

loc_10003C0A:				; CODE XREF: sub_10003BD0+5Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C14
		mov	eax, [edi]
		jmp	short loc_10003C16
; ---------------------------------------------------------------------------

loc_10003C14:				; CODE XREF: sub_10003BD0+3Ej
		mov	eax, edi

loc_10003C16:				; CODE XREF: sub_10003BD0+42j
		cmp	esi, eax
		jz	short loc_10003C3A
		sub	esi, 2

loc_10003C1D:				; CODE XREF: sub_10003BD0+38j
		push	esi
		mov	edx, ebp
		mov	ecx, ebx
		call	sub_10003430
		pop	ecx
		test	eax, eax
		jnz	short loc_10003C0A
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C34
		mov	edi, [edi]

loc_10003C34:				; CODE XREF: sub_10003BD0+60j
		sub	esi, edi
		sar	esi, 1
		jmp	short loc_10003C3D
; ---------------------------------------------------------------------------

loc_10003C3A:				; CODE XREF: sub_10003BD0+1Aj
					; sub_10003BD0+48j
		or	esi, 0FFFFFFFFh

loc_10003C3D:				; CODE XREF: sub_10003BD0+68j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10003BD0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003C46	proc near		; CODE XREF: sub_10003F5F+32p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		cmp	[esi+10h], ebx
		jb	loc_10003EF5
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_C]
		mov	eax, [edi+10h]
		cmp	eax, ecx
		jb	loc_10003EF5
		mov	edx, [esp+10h+arg_4]
		push	ebp
		mov	ebp, [esi+10h]
		sub	ebp, ebx
		mov	[esp+14h+arg_0], ebp
		cmp	ebp, edx
		jnb	short loc_10003C84
		mov	edx, ebp
		mov	[esp+14h+arg_4], edx

loc_10003C84:				; CODE XREF: sub_10003C46+36j
		mov	ebp, [esp+14h+arg_10]
		sub	eax, ecx
		cmp	eax, ebp
		jnb	short loc_10003C90
		mov	ebp, eax

loc_10003C90:				; CODE XREF: sub_10003C46+46j
		mov	eax, [esi+10h]
		sub	eax, edx
		mov	[esp+14h+arg_10], eax
		or	eax, 0FFFFFFFFh
		sub	eax, ebp
		cmp	eax, [esp+14h+arg_10]
		ja	short loc_10003CAF
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003CAF:				; CODE XREF: sub_10003C46+5Cj
		mov	eax, [esp+14h+arg_10]
		sub	[esp+14h+arg_0], edx
		add	eax, ebp
		mov	[esp+14h+var_4], eax
		cmp	[esi+10h], eax
		jnb	short loc_10003CD4
		push	0
		push	eax
		mov	ecx, esi
		call	sub_10002447
		mov	ecx, [esp+14h+arg_C]
		mov	edx, [esp+14h+arg_4]

loc_10003CD4:				; CODE XREF: sub_10003C46+7Aj
		push	8
		cmp	esi, edi
		pop	edi
		jz	short loc_10003D3C
		cmp	[esi+14h], edi
		jb	short loc_10003CE8
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_10003CEC
; ---------------------------------------------------------------------------

loc_10003CE8:				; CODE XREF: sub_10003C46+98j
		mov	[esp+14h+arg_4], esi

loc_10003CEC:				; CODE XREF: sub_10003C46+A0j
		cmp	[esi+14h], edi
		jb	short loc_10003CF5
		mov	ecx, [esi]
		jmp	short loc_10003CF7
; ---------------------------------------------------------------------------

loc_10003CF5:				; CODE XREF: sub_10003C46+A9j
		mov	ecx, esi

loc_10003CF7:				; CODE XREF: sub_10003C46+ADj
		push	[esp+14h+arg_0]	; int
		lea	eax, [ebx+edx]
		mov	edx, [esp+18h+arg_4]
		lea	edx, [edx+eax*2] ; Src
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		mov	ecx, [esp+14h+arg_8]
		cmp	[ecx+14h], edi
		jb	short loc_10003D1C
		mov	ecx, [ecx]

loc_10003D1C:				; CODE XREF: sub_10003C46+D2j
		cmp	[esi+14h], edi
		jb	short loc_10003D25
		mov	edi, [esi]
		jmp	short loc_10003D27
; ---------------------------------------------------------------------------

loc_10003D25:				; CODE XREF: sub_10003C46+D9j
		mov	edi, esi

loc_10003D27:				; CODE XREF: sub_10003C46+DDj
		mov	eax, [esp+14h+arg_C]
		push	ebp		; int
		lea	edx, [ecx+eax*2] ; Src
		lea	ecx, [edi+ebx*2] ; Dst
		call	sub_10001AFC
		jmp	loc_10003EDF
; ---------------------------------------------------------------------------

loc_10003D3C:				; CODE XREF: sub_10003C46+93j
		cmp	ebp, edx
		ja	short loc_10003D8E
		cmp	[esi+14h], edi
		jb	short loc_10003D49
		mov	edx, [esi]
		jmp	short loc_10003D4B
; ---------------------------------------------------------------------------

loc_10003D49:				; CODE XREF: sub_10003C46+FDj
		mov	edx, esi

loc_10003D4B:				; CODE XREF: sub_10003C46+101j
		cmp	[esi+14h], edi
		jb	short loc_10003D54
		mov	eax, [esi]
		jmp	short loc_10003D56
; ---------------------------------------------------------------------------

loc_10003D54:				; CODE XREF: sub_10003C46+108j
		mov	eax, esi

loc_10003D56:				; CODE XREF: sub_10003C46+10Cj
		lea	edx, [edx+ecx*2] ; Src
		push	ebp		; int
		lea	ecx, [eax+ebx*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003D6C
		mov	edx, [esi]
		jmp	short loc_10003D6E
; ---------------------------------------------------------------------------

loc_10003D6C:				; CODE XREF: sub_10003C46+120j
		mov	edx, esi

loc_10003D6E:				; CODE XREF: sub_10003C46+124j
		cmp	[esi+14h], edi
		jb	short loc_10003D77
		mov	edi, [esi]
		jmp	short loc_10003D79
; ---------------------------------------------------------------------------

loc_10003D77:				; CODE XREF: sub_10003C46+12Bj
		mov	edi, esi

loc_10003D79:				; CODE XREF: sub_10003C46+12Fj
		mov	eax, [esp+14h+arg_4]
		push	[esp+14h+arg_0]
		add	eax, ebx
		lea	edx, [edx+eax*2]
		lea	eax, [ebx+ebp]
		jmp	loc_10003ED7
; ---------------------------------------------------------------------------

loc_10003D8E:				; CODE XREF: sub_10003C46+F8j
		cmp	ecx, ebx
		ja	short loc_10003DEE
		cmp	[esi+14h], edi
		jb	short loc_10003D9F
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_10003DA3
; ---------------------------------------------------------------------------

loc_10003D9F:				; CODE XREF: sub_10003C46+14Fj
		mov	[esp+14h+arg_4], esi

loc_10003DA3:				; CODE XREF: sub_10003C46+157j
		cmp	[esi+14h], edi
		jb	short loc_10003DAC
		mov	ecx, [esi]
		jmp	short loc_10003DAE
; ---------------------------------------------------------------------------

loc_10003DAC:				; CODE XREF: sub_10003C46+160j
		mov	ecx, esi

loc_10003DAE:				; CODE XREF: sub_10003C46+164j
		push	[esp+14h+arg_0]	; int
		lea	eax, [ebx+edx]
		mov	edx, [esp+18h+arg_4]
		lea	edx, [edx+eax*2] ; Src
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003DD1
		mov	edx, [esi]
		jmp	short loc_10003DD3
; ---------------------------------------------------------------------------

loc_10003DD1:				; CODE XREF: sub_10003C46+185j
		mov	edx, esi

loc_10003DD3:				; CODE XREF: sub_10003C46+189j
		cmp	[esi+14h], edi
		jb	short loc_10003DDC
		mov	ecx, [esi]
		jmp	short loc_10003DDE
; ---------------------------------------------------------------------------

loc_10003DDC:				; CODE XREF: sub_10003C46+190j
		mov	ecx, esi

loc_10003DDE:				; CODE XREF: sub_10003C46+194j
		mov	eax, [esp+14h+arg_C]
		lea	ecx, [ecx+ebx*2]
		push	ebp
		lea	edx, [edx+eax*2]
		jmp	loc_10003EDA
; ---------------------------------------------------------------------------

loc_10003DEE:				; CODE XREF: sub_10003C46+14Aj
		lea	eax, [ebx+edx]
		mov	[esp+14h+arg_10], eax
		cmp	eax, ecx
		ja	short loc_10003E52
		cmp	[esi+14h], edi
		jb	short loc_10003E02
		mov	eax, [esi]
		jmp	short loc_10003E04
; ---------------------------------------------------------------------------

loc_10003E02:				; CODE XREF: sub_10003C46+1B6j
		mov	eax, esi

loc_10003E04:				; CODE XREF: sub_10003C46+1BAj
		cmp	[esi+14h], edi
		jb	short loc_10003E0D
		mov	ecx, [esi]
		jmp	short loc_10003E0F
; ---------------------------------------------------------------------------

loc_10003E0D:				; CODE XREF: sub_10003C46+1C1j
		mov	ecx, esi

loc_10003E0F:				; CODE XREF: sub_10003C46+1C5j
		mov	edx, [esp+14h+arg_10]
		push	[esp+14h+arg_0]	; int
		lea	edx, [eax+edx*2] ; Src
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003E2F
		mov	edx, [esi]
		jmp	short loc_10003E31
; ---------------------------------------------------------------------------

loc_10003E2F:				; CODE XREF: sub_10003C46+1E3j
		mov	edx, esi

loc_10003E31:				; CODE XREF: sub_10003C46+1E7j
		cmp	[esi+14h], edi
		jb	short loc_10003E3A
		mov	edi, [esi]
		jmp	short loc_10003E3C
; ---------------------------------------------------------------------------

loc_10003E3A:				; CODE XREF: sub_10003C46+1EEj
		mov	edi, esi

loc_10003E3C:				; CODE XREF: sub_10003C46+1F2j
		mov	eax, [esp+14h+arg_C]
		lea	ecx, [edi+ebx*2]
		sub	eax, [esp+14h+arg_4]
		add	eax, ebp
		push	ebp
		lea	edx, [edx+eax*2]
		jmp	loc_10003EDA
; ---------------------------------------------------------------------------

loc_10003E52:				; CODE XREF: sub_10003C46+1B1j
		cmp	[esi+14h], edi
		jb	short loc_10003E5F
		mov	eax, [esi]
		mov	[esp+14h+arg_8], eax
		jmp	short loc_10003E63
; ---------------------------------------------------------------------------

loc_10003E5F:				; CODE XREF: sub_10003C46+20Fj
		mov	[esp+14h+arg_8], esi

loc_10003E63:				; CODE XREF: sub_10003C46+217j
		cmp	[esi+14h], edi
		jb	short loc_10003E6C
		mov	eax, [esi]
		jmp	short loc_10003E6E
; ---------------------------------------------------------------------------

loc_10003E6C:				; CODE XREF: sub_10003C46+220j
		mov	eax, esi

loc_10003E6E:				; CODE XREF: sub_10003C46+224j
		push	edx		; int
		mov	edx, [esp+18h+arg_8]
		lea	edx, [edx+ecx*2] ; Src
		lea	ecx, [eax+ebx*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003E88
		mov	eax, [esi]
		jmp	short loc_10003E8A
; ---------------------------------------------------------------------------

loc_10003E88:				; CODE XREF: sub_10003C46+23Cj
		mov	eax, esi

loc_10003E8A:				; CODE XREF: sub_10003C46+240j
		cmp	[esi+14h], edi
		jb	short loc_10003E93
		mov	ecx, [esi]
		jmp	short loc_10003E95
; ---------------------------------------------------------------------------

loc_10003E93:				; CODE XREF: sub_10003C46+247j
		mov	ecx, esi

loc_10003E95:				; CODE XREF: sub_10003C46+24Bj
		mov	edx, [esp+14h+arg_10]
		push	[esp+14h+arg_0]	; int
		lea	edx, [eax+edx*2] ; Src
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003EB5
		mov	edx, [esi]
		jmp	short loc_10003EB7
; ---------------------------------------------------------------------------

loc_10003EB5:				; CODE XREF: sub_10003C46+269j
		mov	edx, esi

loc_10003EB7:				; CODE XREF: sub_10003C46+26Dj
		cmp	[esi+14h], edi
		jb	short loc_10003EC0
		mov	edi, [esi]
		jmp	short loc_10003EC2
; ---------------------------------------------------------------------------

loc_10003EC0:				; CODE XREF: sub_10003C46+274j
		mov	edi, esi

loc_10003EC2:				; CODE XREF: sub_10003C46+278j
		mov	ecx, [esp+14h+arg_4]
		mov	eax, ebp
		sub	eax, ecx
		push	eax		; int
		mov	eax, [esp+18h+arg_C]
		add	eax, ebp
		lea	edx, [edx+eax*2] ; Src
		lea	eax, [ebx+ecx]

loc_10003ED7:				; CODE XREF: sub_10003C46+143j
		lea	ecx, [edi+eax*2] ; Dst

loc_10003EDA:				; CODE XREF: sub_10003C46+1A3j
					; sub_10003C46+207j
		call	sub_10001B16

loc_10003EDF:				; CODE XREF: sub_10003C46+F1j
		pop	ecx
		push	[esp+14h+var_4]
		mov	ecx, esi
		call	sub_100023AA
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		retn	14h
; ---------------------------------------------------------------------------

loc_10003EF5:				; CODE XREF: sub_10003C46+Dj
					; sub_10003C46+20j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_10003C46	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003F01	proc near		; CODE XREF: sub_10008B78+A9p
					; sub_1000B9F0+3Dp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		mov	eax, [ecx+10h]
		mov	edx, [ebp+arg_0]
		cmp	eax, edx
		jnb	short loc_10003F19
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003F19:				; CODE XREF: sub_10003F01+Bj
		push	esi
		mov	esi, [ebp+arg_4]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_10003F25
		mov	esi, eax

loc_10003F25:				; CODE XREF: sub_10003F01+20j
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_10003F2F
		mov	eax, [ebp+arg_C]

loc_10003F2F:				; CODE XREF: sub_10003F01+29j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10003F37
		mov	ecx, [ecx]

loc_10003F37:				; CODE XREF: sub_10003F01+32j
		lea	ecx, [ecx+edx*2]
		mov	edx, [ebp+arg_8]
		push	eax
		call	sub_10003404
		pop	ecx
		test	eax, eax
		jnz	short loc_10003F5A
		cmp	esi, [ebp+arg_C]
		jnb	short loc_10003F52
		or	eax, 0FFFFFFFFh
		jmp	short loc_10003F5A
; ---------------------------------------------------------------------------

loc_10003F52:				; CODE XREF: sub_10003F01+4Aj
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_10003F5A:				; CODE XREF: sub_10003F01+45j
					; sub_10003F01+4Fj
		pop	esi
		pop	ebp
		retn	10h
sub_10003F01	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003F5F(int, int, void *Src, int)
sub_10003F5F	proc near		; CODE XREF: sub_1000B9F0+87p
					; sub_1000E953+154p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+Src]
		push	esi
		push	ebx
		mov	esi, ecx
		call	sub_100024AE
		test	al, al
		jz	short loc_10003F9B
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003F7B
		mov	eax, [esi]
		jmp	short loc_10003F7D
; ---------------------------------------------------------------------------

loc_10003F7B:				; CODE XREF: sub_10003F5F+16j
		mov	eax, esi

loc_10003F7D:				; CODE XREF: sub_10003F5F+1Aj
		push	[esp+8+arg_C]
		sub	ebx, eax
		mov	ecx, esi
		sar	ebx, 1
		push	ebx
		push	esi
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_0]
		call	sub_10003C46
		jmp	loc_100040C0
; ---------------------------------------------------------------------------

loc_10003F9B:				; CODE XREF: sub_10003F5F+10j
		mov	ecx, [esi+10h]
		mov	edx, [esp+8+arg_0]
		cmp	ecx, edx
		jnb	short loc_10003FB1
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003FB1:				; CODE XREF: sub_10003F5F+45j
		push	ebp
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+10h+arg_4]
		sub	ebp, edx
		cmp	ebp, edi
		jnb	short loc_10003FC1
		mov	edi, ebp

loc_10003FC1:				; CODE XREF: sub_10003F5F+5Ej
		or	eax, 0FFFFFFFFh
		sub	ecx, edi
		sub	eax, [esp+10h+arg_C]
		cmp	eax, ecx
		ja	short loc_10003FD9
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003FD9:				; CODE XREF: sub_10003F5F+6Dj
		mov	ecx, [esp+10h+arg_C]
		sub	ebp, edi
		cmp	ecx, edi
		jnb	short loc_10004029
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003FF1
		mov	eax, [esi]
		mov	[esp+10h+arg_4], eax
		jmp	short loc_10003FF5
; ---------------------------------------------------------------------------

loc_10003FF1:				; CODE XREF: sub_10003F5F+88j
		mov	[esp+10h+arg_4], esi

loc_10003FF5:				; CODE XREF: sub_10003F5F+90j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004003
		mov	eax, [esi]
		mov	[esp+10h+Src], eax
		jmp	short loc_10004007
; ---------------------------------------------------------------------------

loc_10004003:				; CODE XREF: sub_10003F5F+9Aj
		mov	[esp+10h+Src], esi

loc_10004007:				; CODE XREF: sub_10003F5F+A2j
		lea	eax, [edx+edi]
		mov	edx, [esp+10h+arg_4]
		push	ebp		; int
		lea	edx, [edx+eax*2] ; Src
		mov	eax, [esp+14h+arg_0]
		add	eax, ecx
		mov	ecx, [esp+14h+Src]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		mov	ecx, [esp+10h+arg_C]

loc_10004029:				; CODE XREF: sub_10003F5F+82j
		test	ecx, ecx
		jnz	short loc_10004035
		test	edi, edi
		jz	loc_100040BC

loc_10004035:				; CODE XREF: sub_10003F5F+CCj
		mov	eax, [esi+10h]
		sub	eax, edi
		add	eax, ecx
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+Src], eax
		call	sub_10002447
		test	al, al
		jz	short loc_100040BC
		mov	ecx, [esp+10h+arg_C]
		cmp	edi, ecx
		jnb	short loc_10004095
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004060
		mov	edx, [esi]
		jmp	short loc_10004062
; ---------------------------------------------------------------------------

loc_10004060:				; CODE XREF: sub_10003F5F+FBj
		mov	edx, esi

loc_10004062:				; CODE XREF: sub_10003F5F+FFj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004070
		mov	eax, [esi]
		mov	[esp+10h+arg_4], eax
		jmp	short loc_10004074
; ---------------------------------------------------------------------------

loc_10004070:				; CODE XREF: sub_10003F5F+107j
		mov	[esp+10h+arg_4], esi

loc_10004074:				; CODE XREF: sub_10003F5F+10Fj
		push	ebp		; int
		mov	ebp, [esp+14h+arg_0]
		lea	eax, [edi+ebp]
		lea	edx, [edx+eax*2] ; Src
		lea	eax, [ecx+ebp]
		mov	ecx, [esp+14h+arg_4]
		lea	ecx, [ecx+eax*2] ; Dst
		call	sub_10001B16
		pop	ecx
		mov	ecx, [esp+10h+arg_C]
		jmp	short loc_10004099
; ---------------------------------------------------------------------------

loc_10004095:				; CODE XREF: sub_10003F5F+F5j
		mov	ebp, [esp+10h+arg_0]

loc_10004099:				; CODE XREF: sub_10003F5F+134j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100040A3
		mov	eax, [esi]
		jmp	short loc_100040A5
; ---------------------------------------------------------------------------

loc_100040A3:				; CODE XREF: sub_10003F5F+13Ej
		mov	eax, esi

loc_100040A5:				; CODE XREF: sub_10003F5F+142j
		push	ecx		; int
		lea	ecx, [eax+ebp*2] ; Dst
		mov	edx, ebx	; Src
		call	sub_10001AFC
		pop	ecx
		push	[esp+10h+Src]
		mov	ecx, esi
		call	sub_100023AA

loc_100040BC:				; CODE XREF: sub_10003F5F+D0j
					; sub_10003F5F+EDj
		pop	edi
		mov	eax, esi
		pop	ebp

loc_100040C0:				; CODE XREF: sub_10003F5F+37j
		pop	esi
		pop	ebx
		retn	10h
sub_10003F5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100040C5@<eax>(wchar_t *DstBuf@<ecx>, size_t MaxCount@<edx>, wchar_t *Format, va_list ArgList)
sub_100040C5	proc near		; CODE XREF: sub_10004130+CBp

var_4		= dword	ptr -4
Format		= dword	ptr  8
ArgList		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		push	edi
		push	[ebp+ArgList]	; ArgList
		mov	esi, edx
		mov	edi, ecx
		push	[ebp+Format]	; Format
		push	esi		; MaxCount
		push	edi		; DstBuf
		call	ds:_vswprintf_p
		add	esp, 10h
		test	eax, eax
		jns	short loc_10004100
		test	esi, esi
		jz	short loc_100040F2
		xor	eax, eax
		mov	[edi], ax

loc_100040F2:				; CODE XREF: sub_100040C5+26j
		push	[ebp+ArgList]	; ArgList
		push	[ebp+Format]	; Format
		call	ds:_vscwprintf_p
		pop	ecx
		pop	ecx

loc_10004100:				; CODE XREF: sub_100040C5+22j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100040C5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004106	proc near		; CODE XREF: sub_1001719D+7Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		xor	eax, eax
		mov	ecx, esi
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		lea	eax, [esp+4+arg_8]
		mov	edx, [esp+4+arg_4]
		push	eax
		call	sub_10004130
		pop	ecx
		mov	eax, esi
		pop	esi
		retn
sub_10004106	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004130	proc near		; CODE XREF: sub_10004106+20p

var_818		= dword	ptr -818h
var_814		= dword	ptr -814h
var_810		= dword	ptr -810h
var_80C		= dword	ptr -80Ch
DstBuf		= word ptr -808h
var_4		= dword	ptr -4
ArgList		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 81Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+81Ch+var_4], eax
		mov	eax, [ebp+ArgList]
		and	[esp+81Ch+var_818], 0
		push	ebx
		push	esi
		push	edi
		push	eax		; ArgList
		mov	edi, edx
		mov	[esp+82Ch+var_814], eax
		push	edi		; Format
		lea	eax, [esp+830h+DstBuf]
		mov	[esp+830h+var_80C], edi
		mov	ebx, ecx
		push	400h		; MaxCount
		push	eax		; DstBuf
		mov	[esp+838h+var_810], ebx
		call	ds:_vswprintf_p
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jns	short loc_1000419E
		push	[esp+828h+var_814] ; ArgList
		xor	eax, eax
		push	edi		; Format
		mov	[esp+830h+DstBuf], ax
		call	ds:_vscwprintf_p
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		js	loc_10004242

loc_1000419E:				; CODE XREF: sub_10004130+4Ej
		cmp	esi, 400h
		jge	short loc_100041B8
		push	esi		; int
		lea	eax, [esp+82Ch+DstBuf]
		mov	ecx, ebx
		push	eax		; Src
		call	sub_10003375
		jmp	loc_10004242
; ---------------------------------------------------------------------------

loc_100041B8:				; CODE XREF: sub_10004130+74j
					; sub_10004130+ECj
		inc	esi
		mov	[esp+828h+var_818], esi
		cmp	esi, 2000000h
		jg	short loc_10004242
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_100041F2
		cmp	esi, 7FFFFFFFh
		ja	short loc_10004220
		push	esi
		call	sub_10002640
		mov	ebx, eax
		test	esi, esi
		jz	short loc_100041F2
		xor	eax, eax
		mov	ecx, esi
		shr	ecx, 1
		mov	edi, ebx
		rep stosd
		adc	ecx, ecx
		rep stosw
		mov	edi, [esp+828h+var_80C]

loc_100041F2:				; CODE XREF: sub_10004130+99j
					; sub_10004130+ADj
		push	[esp+828h+var_814] ; ArgList
		mov	edx, esi	; MaxCount
		mov	ecx, ebx	; DstBuf
		push	edi		; Format
		call	sub_100040C5
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		js	short loc_1000420E
		cmp	esi, [esp+828h+var_818]
		jl	short loc_1000422B

loc_1000420E:				; CODE XREF: sub_10004130+D6j
		test	ebx, ebx
		jz	short loc_1000421A
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000421A:				; CODE XREF: sub_10004130+E0j
		test	esi, esi
		jns	short loc_100041B8
		jmp	short loc_10004242
; ---------------------------------------------------------------------------

loc_10004220:				; CODE XREF: sub_10004130+A1j
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000422B:				; CODE XREF: sub_10004130+DCj
		mov	ecx, [esp+828h+var_810]
		push	esi		; int
		push	ebx		; Src
		call	sub_10003375
		test	ebx, ebx
		jz	short loc_10004242
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10004242:				; CODE XREF: sub_10004130+68j
					; sub_10004130+83j ...
		mov	ecx, [esp+828h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10004130	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004257	proc near		; CODE XREF: sub_10004437+72p
					; sub_10004437+86p
		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, edx
		mov	ecx, esi
		cmp	ebx, 7Fh
		ja	short loc_10004272
		push	ebx
		call	sub_10002F4F
		xor	eax, eax
		inc	eax
		jmp	loc_1000432F
; ---------------------------------------------------------------------------

loc_10004272:				; CODE XREF: sub_10004257+Bj
		push	ebp
		push	edi
		mov	edi, [esi+10h]
		mov	ebp, edi
		lea	eax, [edi+4]
		push	eax
		call	sub_10003AFB
		cmp	ebx, 7FFh
		ja	short loc_1000429F
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004294
		mov	ecx, [esi]
		jmp	short loc_10004296
; ---------------------------------------------------------------------------

loc_10004294:				; CODE XREF: sub_10004257+37j
		mov	ecx, esi

loc_10004296:				; CODE XREF: sub_10004257+3Bj
		mov	eax, ebx
		shr	eax, 6
		or	al, 0C0h
		jmp	short loc_10004307
; ---------------------------------------------------------------------------

loc_1000429F:				; CODE XREF: sub_10004257+31j
		cmp	ebx, 0FFFFh
		ja	short loc_100042C0
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042B1
		mov	ecx, [esi]
		jmp	short loc_100042B3
; ---------------------------------------------------------------------------

loc_100042B1:				; CODE XREF: sub_10004257+54j
		mov	ecx, esi

loc_100042B3:				; CODE XREF: sub_10004257+58j
		mov	eax, ebx
		shr	eax, 0Ch
		or	al, 0E0h
		mov	[ecx+edi], al
		inc	edi
		jmp	short loc_100042F2
; ---------------------------------------------------------------------------

loc_100042C0:				; CODE XREF: sub_10004257+4Ej
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042CA
		mov	ecx, [esi]
		jmp	short loc_100042CC
; ---------------------------------------------------------------------------

loc_100042CA:				; CODE XREF: sub_10004257+6Dj
		mov	ecx, esi

loc_100042CC:				; CODE XREF: sub_10004257+71j
		mov	eax, ebx
		shr	eax, 12h
		or	al, 0F0h
		mov	[ecx+edi], al
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042E0
		mov	ecx, [esi]
		jmp	short loc_100042E2
; ---------------------------------------------------------------------------

loc_100042E0:				; CODE XREF: sub_10004257+83j
		mov	ecx, esi

loc_100042E2:				; CODE XREF: sub_10004257+87j
		mov	eax, ebx
		shr	eax, 0Ch
		and	al, 3Fh
		or	al, 80h
		mov	[ecx+edi+1], al
		add	edi, 2

loc_100042F2:				; CODE XREF: sub_10004257+67j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042FC
		mov	ecx, [esi]
		jmp	short loc_100042FE
; ---------------------------------------------------------------------------

loc_100042FC:				; CODE XREF: sub_10004257+9Fj
		mov	ecx, esi

loc_100042FE:				; CODE XREF: sub_10004257+A3j
		mov	eax, ebx
		shr	eax, 6
		and	al, 3Fh
		or	al, 80h

loc_10004307:				; CODE XREF: sub_10004257+46j
		mov	[ecx+edi], al
		inc	edi
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004315
		mov	eax, [esi]
		jmp	short loc_10004317
; ---------------------------------------------------------------------------

loc_10004315:				; CODE XREF: sub_10004257+B8j
		mov	eax, esi

loc_10004317:				; CODE XREF: sub_10004257+BCj
		and	bl, 3Fh
		mov	ecx, esi
		or	bl, 80h
		mov	[eax+edi], bl
		inc	edi
		push	edi
		call	sub_10003AFB
		sub	edi, ebp
		mov	eax, edi
		pop	edi
		pop	ebp

loc_1000432F:				; CODE XREF: sub_10004257+16j
		pop	esi
		pop	ebx
		retn
sub_10004257	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004332	proc near		; CODE XREF: sub_10004368+76p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		and	dword ptr [ecx+10h], 0
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10004347
		mov	eax, [ecx]
		jmp	short loc_10004349
; ---------------------------------------------------------------------------

loc_10004347:				; CODE XREF: sub_10004332+Fj
		mov	eax, ecx

loc_10004349:				; CODE XREF: sub_10004332+13j
		mov	byte ptr [eax],	0
		test	edx, edx
		jz	short loc_10004366
		mov	eax, 80h
		cmp	[esi], ax
		jnb	short loc_1000435D
		push	edx
		jmp	short loc_10004361
; ---------------------------------------------------------------------------

loc_1000435D:				; CODE XREF: sub_10004332+26j
		imul	eax, edx, 3
		push	eax

loc_10004361:				; CODE XREF: sub_10004332+29j
		call	sub_100031E7

loc_10004366:				; CODE XREF: sub_10004332+1Cj
		pop	esi
		retn
sub_10004332	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004368	proc near		; CODE XREF: sub_10001BEE+21p
					; sub_100029E7+2Bp ...

Src		= byte ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		push	edi
		mov	edi, ecx
		mov	ebx, [esi+14h]
		mov	ebp, [esi+10h]
		cmp	ebx, 8
		jb	short loc_1000438D
		mov	ecx, [esi]
		jmp	short loc_1000438F
; ---------------------------------------------------------------------------

loc_1000438D:				; CODE XREF: sub_10004368+1Fj
		mov	ecx, esi

loc_1000438F:				; CODE XREF: sub_10004368+23j
		mov	edx, ebp
		call	sub_10003A80
		test	al, al
		jz	short loc_100043BA
		cmp	ebx, 8
		jb	short loc_100043A3
		mov	eax, [esi]
		jmp	short loc_100043A5
; ---------------------------------------------------------------------------

loc_100043A3:				; CODE XREF: sub_10004368+35j
		mov	eax, esi

loc_100043A5:				; CODE XREF: sub_10004368+39j
		cmp	ebx, 8
		jb	short loc_100043AC
		mov	esi, [esi]

loc_100043AC:				; CODE XREF: sub_10004368+40j
		lea	ecx, [eax+ebp*2]
		push	ecx
		push	esi
		mov	ecx, edi
		call	sub_100044D9
		jmp	short loc_10004422
; ---------------------------------------------------------------------------

loc_100043BA:				; CODE XREF: sub_10004368+30j
		and	[esp+34h+var_10], 0
		mov	[esp+34h+var_C], 0Fh
		mov	[esp+34h+Src], 0
		cmp	ebx, 8
		jb	short loc_100043D5
		mov	ecx, [esi]
		jmp	short loc_100043D7
; ---------------------------------------------------------------------------

loc_100043D5:				; CODE XREF: sub_10004368+67j
		mov	ecx, esi

loc_100043D7:				; CODE XREF: sub_10004368+6Bj
		lea	eax, [esp+34h+Src]
		mov	edx, ebp
		push	eax
		call	sub_10004332
		cmp	dword ptr [esi+14h], 8
		mov	edx, [esi+10h]
		pop	ecx
		jb	short loc_100043EF
		mov	esi, [esi]

loc_100043EF:				; CODE XREF: sub_10004368+83j
		lea	eax, [esp+34h+Src]
		mov	ecx, esi
		push	eax
		call	sub_10004437
		pop	ecx
		xor	ebx, ebx
		mov	dword ptr [edi+14h], 0Fh
		lea	eax, [esp+34h+Src]
		mov	[edi+10h], ebx
		push	eax		; Src
		mov	ecx, edi
		mov	[edi], bl
		call	sub_100022B3
		push	ebx		; Size
		push	1		; char
		lea	ecx, [esp+3Ch+Src]
		call	sub_10001883

loc_10004422:				; CODE XREF: sub_10004368+50j
		mov	ecx, [esp+34h+var_8]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_10004368	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004437	proc near		; CODE XREF: sub_10004368+8Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebp
		xor	eax, eax
		mov	ebp, edx
		push	esi
		inc	eax
		mov	edx, ecx
		xor	esi, esi
		mov	[esp+10h+var_4], edx
		mov	[esp+10h+var_8], eax
		test	ebp, ebp
		jle	loc_100044D4
		push	ebx
		push	edi
		mov	edi, eax

loc_10004458:				; CODE XREF: sub_10004437+99j
		movzx	ecx, word ptr [edx+esi*2]
		mov	ebx, ecx
		mov	eax, ebx
		and	eax, 0FFFFF800h
		cmp	eax, 0D800h
		jnz	short loc_10004498
		test	ecx, 400h
		jnz	short loc_100044B4
		cmp	edi, ebp
		jge	short loc_100044B4
		movzx	ecx, word ptr [edx+esi*2+2]
		mov	eax, ecx
		and	eax, 0FFFFFC00h
		cmp	eax, 0DC00h
		jnz	short loc_100044B4
		shl	ebx, 0Ah
		add	ebx, 0FCA02400h
		add	ebx, ecx
		inc	esi
		inc	edi

loc_10004498:				; CODE XREF: sub_10004437+33j
		mov	ecx, ebx
		call	sub_100038B2
		test	al, al
		jz	short loc_100044B4
		mov	edx, [esp+18h+arg_0]
		mov	ecx, ebx
		call	sub_10004257
		mov	eax, [esp+18h+var_8]
		jmp	short loc_100044C8
; ---------------------------------------------------------------------------

loc_100044B4:				; CODE XREF: sub_10004437+3Bj
					; sub_10004437+3Fj ...
		mov	edx, [esp+18h+arg_0]
		mov	ecx, 0FFFDh
		call	sub_10004257
		xor	al, al
		mov	[esp+18h+var_8], eax

loc_100044C8:				; CODE XREF: sub_10004437+7Bj
		mov	edx, [esp+18h+var_4]
		inc	esi
		inc	edi
		cmp	esi, ebp
		jl	short loc_10004458
		pop	edi
		pop	ebx

loc_100044D4:				; CODE XREF: sub_10004437+17j
		pop	esi
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_10004437	endp


; =============== S U B	R O U T	I N E =======================================


sub_100044D9	proc near		; CODE XREF: sub_10004368+4Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		xor	eax, eax
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, ecx
		sub	esi, ebx
		mov	[edi+10h], eax
		mov	dword ptr [edi+14h], 0Fh
		mov	[edi], al
		mov	eax, esi
		sar	eax, 1
		push	eax
		call	sub_100031E7
		lea	eax, [esi+1]
		shr	eax, 1
		cmp	[esp+10h+arg_4], ebx
		sbb	ebp, ebp
		not	ebp
		and	ebp, eax
		jz	short loc_10004529
		xor	esi, esi

loc_10004514:				; CODE XREF: sub_100044D9+4Ej
		movzx	eax, byte ptr [ebx]
		mov	ecx, edi
		push	eax		; int
		push	1		; Size
		call	sub_10003055
		inc	esi
		lea	ebx, [ebx+2]
		cmp	esi, ebp
		jnz	short loc_10004514

loc_10004529:				; CODE XREF: sub_100044D9+37j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_100044D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004532	proc near		; CODE XREF: sub_1000457F+6Ap

Arguments	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	18h
		push	offset stru_1002DC78
		call	__SEH_prolog4
		mov	[ebp+Arguments], 1000h
		mov	[ebp+var_24], offset aBrokerevent ; "BrokerEvent"
		mov	[ebp+var_20], ecx
		xor	ecx, ecx
		mov	[ebp+var_1C], ecx
		mov	[ebp+ms_exc.registration.TryLevel], ecx
		lea	eax, [ebp+Arguments]
		push	eax		; lpArguments
		push	4		; nNumberOfArguments
		push	ecx		; dwExceptionFlags
		push	406D1388h	; dwExceptionCode
		call	ds:RaiseException
		jmp	short loc_10004572
; ---------------------------------------------------------------------------

loc_1000456B:				; DATA XREF: .rdata:stru_1002DC78o
		or	eax, 0FFFFFFFFh	; Exception filter 0 for function 10004532
		retn
; ---------------------------------------------------------------------------

loc_1000456F:				; DATA XREF: .rdata:stru_1002DC78o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10004532

loc_10004572:				; CODE XREF: sub_10004532+37j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_10004532	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000457F	proc near		; CODE XREF: StartAddress+20p

Dst		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		call	ds:GetCurrentThreadId
		push	ecx		; int
		push	eax		; int
		call	sub_100047B4
		mov	ecx, eax	; lpCriticalSection
		call	sub_10004805
		push	0Ch		; Size
		mov	edi, offset aBrokerevent ; "BrokerEvent"
		push	edi		; Buf2
		push	edi		; Buf1
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100045CE
		push	edi		; Src
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_100017BF
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+Dst]
		call	sub_10001883

loc_100045CE:				; CODE XREF: sub_1000457F+38j
		call	ds:IsDebuggerPresent
		test	eax, eax
		jnz	short loc_100045E1
		call	sub_10002E78
		test	al, al
		jz	short loc_100045EE

loc_100045E1:				; CODE XREF: sub_1000457F+57j
		call	ds:GetCurrentThreadId
		mov	ecx, eax
		call	sub_10004532

loc_100045EE:				; CODE XREF: sub_1000457F+60j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000457F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100045FD	proc near		; CODE XREF: sub_1000616A+41p
					; sub_100061FE+2Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	[edi], esi
		jz	short loc_1000462E
		call	sub_10004633
		test	esi, esi
		jz	short loc_1000462E
		cmp	esi, 0FFFFFFFFh
		jz	short loc_1000462E
		mov	[edi], esi
		call	sub_10002F4B
		push	eax
		push	dword ptr [esp+0Ch]
		mov	edx, edi
		mov	ecx, esi
		call	sub_10005952
		pop	ecx
		pop	ecx

loc_1000462E:				; CODE XREF: sub_100045FD+Aj
					; sub_100045FD+13j ...
		pop	edi
		pop	esi
		retn	4
sub_100045FD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004633	proc near		; CODE XREF: sub_100045FD+Cp
					; sub_100061B8+5p ...
		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	ecx, [ebx]
		test	ecx, ecx
		jz	short loc_10004684
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10004684
		push	ecx
		push	ecx
		mov	edx, ebx
		call	sub_10005A18
		mov	edi, [ebx]
		pop	ecx
		pop	ecx
		call	sub_10005AF6
		mov	esi, eax
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, edi	; hObject
		mov	byte_10031CB8, 1
		call	sub_10005908
		push	esi		; lpCriticalSection
		mov	byte_10031CB8, 0
		call	ds:LeaveCriticalSection
		and	dword ptr [ebx], 0

loc_10004684:				; CODE XREF: sub_10004633+10j
					; sub_10004633+15j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10004633	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000468B(LPCRITICAL_SECTION lpCriticalSection)
sub_1000468B	proc near		; CODE XREF: sub_100047B4+2Fp

Buf1		= byte ptr -1Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, ecx
		push	7D0h		; dwSpinCount
		push	esi		; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		lea	ebx, [esi+18h]
		xor	ebp, ebp
		push	2Ch
		mov	[ebx], ebp
		mov	[ebx+4], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_100046CA

loc_100046C4:				; CODE XREF: sub_1000468B+68j
					; sub_1000468B+94j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100046CA:				; CODE XREF: sub_1000468B+37j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_100046D5
		mov	[ecx], eax

loc_100046D5:				; CODE XREF: sub_1000468B+46j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_100046DE
		mov	[ecx], eax

loc_100046DE:				; CODE XREF: sub_1000468B+4Fj
		mov	word ptr [eax+0Ch], 101h
		mov	[ebx], eax
		push	18h
		mov	[esi+20h], ebp
		mov	[esi+24h], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100046C4
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10004700
		mov	[ecx], eax

loc_10004700:				; CODE XREF: sub_1000468B+71j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10004709
		mov	[ecx], eax

loc_10004709:				; CODE XREF: sub_1000468B+7Aj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+20h], eax
		push	18h
		mov	[esi+28h], ebp
		mov	[esi+2Ch], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100046C4
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000472C
		mov	[ecx], eax

loc_1000472C:				; CODE XREF: sub_1000468B+9Dj
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10004735
		mov	[ecx], eax

loc_10004735:				; CODE XREF: sub_1000468B+A6j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+28h], eax
		push	18h
		mov	[esi+30h], ebp
		mov	[esi+34h], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		mov	edi, offset byte_1001AA47
		pop	ecx
		test	eax, eax
		jz	short loc_10004761
		push	edi		; Src
		mov	ecx, eax	; Dst
		call	sub_100017BF
		mov	dword_10031F2C,	eax
		jmp	short loc_10004767
; ---------------------------------------------------------------------------

loc_10004761:				; CODE XREF: sub_1000468B+C5j
		mov	dword_10031F2C,	ebp

loc_10004767:				; CODE XREF: sub_1000468B+D4j
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	edi		; Src
		lea	ecx, [esp+30h+Buf1] ; Dst
		call	sub_100017BF
		lea	eax, [esp+2Ch+Buf1]
		mov	ecx, ebx
		push	eax		; Buf1
		call	sub_10004905
		mov	ecx, dword_10031F2C
		push	ebp		; Size
		push	1		; char
		mov	[eax], ecx
		lea	ecx, [esp+34h+Buf1]
		call	sub_10001883
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [esp+2Ch+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_1000468B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100047B4	proc near		; CODE XREF: sub_1000457F+19p
		mov	eax, dword_10031F44
		test	eax, eax
		jz	short loc_100047C2
		cmp	eax, 1
		jnz	short locret_10004804

loc_100047C2:				; CODE XREF: sub_100047B4+7j
		xor	ecx, ecx
		mov	edx, offset dword_10031F44
		inc	ecx
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jnz	short loc_100047FA
		push	38h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100047EA
		mov	ecx, eax	; lpCriticalSection
		call	sub_1000468B
		jmp	short loc_100047EC
; ---------------------------------------------------------------------------

loc_100047EA:				; CODE XREF: sub_100047B4+2Bj
		xor	eax, eax

loc_100047EC:				; CODE XREF: sub_100047B4+34j
		mov	dword_10031F44,	eax
		retn
; ---------------------------------------------------------------------------

loc_100047F2:				; CODE XREF: sub_100047B4+4Ej
		push	0		; dwMilliseconds
		call	ds:Sleep

loc_100047FA:				; CODE XREF: sub_100047B4+1Ej
		mov	eax, dword_10031F44
		cmp	eax, 1
		jz	short loc_100047F2

locret_10004804:			; CODE XREF: sub_100047B4+Cj
		retn
sub_100047B4	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10004805(LPCRITICAL_SECTION lpCriticalSection, int, int)
sub_10004805	proc near		; CODE XREF: sub_1000457F+20p

var_24		= dword	ptr -24h
Buf1		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ecx, [esp+34h+Buf1] ; Dst
		push	offset aBrokerevent ; "BrokerEvent"
		call	sub_100017BF
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	eax, [esp+34h+Buf1]
		push	eax		; Buf2
		lea	eax, [esp+38h+var_24]
		lea	ebp, [edi+18h]
		push	eax		; int
		mov	ecx, ebp
		call	sub_10004A66
		mov	esi, [esp+34h+var_24]
		cmp	esi, [ebp+0]
		jz	short loc_10004863
		lea	eax, [esi+10h]
		push	eax		; Buf2
		lea	eax, [esp+38h+Buf1]
		push	eax		; Buf1
		call	sub_10004A9A
		test	al, al
		jnz	short loc_10004863
		mov	[esp+34h+var_24], esi
		jmp	short loc_1000486A
; ---------------------------------------------------------------------------

loc_10004863:				; CODE XREF: sub_10004805+44j
					; sub_10004805+56j
		mov	eax, [ebp+0]
		mov	[esp+34h+var_24], eax

loc_1000486A:				; CODE XREF: sub_10004805+5Cj
		lea	eax, [esp+34h+var_24]
		mov	eax, [eax]
		cmp	eax, [ebp+0]
		jz	short loc_1000487A
		mov	ebx, [eax+28h]
		jmp	short loc_100048A7
; ---------------------------------------------------------------------------

loc_1000487A:				; CODE XREF: sub_10004805+6Ej
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10004897
		lea	ecx, [esp+34h+Buf1]
		push	ecx
		mov	ecx, eax
		call	sub_1000344B
		mov	ebx, eax
		jmp	short loc_10004899
; ---------------------------------------------------------------------------

loc_10004897:				; CODE XREF: sub_10004805+80j
		xor	ebx, ebx

loc_10004899:				; CODE XREF: sub_10004805+90j
		lea	eax, [esp+34h+Buf1]
		mov	ecx, ebp
		push	eax		; Buf1
		call	sub_10004976
		mov	[eax], ebx

loc_100048A7:				; CODE XREF: sub_10004805+73j
		lea	eax, [esp+34h+arg_0]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		lea	ecx, [edi+20h]
		call	sub_100049E7
		mov	eax, [esp+34h+var_24]
		cmp	eax, [edi+20h]
		jnz	short loc_100048CE
		mov	eax, [esp+34h+arg_0]
		mov	[edi+30h], ebx
		mov	[edi+34h], eax
		jmp	short loc_100048DC
; ---------------------------------------------------------------------------

loc_100048CE:				; CODE XREF: sub_10004805+BBj
		add	eax, 14h
		lea	ecx, [edi+28h]
		push	eax
		call	sub_10004A21
		mov	[eax], ebx

loc_100048DC:				; CODE XREF: sub_10004805+C7j
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0		; Size
		push	1		; char
		lea	ecx, [esp+3Ch+Buf1]
		call	sub_10001883
		mov	ecx, [esp+34h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	8
sub_10004805	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004905(void *Buf1)
sub_10004905	proc near		; CODE XREF: sub_1000468B+F4p

var_4		= dword	ptr -4
Buf1		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+14h+Buf1]	; Buf2
		lea	eax, [esp+18h+var_4]
		mov	edi, ecx
		push	eax		; int
		call	sub_10004A66
		mov	esi, [esp+14h+var_4]
		cmp	esi, [edi]
		jz	short loc_10004933
		lea	eax, [esi+10h]
		push	eax		; Buf2
		push	[esp+18h+Buf1]	; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_1000496B

loc_10004933:				; CODE XREF: sub_10004905+1Bj
		mov	ecx, edi
		call	sub_10004EA6
		mov	ebp, eax
		lea	ebx, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	ebx, ebx
		jz	short loc_10004958
		push	[esp+14h+Buf1]	; Src
		mov	ecx, ebx
		call	sub_10001C48
		and	dword ptr [ebx+18h], 0

loc_10004958:				; CODE XREF: sub_10004905+42j
		push	ebp		; int
		push	ebx		; Buf1
		push	esi		; int
		lea	eax, [esp+20h+Buf1]
		mov	ecx, edi
		push	eax		; int
		call	sub_10004C14
		mov	esi, [esp+14h+Buf1]

loc_1000496B:				; CODE XREF: sub_10004905+2Cj
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_10004905	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004976(void *Buf1)
sub_10004976	proc near		; CODE XREF: sub_10004805+9Bp

var_4		= dword	ptr -4
Buf1		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+14h+Buf1]	; Buf2
		lea	eax, [esp+18h+var_4]
		mov	edi, ecx
		push	eax		; int
		call	sub_10004A66
		mov	esi, [esp+14h+var_4]
		cmp	esi, [edi]
		jz	short loc_100049A4
		lea	eax, [esi+10h]
		push	eax		; Buf2
		push	[esp+18h+Buf1]	; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_100049DC

loc_100049A4:				; CODE XREF: sub_10004976+1Bj
		mov	ecx, edi
		call	sub_10004EA6
		mov	ebp, eax
		lea	ebx, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	ebx, ebx
		jz	short loc_100049C9
		push	[esp+14h+Buf1]
		mov	ecx, ebx
		call	sub_1000344B
		and	dword ptr [ebx+18h], 0

loc_100049C9:				; CODE XREF: sub_10004976+42j
		push	ebp		; int
		push	ebx		; Buf1
		push	esi		; int
		lea	eax, [esp+20h+Buf1]
		mov	ecx, edi
		push	eax		; int
		call	sub_10004C14
		mov	esi, [esp+14h+Buf1]

loc_100049DC:				; CODE XREF: sub_10004976+2Cj
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_10004976	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100049E7	proc near		; CODE XREF: sub_10004805+AFp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	edi
		push	eax
		mov	esi, ecx
		call	sub_10004AC2
		mov	edx, [esi]
		mov	eax, [ebp+arg_4]
		cmp	eax, edx
		jz	short loc_10004A0E
		mov	ecx, [edi]
		mov	[ebp+arg_4], eax
		cmp	ecx, [eax+10h]
		jnb	short loc_10004A11

loc_10004A0E:				; CODE XREF: sub_100049E7+1Bj
		mov	[ebp+arg_4], edx

loc_10004A11:				; CODE XREF: sub_100049E7+25j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_100049E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004A21	proc near		; CODE XREF: sub_10004805+D0p

var_4		= byte ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+arg_0]
		push	edi
		push	esi
		push	eax
		mov	edi, ecx
		call	sub_10004AC2
		mov	eax, [ebp+arg_0]
		cmp	eax, [edi]
		jz	short loc_10004A44
		mov	ecx, [esi]
		cmp	ecx, [eax+10h]
		jnb	short loc_10004A5B

loc_10004A44:				; CODE XREF: sub_10004A21+1Aj
		push	ecx
		lea	ecx, [ebp+arg_0]
		mov	[ebp+arg_0], esi
		push	ecx
		push	ecx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		call	sub_10004BAE
		mov	eax, [eax]

loc_10004A5B:				; CODE XREF: sub_10004A21+21j
		pop	edi
		add	eax, 14h
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10004A21	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004A66(int, void *Buf2)
sub_10004A66	proc near		; CODE XREF: sub_10004805+38p
					; sub_10004905+10p ...

arg_0		= dword	ptr  4
Buf2		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_10004A89
; ---------------------------------------------------------------------------

loc_10004A6F:				; CODE XREF: sub_10004A66+27j
		push	[esp+8+Buf2]	; Buf2
		lea	eax, [esi+10h]
		push	eax		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_10004A85
		mov	esi, [esi+8]
		jmp	short loc_10004A89
; ---------------------------------------------------------------------------

loc_10004A85:				; CODE XREF: sub_10004A66+18j
		mov	edi, esi
		mov	esi, [esi]

loc_10004A89:				; CODE XREF: sub_10004A66+7j
					; sub_10004A66+1Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10004A6F
		mov	eax, [esp+8+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		retn	8
sub_10004A66	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004A9A(void *Buf1, void *Buf2)
sub_10004A9A	proc near		; CODE XREF: sub_10004805+4Fp
					; sub_10004905+25p ...

Buf1		= dword	ptr  4
Buf2		= dword	ptr  8

		mov	eax, [esp+Buf2]
		cmp	dword ptr [eax+14h], 10h
		mov	ecx, [eax+10h]
		jb	short loc_10004AA9
		mov	eax, [eax]

loc_10004AA9:				; CODE XREF: sub_10004A9A+Bj
		push	ecx		; int
		mov	ecx, [esp+4+Buf1] ; Buf1
		push	eax		; Buf2
		push	dword ptr [ecx+10h] ; Size
		push	ecx		; int
		call	sub_10003975
		xor	ecx, ecx
		test	eax, eax
		sets	al
		retn	8
sub_10004A9A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004AC2	proc near		; CODE XREF: sub_100049E7+Fp
					; sub_10004A21+10p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [ecx]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10004AE7
		mov	eax, [esp+arg_4]
		mov	eax, [eax]

loc_10004AD3:				; CODE XREF: sub_10004AC2+23j
		cmp	[ecx+10h], eax
		jnb	short loc_10004ADD
		mov	ecx, [ecx+8]
		jmp	short loc_10004AE1
; ---------------------------------------------------------------------------

loc_10004ADD:				; CODE XREF: sub_10004AC2+14j
		mov	edx, ecx
		mov	ecx, [ecx]

loc_10004AE1:				; CODE XREF: sub_10004AC2+19j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004AD3

loc_10004AE7:				; CODE XREF: sub_10004AC2+9j
		mov	eax, [esp+arg_0]
		mov	[eax], edx
		retn	8
sub_10004AC2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004AF0	proc near		; CODE XREF: sub_10004F20+8Ep
					; sub_10004F20+FAp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx+8]
		mov	eax, [esi]
		mov	[edx+8], eax
		mov	eax, [esi]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004B08
		mov	[eax+4], edx

loc_10004B08:				; CODE XREF: sub_10004AF0+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_10004B1A
		mov	[eax+4], esi
		jmp	short loc_10004B28
; ---------------------------------------------------------------------------

loc_10004B1A:				; CODE XREF: sub_10004AF0+23j
		mov	eax, [edx+4]
		cmp	edx, [eax]
		jnz	short loc_10004B25
		mov	[eax], esi
		jmp	short loc_10004B28
; ---------------------------------------------------------------------------

loc_10004B25:				; CODE XREF: sub_10004AF0+2Fj
		mov	[eax+8], esi

loc_10004B28:				; CODE XREF: sub_10004AF0+28j
					; sub_10004AF0+33j
		mov	[esi], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_10004AF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B31	proc near		; CODE XREF: sub_10004F20+ACp
					; sub_10004F20+DCp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx]
		mov	eax, [esi+8]
		mov	[edx], eax
		mov	eax, [esi+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004B49
		mov	[eax+4], edx

loc_10004B49:				; CODE XREF: sub_10004B31+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_10004B5B
		mov	[eax+4], esi
		jmp	short loc_10004B6A
; ---------------------------------------------------------------------------

loc_10004B5B:				; CODE XREF: sub_10004B31+23j
		mov	eax, [edx+4]
		cmp	edx, [eax+8]
		jnz	short loc_10004B68
		mov	[eax+8], esi
		jmp	short loc_10004B6A
; ---------------------------------------------------------------------------

loc_10004B68:				; CODE XREF: sub_10004B31+30j
		mov	[eax], esi

loc_10004B6A:				; CODE XREF: sub_10004B31+28j
					; sub_10004B31+35j
		mov	[esi+8], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_10004B31	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B74	proc near		; CODE XREF: sub_10004C14+F4p
					; sub_10004D76+B4p ...
		mov	edx, ecx
		mov	ecx, [edx]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10004BAB
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004BA0
		jmp	short loc_10004B8B
; ---------------------------------------------------------------------------

loc_10004B89:				; CODE XREF: sub_10004B74+1Dj
		mov	eax, ecx

loc_10004B8B:				; CODE XREF: sub_10004B74+13j
		mov	ecx, [eax]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004B89
		mov	[edx], eax
		jmp	short loc_10004BAB
; ---------------------------------------------------------------------------

loc_10004B97:				; CODE XREF: sub_10004B74+33j
		mov	eax, [edx]
		cmp	eax, [ecx+8]
		jnz	short loc_10004BA9
		mov	[edx], ecx

loc_10004BA0:				; CODE XREF: sub_10004B74+11j
		mov	ecx, [ecx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004B97

loc_10004BA9:				; CODE XREF: sub_10004B74+28j
		mov	[edx], ecx

loc_10004BAB:				; CODE XREF: sub_10004B74+8j
					; sub_10004B74+21j
		mov	eax, edx
		retn
sub_10004B74	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004BAE	proc near		; CODE XREF: sub_10004A21+33p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		push	esi
		push	18h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10004BC6
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10004BC6:				; CODE XREF: sub_10004BAE+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10004BD5
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004BD5:				; CODE XREF: sub_10004BAE+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10004BE0
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004BE0:				; CODE XREF: sub_10004BAE+2Cj
		lea	ecx, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	ecx, ecx
		jz	short loc_10004BFB
		mov	eax, [esp+4+arg_C]
		mov	eax, [eax]
		mov	eax, [eax]
		and	dword ptr [ecx+4], 0
		mov	[ecx], eax

loc_10004BFB:				; CODE XREF: sub_10004BAE+3Dj
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		mov	ecx, esi
		push	[esp+10h+arg_0]
		call	sub_10004D76
		mov	eax, [esp+4+arg_0]
		pop	esi
		retn	14h
sub_10004BAE	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004C14(int, int, void *Buf1, int)
sub_10004C14	proc near		; CODE XREF: sub_10004905+5Dp
					; sub_10004976+5Dp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Buf1		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+14h+var_C], ebp
		cmp	[edi+4], ebp
		jnz	short loc_10004C41
		push	[esp+14h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+24h+arg_0]
		call	sub_10004F20
		mov	eax, [esp+14h+arg_0]
		jmp	loc_10004D6E
; ---------------------------------------------------------------------------

loc_10004C41:				; CODE XREF: sub_10004C14+10j
		mov	ecx, [edi]
		mov	eax, [esp+14h+arg_4]
		push	ebx
		mov	ebx, [esp+18h+Buf1]
		push	esi
		cmp	eax, [ecx]
		jnz	short loc_10004C73
		add	eax, 10h
		push	eax		; Buf2
		push	ebx		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	loc_10004D52
		push	[esp+1Ch+arg_C]
		push	ecx
		push	[esp+24h+arg_4]
		mov	ecx, edi
		jmp	loc_10004D41
; ---------------------------------------------------------------------------

loc_10004C73:				; CODE XREF: sub_10004C14+3Bj
		cmp	eax, ecx
		jnz	short loc_10004C9E
		mov	eax, [ecx+8]
		add	eax, 10h
		push	ebx		; Buf2
		push	eax		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	loc_10004D52
		push	[esp+1Ch+arg_C]
		mov	eax, [edi]
		push	ecx
		mov	ecx, edi
		push	dword ptr [eax+8]
		push	ebp
		jmp	loc_10004D43
; ---------------------------------------------------------------------------

loc_10004C9E:				; CODE XREF: sub_10004C14+61j
		add	eax, 10h
		push	eax		; Buf2
		push	ebx		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_10004CEA
		mov	eax, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], eax
		call	sub_10004EDC
		push	ebx		; Buf2
		mov	eax, [eax]
		add	eax, 10h
		push	eax		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_10004CEA
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004CE4
		push	eax
		jmp	short loc_10004D3A
; ---------------------------------------------------------------------------

loc_10004CE4:				; CODE XREF: sub_10004C14+CBj
		push	[esp+24h+arg_4]
		jmp	short loc_10004D41
; ---------------------------------------------------------------------------

loc_10004CEA:				; CODE XREF: sub_10004C14+96j
					; sub_10004C14+B7j
		mov	eax, [esp+1Ch+arg_4]
		push	ebx		; Buf2
		add	eax, 10h
		push	eax		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_10004D52
		mov	esi, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B74
		mov	eax, [eax]
		cmp	eax, [edi]
		jz	short loc_10004D29
		mov	eax, [esp+1Ch+var_C]
		add	eax, 10h
		push	eax		; Buf2
		push	ebx		; Buf1
		call	sub_10004A9A
		test	al, al
		jz	short loc_10004D52
		mov	esi, [esp+1Ch+arg_4]

loc_10004D29:				; CODE XREF: sub_10004C14+FDj
		mov	eax, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [eax+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004D3D
		push	esi

loc_10004D3A:				; CODE XREF: sub_10004C14+CEj
		push	ebp
		jmp	short loc_10004D43
; ---------------------------------------------------------------------------

loc_10004D3D:				; CODE XREF: sub_10004C14+123j
		push	[esp+24h+var_C]

loc_10004D41:				; CODE XREF: sub_10004C14+5Aj
					; sub_10004C14+D4j
		push	1

loc_10004D43:				; CODE XREF: sub_10004C14+85j
					; sub_10004C14+127j
		push	[esp+2Ch+arg_0]
		call	sub_10004F20
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_10004D6C
; ---------------------------------------------------------------------------

loc_10004D52:				; CODE XREF: sub_10004C14+49j
					; sub_10004C14+72j ...
		push	[esp+1Ch+arg_C]	; int
		lea	eax, [esp+20h+var_8]
		push	ebx		; Buf1
		push	ecx		; int
		push	eax		; int
		mov	ecx, edi
		call	sub_10005041
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_10004D6C:				; CODE XREF: sub_10004C14+13Cj
		pop	esi
		pop	ebx

loc_10004D6E:				; CODE XREF: sub_10004C14+28j
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn	10h
sub_10004C14	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004D76	proc near		; CODE XREF: sub_10004BAE+59p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_10004DA2
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_100050E3
		mov	eax, [esp+10h+arg_0]
		jmp	loc_10004E82
; ---------------------------------------------------------------------------

loc_10004DA2:				; CODE XREF: sub_10004D76+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10004DCA
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_10004E65
		push	[esp+1Ch+arg_C]
		push	ecx

loc_10004DC4:				; CODE XREF: sub_10004D76+A0j
		push	esi
		jmp	loc_10004E54
; ---------------------------------------------------------------------------

loc_10004DCA:				; CODE XREF: sub_10004D76+3Cj
		cmp	esi, ebp
		jnz	short loc_10004DE7
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_10004E65
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_10004E56
; ---------------------------------------------------------------------------

loc_10004DE7:				; CODE XREF: sub_10004D76+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_10004E20
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EDC
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_10004E1B
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004DC4
		push	eax
		jmp	short loc_10004E4F
; ---------------------------------------------------------------------------

loc_10004E1B:				; CODE XREF: sub_10004D76+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_10004E20:				; CODE XREF: sub_10004D76+76j
		jnb	short loc_10004E65
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B74
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_10004E3E
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_10004E65

loc_10004E3E:				; CODE XREF: sub_10004D76+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004E53
		push	esi

loc_10004E4F:				; CODE XREF: sub_10004D76+A3j
		push	0
		jmp	short loc_10004E56
; ---------------------------------------------------------------------------

loc_10004E53:				; CODE XREF: sub_10004D76+D6j
		push	eax

loc_10004E54:				; CODE XREF: sub_10004D76+4Fj
		push	1

loc_10004E56:				; CODE XREF: sub_10004D76+6Fj
					; sub_10004D76+DBj
		push	[esp+2Ch+arg_0]
		call	sub_100050E3
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_10004E7F
; ---------------------------------------------------------------------------

loc_10004E65:				; CODE XREF: sub_10004D76+43j
					; sub_10004D76+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_10005207
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_10004E7F:				; CODE XREF: sub_10004D76+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_10004E82:				; CODE XREF: sub_10004D76+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_10004D76	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004E89	proc near		; CODE XREF: sub_10004F20+15p
					; sub_10005041:loc_100050CCp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	0		; Size
		push	1		; char
		lea	ecx, [esi+10h]
		call	sub_10001883
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn	4
sub_10004E89	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004EA6	proc near		; CODE XREF: sub_10004905+30p
					; sub_10004976+30p
		push	esi
		push	2Ch
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10004EBE
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10004EBE:				; CODE XREF: sub_10004EA6+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10004ECD
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004ECD:				; CODE XREF: sub_10004EA6+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10004ED8
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004ED8:				; CODE XREF: sub_10004EA6+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_10004EA6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004EDC	proc near		; CODE XREF: sub_10004C14+A4p
					; sub_10004D76+80p ...
		mov	edx, [ecx]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004EE9
		mov	eax, [edx+8]
		jmp	short loc_10004EFE
; ---------------------------------------------------------------------------

loc_10004EE9:				; CODE XREF: sub_10004EDC+6j
		mov	eax, [edx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004F0A
		jmp	short loc_10004EF5
; ---------------------------------------------------------------------------

loc_10004EF3:				; CODE XREF: sub_10004EDC+20j
		mov	eax, edx

loc_10004EF5:				; CODE XREF: sub_10004EDC+15j
		mov	edx, [eax+8]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004EF3

loc_10004EFE:				; CODE XREF: sub_10004EDC+Bj
		mov	[ecx], eax
		jmp	short loc_10004F1D
; ---------------------------------------------------------------------------

loc_10004F02:				; CODE XREF: sub_10004EDC+35j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_10004F13
		mov	[ecx], edx

loc_10004F0A:				; CODE XREF: sub_10004EDC+13j
		mov	edx, [edx+4]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004F02

loc_10004F13:				; CODE XREF: sub_10004EDC+2Aj
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004F1D
		mov	[ecx], edx

loc_10004F1D:				; CODE XREF: sub_10004EDC+24j
					; sub_10004EDC+3Dj
		mov	eax, ecx
		retn
sub_10004EDC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004F20	proc near		; CODE XREF: sub_10004C14+1Fp
					; sub_10004C14+133p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 5D1745Ch
		jb	short loc_10004F45
		push	[ebp+arg_10]
		call	sub_10004E89
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10004F45:				; CODE XREF: sub_10004F20+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_10004F66
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_10004F85
; ---------------------------------------------------------------------------

loc_10004F66:				; CODE XREF: sub_10004F20+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_10004F78
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_10004F85
		mov	[ecx], edi
		jmp	short loc_10004F85
; ---------------------------------------------------------------------------

loc_10004F78:				; CODE XREF: sub_10004F20+4Aj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_10004F85
		mov	[ecx+8], edi

loc_10004F85:				; CODE XREF: sub_10004F20+44j
					; sub_10004F20+52j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10005022
; ---------------------------------------------------------------------------

loc_10004F8F:				; CODE XREF: sub_10004F20+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10004FD3
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10004FD9
		cmp	esi, [eax+8]
		jnz	short loc_10004FB3
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_10004FB3:				; CODE XREF: sub_10004F20+87j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1000501F
; ---------------------------------------------------------------------------

loc_10004FD3:				; CODE XREF: sub_10004F20+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10004FF3

loc_10004FD9:				; CODE XREF: sub_10004F20+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000501F
; ---------------------------------------------------------------------------

loc_10004FF3:				; CODE XREF: sub_10004F20+B7j
		cmp	esi, [eax]
		jnz	short loc_10005001
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_10005001:				; CODE XREF: sub_10004F20+D5j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1000501F:				; CODE XREF: sub_10004F20+B1j
					; sub_10004F20+D1j
		mov	eax, [esi+4]

loc_10005022:				; CODE XREF: sub_10004F20+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10004F8F
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10004F20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10005041(int, int, void *Buf1, int)
sub_10005041	proc near		; CODE XREF: sub_10004C14+14Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Buf1		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_10005073
; ---------------------------------------------------------------------------

loc_10005057:				; CODE XREF: sub_10005041+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax		; Buf2
		push	[ebp+Buf1]	; Buf1
		call	sub_10004A9A
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_10005070
		mov	esi, [esi]
		jmp	short loc_10005073
; ---------------------------------------------------------------------------

loc_10005070:				; CODE XREF: sub_10005041+29j
		mov	esi, [esi+8]

loc_10005073:				; CODE XREF: sub_10005041+14j
					; sub_10005041+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10005057
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_100050B2
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_100050A7
		push	[ebp+arg_C]
		push	ecx
		push	edi
		push	1

loc_1000508F:				; CODE XREF: sub_10005041+89j
		lea	eax, [ebp+arg_C]
		mov	ecx, ebx
		push	eax
		call	sub_10004F20
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_100050DA
; ---------------------------------------------------------------------------

loc_100050A7:				; CODE XREF: sub_10005041+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EDC
		mov	esi, [ebp+var_4]

loc_100050B2:				; CODE XREF: sub_10005041+3Fj
		push	[ebp+Buf1]	; Buf2
		lea	eax, [esi+10h]
		push	eax		; Buf1
		call	sub_10004A9A
		push	[ebp+arg_C]
		test	al, al
		jz	short loc_100050CC
		push	ecx
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000508F
; ---------------------------------------------------------------------------

loc_100050CC:				; CODE XREF: sub_10005041+82j
		call	sub_10004E89
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_100050DA:				; CODE XREF: sub_10005041+64j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10005041	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100050E3	proc near		; CODE XREF: sub_10004D76+1Ep
					; sub_10004D76+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 0AAAAAA9h
		jb	short loc_1000510B
		push	[ebp+arg_10]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000510B:				; CODE XREF: sub_100050E3+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000512C
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000514B
; ---------------------------------------------------------------------------

loc_1000512C:				; CODE XREF: sub_100050E3+39j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000513E
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000514B
		mov	[ecx], edi
		jmp	short loc_1000514B
; ---------------------------------------------------------------------------

loc_1000513E:				; CODE XREF: sub_100050E3+4Dj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000514B
		mov	[ecx+8], edi

loc_1000514B:				; CODE XREF: sub_100050E3+47j
					; sub_100050E3+55j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_100051E8
; ---------------------------------------------------------------------------

loc_10005155:				; CODE XREF: sub_100050E3+109j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10005199
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000519F
		cmp	esi, [eax+8]
		jnz	short loc_10005179
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_10005179:				; CODE XREF: sub_100050E3+8Aj
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_100051E5
; ---------------------------------------------------------------------------

loc_10005199:				; CODE XREF: sub_100050E3+7Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_100051B9

loc_1000519F:				; CODE XREF: sub_100050E3+85j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_100051E5
; ---------------------------------------------------------------------------

loc_100051B9:				; CODE XREF: sub_100050E3+BAj
		cmp	esi, [eax]
		jnz	short loc_100051C7
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_100051C7:				; CODE XREF: sub_100050E3+D8j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_100051E5:				; CODE XREF: sub_100050E3+B4j
					; sub_100050E3+D4j
		mov	eax, [esi+4]

loc_100051E8:				; CODE XREF: sub_100050E3+6Dj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10005155
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_100050E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005207	proc near		; CODE XREF: sub_10004D76+FCp
					; sub_1000919F+57p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10005245
		mov	esi, [ebx]

loc_10005228:				; CODE XREF: sub_10005207+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_1000523C
		mov	eax, [eax]
		jmp	short loc_1000523F
; ---------------------------------------------------------------------------

loc_1000523C:				; CODE XREF: sub_10005207+2Fj
		mov	eax, [eax+8]

loc_1000523F:				; CODE XREF: sub_10005207+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10005228

loc_10005245:				; CODE XREF: sub_10005207+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_10005282
		cmp	edi, [ecx]
		jnz	short loc_10005275
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_1000525B:				; CODE XREF: sub_10005207+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_100050E3
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_100052A6
; ---------------------------------------------------------------------------

loc_10005275:				; CODE XREF: sub_10005207+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EDC
		mov	esi, [esp+14h+arg_8]

loc_10005282:				; CODE XREF: sub_10005207+46j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]
		cmp	eax, [ebx]
		jnb	short loc_10005295
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000525B
; ---------------------------------------------------------------------------

loc_10005295:				; CODE XREF: sub_10005207+84j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_100052A6:				; CODE XREF: sub_10005207+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10005207	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052AE	proc near		; CODE XREF: sub_100052C3+3p
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jnz	short loc_100052C0
		cmp	dword ptr [ecx+4], 7FFFFFFFh
		jnz	short loc_100052C0
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100052C0:				; CODE XREF: sub_100052AE+3j
					; sub_100052AE+Cj
		xor	eax, eax
		retn
sub_100052AE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052C3	proc near		; CODE XREF: sub_100053AA+9Ap
		push	esi
		mov	esi, ecx
		call	sub_100052AE
		test	al, al
		jz	short loc_100052D9
		or	eax, 0FFFFFFFFh
		mov	edx, 7FFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100052D9:				; CODE XREF: sub_100052C3+Aj
		mov	eax, [esi]
		mov	edx, [esi+4]
		pop	esi
		retn
sub_100052C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052E0	proc near		; CODE XREF: sub_10005320+4Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0FFFFFFFFh
		push	esi
		mov	esi, ecx
		jnz	short loc_100052FD
		mov	eax, 7FFFFFFFh
		cmp	[esp+4+arg_4], eax
		jnz	short loc_100052FD
		or	dword ptr [esi], 0FFFFFFFFh
		mov	[esi+4], eax
		jmp	short loc_10005316
; ---------------------------------------------------------------------------

loc_100052FD:				; CODE XREF: sub_100052E0+8j
					; sub_100052E0+13j
		push	0
		push	3E8h
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	__allmul
		mov	[esi], eax
		mov	[esi+4], edx

loc_10005316:				; CODE XREF: sub_100052E0+1Bj
		mov	eax, esi
		pop	esi
		retn
sub_100052E0	endp

; [00000006 BYTES: COLLAPSED FUNCTION timeGetTime]

; =============== S U B	R O U T	I N E =======================================


sub_10005320	proc near		; CODE XREF: sub_100053AA+92p
					; sub_10005564+58p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, offset CriticalSection
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		call	ds:off_1001AAB4
		mov	ecx, dword_10031CB0
		mov	esi, eax
		mov	edx, dword_10031CB4
		cmp	esi, dword_10031CAC
		jnb	short loc_1000535C
		add	ecx, 0
		mov	dword_10031CB0,	ecx
		adc	edx, 1
		mov	dword_10031CB4,	edx

loc_1000535C:				; CODE XREF: sub_10005320+28j
		xor	eax, eax
		mov	dword_10031CAC,	esi
		add	esi, ecx
		mov	ecx, [esp+8+arg_0]
		adc	eax, edx
		push	eax
		push	esi
		call	sub_100052E0
		pop	ecx
		pop	ecx
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		retn
sub_10005320	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005383	proc near		; CODE XREF: sub_100053AA+33p
					; sub_100055C9+2Ep
		push	esi
		mov	esi, ecx
		push	0Ch		; int
		push	offset aAuthenticamd ; "AuthenticAMD"
		lea	ecx, [esi+28h]	; Buf1
		push	dword ptr [ecx+10h] ; Size
		push	ecx		; int
		call	sub_10003975
		test	eax, eax
		jnz	short loc_100053A6
		cmp	dword ptr [esi+8], 0Fh
		jnz	short loc_100053A6
		inc	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100053A6:				; CODE XREF: sub_10005383+18j
					; sub_10005383+1Ej
		xor	eax, eax
		pop	esi
		retn
sub_10005383	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100053AA	proc near		; CODE XREF: sub_10005533+20p

Frequency	= LARGE_INTEGER	ptr -78h
PerformanceCount= LARGE_INTEGER	ptr -70h
var_68		= byte ptr -68h
var_60		= byte ptr -60h
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+7Ch+var_4], eax
		push	ebx
		mov	ebx, ecx
		lea	ecx, [esp+80h+var_60]
		push	esi
		xor	esi, esi
		push	edi
		mov	[ebx], esi
		mov	[ebx+4], esi
		mov	[ebx+8], esi
		mov	[ebx+0Ch], esi
		call	sub_10002BEF
		lea	ecx, [esp+88h+var_60]
		call	sub_10005383
		test	al, al
		jz	short loc_100053F5

loc_100053E6:				; CODE XREF: sub_100053AA+60j
		push	esi		; Size
		push	1		; char
		lea	ecx, [esp+90h+var_20]
		call	sub_10001883
		push	esi
		jmp	short loc_10005462
; ---------------------------------------------------------------------------

loc_100053F5:				; CODE XREF: sub_100053AA+3Aj
		lea	eax, [esp+88h+Frequency]
		mov	dword ptr [esp+88h+Frequency], esi
		push	eax		; lpFrequency
		mov	dword ptr [esp+8Ch+Frequency+4], esi
		call	ds:QueryPerformanceFrequency
		test	eax, eax
		jz	short loc_100053E6
		mov	eax, dword ptr [esp+88h+Frequency]
		mov	[ebx], eax
		mov	eax, dword ptr [esp+88h+Frequency+4]
		mov	[ebx+4], eax
		lea	eax, [esp+88h+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		push	dword ptr [esp+88h+PerformanceCount+4]
		mov	ecx, ebx
		push	dword ptr [esp+8Ch+PerformanceCount]
		call	sub_10005484
		mov	esi, eax
		mov	edi, edx
		lea	eax, [esp+88h+var_68]
		push	eax
		call	sub_10005320
		pop	ecx
		mov	ecx, eax
		call	sub_100052C3
		sub	esi, eax
		lea	ecx, [esp+88h+var_20]
		push	0		; Size
		sbb	edi, edx
		mov	[ebx+8], esi
		push	1		; char
		mov	[ebx+0Ch], edi
		call	sub_10001883
		push	0		; Size

loc_10005462:				; CODE XREF: sub_100053AA+49j
		push	1		; char
		lea	ecx, [esp+90h+var_38]
		call	sub_10001883
		mov	ecx, [esp+88h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100053AA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005484	proc near		; CODE XREF: sub_100053AA+84p
					; sub_10005564+2Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [ecx]
		mov	eax, ebx
		push	ebp
		mov	ebp, [ecx+4]
		or	eax, ebp
		push	esi
		push	edi
		mov	[esp+18h+var_4], ebx
		mov	[esp+18h+var_8], ebp
		jnz	short loc_100054A4
		xor	edx, edx
		jmp	loc_1000552A
; ---------------------------------------------------------------------------

loc_100054A4:				; CODE XREF: sub_10005484+17j
		mov	edi, [esp+18h+arg_4]
		mov	esi, [esp+18h+arg_0]
		cmp	edi, 863h
		jg	short loc_100054D7
		jl	short loc_100054BE
		cmp	esi, 7BD05AF7h
		jnb	short loc_100054D7

loc_100054BE:				; CODE XREF: sub_10005484+30j
		push	0
		push	0F4240h
		push	edi
		push	esi
		call	__allmul
		push	ebp
		push	ebx
		push	edx
		push	eax
		call	__alldiv
		jmp	short loc_1000552A
; ---------------------------------------------------------------------------

loc_100054D7:				; CODE XREF: sub_10005484+2Ej
					; sub_10005484+38j
		push	ebp
		push	ebx
		push	edi
		push	esi
		call	__alldiv
		mov	ebx, edx
		mov	ebp, eax
		push	ebx
		push	ebp
		push	[esp+20h+var_8]
		push	[esp+24h+var_4]
		call	__allmul
		sub	esi, eax
		push	0
		push	0F4240h
		sbb	edi, edx
		push	edi
		push	esi
		call	__allmul
		push	[esp+18h+var_8]
		push	[esp+1Ch+var_4]
		push	edx
		push	eax
		call	__alldiv
		push	0
		push	0F4240h
		push	ebx
		push	ebp
		mov	esi, eax
		mov	edi, edx
		call	__allmul
		add	eax, esi
		adc	edx, edi

loc_1000552A:				; CODE XREF: sub_10005484+1Bj
					; sub_10005484+51j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
sub_10005484	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005533	proc near		; CODE XREF: sub_10005564+Ap
					; sub_100055C9+1Fp
		push	ecx
		mov	eax, dword_10031CC0
		test	eax, 0FFFFFFFEh
		jnz	short loc_1000555D
		mov	ecx, offset dword_10031CC0
		call	sub_10002F24
		test	al, al
		jz	short loc_1000555D
		mov	ecx, offset dword_10031CC8
		call	sub_100053AA
		mov	dword_10031CC0,	eax

loc_1000555D:				; CODE XREF: sub_10005533+Bj
					; sub_10005533+19j
		mov	eax, dword_10031CC0
		pop	ecx
		retn
sub_10005533	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005564	proc near		; CODE XREF: sub_1000562F+2Fp
					; DATA XREF: sub_1000562F:loc_10005654o

PerformanceCount= LARGE_INTEGER	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0Ch
		push	esi
		call	sub_10005533
		mov	esi, eax
		mov	ecx, [esi]
		or	ecx, [esi+4]
		jz	short loc_100055B8
		lea	eax, [esp+10h+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		push	dword ptr [esp+10h+PerformanceCount+4]
		mov	ecx, esi
		push	dword ptr [esp+14h+PerformanceCount]
		call	sub_10005484
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100055AE
		mov	ecx, 7FFFFFFFh
		cmp	edx, ecx
		jnz	short loc_100055AE
		mov	esi, [ebp+arg_0]
		or	[esi], eax
		mov	[esi+4], ecx
		jmp	short loc_100055C2
; ---------------------------------------------------------------------------

loc_100055AE:				; CODE XREF: sub_10005564+35j
					; sub_10005564+3Ej
		mov	esi, [ebp+arg_0]
		mov	[esi], eax
		mov	[esi+4], edx
		jmp	short loc_100055C2
; ---------------------------------------------------------------------------

loc_100055B8:				; CODE XREF: sub_10005564+16j
		mov	esi, [ebp+arg_0]
		push	esi
		call	sub_10005320
		pop	ecx

loc_100055C2:				; CODE XREF: sub_10005564+48j
					; sub_10005564+52j
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10005564	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100055C9	proc near		; CODE XREF: sub_1000562F+6p

var_60		= byte ptr -60h
var_3A		= byte ptr -3Ah
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		lea	ecx, [ebp+var_60]
		call	sub_10002BEF
		cmp	[ebp+var_3A], 0
		jz	short loc_10005604
		call	sub_10005533
		mov	ecx, [eax]
		or	ecx, [eax+4]
		jz	short loc_10005604
		lea	ecx, [ebp+var_60]
		call	sub_10005383
		test	al, al
		jnz	short loc_10005604
		mov	bl, 1
		jmp	short loc_10005606
; ---------------------------------------------------------------------------

loc_10005604:				; CODE XREF: sub_100055C9+1Dj
					; sub_100055C9+29j ...
		xor	bl, bl

loc_10005606:				; CODE XREF: sub_100055C9+39j
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+var_20]
		call	sub_10001883
		push	0		; Size
		push	1		; char
		lea	ecx, [ebp+var_38]
		call	sub_10001883
		mov	ecx, [ebp+var_4]
		mov	al, bl
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100055C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000562F	proc near		; DATA XREF: .data:off_10031014o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		call	sub_100055C9
		mov	ecx, offset off_10031014
		test	al, al
		jnz	short loc_10005654
		mov	eax, offset sub_10005320
		xchg	eax, [ecx]
		push	[ebp+arg_0]
		call	sub_10005320
		jmp	short loc_10005663
; ---------------------------------------------------------------------------

loc_10005654:				; CODE XREF: sub_1000562F+12j
		mov	eax, offset sub_10005564
		xchg	eax, [ecx]
		push	[ebp+arg_0]
		call	sub_10005564

loc_10005663:				; CODE XREF: sub_1000562F+23j
		mov	eax, [ebp+arg_0]
		pop	ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000562F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000566B	proc near		; CODE XREF: sub_100056A9+28p
					; sub_100056E6+2Cp

arg_0		= dword	ptr  4

		mov	eax, [ecx+4]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, [eax+3Ch]
		add	edx, eax
		movzx	eax, word ptr [edx+6]
		cmp	esi, eax
		jnb	short loc_10005690
		movzx	ecx, word ptr [edx+14h]
		imul	eax, esi, 28h
		add	ecx, edx
		add	eax, 18h
		add	eax, ecx
		jmp	short loc_10005692
; ---------------------------------------------------------------------------

loc_10005690:				; CODE XREF: sub_1000566B+13j
		xor	eax, eax

loc_10005692:				; CODE XREF: sub_1000566B+23j
		pop	esi
		retn	4
sub_1000566B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005696	proc near		; CODE XREF: sub_10005742+9p
					; sub_1000578C+21p ...
		mov	eax, [ecx+4]
		mov	edx, [eax+3Ch]
		add	edx, eax
		mov	eax, [ecx]
		push	dword ptr [edx+78h]
		call	dword ptr [eax+4]
		retn	4
sub_10005696	endp


; =============== S U B	R O U T	I N E =======================================


sub_100056A9	proc near		; CODE XREF: sub_100168F0+18p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		xor	edi, edi
		jmp	short loc_100056D0
; ---------------------------------------------------------------------------

loc_100056B2:				; CODE XREF: sub_100056A9+31j
		push	dword ptr [esi+0Ch]
		mov	ecx, ebx
		call	sub_100058F3
		cmp	eax, [esp+0Ch+arg_0]
		ja	short loc_100056CD
		mov	ecx, [esi+8]
		add	ecx, eax
		cmp	ecx, [esp+0Ch+arg_0]
		ja	short loc_100056E2

loc_100056CD:				; CODE XREF: sub_100056A9+17j
		inc	edi
		mov	ecx, ebx

loc_100056D0:				; CODE XREF: sub_100056A9+7j
		push	edi
		call	sub_1000566B
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100056B2

loc_100056DC:				; CODE XREF: sub_100056A9+3Bj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
; ---------------------------------------------------------------------------

loc_100056E2:				; CODE XREF: sub_100056A9+22j
		mov	eax, esi
		jmp	short loc_100056DC
sub_100056A9	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100056E6(char *Str)
sub_100056E6	proc near		; CODE XREF: sub_10002E78+29p
					; sub_10002E78+3Ap

var_4		= dword	ptr -4
Str		= dword	ptr  4

		push	ecx
		cmp	[esp+4+Str], 0
		push	ebp
		mov	ebp, ecx
		jnz	short loc_100056F5
		xor	eax, eax
		jmp	short loc_1000573D
; ---------------------------------------------------------------------------

loc_100056F5:				; CODE XREF: sub_100056E6+9j
		mov	ecx, [ebp+4]
		push	esi
		push	edi
		xor	edi, edi
		mov	eax, [ecx+3Ch]
		mov	esi, edi
		movzx	eax, word ptr [eax+ecx+6]
		mov	[esp+10h+var_4], eax
		test	eax, eax
		jle	short loc_10005739
		push	ebx

loc_1000570F:				; CODE XREF: sub_100056E6+4Cj
		push	esi
		mov	ecx, ebp
		call	sub_1000566B
		push	8		; MaxCount
		push	[esp+18h+Str]	; Str
		mov	ebx, eax
		push	ebx		; Str1
		call	ds:_strnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005736
		inc	esi
		cmp	esi, [esp+14h+var_4]
		jl	short loc_1000570F
		jmp	short loc_10005738
; ---------------------------------------------------------------------------

loc_10005736:				; CODE XREF: sub_100056E6+45j
		mov	edi, ebx

loc_10005738:				; CODE XREF: sub_100056E6+4Ej
		pop	ebx

loc_10005739:				; CODE XREF: sub_100056E6+26j
		mov	eax, edi
		pop	edi
		pop	esi

loc_1000573D:				; CODE XREF: sub_100056E6+Dj
		pop	ebp
		pop	ecx
		retn	4
sub_100056E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005742	proc near		; CODE XREF: sub_1000578C+7p
					; sub_10009AF1+39p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	ecx
		mov	esi, ecx
		call	sub_10005696
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000575A

loc_10005756:				; CODE XREF: sub_10005742+2Cj
		xor	eax, eax
		jmp	short loc_10005784
; ---------------------------------------------------------------------------

loc_1000575A:				; CODE XREF: sub_10005742+12j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		mov	ecx, esi
		call	sub_100057D2
		test	al, al
		jz	short loc_10005756
		mov	eax, [esi]
		mov	ecx, esi
		push	dword ptr [edi+1Ch]
		call	dword ptr [eax+4]
		movzx	ecx, word ptr [ebp+var_4]
		sub	ecx, [edi+10h]
		lea	eax, [eax+ecx*4]

loc_10005784:				; CODE XREF: sub_10005742+16j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005742	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000578C	proc near		; CODE XREF: sub_1000E01D+69p
					; sub_1000EE41+29p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		call	sub_10005742
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_100057CE
		mov	eax, [esi]
		push	edi
		push	dword ptr [ecx]
		mov	ecx, esi
		call	dword ptr [eax+4]
		push	ecx
		mov	ecx, esi
		mov	edi, eax
		call	sub_10005696
		mov	edx, [esi+4]
		cmp	eax, edi
		ja	short loc_100057CB
		mov	ecx, [edx+3Ch]
		mov	ecx, [ecx+edx+7Ch]
		add	ecx, eax
		cmp	ecx, edi
		jbe	short loc_100057CB
		or	eax, 0FFFFFFFFh
		jmp	short loc_100057CD
; ---------------------------------------------------------------------------

loc_100057CB:				; CODE XREF: sub_1000578C+2Bj
					; sub_1000578C+38j
		mov	eax, edi

loc_100057CD:				; CODE XREF: sub_1000578C+3Dj
		pop	edi

loc_100057CE:				; CODE XREF: sub_1000578C+10j
		pop	esi
		retn	4
sub_1000578C	endp


; =============== S U B	R O U T	I N E =======================================


sub_100057D2	proc near		; CODE XREF: sub_10005742+25p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		push	edi
		mov	edi, ecx
		test	ebp, ebp
		jnz	short loc_100057E7
		xor	al, al
		jmp	loc_100058B9
; ---------------------------------------------------------------------------

loc_100057E7:				; CODE XREF: sub_100057D2+Cj
		push	ebx
		push	ecx
		call	sub_10005696
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_100057FB
		xor	al, al
		jmp	loc_100058B8
; ---------------------------------------------------------------------------

loc_100057FB:				; CODE XREF: sub_100057D2+20j
		mov	eax, [esp+14h+arg_0]
		push	esi
		cmp	eax, 0FFFFh
		jbe	loc_100058AD
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+20h]
		call	dword ptr [eax+4]
		mov	ecx, [ebx+18h]
		mov	edx, eax
		mov	[esp+18h+var_4], edx
		mov	esi, edx
		lea	eax, [edx+ecx*4]
		mov	[esp+18h+var_8], eax
		cmp	edx, eax
		jz	loc_100058B5

loc_1000582F:				; CODE XREF: sub_100057D2+B4j
		sub	eax, esi
		sar	eax, 2
		cdq
		sub	eax, edx
		sar	eax, 1
		lea	ecx, [esi+eax*4]
		mov	eax, [edi]
		push	dword ptr [ecx]
		mov	[esp+1Ch+arg_4], ecx
		mov	ecx, edi
		call	dword ptr [eax+4]
		mov	ecx, eax
		mov	eax, [esp+18h+arg_0]
		mov	edx, eax
		mov	al, [eax]
		jmp	short loc_1000585D
; ---------------------------------------------------------------------------

loc_10005855:				; CODE XREF: sub_100057D2+8Dj
		cmp	al, [ecx]
		jnz	short loc_10005861
		inc	edx
		inc	ecx
		mov	al, [edx]

loc_1000585D:				; CODE XREF: sub_100057D2+81j
		test	al, al
		jnz	short loc_10005855

loc_10005861:				; CODE XREF: sub_100057D2+85j
		movzx	eax, byte ptr [ecx]
		movzx	ecx, byte ptr [edx]
		sub	ecx, eax
		jz	short loc_1000588A
		test	ecx, ecx
		jle	short loc_1000587C
		mov	esi, [esp+18h+arg_4]
		mov	eax, [esp+18h+var_8]
		add	esi, 4
		jmp	short loc_10005884
; ---------------------------------------------------------------------------

loc_1000587C:				; CODE XREF: sub_100057D2+9Bj
		mov	eax, [esp+18h+arg_4]
		mov	[esp+18h+var_8], eax

loc_10005884:				; CODE XREF: sub_100057D2+A8j
		cmp	esi, eax
		jnz	short loc_1000582F
		jmp	short loc_10005890
; ---------------------------------------------------------------------------

loc_1000588A:				; CODE XREF: sub_100057D2+97j
		mov	eax, [esp+18h+arg_4]
		mov	esi, eax

loc_10005890:				; CODE XREF: sub_100057D2+B6j
		test	ecx, ecx
		jnz	short loc_100058B5
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+24h]
		call	dword ptr [eax+4]
		sub	esi, [esp+18h+var_4]
		sar	esi, 2
		mov	ax, [eax+esi*2]
		add	ax, [ebx+10h]

loc_100058AD:				; CODE XREF: sub_100057D2+33j
		mov	[ebp+0], ax
		mov	al, 1
		jmp	short loc_100058B7
; ---------------------------------------------------------------------------

loc_100058B5:				; CODE XREF: sub_100057D2+57j
					; sub_100057D2+C0j
		xor	al, al

loc_100058B7:				; CODE XREF: sub_100057D2+E1j
		pop	esi

loc_100058B8:				; CODE XREF: sub_100057D2+24j
		pop	ebx

loc_100058B9:				; CODE XREF: sub_100057D2+10j
		pop	edi
		pop	ebp
		pop	ecx
		pop	ecx
		retn	8
sub_100057D2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100058C0	proc near		; CODE XREF: sub_10009AF1+23p
					; sub_10012A16+20p ...
		mov	ecx, [ecx+4]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_100058D0

loc_100058CD:				; CODE XREF: sub_100058C0+1Bj
					; sub_100058C0+26j
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_100058D0:				; CODE XREF: sub_100058C0+Bj
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_100058CD
		mov	ecx, 0E0h
		cmp	[eax+14h], cx
		jnz	short loc_100058CD
		add	ecx, 2Bh
		cmp	[eax+18h], cx
		setz	al
		retn
sub_100058C0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100058F3	proc near		; CODE XREF: sub_100056A9+Ep
					; sub_10009AF1+51p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jnz	short loc_100058FE
		xor	eax, eax
		jmp	short locret_10005905
; ---------------------------------------------------------------------------

loc_100058FE:				; CODE XREF: sub_100058F3+5j
		mov	eax, [ecx+4]
		add	eax, [esp+arg_0]

locret_10005905:			; CODE XREF: sub_100058F3+9j
		retn	4
sub_100058F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10005908(HANDLE hObject)
sub_10005908	proc near		; CODE XREF: sub_10004633+3Bp

var_B8		= byte ptr -0B8h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		and	[ebp+var_4], 0
		push	ecx		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_1000594C
		push	3
		push	32h
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [ebp+var_B8]
		call	sub_10001B31
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002830
		lea	ecx, [ebp+var_B8]
		call	sub_10001BD6

loc_1000594C:				; CODE XREF: sub_10005908+16j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_10005908	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005952	proc near		; CODE XREF: sub_100045FD+2Ap

lpCriticalSection= dword ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= byte ptr -0C0h
var_B0		= byte ptr -0B0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0DCh
		and	[esp+0DCh+lpCriticalSection], 0
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, ecx
		call	ds:GetCurrentThreadId
		mov	edi, eax
		call	sub_10005AF6
		push	eax		; lpCriticalSection
		mov	[esp+0ECh+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		lea	eax, [esp+0E8h+var_C4]
		mov	[esp+0E8h+var_D0], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+0E8h+var_D4], esi
		lea	esi, [esp+0E8h+var_D4]
		mov	[esp+0E8h+var_C8], edi
		lea	edi, [esp+0E8h+var_C0]
		mov	[esp+0E8h+var_CC], ecx
		mov	[esp+0E8h+var_C4], ebx
		movsd
		push	eax
		lea	eax, [esp+0ECh+var_D4]
		push	eax
		movsd
		movsd
		movsd
		call	sub_10005BF2
		mov	ecx, eax
		call	sub_10005F49
		cmp	byte ptr [esp+0E8h+var_D0], 0
		jnz	short loc_10005A07
		mov	esi, [esp+0E8h+var_D4]
		lea	edi, [esp+0E8h+var_D4]
		lea	eax, [esp+0E8h+var_D4]
		push	eax
		lea	esi, [esi+0Ch]
		movsd
		movsd
		movsd
		movsd
		call	sub_10002E55
		pop	ecx
		push	3
		push	6Ah
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+0F4h+var_B0]
		call	sub_10001B31
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002830
		lea	ecx, [esp+0E8h+var_B0]
		call	sub_10001BD6

loc_10005A07:				; CODE XREF: sub_10005952+71j
		push	[esp+0E8h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10005952	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005A18	proc near		; CODE XREF: sub_10004633+1Bp
					; sub_1000628A+15p

var_CC		= dword	ptr -0CCh
lpCriticalSection= dword ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_B0		= byte ptr -0B0h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0D0h
		and	[esp+0D0h+lpCriticalSection], 0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebx, edx
		mov	[esp+0E0h+var_C4], ecx
		call	sub_10005AF6
		push	eax		; lpCriticalSection
		mov	[esp+0E4h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	eax, [esp+0E0h+var_C4]
		push	eax
		lea	eax, [esp+0E4h+var_CC]
		push	eax
		call	sub_10005BF2
		mov	ecx, eax
		call	sub_10005B8F
		call	sub_10005BF2
		mov	esi, [esp+0E0h+var_CC]
		mov	ebp, offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		cmp	esi, [eax]
		jnz	short loc_10005A8F
		push	3
		push	77h
		push	ebp
		lea	ecx, [esp+0ECh+var_B0]
		call	sub_10001B31
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002830
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001BD6

loc_10005A8F:				; CODE XREF: sub_10005A18+51j
		add	esi, 0Ch
		lea	edi, [esp+0E0h+var_C0]
		movsd
		movsd
		movsd
		movsd
		cmp	[esp+0E0h+var_C0], ebx
		jz	short loc_10005ACF
		lea	eax, [esp+0E0h+var_C0]
		push	eax
		call	sub_10002E55
		pop	ecx
		push	3
		push	7Ch
		push	ebp
		lea	ecx, [esp+0ECh+var_B0]
		call	sub_10001B31
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002830
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001BD6

loc_10005ACF:				; CODE XREF: sub_10005A18+86j
		push	[esp+0E0h+var_CC]
		lea	eax, [esp+0E4h+var_CC]
		push	eax
		call	sub_10005BF2
		mov	ecx, eax
		call	sub_10005B2F
		push	[esp+0E0h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10005A18	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005AF6	proc near		; CODE XREF: sub_10004633+24p
					; sub_10005952+20p ...
		mov	eax, dword_10031D60
		push	esi
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005B28
		mov	ecx, offset dword_10031D60
		call	sub_10002F24
		test	al, al
		jz	short loc_10005B28
		push	7D0h		; dwSpinCount
		mov	esi, offset stru_10031D64
		push	esi		; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		mov	dword_10031D60,	esi

loc_10005B28:				; CODE XREF: sub_10005AF6+Bj
					; sub_10005AF6+19j
		mov	eax, dword_10031D60
		pop	esi
		retn
sub_10005AF6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005B2F	proc near		; CODE XREF: sub_10005A18+C7p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		push	edi
		add	eax, 8
		mov	edi, ecx
		push	eax
		call	sub_10005C64
		mov	esi, [edi+8]
		mov	edx, eax
		mov	ecx, [ebp+arg_4]
		cmp	[esi+edx*8+4], ecx
		jnz	short loc_10005B6E
		cmp	[esi+edx*8], ecx
		jnz	short loc_10005B65
		mov	eax, [edi]
		mov	[esi+edx*8], eax
		mov	ecx, [edi+8]
		mov	eax, [edi]
		mov	[ecx+edx*8+4], eax
		jmp	short loc_10005B78
; ---------------------------------------------------------------------------

loc_10005B65:				; CODE XREF: sub_10005B2F+24j
		mov	eax, [ecx+4]
		mov	[esi+edx*8+4], eax
		jmp	short loc_10005B78
; ---------------------------------------------------------------------------

loc_10005B6E:				; CODE XREF: sub_10005B2F+1Fj
		cmp	[esi+edx*8], ecx
		jnz	short loc_10005B7B
		mov	eax, [ecx]
		mov	[esi+edx*8], eax

loc_10005B78:				; CODE XREF: sub_10005B2F+34j
					; sub_10005B2F+3Dj
		mov	ecx, [ebp+arg_4]

loc_10005B7B:				; CODE XREF: sub_10005B2F+42j
		push	ecx
		push	[ebp+arg_0]
		mov	ecx, edi
		call	sub_10005C9B
		mov	eax, [ebp+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		retn	8
sub_10005B2F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005B8F	proc near		; CODE XREF: sub_10005A18+3Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		mov	esi, ecx
		push	edi
		call	sub_10005C64
		mov	ecx, [esi+8]
		mov	esi, [esi]
		lea	ebx, [eax+eax]
		mov	edx, [ecx+eax*8]

loc_10005BAC:				; CODE XREF: sub_10005B8F+39j
		cmp	[ecx+ebx*4], esi
		jnz	short loc_10005BB5
		mov	eax, esi
		jmp	short loc_10005BBB
; ---------------------------------------------------------------------------

loc_10005BB5:				; CODE XREF: sub_10005B8F+20j
		mov	eax, [ecx+ebx*4+4]
		mov	eax, [eax]

loc_10005BBB:				; CODE XREF: sub_10005B8F+24j
		cmp	edx, eax
		jz	short loc_10005BE3
		mov	eax, [edx+8]
		cmp	eax, [edi]
		jz	short loc_10005BCA
		mov	edx, [edx]
		jmp	short loc_10005BAC
; ---------------------------------------------------------------------------

loc_10005BCA:				; CODE XREF: sub_10005B8F+35j
		mov	eax, [edi]
		cmp	eax, [edx+8]
		lea	eax, [ebp+arg_4]
		mov	[ebp+arg_4], esi
		jnz	short loc_10005BDA
		mov	[ebp+arg_4], edx

loc_10005BDA:				; CODE XREF: sub_10005B8F+46j
		mov	ecx, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ecx], eax
		jmp	short loc_10005BE8
; ---------------------------------------------------------------------------

loc_10005BE3:				; CODE XREF: sub_10005B8F+2Ej
		mov	ecx, [ebp+arg_0]
		mov	[ecx], esi

loc_10005BE8:				; CODE XREF: sub_10005B8F+52j
		pop	edi
		pop	esi
		mov	eax, ecx
		pop	ebx
		pop	ecx
		pop	ebp
		retn	8
sub_10005B8F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005BF2	proc near		; CODE XREF: sub_10005952+60p
					; sub_10005A18+35p ...

var_1		= byte ptr -1

		push	ecx
		mov	eax, dword_10031CE0
		push	ebx
		push	esi
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005C5B
		mov	ecx, offset dword_10031CE0
		call	sub_10002F24
		test	al, al
		jz	short loc_10005C5B
		xor	ebx, ebx
		push	ebx
		push	ebx
		mov	[esp+14h+var_1], bl
		mov	dword_10031CE4,	ebx
		mov	dword_10031CE8,	ebx
		call	sub_10005F16
		fld1
		mov	esi, offset dword_10031CE4
		push	8
		mov	ecx, esi
		mov	dword_10031CE4,	eax
		fstp	flt_10031D00
		mov	dword_10031CEC,	ebx
		mov	dword_10031CF0,	ebx
		mov	dword_10031CF4,	ebx
		call	sub_10005CD2
		mov	dword_10031CE0,	esi

loc_10005C5B:				; CODE XREF: sub_10005BF2+Dj
					; sub_10005BF2+1Bj
		mov	eax, dword_10031CE0
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_10005BF2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005C64	proc near		; CODE XREF: sub_10005B2F+Ep
					; sub_10005B8F+Dp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		and	[ebp+var_4], 0
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+arg_0]
		mov	eax, [eax]
		push	edi
		mov	[ebp+arg_0], eax
		mov	edi, [esi+14h]
		call	sub_10002ED5
		and	eax, edi
		cmp	[esi+18h], eax
		ja	short loc_10005C93
		shr	edi, 1
		or	ecx, 0FFFFFFFFh
		sub	ecx, edi
		add	eax, ecx

loc_10005C93:				; CODE XREF: sub_10005C64+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005C64	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005C9B	proc near		; CODE XREF: sub_10005B2F+52p
					; sub_10005FFC+8Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, ecx
		mov	edx, [eax]
		mov	[esp+8+arg_4], edx
		mov	esi, [eax+4]
		mov	edx, [eax]
		push	eax
		mov	[esi], edx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		dec	dword ptr [edi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+0Ch+arg_0]
		pop	ecx
		mov	ecx, [esp+8+arg_4]
		pop	edi
		mov	[eax], ecx
		pop	esi
		retn	8
sub_10005C9B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005CD2	proc near		; CODE XREF: sub_10005BF2+5Ep
					; sub_100060D9+62p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		push	edi
		mov	edi, ecx
		push	edx
		lea	edx, [esi+esi]
		push	edx
		mov	eax, [edi]
		lea	ecx, [edi+8]
		mov	[ebp+var_4], eax
		mov	eax, [ecx]
		push	eax
		mov	[ecx+4], eax
		lea	eax, [ebp+arg_0]
		push	eax
		call	sub_10005D0D
		lea	eax, [esi-1]
		mov	[edi+18h], esi
		mov	[edi+14h], eax
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005CD2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005D0D	proc near		; CODE XREF: sub_10005CD2+25p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		mov	eax, [esp+8+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	edi, eax
		sub	edi, [ebp+0]
		sar	edi, 2
		mov	[esp+18h+var_4], edi
		mov	edi, [esp+18h+arg_8]
		test	edi, edi
		jz	loc_10005EFD
		mov	esi, [ebp+8]
		mov	ecx, esi
		mov	ebx, [ebp+4]
		sub	ecx, ebx
		sar	ecx, 2
		cmp	ecx, edi
		jnb	loc_10005E3F
		sub	ebx, [ebp+0]
		mov	ecx, 3FFFFFFFh
		sar	ebx, 2
		sub	ecx, ebx
		cmp	ecx, edi
		jnb	short loc_10005D62
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10005D62:				; CODE XREF: sub_10005D0D+48j
		sub	esi, [ebp+0]
		lea	ecx, [ebx+edi]
		sar	esi, 2
		xor	ebx, ebx
		mov	[esp+18h+var_8], ecx
		mov	edx, esi
		shr	edx, 1
		mov	ecx, 3FFFFFFFh
		sub	ecx, edx
		cmp	ecx, esi
		jnb	short loc_10005D84
		mov	esi, ebx
		jmp	short loc_10005D86
; ---------------------------------------------------------------------------

loc_10005D84:				; CODE XREF: sub_10005D0D+71j
		add	esi, edx

loc_10005D86:				; CODE XREF: sub_10005D0D+75j
		mov	ecx, [esp+18h+var_8]
		cmp	esi, ecx
		jnb	short loc_10005D90
		mov	esi, ecx

loc_10005D90:				; CODE XREF: sub_10005D0D+7Fj
		test	esi, esi
		jz	short loc_10005DBB
		cmp	esi, 3FFFFFFFh
		ja	loc_10005E39
		mov	eax, esi
		shl	eax, 2
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	loc_10005E39
		mov	eax, [esp+18h+arg_4]

loc_10005DBB:				; CODE XREF: sub_10005D0D+85j
		mov	ecx, eax
		mov	edx, edi
		sub	ecx, [ebp+0]
		sar	ecx, 2
		mov	[esp+18h+var_8], ecx
		lea	ecx, [ebx+ecx*4]
		test	edi, edi
		jz	short loc_10005DEA
		mov	edi, [esp+18h+arg_C]

loc_10005DD4:				; CODE XREF: sub_10005D0D+D3j
		test	ecx, ecx
		jz	short loc_10005DDC
		mov	eax, [edi]
		mov	[ecx], eax

loc_10005DDC:				; CODE XREF: sub_10005D0D+C9j
		add	ecx, 4
		dec	edx
		jnz	short loc_10005DD4
		mov	eax, [esp+18h+arg_4]
		mov	edi, [esp+18h+arg_8]

loc_10005DEA:				; CODE XREF: sub_10005D0D+C1j
		push	ebx
		push	eax
		push	dword ptr [ebp+0]
		call	sub_10005FBE
		mov	eax, [esp+18h+var_8]
		add	eax, edi
		lea	eax, [ebx+eax*4]
		push	eax
		push	dword ptr [ebp+4]
		push	[esp+20h+arg_4]
		call	sub_10005FBE
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		sar	eax, 2
		add	edi, eax
		cmp	dword ptr [ebp+0], 0
		jz	short loc_10005E25
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10005E25:				; CODE XREF: sub_10005D0D+10Cj
		lea	eax, [ebx+esi*4]
		mov	[ebp+0], ebx
		mov	[ebp+8], eax
		lea	eax, [ebx+edi*4]
		mov	[ebp+4], eax
		jmp	loc_10005EFD
; ---------------------------------------------------------------------------

loc_10005E39:				; CODE XREF: sub_10005D0D+8Dj
					; sub_10005D0D+A4j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10005E3F:				; CODE XREF: sub_10005D0D+33j
		mov	esi, [esp+18h+arg_C]
		mov	ecx, ebx
		sub	ecx, eax
		sar	ecx, 2
		mov	esi, [esi]
		cmp	ecx, edi
		jnb	short loc_10005EB3
		mov	ecx, edi
		shl	ecx, 2
		mov	[esp+18h+arg_C], ecx
		add	ecx, eax
		push	ecx
		push	ebx
		push	eax
		call	sub_10005FBE
		mov	ecx, [ebp+4]
		mov	eax, ecx
		mov	edx, [esp+18h+arg_4]
		sub	eax, edx
		sar	eax, 2
		sub	edi, eax
		jz	short loc_10005E85

loc_10005E75:				; CODE XREF: sub_10005D0D+172j
		test	ecx, ecx
		jz	short loc_10005E7B
		mov	[ecx], esi

loc_10005E7B:				; CODE XREF: sub_10005D0D+16Aj
		add	ecx, 4
		dec	edi
		jnz	short loc_10005E75
		mov	edx, [esp+18h+arg_4]

loc_10005E85:				; CODE XREF: sub_10005D0D+166j
		mov	eax, [esp+18h+arg_C]
		xor	edi, edi
		add	[ebp+4], eax
		mov	ecx, [ebp+4]
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, edx
		add	eax, 3
		shr	eax, 2
		cmp	ecx, edx
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		jz	short loc_10005EFD

loc_10005EA7:				; CODE XREF: sub_10005D0D+1A2j
		inc	edi
		mov	[edx], esi
		lea	edx, [edx+4]
		cmp	edi, ecx
		jnz	short loc_10005EA7
		jmp	short loc_10005EFD
; ---------------------------------------------------------------------------

loc_10005EB3:				; CODE XREF: sub_10005D0D+141j
		mov	eax, edi
		mov	edi, ebx
		shl	eax, 2
		push	ebx
		sub	edi, eax
		mov	[esp+1Ch+arg_C], eax
		push	ebx
		push	edi
		call	sub_10005FBE
		mov	ecx, [esp+18h+arg_4]
		mov	[ebp+4], eax
		cmp	ecx, edi
		jz	short loc_10005EE5
		sub	ebx, edi

loc_10005ED5:				; CODE XREF: sub_10005D0D+1D6j
		sub	edi, 4
		mov	eax, [edi]
		mov	[edi+ebx], eax
		mov	ecx, [esp+18h+arg_4]
		cmp	ecx, edi
		jnz	short loc_10005ED5

loc_10005EE5:				; CODE XREF: sub_10005D0D+1C4j
		mov	edx, [esp+18h+arg_C]
		lea	eax, [edx+ecx]
		jmp	short loc_10005EF9
; ---------------------------------------------------------------------------

loc_10005EEE:				; CODE XREF: sub_10005D0D+1EEj
		mov	[ecx], esi
		add	ecx, 4
		mov	eax, [esp+18h+arg_4]
		add	eax, edx

loc_10005EF9:				; CODE XREF: sub_10005D0D+1DFj
		cmp	ecx, eax
		jnz	short loc_10005EEE

loc_10005EFD:				; CODE XREF: sub_10005D0D+1Ej
					; sub_10005D0D+127j ...
		mov	eax, [ebp+0]
		mov	ecx, [esp+18h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		lea	ecx, [eax+ecx*4]
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		mov	[eax], ecx
		pop	ecx
		pop	ecx
		retn	10h
sub_10005D0D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F16	proc near		; CODE XREF: sub_10005BF2+31p
					; sub_10005F49+Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	1Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_10005F29
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10005F29:				; CODE XREF: sub_10005F16+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_10005F37
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_10005F3B
; ---------------------------------------------------------------------------

loc_10005F37:				; CODE XREF: sub_10005F16+19j
		mov	edx, [esp+arg_4]

loc_10005F3B:				; CODE XREF: sub_10005F16+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_10005F46
		mov	[ecx], edx

locret_10005F46:			; CODE XREF: sub_10005F16+2Cj
		retn	8
sub_10005F16	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F49	proc near		; CODE XREF: sub_10005952+67p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	eax, [ebx]
		mov	ebp, [eax]
		push	dword ptr [ebp+4]
		push	ebp
		call	sub_10005F16
		mov	edx, eax
		lea	edi, [edx+8]
		test	edi, edi
		jz	short loc_10005F77
		mov	esi, [esp+10h+arg_4]
		mov	ecx, [esi]
		add	esi, 4
		mov	[edi], ecx
		add	edi, 4
		movsd
		movsd
		movsd
		movsd

loc_10005F77:				; CODE XREF: sub_10005F49+1Aj
		mov	ecx, [ebx+4]
		mov	eax, 9249248h
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_10005F91
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10005F91:				; CODE XREF: sub_10005F49+3Bj
		lea	eax, [ecx+1]
		mov	ecx, ebx
		mov	[ebx+4], eax
		mov	[ebp+4], edx
		mov	eax, [edx+4]
		mov	[eax], edx
		mov	eax, [ebx]
		mov	eax, [eax]
		push	eax
		add	eax, 8
		push	eax
		push	[esp+18h+arg_0]
		call	sub_10005FFC
		mov	eax, [esp+10h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10005F49	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005FBE	proc near		; CODE XREF: sub_10005D0D+E2p
					; sub_10005D0D+F8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_0]
		sub	eax, edx
		mov	ecx, [esp+arg_8]
		add	eax, 3
		push	esi
		xor	esi, esi
		shr	eax, 2
		cmp	[esp+4+arg_4], edx
		push	edi
		sbb	edi, edi
		not	edi
		and	edi, eax
		jz	short loc_10005FF5
		sub	edx, ecx

loc_10005FE4:				; CODE XREF: sub_10005FBE+35j
		test	ecx, ecx
		jz	short loc_10005FED
		mov	eax, [edx+ecx]
		mov	[ecx], eax

loc_10005FED:				; CODE XREF: sub_10005FBE+28j
		add	ecx, 4
		inc	esi
		cmp	esi, edi
		jnz	short loc_10005FE4

loc_10005FF5:				; CODE XREF: sub_10005FBE+22j
		pop	edi
		mov	eax, ecx
		pop	esi
		retn	0Ch
sub_10005FBE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005FFC	proc near		; CODE XREF: sub_10005F49+65p
					; sub_100060D9+81p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		push	edi
		mov	[esp+14h+var_4], ecx
		call	sub_10005C64
		mov	edx, [esp+10h+var_4]
		mov	ebx, eax
		mov	ecx, [edx+8]
		mov	esi, [edx]
		cmp	esi, [ecx+ebx*8]
		jz	short loc_1000603D
		mov	esi, [ecx+ebx*8+4]
		mov	esi, [esi]
		cmp	esi, [ecx+ebx*8]
		jz	short loc_1000603D
		mov	eax, [edi]

loc_10006030:				; CODE XREF: sub_10005FFC+3Fj
		mov	esi, [esi+4]
		cmp	[esi+8], eax
		jz	short loc_10006081
		cmp	esi, [ecx+ebx*8]
		jnz	short loc_10006030

loc_1000603D:				; CODE XREF: sub_10005FFC+25j
					; sub_10005FFC+30j
		mov	edi, [ebp+arg_8]
		mov	eax, [edi]
		cmp	esi, eax
		jz	short loc_1000606B
		mov	ecx, [edi+4]
		mov	[ecx], eax
		mov	ecx, [eax+4]
		mov	[ecx], esi
		mov	ecx, [esi+4]
		mov	[ecx], edi
		mov	edx, [esi+4]
		mov	ecx, [eax+4]
		mov	[esi+4], ecx
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi+4], edx
		mov	edx, [esp+10h+var_4]

loc_1000606B:				; CODE XREF: sub_10005FFC+48j
		mov	ecx, [edx+8]
		mov	eax, [ecx+ebx*8]
		cmp	eax, [edx]
		jnz	short loc_1000609B
		mov	[ecx+ebx*8], edi
		mov	eax, [edx+8]
		mov	[eax+ebx*8+4], edi
		jmp	short loc_100060C0
; ---------------------------------------------------------------------------

loc_10006081:				; CODE XREF: sub_10005FFC+3Aj
		push	[ebp+arg_8]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edx
		push	eax
		call	sub_10005C9B
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0
		jmp	short loc_100060D0
; ---------------------------------------------------------------------------

loc_1000609B:				; CODE XREF: sub_10005FFC+77j
		cmp	eax, esi
		jnz	short loc_100060A4
		mov	[ecx+ebx*8], edi
		jmp	short loc_100060C0
; ---------------------------------------------------------------------------

loc_100060A4:				; CODE XREF: sub_10005FFC+A1j
		mov	eax, [ecx+ebx*8+4]
		mov	eax, [eax]
		mov	[ecx+ebx*8+4], eax
		cmp	eax, edi
		jz	short loc_100060C0
		mov	ecx, [edx+8]
		mov	eax, [ecx+ebx*8+4]
		mov	eax, [eax+4]
		mov	[ecx+ebx*8+4], eax

loc_100060C0:				; CODE XREF: sub_10005FFC+83j
					; sub_10005FFC+A6j ...
		mov	ecx, edx
		call	sub_100060D9
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		mov	byte ptr [eax+4], 1

loc_100060D0:				; CODE XREF: sub_10005FFC+9Dj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10005FFC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100060D9	proc near		; CODE XREF: sub_10005FFC+C6p

var_C		= byte ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		mov	ebx, ecx
		fld	dword ptr [ebx+1Ch]
		mov	eax, [ebx+4]
		mov	edx, [ebx+18h]
		fild	dword ptr [ebx+4]
		test	eax, eax
		jns	short loc_100060F8
		fadd	ds:flt_1002DB58

loc_100060F8:				; CODE XREF: sub_100060D9+17j
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		mov	[ebp+var_4], edx
		fild	[ebp+var_4]
		test	edx, edx
		jns	short loc_1000610E
		fadd	ds:flt_1002DB58

loc_1000610E:				; CODE XREF: sub_100060D9+2Dj
		fstp	[ebp+var_4]
		fdiv	[ebp+var_4]
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		fcompp
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_10006165
		cmp	edx, 200h
		jnb	short loc_10006130
		shl	edx, 3
		jmp	short loc_1000613A
; ---------------------------------------------------------------------------

loc_10006130:				; CODE XREF: sub_100060D9+50j
		cmp	edx, 1FFFFFFFh
		jnb	short loc_1000613A
		add	edx, edx

loc_1000613A:				; CODE XREF: sub_100060D9+55j
					; sub_100060D9+5Dj
		push	edx
		call	sub_10005CD2
		mov	eax, [ebx]
		cmp	[eax], eax
		jz	short loc_10006165
		push	esi
		push	edi
		mov	edi, [eax+4]

loc_1000614B:				; CODE XREF: sub_100060D9+88j
		mov	esi, [ebx]
		mov	ecx, ebx
		mov	esi, [esi]
		push	esi
		lea	eax, [esi+8]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_10005FFC
		cmp	esi, edi
		jnz	short loc_1000614B
		pop	edi
		pop	esi

loc_10006165:				; CODE XREF: sub_100060D9+48j
					; sub_100060D9+6Bj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_100060D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000616A(HANDLE hSourceHandle)
sub_1000616A	proc near		; CODE XREF: sub_1001789C+18Ep
					; sub_1001789C+19Ep

TargetHandle	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	edi
		mov	edi, ecx
		xor	eax, eax
		mov	[ebp+TargetHandle], eax
		mov	ebx, edx
		test	edi, edi
		jz	short loc_100061B0
		push	2		; dwOptions
		push	eax		; bInheritHandle
		push	eax		; dwDesiredAccess
		mov	[ebp+TargetHandle], eax
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	edi		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_100061A6
		xor	al, al
		jmp	short loc_100061B2
; ---------------------------------------------------------------------------

loc_100061A6:				; CODE XREF: sub_1000616A+36j
		push	[ebp+TargetHandle]
		mov	ecx, ebx
		call	sub_100045FD

loc_100061B0:				; CODE XREF: sub_1000616A+12j
		mov	al, 1

loc_100061B2:				; CODE XREF: sub_1000616A+3Aj
		pop	edi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000616A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100061B8	proc near		; CODE XREF: sub_10006831+260p
					; sub_100083D0+586p ...
		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_10004633
		lea	ecx, [edi+4]
		call	sub_10004633
		and	dword ptr [edi+8], 0
		lea	ecx, [edi+4]
		and	dword ptr [edi+0Ch], 0
		call	sub_10004633
		mov	ecx, edi
		call	sub_10004633
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100061B8	endp


; =============== S U B	R O U T	I N E =======================================


sub_100061E5	proc near		; CODE XREF: sub_100061FE+4p
					; sub_10007EBC+15p ...
		xor	eax, eax
		cmp	[ecx+8], eax
		jnz	short loc_100061FA
		cmp	[ecx], eax
		jnz	short loc_100061FA
		cmp	[ecx+0Ch], eax
		jnz	short loc_100061FA
		cmp	[ecx+4], eax
		jz	short locret_100061FD

loc_100061FA:				; CODE XREF: sub_100061E5+5j
					; sub_100061E5+9j ...
		xor	eax, eax
		inc	eax

locret_100061FD:			; CODE XREF: sub_100061E5+13j
		retn
sub_100061E5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100061FE	proc near		; CODE XREF: sub_10006831+220p
					; sub_1001789C+107p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100061E5
		test	al, al
		jz	short loc_10006220
		call	sub_10004633
		lea	ecx, [edi+4]
		call	sub_10004633
		and	dword ptr [edi+8], 0
		and	dword ptr [edi+0Ch], 0

loc_10006220:				; CODE XREF: sub_100061FE+Bj
		mov	esi, [esp+8+arg_0]
		mov	ecx, edi
		push	dword ptr [esi]
		call	sub_100045FD
		push	dword ptr [esi+4]
		lea	ecx, [edi+4]
		call	sub_100045FD
		mov	eax, [esi+8]
		mov	[edi+8], eax
		mov	eax, [esi+0Ch]
		mov	[edi+0Ch], eax
		pop	edi
		pop	esi
		retn	4
sub_100061FE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006249	proc near		; CODE XREF: sub_100083D0+571p
					; sub_1001789C+1CEp

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	eax, eax
		push	edi
		mov	edi, esi
		mov	ebx, ecx
		stosd
		stosd
		stosd
		stosd
		call	sub_1000628A
		lea	ecx, [ebx+4]
		mov	[esi], eax
		call	sub_1000628A
		mov	ecx, [ebx+8]
		and	dword ptr [ebx+8], 0
		mov	[esi+8], ecx
		mov	ecx, [ebx+0Ch]
		and	dword ptr [ebx+0Ch], 0
		mov	[esi+4], eax
		mov	eax, esi
		pop	edi
		mov	[esi+0Ch], ecx
		pop	esi
		pop	ebx
		pop	ecx
		retn	4
sub_10006249	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000628A	proc near		; CODE XREF: sub_10006249+12p
					; sub_10006249+1Cp ...
		push	esi
		mov	esi, [ecx]
		and	dword ptr [ecx], 0
		test	esi, esi
		jz	short loc_100062A6
		cmp	esi, 0FFFFFFFFh
		jz	short loc_100062A6
		push	ecx
		push	ecx
		mov	edx, ecx
		mov	ecx, esi
		call	sub_10005A18
		pop	ecx
		pop	ecx

loc_100062A6:				; CODE XREF: sub_1000628A+8j
					; sub_1000628A+Dj
		mov	eax, esi
		pop	esi
		retn
sub_1000628A	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100062AA(void *Dst)
sub_100062AA	proc near		; CODE XREF: sub_100083D0+22Ep
		push	ebx
		push	esi
		push	edi
		push	48h
		pop	esi
		push	esi		; Size
		mov	ebx, ecx
		push	0		; Val
		push	ebx		; Dst
		call	memset
		add	esp, 0Ch
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jge	short loc_100062D0
		mov	dword ptr [ebx], 44h
		jmp	short loc_10006327
; ---------------------------------------------------------------------------

loc_100062D0:				; CODE XREF: sub_100062AA+1Cj
		cmp	dword_10031F34,	0
		mov	[ebx], esi
		jz	short loc_100062ED
		cmp	dword_10031F30,	0
		jz	short loc_100062ED
		cmp	dword_10031F38,	0
		jnz	short loc_10006327

loc_100062ED:				; CODE XREF: sub_100062AA+2Fj
					; sub_100062AA+38j
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		mov	esi, ds:GetProcAddress
		mov	edi, eax
		push	offset ProcName	; "InitializeProcThreadAttributeList"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	offset aUpdateprocthre ; "UpdateProcThreadAttribute"
		push	edi		; hModule
		mov	dword_10031F34,	eax
		call	esi ; GetProcAddress
		push	offset aDeleteprocthre ; "DeleteProcThreadAttributeList"
		push	edi		; hModule
		mov	dword_10031F30,	eax
		call	esi ; GetProcAddress
		mov	dword_10031F38,	eax

loc_10006327:				; CODE XREF: sub_100062AA+24j
					; sub_100062AA+41j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_100062AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000632D	proc near		; CODE XREF: sub_100083D0+306p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		cmp	dword ptr [esi], 48h
		jnz	short loc_10006384
		xor	edi, edi
		cmp	[esi+44h], edi
		jnz	short loc_10006384
		lea	eax, [ebp+var_4]
		mov	[ebp+var_4], edi
		push	eax
		push	edi
		push	[ebp+arg_0]
		push	edi
		call	dword_10031F34
		cmp	[ebp+var_4], edi
		jz	short loc_10006384
		push	[ebp+var_4]
		call	sub_10018CA2
		pop	ecx
		lea	ecx, [ebp+var_4]
		mov	[esi+44h], eax
		push	ecx
		push	edi
		push	[ebp+arg_0]
		push	eax
		call	dword_10031F34
		test	eax, eax
		jnz	short loc_1000638E
		push	dword ptr [esi+44h]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		mov	[esi+44h], edi

loc_10006384:				; CODE XREF: sub_1000632D+Bj
					; sub_1000632D+12j ...
		xor	al, al

loc_10006386:				; CODE XREF: sub_1000632D+63j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_1000638E:				; CODE XREF: sub_1000632D+48j
		mov	al, 1
		jmp	short loc_10006386
sub_1000632D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006392	proc near		; CODE XREF: sub_100083D0+32Dp
					; sub_100083D0+35Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword ptr [ecx+44h], 0
		jnz	short loc_1000639C
		xor	al, al
		jmp	short locret_100063BC
; ---------------------------------------------------------------------------

loc_1000639C:				; CODE XREF: sub_10006392+4j
		xor	eax, eax
		push	eax
		push	eax
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		push	eax
		push	dword ptr [ecx+44h]
		call	dword_10031F30
		neg	eax
		sbb	eax, eax
		neg	eax

locret_100063BC:			; CODE XREF: sub_10006392+8j
		retn	0Ch
sub_10006392	endp


; =============== S U B	R O U T	I N E =======================================


sub_100063BF	proc near		; CODE XREF: sub_100062AA+14p
					; sub_1000671B+Ep ...
		cmp	dword_10031F94,	0
		push	esi
		jnz	short loc_1000640C
		push	44h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100063E1
		mov	ecx, eax
		call	sub_10006413
		mov	esi, eax
		jmp	short loc_100063E3
; ---------------------------------------------------------------------------

loc_100063E1:				; CODE XREF: sub_100063BF+15j
		xor	esi, esi

loc_100063E3:				; CODE XREF: sub_100063BF+20j
		mov	ecx, esi
		mov	edx, offset dword_10031F94
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_1000640C
		test	esi, esi
		jz	short loc_1000640C
		push	0		; Size
		push	1		; char
		lea	ecx, [esi+2Ch]
		call	sub_10001883
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000640C:				; CODE XREF: sub_100063BF+8j
					; sub_100063BF+33j ...
		mov	eax, dword_10031F94
		pop	esi
		retn
sub_100063BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006413	proc near		; CODE XREF: sub_100063BF+19p

var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
SystemInfo	= _SYSTEM_INFO ptr -14Ch
VersionInformation= _OSVERSIONINFOW ptr	-128h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 158h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+158h+var_4], eax
		and	[esp+158h+var_154], 0
		push	esi
		mov	esi, ecx
		push	edi
		and	dword ptr [esi], 0
		mov	dword ptr [esi+1Ch], 3
		call	ds:GetCurrentProcess
		push	offset aIswow64process ; "IsWow64Process"
		push	offset ModuleName ; "kernel32.dll"
		mov	edi, eax
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10006482
		and	[esp+160h+var_150], 0
		lea	ecx, [esp+160h+var_150]
		push	ecx
		push	edi
		call	eax
		test	eax, eax
		jnz	short loc_10006479
		push	2
		pop	eax
		jmp	short loc_10006482
; ---------------------------------------------------------------------------

loc_10006479:				; CODE XREF: sub_10006413+5Fj
		xor	eax, eax
		cmp	[esp+160h+var_150], eax
		setnz	al

loc_10006482:				; CODE XREF: sub_10006413+4Ej
					; sub_10006413+64j
		mov	[esi+28h], eax
		xor	eax, eax
		mov	[esi+3Ch], eax
		push	118h		; Size
		push	eax		; Val
		mov	dword ptr [esi+40h], 0Fh
		mov	[esi+2Ch], al
		lea	eax, [esp+168h+VersionInformation.dwMajorVersion]
		push	eax		; Dst
		mov	[esp+16Ch+VersionInformation.dwOSVersionInfoSize], 11Ch
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+160h+VersionInformation]
		push	eax		; lpVersionInformation
		call	ds:GetVersionExW
		mov	eax, [esp+160h+VersionInformation.dwBuildNumber]
		mov	edx, [esp+160h+VersionInformation.dwMajorVersion]
		mov	ecx, [esp+160h+VersionInformation.dwMinorVersion]
		push	6
		mov	[esi+0Ch], eax
		pop	eax
		push	5
		pop	edi
		mov	[esi+4], edx
		mov	[esi+8], ecx
		cmp	edx, edi
		jnz	short loc_100064EA
		test	ecx, ecx
		jle	short loc_10006515
		xor	eax, eax
		cmp	ecx, 1
		setnz	al
		inc	eax

loc_100064E6:				; CODE XREF: sub_10006413+E4j
		mov	[esi], eax
		jmp	short loc_10006515
; ---------------------------------------------------------------------------

loc_100064EA:				; CODE XREF: sub_10006413+C4j
		cmp	edx, eax
		jnz	short loc_1000650D
		sub	ecx, 0
		jz	short loc_10006505
		dec	ecx
		jz	short loc_100064FD
		dec	ecx
		jnz	short loc_100064E6
		mov	[esi], edi
		jmp	short loc_10006515
; ---------------------------------------------------------------------------

loc_100064FD:				; CODE XREF: sub_10006413+E1j
		mov	dword ptr [esi], 4
		jmp	short loc_10006515
; ---------------------------------------------------------------------------

loc_10006505:				; CODE XREF: sub_10006413+DEj
		mov	dword ptr [esi], 3
		jmp	short loc_10006515
; ---------------------------------------------------------------------------

loc_1000650D:				; CODE XREF: sub_10006413+D9j
		jle	short loc_10006515
		mov	dword ptr [esi], 7

loc_10006515:				; CODE XREF: sub_10006413+C8j
					; sub_10006413+D5j ...
		movzx	eax, [esp+160h+var_14]
		lea	edi, [esp+160h+SystemInfo.dwPageSize]
		and	dword ptr [esp+160h+SystemInfo.anonymous_0], 0
		mov	[esi+14h], eax
		movzx	eax, [esp+160h+var_12]
		push	8
		mov	[esi+18h], eax
		xor	eax, eax
		pop	ecx
		rep stosd
		lea	eax, [esp+160h+SystemInfo]
		push	eax		; lpSystemInfo
		call	ds:GetNativeSystemInfo
		mov	ecx, dword ptr [esp+160h+SystemInfo.anonymous_0]
		movzx	eax, cx
		push	9
		pop	edx
		test	eax, eax
		jz	short loc_1000656F
		cmp	eax, 6
		jz	short loc_10006566
		cmp	eax, edx
		jnz	short loc_10006573
		mov	dword ptr [esi+1Ch], 1
		jmp	short loc_10006573
; ---------------------------------------------------------------------------

loc_10006566:				; CODE XREF: sub_10006413+144j
		mov	dword ptr [esi+1Ch], 2
		jmp	short loc_10006573
; ---------------------------------------------------------------------------

loc_1000656F:				; CODE XREF: sub_10006413+13Fj
		and	dword ptr [esi+1Ch], 0

loc_10006573:				; CODE XREF: sub_10006413+148j
					; sub_10006413+151j ...
		cmp	[esp+160h+VersionInformation.dwMajorVersion], 6
		mov	eax, [esp+160h+SystemInfo.dwNumberOfProcessors]
		mov	[esi+20h], eax
		mov	eax, [esp+160h+SystemInfo.dwAllocationGranularity]
		mov	[esi+24h], eax
		jnz	loc_1000661A
		push	offset aGetproductinfo ; "GetProductInfo"
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		lea	ecx, [esp+160h+var_154]
		push	ecx
		push	0
		push	0
		push	[esp+16Ch+VersionInformation.dwMinorVersion]
		push	[esp+170h+VersionInformation.dwMajorVersion]
		call	eax
		mov	eax, [esp+160h+var_154]
		cmp	eax, 0Fh
		ja	short loc_100065F4
		cmp	eax, 0Ch
		jnb	short loc_10006611
		cmp	eax, 1
		jz	short loc_10006608
		cmp	eax, 4
		jz	short loc_10006608
		cmp	eax, 6
		jz	short loc_10006608
		jbe	short loc_100065DA
		cmp	eax, 0Ah
		jbe	short loc_10006611

loc_100065DA:				; CODE XREF: sub_10006413+1C0j
					; sub_10006413+1E4j ...
		and	dword ptr [esi+10h], 0

loc_100065DE:				; CODE XREF: sub_10006413+1FCj
					; sub_10006413+205j ...
		mov	ecx, [esp+160h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_100065F4:				; CODE XREF: sub_10006413+1AAj
		cmp	eax, 11h
		jb	short loc_100065DA
		cmp	eax, 12h
		jbe	short loc_10006611
		cmp	eax, 19h
		jz	short loc_10006611
		cmp	eax, 30h
		jnz	short loc_100065DA

loc_10006608:				; CODE XREF: sub_10006413+1B4j
					; sub_10006413+1B9j ...
		mov	dword ptr [esi+10h], 1
		jmp	short loc_100065DE
; ---------------------------------------------------------------------------

loc_10006611:				; CODE XREF: sub_10006413+1AFj
					; sub_10006413+1C5j ...
		mov	dword ptr [esi+10h], 2
		jmp	short loc_100065DE
; ---------------------------------------------------------------------------

loc_1000661A:				; CODE XREF: sub_10006413+173j
		cmp	[esp+160h+VersionInformation.dwMajorVersion], 5
		jnz	short loc_100065DA
		cmp	[esp+160h+VersionInformation.dwMinorVersion], 2
		jnz	short loc_1000664D
		cmp	[esp+160h+var_E], 1
		jnz	short loc_10006637
		cmp	cx, dx
		jz	short loc_10006608

loc_10006637:				; CODE XREF: sub_10006413+21Dj
		mov	ax, [esp+160h+var_10]
		not	ax
		movzx	eax, ax
		shr	eax, 0Eh
		and	eax, 2
		jmp	short loc_10006668
; ---------------------------------------------------------------------------

loc_1000664D:				; CODE XREF: sub_10006413+213j
		cmp	[esp+160h+VersionInformation.dwMinorVersion], 1
		jnz	short loc_100065DA
		mov	ax, [esp+160h+var_10]
		not	ax
		movzx	eax, ax
		shr	eax, 9
		and	eax, 1

loc_10006668:				; CODE XREF: sub_10006413+238j
		mov	[esi+10h], eax
		jmp	loc_100065DE
sub_10006413	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006670	proc near		; DATA XREF: sub_10006831+12Bo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+14h]
		and	ecx, 0FFFFF9FFh
		or	ecx, 800h
		mov	[eax+14h], ecx
		retn
sub_10006670	endp

; ---------------------------------------------------------------------------

loc_10006687:				; DATA XREF: sub_10006831+126o
		mov	eax, [esp+4]
		or	dword ptr [eax+14h], 8
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_10006690(HANDLE hProcess, LPCVOID lpBaseAddress)
sub_10006690	proc near		; CODE XREF: sub_1000671B+10Ap

Buffer		= byte ptr -48h
lpBaseAddress	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
var_14		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		lea	eax, [ebp+NumberOfBytesRead]
		mov	esi, ecx
		push	eax		; lpNumberOfBytesRead
		push	30h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	edx		; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100066BD

loc_100066B9:				; CODE XREF: sub_10006690+31j
					; sub_10006690+37j ...
		xor	al, al
		jmp	short loc_1000670C
; ---------------------------------------------------------------------------

loc_100066BD:				; CODE XREF: sub_10006690+27j
		cmp	[ebp+NumberOfBytesRead], 30h
		jnz	short loc_100066B9
		cmp	[ebp+var_2C], 0
		jnz	short loc_100066B9
		cmp	[ebp+var_1C], 0
		jnz	short loc_100066B9
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+lpBaseAddress] ; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100066B9
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100066B9
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+var_20]	; lpBaseAddress
		push	esi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_100066B9
		cmp	[ebp+NumberOfBytesRead], 10h
		setz	al

loc_1000670C:				; CODE XREF: sub_10006690+2Bj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10006690	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000671B	proc near		; CODE XREF: sub_1000E01D+C0p

TargetHandle	= dword	ptr -40h
var_3C		= dword	ptr -3Ch
NumberOfBytesWritten= dword ptr	-38h
Buffer		= dword	ptr -34h
Dst		= byte ptr -30h
var_2C		= dword	ptr -2Ch

		sub	esp, 40h
		push	ebp
		push	esi
		push	edi
		xor	ebp, ebp
		mov	edi, ecx
		mov	[esp+4Ch+NumberOfBytesWritten],	ebp
		call	sub_100063BF
		cmp	dword ptr [eax+28h], 1
		jz	short loc_1000673B
		mov	al, 1
		jmp	loc_1000682A
; ---------------------------------------------------------------------------

loc_1000673B:				; CODE XREF: sub_1000671B+17j
		mov	esi, ds:CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		call	esi ; CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		mov	[edi+8], eax
		call	esi ; CreateEventW
		mov	[edi+0Ch], eax
		call	ds:GetCurrentProcess
		mov	ecx, [edi]
		mov	esi, eax
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		lea	eax, [esp+58h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ecx]	; hTargetProcessHandle
		push	dword ptr [edi+8] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10006782

loc_1000677B:				; CODE XREF: sub_1000671B+83j
					; sub_1000671B+9Dj ...
		xor	al, al
		jmp	loc_1000682A
; ---------------------------------------------------------------------------

loc_10006782:				; CODE XREF: sub_1000671B+5Ej
		mov	eax, [edi]
		lea	ecx, [esp+4Ch+var_3C]
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	ecx		; lpTargetHandle
		push	dword ptr [eax]	; hTargetProcessHandle
		push	dword ptr [edi+0Ch] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000677B
		mov	eax, [edi]
		mov	ecx, 1000h
		push	40h		; flProtect
		push	ecx		; flAllocationType
		push	ecx		; dwSize
		push	ebp		; lpAddress
		push	dword ptr [eax]	; hProcess
		call	ds:VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000677B
		push	2Ch		; Size
		lea	eax, [esp+50h+Dst]
		push	ebp		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [esp+58h+TargetHandle]
		lea	ecx, [esp+58h+NumberOfBytesWritten]
		add	esp, 0Ch
		mov	[esp+4Ch+Buffer], eax
		mov	eax, [esp+4Ch+var_3C]
		mov	[esp+4Ch+var_2C], eax
		mov	eax, [edi]
		push	ecx		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	ecx, [esp+54h+Buffer]
		push	ecx		; lpBuffer
		push	esi		; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000677B
		cmp	[esp+4Ch+NumberOfBytesWritten],	10h
		jnz	loc_1000677B
		push	esi
		mov	ecx, edi
		call	sub_10006831
		test	al, al
		jz	loc_1000677B
		mov	ecx, edi
		call	sub_10006AE8
		test	al, al
		jz	loc_1000677B
		mov	eax, [edi]
		mov	edx, esi	; lpBaseAddress
		mov	ecx, [eax]	; hProcess
		call	sub_10006690

loc_1000682A:				; CODE XREF: sub_1000671B+1Bj
					; sub_1000671B+62j
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 40h
		retn
sub_1000671B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006831	proc near		; CODE XREF: sub_1000671B+E8p

hHandle		= dword	ptr -360h
var_35C		= dword	ptr -35Ch
var_358		= byte ptr -358h
var_354		= dword	ptr -354h
var_350		= dword	ptr -350h
ExitCode	= dword	ptr -34Ch
ProcessInformation= _PROCESS_INFORMATION ptr -348h
StartupInfo	= _STARTUPINFOW	ptr -338h
var_2F0		= byte ptr -2F0h
var_2E0		= byte ptr -2E0h
var_2D8		= byte ptr -2D8h
var_288		= byte ptr -288h
Dst		= dword	ptr -240h
var_238		= byte ptr -238h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
Str		= dword	ptr -228h
var_214		= dword	ptr -214h
Filename	= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 360h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+360h+var_4], eax
		mov	eax, [esp+360h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+370h+var_350], eax
		xor	ebx, ebx
		push	104h		; nSize
		lea	eax, [esp+374h+Filename]
		mov	ebp, ecx
		push	eax		; lpFilename
		push	ebx		; hModule
		call	ds:GetModuleFileNameW
		lea	eax, [esp+370h+Filename]
		push	eax		; Src
		lea	ecx, [esp+374h+Dst] ; Dst
		call	sub_10001C68
		mov	ecx, offset asc_1002BB98 ; "\\"
		call	sub_10001ADC
		mov	esi, eax
		test	esi, esi
		jz	loc_10006923
		mov	ecx, [esp+370h+var_230]
		test	ecx, ecx
		jz	loc_10006923
		cmp	ecx, 0FFFFFFFFh
		jbe	short loc_100068AD
		or	ecx, 0FFFFFFFFh
		jmp	short loc_100068AE
; ---------------------------------------------------------------------------

loc_100068AD:				; CODE XREF: sub_10006831+75j
		dec	ecx

loc_100068AE:				; CODE XREF: sub_10006831+7Aj
		cmp	[esp+370h+var_22C], 8
		mov	edx, [esp+370h+Dst]
		mov	eax, edx
		jnb	short loc_100068C8
		lea	eax, [esp+370h+Dst]

loc_100068C8:				; CODE XREF: sub_10006831+8Ej
		lea	eax, [eax+ecx*2]

loc_100068CB:				; CODE XREF: sub_10006831+D9j
		test	esi, esi
		jz	short loc_100068F0
		movzx	ebx, word ptr [eax]
		mov	edi, esi
		mov	ecx, offset asc_1002BB98 ; "\\"

loc_100068D9:				; CODE XREF: sub_10006831+B1j
		cmp	[ecx], bx
		jz	short loc_100068EA
		add	ecx, 2
		dec	edi
		jnz	short loc_100068D9
		xor	ebx, ebx
		mov	ecx, ebx
		jmp	short loc_100068EC
; ---------------------------------------------------------------------------

loc_100068EA:				; CODE XREF: sub_10006831+ABj
		xor	ebx, ebx

loc_100068EC:				; CODE XREF: sub_10006831+B7j
		test	ecx, ecx
		jnz	short loc_1000690C

loc_100068F0:				; CODE XREF: sub_10006831+9Cj
		cmp	[esp+370h+var_22C], 8
		mov	ecx, edx
		jnb	short loc_10006903
		lea	ecx, [esp+370h+Dst]

loc_10006903:				; CODE XREF: sub_10006831+C9j
		cmp	eax, ecx
		jz	short loc_10006923
		sub	eax, 2
		jmp	short loc_100068CB
; ---------------------------------------------------------------------------

loc_1000690C:				; CODE XREF: sub_10006831+BDj
		cmp	[esp+370h+var_22C], 8
		jnb	short loc_1000691D
		lea	edx, [esp+370h+Dst]

loc_1000691D:				; CODE XREF: sub_10006831+E3j
		sub	eax, edx
		sar	eax, 1
		jmp	short loc_10006926
; ---------------------------------------------------------------------------

loc_10006923:				; CODE XREF: sub_10006831+5Dj
					; sub_10006831+6Cj ...
		or	eax, 0FFFFFFFFh

loc_10006926:				; CODE XREF: sub_10006831+F0j
		cmp	eax, 0FFFFFFFFh
		jz	loc_10006ABB
		inc	eax
		lea	ecx, [esp+370h+Dst]
		push	eax
		call	sub_10003B46
		push	ecx
		push	ecx
		lea	ecx, [esp+378h+var_2F0]
		call	sub_10006BBC
		push	[esp+370h+var_350]
		mov	eax, [ebp+0]
		push	ecx
		push	dword ptr [eax+8]
		push	ecx
		push	offset loc_10006687
		push	offset sub_10006670
		lea	ecx, [esp+388h+var_2E0]
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		mov	edx, offset asc_1002BBC4 ; "\""
		mov	ecx, eax
		call	sub_10007418
		lea	edx, [esp+378h+var_238]
		mov	ecx, eax
		call	sub_1000754F
		mov	edx, offset aWow_helper_exe ; "wow_helper.exe\"	"
		mov	ecx, eax
		call	sub_10007418
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		mov	ecx, eax
		call	sub_10007665
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		lea	eax, [esp+370h+Str]
		push	eax
		lea	ecx, [esp+374h+var_2D8]
		call	sub_1000725C
		cmp	[esp+370h+var_214], 8
		mov	eax, [esp+370h+Str]
		jnb	short loc_100069E1
		lea	eax, [esp+370h+Str]

loc_100069E1:				; CODE XREF: sub_10006831+1A7j
		push	eax		; Str
		call	ds:_wcsdup
		pop	ecx
		push	ebx
		push	1
		lea	ecx, [esp+378h+Str]
		mov	esi, eax
		call	sub_100022FA
		push	40h		; Size
		lea	eax, [esp+374h+StartupInfo.lpReserved]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		xor	eax, eax
		mov	[esp+37Ch+StartupInfo.cb], 44h
		lea	edi, [esp+37Ch+ProcessInformation]
		add	esp, 0Ch
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+370h+ProcessInformation]
		push	eax		; lpProcessInformation
		lea	eax, [esp+374h+StartupInfo]
		push	eax		; lpStartupInfo
		push	ebx		; lpCurrentDirectory
		push	ebx		; lpEnvironment
		push	ebx		; dwCreationFlags
		push	ebx		; bInheritHandles
		push	ebx		; lpThreadAttributes
		push	ebx		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	ebx		; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_10006A96
		lea	eax, [esp+370h+ProcessInformation]
		mov	[esp+370h+hHandle], ebx
		push	eax
		lea	ecx, [esp+374h+hHandle]
		mov	[esp+374h+var_35C], ebx
		mov	dword ptr [esp+374h+var_358], ebx
		mov	[esp+374h+var_354], ebx
		call	sub_100061FE
		push	0FFFFFFFFh	; dwMilliseconds
		push	[esp+374h+hHandle] ; hHandle
		call	ds:WaitForSingleObject
		mov	edi, eax
		lea	eax, [esp+370h+ExitCode]
		push	eax		; lpExitCode
		push	[esp+374h+hHandle] ; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		setnz	al
		cmp	edi, 102h
		jz	short loc_10006A8D
		test	al, al
		jz	short loc_10006A8D
		cmp	[esp+370h+ExitCode], 0
		jnz	short loc_10006A8D
		mov	bl, 1

loc_10006A8D:				; CODE XREF: sub_10006831+24Dj
					; sub_10006831+251j ...
		lea	ecx, [esp+370h+hHandle]
		call	sub_100061B8

loc_10006A96:				; CODE XREF: sub_10006831+205j
		test	esi, esi
		jz	short loc_10006AA2
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_10006AA2:				; CODE XREF: sub_10006831+267j
		lea	ecx, [esp+370h+var_288]
		call	sub_10006C20
		lea	ecx, [esp+370h+var_288]
		call	ds:??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::~basic_ios<wchar_t,std::char_traits<wchar_t>>(void)

loc_10006ABB:				; CODE XREF: sub_10006831+F8j
		push	0
		push	1
		lea	ecx, [esp+378h+Dst]
		call	sub_100022FA
		mov	ecx, [esp+370h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 360h
		retn	4
sub_10006831	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006AE8	proc near		; CODE XREF: sub_1000671B+F7p

NumberOfBytesRead= dword ptr -210h
Buffer		= byte ptr -20Ch
var_8		= dword	ptr -8

		sub	esp, 210h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+210h+var_8], eax
		and	[esp+210h+NumberOfBytesRead], 0
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; hThread
		call	ds:ResumeThread
		cmp	eax, 1
		jnz	loc_10006B9E
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject
		mov	ebp, 102h
		jmp	short loc_10006B9A
; ---------------------------------------------------------------------------

loc_10006B2B:				; CODE XREF: sub_10006AE8+B4j
		cmp	eax, 80h
		jz	short loc_10006B9E
		push	dword ptr [esi+8] ; hEvent
		call	ds:ResetEvent
		test	eax, eax
		jz	short loc_10006B9E
		mov	eax, [esi]
		lea	ecx, [esp+21Ch+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	200h		; nSize
		lea	ecx, [esp+224h+Buffer]
		push	ecx		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_10006B63

loc_10006B5F:				; CODE XREF: sub_10006AE8+83j
		xor	bl, bl
		jmp	short loc_10006B7E
; ---------------------------------------------------------------------------

loc_10006B63:				; CODE XREF: sub_10006AE8+75j
		cmp	[esp+21Ch+NumberOfBytesRead], 200h
		jnz	short loc_10006B5F
		mov	eax, [esi]
		mov	bl, 1
		push	dword ptr [eax+4] ; hThread
		call	ds:SuspendThread
		test	eax, eax
		jnz	short loc_10006B9E

loc_10006B7E:				; CODE XREF: sub_10006AE8+79j
		push	dword ptr [esi+0Ch] ; hEvent
		call	ds:SetEvent
		test	eax, eax
		jz	short loc_10006B9E
		test	bl, bl
		jnz	short loc_10006BB8
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject

loc_10006B9A:				; CODE XREF: sub_10006AE8+41j
		cmp	eax, ebp
		jnz	short loc_10006B2B

loc_10006B9E:				; CODE XREF: sub_10006AE8+2Bj
					; sub_10006AE8+48j ...
		xor	al, al

loc_10006BA0:				; CODE XREF: sub_10006AE8+D2j
		mov	ecx, [esp+21Ch+var_8]
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 210h
		retn
; ---------------------------------------------------------------------------

loc_10006BB8:				; CODE XREF: sub_10006AE8+A5j
		mov	al, 1
		jmp	short loc_10006BA0
sub_10006AE8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006BBC	proc near		; CODE XREF: sub_10006831+115p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		mov	[esp+10h+var_4], ebx
		lea	ecx, [edi+68h]
		mov	dword ptr [edi], offset	dword_1002BBC8
		mov	dword ptr [edi+10h], offset dword_1002BC10
		call	ds:??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::basic_ios<wchar_t,std::char_traits<wchar_t>>(void)
		push	ebx
		lea	esi, [edi+18h]
		mov	ecx, edi
		push	esi
		call	ds:??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z ;	std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::basic_iostream<wchar_t,std::char_traits<wchar_t>>(std::basic_streambuf<wchar_t,std::char_traits<wchar_t>> *)
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1002BC0C
		mov	eax, [edi]
		mov	ecx, [eax+4]
		lea	eax, [ecx-68h]
		mov	[ecx+edi-4], eax
		mov	ecx, esi
		call	ds:??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
		mov	eax, edi
		mov	[esi+38h], ebx
		pop	edi
		mov	[esi+3Ch], ebx
		mov	dword ptr [esi], offset	off_1002BBD0
		pop	esi
		pop	ebx
		pop	ecx
		retn	8
sub_10006BBC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C20	proc near		; CODE XREF: sub_10006831+278p
					; sub_10007838-61Dp
		push	esi
		mov	esi, ecx
		mov	eax, [esi-68h]
		lea	ecx, [esi-50h]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-68h], offset	off_1002BC0C
		mov	eax, [esi-68h]
		mov	edx, [eax+4]
		lea	eax, [edx-68h]
		mov	[edx+esi-6Ch], eax
		call	sub_10006C50
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ ; std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::~basic_iostream<wchar_t,std::char_traits<wchar_t>>(void)
sub_10006C20	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C50	proc near		; CODE XREF: sub_10006C20+21p
					; sub_1000723F+3p
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 1
		mov	dword ptr [esi], offset	off_1002BBD0
		jz	short loc_10006C6B
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10006C6B:				; CODE XREF: sub_10006C50+Dj
		mov	eax, [esi+0Ch]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], ecx
		mov	eax, [esi+10h]
		mov	[eax], ecx
		mov	eax, [esi+20h]
		mov	[eax], ecx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		and	dword ptr [esi+3Ch], 0FFFFFFFEh
		mov	[esi+38h], ecx
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
sub_10006C50	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C9B	proc near		; DATA XREF: .rdata:1002BBDCo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10006CAF
		mov	eax, 0FFFFh
		jmp	loc_10006E72
; ---------------------------------------------------------------------------

loc_10006CAF:				; CODE XREF: sub_10006C9B+8j
		push	ebp
		mov	bp, word ptr [esp+0Ch+arg_0]
		push	edi
		mov	edi, 0FFFFh
		cmp	di, bp
		jnz	short loc_10006CC7
		xor	eax, eax
		jmp	loc_10006E70
; ---------------------------------------------------------------------------

loc_10006CC7:				; CODE XREF: sub_10006C9B+23j
		test	byte ptr [esi+3Ch], 8
		jz	short loc_10006CF5
		mov	edi, [esi+20h]
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_10006CF0
		mov	edx, [esi+38h]
		cmp	ecx, edx
		jnb	short loc_10006CF0
		mov	eax, [esi+30h]
		mov	eax, [eax]
		mov	[edi], edx
		lea	ecx, [ecx+eax*2]
		mov	eax, [esi+30h]
		sub	ecx, edx
		sar	ecx, 1
		mov	[eax], ecx

loc_10006CF0:				; CODE XREF: sub_10006C9B+39j
					; sub_10006C9B+40j
		mov	edi, 0FFFFh

loc_10006CF5:				; CODE XREF: sub_10006C9B+30j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10006D1D
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		lea	ecx, [edx+ecx*2]
		cmp	edx, ecx
		jnb	short loc_10006D1D
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp
		jmp	loc_10006E70
; ---------------------------------------------------------------------------

loc_10006D1D:				; CODE XREF: sub_10006C9B+61j
					; sub_10006C9B+6Dj
		push	ebx
		test	edx, edx
		jnz	short loc_10006D26
		xor	ebx, ebx
		jmp	short loc_10006D36
; ---------------------------------------------------------------------------

loc_10006D26:				; CODE XREF: sub_10006C9B+85j
		mov	eax, [esi+30h]
		mov	ebx, [eax]
		mov	eax, [esi+0Ch]
		add	ebx, ebx
		sub	ebx, [eax]
		add	ebx, edx
		sar	ebx, 1

loc_10006D36:				; CODE XREF: sub_10006C9B+89j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_10006D47
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10006D5A

loc_10006D47:				; CODE XREF: sub_10006C9B+A4j
					; sub_10006C9B+B9j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_10006D56
		shr	ecx, 1
		jnz	short loc_10006D47

loc_10006D56:				; CODE XREF: sub_10006C9B+B5j
		test	ecx, ecx
		jnz	short loc_10006D62

loc_10006D5A:				; CODE XREF: sub_10006C9B+AAj
		mov	ax, di
		jmp	loc_10006E6F
; ---------------------------------------------------------------------------

loc_10006D62:				; CODE XREF: sub_10006C9B+BDj
		lea	eax, [ecx+ebx]
		push	eax
		mov	[esp+18h+var_4], eax
		call	sub_10002640
		mov	ecx, [esi+0Ch]
		mov	edi, eax
		mov	ecx, [ecx]
		mov	[esp+14h+arg_0], ecx
		test	ebx, ebx
		jz	short loc_10006D91
		mov	edx, ecx	; Src
		mov	ecx, edi	; Dst
		push	ebx		; int
		call	sub_10001AFC
		pop	ecx
		mov	ecx, [esp+14h+arg_0]
		test	ebx, ebx
		jnz	short loc_10006DCD

loc_10006D91:				; CODE XREF: sub_10006C9B+E1j
		mov	eax, [esi+10h]
		mov	ecx, [esp+14h+var_4]
		mov	ebx, [esp+14h+arg_0]
		add	ecx, ecx
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		sar	ecx, 1
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], ecx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_10006E1C
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	loc_10006E4F
; ---------------------------------------------------------------------------

loc_10006DCD:				; CODE XREF: sub_10006C9B+F4j
		mov	eax, [esi+38h]
		sub	eax, ecx
		mov	ebx, [esp+14h+arg_0]
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	eax, [eax]
		sub	eax, ecx
		mov	ecx, [esi+10h]
		sar	eax, 1
		lea	edx, [edi+eax*2]
		mov	eax, [ecx]
		sub	eax, ebx
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[ecx], eax
		mov	eax, [esi+20h]
		mov	ecx, [esp+14h+var_4]
		add	ecx, ecx
		sub	ecx, edx
		mov	[eax], edx
		add	ecx, edi
		mov	eax, [esi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10006E28
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_10006E1C:				; CODE XREF: sub_10006C9B+120j
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		sar	edi, 1
		mov	[eax], edi
		jmp	short loc_10006E4F
; ---------------------------------------------------------------------------

loc_10006E28:				; CODE XREF: sub_10006C9B+177j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		sub	eax, ebx
		sar	eax, 1
		lea	ecx, [edi+eax*2]
		mov	eax, [esi+0Ch]
		sub	edx, ecx
		add	edx, 2
		sar	edx, 1
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10006E4F:				; CODE XREF: sub_10006C9B+12Dj
					; sub_10006C9B+18Bj
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10006E5D
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10006E5D:				; CODE XREF: sub_10006C9B+1B8j
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp

loc_10006E6F:				; CODE XREF: sub_10006C9B+C2j
		pop	ebx

loc_10006E70:				; CODE XREF: sub_10006C9B+27j
					; sub_10006C9B+7Dj
		pop	edi
		pop	ebp

loc_10006E72:				; CODE XREF: sub_10006C9B+Fj
		pop	esi
		pop	ecx
		retn	4
sub_10006C9B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006E77	proc near		; DATA XREF: .rdata:1002BBE0o

arg_0		= word ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		mov	ebx, 0FFFFh
		push	edi
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10006EC7
		mov	eax, [esi+0Ch]
		cmp	ecx, [eax]
		jbe	short loc_10006EC7
		mov	di, [esp+0Ch+arg_0]
		cmp	bx, di
		jz	short loc_10006EA7
		cmp	di, [ecx-2]
		jz	short loc_10006EA7
		test	byte ptr [esi+3Ch], 2
		jnz	short loc_10006EC7

loc_10006EA7:				; CODE XREF: sub_10006E77+22j
					; sub_10006E77+28j
		push	0FFFFFFFFh
		mov	ecx, esi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		cmp	bx, di
		jz	short loc_10006EC3
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		mov	[eax], di
		movzx	eax, di
		jmp	short loc_10006ECA
; ---------------------------------------------------------------------------

loc_10006EC3:				; CODE XREF: sub_10006E77+3Dj
		xor	eax, eax
		jmp	short loc_10006ECA
; ---------------------------------------------------------------------------

loc_10006EC7:				; CODE XREF: sub_10006E77+11j
					; sub_10006E77+18j ...
		mov	ax, bx

loc_10006ECA:				; CODE XREF: sub_10006E77+4Aj
					; sub_10006E77+4Ej
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10006E77	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006ED0	proc near		; DATA XREF: .rdata:1002BBE8o
		mov	edx, ecx
		push	esi
		push	edi
		mov	edi, [edx+1Ch]
		mov	esi, [edi]
		test	esi, esi
		jnz	short loc_10006EE4
		mov	eax, 0FFFFh
		jmp	short loc_10006F2F
; ---------------------------------------------------------------------------

loc_10006EE4:				; CODE XREF: sub_10006ED0+Bj
		push	ebx
		mov	ebx, [edx+2Ch]
		mov	ecx, [ebx]
		lea	ecx, [esi+ecx*2]
		cmp	esi, ecx
		jnb	short loc_10006EF6
		mov	ax, [esi]
		jmp	short loc_10006F2E
; ---------------------------------------------------------------------------

loc_10006EF6:				; CODE XREF: sub_10006ED0+1Fj
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_10006F29
		mov	eax, [edx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10006F29
		cmp	eax, esi
		ja	short loc_10006F0E
		cmp	[edx+38h], esi
		jbe	short loc_10006F29

loc_10006F0E:				; CODE XREF: sub_10006ED0+37j
		cmp	[edx+38h], eax
		jnb	short loc_10006F16
		mov	[edx+38h], eax

loc_10006F16:				; CODE XREF: sub_10006ED0+41j
		mov	eax, [edx+38h]
		sub	eax, [edi]
		sar	eax, 1
		mov	[ebx], eax
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	ax, [eax]
		jmp	short loc_10006F2E
; ---------------------------------------------------------------------------

loc_10006F29:				; CODE XREF: sub_10006ED0+2Aj
					; sub_10006ED0+33j ...
		mov	eax, 0FFFFh

loc_10006F2E:				; CODE XREF: sub_10006ED0+24j
					; sub_10006ED0+57j
		pop	ebx

loc_10006F2F:				; CODE XREF: sub_10006ED0+12j
		pop	edi
		pop	esi
		retn
sub_10006ED0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006F32	proc near		; DATA XREF: .rdata:1002BBF8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	edx, [ebx+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_10006F4A
		cmp	[ebx+38h], eax
		jnb	short loc_10006F4A
		mov	[ebx+38h], eax

loc_10006F4A:				; CODE XREF: sub_10006F32+Ej
					; sub_10006F32+13j
		test	[esp+14h+arg_10], 1
		jz	loc_10007029
		mov	eax, [ebx+1Ch]
		mov	esi, [eax]
		mov	[esp+14h+var_4], esi
		test	esi, esi
		jz	loc_10007029
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10006F7A
		mov	eax, [ebx+38h]
		jmp	short loc_10006F88
; ---------------------------------------------------------------------------

loc_10006F7A:				; CODE XREF: sub_10006F32+41j
		cmp	eax, 1
		jnz	short loc_10006F9E
		test	[esp+14h+arg_10], 2
		jnz	short loc_10006FA2
		mov	eax, esi

loc_10006F88:				; CODE XREF: sub_10006F32+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10006FB2
; ---------------------------------------------------------------------------

loc_10006F9E:				; CODE XREF: sub_10006F32+4Bj
		test	eax, eax
		jz	short loc_10006FAA

loc_10006FA2:				; CODE XREF: sub_10006F32+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10006FB2
; ---------------------------------------------------------------------------

loc_10006FAA:				; CODE XREF: sub_10006F32+6Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10006FB2:				; CODE XREF: sub_10006F32+6Aj
					; sub_10006F32+76j
		test	edi, edi
		jl	loc_100070B7
		jg	short loc_10006FC4
		test	esi, esi
		jb	loc_100070B7

loc_10006FC4:				; CODE XREF: sub_10006F32+88j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	loc_100070B7
		jl	short loc_10006FE3
		cmp	esi, eax
		ja	loc_100070B7

loc_10006FE3:				; CODE XREF: sub_10006F32+A7j
		sub	ecx, [esp+14h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+14h+arg_10], 2
		jz	loc_100070D7
		mov	edx, [ebx+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_100070D7
		mov	eax, [ebx+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [ebx+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	loc_100070D7
; ---------------------------------------------------------------------------

loc_10007029:				; CODE XREF: sub_10006F32+1Dj
					; sub_10006F32+2Ej
		test	[esp+14h+arg_10], 2
		jz	loc_100070BF
		cmp	dword ptr [edx], 0
		jz	loc_100070BF
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10007051
		mov	eax, [ebx+38h]
		jmp	short loc_10007058
; ---------------------------------------------------------------------------

loc_10007051:				; CODE XREF: sub_10006F32+118j
		cmp	eax, 1
		jnz	short loc_1000706E
		mov	eax, [edx]

loc_10007058:				; CODE XREF: sub_10006F32+11Dj
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10007082
; ---------------------------------------------------------------------------

loc_1000706E:				; CODE XREF: sub_10006F32+122j
		test	eax, eax
		jz	short loc_1000707A
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10007082
; ---------------------------------------------------------------------------

loc_1000707A:				; CODE XREF: sub_10006F32+13Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10007082:				; CODE XREF: sub_10006F32+13Aj
					; sub_10006F32+146j
		test	edi, edi
		jl	short loc_100070B7
		jg	short loc_1000708C
		test	esi, esi
		jb	short loc_100070B7

loc_1000708C:				; CODE XREF: sub_10006F32+154j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	short loc_100070B7
		jl	short loc_100070A3
		cmp	esi, eax
		ja	short loc_100070B7

loc_100070A3:				; CODE XREF: sub_10006F32+16Bj
		mov	eax, [ebx+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_100070D7
; ---------------------------------------------------------------------------

loc_100070B7:				; CODE XREF: sub_10006F32+82j
					; sub_10006F32+8Cj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_100070D7
; ---------------------------------------------------------------------------

loc_100070BF:				; CODE XREF: sub_10006F32+FCj
					; sub_10006F32+105j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_100070D7
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_100070D7:				; CODE XREF: sub_10006F32+C7j
					; sub_10006F32+D4j ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_10006F32	endp


; =============== S U B	R O U T	I N E =======================================


sub_100070F3	proc near		; DATA XREF: .rdata:1002BBFCo

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= byte ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_4]
		add	esi, [esp+14h+arg_C]
		push	edi
		adc	ebx, [esp+18h+arg_10]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_1000711C
		cmp	[edi+38h], eax
		jnb	short loc_1000711C
		mov	[edi+38h], eax

loc_1000711C:				; CODE XREF: sub_100070F3+1Fj
					; sub_100070F3+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_10007138
		cmp	ebx, ebp
		jz	loc_100071F5

loc_10007138:				; CODE XREF: sub_100070F3+3Bj
		test	[esp+18h+arg_1C], 1
		jz	short loc_100071B0
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_100071AE
		test	ebx, ebx
		jl	short loc_100071A8
		jg	short loc_10007156
		test	esi, esi
		jb	short loc_100071A8

loc_10007156:				; CODE XREF: sub_100070F3+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_100071A8
		jl	short loc_1000716D
		cmp	esi, eax
		ja	short loc_100071A8

loc_1000716D:				; CODE XREF: sub_100070F3+74j
		sub	ecx, [esp+18h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+18h+arg_1C], 2
		jz	short loc_100071F5
		mov	edx, [edi+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	short loc_100071F5
		mov	eax, [edi+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	short loc_100071F5
; ---------------------------------------------------------------------------

loc_100071A8:				; CODE XREF: sub_100070F3+5Bj
					; sub_100070F3+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_100071F3
; ---------------------------------------------------------------------------

loc_100071AE:				; CODE XREF: sub_100070F3+57j
		mov	eax, ecx

loc_100071B0:				; CODE XREF: sub_100070F3+4Aj
		test	[esp+18h+arg_1C], 2
		jz	short loc_100071F1
		cmp	dword ptr [edx], 0
		jz	short loc_100071F1
		test	ebx, ebx
		jl	short loc_100071A8
		jg	short loc_100071C6
		test	esi, esi
		jb	short loc_100071A8

loc_100071C6:				; CODE XREF: sub_100070F3+CDj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_100071A8
		jl	short loc_100071DD
		cmp	esi, eax
		ja	short loc_100071A8

loc_100071DD:				; CODE XREF: sub_100070F3+E4j
		mov	eax, [edi+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_100071F5
; ---------------------------------------------------------------------------

loc_100071F1:				; CODE XREF: sub_100070F3+C2j
					; sub_100070F3+C7j
		mov	esi, eax

loc_100071F3:				; CODE XREF: sub_100070F3+B9j
		mov	ebx, ebp

loc_100071F5:				; CODE XREF: sub_100070F3+3Fj
					; sub_100070F3+90j ...
		mov	eax, [esp+18h+arg_0]
		pop	edi
		and	dword ptr [eax+8], 0
		and	dword ptr [eax+0Ch], 0
		and	dword ptr [eax+10h], 0
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_100070F3	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10007838

loc_10007213:				; CODE XREF: sub_10007838+3j
		push	esi
		push	edi
		lea	edi, [ecx-68h]
		lea	ecx, [edi+68h]
		call	sub_10006C20
		lea	ecx, [edi+68h]
		call	ds:??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::~basic_ios<wchar_t,std::char_traits<wchar_t>>(void)
		test	[esp+8+arg_0], 1
		jz	short loc_10007238
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007238:				; CODE XREF: sub_10007838-60Aj
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
; END OF FUNCTION CHUNK	FOR sub_10007838

; =============== S U B	R O U T	I N E =======================================


sub_1000723F	proc near		; DATA XREF: .rdata:off_1002BBD0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10006C50
		test	[esp+4+arg_0], 1
		jz	short loc_10007256
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007256:				; CODE XREF: sub_1000723F+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_1000723F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000725C	proc near		; CODE XREF: sub_10006831+193p

Src		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	edx, ecx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_1000729E
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000729E
		cmp	[edx+38h], ecx
		jb	short loc_1000728A
		mov	ecx, [edx+38h]

loc_1000728A:				; CODE XREF: sub_1000725C+29j
		mov	eax, [edx+10h]
		sub	ecx, [eax]
		sar	ecx, 1
		push	ecx		; int
		push	dword ptr [eax]	; Src

loc_10007294:				; CODE XREF: sub_1000725C+65j
		lea	ecx, [ebp+Src]
		call	sub_10002BC9
		jmp	short loc_100072D4
; ---------------------------------------------------------------------------

loc_1000729E:				; CODE XREF: sub_1000725C+1Bj
					; sub_1000725C+24j
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_100072C3
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_100072C3
		mov	eax, [edx+0Ch]
		mov	ecx, [eax]
		mov	eax, [edx+2Ch]
		mov	eax, [eax]
		add	eax, eax
		sub	eax, ecx
		add	eax, edi
		sar	eax, 1
		push	eax
		push	ecx
		jmp	short loc_10007294
; ---------------------------------------------------------------------------

loc_100072C3:				; CODE XREF: sub_1000725C+46j
					; sub_1000725C+4Fj
		and	[ebp+var_10], 0
		xor	eax, eax
		mov	[ebp+var_C], 7
		mov	[ebp+Src], ax

loc_100072D4:				; CODE XREF: sub_1000725C+40j
		lea	eax, [ebp+Src]
		mov	ecx, esi
		push	eax		; Src
		call	sub_1000346E
		push	0
		push	1
		lea	ecx, [ebp+Src]
		call	sub_100022FA
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000725C	endp


; =============== S U B	R O U T	I N E =======================================


sub_100072FF	proc near		; CODE XREF: sub_10007418+4Cp
					; sub_1000754F+3Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		mov	[edi], esi
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	ecx, [eax+esi+38h]
		test	ecx, ecx
		jz	short loc_1000731B
		mov	eax, [ecx]
		call	dword ptr [eax+4]

loc_1000731B:				; CODE XREF: sub_100072FF+15j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_10007339
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_10007339
		cmp	ecx, esi
		jz	short loc_10007339
		call	ds:?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::flush(void)

loc_10007339:				; CODE XREF: sub_100072FF+26j
					; sub_100072FF+2Ej ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100072FF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007350	proc near		; CODE XREF: sub_10007418+128p
					; sub_1000754F+107p ...
		push	esi
		mov	esi, ecx
		mov	ecx, [esi]
		call	ds:?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ	; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::_Osfx(void)
		mov	ecx, [esi]
		pop	esi
		mov	eax, [ecx]
		mov	eax, [eax+4]
		mov	ecx, [eax+ecx+38h]
		test	ecx, ecx
		jz	short locret_10007370
		mov	eax, [ecx]
		jmp	dword ptr [eax+8]
; ---------------------------------------------------------------------------

locret_10007370:			; CODE XREF: sub_10007350+19j
		retn
sub_10007350	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10007371	proc near		; CODE XREF: sub_10007665+7Ap

var_8		= byte ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		xor	esi, esi
		push	esi
		lea	ecx, [ebp+var_8]
		call	ds:??0_Lockit@std@@QAE@H@Z ; std::_Lockit::_Lockit(int)
		mov	eax, dword_10031F48
		mov	ecx, ds:?id@?$ctype@_W@std@@2V0locale@2@A ; std::locale::id std::ctype<wchar_t>::id
		mov	[ebp+var_4], eax
		call	ds:??Bid@locale@std@@QAEIXZ ; std::locale::id::operator	uint(void)
		mov	edi, eax
		mov	eax, [ebx]
		cmp	edi, [eax+0Ch]
		jnb	short loc_100073AC
		mov	ecx, [eax+8]
		mov	ecx, [ecx+edi*4]
		jmp	short loc_100073AE
; ---------------------------------------------------------------------------

loc_100073AC:				; CODE XREF: sub_10007371+31j
		mov	ecx, esi

loc_100073AE:				; CODE XREF: sub_10007371+39j
		test	ecx, ecx
		jnz	short loc_100073CA
		cmp	[eax+14h], cl
		jz	short loc_100073CA
		call	ds:?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ ; std::locale::_Getgloballocale(void)
		cmp	edi, [eax+0Ch]
		jnb	short loc_100073CC
		mov	eax, [eax+8]
		mov	esi, [eax+edi*4]
		jmp	short loc_100073CC
; ---------------------------------------------------------------------------

loc_100073CA:				; CODE XREF: sub_10007371+3Fj
					; sub_10007371+44j
		mov	esi, ecx

loc_100073CC:				; CODE XREF: sub_10007371+4Fj
					; sub_10007371+57j
		test	esi, esi
		jnz	short loc_10007406
		mov	esi, [ebp+var_4]
		test	esi, esi
		jnz	short loc_10007406
		lea	eax, [ebp+var_4]
		push	ebx
		push	eax
		call	ds:?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z ; std::ctype<wchar_t>::_Getcat(std::locale::facet const * *,std::locale const *)
		pop	ecx
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100073EF
		call	ds:abort
; ---------------------------------------------------------------------------

loc_100073EF:				; CODE XREF: sub_10007371+76j
		mov	esi, [ebp+var_4]
		mov	ecx, esi
		mov	dword_10031F48,	esi
		mov	edx, [esi]
		call	dword ptr [edx+4]
		push	esi		; struct std::_Facet_base *
		call	?_Facet_Register@std@@YAXPAV_Facet_base@1@@Z ; std::_Facet_Register(std::_Facet_base *)
		pop	ecx

loc_10007406:				; CODE XREF: sub_10007371+5Dj
					; sub_10007371+64j
		lea	ecx, [ebp+var_8]
		call	ds:??1_Lockit@std@@QAE@XZ ; std::_Lockit::~_Lockit(void)
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007371	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007418	proc near		; CODE XREF: sub_10006831+14Cp
					; sub_10006831+166p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	eax, edx
		xor	ebp, ebp
		push	edi
		mov	edi, ecx
		mov	[esp+24h+var_10], eax
		mov	ecx, eax
		call	sub_10001ADC
		mov	esi, [edi]
		mov	[esp+24h+var_14], eax
		mov	edx, [esi+4]
		mov	ebx, [edx+edi+24h]
		mov	esi, [edx+edi+20h]
		test	ebx, ebx
		jl	short loc_1000745B
		jg	short loc_10007455
		test	esi, esi
		jz	short loc_1000745B
		test	ebx, ebx
		jl	short loc_1000745B
		jg	short loc_10007455
		cmp	esi, eax
		jbe	short loc_1000745B

loc_10007455:				; CODE XREF: sub_10007418+2Dj
					; sub_10007418+37j
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_1000745F
; ---------------------------------------------------------------------------

loc_1000745B:				; CODE XREF: sub_10007418+2Bj
					; sub_10007418+31j ...
		xor	esi, esi
		xor	ebx, ebx

loc_1000745F:				; CODE XREF: sub_10007418+41j
		push	edi
		lea	ecx, [esp+28h+var_C]
		call	sub_100072FF
		cmp	[esp+24h+var_8], 0
		jnz	short loc_10007478
		push	4
		pop	ebp
		jmp	loc_1000752C
; ---------------------------------------------------------------------------

loc_10007478:				; CODE XREF: sub_10007418+56j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100074C0
		test	ebx, ebx
		jl	short loc_100074C0
		jle	short loc_100074BC

loc_10007491:				; CODE XREF: sub_10007418+A0j
					; sub_10007418+A6j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000751A
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_10007491
		jl	short loc_100074C0

loc_100074BC:				; CODE XREF: sub_10007418+77j
		test	esi, esi
		jnz	short loc_10007491

loc_100074C0:				; CODE XREF: sub_10007418+71j
					; sub_10007418+75j ...
		mov	eax, [edi]
		push	0
		push	[esp+28h+var_14]
		mov	eax, [eax+4]
		push	[esp+2Ch+var_10]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+24h+var_14]
		jnz	short loc_1000751A
		test	edx, edx
		jnz	short loc_1000751A
		test	ebx, ebx
		jl	short loc_1000751D
		jle	short loc_10007514

loc_100074E9:				; CODE XREF: sub_10007418+F8j
					; sub_10007418+FEj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000751A
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100074E9
		jl	short loc_1000751D

loc_10007514:				; CODE XREF: sub_10007418+CFj
		test	esi, esi
		jnz	short loc_100074E9
		jmp	short loc_1000751D
; ---------------------------------------------------------------------------

loc_1000751A:				; CODE XREF: sub_10007418+96j
					; sub_10007418+C5j ...
		push	4
		pop	ebp

loc_1000751D:				; CODE XREF: sub_10007418+CDj
					; sub_10007418+FAj ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_1000752C:				; CODE XREF: sub_10007418+5Bj
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_10007350
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10007418	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000754F	proc near		; CODE XREF: sub_10006831+15Ap

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		push	edi
		xor	ebx, ebx
		mov	eax, [esi]
		mov	ecx, [ebp+10h]
		mov	[esp+24h+var_10], ecx
		mov	edi, [eax+4]
		cmp	[edi+esi+24h], ebx
		jl	short loc_10007582
		jg	short loc_10007576
		cmp	[edi+esi+20h], ebx
		jbe	short loc_10007582

loc_10007576:				; CODE XREF: sub_1000754F+1Fj
		mov	edi, [edi+esi+20h]
		cmp	edi, ecx
		jbe	short loc_10007582
		sub	edi, ecx
		jmp	short loc_10007584
; ---------------------------------------------------------------------------

loc_10007582:				; CODE XREF: sub_1000754F+1Dj
					; sub_1000754F+25j ...
		xor	edi, edi

loc_10007584:				; CODE XREF: sub_1000754F+31j
		push	esi
		lea	ecx, [esp+28h+var_C]
		call	sub_100072FF
		cmp	[esp+24h+var_8], bl
		jnz	short loc_1000759C
		push	4
		pop	ebx
		jmp	loc_10007642
; ---------------------------------------------------------------------------

loc_1000759C:				; CODE XREF: sub_1000754F+43j
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	eax, [eax+esi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100075D5
		test	edi, edi
		jz	short loc_100075D5

loc_100075B3:				; CODE XREF: sub_1000754F+84j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007626
		dec	edi
		jnz	short loc_100075B3

loc_100075D5:				; CODE XREF: sub_1000754F+5Ej
					; sub_1000754F+62j
		cmp	dword ptr [ebp+14h], 8
		jb	short loc_100075DE
		mov	ebp, [ebp+0]

loc_100075DE:				; CODE XREF: sub_1000754F+8Aj
		mov	eax, [esi]
		push	0
		push	[esp+28h+var_10]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+esi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+24h+var_10]
		jnz	short loc_10007630
		test	edx, edx
		jnz	short loc_10007630

loc_100075FE:				; CODE XREF: sub_1000754F+DAj
		test	edi, edi
		jz	short loc_10007633

loc_10007602:				; CODE XREF: sub_1000754F+D3j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000762B
		dec	edi
		jnz	short loc_10007602
		jmp	short loc_10007633
; ---------------------------------------------------------------------------

loc_10007626:				; CODE XREF: sub_1000754F+81j
		push	4
		pop	ebx
		jmp	short loc_100075FE
; ---------------------------------------------------------------------------

loc_1000762B:				; CODE XREF: sub_1000754F+D0j
		or	ebx, 4
		jmp	short loc_10007633
; ---------------------------------------------------------------------------

loc_10007630:				; CODE XREF: sub_1000754F+A9j
					; sub_1000754F+ADj
		push	4
		pop	ebx

loc_10007633:				; CODE XREF: sub_1000754F+B1j
					; sub_1000754F+D5j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		and	dword ptr [eax+esi+20h], 0
		and	dword ptr [eax+esi+24h], 0

loc_10007642:				; CODE XREF: sub_1000754F+48j
		mov	eax, [esi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, esi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_10007350
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1000754F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007665	proc near		; CODE XREF: sub_10006831+176p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 2Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	esi, esi
		and	[esp+3Ch+var_24], esi
		xor	ecx, ecx
		inc	ecx
		mov	[esp+3Ch+var_28], esi
		mov	[esp+3Ch+var_18], ecx
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	ebp, [eax+edi+24h]
		mov	ebx, [eax+edi+20h]
		test	ebp, ebp
		jl	short loc_100076A6
		jg	short loc_100076A0
		test	ebx, ebx
		jz	short loc_100076A6
		test	ebp, ebp
		jl	short loc_100076A6
		jg	short loc_100076A0
		cmp	ebx, ecx
		jbe	short loc_100076A6

loc_100076A0:				; CODE XREF: sub_10007665+2Bj
					; sub_10007665+35j
		sub	ebx, ecx
		sbb	ebp, esi
		jmp	short loc_100076AA
; ---------------------------------------------------------------------------

loc_100076A6:				; CODE XREF: sub_10007665+29j
					; sub_10007665+2Fj ...
		xor	ebx, ebx
		xor	ebp, ebp

loc_100076AA:				; CODE XREF: sub_10007665+3Fj
		push	edi
		lea	ecx, [esp+40h+var_C]
		mov	[esp+40h+var_1C], ebp
		mov	[esp+40h+var_20], ebx
		call	sub_100072FF
		cmp	[esp+3Ch+var_8], 0
		jnz	short loc_100076CB
		push	4
		pop	esi
		jmp	loc_10007815
; ---------------------------------------------------------------------------

loc_100076CB:				; CODE XREF: sub_10007665+5Cj
		lea	eax, [esp+3Ch+var_14]
		push	eax
		mov	eax, [edi]
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?getloc@ios_base@std@@QBE?AVlocale@2@XZ ; std::ios_base::getloc(void)
		mov	ecx, eax
		call	sub_10007371
		mov	ecx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_10], eax
		test	ecx, ecx
		jz	short loc_10007701
		mov	edx, [ecx]
		call	dword ptr [edx+8]
		test	eax, eax
		jz	short loc_10007701
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

loc_10007701:				; CODE XREF: sub_10007665+89j
					; sub_10007665+92j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_10007755
		test	ebp, ebp
		jl	short loc_10007755
		jle	short loc_10007751

loc_1000771A:				; CODE XREF: sub_10007665+E8j
					; sub_10007665+EEj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	loc_10007803
		add	ebx, 0FFFFFFFFh
		mov	[esp+3Ch+var_20], ebx
		adc	ebp, 0FFFFFFFFh
		mov	[esp+3Ch+var_1C], ebp
		test	ebp, ebp
		jg	short loc_1000771A
		jl	short loc_10007755

loc_10007751:				; CODE XREF: sub_10007665+B3j
		test	ebx, ebx
		jnz	short loc_1000771A

loc_10007755:				; CODE XREF: sub_10007665+ADj
					; sub_10007665+B1j ...
		mov	ecx, [esp+3Ch+var_24]
		xor	eax, eax
		mov	ebp, [esp+3Ch+var_10]
		inc	eax
		mov	ebx, offset asc_1002BB9C ; " "

loc_10007765:				; CODE XREF: sub_10007665+159j
		test	ecx, ecx
		jl	short loc_100077C0
		jg	short loc_1000776F
		test	eax, eax
		jz	short loc_100077C0

loc_1000776F:				; CODE XREF: sub_10007665+104j
		mov	eax, [edi]
		mov	ecx, ebp
		mov	eax, [eax+4]
		mov	esi, [eax+edi+38h]
		movzx	eax, byte ptr [ebx]
		push	eax
		call	ds:?widen@?$ctype@_W@std@@QBE_WD@Z ; std::ctype<wchar_t>::widen(char)
		movzx	eax, ax
		mov	ecx, esi
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	esi, [esp+3Ch+var_28]
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jnz	short loc_100077A5
		or	esi, 4
		mov	[esp+3Ch+var_28], esi

loc_100077A5:				; CODE XREF: sub_10007665+137j
		mov	eax, [esp+3Ch+var_18]
		mov	ecx, [esp+3Ch+var_24]
		add	eax, 0FFFFFFFFh
		mov	[esp+3Ch+var_18], eax
		adc	ecx, 0FFFFFFFFh
		inc	ebx
		mov	[esp+3Ch+var_24], ecx
		test	esi, esi
		jz	short loc_10007765

loc_100077C0:				; CODE XREF: sub_10007665+102j
					; sub_10007665+108j
		mov	ebx, [esp+3Ch+var_20]
		mov	ebp, [esp+3Ch+var_1C]
		test	esi, esi
		jnz	short loc_10007806
		test	ebp, ebp
		jl	short loc_10007806
		jle	short loc_100077FD

loc_100077D2:				; CODE XREF: sub_10007665+194j
					; sub_10007665+19Aj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007803
		add	ebx, 0FFFFFFFFh
		adc	ebp, 0FFFFFFFFh
		test	ebp, ebp
		jg	short loc_100077D2
		jl	short loc_10007806

loc_100077FD:				; CODE XREF: sub_10007665+16Bj
		test	ebx, ebx
		jnz	short loc_100077D2
		jmp	short loc_10007806
; ---------------------------------------------------------------------------

loc_10007803:				; CODE XREF: sub_10007665+D2j
					; sub_10007665+18Aj
		push	4
		pop	esi

loc_10007806:				; CODE XREF: sub_10007665+165j
					; sub_10007665+169j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10007815:				; CODE XREF: sub_10007665+61j
		mov	eax, [edi]
		push	0
		push	esi
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+3Ch+var_C]
		call	sub_10007350
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 2Ch
		retn
sub_10007665	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007838	proc near		; DATA XREF: .rdata:off_1002BC0Co

arg_0		= byte ptr  4

; FUNCTION CHUNK AT 10007213 SIZE 0000002C BYTES

		sub	ecx, [ecx-4]
		jmp	loc_10007213
sub_10007838	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007840(HANDLE TokenHandle)
sub_10007840	proc near		; CODE XREF: sub_100078FE+1Dp

var_8		= dword	ptr -8
ReturnLength	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, edx
		xor	ecx, ecx
		mov	[ebp+var_8], ecx
		test	edi, edi
		jnz	short loc_10007859

loc_10007855:				; CODE XREF: sub_10007840+30j
		xor	al, al
		jmp	short loc_100078AA
; ---------------------------------------------------------------------------

loc_10007859:				; CODE XREF: sub_10007840+13j
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], ecx
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:GetTokenInformation
		mov	esi, [ebp+ReturnLength]
		test	esi, esi
		jz	short loc_10007855
		push	esi		; Size
		call	ds:malloc
		pop	ecx
		mov	ecx, [ebx]
		and	dword ptr [ebx], 0
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_10007894
		push	ecx		; Memory
		call	ds:free
		mov	esi, [ebp+ReturnLength]
		mov	eax, [ebp+var_8]
		pop	ecx

loc_10007894:				; CODE XREF: sub_10007840+44j
		lea	ecx, [ebp+ReturnLength]
		mov	[ebx], eax
		push	ecx		; ReturnLength
		push	esi		; TokenInformationLength
		push	eax		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		setnz	al

loc_100078AA:				; CODE XREF: sub_10007840+17j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007840	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100078B1	proc near		; CODE XREF: sub_100078FE+3Ep
					; sub_10007988+5Fp

pListOfExplicitEntries=	_EXPLICIT_ACCESS_W ptr -24h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
NewAcl		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	esi
		push	edi
		push	7
		xor	eax, eax
		lea	edi, [ebp+pListOfExplicitEntries.grfAccessMode]
		mov	esi, ecx
		pop	ecx
		push	[ebp+NewAcl]	; NewAcl
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	[ebp+pListOfExplicitEntries.grfAccessMode], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+pListOfExplicitEntries.grfAccessPermissions], eax
		xor	eax, eax
		mov	[ebp+pListOfExplicitEntries.grfInheritance], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.pMultipleTrustee], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.MultipleTrusteeOperation], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.TrusteeForm], eax
		lea	eax, [ebp+pListOfExplicitEntries]
		push	edx		; OldAcl
		push	eax		; pListOfExplicitEntries
		push	1		; cCountOfExplicitEntries
		mov	[ebp+pListOfExplicitEntries.Trustee.ptstrName],	esi
		call	ds:SetEntriesInAclW
		neg	eax
		pop	edi
		sbb	al, al
		inc	al
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100078B1	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100078FE(HANDLE TokenHandle)
sub_100078FE	proc near		; CODE XREF: sub_10012ACB+1F4p
					; sub_10012ACB+24Dp

hMem		= dword	ptr -0Ch
Memory		= dword	ptr -8
TokenInformation= dword	ptr -4

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebp, edx
		test	edi, edi
		jnz	short loc_10007911
		xor	al, al
		jmp	short loc_10007980
; ---------------------------------------------------------------------------

loc_10007911:				; CODE XREF: sub_100078FE+Dj
		xor	ebx, ebx
		lea	edx, [esp+20h+Memory]
		mov	[esp+20h+Memory], ebx
		call	sub_10007840
		mov	esi, [esp+20h+Memory]
		test	al, al
		jz	short loc_10007972
		lea	eax, [esp+20h+hMem]
		mov	[esp+20h+hMem],	ebx
		mov	edx, [esi]
		mov	ecx, ebp
		push	eax
		push	10000000h
		push	1
		call	sub_100078B1
		add	esp, 0Ch
		test	al, al
		jz	short loc_10007972
		mov	eax, [esp+20h+hMem]
		push	4		; TokenInformationLength
		mov	[esp+24h+TokenInformation], eax
		lea	eax, [esp+24h+TokenInformation]
		push	eax		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:SetTokenInformation
		push	[esp+20h+hMem]	; hMem
		mov	edi, eax
		call	ds:LocalFree
		cmp	edi, 1
		setz	bl

loc_10007972:				; CODE XREF: sub_100078FE+28j
					; sub_100078FE+48j
		test	esi, esi
		jz	short loc_1000797E
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_1000797E:				; CODE XREF: sub_100078FE+76j
		mov	al, bl

loc_10007980:				; CODE XREF: sub_100078FE+11j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_100078FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_10007988@<eax>(HANDLE handle@<ecx>, PSID pSourceSid)
sub_10007988	proc near		; CODE XREF: sub_100189A5+135p

ppDacl		= dword	ptr -5Ch
pDacl		= dword	ptr -58h
ppSecurityDescriptor= dword ptr	-54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
pSourceSid	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+pSourceSid]
		lea	eax, [ebp+ppSecurityDescriptor]
		push	eax		; ppSecurityDescriptor
		xor	ebx, ebx
		lea	eax, [ebp+ppDacl]
		push	ebx		; ppSacl
		push	eax		; ppDacl
		push	ebx		; ppsidGroup
		push	ebx		; ppsidOwner
		push	4		; SecurityInfo
		mov	esi, ecx
		mov	[ebp+ppSecurityDescriptor], ebx
		push	7		; ObjectType
		push	esi		; handle
		mov	[ebp+ppDacl], ebx
		mov	[ebp+pDacl], ebx
		call	ds:GetSecurityInfo
		test	eax, eax
		jz	short loc_100079C9

loc_100079C5:				; CODE XREF: sub_10007988+74j
		xor	al, al
		jmp	short loc_10007A26
; ---------------------------------------------------------------------------

loc_100079C9:				; CODE XREF: sub_10007988+3Bj
		push	edi		; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		mov	edx, [ebp+ppDacl]
		lea	eax, [ebp+pDacl]
		push	eax
		push	0D013Eh
		push	3
		lea	ecx, [ebp+pDestinationSid]
		call	sub_100078B1
		add	esp, 0Ch
		test	al, al
		jnz	short loc_100079FE
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	ds:LocalFree
		jmp	short loc_100079C5
; ---------------------------------------------------------------------------

loc_100079FE:				; CODE XREF: sub_10007988+69j
		push	ebx		; pSacl
		push	[ebp+pDacl]	; pDacl
		push	ebx		; psidGroup
		push	ebx		; psidOwner
		push	4		; SecurityInfo
		push	7		; ObjectType
		push	esi		; handle
		call	ds:SetSecurityInfo
		push	[ebp+pDacl]	; hMem
		mov	esi, ds:LocalFree
		mov	edi, eax
		call	esi ; LocalFree
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	esi ; LocalFree
		test	edi, edi
		setz	al

loc_10007A26:				; CODE XREF: sub_10007988+3Fj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10007988	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007A37(LPCWSTR StringSid)
sub_10007A37	proc near		; CODE XREF: sub_10007A59+13p
					; sub_10007A59+4Bp

Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10007A43
		mov	ecx, [ecx]

loc_10007A43:				; CODE XREF: sub_10007A37+8j
		lea	eax, [ebp+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		neg	eax
		sbb	eax, eax
		and	eax, [ebp+Sid]
		mov	esp, ebp
		pop	ebp
		retn
sub_10007A37	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10007A59(LPCWSTR StringSid,	int)
sub_10007A59	proc near		; CODE XREF: sub_100149E6+A4p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
StringSid	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	ecx, [esp+24h+StringSid] ; StringSid
		mov	[esp+24h+var_10], ebp
		call	sub_10007A37
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10007A7F
		push	0Eh

loc_10007A79:				; CODE XREF: sub_10007A59+114j
		pop	eax
		jmp	loc_10007B61
; ---------------------------------------------------------------------------

loc_10007A7F:				; CODE XREF: sub_10007A59+1Cj
		mov	ebx, [esp+24h+arg_4]
		push	18h
		pop	esi
		mov	[esp+24h+var_10], esi
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		sub	eax, ecx
		cdq
		idiv	esi
		test	eax, eax
		jz	loc_10007B4A
		mov	esi, ebp
		mov	[esp+24h+StringSid], ebp

loc_10007AA2:				; CODE XREF: sub_10007A59+E8j
		add	ecx, esi	; StringSid
		call	sub_10007A37
		mov	ecx, eax
		mov	[esp+24h+var_C], ecx
		test	ecx, ecx
		jz	loc_10007B6B
		lea	esi, [edi+10h]
		mov	[esp+24h+var_8], 4
		mov	eax, [esi+4]
		lea	edx, [esp+24h+var_C]
		cmp	edx, eax
		jnb	short loc_10007B00
		cmp	[esi], edx
		ja	short loc_10007B00
		mov	ebx, edx
		sub	ebx, [esi]
		sar	ebx, 3
		cmp	eax, [esi+8]
		jnz	short loc_10007AE5
		push	ecx
		mov	ecx, esi
		call	sub_10007DAB

loc_10007AE5:				; CODE XREF: sub_10007A59+82j
		mov	edx, [esi+4]
		test	edx, edx
		jz	short loc_10007AFA
		mov	ecx, [esi]
		mov	eax, [ecx+ebx*8]
		mov	[edx], eax
		mov	eax, [ecx+ebx*8+4]
		mov	[edx+4], eax

loc_10007AFA:				; CODE XREF: sub_10007A59+91j
		mov	ebx, [esp+24h+arg_4]
		jmp	short loc_10007B21
; ---------------------------------------------------------------------------

loc_10007B00:				; CODE XREF: sub_10007A59+72j
					; sub_10007A59+76j
		cmp	eax, [esi+8]
		jnz	short loc_10007B11
		push	ecx
		mov	ecx, esi
		call	sub_10007DAB
		mov	ecx, [esp+24h+var_C]

loc_10007B11:				; CODE XREF: sub_10007A59+AAj
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10007B21
		mov	[eax], ecx
		mov	dword ptr [eax+4], 4

loc_10007B21:				; CODE XREF: sub_10007A59+A5j
					; sub_10007A59+BDj
		add	dword ptr [esi+4], 8
		inc	ebp
		mov	esi, [esp+24h+StringSid]
		mov	ecx, [ebx]
		push	18h
		pop	eax
		add	esi, eax
		mov	eax, [ebx+4]
		sub	eax, ecx
		mov	[esp+24h+StringSid], esi
		cdq
		idiv	[esp+24h+var_10]
		cmp	ebp, eax
		jb	loc_10007AA2
		push	18h
		pop	esi

loc_10007B4A:				; CODE XREF: sub_10007A59+3Dj
		mov	eax, [ebx+4]
		sub	eax, [ebx]
		cdq
		idiv	esi
		test	eax, eax
		jz	short loc_10007B5F
		mov	[edi+8], eax
		mov	eax, [edi+10h]
		mov	[edi+4], eax

loc_10007B5F:				; CODE XREF: sub_10007A59+FBj
		xor	eax, eax

loc_10007B61:				; CODE XREF: sub_10007A59+21j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn	8
; ---------------------------------------------------------------------------

loc_10007B6B:				; CODE XREF: sub_10007A59+58j
		push	0Fh
		jmp	loc_10007A79
sub_10007A59	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10007B72(LPCWSTR StringSid)
sub_10007B72	proc near		; CODE XREF: sub_10008B78+76p

Sid		= dword	ptr -4

		push	ecx
		and	[esp+4+Sid], 0
		cmp	dword ptr [ecx+14h], 8
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		jb	short loc_10007B84
		mov	ecx, [ecx]

loc_10007B84:				; CODE XREF: sub_10007B72+Ej
		lea	eax, [esp+10h+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10007B99
		push	0Eh
		pop	eax
		jmp	short loc_10007C09
; ---------------------------------------------------------------------------

loc_10007B99:				; CODE XREF: sub_10007B72+20j
		mov	eax, dword_10031F58
		test	eax, eax
		jnz	short loc_10007BD4
		mov	edi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	edi ; GetModuleHandleW
		mov	ebp, offset aAppcontainerre ; "AppContainerRegisterSid"
		push	ebp		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short loc_10007BCF
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	ebp		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress

loc_10007BCF:				; CODE XREF: sub_10007B72+4Cj
		mov	dword_10031F58,	eax

loc_10007BD4:				; CODE XREF: sub_10007B72+2Ej
		xor	edi, edi
		inc	edi
		test	eax, eax
		jz	short loc_10007BFD
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007BE5
		mov	ecx, [esi]
		jmp	short loc_10007BE7
; ---------------------------------------------------------------------------

loc_10007BE5:				; CODE XREF: sub_10007B72+6Dj
		mov	ecx, esi

loc_10007BE7:				; CODE XREF: sub_10007B72+71j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007BEF
		mov	esi, [esi]

loc_10007BEF:				; CODE XREF: sub_10007B72+79j
		push	ecx
		push	esi
		push	[esp+18h+Sid]
		call	eax ; dword_10031F58
		test	eax, eax
		js	short loc_10007BFD
		xor	edi, edi

loc_10007BFD:				; CODE XREF: sub_10007B72+67j
					; sub_10007B72+87j
		push	[esp+10h+Sid]	; hMem
		call	ds:LocalFree
		mov	eax, edi

loc_10007C09:				; CODE XREF: sub_10007B72+25j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_10007B72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007C0E(LPCWSTR StringSid)
sub_10007C0E	proc near		; CODE XREF: sub_10008C53+65p

Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+Sid], 0
		cmp	dword ptr [ecx+14h], 8
		push	ebx
		push	esi
		jb	short loc_10007C20
		mov	ecx, [ecx]

loc_10007C20:				; CODE XREF: sub_10007C0E+Ej
		lea	eax, [ebp+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10007C34
		push	0Eh
		pop	eax
		jmp	short loc_10007C8C
; ---------------------------------------------------------------------------

loc_10007C34:				; CODE XREF: sub_10007C0E+1Fj
		mov	eax, dword_10031F4C
		test	eax, eax
		jnz	short loc_10007C6F
		mov	esi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	esi ; GetModuleHandleW
		mov	ebx, offset aAppcontainerun ; "AppContainerUnregisterSid"
		push	ebx		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short loc_10007C6A
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	esi ; GetModuleHandleW
		push	ebx		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress

loc_10007C6A:				; CODE XREF: sub_10007C0E+4Bj
		mov	dword_10031F4C,	eax

loc_10007C6F:				; CODE XREF: sub_10007C0E+2Dj
		xor	esi, esi
		inc	esi
		test	eax, eax
		jz	short loc_10007C81
		push	[ebp+Sid]
		call	eax ; dword_10031F4C
		test	eax, eax
		js	short loc_10007C81
		xor	esi, esi

loc_10007C81:				; CODE XREF: sub_10007C0E+66j
					; sub_10007C0E+6Fj
		push	[ebp+Sid]	; hMem
		call	ds:LocalFree
		mov	eax, esi

loc_10007C8C:				; CODE XREF: sub_10007C0E+24j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007C0E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007C92	proc near		; CODE XREF: sub_10008B78+41p
					; sub_10008C53+39p

var_28		= dword	ptr -28h
Sid		= dword	ptr -24h
Src		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	[esp+38h+Sid], ebp
		mov	esi, ecx
		cmp	dword ptr [edx+14h], 8
		push	edi
		jb	short loc_10007CB4
		mov	edx, [edx]

loc_10007CB4:				; CODE XREF: sub_10007C92+1Ej
		lea	eax, [esp+3Ch+Sid]
		push	eax		; Sid
		push	edx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jz	loc_10007D87
		mov	ecx, dword_10031F54
		test	ecx, ecx
		jz	short loc_10007CDB
		mov	eax, dword_10031F50
		test	eax, eax
		jnz	short loc_10007D3B

loc_10007CDB:				; CODE XREF: sub_10007C92+3Ej
		mov	edi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	edi ; GetModuleHandleW
		mov	ebx, ds:GetProcAddress
		push	offset aAppcontainerlo ; "AppContainerLookupMoniker"
		push	eax		; hModule
		call	ebx ; GetProcAddress
		test	eax, eax
		jnz	short loc_10007D09
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerlo ; "AppContainerLookupMoniker"
		push	eax		; hModule
		call	ebx ; GetProcAddress

loc_10007D09:				; CODE XREF: sub_10007C92+66j
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		mov	dword_10031F54,	eax
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerfr ; "AppContainerFreeMemory"
		push	eax		; hModule
		call	ebx ; GetProcAddress
		test	eax, eax
		jnz	short loc_10007D30
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerfr ; "AppContainerFreeMemory"
		push	eax		; hModule
		call	ebx ; GetProcAddress

loc_10007D30:				; CODE XREF: sub_10007C92+8Dj
		mov	ecx, dword_10031F54
		mov	dword_10031F50,	eax

loc_10007D3B:				; CODE XREF: sub_10007C92+47j
		test	ecx, ecx
		jz	short loc_10007D87
		test	eax, eax
		jz	short loc_10007D87
		lea	eax, [esp+3Ch+var_28]
		mov	[esp+3Ch+var_28], ebp
		push	eax
		push	[esp+40h+Sid]
		call	ecx ; dword_10031F54
		test	eax, eax
		js	short loc_10007D87
		push	[esp+3Ch+var_28] ; Src
		lea	ecx, [esp+40h+Src] ; Dst
		call	sub_10001C68
		push	[esp+3Ch+var_28]
		call	dword_10031F50
		lea	eax, [esp+3Ch+Src]
		mov	ecx, esi
		push	eax		; Src
		call	sub_1000346E
		push	ebp
		push	1
		lea	ecx, [esp+44h+Src]
		call	sub_100022FA
		jmp	short loc_10007D96
; ---------------------------------------------------------------------------

loc_10007D87:				; CODE XREF: sub_10007C92+30j
					; sub_10007C92+ABj ...
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], ebp
		mov	[esi], ax

loc_10007D96:				; CODE XREF: sub_10007C92+F3j
		mov	ecx, [esp+3Ch+var_8]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10007C92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007DAB	proc near		; CODE XREF: sub_10007A59+87p
					; sub_10007A59+AFp ...
		mov	edx, [ecx+8]
		mov	eax, edx
		push	esi
		mov	esi, [ecx+4]
		sub	eax, esi
		sar	eax, 3
		cmp	eax, 1
		jnb	short loc_10007E00
		sub	esi, [ecx]
		push	edi
		mov	edi, 1FFFFFFFh
		sar	esi, 3
		mov	eax, edi
		sub	eax, esi
		cmp	eax, 1
		jnb	short loc_10007DDD
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10007DDD:				; CODE XREF: sub_10007DAB+25j
		sub	edx, [ecx]
		inc	esi
		sar	edx, 3
		mov	eax, edx
		shr	eax, 1
		sub	edi, eax
		cmp	edi, edx
		jnb	short loc_10007DF1
		xor	edx, edx
		jmp	short loc_10007DF3
; ---------------------------------------------------------------------------

loc_10007DF1:				; CODE XREF: sub_10007DAB+40j
		add	edx, eax

loc_10007DF3:				; CODE XREF: sub_10007DAB+44j
		cmp	edx, esi
		jnb	short loc_10007DF9
		mov	edx, esi

loc_10007DF9:				; CODE XREF: sub_10007DAB+4Aj
		push	edx
		call	sub_10007E04
		pop	edi

loc_10007E00:				; CODE XREF: sub_10007DAB+11j
		pop	esi
		retn	4
sub_10007DAB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E04	proc near		; CODE XREF: sub_10007DAB+4Fp

arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, ecx
		test	ebp, ebp
		jz	short loc_10007E34
		cmp	ebp, 1FFFFFFFh
		ja	short loc_10007E2E
		mov	eax, ebp
		shl	eax, 3
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_10007E34

loc_10007E2E:				; CODE XREF: sub_10007E04+15j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10007E34:				; CODE XREF: sub_10007E04+Dj
					; sub_10007E04+28j
		mov	ecx, [esi]
		mov	edx, edi
		push	ebx
		mov	ebx, [esi+4]
		jmp	short loc_10007E52
; ---------------------------------------------------------------------------

loc_10007E3E:				; CODE XREF: sub_10007E04+50j
		test	edx, edx
		jz	short loc_10007E4C
		mov	eax, [ecx]
		mov	[edx], eax
		mov	eax, [ecx+4]
		mov	[edx+4], eax

loc_10007E4C:				; CODE XREF: sub_10007E04+3Cj
		add	edx, 8
		add	ecx, 8

loc_10007E52:				; CODE XREF: sub_10007E04+38j
		cmp	ecx, ebx
		jnz	short loc_10007E3E
		mov	ebx, [esi+4]
		sub	ebx, [esi]
		sar	ebx, 3
		cmp	dword ptr [esi], 0
		jz	short loc_10007E6C
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007E6C:				; CODE XREF: sub_10007E04+5Dj
		lea	eax, [edi+ebp*8]
		mov	[esi], edi
		mov	[esi+8], eax
		lea	eax, [edi+ebx*8]
		pop	ebx
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		retn	4
sub_10007E04	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E81	proc near		; DATA XREF: .rdata:1002BC94o

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BC8C
		jz	short loc_10007E99
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007E99:				; CODE XREF: sub_10007E81+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10007E81	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E9F	proc near		; DATA XREF: .rdata:1002BC88o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10017FE3
		test	[esp+4+arg_0], 1
		jz	short loc_10007EB6
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007EB6:				; CODE XREF: sub_10007E9F+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10007E9F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007EBC	proc near		; CODE XREF: sub_100083D0+4A0p
					; sub_100083D0+512p
		push	ecx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, ecx
		test	edi, edi
		jnz	short loc_10007ECF
		call	ds:GetLastError
		mov	edi, eax

loc_10007ECF:				; CODE XREF: sub_10007EBC+9j
		mov	ecx, esi
		call	sub_100061E5
		test	al, al
		jz	short loc_10007EE4
		push	0		; uExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:TerminateProcess

loc_10007EE4:				; CODE XREF: sub_10007EBC+1Cj
		test	esi, esi
		jz	short loc_10007EF7
		mov	ecx, esi
		call	sub_100177EE
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007EF7:				; CODE XREF: sub_10007EBC+2Aj
		push	edi		; dwErrCode
		call	ds:SetLastError
		xor	eax, eax
		pop	edi
		inc	eax
		pop	esi
		pop	ecx
		retn
sub_10007EBC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007F05	proc near		; CODE XREF: sub_10008051+A0p
					; StartAddress+155p

var_4		= dword	ptr -4

		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	esi
		mov	esi, ecx
		push	0FFFFFFFFh	; CompletionEvent
		push	dword ptr [esi]	; WaitHandle
		call	ds:UnregisterWaitEx
		test	eax, eax
		jz	short loc_10007F2D
		lea	ecx, [esi+4]
		call	sub_10004633
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007F2D:				; CODE XREF: sub_10007F05+16j
		pop	esi
		pop	ecx
		pop	ecx
		retn
sub_10007F05	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007F31	proc near		; CODE XREF: sub_1000D76A+18p
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	ebx
		push	ebx
		mov	dword ptr [esi], offset	off_1002BC98
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+28h], ebx
		mov	[esi+2Ch], ebx
		mov	[esi+30h], ebx
		call	sub_1000916C
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		mov	[esi+2Ch], eax
		push	18h
		mov	[esi+34h], ebx
		mov	[esi+38h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_10007F75

loc_10007F6F:				; CODE XREF: sub_10007F31+6Ej
					; sub_10007F31+9Aj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10007F75:				; CODE XREF: sub_10007F31+3Cj
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007F80
		mov	[ecx], eax

loc_10007F80:				; CODE XREF: sub_10007F31+4Bj
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007F89
		mov	[ecx], eax

loc_10007F89:				; CODE XREF: sub_10007F31+54j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+34h], eax
		push	14h
		mov	[esi+3Ch], ebx
		mov	[esi+40h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10007F6F
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007FAC
		mov	[ecx], eax

loc_10007FAC:				; CODE XREF: sub_10007F31+77j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007FB5
		mov	[ecx], eax

loc_10007FB5:				; CODE XREF: sub_10007F31+80j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+3Ch], eax
		push	1Ch
		mov	[esi+44h], ebx
		mov	[esi+48h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10007F6F
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007FD8
		mov	[ecx], eax

loc_10007FD8:				; CODE XREF: sub_10007F31+A3j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007FE1
		mov	[ecx], eax

loc_10007FE1:				; CODE XREF: sub_10007F31+ACj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+44h], eax
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10007F31	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10007FF0(LPVOID lpParameter)
sub_10007FF0	proc near		; DATA XREF: .rdata:off_1002BC98o
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		cmp	[esi+4], edi
		jnz	short loc_1000804B
		cmp	[esi+28h], edi
		jnz	short loc_1000804B
		lea	eax, [esi+10h]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		push	edi		; NumberOfConcurrentThreads
		push	edi		; CompletionKey
		push	edi		; ExistingCompletionPort
		push	0FFFFFFFFh	; FileHandle
		call	ds:CreateIoCompletionPort
		mov	[esi+4], eax
		test	eax, eax
		jnz	short loc_1000801F
		inc	eax
		jmp	short loc_1000804E
; ---------------------------------------------------------------------------

loc_1000801F:				; CODE XREF: sub_10007FF0+2Aj
		push	edi		; lpName
		push	edi		; bInitialState
		push	1		; bManualReset
		push	edi		; lpEventAttributes
		call	ds:CreateEventW
		push	edi		; lpThreadId
		push	edi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	edi		; dwStackSize
		push	edi		; lpThreadAttributes
		mov	[esi+8], eax
		call	ds:CreateThread
		xor	ecx, ecx
		mov	[esi+0Ch], eax
		test	eax, eax
		setz	cl
		mov	eax, ecx
		jmp	short loc_1000804E
; ---------------------------------------------------------------------------

loc_1000804B:				; CODE XREF: sub_10007FF0+9j
					; sub_10007FF0+Ej
		push	8
		pop	eax

loc_1000804E:				; CODE XREF: sub_10007FF0+2Dj
					; sub_10007FF0+59j
		pop	edi
		pop	esi
		retn
sub_10007FF0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008051	proc near		; CODE XREF: sub_1000D76A+4Ap

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+4], 0
		mov	dword ptr [ebx], offset	off_1002BC98
		jz	loc_10008141
		push	0		; lpOverlapped
		push	2		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [ebx+4] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		push	dword ptr [ebx+4] ; hObject
		mov	ebp, ds:CloseHandle
		call	ebp ; CloseHandle
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+0Ch] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	loc_10008141
		mov	eax, [ebx+2Ch]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100080C9

loc_100080B0:				; CODE XREF: sub_10008051+76j
		mov	edi, [esi+8]
		mov	ecx, edi
		call	sub_100081BC
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		cmp	esi, [ebx+2Ch]
		jnz	short loc_100080B0

loc_100080C9:				; CODE XREF: sub_10008051+5Dj
		push	dword ptr [ebx+0Ch] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+28h]
		test	ecx, ecx
		jz	short loc_100080DC
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

loc_100080DC:				; CODE XREF: sub_10008051+82j
		push	dword ptr [ebx+8] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+34h]
		mov	eax, [ecx]
		mov	[esp+18h+var_4], eax
		cmp	eax, ecx
		jz	short loc_10008108

loc_100080EE:				; CODE XREF: sub_10008051+B5j
		mov	ecx, [eax+14h]
		call	sub_10007F05
		lea	ecx, [esp+18h+var_4]
		call	sub_10004B74
		mov	eax, [esp+18h+var_4]
		cmp	eax, [ebx+34h]
		jnz	short loc_100080EE

loc_10008108:				; CODE XREF: sub_10008051+9Bj
		cmp	dword ptr [ebx+4], 0
		jz	short loc_10008118
		lea	eax, [ebx+10h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection

loc_10008118:				; CODE XREF: sub_10008051+BBj
		mov	eax, [ebx+44h]
		mov	esi, [eax]
		mov	[esp+18h+var_4], esi
		cmp	esi, eax
		jz	short loc_10008141

loc_10008125:				; CODE XREF: sub_10008051+EEj
		push	dword ptr [esi+14h] ; hObject
		call	ebp ; CloseHandle
		push	dword ptr [esi+18h] ; hObject
		call	ebp ; CloseHandle
		lea	ecx, [esp+18h+var_4]
		call	sub_10004B74
		mov	esi, [esp+18h+var_4]
		cmp	esi, [ebx+44h]
		jnz	short loc_10008125

loc_10008141:				; CODE XREF: sub_10008051+1Dj
					; sub_10008051+50j ...
		lea	ecx, [ebx+44h]
		call	sub_10009078
		lea	esi, [ebx+3Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	eax
		push	dword ptr [eax]
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_100090A2
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		lea	esi, [ebx+34h]
		mov	eax, [esi]
		mov	ecx, esi
		push	eax
		push	dword ptr [eax]
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_100090A2
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		lea	ecx, [ebx+2Ch]
		call	sub_10008CED
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10008051	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008193	proc near		; DATA XREF: .rdata:1002BC9Co
		push	esi
		push	0F8h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		xor	esi, esi
		pop	ecx
		test	eax, eax
		jz	short loc_100081AF
		mov	ecx, eax
		call	sub_1001436D
		jmp	short loc_100081B1
; ---------------------------------------------------------------------------

loc_100081AF:				; CODE XREF: sub_10008193+11j
		mov	eax, esi

loc_100081B1:				; CODE XREF: sub_10008193+1Aj
		test	eax, eax
		jz	short loc_100081B8
		lea	esi, [eax+10h]

loc_100081B8:				; CODE XREF: sub_10008193+20j
		mov	eax, esi
		pop	esi
		retn
sub_10008193	endp


; =============== S U B	R O U T	I N E =======================================


sub_100081BC	proc near		; CODE XREF: sub_10008051+64p
					; StartAddress:loc_10008317p

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	[esp+0Ch+var_4], edi
		cmp	[esi+4], edi
		jz	short loc_100081F5
		push	edi		; uExitCode
		push	dword ptr [esi]	; hJob
		call	ds:TerminateJobObject
		push	dword ptr [esi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [esi]
		mov	ecx, [esi+4]
		call	sub_10014FE4
		mov	ecx, [esi+4]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], edi

loc_100081F5:				; CODE XREF: sub_100081BC+Ej
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100081BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: sub_10007FF0+3Do

var_238		= dword	ptr -238h
Overlapped	= dword	ptr -234h
var_230		= dword	ptr -230h
NumberOfBytesTransferred= dword	ptr -22Ch
CompletionKey	= dword	ptr -228h
var_224		= dword	ptr -224h
CompletionPort	= dword	ptr -220h
hEvent		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= byte ptr -214h
var_210		= byte ptr -210h
var_160		= byte ptr -160h
var_B0		= byte ptr -0B0h
lpThreadParameter= dword ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 23Ch
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+lpThreadParameter]
		xor	ebx, ebx
		mov	[esp+248h+var_238], ebx
		test	edi, edi
		jz	loc_100083C0
		call	sub_1000457F
		mov	eax, [edi+4]
		xor	esi, esi
		mov	[esp+248h+CompletionPort], eax
		mov	eax, [edi+8]
		mov	[esp+248h+hEvent], eax
		mov	[esp+248h+var_230], esi
		push	eax
		jmp	loc_1000830F
; ---------------------------------------------------------------------------

loc_10008238:				; CODE XREF: StartAddress+1C1j
		mov	ecx, [esp+248h+CompletionKey]
		cmp	ecx, 3
		jbe	loc_1000831E
		mov	eax, [esp+248h+NumberOfBytesTransferred]
		cmp	eax, 3
		jz	loc_1000838F
		cmp	eax, 4
		jz	loc_10008317
		cmp	eax, 6
		jz	loc_100082FD
		jbe	loc_100082EC
		cmp	eax, 8
		jbe	short loc_10008299
		cmp	eax, 9
		jnz	short loc_100082EC
		push	1B64h		; uExitCode
		push	dword ptr [ecx]	; hJob
		call	ds:TerminateJobObject
		test	bl, 2
		jz	loc_1000838F
		and	ebx, 0FFFFFFFDh
		lea	ecx, [esp+248h+var_B0]
		jmp	loc_10008386
; ---------------------------------------------------------------------------

loc_10008299:				; CODE XREF: StartAddress+74j
		lea	esi, [edi+10h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [edi+3Ch]
		mov	[esp+248h+var_224], eax
		lea	eax, [esp+248h+var_224]
		push	eax
		call	sub_10008F9A
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	esi, [esp+248h+var_230]
		dec	esi
		mov	[esp+248h+var_230], esi
		jnz	short loc_100082D4
		push	[esp+248h+hEvent] ; hEvent
		call	ds:SetEvent

loc_100082D4:				; CODE XREF: StartAddress+CFj
		test	bl, 1
		jz	loc_1000838F
		and	ebx, 0FFFFFFFEh
		lea	ecx, [esp+248h+var_160]
		jmp	loc_10008386
; ---------------------------------------------------------------------------

loc_100082EC:				; CODE XREF: StartAddress+6Bj
					; StartAddress+79j
		test	bl, 4
		jz	loc_1000838F
		and	ebx, 0FFFFFFFBh
		jmp	loc_10008382
; ---------------------------------------------------------------------------

loc_100082FD:				; CODE XREF: StartAddress+65j
		inc	esi
		mov	[esp+248h+var_230], esi
		cmp	esi, 1
		jnz	loc_1000838F
		push	[esp+248h+hEvent] ; hEvent

loc_1000830F:				; CODE XREF: StartAddress+3Aj
		call	ds:ResetEvent
		jmp	short loc_1000838F
; ---------------------------------------------------------------------------

loc_10008317:				; CODE XREF: StartAddress+5Cj
		call	sub_100081BC
		jmp	short loc_1000838F
; ---------------------------------------------------------------------------

loc_1000831E:				; CODE XREF: StartAddress+46j
		cmp	ecx, 1
		jnz	short loc_10008375
		lea	ebx, [edi+10h]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [edi+34h]
		mov	[esp+248h+var_224], eax
		lea	eax, [esp+248h+var_224]
		push	eax
		lea	eax, [esp+24Ch+var_218]
		push	eax
		call	sub_1000902C
		mov	esi, [esp+248h+var_218]
		mov	ecx, [esi+14h]
		call	sub_10007F05
		push	esi
		lea	eax, [esp+24Ch+var_214]
		push	eax
		lea	ecx, [edi+34h]
		call	sub_10008D6D
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ebx, [esp+248h+var_238]
		mov	edi, [ebp+lpThreadParameter]
		mov	esi, [esp+248h+var_230]
		jmp	short loc_1000838F
; ---------------------------------------------------------------------------

loc_10008375:				; CODE XREF: StartAddress+128j
		cmp	ecx, 2
		jz	short loc_100083CC
		test	bl, 8
		jz	short loc_1000838F
		and	ebx, 0FFFFFFF7h

loc_10008382:				; CODE XREF: StartAddress+FFj
		lea	ecx, [esp+248h+var_210]

loc_10008386:				; CODE XREF: StartAddress+9Bj
					; StartAddress+EEj
		mov	[esp+248h+var_238], ebx
		call	sub_10001BD6

loc_1000838F:				; CODE XREF: StartAddress+53j
					; StartAddress+8Bj ...
		xor	eax, eax
		mov	[esp+248h+NumberOfBytesTransferred], eax
		mov	[esp+248h+CompletionKey], eax
		mov	[esp+248h+Overlapped], eax
		lea	eax, [esp+248h+Overlapped]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; lpOverlapped
		lea	eax, [esp+250h+CompletionKey]
		push	eax		; lpCompletionKey
		lea	eax, [esp+254h+NumberOfBytesTransferred]
		push	eax		; lpNumberOfBytesTransferred
		push	[esp+258h+CompletionPort] ; CompletionPort
		call	ds:GetQueuedCompletionStatus
		test	eax, eax
		jnz	loc_10008238

loc_100083C0:				; CODE XREF: StartAddress+1Aj
		xor	eax, eax
		inc	eax

loc_100083C3:				; CODE XREF: StartAddress+1D5j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_100083CC:				; CODE XREF: StartAddress+17Fj
		xor	eax, eax
		jmp	short loc_100083C3
StartAddress	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100083D0	proc near		; DATA XREF: .rdata:1002BCA0o

var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
hExistingToken	= dword	ptr -0C0h
DuplicateTokenHandle= dword ptr	-0BCh
Str		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
lpCriticalSection= dword ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
JobObjectInformation= dword ptr	-78h
var_74		= dword	ptr -74h
Dst		= byte ptr -68h
var_60		= dword	ptr -60h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0D4h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0D4h+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+0D4h+lpCriticalSection], 0
		mov	[esp+0D4h+Str],	eax
		push	ebx
		mov	ebx, ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+0D8h+var_7C], ecx
		mov	ecx, [ebp+arg_C]
		mov	[esp+0D8h+var_AC], ebx
		mov	[esp+0D8h+var_90], ecx
		push	esi
		mov	esi, [ebp+arg_8]
		mov	[esp+0DCh+var_B4], esi
		push	edi
		test	eax, eax
		jnz	short loc_10008420

loc_10008418:				; CODE XREF: sub_100083D0+52j
		push	2
		pop	eax
		jmp	loc_100089B7
; ---------------------------------------------------------------------------

loc_10008420:				; CODE XREF: sub_100083D0+46j
		test	esi, esi
		jz	short loc_10008418
		mov	eax, dword_10031F9C
		test	al, 1
		jnz	short loc_10008440
		or	eax, 1
		mov	dword_10031F9C,	eax
		call	ds:GetCurrentThreadId
		mov	dword_10031F98,	eax

loc_10008440:				; CODE XREF: sub_100083D0+5Bj
		lea	eax, [ebx+10h]
		push	eax		; lpCriticalSection
		mov	[esp+0E4h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	ebx, [esi-10h]
		mov	eax, [ebx+0F0h]
		mov	[esp+0E0h+var_C8], ebx
		test	eax, eax
		jz	short loc_10008464
		cmp	dword ptr [eax], 0
		jnz	short loc_10008466

loc_10008464:				; CODE XREF: sub_100083D0+8Dj
		xor	eax, eax

loc_10008466:				; CODE XREF: sub_100083D0+92j
		test	eax, eax
		jnz	loc_10008594
		add	ebx, 10h
		mov	ecx, ebx
		mov	eax, [ebx]
		call	dword ptr [eax+0Ch]
		mov	edx, [ebx]
		mov	esi, eax
		mov	ecx, ebx
		shl	esi, 3
		call	dword ptr [edx+10h]
		mov	edx, [ebx]
		mov	edi, eax
		or	edi, esi
		mov	ecx, ebx
		shl	edi, 3
		call	dword ptr [edx+30h]
		mov	esi, eax
		lea	eax, [esp+0E0h+var_CC]
		or	esi, edi
		mov	edi, [esp+0E0h+var_AC]
		push	eax
		lea	eax, [esp+0E4h+var_D0]
		mov	[esp+0E4h+var_CC], esi
		add	edi, 44h
		push	eax
		mov	ecx, edi
		call	sub_10004AC2
		mov	ecx, [edi]
		mov	eax, [esp+0E0h+var_D0]
		cmp	eax, ecx
		jz	short loc_100084C5
		mov	[esp+0E0h+var_D0], eax
		cmp	esi, [eax+10h]
		jnb	short loc_100084C9

loc_100084C5:				; CODE XREF: sub_100083D0+EAj
		mov	[esp+0E0h+var_D0], ecx

loc_100084C9:				; CODE XREF: sub_100083D0+F3j
		mov	ebx, [esp+0E0h+var_C8]
		lea	eax, [esp+0E0h+var_D0]
		mov	eax, [eax]
		cmp	eax, ecx
		jz	short loc_100084E7
		mov	ecx, [eax+14h]
		mov	[esp+0E0h+DuplicateTokenHandle], ecx
		mov	eax, [eax+18h]
		mov	[esp+0E0h+hExistingToken], eax
		jmp	short loc_1000855C
; ---------------------------------------------------------------------------

loc_100084E7:				; CODE XREF: sub_100083D0+105j
		lea	eax, [esp+0E0h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0E4h+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10014DF3
		mov	esi, eax
		test	esi, esi
		jnz	loc_100089AB
		mov	eax, [esp+0E0h+hExistingToken]
		mov	ecx, edi
		mov	esi, [esp+0E0h+DuplicateTokenHandle]
		mov	[esp+0E0h+var_C8], eax
		lea	eax, [esp+0E0h+var_CC]
		push	eax
		lea	eax, [esp+0E4h+var_D0]
		push	eax
		call	sub_10004AC2
		mov	eax, [esp+0E0h+var_D0]
		cmp	eax, [edi]
		jz	short loc_10008530
		mov	ecx, [esp+0E0h+var_CC]
		cmp	ecx, [eax+10h]
		jnb	short loc_1000854E

loc_10008530:				; CODE XREF: sub_100083D0+155j
		lea	ecx, [esp+0E0h+var_CC]
		push	ecx
		mov	[esp+0E4h+var_D0], ecx
		lea	ecx, [esp+0E4h+var_D0]
		push	ecx
		push	ecx
		push	eax
		lea	eax, [esp+0F0h+var_A4]
		mov	ecx, edi
		push	eax
		call	sub_10009204
		mov	eax, [eax]

loc_1000854E:				; CODE XREF: sub_100083D0+15Ej
		mov	ecx, [esp+0E0h+var_C8]
		mov	[eax+14h], esi
		mov	[eax+18h], ecx
		mov	ecx, [esp+0E0h+DuplicateTokenHandle]

loc_1000855C:				; CODE XREF: sub_100083D0+115j
		lea	eax, [esp+0E0h+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	ecx		; ExistingTokenHandle
		call	ds:DuplicateToken
		test	eax, eax
		jz	short loc_1000858C
		lea	eax, [esp+0E0h+hExistingToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	0		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	[esp+0F4h+hExistingToken] ; hExistingToken
		call	ds:DuplicateTokenEx
		test	eax, eax
		jnz	short loc_100085AF

loc_1000858C:				; CODE XREF: sub_100083D0+19Cj
		xor	esi, esi
		inc	esi
		jmp	loc_100089AB
; ---------------------------------------------------------------------------

loc_10008594:				; CODE XREF: sub_100083D0+98j
		lea	eax, [esp+0E0h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0E4h+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10014DF3
		mov	esi, eax
		test	esi, esi
		jnz	loc_100089AB

loc_100085AF:				; CODE XREF: sub_100083D0+1BAj
		push	[esp+0E0h+DuplicateTokenHandle]
		and	[esp+0E4h+var_A8], 0
		lea	ecx, [esp+0E4h+var_A8]
		call	sub_100045FD
		push	[esp+0E0h+hExistingToken]
		and	[esp+0E4h+var_B0], 0
		lea	ecx, [esp+0E4h+var_B0]
		call	sub_100045FD
		lea	eax, [esp+0E0h+var_D0]
		mov	ecx, ebx
		push	eax
		call	sub_10014DA3
		mov	esi, eax
		test	esi, esi
		jnz	loc_10008999
		push	[esp+0E0h+var_D0]
		and	[esp+0E4h+var_C4], eax
		lea	ecx, [esp+0E4h+var_C4]
		call	sub_100045FD
		lea	ecx, [esp+0E0h+Dst] ; Dst
		call	sub_100062AA
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		lea	edx, [esp+0E0h+var_1C]
		push	edx
		call	dword ptr [eax+20h]
		cmp	[esp+0E0h+var_C], esi
		jz	short loc_1000863B
		cmp	[esp+0E0h+var_8], 8
		mov	eax, [esp+0E0h+var_1C]
		jnb	short loc_10008634
		lea	eax, [esp+0E0h+var_1C]

loc_10008634:				; CODE XREF: sub_100083D0+25Bj
		mov	[esp+0E0h+var_60], eax

loc_1000863B:				; CODE XREF: sub_100083D0+24Aj
		mov	byte ptr [esp+0E0h+var_C8], 0
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jl	loc_10008770
		mov	edi, [ebx+0F0h]
		xor	eax, eax
		mov	[esp+0E0h+var_CC], eax
		test	edi, edi
		jz	short loc_10008662
		cmp	[edi], eax
		jnz	short loc_10008664

loc_10008662:				; CODE XREF: sub_100083D0+28Cj
		xor	edi, edi

loc_10008664:				; CODE XREF: sub_100083D0+290j
		test	edi, edi
		jz	short loc_1000866F
		xor	eax, eax
		inc	eax
		mov	[esp+0E0h+var_CC], eax

loc_1000866F:				; CODE XREF: sub_100083D0+296j
		mov	ecx, [esp+0E0h+var_B4]
		mov	eax, [ecx]
		call	dword ptr [eax+44h]
		push	edx
		push	eax
		lea	edx, [esp+0E8h+var_B4]
		lea	ecx, [esp+0E8h+var_A0]
		call	sub_100104A0
		mov	eax, [esp+0E8h+var_A0]
		or	eax, [esp+0E8h+var_9C]
		mov	eax, [esp+0E8h+var_CC]
		pop	ecx
		pop	ecx
		jz	short loc_10008698
		inc	eax

loc_10008698:				; CODE XREF: sub_100083D0+2C5j
		mov	edx, [ebx+50h]
		xor	esi, esi
		mov	ecx, [ebx+54h]
		mov	[esp+0E0h+var_D0], edx
		mov	[esp+0E0h+var_A4], ecx
		mov	[esp+0E0h+var_CC], esi
		cmp	edx, 0FFFFFFFFh
		jz	short loc_100086BA
		inc	esi
		mov	[esp+0E0h+JobObjectInformation], edx
		mov	[esp+0E0h+var_CC], esi

loc_100086BA:				; CODE XREF: sub_100083D0+2DFj
		cmp	ecx, edx
		jz	short loc_100086CC
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100086CC
		mov	[esp+esi*4+0E0h+JobObjectInformation], ecx
		inc	esi
		mov	[esp+0E0h+var_CC], esi

loc_100086CC:				; CODE XREF: sub_100083D0+2ECj
					; sub_100083D0+2F1j
		test	esi, esi
		jz	short loc_100086D1
		inc	eax

loc_100086D1:				; CODE XREF: sub_100083D0+2FEj
		push	eax
		lea	ecx, [esp+0E4h+Dst]
		call	sub_1000632D
		test	al, al
		jz	short loc_10008757
		test	edi, edi
		jz	short loc_1000870E
		cmp	dword ptr [edi], 0
		jnz	short loc_100086EC
		push	0Eh
		jmp	short loc_10008759
; ---------------------------------------------------------------------------

loc_100086EC:				; CODE XREF: sub_100083D0+316j
		push	10h
		pop	esi
		push	esi
		push	edi
		push	20009h
		lea	ecx, [esp+0ECh+Dst]
		call	sub_10006392
		test	al, al
		jz	loc_1000895B
		mov	esi, [esp+0E0h+var_CC]

loc_1000870E:				; CODE XREF: sub_100083D0+311j
		mov	eax, [esp+0E0h+var_A0]
		or	eax, [esp+0E0h+var_9C]
		jz	short loc_10008736
		push	[esp+0E0h+var_B4]
		lea	eax, [esp+0E4h+var_A0]
		push	eax
		push	20007h
		lea	ecx, [esp+0ECh+Dst]
		call	sub_10006392
		test	al, al
		jz	short loc_10008757

loc_10008736:				; CODE XREF: sub_100083D0+346j
		test	esi, esi
		jz	short loc_100087AC
		mov	eax, esi
		lea	ecx, [esp+0E0h+Dst]
		shl	eax, 2
		push	eax
		lea	eax, [esp+0E4h+JobObjectInformation]
		push	eax
		push	20002h
		call	sub_10006392
		test	al, al
		jnz	short loc_1000875F

loc_10008757:				; CODE XREF: sub_100083D0+30Dj
					; sub_100083D0+364j
		push	11h

loc_10008759:				; CODE XREF: sub_100083D0+31Aj
		pop	esi
		jmp	loc_1000895B
; ---------------------------------------------------------------------------

loc_1000875F:				; CODE XREF: sub_100083D0+385j
		mov	eax, [esp+0E0h+var_D0]
		mov	[esp+0E0h+var_2C], eax
		mov	eax, [esp+0E0h+var_A4]
		jmp	short loc_1000878D
; ---------------------------------------------------------------------------

loc_10008770:				; CODE XREF: sub_100083D0+278j
		push	offset VarName	; "MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA"
		call	ds:getenv
		pop	ecx
		test	eax, eax
		jz	short loc_100087AC
		mov	eax, [ebx+50h]
		mov	[esp+0E0h+var_2C], eax
		mov	eax, [ebx+54h]

loc_1000878D:				; CODE XREF: sub_100083D0+39Ej
		or	[esp+0E0h+var_3C], 100h
		or	[esp+0E0h+var_30], 0FFFFFFFFh
		mov	byte ptr [esp+0E0h+var_C8], 1
		mov	[esp+0E0h+var_28], eax

loc_100087AC:				; CODE XREF: sub_100083D0+368j
					; sub_100083D0+3AEj
		mov	edi, [esp+0E0h+var_AC]
		cmp	dword ptr [edi+28h], 0
		jnz	short loc_100087EE
		push	24h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100087E9
		xor	eax, eax
		mov	dword ptr [esi], offset	off_1002BC80
		push	eax
		push	eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		call	sub_10009139
		mov	[esi+4], eax
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		jmp	short loc_100087EB
; ---------------------------------------------------------------------------

loc_100087E9:				; CODE XREF: sub_100083D0+3F3j
		xor	esi, esi

loc_100087EB:				; CODE XREF: sub_100083D0+417j
		mov	[edi+28h], esi

loc_100087EE:				; CODE XREF: sub_100083D0+3E4j
		and	[esp+0E0h+var_8C], 0
		and	[esp+0E0h+var_88], 0
		and	[esp+0E0h+var_84], 0
		and	[esp+0E0h+var_80], 0
		push	30h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10008839
		push	dword ptr [edi+28h]
		lea	ecx, [esp+0E4h+var_B0]
		push	[esp+0E4h+var_C4]
		call	sub_1000628A
		push	eax
		push	ecx
		lea	ecx, [esp+0F0h+var_A8]
		call	sub_1000628A
		pop	ecx
		push	eax
		mov	ecx, esi
		call	sub_1001779E
		mov	esi, eax
		jmp	short loc_1000883B
; ---------------------------------------------------------------------------

loc_10008839:				; CODE XREF: sub_100083D0+43Fj
		xor	esi, esi

loc_1000883B:				; CODE XREF: sub_100083D0+467j
		lea	eax, [esp+0E0h+var_8C]
		mov	ecx, esi
		push	eax		; int
		lea	eax, [esp+0E4h+Dst]
		push	eax		; int
		push	[esp+0E8h+var_C8] ; int
		push	[esp+0ECh+var_7C] ; wchar_t *
		push	[esp+0F0h+Str]	; Str
		call	sub_1001789C
		test	eax, eax
		jz	short loc_10008860
		mov	edx, eax
		jmp	short loc_1000886E
; ---------------------------------------------------------------------------

loc_10008860:				; CODE XREF: sub_100083D0+48Aj
		push	esi
		mov	ecx, ebx
		call	sub_10014EB0
		test	al, al
		jnz	short loc_1000887C
		xor	edx, edx

loc_1000886E:				; CODE XREF: sub_100083D0+48Ej
		mov	ecx, esi
		call	sub_10007EBC
		mov	esi, eax
		jmp	loc_10008952
; ---------------------------------------------------------------------------

loc_1000887C:				; CODE XREF: sub_100083D0+49Aj
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		call	dword ptr [eax]
		cmp	[esp+0E0h+var_C4], 0
		jz	loc_10008929
		cmp	[esp+0E0h+var_C4], 0FFFFFFFFh
		jz	loc_10008929
		push	8
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_100088B8
		lea	ecx, [esp+0E0h+var_C4]
		call	sub_1000628A
		mov	[edi], eax
		mov	[edi+4], ebx
		jmp	short loc_100088BA
; ---------------------------------------------------------------------------

loc_100088B8:				; CODE XREF: sub_100083D0+4D6j
		xor	edi, edi

loc_100088BA:				; CODE XREF: sub_100083D0+4E6j
		mov	ebx, [esp+0E0h+var_AC]
		push	8		; cbJobObjectInformationLength
		mov	[esp+0E4h+JobObjectInformation], edi
		mov	eax, [ebx+4]
		mov	[esp+0E4h+var_74], eax
		lea	eax, [esp+0E4h+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	7		; JobObjectInformationClass
		push	dword ptr [edi]	; hJob
		call	ds:SetInformationJobObject
		test	eax, eax
		jnz	short loc_100088F3
		xor	edx, edx
		mov	ecx, esi
		call	sub_10007EBC
		push	edi
		mov	esi, eax
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		jmp	short loc_10008952
; ---------------------------------------------------------------------------

loc_100088F3:				; CODE XREF: sub_100083D0+50Cj
		lea	eax, [esp+0E0h+Str]
		mov	[esp+0E0h+Str],	edi
		push	eax
		lea	ecx, [ebx+2Ch]
		call	sub_10008D20
		mov	eax, [esp+0E0h+var_84]
		mov	[esp+0E0h+Str],	eax
		movzx	eax, byte_10031F2A
		push	eax
		lea	eax, [esp+0E4h+Str]
		push	eax
		push	ecx
		lea	eax, [esp+0ECh+JobObjectInformation]
		push	eax
		lea	ecx, [ebx+3Ch]
		call	sub_1000926E
		jmp	short loc_10008938
; ---------------------------------------------------------------------------

loc_10008929:				; CODE XREF: sub_100083D0+4B8j
					; sub_100083D0+4C3j
		cmp	dword ptr [edi+40h], 0
		jnz	short loc_10008938
		push	dword ptr [edi+8] ; hEvent
		call	ds:SetEvent

loc_10008938:				; CODE XREF: sub_100083D0+557j
					; sub_100083D0+55Dj
		lea	eax, [esp+0E0h+JobObjectInformation]
		push	eax
		lea	ecx, [esp+0E4h+var_8C]
		call	sub_10006249
		mov	edi, [esp+0E0h+var_90]
		mov	esi, eax
		movsd
		movsd
		movsd
		movsd
		xor	esi, esi

loc_10008952:				; CODE XREF: sub_100083D0+4A7j
					; sub_100083D0+521j
		lea	ecx, [esp+0E0h+var_8C]
		call	sub_100061B8

loc_1000895B:				; CODE XREF: sub_100083D0+334j
					; sub_100083D0+38Aj
		push	0
		push	1
		lea	ecx, [esp+0E8h+var_1C]
		call	sub_100022FA
		cmp	[esp+0E0h+var_24], 0
		jz	short loc_10008990
		push	[esp+0E0h+var_24]
		call	dword_10031F38
		push	[esp+0E0h+var_24]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10008990:				; CODE XREF: sub_100083D0+5A3j
		lea	ecx, [esp+0E0h+var_C4]
		call	sub_10004633

loc_10008999:				; CODE XREF: sub_100083D0+213j
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10004633
		lea	ecx, [esp+0E0h+var_A8]
		call	sub_10004633

loc_100089AB:				; CODE XREF: sub_100083D0+12Cj
					; sub_100083D0+1BFj ...
		push	[esp+0E0h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, esi

loc_100089B7:				; CODE XREF: sub_100083D0+4Bj
		mov	ecx, [esp+0E0h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_100083D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100089CE	proc near		; DATA XREF: .rdata:1002BCA4o
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [ecx+8] ; hHandle
		call	ds:WaitForSingleObject
		xor	eax, eax
		retn
sub_100089CE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100089DC	proc near		; CODE XREF: sub_1000D6C3+2Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ecx
		push	esi
		push	edi
		lea	ebp, [ebx+10h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebx+3Ch]
		mov	esi, eax
		mov	edi, [esp+14h+arg_0]
		mov	edx, esi
		mov	ecx, [esi+4]
		jmp	short loc_10008A0B
; ---------------------------------------------------------------------------

loc_100089FD:				; CODE XREF: sub_100089DC+33j
		cmp	[ecx+10h], edi
		jnb	short loc_10008A07
		mov	ecx, [ecx+8]
		jmp	short loc_10008A0B
; ---------------------------------------------------------------------------

loc_10008A07:				; CODE XREF: sub_100089DC+24j
		mov	edx, ecx
		mov	ecx, [ecx]

loc_10008A0B:				; CODE XREF: sub_100089DC+1Fj
					; sub_100089DC+29j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_100089FD
		cmp	edx, esi
		jz	short loc_10008A1E
		cmp	edi, [edx+10h]
		mov	[esp+14h+var_4], edx
		jnb	short loc_10008A22

loc_10008A1E:				; CODE XREF: sub_100089DC+37j
		mov	[esp+14h+var_4], esi

loc_10008A22:				; CODE XREF: sub_100089DC+40j
		lea	ecx, [esp+14h+var_4]
		cmp	[ecx], eax
		jnz	short loc_10008A47
		lea	eax, [esp+14h+arg_0]
		push	eax
		lea	eax, [esp+18h+var_4]
		push	eax
		lea	ecx, [ebx+34h]
		call	sub_1000902C
		mov	eax, [eax]
		cmp	eax, [ebx+34h]
		jnz	short loc_10008A47
		xor	bl, bl
		jmp	short loc_10008A49
; ---------------------------------------------------------------------------

loc_10008A47:				; CODE XREF: sub_100089DC+4Cj
					; sub_100089DC+65j
		mov	bl, 1

loc_10008A49:				; CODE XREF: sub_100089DC+69j
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		pop	ecx
		retn	4
sub_100089DC	endp


; =============== S U B	R O U T	I N E =======================================


; void __stdcall Callback(PVOID, BOOLEAN)
Callback	proc near		; DATA XREF: sub_10008A71+B5o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax+8] ; lpOverlapped
		push	1		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [eax+0Ch] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		retn	8
Callback	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008A71(HANDLE Process)
sub_10008A71	proc near		; DATA XREF: .rdata:1002BCA8o

TargetHandle	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
Process		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		push	10h
		mov	[esp+24h+var_10], ebx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10008AA8
		push	[esp+20h+Process] ; Process
		mov	edi, [ebx+4]
		call	ds:GetProcessId
		xor	ebx, ebx
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], eax
		mov	[esi+0Ch], edi
		jmp	short loc_10008AAC
; ---------------------------------------------------------------------------

loc_10008AA8:				; CODE XREF: sub_10008A71+19j
		xor	ebx, ebx
		mov	esi, ebx

loc_10008AAC:				; CODE XREF: sub_10008A71+35j
		push	ebp
		lea	ebp, [esi+8]
		cmp	[ebp+0], ebx
		jz	loc_10008B55
		mov	edi, ds:GetCurrentProcess
		lea	eax, [esp+24h+TargetHandle]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		push	100000h		; dwDesiredAccess
		push	eax		; lpTargetHandle
		call	edi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+38h+Process] ; hSourceHandle
		call	edi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10008B55
		push	[esp+24h+TargetHandle]
		lea	ecx, [esi+4]
		call	sub_100045FD
		mov	edi, [esp+24h+var_10]
		lea	eax, [edi+10h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+0]
		lea	ecx, [esp+24h+var_10]
		push	ecx
		lea	ecx, [esp+28h+var_8]
		mov	[esp+28h+var_10], eax
		push	ecx
		lea	ecx, [edi+34h]
		mov	[esp+2Ch+var_C], esi
		call	sub_1000919F
		cmp	byte ptr [eax+4], 0
		jnz	short loc_10008B21
		push	2
		pop	ebx
		jmp	short loc_10008B49
; ---------------------------------------------------------------------------

loc_10008B21:				; CODE XREF: sub_10008A71+A9j
		push	0Ch		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	esi		; Context
		push	offset Callback	; Callback
		push	dword ptr [esi+4] ; hObject
		push	esi		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jnz	short loc_10008B47
		push	ebp
		lea	ecx, [edi+34h]
		call	sub_10008F9A
		xor	ebx, ebx
		inc	ebx
		jmp	short loc_10008B49
; ---------------------------------------------------------------------------

loc_10008B47:				; CODE XREF: sub_10008A71+C6j
		mov	esi, ebx

loc_10008B49:				; CODE XREF: sub_10008A71+AEj
					; sub_10008A71+D4j
		lea	eax, [edi+10h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_10008B58
; ---------------------------------------------------------------------------

loc_10008B55:				; CODE XREF: sub_10008A71+42j
					; sub_10008A71+6Cj
		xor	ebx, ebx
		inc	ebx

loc_10008B58:				; CODE XREF: sub_10008A71+E2j
		pop	ebp
		test	esi, esi
		jz	short loc_10008B6D
		lea	ecx, [esi+4]
		call	sub_10004633
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10008B6D:				; CODE XREF: sub_10008A71+EAj
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 14h
		retn	4
sub_10008A71	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10008B78(void *Src,	void *)
sub_10008B78	proc near		; DATA XREF: .rdata:1002BCACo

StringSid	= word ptr -4Ch
var_34		= byte ptr -34h
var_24		= dword	ptr -24h
Dst		= byte ptr -1Ch
var_4		= dword	ptr -4
Src		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+Src]
		call	sub_100063BF
		cmp	dword ptr [eax], 5
		jge	short loc_10008BA7
		push	3
		pop	eax
		jmp	loc_10008C3F
; ---------------------------------------------------------------------------

loc_10008BA7:				; CODE XREF: sub_10008B78+25j
		push	edi		; Src
		lea	ecx, [esp+5Ch+StringSid] ; Dst
		call	sub_10001C68
		lea	edx, [esp+58h+StringSid]
		lea	ecx, [esp+58h+var_34]
		call	sub_10007C92
		xor	ebx, ebx
		lea	ecx, [esp+58h+StringSid]
		push	ebx
		push	1
		call	sub_100022FA
		cmp	[esp+58h+var_24], ebx
		jnz	short loc_10008C0F
		push	esi		; Src
		lea	ecx, [esp+5Ch+Dst] ; Dst
		call	sub_10001C68
		push	edi		; Src
		lea	ecx, [esp+5Ch+StringSid] ; Dst
		call	sub_10001C68
		lea	edx, [esp+58h+Dst]
		lea	ecx, [esp+58h+StringSid] ; StringSid
		call	sub_10007B72
		push	ebx
		push	1
		lea	ecx, [esp+60h+StringSid]
		mov	esi, eax
		call	sub_100022FA
		push	ebx
		push	1
		lea	ecx, [esp+60h+Dst]
		call	sub_100022FA
		jmp	short loc_10008C31
; ---------------------------------------------------------------------------

loc_10008C0F:				; CODE XREF: sub_10008B78+58j
		mov	ecx, esi
		call	sub_10001ADC
		push	eax
		push	esi
		push	[esp+60h+var_24]
		lea	ecx, [esp+64h+var_34]
		push	ebx
		call	sub_10003F01
		test	eax, eax
		jz	short loc_10008C2F
		push	0Eh
		pop	esi
		jmp	short loc_10008C31
; ---------------------------------------------------------------------------

loc_10008C2F:				; CODE XREF: sub_10008B78+B0j
		mov	esi, ebx

loc_10008C31:				; CODE XREF: sub_10008B78+95j
					; sub_10008B78+B5j
		push	ebx
		push	1
		lea	ecx, [esp+60h+var_34]
		call	sub_100022FA
		mov	eax, esi

loc_10008C3F:				; CODE XREF: sub_10008B78+2Aj
		mov	ecx, [esp+58h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10008B78	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10008C53(void *Src)
sub_10008C53	proc near		; DATA XREF: .rdata:1002BCB0o

StringSid	= word ptr -34h
var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
Src		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		push	esi
		mov	esi, [ebp+Src]
		call	sub_100063BF
		cmp	dword ptr [eax], 5
		jge	short loc_10008C7A
		push	3
		pop	eax
		jmp	short loc_10008CDB
; ---------------------------------------------------------------------------

loc_10008C7A:				; CODE XREF: sub_10008C53+20j
		push	esi		; Src
		lea	ecx, [esp+3Ch+StringSid] ; Dst
		call	sub_10001C68
		lea	edx, [esp+38h+StringSid]
		lea	ecx, [esp+38h+var_1C]
		call	sub_10007C92
		push	0
		push	1
		lea	ecx, [esp+40h+StringSid]
		call	sub_100022FA
		cmp	[esp+38h+var_C], 0
		jnz	short loc_10008CAA
		push	0Eh
		pop	esi
		jmp	short loc_10008CCC
; ---------------------------------------------------------------------------

loc_10008CAA:				; CODE XREF: sub_10008C53+50j
		push	esi		; Src
		lea	ecx, [esp+3Ch+StringSid] ; Dst
		call	sub_10001C68
		lea	ecx, [esp+38h+StringSid] ; StringSid
		call	sub_10007C0E
		push	0
		push	1
		lea	ecx, [esp+40h+StringSid]
		mov	esi, eax
		call	sub_100022FA

loc_10008CCC:				; CODE XREF: sub_10008C53+55j
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_100022FA
		mov	eax, esi

loc_10008CDB:				; CODE XREF: sub_10008C53+25j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10008C53	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008CED	proc near		; CODE XREF: sub_10008051+135p
					; sub_1000FE24+20p ...
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ecx, [edi]
		jz	short loc_10008D15
		push	esi

loc_10008D04:				; CODE XREF: sub_10008CED+25j
		mov	esi, [ecx]
		push	ecx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	ecx, esi
		cmp	esi, [edi]
		jnz	short loc_10008D04
		pop	esi

loc_10008D15:				; CODE XREF: sub_10008CED+14j
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		retn
sub_10008CED	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008D20	proc near		; CODE XREF: sub_100083D0+52Fp
					; sub_10014EB0+11Fp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi]
		push	dword ptr [edi+4]
		push	edi
		call	sub_1000916C
		mov	edx, eax
		lea	eax, [edx+8]
		test	eax, eax
		jz	short loc_10008D40
		mov	ecx, [esp+8+arg_0]
		mov	ecx, [ecx]
		mov	[eax], ecx

loc_10008D40:				; CODE XREF: sub_10008D20+16j
		mov	ecx, [esi+4]
		mov	eax, 15555554h
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_10008D5A
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10008D5A:				; CODE XREF: sub_10008D20+2Dj
		lea	eax, [ecx+1]
		mov	[esi+4], eax
		mov	[edi+4], edx
		mov	eax, [edx+4]
		pop	edi
		pop	esi
		mov	[eax], edx
		retn	4
sub_10008D20	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008D6D	proc near		; CODE XREF: StartAddress+163p
					; sub_100090A2+4Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_10004B74
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008D8D
		mov	edi, [ebx+8]
		jmp	short loc_10008DA5
; ---------------------------------------------------------------------------

loc_10008D8D:				; CODE XREF: sub_10008D6D+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008D9A
		mov	edi, ecx
		jmp	short loc_10008DA5
; ---------------------------------------------------------------------------

loc_10008D9A:				; CODE XREF: sub_10008D6D+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_10008E15

loc_10008DA5:				; CODE XREF: sub_10008D6D+1Ej
					; sub_10008D6D+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_10008DB1
		mov	[edi+4], esi

loc_10008DB1:				; CODE XREF: sub_10008D6D+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10008DBE
		mov	[eax+4], edi
		jmp	short loc_10008DC9
; ---------------------------------------------------------------------------

loc_10008DBE:				; CODE XREF: sub_10008D6D+4Aj
		cmp	[esi], ebx
		jnz	short loc_10008DC6
		mov	[esi], edi
		jmp	short loc_10008DC9
; ---------------------------------------------------------------------------

loc_10008DC6:				; CODE XREF: sub_10008D6D+53j
		mov	[esi+8], edi

loc_10008DC9:				; CODE XREF: sub_10008D6D+4Fj
					; sub_10008D6D+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_10008DEC
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10008DDA
		mov	eax, esi
		jmp	short loc_10008DEA
; ---------------------------------------------------------------------------

loc_10008DDA:				; CODE XREF: sub_10008D6D+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_10008DE4
; ---------------------------------------------------------------------------

loc_10008DE0:				; CODE XREF: sub_10008D6D+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_10008DE4:				; CODE XREF: sub_10008D6D+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008DE0

loc_10008DEA:				; CODE XREF: sub_10008D6D+6Bj
		mov	[edx], eax

loc_10008DEC:				; CODE XREF: sub_10008D6D+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_10008E6C
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10008DFE
		mov	eax, esi
		jmp	short loc_10008E10
; ---------------------------------------------------------------------------

loc_10008DFE:				; CODE XREF: sub_10008D6D+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_10008E0A
; ---------------------------------------------------------------------------

loc_10008E05:				; CODE XREF: sub_10008D6D+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_10008E0A:				; CODE XREF: sub_10008D6D+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008E05

loc_10008E10:				; CODE XREF: sub_10008D6D+8Fj
		mov	[edx+8], eax
		jmp	short loc_10008E6C
; ---------------------------------------------------------------------------

loc_10008E15:				; CODE XREF: sub_10008D6D+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_10008E25
		mov	esi, edx
		jmp	short loc_10008E3F
; ---------------------------------------------------------------------------

loc_10008E25:				; CODE XREF: sub_10008D6D+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_10008E31
		mov	[edi+4], esi

loc_10008E31:				; CODE XREF: sub_10008D6D+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_10008E3F:				; CODE XREF: sub_10008D6D+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10008E4C
		mov	[eax+4], edx
		jmp	short loc_10008E5A
; ---------------------------------------------------------------------------

loc_10008E4C:				; CODE XREF: sub_10008D6D+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_10008E57
		mov	[eax], edx
		jmp	short loc_10008E5A
; ---------------------------------------------------------------------------

loc_10008E57:				; CODE XREF: sub_10008D6D+E4j
		mov	[eax+8], edx

loc_10008E5A:				; CODE XREF: sub_10008D6D+DDj
					; sub_10008D6D+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_10008E6C:				; CODE XREF: sub_10008D6D+85j
					; sub_10008D6D+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_10008F76
		jmp	loc_10008F2F
; ---------------------------------------------------------------------------

loc_10008E7B:				; CODE XREF: sub_10008D6D+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_10008F72
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_10008EF7
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008EA7
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10004AF0
		mov	ecx, [esi+8]

loc_10008EA7:				; CODE XREF: sub_10008D6D+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10008F2A
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008EBE
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_10008F26

loc_10008EBE:				; CODE XREF: sub_10008D6D+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008EDC
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10004B31
		mov	ecx, [esi+8]

loc_10008EDC:				; CODE XREF: sub_10008D6D+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10004AF0
		jmp	short loc_10008F72
; ---------------------------------------------------------------------------

loc_10008EF7:				; CODE XREF: sub_10008D6D+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008F0F
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10004B31
		mov	ecx, [esi]

loc_10008F0F:				; CODE XREF: sub_10008D6D+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10008F2A
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F3D
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F3D

loc_10008F26:				; CODE XREF: sub_10008D6D+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_10008F2A:				; CODE XREF: sub_10008D6D+13Ej
					; sub_10008D6D+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_10008F2F:				; CODE XREF: sub_10008D6D+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_10008E7B
		jmp	short loc_10008F72
; ---------------------------------------------------------------------------

loc_10008F3D:				; CODE XREF: sub_10008D6D+1AFj
					; sub_10008D6D+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F5A
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10004AF0
		mov	ecx, [esi]

loc_10008F5A:				; CODE XREF: sub_10008D6D+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10004B31

loc_10008F72:				; CODE XREF: sub_10008D6D+112j
					; sub_10008D6D+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_10008F76:				; CODE XREF: sub_10008D6D+103j
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_10008F89
		dec	eax
		mov	[ebp+4], eax

loc_10008F89:				; CODE XREF: sub_10008D6D+216j
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_10008D6D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008F9A	proc near		; CODE XREF: StartAddress+BAp
					; sub_10008A71+CCp

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, ecx
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	ebx, [ebp+0]
		mov	esi, ebx
		mov	eax, [ebx+4]
		mov	edx, eax
		cmp	byte ptr [edx+0Dh], 0
		jnz	short loc_10008FD7
		mov	ecx, [edi]

loc_10008FB6:				; CODE XREF: sub_10008F9A+3Bj
		cmp	[edx+10h], ecx
		jnb	short loc_10008FC0
		mov	edx, [edx+8]
		jmp	short loc_10008FD1
; ---------------------------------------------------------------------------

loc_10008FC0:				; CODE XREF: sub_10008F9A+1Fj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10008FCD
		cmp	ecx, [edx+10h]
		jnb	short loc_10008FCD
		mov	esi, edx

loc_10008FCD:				; CODE XREF: sub_10008F9A+2Aj
					; sub_10008F9A+2Fj
		mov	ebx, edx
		mov	edx, [edx]

loc_10008FD1:				; CODE XREF: sub_10008F9A+24j
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10008FB6

loc_10008FD7:				; CODE XREF: sub_10008F9A+18j
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_10008FDF
		mov	eax, [esi]

loc_10008FDF:				; CODE XREF: sub_10008F9A+41j
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10008FFB
		mov	ecx, [edi]

loc_10008FE7:				; CODE XREF: sub_10008F9A+5Fj
		cmp	ecx, [eax+10h]
		jnb	short loc_10008FF2
		mov	esi, eax
		mov	eax, [eax]
		jmp	short loc_10008FF5
; ---------------------------------------------------------------------------

loc_10008FF2:				; CODE XREF: sub_10008F9A+50j
		mov	eax, [eax+8]

loc_10008FF5:				; CODE XREF: sub_10008F9A+56j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008FE7

loc_10008FFB:				; CODE XREF: sub_10008F9A+49j
		xor	edi, edi
		mov	[esp+10h+arg_0], ebx
		cmp	ebx, esi
		jz	short loc_10009015

loc_10009005:				; CODE XREF: sub_10008F9A+79j
		lea	ecx, [esp+10h+arg_0]
		inc	edi
		call	sub_10004B74
		cmp	[esp+10h+arg_0], esi
		jnz	short loc_10009005

loc_10009015:				; CODE XREF: sub_10008F9A+69j
		push	esi
		push	ebx
		lea	eax, [esp+18h+arg_0]
		mov	ecx, ebp
		push	eax
		call	sub_100090A2
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10008F9A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000902C	proc near		; CODE XREF: StartAddress+149p
					; sub_100089DC+5Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	edx, [ecx]
		mov	ecx, edx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	eax, [edx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10009058
		push	edi
		mov	edi, [esi]

loc_10009043:				; CODE XREF: sub_1000902C+29j
		cmp	[eax+10h], edi
		jnb	short loc_1000904D
		mov	eax, [eax+8]
		jmp	short loc_10009051
; ---------------------------------------------------------------------------

loc_1000904D:				; CODE XREF: sub_1000902C+1Aj
		mov	ecx, eax
		mov	eax, [eax]

loc_10009051:				; CODE XREF: sub_1000902C+1Fj
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10009043
		pop	edi

loc_10009058:				; CODE XREF: sub_1000902C+12j
		cmp	ecx, edx
		jz	short loc_10009066
		mov	eax, [esi]
		mov	[ebp+arg_4], ecx
		cmp	eax, [ecx+10h]
		jnb	short loc_10009069

loc_10009066:				; CODE XREF: sub_1000902C+2Ej
		mov	[ebp+arg_4], edx

loc_10009069:				; CODE XREF: sub_1000902C+38j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_1000902C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009078	proc near		; CODE XREF: sub_10008051+F3p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_10009106
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_10009078	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100090A2	proc near		; CODE XREF: sub_10008051+107p
					; sub_10008051+124p ...

var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_100090F4
		cmp	[ebp+arg_8], eax
		jnz	short loc_100090F4
		push	dword ptr [eax+4]
		call	sub_10009106
		mov	eax, [edi]
		mov	[eax+4], eax
		mov	eax, [edi]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+8], eax
		mov	eax, [edi]
		and	dword ptr [edi+4], 0
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_100090FE
; ---------------------------------------------------------------------------

loc_100090DD:				; CODE XREF: sub_100090A2+55j
		lea	ecx, [ebp+arg_4]
		call	sub_10004B74
		push	esi
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		call	sub_10008D6D
		mov	esi, [ebp+arg_4]

loc_100090F4:				; CODE XREF: sub_100090A2+Fj
					; sub_100090A2+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_100090DD
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_100090FE:				; CODE XREF: sub_100090A2+39j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100090A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009106	proc near		; CODE XREF: sub_10009078+8p
					; sub_100090A2+19p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ebx, ecx
		mov	esi, edi
		cmp	byte ptr [edi+0Dh], 0
		jnz	short loc_10009133

loc_10009117:				; CODE XREF: sub_10009106+2Bj
		push	dword ptr [esi+8]
		mov	ecx, ebx
		call	sub_10009106
		mov	esi, [esi]
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [esi+0Dh], 0
		mov	edi, esi
		pop	ecx
		jz	short loc_10009117

loc_10009133:				; CODE XREF: sub_10009106+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10009106	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009139	proc near		; CODE XREF: sub_100083D0+405p
					; sub_1000FDA5+Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000914C
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000914C:				; CODE XREF: sub_10009139+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000915A
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_1000915E
; ---------------------------------------------------------------------------

loc_1000915A:				; CODE XREF: sub_10009139+19j
		mov	edx, [esp+arg_4]

loc_1000915E:				; CODE XREF: sub_10009139+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_10009169
		mov	[ecx], edx

locret_10009169:			; CODE XREF: sub_10009139+2Cj
		retn	8
sub_10009139	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000916C	proc near		; CODE XREF: sub_10007F31+21p
					; sub_10008D20+Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000917F
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000917F:				; CODE XREF: sub_1000916C+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000918D
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_10009191
; ---------------------------------------------------------------------------

loc_1000918D:				; CODE XREF: sub_1000916C+19j
		mov	edx, [esp+arg_4]

loc_10009191:				; CODE XREF: sub_1000916C+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_1000919C
		mov	[ecx], edx

locret_1000919C:			; CODE XREF: sub_1000916C+2Cj
		retn	8
sub_1000916C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000919F	proc near		; CODE XREF: sub_10008A71+A0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	18h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_100091B7
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100091B7:				; CODE XREF: sub_1000919F+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_100091C6
		mov	eax, [esi]
		mov	[ecx], eax

loc_100091C6:				; CODE XREF: sub_1000919F+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_100091D1
		mov	eax, [esi]
		mov	[ecx], eax

loc_100091D1:				; CODE XREF: sub_1000919F+2Cj
		push	edi
		lea	edi, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	edi, edi
		jz	short loc_100091ED
		mov	ecx, [esp+8+arg_4]
		mov	eax, [ecx]
		mov	[edi], eax
		mov	eax, [ecx+4]
		mov	[edi+4], eax

loc_100091ED:				; CODE XREF: sub_1000919F+3Ej
		push	edx
		push	edi
		push	ecx
		push	[esp+14h+arg_0]
		mov	ecx, esi
		call	sub_10005207
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		retn	8
sub_1000919F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009204	proc near		; CODE XREF: sub_100083D0+177p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		push	1Ch
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_1000921D
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000921D:				; CODE XREF: sub_10009204+11j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000922C
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000922C:				; CODE XREF: sub_10009204+22j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10009237
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009237:				; CODE XREF: sub_10009204+2Dj
		xor	ebx, ebx
		lea	ecx, [edx+10h]
		mov	[edx+0Ch], bx
		test	ecx, ecx
		jz	short loc_10009254
		mov	eax, [esp+8+arg_C]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ecx], eax
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx

loc_10009254:				; CODE XREF: sub_10009204+3Ej
		push	edx
		push	ecx
		push	[esp+10h+arg_4]
		mov	ecx, esi
		push	[esp+14h+arg_0]
		call	sub_1000930F
		mov	eax, [esp+8+arg_0]
		pop	esi
		pop	ebx
		retn	14h
sub_10009204	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000926E	proc near		; CODE XREF: sub_100083D0+552p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	dl, 1
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [ebx]
		mov	esi, ecx
		mov	byte ptr [esp+10h+var_4], dl
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100092AC
		push	ebp
		mov	ebp, [edi]

loc_1000928E:				; CODE XREF: sub_1000926E+3Bj
		cmp	ebp, [eax+10h]
		mov	esi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_100092A2
		mov	eax, [eax]
		jmp	short loc_100092A5
; ---------------------------------------------------------------------------

loc_100092A2:				; CODE XREF: sub_1000926E+2Ej
		mov	eax, [eax+8]

loc_100092A5:				; CODE XREF: sub_1000926E+32j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000928E
		pop	ebp

loc_100092AC:				; CODE XREF: sub_1000926E+1Bj
		mov	eax, esi
		mov	[esp+10h+arg_8], eax
		test	dl, dl
		jz	short loc_100092E9
		cmp	esi, [ecx]
		jnz	short loc_100092DC
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	1

loc_100092C2:				; CODE XREF: sub_1000926E+8Cj
		lea	eax, [esp+20h+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_10009422
		mov	ecx, [eax]
		mov	eax, [esp+10h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10009308
; ---------------------------------------------------------------------------

loc_100092DC:				; CODE XREF: sub_1000926E+4Aj
		lea	ecx, [esp+10h+arg_8]
		call	sub_10004EDC
		mov	eax, [esp+10h+arg_8]

loc_100092E9:				; CODE XREF: sub_1000926E+46j
		mov	ecx, [eax+10h]
		cmp	ecx, [edi]
		jnb	short loc_100092FC
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	[esp+1Ch+var_4]
		jmp	short loc_100092C2
; ---------------------------------------------------------------------------

loc_100092FC:				; CODE XREF: sub_1000926E+80j
		mov	ecx, [esp+10h+arg_0]
		mov	[ecx], eax
		mov	eax, ecx
		mov	byte ptr [ecx+4], 0

loc_10009308:				; CODE XREF: sub_1000926E+6Cj
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn	10h
sub_1000926E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000930F	proc near		; CODE XREF: sub_10009204+5Cp

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_1000933B
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_10009543
		mov	eax, [esp+10h+arg_0]
		jmp	loc_1000941B
; ---------------------------------------------------------------------------

loc_1000933B:				; CODE XREF: sub_1000930F+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10009363
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_100093FE
		push	[esp+1Ch+arg_C]
		push	ecx

loc_1000935D:				; CODE XREF: sub_1000930F+A0j
		push	esi
		jmp	loc_100093ED
; ---------------------------------------------------------------------------

loc_10009363:				; CODE XREF: sub_1000930F+3Cj
		cmp	esi, ebp
		jnz	short loc_10009380
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_100093FE
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_100093EF
; ---------------------------------------------------------------------------

loc_10009380:				; CODE XREF: sub_1000930F+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_100093B9
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EDC
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_100093B4
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000935D
		push	eax
		jmp	short loc_100093E8
; ---------------------------------------------------------------------------

loc_100093B4:				; CODE XREF: sub_1000930F+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_100093B9:				; CODE XREF: sub_1000930F+76j
		jnb	short loc_100093FE
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B74
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_100093D7
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_100093FE

loc_100093D7:				; CODE XREF: sub_1000930F+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_100093EC
		push	esi

loc_100093E8:				; CODE XREF: sub_1000930F+A3j
		push	0
		jmp	short loc_100093EF
; ---------------------------------------------------------------------------

loc_100093EC:				; CODE XREF: sub_1000930F+D6j
		push	eax

loc_100093ED:				; CODE XREF: sub_1000930F+4Fj
		push	1

loc_100093EF:				; CODE XREF: sub_1000930F+6Fj
					; sub_1000930F+DBj
		push	[esp+2Ch+arg_0]
		call	sub_10009543
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_10009418
; ---------------------------------------------------------------------------

loc_100093FE:				; CODE XREF: sub_1000930F+43j
					; sub_1000930F+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_10009667
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_10009418:				; CODE XREF: sub_1000930F+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_1000941B:				; CODE XREF: sub_1000930F+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_1000930F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009422	proc near		; CODE XREF: sub_1000926E+5Bp

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0CCCCCCBh
		jb	short loc_1000943E
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000943E:				; CODE XREF: sub_10009422+Fj
		push	[ebp+arg_C]
		push	[ebp+arg_10]
		call	sub_1000970E
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [ebp+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_10009468
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_10009487
; ---------------------------------------------------------------------------

loc_10009468:				; CODE XREF: sub_10009422+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000947A
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_10009487
		mov	[ecx], ebx
		jmp	short loc_10009487
; ---------------------------------------------------------------------------

loc_1000947A:				; CODE XREF: sub_10009422+4Aj
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_10009487
		mov	[ecx+8], ebx

loc_10009487:				; CODE XREF: sub_10009422+44j
					; sub_10009422+52j ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_10009524
; ---------------------------------------------------------------------------

loc_10009491:				; CODE XREF: sub_10009422+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_100094D5
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_100094DB
		cmp	esi, [eax+8]
		jnz	short loc_100094B5
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004AF0

loc_100094B5:				; CODE XREF: sub_10009422+87j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_10009521
; ---------------------------------------------------------------------------

loc_100094D5:				; CODE XREF: sub_10009422+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_100094F5

loc_100094DB:				; CODE XREF: sub_10009422+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10009521
; ---------------------------------------------------------------------------

loc_100094F5:				; CODE XREF: sub_10009422+B7j
		cmp	esi, [eax]
		jnz	short loc_10009503
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B31

loc_10009503:				; CODE XREF: sub_10009422+D5j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_10009521:				; CODE XREF: sub_10009422+B1j
					; sub_10009422+D1j
		mov	eax, [esi+4]

loc_10009524:				; CODE XREF: sub_10009422+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10009491
		mov	eax, [edi]
		pop	edi
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	ebp
		retn	14h
sub_10009422	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009543	proc near		; CODE XREF: sub_1000930F+1Ep
					; sub_1000930F+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_1000956B
		push	[ebp+arg_10]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000956B:				; CODE XREF: sub_10009543+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000958C
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_100095AB
; ---------------------------------------------------------------------------

loc_1000958C:				; CODE XREF: sub_10009543+39j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000959E
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_100095AB
		mov	[ecx], edi
		jmp	short loc_100095AB
; ---------------------------------------------------------------------------

loc_1000959E:				; CODE XREF: sub_10009543+4Dj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_100095AB
		mov	[ecx+8], edi

loc_100095AB:				; CODE XREF: sub_10009543+47j
					; sub_10009543+55j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10009648
; ---------------------------------------------------------------------------

loc_100095B5:				; CODE XREF: sub_10009543+109j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_100095F9
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_100095FF
		cmp	esi, [eax+8]
		jnz	short loc_100095D9
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_100095D9:				; CODE XREF: sub_10009543+8Aj
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_10009645
; ---------------------------------------------------------------------------

loc_100095F9:				; CODE XREF: sub_10009543+7Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10009619

loc_100095FF:				; CODE XREF: sub_10009543+85j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10009645
; ---------------------------------------------------------------------------

loc_10009619:				; CODE XREF: sub_10009543+BAj
		cmp	esi, [eax]
		jnz	short loc_10009627
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_10009627:				; CODE XREF: sub_10009543+D8j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_10009645:				; CODE XREF: sub_10009543+B4j
					; sub_10009543+D4j
		mov	eax, [esi+4]

loc_10009648:				; CODE XREF: sub_10009543+6Dj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_100095B5
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10009543	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009667	proc near		; CODE XREF: sub_1000930F+FCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100096A5
		mov	esi, [ebx]

loc_10009688:				; CODE XREF: sub_10009667+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_1000969C
		mov	eax, [eax]
		jmp	short loc_1000969F
; ---------------------------------------------------------------------------

loc_1000969C:				; CODE XREF: sub_10009667+2Fj
		mov	eax, [eax+8]

loc_1000969F:				; CODE XREF: sub_10009667+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10009688

loc_100096A5:				; CODE XREF: sub_10009667+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_100096E2
		cmp	edi, [ecx]
		jnz	short loc_100096D5
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_100096BB:				; CODE XREF: sub_10009667+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_10009543
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10009706
; ---------------------------------------------------------------------------

loc_100096D5:				; CODE XREF: sub_10009667+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EDC
		mov	esi, [esp+14h+arg_8]

loc_100096E2:				; CODE XREF: sub_10009667+46j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]
		cmp	eax, [ebx]
		jnb	short loc_100096F5
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_100096BB
; ---------------------------------------------------------------------------

loc_100096F5:				; CODE XREF: sub_10009667+84j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10009706:				; CODE XREF: sub_10009667+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_10009667	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000970E	proc near		; CODE XREF: sub_10009422+22p

arg_4		= dword	ptr  8

		push	esi
		push	14h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10009726
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10009726:				; CODE XREF: sub_1000970E+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10009735
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009735:				; CODE XREF: sub_1000970E+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10009740
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009740:				; CODE XREF: sub_1000970E+2Cj
		lea	ecx, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	ecx, ecx
		jz	short loc_10009755
		mov	eax, [esp+4+arg_4]
		mov	eax, [eax]
		mov	[ecx], eax

loc_10009755:				; CODE XREF: sub_1000970E+3Dj
		mov	eax, edx
		pop	esi
		retn	8
sub_1000970E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000975B	proc near		; CODE XREF: sub_100097E2+4Cp
					; sub_100097E2+A2p
		cmp	ecx, 9		; switch 10 cases
		ja	short loc_1000979A ; jumptable 10009760	default	case
		jmp	ds:off_1000979F[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10009767:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+50h]	; jumptable 10009760 case 1
		retn
; ---------------------------------------------------------------------------

loc_1000976B:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+5Ch]	; jumptable 10009760 case 2
		retn
; ---------------------------------------------------------------------------

loc_1000976F:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+68h]	; jumptable 10009760 case 3
		retn
; ---------------------------------------------------------------------------

loc_10009773:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+74h]	; jumptable 10009760 case 4
		retn
; ---------------------------------------------------------------------------

loc_10009777:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+80h]	; jumptable 10009760 case 5
		retn
; ---------------------------------------------------------------------------

loc_1000977E:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+8Ch]	; jumptable 10009760 case 6
		retn
; ---------------------------------------------------------------------------

loc_10009785:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+98h]	; jumptable 10009760 case 7
		retn
; ---------------------------------------------------------------------------

loc_1000978C:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+0A4h]	; jumptable 10009760 case 8
		retn
; ---------------------------------------------------------------------------

loc_10009793:				; CODE XREF: sub_1000975B+5j
					; DATA XREF: .text:off_1000979Fo
		mov	eax, [edx+0B0h]	; jumptable 10009760 case 9
		retn
; ---------------------------------------------------------------------------

loc_1000979A:				; CODE XREF: sub_1000975B+3j
					; sub_1000975B+5j
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10009760 default case
		retn
sub_1000975B	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_1000979F	dd offset loc_1000979A	; DATA XREF: sub_1000975B+5r
		dd offset loc_10009767	; jump table for switch	statement
		dd offset loc_1000976B
		dd offset loc_1000976F
		dd offset loc_10009773
		dd offset loc_10009777
		dd offset loc_1000977E
		dd offset loc_10009785
		dd offset loc_1000978C
		dd offset loc_10009793

; =============== S U B	R O U T	I N E =======================================


sub_100097C7	proc near		; CODE XREF: sub_100097E2+5Cp
					; sub_100097E2+B5p

arg_0		= dword	ptr  4

		cmp	ecx, edx
		jb	short loc_100097DF
		cmp	edx, 4Ch
		jb	short loc_100097DF
		cmp	[esp+arg_0], ecx
		ja	short loc_100097DF
		cmp	[esp+arg_0], edx
		jb	short loc_100097DF
		mov	al, 1
		retn
; ---------------------------------------------------------------------------

loc_100097DF:				; CODE XREF: sub_100097C7+2j
					; sub_100097C7+7j ...
		xor	al, al
		retn
sub_100097C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100097E2	proc near		; CODE XREF: sub_10015E06+49p

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
Src		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	2Ch
		push	offset stru_1002DC98
		call	__SEH_prolog4
		mov	ebx, edx
		mov	[ebp+Src], ecx
		test	ecx, ecx
		jz	loc_1000992D
		cmp	ebx, 40h
		jb	loc_1000992D
		cmp	ebx, 400h
		ja	loc_1000992D
		and	[ebp+var_24], 0
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, [ecx+3Ch]
		mov	[ebp+var_20], esi
		mov	[ebp+var_34], esi
		imul	eax, esi, 0Ch
		add	eax, 4Ch
		mov	[ebp+var_1C], eax
		mov	edx, ecx
		mov	ecx, esi
		call	sub_1000975B
		mov	edi, eax
		mov	[ebp+var_38], edi
		push	edi
		mov	edx, [ebp+var_1C]
		mov	ecx, ebx
		call	sub_100097C7
		add	esp, 4
		test	al, al
		jz	loc_10009926
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		push	edi
		call	sub_10018CA2
		mov	esi, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_3C], esi
		push	edi		; Size
		push	[ebp+Src]	; Src
		push	esi		; Dst
		call	memcpy
		add	esp, 10h
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		cmp	[esi+3Ch], eax
		jnz	loc_10009912
		mov	edx, esi
		mov	ecx, eax
		call	sub_1000975B
		cmp	eax, edi
		jnz	loc_10009912
		push	edi
		mov	edx, [ebp+var_1C]
		mov	ecx, ebx
		call	sub_100097C7
		add	esp, 4
		test	al, al
		jz	short loc_10009912
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		lea	eax, [esi+edi]
		mov	[ebp+var_30], eax
		lea	eax, [esi+edx]
		mov	[ebp+var_2C], eax
		xor	edi, edi
		mov	ebx, [ebp+var_20]
		test	ebx, ebx
		jz	short loc_10009904

loc_100098BF:				; CODE XREF: sub_100097E2+120j
		and	[ebp+var_20], 0
		lea	eax, [ebp+Src]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	edi
		mov	ecx, esi
		call	sub_10009935
		mov	edx, eax
		test	edx, edx
		jz	short loc_10009908
		mov	ecx, [ebp+Src]
		dec	ecx
		cmp	ecx, 5
		ja	short loc_10009908
		cmp	edx, esi
		jb	short loc_10009908
		cmp	edx, [ebp+var_2C]
		jb	short loc_10009908
		mov	ecx, [ebp+var_30]
		cmp	edx, ecx
		ja	short loc_10009908
		mov	eax, [ebp+var_20]
		add	eax, edx
		cmp	eax, edx
		jb	short loc_10009908
		cmp	eax, ecx
		ja	short loc_10009908
		inc	edi
		cmp	edi, ebx
		jnz	short loc_100098BF

loc_10009904:				; CODE XREF: sub_100097E2+DBj
		mov	eax, esi
		jmp	short loc_1000992F
; ---------------------------------------------------------------------------

loc_10009908:				; CODE XREF: sub_100097E2+F5j
					; sub_100097E2+FEj ...
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_1000992D
; ---------------------------------------------------------------------------

loc_10009912:				; CODE XREF: sub_100097E2+98j
					; sub_100097E2+A9j ...
		push	esi
		jmp	short loc_1000991F
; ---------------------------------------------------------------------------

loc_10009915:				; DATA XREF: .rdata:stru_1002DC98o
		xor	eax, eax	; Exception filter 0 for function 100097E2
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10009919:				; DATA XREF: .rdata:stru_1002DC98o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100097E2
		push	[ebp+var_24]

loc_1000991F:				; CODE XREF: sub_100097E2+131j
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10009926:				; CODE XREF: sub_100097E2+66j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000992D:				; CODE XREF: sub_100097E2+13j
					; sub_100097E2+1Cj ...
		xor	eax, eax

loc_1000992F:				; CODE XREF: sub_100097E2+124j
		call	__SEH_epilog4
		retn
sub_100097E2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009935	proc near		; CODE XREF: sub_100097E2+ECp
					; sub_1000996B+14p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		cmp	edx, [esi+3Ch]
		jb	short loc_10009945
		xor	eax, eax
		jmp	short loc_10009967
; ---------------------------------------------------------------------------

loc_10009945:				; CODE XREF: sub_10009935+Aj
		lea	eax, [edx+6]
		imul	edx, 0Ch
		imul	eax, 0Ch
		mov	ecx, [eax+esi]
		mov	eax, [esp+4+arg_4]
		mov	[eax], ecx
		mov	eax, [esp+4+arg_8]
		mov	ecx, [edx+esi+40h]
		mov	[eax], ecx
		mov	eax, [edx+esi+44h]
		add	eax, esi

loc_10009967:				; CODE XREF: sub_10009935+Ej
		pop	esi
		retn	0Ch
sub_10009935	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000996B(int, void *Dst)
sub_1000996B	proc near		; CODE XREF: sub_10015C92+118p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Dst		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_10009935
		cmp	[ebp+var_8], 1
		jnz	short loc_100099C6
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jnz	short loc_100099AD
		push	esi
		mov	esi, offset Src
		mov	ecx, esi
		call	sub_10001ADC
		mov	ecx, [ebp+Dst]	; Dst
		push	eax		; int
		push	esi		; Src
		call	sub_1000233F
		mov	al, 1
		pop	esi
		jmp	short loc_100099C8
; ---------------------------------------------------------------------------

loc_100099AD:				; CODE XREF: sub_1000996B+24j
		test	eax, eax
		jz	short loc_100099C6
		test	cl, 1
		jnz	short loc_100099C6
		shr	ecx, 1
		push	ecx		; int
		mov	ecx, [ebp+Dst]
		push	eax		; Src
		call	sub_10003375
		mov	al, 1
		jmp	short loc_100099C8
; ---------------------------------------------------------------------------

loc_100099C6:				; CODE XREF: sub_1000996B+1Dj
					; sub_1000996B+44j ...
		xor	al, al

loc_100099C8:				; CODE XREF: sub_1000996B+40j
					; sub_1000996B+59j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000996B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100099CE	proc near		; DATA XREF: .rdata:off_1002BDDCo
					; .rdata:off_1002BE98o	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+4]
		cmp	eax, [esi+8]
		jz	short loc_10009A0E
		mov	edi, [ebp+arg_0]

loc_100099EA:				; CODE XREF: sub_100099CE+3Ej
		xor	edx, edx

loc_100099EC:				; CODE XREF: sub_100099CE+2Aj
		mov	ecx, [eax+edx*4]
		cmp	ecx, [edi+edx*4]
		jnz	short loc_10009A06
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_100099EC
		mov	ecx, [eax+28h]
		mov	eax, [ebp+arg_4]
		mov	[eax], ecx
		mov	eax, esi
		jmp	short loc_10009A10
; ---------------------------------------------------------------------------

loc_10009A06:				; CODE XREF: sub_100099CE+24j
		add	eax, 2Ch
		cmp	eax, [esi+8]
		jnz	short loc_100099EA

loc_10009A0E:				; CODE XREF: sub_100099CE+17j
		xor	eax, eax

loc_10009A10:				; CODE XREF: sub_100099CE+36j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100099CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009A18	proc near		; CODE XREF: sub_10009A54+8Dp
					; sub_1001674A+B3p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, ecx
		cmp	byte ptr [ebx],	0
		jz	short loc_10009A4F
		mov	eax, [ebx+8]
		push	esi
		push	edi
		lea	edi, [ebx+0Ch]
		mov	[ebp+var_4], eax
		push	edi
		push	dword ptr [edi]
		lea	eax, [ebp+var_4]
		push	eax
		lea	esi, [ebx+4]
		push	esi
		push	0FFFFFFFFh
		call	dword_10031D1C
		xor	eax, eax
		mov	[edi], eax
		pop	edi
		mov	[esi], eax
		mov	[ebx], al
		mov	[ebx+8], eax
		pop	esi

loc_10009A4F:				; CODE XREF: sub_10009A18+Aj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10009A18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009A54	proc near		; DATA XREF: .rdata:1002C25Co

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		push	edi
		push	[ebp+arg_18]
		mov	edi, [ebp+arg_14]
		mov	esi, ecx
		push	edi
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		mov	eax, [esi]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_10009AE9
		xor	edx, edx
		cmp	[esi+0Ch], edx
		jnz	short loc_10009A8B
		mov	eax, 0C000000Dh
		jmp	short loc_10009AE9
; ---------------------------------------------------------------------------

loc_10009A8B:				; CODE XREF: sub_10009A54+2Ej
		push	dword ptr [esi+8]
		push	dword ptr [esi+4]
		push	[ebp+arg_18]
		push	edi
		call	sub_10012A69
		test	al, al
		jnz	short loc_10009AA5
		mov	eax, 0C0000023h
		jmp	short loc_10009AE9
; ---------------------------------------------------------------------------

loc_10009AA5:				; CODE XREF: sub_10009A54+48j
		push	ebx
		push	ecx
		push	4
		push	dword ptr [esi+0Ch]
		lea	ecx, [ebp+var_10]
		mov	[ebp+var_10], dl
		mov	[ebp+var_C], edx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], edx
		call	sub_1001424E
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_10009ADE
		mov	ecx, [esi+0Ch]
		sub	edi, [ebp+arg_0]
		mov	[ecx], edi
		mov	edi, [ebp+arg_1C]
		test	edi, edi
		jz	short loc_10009ADE
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_10009ADE:				; CODE XREF: sub_10009A54+70j
					; sub_10009A54+7Fj
		lea	ecx, [ebp+var_10]
		call	sub_10009A18
		mov	eax, ebx
		pop	ebx

loc_10009AE9:				; CODE XREF: sub_10009A54+27j
					; sub_10009A54+35j ...
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_10009A54	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009AF1	proc near		; DATA XREF: .rdata:1002C264o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		test	eax, eax
		jnz	short loc_10009B07
		mov	eax, 0C000000Dh
		jmp	short loc_10009B4E
; ---------------------------------------------------------------------------

loc_10009B07:				; CODE XREF: sub_10009AF1+Dj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100058C0
		test	al, al
		jnz	short loc_10009B24
		mov	eax, 0C000007Bh
		jmp	short loc_10009B4E
; ---------------------------------------------------------------------------

loc_10009B24:				; CODE XREF: sub_10009AF1+2Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_10005742
		mov	[esi+0Ch], eax
		test	eax, eax
		jnz	short loc_10009B3D
		mov	eax, 0C000007Ah
		jmp	short loc_10009B4E
; ---------------------------------------------------------------------------

loc_10009B3D:				; CODE XREF: sub_10009AF1+43j
		push	dword ptr [eax]
		lea	ecx, [ebp+var_8]
		call	sub_100058F3
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		xor	eax, eax

loc_10009B4E:				; CODE XREF: sub_10009AF1+14j
					; sub_10009AF1+31j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10009AF1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B55	proc near		; DATA XREF: .rdata:1002C268o
		push	1Eh
		pop	eax
		retn
sub_10009B55	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B59	proc near		; CODE XREF: sub_10009B7F+3p
					; sub_10009B9C+9p ...
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BE98
		cmp	dword ptr [esi+4], 0
		jz	short loc_10009B7D
		push	dword ptr [esi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax

loc_10009B7D:				; CODE XREF: sub_10009B59+Dj
		pop	esi
		retn
sub_10009B59	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B7F	proc near		; DATA XREF: .rdata:1002BEA0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_10009B96
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10009B96:				; CODE XREF: sub_10009B7F+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10009B7F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B9C	proc near		; DATA XREF: .rdata:1002BDE4o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BDDC
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_10009BB9
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10009BB9:				; CODE XREF: sub_10009B9C+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10009B9C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009BBF	proc near		; CODE XREF: sub_1001436D+D9p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1002BDE8
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1002BDDC
		mov	[edi+10h], eax
		call	sub_1000A1B0
		push	offset dword_1002BE6C
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002BE40
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002BEA4
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002BE14
		mov	ecx, esi
		call	sub_1000A1B0
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10009BBF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009C20	proc near		; DATA XREF: .rdata:1002BDE0o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		sub	eax, 3
		jz	short loc_10009CA3
		dec	eax
		jz	short loc_10009C8A
		dec	eax
		jz	short loc_10009C71
		dec	eax
		jz	short loc_10009C58
		dec	eax
		jnz	loc_10009CC9
		mov	eax, offset _TargetNtSetInformationFile@24 ; TargetNtSetInformationFile(x,x,x,x,x,x)
		test	eax, eax
		jz	loc_10009CC9
		push	0Dh
		push	offset a_targetntset_1 ; "_TargetNtSetInformationFile@24"
		push	1
		push	offset aNtsetinformati ; "NtSetInformationFile"
		jmp	short loc_10009CBA
; ---------------------------------------------------------------------------

loc_10009C58:				; CODE XREF: sub_10009C20+12j
		mov	eax, offset _TargetNtQueryFullAttributesFile@12	; TargetNtQueryFullAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_10009CC9
		push	0Ch
		push	offset a_targetntque_1 ; "_TargetNtQueryFullAttributesFile@12"
		push	1
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		jmp	short loc_10009CBA
; ---------------------------------------------------------------------------

loc_10009C71:				; CODE XREF: sub_10009C20+Fj
		mov	eax, offset _TargetNtQueryAttributesFile@12 ; TargetNtQueryAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_10009CC9
		push	0Bh
		push	offset a_targetntque_2 ; "_TargetNtQueryAttributesFile@12"
		push	1
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		jmp	short loc_10009CBA
; ---------------------------------------------------------------------------

loc_10009C8A:				; CODE XREF: sub_10009C20+Cj
		mov	eax, offset _TargetNtOpenFile@28 ; TargetNtOpenFile(x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10009CC9
		push	0Ah
		push	offset a_targetntope_5 ; "_TargetNtOpenFile@28"
		push	1
		push	offset aNtopenfile ; "NtOpenFile"
		jmp	short loc_10009CBA
; ---------------------------------------------------------------------------

loc_10009CA3:				; CODE XREF: sub_10009C20+9j
		mov	eax, offset _TargetNtCreateFile@48 ; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10009CC9
		push	9		; int
		push	offset a_targetntcre_2 ; "_TargetNtCreateFile@48"
		push	1		; int
		push	offset aNtcreatefile ; "NtCreateFile"

loc_10009CBA:				; CODE XREF: sub_10009C20+36j
					; sub_10009C20+4Fj ...
		mov	ecx, [ebp+arg_0]
		push	offset aNtdll_dll ; "ntdll.dll"
		call	sub_1000D8BF
		jmp	short loc_10009CCB
; ---------------------------------------------------------------------------

loc_10009CC9:				; CODE XREF: sub_10009C20+15j
					; sub_10009C20+22j ...
		xor	al, al

loc_10009CCB:				; CODE XREF: sub_10009C20+A7j
		pop	ebp
		retn	8
sub_10009C20	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009CCF	proc near		; DATA XREF: .rdata:1002BE10o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
TargetHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		mov	edx, edi
		mov	ecx, edi
		call	sub_1000B9C1
		test	al, al
		jnz	short loc_10009D07

loc_10009CFB:				; CODE XREF: sub_10009CCF+D3j
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	loc_10009DBD
; ---------------------------------------------------------------------------

loc_10009D07:				; CODE XREF: sub_10009CCF+2Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10009D11
		mov	eax, [edi]
		jmp	short loc_10009D13
; ---------------------------------------------------------------------------

loc_10009D11:				; CODE XREF: sub_10009CCF+3Cj
		mov	eax, edi

loc_10009D13:				; CODE XREF: sub_10009CCF+40j
		lea	ecx, [esp+48h+var_28]
		mov	[esp+48h+var_2C], eax
		mov	[esp+48h+var_38], 1
		call	sub_1000A218
		lea	eax, [esp+48h+var_2C]
		mov	[esp+48h+var_24], 1
		mov	[esp+48h+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[esp+48h+var_10], eax
		lea	eax, [ebp+arg_1C]
		mov	[esp+48h+var_8], eax
		lea	eax, [esp+48h+var_38]
		push	2
		pop	ecx
		mov	[esp+48h+var_18], eax
		lea	eax, [esp+48h+var_28]
		push	eax
		mov	[esp+4Ch+var_14], ecx
		mov	[esp+4Ch+var_C], ecx
		mov	[esp+4Ch+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	3
		call	sub_10015057
		mov	edx, [esi+4]
		lea	ecx, [esp+48h+var_3C]
		push	ecx		; int
		and	[esp+4Ch+var_3C], 0
		lea	ecx, [esp+4Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+50h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_1C]	; int
		mov	ecx, eax
		push	[ebp+arg_18]	; int
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_1000B746
		add	esp, 28h
		test	al, al
		jz	loc_10009CFB
		mov	eax, [esp+48h+var_3C]
		mov	[esi+1Ch], eax
		mov	eax, [esp+48h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+48h+TargetHandle]
		mov	[esi+18h], eax

loc_10009DBD:				; CODE XREF: sub_10009CCF+33j
		mov	ecx, [esp+48h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_10009CCF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009DD3	proc near		; DATA XREF: .rdata:1002BE94o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
TargetHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		mov	edx, edi
		mov	ecx, edi
		call	sub_1000B9C1
		test	al, al
		jnz	short loc_10009E0B

loc_10009DFF:				; CODE XREF: sub_10009DD3+CDj
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	loc_10009EBB
; ---------------------------------------------------------------------------

loc_10009E0B:				; CODE XREF: sub_10009DD3+2Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10009E15
		mov	eax, [edi]
		jmp	short loc_10009E17
; ---------------------------------------------------------------------------

loc_10009E15:				; CODE XREF: sub_10009DD3+3Cj
		mov	eax, edi

loc_10009E17:				; CODE XREF: sub_10009DD3+40j
		lea	ecx, [esp+48h+var_28]
		mov	[esp+48h+var_2C], eax
		mov	[esp+48h+var_38], 1
		call	sub_1000A218
		lea	eax, [esp+48h+var_2C]
		mov	[esp+48h+var_24], 1
		mov	[esp+48h+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[esp+48h+var_10], eax
		lea	eax, [ebp+arg_14]
		mov	[esp+48h+var_8], eax
		lea	eax, [esp+48h+var_38]
		push	2
		pop	ecx
		mov	[esp+48h+var_18], eax
		lea	eax, [esp+48h+var_28]
		push	eax
		mov	[esp+4Ch+var_14], ecx
		mov	[esp+4Ch+var_C], ecx
		mov	[esp+4Ch+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	4
		call	sub_10015057
		mov	edx, [esi+4]
		lea	ecx, [esp+48h+var_3C]
		and	[esp+48h+var_3C], 0
		push	ecx		; int
		lea	ecx, [esp+4Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+50h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_14]	; int
		mov	ecx, eax
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_1000B7D4
		add	esp, 20h
		test	al, al
		jz	loc_10009DFF
		mov	eax, [esp+48h+var_3C]
		mov	[esi+1Ch], eax
		mov	eax, [esp+48h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+48h+TargetHandle]
		mov	[esi+18h], eax

loc_10009EBB:				; CODE XREF: sub_10009DD3+33j
		mov	ecx, [esp+48h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	18h
sub_10009DD3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009ED1	proc near		; DATA XREF: .rdata:1002BE68o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_C]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		cmp	dword ptr [ebx], 28h
		mov	edi, [ebp+arg_0]
		mov	[esp+30h+var_24], ecx
		jz	short loc_10009F01
		xor	al, al
		jmp	loc_10009F8E
; ---------------------------------------------------------------------------

loc_10009F01:				; CODE XREF: sub_10009ED1+27j
		mov	edx, esi
		mov	ecx, esi
		call	sub_1000B9C1
		test	al, al
		jnz	short loc_10009F17

loc_10009F0E:				; CODE XREF: sub_10009ED1+B2j
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_10009F8C
; ---------------------------------------------------------------------------

loc_10009F17:				; CODE XREF: sub_10009ED1+3Bj
		cmp	dword ptr [esi+14h], 8
		mov	[esp+30h+var_20], 1
		jb	short loc_10009F29
		mov	eax, [esi]
		jmp	short loc_10009F2B
; ---------------------------------------------------------------------------

loc_10009F29:				; CODE XREF: sub_10009ED1+52j
		mov	eax, esi

loc_10009F2B:				; CODE XREF: sub_10009ED1+56j
		lea	ecx, [esp+30h+var_18]
		mov	[esp+30h+var_1C], eax
		call	sub_1000A234
		mov	ecx, [esp+30h+var_24]
		lea	eax, [esp+30h+var_1C]
		mov	[esp+30h+var_10], eax
		lea	eax, [esp+30h+var_20]
		mov	[esp+30h+var_8], eax
		lea	eax, [esp+30h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	5
		mov	[esp+38h+var_14], 1
		mov	[esp+38h+var_C], 2
		call	sub_10015057
		lea	ecx, [esp+30h+var_24]
		push	ecx
		push	dword ptr [ebx+4]
		mov	ecx, eax
		push	[ebp+arg_8]
		push	esi
		call	sub_1000B85F
		add	esp, 10h
		test	al, al
		jz	short loc_10009F0E
		mov	eax, [esp+30h+var_24]
		mov	[edi+10h], eax

loc_10009F8C:				; CODE XREF: sub_10009ED1+44j
		mov	al, 1

loc_10009F8E:				; CODE XREF: sub_10009ED1+2Bj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10009ED1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009FA2	proc near		; DATA XREF: .rdata:1002BECCo

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_C]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		cmp	dword ptr [ebx], 38h
		mov	edi, [ebp+arg_0]
		mov	[esp+30h+var_24], ecx
		jz	short loc_10009FD2
		xor	al, al
		jmp	loc_1000A05F
; ---------------------------------------------------------------------------

loc_10009FD2:				; CODE XREF: sub_10009FA2+27j
		mov	edx, esi
		mov	ecx, esi
		call	sub_1000B9C1
		test	al, al
		jnz	short loc_10009FE8

loc_10009FDF:				; CODE XREF: sub_10009FA2+B2j
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_1000A05D
; ---------------------------------------------------------------------------

loc_10009FE8:				; CODE XREF: sub_10009FA2+3Bj
		cmp	dword ptr [esi+14h], 8
		mov	[esp+30h+var_20], 1
		jb	short loc_10009FFA
		mov	eax, [esi]
		jmp	short loc_10009FFC
; ---------------------------------------------------------------------------

loc_10009FFA:				; CODE XREF: sub_10009FA2+52j
		mov	eax, esi

loc_10009FFC:				; CODE XREF: sub_10009FA2+56j
		lea	ecx, [esp+30h+var_18]
		mov	[esp+30h+var_1C], eax
		call	sub_1000A234
		mov	ecx, [esp+30h+var_24]
		lea	eax, [esp+30h+var_1C]
		mov	[esp+30h+var_10], eax
		lea	eax, [esp+30h+var_20]
		mov	[esp+30h+var_8], eax
		lea	eax, [esp+30h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	6
		mov	[esp+38h+var_14], 1
		mov	[esp+38h+var_C], 2
		call	sub_10015057
		lea	ecx, [esp+30h+var_24]
		push	ecx
		push	dword ptr [ebx+4]
		mov	ecx, eax
		push	[ebp+arg_8]
		push	esi
		call	sub_1000B8CF
		add	esp, 10h
		test	al, al
		jz	short loc_10009FDF
		mov	eax, [esp+30h+var_24]
		mov	[edi+10h], eax

loc_1000A05D:				; CODE XREF: sub_10009FA2+44j
		mov	al, 1

loc_1000A05F:				; CODE XREF: sub_10009FA2+2Bj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10009FA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A073	proc near		; DATA XREF: .rdata:1002BE3Co

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
hSourceHandle	= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Dst		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+44h+var_44], ecx
		mov	ecx, [ebp+arg_8]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [ecx], 8
		mov	[esp+4Ch+hSourceHandle], eax
		mov	eax, [ebp+arg_C]
		push	edi
		mov	[esp+50h+var_40], ecx
		jz	short loc_1000A0AD

loc_1000A0A6:				; CODE XREF: sub_1000A073+3Fj
					; sub_1000A073+55j
		xor	al, al
		jmp	loc_1000A19C
; ---------------------------------------------------------------------------

loc_1000A0AD:				; CODE XREF: sub_1000A073+31j
		mov	ebx, [ebp+arg_10]
		cmp	ebx, [eax]
		jnz	short loc_1000A0A6
		mov	edi, [eax+4]
		mov	edx, ebx
		push	[ebp+arg_14]
		mov	ecx, edi
		call	sub_10014288
		add	esp, 4
		test	al, al
		jz	short loc_1000A0A6
		and	[esp+50h+var_20], 0
		lea	ecx, [esp+50h+Dst] ; Dst
		xor	eax, eax
		mov	[esp+50h+var_1C], 7
		mov	word ptr [esp+50h+Dst],	ax
		mov	eax, [edi+8]
		shr	eax, 1
		push	eax		; int
		lea	eax, [edi+0Ch]
		push	eax		; Src
		call	sub_1000233F
		lea	edx, [esp+50h+Dst]
		mov	ecx, edx
		call	sub_1000B9C1
		test	al, al
		jz	short loc_1000A17D
		cmp	[esp+50h+var_1C], 8
		mov	eax, [esp+50h+Dst]
		mov	[esp+50h+var_38], 1
		jnb	short loc_1000A117
		lea	eax, [esp+50h+Dst]

loc_1000A117:				; CODE XREF: sub_1000A073+9Ej
		lea	ecx, [esp+50h+var_18]
		mov	[esp+50h+var_34], eax
		call	sub_1000A234
		mov	ecx, [esp+50h+var_44]
		lea	eax, [esp+50h+var_34]
		mov	[esp+50h+var_10], eax
		lea	eax, [esp+50h+var_38]
		mov	[esp+50h+var_8], eax
		lea	eax, [esp+50h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	7
		mov	[esp+58h+var_14], 1
		mov	[esp+58h+var_C], 2
		call	sub_10015057
		mov	edx, [esi+4]
		lea	ecx, [esp+50h+var_44]
		push	ecx		; int
		mov	ecx, [esp+54h+var_40]
		push	dword ptr [ecx+4] ; int
		mov	ecx, eax
		push	[ebp+arg_14]	; int
		push	ebx		; int
		push	edi		; int
		push	[esp+64h+hSourceHandle]	; hSourceHandle
		call	sub_1000B93F
		add	esp, 18h
		test	al, al
		jnz	short loc_1000A186

loc_1000A17D:				; CODE XREF: sub_1000A073+8Bj
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_1000A18D
; ---------------------------------------------------------------------------

loc_1000A186:				; CODE XREF: sub_1000A073+108j
		mov	ecx, [esp+50h+var_44]
		mov	[esi+10h], ecx

loc_1000A18D:				; CODE XREF: sub_1000A073+111j
		push	0
		push	1
		lea	ecx, [esp+58h+Dst]
		call	sub_100022FA
		mov	al, 1

loc_1000A19C:				; CODE XREF: sub_1000A073+35j
		mov	ecx, [esp+50h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	18h
sub_1000A073	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A1B0	proc near		; CODE XREF: sub_10009BBF+25p
					; sub_10009BBF+31p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_1000A1F5
		cmp	[ebx], esi
		ja	short loc_1000A1F5
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	2Ch
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_1000A1DE
		push	ecx
		mov	ecx, ebx
		call	sub_1000A250

loc_1000A1DE:				; CODE XREF: sub_1000A1B0+24j
		mov	edi, [ebx+4]
		imul	esi, 2Ch
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_1000A1EF
		push	0Bh
		pop	ecx
		rep movsd

loc_1000A1EF:				; CODE XREF: sub_1000A1B0+38j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_1000A212
; ---------------------------------------------------------------------------

loc_1000A1F5:				; CODE XREF: sub_1000A1B0+Ej
					; sub_1000A1B0+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_1000A202
		push	ecx
		mov	ecx, ebx
		call	sub_1000A250

loc_1000A202:				; CODE XREF: sub_1000A1B0+48j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_1000A20E
		push	0Bh
		pop	ecx
		rep movsd

loc_1000A20E:				; CODE XREF: sub_1000A1B0+57j
		add	dword ptr [ebx+4], 2Ch

loc_1000A212:				; CODE XREF: sub_1000A1B0+43j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000A1B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A218	proc near		; CODE XREF: sub_10009CCF+54p
					; sub_10009DD3+54p ...
		push	3
		mov	dword ptr [ecx], 4
		lea	eax, [ecx+4]
		pop	edx

loc_1000A224:				; CODE XREF: sub_1000A218+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_1000A224
		mov	eax, ecx
		retn
sub_1000A218	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A234	proc near		; CODE XREF: sub_10009ED1+62p
					; sub_10009FA2+62p ...
		xor	edx, edx
		mov	dword ptr [ecx], 2
		lea	eax, [ecx+4]
		inc	edx

loc_1000A240:				; CODE XREF: sub_1000A234+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_1000A240
		mov	eax, ecx
		retn
sub_1000A234	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A250	proc near		; CODE XREF: sub_1000A1B0+29p
					; sub_1000A1B0+4Dp
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	2Ch
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_1000A2B4
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 5D1745Dh
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_1000A28B
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000A28B:				; CODE XREF: sub_1000A250+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_1000A2A3
		xor	eax, eax
		jmp	short loc_1000A2A5
; ---------------------------------------------------------------------------

loc_1000A2A3:				; CODE XREF: sub_1000A250+4Dj
		add	eax, edx

loc_1000A2A5:				; CODE XREF: sub_1000A250+51j
		cmp	eax, ecx
		jnb	short loc_1000A2AB
		mov	eax, ecx

loc_1000A2AB:				; CODE XREF: sub_1000A250+57j
		push	eax
		mov	ecx, esi
		call	sub_1000A2BA
		pop	ebx

loc_1000A2B4:				; CODE XREF: sub_1000A250+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_1000A250	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A2BA	proc near		; CODE XREF: sub_1000A250+5Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		mov	ebp, ecx
		test	esi, esi
		jz	short loc_1000A2E9
		cmp	esi, 5D1745Dh
		ja	short loc_1000A2E3
		imul	eax, esi, 2Ch
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_1000A2E9

loc_1000A2E3:				; CODE XREF: sub_1000A2BA+16j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000A2E9:				; CODE XREF: sub_1000A2BA+Ej
					; sub_1000A2BA+27j
		mov	ecx, [ebp+4]
		mov	edx, ebx
		mov	eax, [ebp+0]
		mov	[esp+10h+var_4], ecx
		push	edi
		push	2Ch
		pop	edi
		cmp	eax, ecx
		jz	short loc_1000A31D

loc_1000A2FD:				; CODE XREF: sub_1000A2BA+5Dj
		test	edx, edx
		jz	short loc_1000A311
		push	0Bh
		pop	ecx
		mov	esi, eax
		mov	edi, edx
		rep movsd
		mov	ecx, [esp+14h+var_4]
		push	2Ch
		pop	edi

loc_1000A311:				; CODE XREF: sub_1000A2BA+45j
		add	eax, edi
		add	edx, edi
		cmp	eax, ecx
		jnz	short loc_1000A2FD
		mov	esi, [esp+14h+arg_0]

loc_1000A31D:				; CODE XREF: sub_1000A2BA+41j
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		cdq
		idiv	edi
		cmp	dword ptr [ebp+0], 0
		mov	edi, eax
		jz	short loc_1000A338
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000A338:				; CODE XREF: sub_1000A2BA+72j
		imul	ecx, esi, 2Ch
		imul	eax, edi, 2Ch
		pop	edi
		pop	esi
		mov	[ebp+0], ebx
		add	ecx, ebx
		add	eax, ebx
		mov	[ebp+8], ecx
		mov	[ebp+4], eax
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_1000A2BA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A353	proc near		; CODE XREF: sub_1000ACA5+40p
					; sub_1000ADBD+40p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset stru_1002DCB8
		call	__SEH_prolog4
		mov	edx, ecx
		xor	eax, eax
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[edx], eax
		jz	short loc_1000A388
		mov	ecx, [edx]
		mov	[ebp+var_1C], ecx

loc_1000A36F:				; CODE XREF: sub_1000A353+28j
		mov	ax, [ecx]
		add	ecx, 2
		mov	[ebp+var_1C], ecx
		test	ax, ax
		jnz	short loc_1000A36F
		sub	ecx, [edx]
		sar	ecx, 1
		lea	eax, ds:0FFFFFFFEh[ecx*2]

loc_1000A388:				; CODE XREF: sub_1000A353+15j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_1000A3A2
; ---------------------------------------------------------------------------

loc_1000A391:				; DATA XREF: .rdata:stru_1002DCB8o
		xor	eax, eax	; Exception filter 0 for function 1000A353
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A395:				; DATA XREF: .rdata:stru_1002DCB8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A353
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		or	eax, 0FFFFFFFFh

loc_1000A3A2:				; CODE XREF: sub_1000A353+3Cj
		call	__SEH_epilog4
		retn
sub_1000A353	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000A3A8(void *Src)
sub_1000A3A8	proc near		; CODE XREF: sub_1000AEA5+B0p
					; sub_1000AF8F+F9p ...

ms_exc		= CPPEH_RECORD ptr -18h
Src		= dword	ptr  8

		push	8
		push	offset stru_1002DCD8
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	dword ptr [ecx]	; Size
		push	[ebp+Src]	; Src
		push	dword ptr [ecx+4] ; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_1000A3E3
; ---------------------------------------------------------------------------

loc_1000A3D3:				; DATA XREF: .rdata:stru_1002DCD8o
		xor	eax, eax	; Exception filter 0 for function 1000A3A8
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A3D7:				; DATA XREF: .rdata:stru_1002DCD8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A3A8
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_1000A3E3:				; CODE XREF: sub_1000A3A8+29j
		call	__SEH_epilog4
		retn	4
sub_1000A3A8	endp

; Exported entry  23. _TargetNtCreateFile@48

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateFile(x, x, x,	x, x, x, x, x, x, x, x,	x)
		public _TargetNtCreateFile@48
_TargetNtCreateFile@48 proc near	; DATA XREF: sub_10009C20:loc_10009CA3o
					; .rdata:off_1002E058o

var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
Src		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
Dst		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h

		push	64h
		push	offset stru_1002DCF8
		call	__SEH_prolog4_GS
		mov	edx, [ebp+arg_0]
		mov	esi, [ebp+arg_4]
		mov	[ebp+var_58], esi
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_10]
		mov	ecx, [ebp+arg_14]
		mov	eax, [ebp+arg_28]
		push	[ebp+arg_2C]
		push	eax
		push	[ebp+arg_24]
		push	[ebp+arg_20]
		push	[ebp+arg_1C]
		push	[ebp+arg_18]
		push	ecx
		push	edi
		push	ebx
		push	[ebp+arg_8]
		push	esi
		call	edx
		mov	esi, eax
		mov	[ebp+var_5C], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000A5C1
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A45D
		mov	eax, esi
		jmp	loc_1000A5C1
; ---------------------------------------------------------------------------

loc_1000A45D:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+69j
		and	[ebp+var_54], 0
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+var_58]
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000A5B1
		push	1
		push	8
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000A5B1
		call	sub_10013DD2
		mov	[ebp+var_70], eax
		test	eax, eax
		jz	loc_1000A5B1
		and	[ebp+Src], 0
		push	0
		lea	eax, [ebp+Src]
		push	eax
		lea	edx, [ebp+var_54]
		mov	ecx, ebx
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A5B1
		cmp	[ebp+var_54], 0
		jz	loc_1000A5B1
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_64], eax
		mov	eax, [ebp+arg_24]
		mov	[ebp+var_68], eax
		and	[ebp+var_6C], 0
		lea	ecx, [ebp+var_40]
		call	sub_1000A218
		lea	eax, [ebp+var_54]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_64]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_68]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_6C]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	edx, [ebp+var_40]
		push	3
		pop	ecx
		call	sub_10010153
		test	al, al
		jz	loc_1000A5B1
		push	[ebp+var_70]
		lea	ecx, [ebp+var_74]
		call	sub_10015A07
		and	[ebp+var_50], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_68]
		push	eax		; void *
		lea	eax, [ebp+arg_20]
		push	eax		; void *
		lea	eax, [ebp+arg_1C]
		push	eax		; void *
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+var_64]
		push	eax		; void *
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	ecx, [ebp+var_74]
		call	sub_1000ACA5
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_1000A5B1
		mov	esi, [ebp+var_48]
		test	esi, esi
		js	short loc_1000A5BF
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_58]
		mov	[ecx], eax
		mov	[edi], esi
		mov	eax, [ebp+var_3C]
		mov	[edi+4], eax
		mov	[ebp+var_5C], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_1000A5B1
; ---------------------------------------------------------------------------

loc_1000A5A0:				; DATA XREF: .rdata:stru_1002DCF8o
		xor	eax, eax	; Exception filter 0 for function 1000A3EB
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A5A4:				; DATA XREF: .rdata:stru_1002DCF8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A3EB
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_5C]

loc_1000A5B1:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+86j
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+9Bj ...
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jz	short loc_1000A5BF
		xor	edx, edx
		call	sub_1001430B

loc_1000A5BF:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+17Fj
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1CBj
		mov	eax, esi

loc_1000A5C1:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+45j
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+6Dj
		call	__SEH_epilog4_GS
		retn	30h
_TargetNtCreateFile@48 endp

; Exported entry  27. _TargetNtOpenFile@28

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenFile(x,	x, x, x, x, x, x)
		public _TargetNtOpenFile@28
_TargetNtOpenFile@28 proc near		; DATA XREF: sub_10009C20:loc_10009C8Ao
					; .rdata:off_1002E058o

var_74		= byte ptr -74h
var_70		= dword	ptr -70h
Src		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
Dst		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	64h
		push	offset stru_1002DD18
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_64], ecx
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_10]
		push	[ebp+arg_18]
		push	[ebp+arg_14]
		push	edi
		push	ebx
		push	[ebp+arg_8]
		push	ecx
		call	eax
		mov	esi, eax
		mov	[ebp+var_58], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000A782
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenfile	; "NtOpenFile"
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A62A
		mov	eax, esi
		jmp	loc_1000A782
; ---------------------------------------------------------------------------

loc_1000A62A:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+58j
		and	[ebp+var_54], 0
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+var_64]
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000A772
		push	1
		push	8
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000A772
		call	sub_10013DD2
		mov	[ebp+var_70], eax
		test	eax, eax
		jz	loc_1000A772
		push	0
		lea	eax, [ebp+Src]
		push	eax
		lea	edx, [ebp+var_54]
		mov	ecx, ebx
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A772
		cmp	[ebp+var_54], 0
		jz	loc_1000A772
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_60], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_5C], eax
		and	[ebp+var_68], 0
		lea	ecx, [ebp+var_40]
		call	sub_1000A218
		lea	eax, [ebp+var_54]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_60]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_5C]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_68]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	edx, [ebp+var_40]
		push	4
		pop	ecx
		call	sub_10010153
		test	al, al
		jz	loc_1000A772
		push	[ebp+var_70]
		lea	ecx, [ebp+var_74]
		call	sub_10015A07
		and	[ebp+var_50], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_5C]
		push	eax		; void *
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+var_60]
		push	eax		; void *
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	ecx, [ebp+var_74]
		call	sub_1000ADBD
		add	esp, 24h
		test	eax, eax
		jnz	short loc_1000A772
		mov	esi, [ebp+var_48]
		test	esi, esi
		js	short loc_1000A780
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_64]
		mov	[ecx], eax
		mov	[edi], esi
		mov	eax, [ebp+var_3C]
		mov	[edi+4], eax
		mov	[ebp+var_58], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenfile	; "NtOpenFile"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_1000A772
; ---------------------------------------------------------------------------

loc_1000A761:				; DATA XREF: .rdata:stru_1002DD18o
		xor	eax, eax	; Exception filter 0 for function 1000A5C9
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A765:				; DATA XREF: .rdata:stru_1002DD18o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A5C9
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_58]

loc_1000A772:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+75j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+8Aj ...
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jz	short loc_1000A780
		xor	edx, edx
		call	sub_1001430B

loc_1000A780:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+162j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+1AEj
		mov	eax, esi

loc_1000A782:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+34j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+5Cj
		call	__SEH_epilog4_GS
		retn	1Ch
_TargetNtOpenFile@28 endp

; Exported entry  36. _TargetNtQueryAttributesFile@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtQueryAttributesFile(x, x, x)
		public _TargetNtQueryAttributesFile@12
_TargetNtQueryAttributesFile@12	proc near ; DATA XREF: sub_10009C20:loc_10009C71o
					; .rdata:off_1002E058o

var_68		= dword	ptr -68h
Src		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
Dst		= byte ptr -48h
var_44		= dword	ptr -44h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+6Ch+var_60], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000A90B
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A7E7
		mov	eax, ebx
		jmp	loc_1000A90B
; ---------------------------------------------------------------------------

loc_1000A7E7:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+54j
		and	[esp+78h+var_68], 0
		mov	ecx, esi
		push	1
		push	28h
		pop	edx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000A8F7
		call	sub_10013DD2
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000A8F7
		and	[esp+78h+Src], 0
		lea	eax, [esp+78h+Src]
		push	0
		push	eax
		lea	edx, [esp+80h+var_68]
		mov	ecx, edi
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A8F7
		cmp	[esp+78h+var_68], 0
		jz	loc_1000A906
		mov	[esp+78h+var_58], esi
		lea	ecx, [esp+78h+var_18]
		xor	esi, esi
		mov	[esp+78h+var_5C], 28h
		mov	[esp+78h+var_60], esi
		call	sub_1000A234
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_14], 1
		mov	[esp+78h+var_10], eax
		lea	edx, [esp+78h+var_18]
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_C], 2
		push	5
		pop	ecx
		mov	[esp+78h+var_8], eax
		call	sub_10010153
		test	al, al
		jz	short loc_1000A8F7
		mov	eax, [ebx+8]
		add	eax, ebx
		mov	[esp+78h+var_54], ebx
		push	30h		; Size
		mov	dword ptr [esp+7Ch+var_50], eax
		lea	eax, [esp+7Ch+Dst]
		push	esi		; Val
		push	eax		; Dst
		mov	[esp+84h+var_4C], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+78h+var_4C]
		lea	ecx, [esp+78h+var_54]
		push	eax		; int
		lea	eax, [esp+7Ch+var_5C]
		push	eax		; int
		lea	eax, [esp+80h+Src]
		push	eax		; Src
		lea	eax, [esp+84h+var_68]
		push	eax		; int
		push	5
		pop	edx
		call	sub_1000AEA5
		mov	ecx, [esp+88h+var_68]
		add	esp, 10h
		xor	edx, edx
		mov	esi, eax
		call	sub_1001430B
		test	esi, esi
		jnz	short loc_1000A8F7
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002B50
		mov	eax, [esp+7Ch+var_44]
		pop	ecx
		jmp	short loc_1000A90B
; ---------------------------------------------------------------------------

loc_1000A8F7:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+71j
					; TargetNtQueryAttributesFile(x,x,x)+80j ...
		mov	ecx, [esp+78h+var_68]
		test	ecx, ecx
		jz	short loc_1000A906
		xor	edx, edx
		call	sub_1001430B

loc_1000A906:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+ACj
					; TargetNtQueryAttributesFile(x,x,x)+173j
		mov	eax, 0C0000022h

loc_1000A90B:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+30j
					; TargetNtQueryAttributesFile(x,x,x)+58j ...
		mov	ecx, [esp+78h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
_TargetNtQueryAttributesFile@12	endp

; Exported entry  37. _TargetNtQueryFullAttributesFile@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtQueryFullAttributesFile(x, x, x)
		public _TargetNtQueryFullAttributesFile@12
_TargetNtQueryFullAttributesFile@12 proc near ;	DATA XREF: sub_10009C20:loc_10009C58o
					; .rdata:off_1002E058o

var_68		= dword	ptr -68h
Src		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
Dst		= byte ptr -48h
var_44		= dword	ptr -44h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+6Ch+var_60], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000AAA0
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A97C
		mov	eax, ebx
		jmp	loc_1000AAA0
; ---------------------------------------------------------------------------

loc_1000A97C:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+54j
		and	[esp+78h+var_68], 0
		mov	ecx, esi
		push	1
		push	38h
		pop	edx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000AA8C
		call	sub_10013DD2
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000AA8C
		and	[esp+78h+Src], 0
		lea	eax, [esp+78h+Src]
		push	0
		push	eax
		lea	edx, [esp+80h+var_68]
		mov	ecx, edi
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000AA8C
		cmp	[esp+78h+var_68], 0
		jz	loc_1000AA9B
		mov	[esp+78h+var_58], esi
		lea	ecx, [esp+78h+var_18]
		xor	esi, esi
		mov	[esp+78h+var_5C], 38h
		mov	[esp+78h+var_60], esi
		call	sub_1000A234
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_14], 1
		mov	[esp+78h+var_10], eax
		lea	edx, [esp+78h+var_18]
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_C], 2
		push	6
		pop	ecx
		mov	[esp+78h+var_8], eax
		call	sub_10010153
		test	al, al
		jz	short loc_1000AA8C
		mov	eax, [ebx+8]
		add	eax, ebx
		mov	[esp+78h+var_54], ebx
		push	30h		; Size
		mov	dword ptr [esp+7Ch+var_50], eax
		lea	eax, [esp+7Ch+Dst]
		push	esi		; Val
		push	eax		; Dst
		mov	[esp+84h+var_4C], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+78h+var_4C]
		lea	ecx, [esp+78h+var_54]
		push	eax		; int
		lea	eax, [esp+7Ch+var_5C]
		push	eax		; int
		lea	eax, [esp+80h+Src]
		push	eax		; Src
		lea	eax, [esp+84h+var_68]
		push	eax		; int
		push	6
		pop	edx
		call	sub_1000AEA5
		mov	ecx, [esp+88h+var_68]
		add	esp, 10h
		xor	edx, edx
		mov	esi, eax
		call	sub_1001430B
		test	esi, esi
		jnz	short loc_1000AA8C
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002B50
		mov	eax, [esp+7Ch+var_44]
		pop	ecx
		jmp	short loc_1000AAA0
; ---------------------------------------------------------------------------

loc_1000AA8C:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+71j
					; TargetNtQueryFullAttributesFile(x,x,x)+80j ...
		mov	ecx, [esp+78h+var_68]
		test	ecx, ecx
		jz	short loc_1000AA9B
		xor	edx, edx
		call	sub_1001430B

loc_1000AA9B:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+ACj
					; TargetNtQueryFullAttributesFile(x,x,x)+173j
		mov	eax, 0C0000022h

loc_1000AAA0:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+30j
					; TargetNtQueryFullAttributesFile(x,x,x)+58j ...
		mov	ecx, [esp+78h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
_TargetNtQueryFullAttributesFile@12 endp

; Exported entry  38. _TargetNtSetInformationFile@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationFile(x, x, x,	x, x, x)
		public _TargetNtSetInformationFile@24
_TargetNtSetInformationFile@24 proc near ; DATA	XREF: sub_10009C20+1Bo
					; .rdata:off_1002E058o

var_98		= dword	ptr -98h
Dst		= byte ptr -94h
var_90		= dword	ptr -90h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	88h
		push	offset stru_1002DD38
		call	__SEH_prolog4_GS
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_48], eax
		mov	edx, [ebp+arg_8]
		mov	[ebp+var_3C], edx
		mov	edi, [ebp+arg_C]
		push	[ebp+arg_14]
		mov	ebx, [ebp+arg_10]
		push	ebx
		push	edi
		push	edx
		push	eax
		call	ecx
		mov	esi, eax
		mov	[ebp+var_40], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000AC9D
		push	2
		xor	edx, edx
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_100029CB
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000AB13
		mov	eax, esi
		jmp	loc_1000AC9D
; ---------------------------------------------------------------------------

loc_1000AB13:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+56j
		and	[ebp+var_38], 0
		call	sub_10013DD2
		mov	[ebp+var_58], eax
		test	eax, eax
		jz	loc_1000AC8D
		push	1
		push	8
		pop	edx
		mov	ecx, [ebp+var_3C]
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000AC8D
		push	0
		mov	edx, ebx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_1000AC8D
		mov	[ebp+var_34], 18h
		xor	ecx, ecx
		mov	[ebp+var_30], ecx
		mov	[ebp+var_28], ecx
		lea	eax, [ebp+var_50]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], ecx
		mov	[ebp+ms_exc.registration.TryLevel], ecx
		push	[ebp+arg_14]
		mov	edx, ebx
		mov	ecx, edi
		call	sub_10014288
		add	esp, 4
		test	al, al
		jnz	short loc_1000AB8E
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	loc_1000AC8D
; ---------------------------------------------------------------------------

loc_1000AB8E:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+CCj
		mov	eax, [edi+4]
		mov	[ebp+var_30], eax
		lea	eax, [edi+0Ch]
		mov	[ebp+var_4C], eax
		mov	ax, [edi+8]
		mov	[ebp+var_4E], ax
		mov	[ebp+var_50], ax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	0
		push	0
		lea	edx, [ebp+var_38]
		lea	ecx, [ebp+var_34]
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000AC8D
		cmp	[ebp+var_38], 0
		jz	loc_1000AC8D
		and	[ebp+var_54], 0
		lea	ecx, [ebp+var_30]
		call	sub_1000A234
		lea	eax, [ebp+var_38]
		mov	[ebp+var_2C], 1
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_54]
		mov	[ebp+var_24], 2
		mov	[ebp+var_20], eax
		lea	edx, [ebp+var_30]
		push	7
		pop	ecx
		call	sub_10010153
		test	al, al
		jz	loc_1000AC8D
		mov	[ebp+var_64], 8
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_60], eax
		mov	[ebp+var_44], ebx
		mov	[ebp+var_40], edi
		push	[ebp+var_58]
		lea	ecx, [ebp+var_5C]
		call	sub_10015A07
		and	[ebp+var_98], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_98]
		push	eax		; int
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+var_44]
		push	eax		; int
		lea	eax, [ebp+var_64]
		push	eax		; int
		lea	eax, [ebp+var_48]
		push	eax		; int
		lea	ecx, [ebp+var_5C]
		call	sub_1000AF8F
		add	esp, 24h
		test	eax, eax
		jnz	short loc_1000AC8D
		mov	esi, [ebp+var_90]
		xor	edx, edx
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_10002ACE
		jmp	short loc_1000AC8D
; ---------------------------------------------------------------------------

loc_1000AC7C:				; DATA XREF: .rdata:stru_1002DD38o
		xor	eax, eax	; Exception filter 0 for function 1000AAB4
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000AC80:				; DATA XREF: .rdata:stru_1002DD38o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000AAB4
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_40]

loc_1000AC8D:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+6Dj
					; TargetNtSetInformationFile(x,x,x,x,x,x)+83j ...
		mov	ecx, [ebp+var_38]
		test	ecx, ecx
		jz	short loc_1000AC9B
		xor	edx, edx
		call	sub_1001430B

loc_1000AC9B:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+1DEj
		mov	eax, esi

loc_1000AC9D:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+38j
					; TargetNtSetInformationFile(x,x,x,x,x,x)+5Aj
		call	__SEH_epilog4_GS
		retn	18h
_TargetNtSetInformationFile@24 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ACA5(int,	void *Src, void	*, void	*, void	*, void	*, void	*, int)
sub_1000ACA5	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+16Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ACBD
		push	4
		pop	eax
		jmp	loc_1000ADB9
; ---------------------------------------------------------------------------

loc_1000ACBD:				; CODE XREF: sub_1000ACA5+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 3
		mov	dword ptr [edi+3Ch], 7
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A353
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		call	sub_1000B190
		test	al, al
		jnz	short loc_1000AD07
		push	4
		pop	eax
		jmp	loc_1000ADB7
; ---------------------------------------------------------------------------

loc_1000AD07:				; CODE XREF: sub_1000ACA5+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B190
		test	al, al
		jz	loc_1000ADB5
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, edi
		push	2		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000ADB5
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, edi
		push	3		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000ADB5
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_10] ; Src
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000ADB5
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_14] ; Src
		mov	ecx, edi
		push	5		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000ADB5
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_18] ; Src
		mov	ecx, edi
		push	6		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000ADB5
		push	[esp+14h+arg_1C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000ADB5
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000ADB5:				; CODE XREF: sub_1000ACA5+78j
					; sub_1000ACA5+92j ...
		mov	eax, esi

loc_1000ADB7:				; CODE XREF: sub_1000ACA5+5Dj
		pop	esi
		pop	ebp

loc_1000ADB9:				; CODE XREF: sub_1000ACA5+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ACA5	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ADBD(int,	void *Src, void	*, void	*, void	*, int)
sub_1000ADBD	proc near		; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+151p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ADD5
		push	4
		pop	eax
		jmp	loc_1000AEA1
; ---------------------------------------------------------------------------

loc_1000ADD5:				; CODE XREF: sub_1000ADBD+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 4
		mov	dword ptr [edi+3Ch], 5
		mov	dword ptr [edi+44h], 88h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A353
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		call	sub_1000B240
		test	al, al
		jnz	short loc_1000AE1F
		push	4
		pop	eax
		jmp	loc_1000AE9F
; ---------------------------------------------------------------------------

loc_1000AE1F:				; CODE XREF: sub_1000ADBD+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B240
		test	al, al
		jz	short loc_1000AE9D
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, edi
		push	2		; int
		call	sub_1000B240
		test	al, al
		jz	short loc_1000AE9D
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, edi
		push	3		; int
		call	sub_1000B240
		test	al, al
		jz	short loc_1000AE9D
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_10] ; Src
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B240
		test	al, al
		jz	short loc_1000AE9D
		push	[esp+14h+arg_14]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000AE9D
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000AE9D:				; CODE XREF: sub_1000ADBD+78j
					; sub_1000ADBD+8Ej ...
		mov	eax, esi

loc_1000AE9F:				; CODE XREF: sub_1000ADBD+5Dj
		pop	esi
		pop	ebp

loc_1000AEA1:				; CODE XREF: sub_1000ADBD+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ADBD	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AEA5(int,	void *Src, int,	int)
sub_1000AEA5	proc near		; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+139p
					; TargetNtQueryFullAttributesFile(x,x,x)+139p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		mov	ebp, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000AEC3

loc_1000AEBB:				; CODE XREF: sub_1000AEA5+58j
					; sub_1000AEA5+6Ej ...
		push	4

loc_1000AEBD:				; CODE XREF: sub_1000AEA5+CEj
		pop	eax
		jmp	loc_1000AF87
; ---------------------------------------------------------------------------

loc_1000AEC3:				; CODE XREF: sub_1000AEA5+14j
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+1Ch+var_C]
		mov	[edi], esi
		mov	esi, [esp+1Ch+arg_0]
		mov	dword ptr [edi+3Ch], 3
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		mov	[esp+1Ch+var_C], esi
		call	sub_1000A353
		xor	ebx, ebx
		mov	ecx, edi
		inc	ebx
		push	ebx		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_1000AEBB
		push	2		; int
		push	0		; char
		push	4		; Size
		push	[esp+28h+Src]	; Src
		mov	ecx, edi
		push	ebx		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_1000AEBB
		mov	eax, [esp+1Ch+arg_8]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; Size
		push	eax		; Src
		mov	[esp+2Ch+var_C], ecx
		mov	ecx, edi
		push	2		; int
		mov	[esp+30h+var_8], eax
		call	sub_1000B0E0
		test	al, al
		jz	short loc_1000AEBB
		push	[esp+1Ch+arg_C]
		mov	ecx, ebp
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000AF85
		mov	ecx, [edi+5Ch]
		add	ecx, edi
		push	ecx		; Src
		lea	ecx, [esp+20h+var_C]
		call	sub_1000A3A8
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_1000AF78
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_1000AEBD
; ---------------------------------------------------------------------------

loc_1000AF78:				; CODE XREF: sub_1000AEA5+BDj
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_1000AF85:				; CODE XREF: sub_1000AEA5+A4j
		mov	eax, esi

loc_1000AF87:				; CODE XREF: sub_1000AEA5+19j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000AEA5	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AF8F(int,	int, int, void *, void *, int)
sub_1000AF8F	proc near		; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+1A8p

Src		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 10h
		push	ebx
		push	esi
		mov	ebx, ecx
		call	sub_100159B0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000AFA9
		push	4
		pop	eax
		jmp	loc_1000B0DA
; ---------------------------------------------------------------------------

loc_1000AFA9:				; CODE XREF: sub_1000AF8F+10j
		mov	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+Src]
		push	ebp
		push	4
		pop	ebp
		push	ebp		; int
		xor	edx, edx
		mov	dword ptr [esi], 7
		push	edx		; char
		push	ebp		; Size
		mov	[esi+4], edx
		mov	dword ptr [esi+3Ch], 5
		push	ecx		; Src
		mov	dword ptr [esi+44h], 88h
		mov	ecx, esi
		mov	eax, [eax]
		push	edx		; int
		mov	[esp+30h+Src], eax
		call	sub_1000B240
		test	al, al
		jnz	short loc_1000AFEB
		mov	eax, ebp
		jmp	loc_1000B0D9
; ---------------------------------------------------------------------------

loc_1000AFEB:				; CODE XREF: sub_1000AF8F+53j
		mov	eax, [esp+1Ch+arg_4]
		push	edi
		push	6		; int
		xor	edi, edi
		mov	ecx, [eax]
		inc	edi
		mov	eax, [eax+4]
		push	edi		; char
		push	ecx		; Size
		push	eax		; Src
		mov	[esp+30h+Src], ecx
		mov	ecx, esi
		push	edi		; int
		mov	[esp+34h+var_C], eax
		call	sub_1000B240
		test	al, al
		jz	loc_1000B0D6
		mov	eax, [esp+20h+arg_8]
		push	6		; int
		push	edi		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; Size
		push	eax		; Src
		mov	[esp+30h+var_8], ecx
		mov	ecx, esi
		push	2		; int
		mov	[esp+34h+var_4], eax
		call	sub_1000B240
		test	al, al
		jz	loc_1000B0D6
		push	2		; int
		push	0		; char
		push	ebp		; Size
		push	[esp+2Ch+arg_C]	; Src
		mov	ecx, esi
		push	3		; int
		call	sub_1000B240
		test	al, al
		jz	loc_1000B0D6
		push	2		; int
		push	0		; char
		push	ebp		; Size
		push	[esp+2Ch+arg_10] ; Src
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000B240
		test	al, al
		jz	short loc_1000B0D6
		push	[esp+20h+arg_14]
		mov	ecx, ebx
		push	esi
		call	sub_10015A29
		mov	ebp, eax
		cmp	ebp, 0Ah
		jz	short loc_1000B0D6
		mov	ecx, [esi+50h]
		add	ecx, esi
		push	ecx		; Src
		lea	ecx, [esp+24h+Src]
		call	sub_1000A3A8
		test	al, al
		jnz	short loc_1000B0A5
		sub	esi, [ebx+4]
		mov	ecx, [ebx]
		shr	esi, 0Ah
		add	ecx, 0Ch
		imul	edx, esi, 14h
		add	ecx, edx
		xchg	edi, [ecx]
		jmp	short loc_1000B0CA
; ---------------------------------------------------------------------------

loc_1000B0A5:				; CODE XREF: sub_1000AF8F+100j
		mov	eax, [esi+5Ch]
		lea	ecx, [esp+20h+var_8]
		add	eax, esi
		push	eax		; Src
		call	sub_1000A3A8
		sub	esi, [ebx+4]
		shr	esi, 0Ah
		imul	ecx, esi, 14h
		test	al, al
		mov	eax, [ebx]
		jnz	short loc_1000B0CF
		add	eax, 0Ch
		add	eax, ecx
		xchg	edi, [eax]

loc_1000B0CA:				; CODE XREF: sub_1000AF8F+114j
		push	2
		pop	eax
		jmp	short loc_1000B0D8
; ---------------------------------------------------------------------------

loc_1000B0CF:				; CODE XREF: sub_1000AF8F+132j
		add	eax, 0Ch
		add	eax, ecx
		xchg	edi, [eax]

loc_1000B0D6:				; CODE XREF: sub_1000AF8F+80j
					; sub_1000AF8F+A7j ...
		mov	eax, ebp

loc_1000B0D8:				; CODE XREF: sub_1000AF8F+13Ej
		pop	edi

loc_1000B0D9:				; CODE XREF: sub_1000AF8F+57j
		pop	ebp

loc_1000B0DA:				; CODE XREF: sub_1000AF8F+15j
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
sub_1000AF8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B0E0(int, void *Src, size_t Size, char,	int)
sub_1000B0E0	proc near		; CODE XREF: sub_1000AEA5+51p
					; sub_1000AEA5+67p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD58
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 3
		jnb	loc_1000B186
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B186
		test	esi, esi
		jz	short loc_1000B110
		cmp	[ebp+Src], 0
		jz	short loc_1000B186

loc_1000B110:				; CODE XREF: sub_1000B0E0+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B186
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B186
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B151
		mov	dword ptr [edi+4], 1

loc_1000B151:				; CODE XREF: sub_1000B0E0+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B188
; ---------------------------------------------------------------------------

loc_1000B178:				; DATA XREF: .rdata:stru_1002DD58o
		xor	eax, eax	; Exception filter 0 for function 1000B0E0
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B17C:				; DATA XREF: .rdata:stru_1002DD58o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B0E0
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B186:				; CODE XREF: sub_1000B0E0+14j
					; sub_1000B0E0+20j ...
		xor	al, al

loc_1000B188:				; CODE XREF: sub_1000B0E0+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B0E0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B190(int, void *Src, size_t Size, char,	int)
sub_1000B190	proc near		; CODE XREF: sub_1000ACA5+51p
					; sub_1000ACA5+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD78
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 7
		jnb	loc_1000B236
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B236
		test	esi, esi
		jz	short loc_1000B1C0
		cmp	[ebp+Src], 0
		jz	short loc_1000B236

loc_1000B1C0:				; CODE XREF: sub_1000B190+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B236
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B236
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B201
		mov	dword ptr [edi+4], 1

loc_1000B201:				; CODE XREF: sub_1000B190+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B238
; ---------------------------------------------------------------------------

loc_1000B228:				; DATA XREF: .rdata:stru_1002DD78o
		xor	eax, eax	; Exception filter 0 for function 1000B190
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B22C:				; DATA XREF: .rdata:stru_1002DD78o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B190
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B236:				; CODE XREF: sub_1000B190+14j
					; sub_1000B190+20j ...
		xor	al, al

loc_1000B238:				; CODE XREF: sub_1000B190+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B190	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B240(int, void *Src, size_t Size, char,	int)
sub_1000B240	proc near		; CODE XREF: sub_1000ADBD+51p
					; sub_1000ADBD+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD98
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 5
		jnb	loc_1000B2E6
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B2E6
		test	esi, esi
		jz	short loc_1000B270
		cmp	[ebp+Src], 0
		jz	short loc_1000B2E6

loc_1000B270:				; CODE XREF: sub_1000B240+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B2E6
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B2E6
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B2B1
		mov	dword ptr [edi+4], 1

loc_1000B2B1:				; CODE XREF: sub_1000B240+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B2E8
; ---------------------------------------------------------------------------

loc_1000B2D8:				; DATA XREF: .rdata:stru_1002DD98o
		xor	eax, eax	; Exception filter 0 for function 1000B240
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B2DC:				; DATA XREF: .rdata:stru_1002DD98o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B240
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B2E6:				; CODE XREF: sub_1000B240+14j
					; sub_1000B240+20j ...
		xor	al, al

loc_1000B2E8:				; CODE XREF: sub_1000B240+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B240	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1000B2F0@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int, int, int, int, int, int, int, HANDLE hTargetProcessHandle)
sub_1000B2F0	proc near		; CODE XREF: sub_1000B746+71p
					; sub_1000B7D4+6Dp

hObject		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
hTargetProcessHandle= dword ptr	 24h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		mov	ebx, ecx
		xor	ebp, ebp
		lea	edx, [esp+14h+var_4]
		push	edi
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		mov	[esp+18h+var_4], ebp
		call	sub_1001881C
		mov	edi, [esp+18h+arg_0]
		lea	eax, [esp+18h+hObject]
		push	ebp
		push	ebp
		push	[esp+20h+arg_14]
		or	[esp+24h+hObject], 0FFFFFFFFh
		push	[esp+24h+arg_10]
		push	[esp+28h+arg_C]
		push	[esp+2Ch+arg_8]
		push	ebp
		push	[esp+34h+arg_4]
		push	edi
		push	esi
		push	eax
		call	[esp+44h+var_4]
		test	eax, eax
		js	short loc_1000B389
		mov	edx, [edi+8]
		mov	ecx, [esp+18h+hObject]
		mov	edx, [edx+4]
		call	sub_1001826B
		test	al, al
		jnz	short loc_1000B361
		push	[esp+18h+hObject] ; hObject
		call	ds:CloseHandle
		mov	eax, 0C0000022h
		jmp	short loc_1000B389
; ---------------------------------------------------------------------------

loc_1000B361:				; CODE XREF: sub_1000B2F0+5Ej
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	ebx		; lpTargetHandle
		push	[esp+28h+hTargetProcessHandle] ; hTargetProcessHandle
		push	[esp+2Ch+hObject] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_1000B389:				; CODE XREF: sub_1000B2F0+4Bj
					; sub_1000B2F0+6Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_1000B2F0	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1000B390@<eax>(void *Src@<ecx>, int)
sub_1000B390	proc near		; CODE XREF: sub_1001525E+14Ep

var_78		= byte ptr -78h
var_68		= byte ptr -68h
var_58		= byte ptr -58h
var_48		= byte ptr -48h
var_38		= dword	ptr -38h
Str1		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		and	[esp+78h+var_38], 0
		push	ebx
		push	ebp
		mov	ebp, [esp+80h+arg_0]
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, edx
		push	esi		; Src
		lea	ecx, [esp+8Ch+Str1] ; Dst
		call	sub_10001C68
		cmp	[esp+88h+var_24], 0
		jz	loc_1000B5DD
		cmp	[esp+88h+var_20], 8
		mov	eax, [esp+88h+Str1]
		jnb	short loc_1000B3D6
		lea	eax, [esp+88h+Str1]

loc_1000B3D6:				; CODE XREF: sub_1000B390+40j
		push	8		; MaxCount
		push	offset Str2	; "\\Device\\"
		push	eax		; Str1
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000B431
		lea	edx, [esp+88h+Str1]
		mov	ecx, edx
		call	sub_1000B9C1
		test	al, al
		jz	loc_1000B5DD
		lea	edx, [esp+88h+Str1]
		lea	ecx, [esp+88h+var_1C] ;	int
		call	sub_1000B9F0
		push	eax		; Src
		lea	ecx, [esp+8Ch+Str1]
		call	sub_10003B23
		push	0
		push	1
		lea	ecx, [esp+90h+var_1C]
		call	sub_100022FA
		cmp	[esp+88h+var_20], 8
		mov	esi, [esp+88h+Str1]
		jnb	short loc_1000B431
		lea	esi, [esp+88h+Str1]

loc_1000B431:				; CODE XREF: sub_1000B390+59j
					; sub_1000B390+9Bj
		push	1Fh
		pop	ebx
		push	3
		lea	ecx, [esp+8Ch+var_78]
		call	sub_1000F976
		push	3
		lea	ecx, [esp+8Ch+var_68]
		call	sub_1000F976
		push	3
		lea	ecx, [esp+8Ch+var_1C]
		call	sub_1000F976
		push	3
		lea	ecx, [esp+8Ch+var_48]
		call	sub_1000F976
		push	3
		lea	ecx, [esp+8Ch+var_58]
		call	sub_1000F976
		sub	edi, 0
		jz	short loc_1000B4CA
		dec	edi
		jz	short loc_1000B4A3
		dec	edi
		jz	short loc_1000B49F
		dec	edi
		jnz	loc_1000B5A8
		push	1
		push	1
		push	3
		push	edi
		lea	ecx, [esp+98h+var_68]
		call	sub_1000FC65
		push	1
		push	1
		push	3
		push	edi
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FC65
		jmp	short loc_1000B4CA
; ---------------------------------------------------------------------------

loc_1000B49F:				; CODE XREF: sub_1000B390+E4j
		push	0Ch
		jmp	short loc_1000B4C9
; ---------------------------------------------------------------------------

loc_1000B4A3:				; CODE XREF: sub_1000B390+E1j
		xor	ebx, ebx
		lea	ecx, [esp+88h+var_68]
		inc	ebx
		mov	edi, 5FEDFF56h
		push	ebx
		push	edi
		push	2
		push	ebx
		call	sub_1000FC65
		push	ebx
		push	edi
		push	2
		push	ebx
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FC65
		push	0Fh

loc_1000B4C9:				; CODE XREF: sub_1000B390+111j
		pop	ebx

loc_1000B4CA:				; CODE XREF: sub_1000B390+DEj
					; sub_1000B390+10Dj
		test	bl, 1
		jz	short loc_1000B4FC
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FB2D
		test	al, al
		jz	loc_1000B5A8
		lea	eax, [esp+88h+var_78]
		mov	ecx, ebp
		push	eax
		push	3
		call	sub_1000F6D9
		test	al, al
		jz	loc_1000B5A8

loc_1000B4FC:				; CODE XREF: sub_1000B390+13Dj
		test	bl, 2
		jz	short loc_1000B52A
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_68]
		call	sub_1000FB2D
		test	al, al
		jz	loc_1000B5A8
		lea	eax, [esp+88h+var_68]
		mov	ecx, ebp
		push	eax
		push	4
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B5A8

loc_1000B52A:				; CODE XREF: sub_1000B390+16Fj
		test	bl, 4
		jz	short loc_1000B554
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_1C]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1000B5A8
		lea	eax, [esp+88h+var_1C]
		mov	ecx, ebp
		push	eax
		push	5
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B5A8

loc_1000B554:				; CODE XREF: sub_1000B390+19Dj
		test	bl, 8
		jz	short loc_1000B57E
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_48]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1000B5A8
		lea	eax, [esp+88h+var_48]
		mov	ecx, ebp
		push	eax
		push	6
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B5A8

loc_1000B57E:				; CODE XREF: sub_1000B390+1C7j
		test	bl, 10h
		jz	short loc_1000B5AC
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_58]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1000B5A8
		lea	eax, [esp+88h+var_58]
		mov	ecx, ebp
		push	eax
		push	7
		call	sub_1000F6D9
		test	al, al
		jnz	short loc_1000B5AC

loc_1000B5A8:				; CODE XREF: sub_1000B390+E7j
					; sub_1000B390+150j ...
		xor	bl, bl
		jmp	short loc_1000B5AE
; ---------------------------------------------------------------------------

loc_1000B5AC:				; CODE XREF: sub_1000B390+1F1j
					; sub_1000B390+216j
		mov	bl, 1

loc_1000B5AE:				; CODE XREF: sub_1000B390+21Aj
		lea	ecx, [esp+88h+var_58]
		call	sub_1000FD8D
		lea	ecx, [esp+88h+var_48]
		call	sub_1000FD8D
		lea	ecx, [esp+88h+var_1C]
		call	sub_1000FD8D
		lea	ecx, [esp+88h+var_68]
		call	sub_1000FD8D
		lea	ecx, [esp+88h+var_78]
		call	sub_1000FD8D
		jmp	short loc_1000B5DF
; ---------------------------------------------------------------------------

loc_1000B5DD:				; CODE XREF: sub_1000B390+31j
					; sub_1000B390+68j
		xor	bl, bl

loc_1000B5DF:				; CODE XREF: sub_1000B390+24Bj
		push	0
		push	1
		lea	ecx, [esp+90h+Str1]
		call	sub_100022FA
		mov	ecx, [esp+88h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
sub_1000B390	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B604	proc near		; CODE XREF: sub_1001525E+12Ep

var_24		= byte ptr -24h
var_14		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_24]
		push	3
		call	sub_1000F976
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F976
		xor	eax, eax
		lea	ecx, [ebp+var_24]
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	[ebp+var_4], eax
		call	sub_1000FC65
		push	0
		mov	bl, al
		xor	eax, eax
		push	offset a??	; "\\/?/?\\*"
		push	ecx
		inc	eax
		lea	ecx, [ebp+var_24]
		push	eax
		call	sub_1000FB2D
		and	bl, al
		lea	ecx, [ebp+var_14]
		xor	eax, eax
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_1000FC65
		push	0
		push	offset asc_1002BEE0 ; "*~*"
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		and	bl, al
		call	sub_1000FB2D
		test	bl, al
		jz	loc_1000B729
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	3
		call	sub_1000F6D9
		test	al, al
		jz	loc_1000B729
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	3
		call	sub_1000F6D9
		test	al, al
		jz	loc_1000B729
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1000B729
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_1000F6D9
		test	al, al
		jnz	short loc_1000B72D

loc_1000B729:				; CODE XREF: sub_1000B604+6Dj
					; sub_1000B604+82j ...
		mov	byte ptr [ebp+var_4], 0

loc_1000B72D:				; CODE XREF: sub_1000B604+123j
		lea	ecx, [ebp+var_14]
		call	sub_1000FD8D
		lea	ecx, [ebp+var_24]
		call	sub_1000FD8D
		mov	eax, [ebp+var_4]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B604	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B746(int,	int, int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_1000B746	proc near		; CODE XREF: sub_10009CCF+C9p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
lpTargetHandle	= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B762
		mov	eax, [ebp+arg_20]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_1000B7CE
; ---------------------------------------------------------------------------

loc_1000B762:				; CODE XREF: sub_1000B746+Dj
		xor	ecx, ecx
		mov	edx, [ebp+arg_4]
		xor	eax, eax
		mov	[ebp+var_28], ecx
		mov	[ebp+var_8], ax
		lea	edi, [ebp+var_24]
		stosd
		mov	[ebp+var_10], ecx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_6], ecx
		stosd
		mov	[ebp+var_2], cx
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	ecx
		mov	ecx, [ebp+arg_0]
		call	sub_1001541F
		add	esp, 0Ch
		mov	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	dword ptr [esi]	; hTargetProcessHandle
		push	ecx		; int
		push	ecx		; int
		push	[ebp+arg_18]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		call	sub_1000B2F0
		mov	ecx, [ebp+arg_20]
		add	esp, 24h
		mov	[ecx], eax
		mov	ecx, [ebp+arg_24]
		mov	eax, [ebp+var_C]
		mov	[ecx], eax
		mov	al, 1

loc_1000B7CE:				; CODE XREF: sub_1000B746+1Aj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B746	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B7D4(int,	int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_1000B7D4	proc near		; CODE XREF: sub_10009DD3+C3p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
lpTargetHandle	= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B7EF
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B856
; ---------------------------------------------------------------------------

loc_1000B7EF:				; CODE XREF: sub_1000B7D4+Ej
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		xor	ebx, ebx
		mov	[ebp+var_8], ax
		mov	[ebp+var_28], ebx
		lea	edi, [ebp+var_24]
		stosd
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		stosd
		mov	[ebp+var_6], ebx
		mov	[ebp+var_2], bx
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	ebx
		call	sub_1001541F
		add	esp, 0Ch
		mov	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	dword ptr [esi]	; hTargetProcessHandle
		push	ecx		; int
		push	ecx		; int
		push	[ebp+arg_10]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	1		; int
		push	[ebp+arg_C]	; int
		push	ebx		; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		call	sub_1000B2F0
		mov	ecx, [ebp+arg_18]
		add	esp, 24h
		mov	edx, [ebp+arg_1C]
		mov	[ecx], eax
		mov	ecx, [ebp+var_C]
		mov	[edx], ecx

loc_1000B856:				; CODE XREF: sub_1000B7D4+19j
		pop	edi
		pop	esi
		mov	al, 1
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B7D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B85F	proc near		; CODE XREF: sub_10009ED1+A8p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B877
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B8C7
; ---------------------------------------------------------------------------

loc_1000B877:				; CODE XREF: sub_1000B85F+Bj
		xor	esi, esi
		lea	edx, [ebp+var_4]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		mov	[ebp+var_4], esi
		call	sub_1001881C
		xor	eax, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		stosd
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_A], esi
		stosd
		mov	[ebp+var_6], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	esi
		call	sub_1001541F
		add	esp, 0Ch
		lea	eax, [ebp+var_24]
		push	[ebp+arg_8]
		push	eax
		call	[ebp+var_4]
		mov	ecx, [ebp+arg_C]
		mov	[ecx], eax

loc_1000B8C7:				; CODE XREF: sub_1000B85F+16j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B85F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B8CF	proc near		; CODE XREF: sub_10009FA2+A8p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B8E7
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B937
; ---------------------------------------------------------------------------

loc_1000B8E7:				; CODE XREF: sub_1000B8CF+Bj
		xor	esi, esi
		lea	edx, [ebp+var_4]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		mov	[ebp+var_4], esi
		call	sub_1001881C
		xor	eax, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		stosd
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_A], esi
		stosd
		mov	[ebp+var_6], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	esi
		call	sub_1001541F
		add	esp, 0Ch
		lea	eax, [ebp+var_24]
		push	[ebp+arg_8]
		push	eax
		call	[ebp+var_4]
		mov	ecx, [ebp+arg_C]
		mov	[ecx], eax

loc_1000B937:				; CODE XREF: sub_1000B8CF+16j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B8CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B93F(HANDLE hSourceHandle, int, int, int,	int, int)
sub_1000B93F	proc near		; CODE XREF: sub_1000A073+FEp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
TargetHandle	= dword	ptr -4
hSourceHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B959

loc_1000B94E:				; CODE XREF: sub_1000B93F+4Bj
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B9B9
; ---------------------------------------------------------------------------

loc_1000B959:				; CODE XREF: sub_1000B93F+Dj
		xor	edi, edi
		lea	edx, [ebp+var_8]
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		mov	[ebp+var_8], edi
		call	sub_1001881C
		push	2		; dwOptions
		push	edi		; bInheritHandle
		push	edi		; dwDesiredAccess
		lea	eax, [ebp+TargetHandle]
		mov	[ebp+TargetHandle], edi
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		push	dword ptr [esi]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000B94E
		push	[ebp+TargetHandle]
		lea	ecx, [ebp+var_C]
		mov	[ebp+var_C], edi
		call	sub_100045FD
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_10]
		push	[ebp+TargetHandle]
		call	[ebp+var_8]
		mov	ecx, [ebp+arg_14]
		mov	[ecx], eax
		lea	ecx, [ebp+var_C]
		call	sub_10004633

loc_1000B9B9:				; CODE XREF: sub_1000B93F+18j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B93F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B9C1	proc near		; CODE XREF: sub_10009CCF+23p
					; sub_10009DD3+23p ...

var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, edx
		call	sub_100184A4
		lea	edx, [ebp+var_1]
		mov	[ebp+var_1], 0
		mov	ecx, esi
		call	sub_10018169
		test	eax, eax
		jz	short loc_1000B9E3
		xor	al, al
		jmp	short loc_1000B9EB
; ---------------------------------------------------------------------------

loc_1000B9E3:				; CODE XREF: sub_1000B9C1+1Cj
		xor	eax, eax
		cmp	[ebp+var_1], al
		setz	al

loc_1000B9EB:				; CODE XREF: sub_1000B9C1+20j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B9C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000B9F0(int)
sub_1000B9F0	proc near		; CODE XREF: sub_1000B390+76p

Src		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		push	edx
		mov	ebx, ecx
		call	sub_1000388D
		mov	esi, offset a??_0 ; "\\/?/?\\"
		lea	edi, [ebp+Src]
		movsd
		movsd
		movsd
		movsw
		mov	esi, offset a??_1 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001ADC
		push	eax
		push	esi
		push	4
		xor	esi, esi
		mov	ecx, ebx
		push	esi
		call	sub_10003F01
		lea	ecx, [ebp+Src]
		test	eax, eax
		jz	short loc_1000BA68
		call	sub_10001ADC
		push	eax
		lea	eax, [ebp+Src]
		mov	ecx, ebx
		push	eax
		push	6
		push	esi
		call	sub_10003F01
		test	eax, eax
		jz	short loc_1000BA7C
		lea	ecx, [ebp+Src]
		call	sub_10001ADC
		push	eax		; int
		lea	eax, [ebp+Src]
		push	eax		; Src
		push	ecx		; int
		mov	ecx, ebx	; int
		call	sub_1000BA8F
		jmp	short loc_1000BA7C
; ---------------------------------------------------------------------------

loc_1000BA68:				; CODE XREF: sub_1000B9F0+47j
		call	sub_10001ADC
		push	eax		; int
		lea	eax, [ebp+Src]
		mov	ecx, ebx
		push	eax		; Src
		push	4		; int
		push	esi		; int
		call	sub_10003F5F

loc_1000BA7C:				; CODE XREF: sub_1000B9F0+5Fj
					; sub_1000B9F0+76j
		mov	ecx, [ebp+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B9F0	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000BA8F(int, int,	void *Src, int)
sub_1000BA8F	proc near		; CODE XREF: sub_1000B9F0+71p

Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+Src]
		mov	esi, ecx
		push	edi
		call	sub_100024AE
		test	al, al
		jz	short loc_1000BAC1
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BAAB
		mov	eax, [esi]
		jmp	short loc_1000BAAD
; ---------------------------------------------------------------------------

loc_1000BAAB:				; CODE XREF: sub_1000BA8F+16j
		mov	eax, esi

loc_1000BAAD:				; CODE XREF: sub_1000BA8F+1Aj
		push	[esp+8+arg_8]	; int
		sub	edi, eax
		sar	edi, 1
		push	edi		; int
		push	esi		; int
		push	ecx		; int
		mov	ecx, esi	; Dst
		call	sub_1000BB3D
		jmp	short loc_1000BB38
; ---------------------------------------------------------------------------

loc_1000BAC1:				; CODE XREF: sub_1000BA8F+10j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_1000BADD
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000BADD:				; CODE XREF: sub_1000BA8F+41j
		test	ebx, ebx
		jz	short loc_1000BB35
		push	ebp
		lea	ebp, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_10002447
		test	al, al
		jz	short loc_1000BB34
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BAFD
		mov	edx, [esi]
		jmp	short loc_1000BAFF
; ---------------------------------------------------------------------------

loc_1000BAFD:				; CODE XREF: sub_1000BA8F+68j
		mov	edx, esi	; Src

loc_1000BAFF:				; CODE XREF: sub_1000BA8F+6Cj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BB09
		mov	eax, [esi]
		jmp	short loc_1000BB0B
; ---------------------------------------------------------------------------

loc_1000BB09:				; CODE XREF: sub_1000BA8F+74j
		mov	eax, esi

loc_1000BB0B:				; CODE XREF: sub_1000BA8F+78j
		push	dword ptr [esi+10h] ; int
		lea	ecx, [eax+ebx*2] ; Dst
		call	sub_10001B16
		cmp	dword ptr [esi+14h], 8
		pop	ecx
		jb	short loc_1000BB21
		mov	ecx, [esi]
		jmp	short loc_1000BB23
; ---------------------------------------------------------------------------

loc_1000BB21:				; CODE XREF: sub_1000BA8F+8Cj
		mov	ecx, esi	; Dst

loc_1000BB23:				; CODE XREF: sub_1000BA8F+90j
		push	ebx		; int
		mov	edx, edi	; Src
		call	sub_10001AFC
		pop	ecx
		push	ebp
		mov	ecx, esi
		call	sub_100023AA

loc_1000BB34:				; CODE XREF: sub_1000BA8F+62j
		pop	ebp

loc_1000BB35:				; CODE XREF: sub_1000BA8F+50j
		mov	eax, esi
		pop	ebx

loc_1000BB38:				; CODE XREF: sub_1000BA8F+30j
		pop	edi
		pop	esi
		retn	0Ch
sub_1000BA8F	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000BB3D(void *Dst, int, int, int,	int)
sub_1000BB3D	proc near		; CODE XREF: sub_1000BA8F+2Bp

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, ecx
		mov	eax, [ebp+10h]
		cmp	eax, ebx
		jb	loc_1000BC24
		push	edi
		mov	edi, [esp+10h+arg_C]
		sub	eax, ebx
		cmp	eax, edi
		jnb	short loc_1000BB62
		mov	edi, eax

loc_1000BB62:				; CODE XREF: sub_1000BB3D+21j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_1000BB79
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000BB79:				; CODE XREF: sub_1000BB3D+2Fj
		test	edi, edi
		jz	loc_1000BC1B
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_4], eax
		call	sub_10002447
		test	al, al
		jz	loc_1000BC1B
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBA4
		mov	edx, [esi]
		jmp	short loc_1000BBA6
; ---------------------------------------------------------------------------

loc_1000BBA4:				; CODE XREF: sub_1000BB3D+61j
		mov	edx, esi	; Src

loc_1000BBA6:				; CODE XREF: sub_1000BB3D+65j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBB0
		mov	eax, [esi]
		jmp	short loc_1000BBB2
; ---------------------------------------------------------------------------

loc_1000BBB0:				; CODE XREF: sub_1000BB3D+6Dj
		mov	eax, esi

loc_1000BBB2:				; CODE XREF: sub_1000BB3D+71j
		push	dword ptr [esi+10h] ; int
		lea	ecx, [eax+edi*2] ; Dst
		call	sub_10001B16
		pop	ecx
		cmp	esi, ebp
		jnz	short loc_1000BBEB
		test	ebx, ebx
		jz	short loc_1000BBC8
		add	ebx, edi

loc_1000BBC8:				; CODE XREF: sub_1000BB3D+87j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBD2
		mov	eax, [esi]
		jmp	short loc_1000BBD4
; ---------------------------------------------------------------------------

loc_1000BBD2:				; CODE XREF: sub_1000BB3D+8Fj
		mov	eax, esi

loc_1000BBD4:				; CODE XREF: sub_1000BB3D+93j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBDE
		mov	ecx, [esi]
		jmp	short loc_1000BBE0
; ---------------------------------------------------------------------------

loc_1000BBDE:				; CODE XREF: sub_1000BB3D+9Bj
		mov	ecx, esi	; Dst

loc_1000BBE0:				; CODE XREF: sub_1000BB3D+9Fj
		push	edi		; int
		lea	edx, [eax+ebx*2] ; Src
		call	sub_10001B16
		jmp	short loc_1000BC0F
; ---------------------------------------------------------------------------

loc_1000BBEB:				; CODE XREF: sub_1000BB3D+83j
		cmp	dword ptr [ebp+14h], 8
		jb	short loc_1000BBF4
		mov	ebp, [ebp+0]

loc_1000BBF4:				; CODE XREF: sub_1000BB3D+B2j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBFE
		mov	ecx, [esi]
		jmp	short loc_1000BC00
; ---------------------------------------------------------------------------

loc_1000BBFE:				; CODE XREF: sub_1000BB3D+BBj
		mov	ecx, esi	; Dst

loc_1000BC00:				; CODE XREF: sub_1000BB3D+BFj
		lea	edx, ds:0[ebx*2]
		push	edi		; int
		add	edx, ebp	; Src
		call	sub_10001AFC

loc_1000BC0F:				; CODE XREF: sub_1000BB3D+ACj
		pop	ecx
		push	[esp+10h+arg_4]
		mov	ecx, esi
		call	sub_100023AA

loc_1000BC1B:				; CODE XREF: sub_1000BB3D+3Ej
					; sub_1000BB3D+57j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------

loc_1000BC24:				; CODE XREF: sub_1000BB3D+12j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_1000BB3D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000BC30(void *, void *Src)
sub_1000BC30	proc near		; CODE XREF: sub_10014CDE+6j

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= byte ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Dst		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		mov	[esp+50h+var_44], ebx
		push	esi
		mov	esi, ecx
		mov	[esp+54h+var_4C], esi
		push	edi
		mov	edi, [ebp+Src]
		test	ebx, ebx
		jnz	short loc_1000BC63
		push	2
		pop	eax
		jmp	loc_1000BE1D
; ---------------------------------------------------------------------------

loc_1000BC63:				; CODE XREF: sub_1000BC30+29j
		and	[esp+58h+var_C], 0
		xor	eax, eax
		mov	[esp+58h+var_8], 7
		mov	[esp+58h+Dst], ax
		test	edi, edi
		jz	short loc_1000BCF8
		mov	ecx, edi
		call	sub_10001ADC
		push	eax		; int
		push	edi		; Src
		lea	ecx, [esp+60h+Dst] ; Dst
		call	sub_1000233F
		push	offset aKey	; "Key"
		lea	ecx, [esp+5Ch+var_3C] ;	Dst
		call	sub_10001C68
		mov	ecx, ebx
		mov	esi, eax
		call	sub_10001ADC
		push	eax
		push	ebx
		push	dword ptr [esi+10h]
		mov	ecx, esi
		push	0
		call	sub_10003F01
		mov	ebx, eax
		lea	ecx, [esp+58h+var_3C]
		push	0
		neg	ebx
		push	1
		sbb	bl, bl
		call	sub_100022FA
		inc	bl
		jz	short loc_1000BCF0
		sub	esp, 18h
		lea	eax, [esp+70h+Dst]
		mov	ecx, esp
		push	eax
		call	sub_1000388D
		lea	ecx, [esp+70h+Dst]
		call	sub_10018078
		add	esp, 18h
		test	al, al
		jnz	short loc_1000BCF0
		push	2
		pop	esi
		jmp	loc_1000BE0E
; ---------------------------------------------------------------------------

loc_1000BCF0:				; CODE XREF: sub_1000BC30+97j
					; sub_1000BC30+B6j
		mov	esi, [esp+58h+var_4C]
		mov	ebx, [esp+58h+var_44]

loc_1000BCF8:				; CODE XREF: sub_1000BC30+49j
		push	ebx		; Src
		lea	ecx, [esp+5Ch+var_3C] ;	Dst
		call	sub_10001C68
		lea	eax, [esp+58h+var_3C]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+5Ch+var_4C]
		push	eax
		call	sub_1000C203
		push	0
		push	1
		lea	ecx, [esp+60h+var_3C]
		call	sub_100022FA
		mov	eax, [esp+58h+var_4C]
		cmp	eax, [esi]
		jnz	loc_1000BDC5
		push	ecx
		push	ecx
		lea	ecx, [esp+60h+var_4C]
		call	sub_1000C310
		push	ebx		; Src
		lea	ecx, [esp+5Ch+var_3C] ;	Dst
		call	sub_10001C68
		push	ecx
		push	ecx
		lea	ecx, [esp+60h+var_24]
		call	sub_1000C310
		mov	ecx, [esp+58h+var_24]
		mov	eax, [esp+58h+var_4C]
		mov	edx, [esp+58h+var_20]
		mov	[esp+58h+var_24], eax
		mov	eax, [esp+58h+var_48]
		mov	[esp+58h+var_20], eax
		movzx	eax, byte_10031F2B
		push	eax
		lea	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_4C], ecx
		push	eax
		push	ecx
		lea	eax, [esp+64h+var_44]
		mov	[esp+64h+var_48], edx
		push	eax
		mov	ecx, esi
		call	sub_1000C398
		lea	ecx, [esp+58h+var_24]
		call	sub_1000C24A
		push	0
		push	1
		lea	ecx, [esp+60h+var_3C]
		call	sub_100022FA
		lea	ecx, [esp+58h+var_4C]
		call	sub_1000C24A
		test	edi, edi
		jz	short loc_1000BE0C
		movzx	eax, byte_10031F2B
		push	eax
		lea	eax, [esp+5Ch+Dst]
		push	eax
		push	ecx
		mov	ecx, [esp+64h+var_44]
		lea	eax, [esp+64h+var_4C]
		push	eax
		lea	ecx, [ecx+28h]
		jmp	short loc_1000BE07
; ---------------------------------------------------------------------------

loc_1000BDC5:				; CODE XREF: sub_1000BC30+F6j
		test	edi, edi
		jnz	short loc_1000BDEB
		lea	esi, [eax+28h]
		mov	eax, [esi]
		mov	ecx, esi
		push	dword ptr [eax+4]
		call	sub_1000C2D1
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	[esi+4], edi
		jmp	short loc_1000BE0C
; ---------------------------------------------------------------------------

loc_1000BDEB:				; CODE XREF: sub_1000BC30+197j
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_1000BE0C
		movzx	ecx, byte_10031F2B
		push	ecx
		lea	ecx, [esp+5Ch+Dst]
		push	ecx
		push	ecx
		lea	ecx, [esp+64h+var_4C]
		push	ecx
		lea	ecx, [eax+28h]

loc_1000BE07:				; CODE XREF: sub_1000BC30+193j
		call	sub_1000C439

loc_1000BE0C:				; CODE XREF: sub_1000BC30+177j
					; sub_1000BC30+1B9j ...
		xor	esi, esi

loc_1000BE0E:				; CODE XREF: sub_1000BC30+BBj
		push	0
		push	1
		lea	ecx, [esp+60h+Dst]
		call	sub_100022FA
		mov	eax, esi

loc_1000BE1D:				; CODE XREF: sub_1000BC30+2Ej
		mov	ecx, [esp+58h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000BC30	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BE31	proc near		; CODE XREF: sub_1000BE9E+14p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [ecx]
		push	edi
		push	8
		pop	edi
		mov	eax, [ebx]
		mov	[esp+10h+var_4], eax
		cmp	eax, ebx
		jz	short loc_1000BE97
		push	ebp
		push	esi

loc_1000BE46:				; CODE XREF: sub_1000BE31+62j
		mov	ecx, [eax+20h]
		mov	ebp, [eax+28h]
		lea	esi, ds:0Eh[ecx*2]
		mov	eax, [ebp+0]
		mov	[esp+18h+var_8], eax
		jmp	short loc_1000BE72
; ---------------------------------------------------------------------------

loc_1000BE5C:				; CODE XREF: sub_1000BE31+43j
		mov	eax, [eax+20h]
		lea	ecx, [esp+18h+var_8]
		lea	esi, [esi+eax*2]
		add	esi, 2
		call	sub_10004B74
		mov	eax, [esp+18h+var_8]

loc_1000BE72:				; CODE XREF: sub_1000BE31+29j
		cmp	eax, ebp
		jnz	short loc_1000BE5C
		mov	eax, esi
		and	eax, 3
		jz	short loc_1000BE82
		sub	esi, eax
		add	esi, 4

loc_1000BE82:				; CODE XREF: sub_1000BE31+4Aj
		lea	ecx, [esp+18h+var_4]
		add	edi, esi
		call	sub_10004B74
		mov	eax, [esp+18h+var_4]
		cmp	eax, ebx
		jnz	short loc_1000BE46
		pop	esi
		pop	ebp

loc_1000BE97:				; CODE XREF: sub_1000BE31+11j
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_1000BE31	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BE9E	proc near		; CODE XREF: sub_10014EB0+4Cp

NumberOfBytesWritten= dword ptr	-4
arg_0		= dword	ptr  4

		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1000BEAF
		mov	al, 1
		jmp	loc_1000BF5D
; ---------------------------------------------------------------------------

loc_1000BEAF:				; CODE XREF: sub_1000BE9E+8j
		push	ebx
		push	ebp
		push	esi
		call	sub_1000BE31
		mov	ebp, eax
		xor	ecx, ecx
		push	4
		shr	eax, 2
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebp		; Size
		push	esi		; Dst
		call	sub_1000BF62
		test	al, al
		jz	short loc_1000BF4A
		mov	ebx, [esp+14h+arg_0]
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	ebp		; dwSize
		mov	ebx, [ebx]
		push	0		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000BF4A
		lea	eax, [esp+14h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	esi		; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000BF3B
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		jnz	short loc_1000BF3B
		mov	ecx, [esp+14h+arg_0]
		push	4		; nSize
		push	offset g_handles_to_close ; lpBuffer
		push	offset aG_handles_to_0 ; "g_handles_to_close"
		mov	g_handles_to_close, edi
		call	sub_10017AC0
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000BF4C
; ---------------------------------------------------------------------------

loc_1000BF3B:				; CODE XREF: sub_1000BE9E+70j
					; sub_1000BE9E+76j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000BF4A:				; CODE XREF: sub_1000BE9E+40j
					; sub_1000BE9E+5Dj
		xor	bl, bl

loc_1000BF4C:				; CODE XREF: sub_1000BE9E+9Bj
		test	esi, esi
		jz	short loc_1000BF58
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1000BF58:				; CODE XREF: sub_1000BE9E+B0j
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_1000BF5D:				; CODE XREF: sub_1000BE9E+Cj
		pop	edi
		pop	ecx
		retn	4
sub_1000BE9E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000BF62(void *Dst,	size_t Size)
sub_1000BF62	proc near		; CODE XREF: sub_1000BE9E+39p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
Dst		= dword	ptr  4
Size		= dword	ptr  8

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+Dst]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+20h+Size]
		push	edi		; Size
		push	0		; Val
		push	esi		; Dst
		mov	[esp+2Ch+var_8], ebp
		call	memset
		mov	[esi], edi
		lea	ecx, [esi+edi]
		mov	eax, [ebp+4]
		lea	ebx, [esi+8]
		mov	[esi+4], eax
		add	esp, 0Ch
		mov	eax, [ebp+0]
		mov	[esp+20h+var_10], ecx
		mov	esi, [eax]
		mov	[esp+20h+Dst], esi
		cmp	esi, eax
		jz	loc_1000C068

loc_1000BFA6:				; CODE XREF: sub_1000BF62+100j
		cmp	ebx, ecx
		jnb	loc_1000C077
		push	ecx
		push	dword ptr [esi+20h]
		mov	edi, ebx
		lea	ecx, [esi+10h]
		push	dword ptr [esi+20h]
		add	ebx, 0Ch
		mov	[esp+2Ch+var_C], edi
		push	ebx
		call	sub_1000C16A
		mov	eax, [esi+20h]
		lea	ebx, [ebx+eax*2]
		xor	eax, eax
		mov	[ebx], ax
		add	ebx, 2
		mov	eax, ebx
		sub	eax, edi
		mov	[edi+4], eax
		mov	eax, [esi+2Ch]
		mov	[edi+8], eax
		mov	ecx, [esi+28h]
		mov	eax, [ecx]
		mov	[esp+20h+Size],	eax
		cmp	eax, ecx
		jz	short loc_1000C03C

loc_1000BFEF:				; CODE XREF: sub_1000BF62+D0j
		lea	ecx, [eax+10h]
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000BFFC
		mov	ebp, [ecx]
		jmp	short loc_1000BFFE
; ---------------------------------------------------------------------------

loc_1000BFFC:				; CODE XREF: sub_1000BF62+94j
		mov	ebp, ecx

loc_1000BFFE:				; CODE XREF: sub_1000BF62+98j
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_10003920
		mov	eax, [eax]
		sub	eax, ebp
		sar	eax, 1
		lea	edi, [eax+eax]
		push	edi		; Size
		push	ebp		; Src
		push	ebx		; Dst
		call	ds:memmove
		add	esp, 0Ch
		lea	ecx, [esp+20h+Size]
		add	ebx, 2
		add	ebx, edi
		call	sub_10004B74
		mov	eax, [esp+20h+Size]
		cmp	eax, [esi+28h]
		jnz	short loc_1000BFEF
		mov	edi, [esp+20h+var_C]
		mov	ebp, [esp+20h+var_8]

loc_1000C03C:				; CODE XREF: sub_1000BF62+8Bj
		mov	eax, ebx
		and	eax, 3
		jz	short loc_1000C048
		sub	ebx, eax
		add	ebx, 4

loc_1000C048:				; CODE XREF: sub_1000BF62+DFj
		mov	eax, ebx
		lea	ecx, [esp+20h+Dst]
		sub	eax, edi
		mov	[edi], eax
		call	sub_10004B74
		mov	esi, [esp+20h+Dst]
		mov	ecx, [esp+20h+var_10]
		cmp	esi, [ebp+0]
		jnz	loc_1000BFA6

loc_1000C068:				; CODE XREF: sub_1000BF62+3Ej
		cmp	ecx, ebx
		sbb	eax, eax
		inc	eax

loc_1000C06D:				; CODE XREF: sub_1000BF62+117j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn	8
; ---------------------------------------------------------------------------

loc_1000C077:				; CODE XREF: sub_1000BF62+46j
		xor	al, al
		jmp	short loc_1000C06D
sub_1000BF62	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C07B	proc near		; CODE XREF: sub_1000CA8B+168p

var_C5		= byte ptr -0C5h
Size		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
Dst		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= byte ptr -0B4h

		sub	esp, 0CCh
		and	[esp+0CCh+var_C0], 0
		cmp	dword_10031F5C,	0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+0DCh+Dst],	edx
		mov	[esp+0DCh+var_B8], ecx
		jnz	short loc_1000C0AA
		mov	edx, offset dword_10031F5C
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_1001881C

loc_1000C0AA:				; CODE XREF: sub_1000C07B+1Ej
		mov	edi, [esp+0DCh+var_B8]
		xor	esi, esi
		mov	[esp+0DCh+Size], 104h

loc_1000C0B8:				; CODE XREF: sub_1000C07B+8Bj
					; sub_1000C07B+93j
		push	[esp+0DCh+Size]	; Size
		call	ds:malloc
		mov	ebx, eax
		pop	ecx
		test	esi, esi
		jz	short loc_1000C0D1
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_1000C0D1:				; CODE XREF: sub_1000C07B+4Cj
		mov	eax, [esp+0DCh+var_C0]
		mov	esi, ebx
		test	al, 1
		jz	short loc_1000C0EB
		and	eax, 0FFFFFFFEh
		lea	ecx, [esp+0DCh+var_B4]
		mov	[esp+0DCh+var_C0], eax
		call	sub_10001BD6

loc_1000C0EB:				; CODE XREF: sub_1000C07B+5Ej
		lea	eax, [esp+0DCh+Size]
		push	eax
		push	[esp+0E0h+Size]
		push	ebx
		push	1
		push	edi
		call	dword_10031F5C
		mov	ebp, eax
		cmp	ebp, 0C0000004h
		jz	short loc_1000C0B8
		cmp	ebp, 80000005h
		jz	short loc_1000C0B8
		mov	edi, [esp+0DCh+Dst]
		test	ebp, ebp
		js	short loc_1000C135
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000C135
		movzx	eax, word ptr [ebx]
		test	ax, ax
		jz	short loc_1000C135
		shr	eax, 1
		mov	ecx, edi	; Dst
		push	eax		; int
		push	dword ptr [ebx+4] ; Src
		call	sub_1000233F
		jmp	short loc_1000C146
; ---------------------------------------------------------------------------

loc_1000C135:				; CODE XREF: sub_1000C07B+9Bj
					; sub_1000C07B+A1j ...
		and	dword ptr [edi+10h], 0
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000C141
		mov	edi, [edi]

loc_1000C141:				; CODE XREF: sub_1000C07B+C2j
		xor	eax, eax
		mov	[edi], ax

loc_1000C146:				; CODE XREF: sub_1000C07B+B8j
		test	ebp, ebp
		setns	al
		mov	[esp+0DCh+var_C5], al
		test	ebx, ebx
		jz	short loc_1000C15F
		push	ebx		; Memory
		call	ds:free
		mov	al, [esp+0E0h+var_C5]
		pop	ecx

loc_1000C15F:				; CODE XREF: sub_1000C07B+D6j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0CCh
		retn
sub_1000C07B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C16A	proc near		; CODE XREF: sub_1000BF62+60p
					; sub_1000DA8C+116p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_8]
		cmp	[ecx+10h], esi
		jnb	short loc_1000C177
		mov	esi, [ecx+10h]

loc_1000C177:				; CODE XREF: sub_1000C16A+8j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000C17F
		mov	ecx, [ecx]

loc_1000C17F:				; CODE XREF: sub_1000C16A+11j
		test	esi, esi
		jz	short loc_1000C196
		push	esi
		push	ecx
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	ds:wmemcpy_s
		add	esp, 10h

loc_1000C196:				; CODE XREF: sub_1000C16A+17j
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000C16A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C19C	proc near		; CODE XREF: sub_1001436D+92p
					; sub_10017D76+FDp
		push	esi
		mov	esi, ecx
		push	30h
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000C1B9
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C1B9:				; CODE XREF: sub_1000C19C+15j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000C1C4
		mov	[ecx], eax

loc_1000C1C4:				; CODE XREF: sub_1000C19C+24j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000C1CD
		mov	[ecx], eax

loc_1000C1CD:				; CODE XREF: sub_1000C19C+2Dj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi], eax
		mov	eax, esi
		pop	esi
		retn
sub_1000C19C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C1D9	proc near		; CODE XREF: sub_100145ED+152p
					; sub_10017D76+11Cp ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000C34F
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000C1D9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C203	proc near		; CODE XREF: sub_1000BC30+DEp
					; sub_1000CA8B+13Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	[ebp+arg_4]
		lea	eax, [ebp+var_4]
		mov	edi, ecx
		push	eax
		call	sub_1000C274
		mov	esi, [ebp+var_4]
		cmp	esi, [edi]
		jz	short loc_1000C233
		lea	eax, [esi+10h]
		push	eax
		push	[ebp+arg_4]
		call	sub_1000C2A8
		test	al, al
		jnz	short loc_1000C233
		mov	[ebp+arg_4], esi
		jmp	short loc_1000C238
; ---------------------------------------------------------------------------

loc_1000C233:				; CODE XREF: sub_1000C203+19j
					; sub_1000C203+29j
		mov	eax, [edi]
		mov	[ebp+arg_4], eax

loc_1000C238:				; CODE XREF: sub_1000C203+2Ej
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000C203	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C24A	proc near		; CODE XREF: sub_1000BC30+15Ap
					; sub_1000BC30+170p ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000C2D1
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000C24A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C274	proc near		; CODE XREF: sub_1000C203+Fp
					; sub_1000C850+99p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_1000C297
; ---------------------------------------------------------------------------

loc_1000C27D:				; CODE XREF: sub_1000C274+27j
		push	[esp+8+arg_4]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000C293
		mov	esi, [esi+8]
		jmp	short loc_1000C297
; ---------------------------------------------------------------------------

loc_1000C293:				; CODE XREF: sub_1000C274+18j
		mov	edi, esi
		mov	esi, [esi]

loc_1000C297:				; CODE XREF: sub_1000C274+7j
					; sub_1000C274+1Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C27D
		mov	eax, [esp+8+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		retn	8
sub_1000C274	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C2A8	proc near		; CODE XREF: sub_1000C203+22p
					; sub_1000C274+11p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax+14h], 8
		mov	ecx, [eax+10h]
		jb	short loc_1000C2B7
		mov	eax, [eax]

loc_1000C2B7:				; CODE XREF: sub_1000C2A8+Bj
		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	eax
		push	dword ptr [ecx+10h]
		push	0
		call	sub_10003F01
		xor	ecx, ecx
		test	eax, eax
		sets	al
		retn	8
sub_1000C2A8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C2D1	proc near		; CODE XREF: sub_1000BC30+1A3p
					; sub_1000C24A+8p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000C30A

loc_1000C2E2:				; CODE XREF: sub_1000C2D1+37j
		push	dword ptr [edi+8]
		mov	ecx, ebx
		call	sub_1000C2D1
		mov	edi, [edi]
		lea	ecx, [esi+10h]
		push	0
		push	1
		call	sub_100022FA
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000C2E2

loc_1000C30A:				; CODE XREF: sub_1000C2D1+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000C2D1	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C310	proc near		; CODE XREF: sub_1000BC30+102p
					; sub_1000BC30+117p ...
		push	esi
		mov	esi, ecx
		push	28h
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000C32D
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C32D:				; CODE XREF: sub_1000C310+15j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000C338
		mov	[ecx], eax

loc_1000C338:				; CODE XREF: sub_1000C310+24j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000C341
		mov	[ecx], eax

loc_1000C341:				; CODE XREF: sub_1000C310+2Dj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi], eax
		mov	eax, esi
		pop	esi
		retn	8
sub_1000C310	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C34F	proc near		; CODE XREF: sub_1000C1D9+8p
					; sub_1000C34F+17p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ebp, ecx
		mov	ebx, edi
		cmp	byte ptr [edi+0Dh], 0
		jnz	short loc_1000C392
		push	esi

loc_1000C361:				; CODE XREF: sub_1000C34F+40j
		push	dword ptr [ebx+8]
		mov	ecx, ebp
		call	sub_1000C34F
		mov	ebx, [ebx]
		lea	ecx, [edi+28h]
		call	sub_1000C24A
		push	0
		push	1
		lea	ecx, [edi+10h]
		call	sub_100022FA
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [ebx+0Dh], 0
		mov	edi, ebx
		pop	ecx
		jz	short loc_1000C361
		pop	esi

loc_1000C392:				; CODE XREF: sub_1000C34F+Fj
		pop	edi
		pop	ebp
		pop	ebx
		retn	4
sub_1000C34F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C398	proc near		; CODE XREF: sub_1000BC30+151p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000C3CA
; ---------------------------------------------------------------------------

loc_1000C3AE:				; CODE XREF: sub_1000C398+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2A8
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000C3C7
		mov	esi, [esi]
		jmp	short loc_1000C3CA
; ---------------------------------------------------------------------------

loc_1000C3C7:				; CODE XREF: sub_1000C398+29j
		mov	esi, [esi+8]

loc_1000C3CA:				; CODE XREF: sub_1000C398+14j
					; sub_1000C398+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C3AE
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000C40B
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000C400
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	1

loc_1000C3E8:				; CODE XREF: sub_1000C398+8Dj
		lea	eax, [ebp+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_1000C4DA
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000C430
; ---------------------------------------------------------------------------

loc_1000C400:				; CODE XREF: sub_1000C398+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EDC
		mov	esi, [ebp+var_4]

loc_1000C40B:				; CODE XREF: sub_1000C398+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000C427
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000C3E8
; ---------------------------------------------------------------------------

loc_1000C427:				; CODE XREF: sub_1000C398+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000C430:				; CODE XREF: sub_1000C398+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000C398	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C439	proc near		; CODE XREF: sub_1000BC30:loc_1000BE07p
					; sub_1000D9F7+60p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000C46B
; ---------------------------------------------------------------------------

loc_1000C44F:				; CODE XREF: sub_1000C439+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2A8
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000C468
		mov	esi, [esi]
		jmp	short loc_1000C46B
; ---------------------------------------------------------------------------

loc_1000C468:				; CODE XREF: sub_1000C439+29j
		mov	esi, [esi+8]

loc_1000C46B:				; CODE XREF: sub_1000C439+14j
					; sub_1000C439+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C44F
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000C4AC
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000C4A1
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	1

loc_1000C489:				; CODE XREF: sub_1000C439+8Dj
		lea	eax, [ebp+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_1000C5FB
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000C4D1
; ---------------------------------------------------------------------------

loc_1000C4A1:				; CODE XREF: sub_1000C439+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EDC
		mov	esi, [ebp+var_4]

loc_1000C4AC:				; CODE XREF: sub_1000C439+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000C4C8
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000C489
; ---------------------------------------------------------------------------

loc_1000C4C8:				; CODE XREF: sub_1000C439+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000C4D1:				; CODE XREF: sub_1000C439+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000C439	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C4DA	proc near		; CODE XREF: sub_1000C398+56p

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 5555554h
		jb	short loc_1000C4F6
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C4F6:				; CODE XREF: sub_1000C4DA+Fj
		push	[ebp+arg_C]
		push	[ebp+arg_10]
		call	sub_1000C72B
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [ebp+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000C520
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000C53F
; ---------------------------------------------------------------------------

loc_1000C520:				; CODE XREF: sub_1000C4DA+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000C532
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000C53F
		mov	[ecx], ebx
		jmp	short loc_1000C53F
; ---------------------------------------------------------------------------

loc_1000C532:				; CODE XREF: sub_1000C4DA+4Aj
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000C53F
		mov	[ecx+8], ebx

loc_1000C53F:				; CODE XREF: sub_1000C4DA+44j
					; sub_1000C4DA+52j ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_1000C5DC
; ---------------------------------------------------------------------------

loc_1000C549:				; CODE XREF: sub_1000C4DA+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000C58D
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000C593
		cmp	esi, [eax+8]
		jnz	short loc_1000C56D
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004AF0

loc_1000C56D:				; CODE XREF: sub_1000C4DA+87j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1000C5D9
; ---------------------------------------------------------------------------

loc_1000C58D:				; CODE XREF: sub_1000C4DA+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000C5AD

loc_1000C593:				; CODE XREF: sub_1000C4DA+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000C5D9
; ---------------------------------------------------------------------------

loc_1000C5AD:				; CODE XREF: sub_1000C4DA+B7j
		cmp	esi, [eax]
		jnz	short loc_1000C5BB
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B31

loc_1000C5BB:				; CODE XREF: sub_1000C4DA+D5j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1000C5D9:				; CODE XREF: sub_1000C4DA+B1j
					; sub_1000C4DA+D1j
		mov	eax, [esi+4]

loc_1000C5DC:				; CODE XREF: sub_1000C4DA+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000C549
		mov	eax, [edi]
		pop	edi
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	ebp
		retn	14h
sub_1000C4DA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C5FB	proc near		; CODE XREF: sub_1000C439+56p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 6666665h
		jb	short loc_1000C612
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C612:				; CODE XREF: sub_1000C5FB+Aj
		push	esi
		push	edi
		call	sub_1000C7AE
		mov	edi, eax
		lea	ecx, [edi+10h]
		mov	word ptr [edi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000C631
		push	[esp+0Ch+arg_C]
		call	sub_1000388D

loc_1000C631:				; CODE XREF: sub_1000C5FB+2Bj
		inc	dword ptr [ebx+4]
		mov	eax, [esp+0Ch+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000C64F
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000C66F
; ---------------------------------------------------------------------------

loc_1000C64F:				; CODE XREF: sub_1000C5FB+44j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000C662
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000C66F
		mov	[ecx], edi
		jmp	short loc_1000C66F
; ---------------------------------------------------------------------------

loc_1000C662:				; CODE XREF: sub_1000C5FB+59j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000C66F
		mov	[ecx+8], edi

loc_1000C66F:				; CODE XREF: sub_1000C5FB+52j
					; sub_1000C5FB+61j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000C70C
; ---------------------------------------------------------------------------

loc_1000C679:				; CODE XREF: sub_1000C5FB+115j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000C6BD
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000C6C3
		cmp	esi, [eax+8]
		jnz	short loc_1000C69D
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_1000C69D:				; CODE XREF: sub_1000C5FB+96j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1000C709
; ---------------------------------------------------------------------------

loc_1000C6BD:				; CODE XREF: sub_1000C5FB+88j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000C6DD

loc_1000C6C3:				; CODE XREF: sub_1000C5FB+91j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000C709
; ---------------------------------------------------------------------------

loc_1000C6DD:				; CODE XREF: sub_1000C5FB+C6j
		cmp	esi, [eax]
		jnz	short loc_1000C6EB
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_1000C6EB:				; CODE XREF: sub_1000C5FB+E4j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1000C709:				; CODE XREF: sub_1000C5FB+C0j
					; sub_1000C5FB+E0j
		mov	eax, [esi+4]

loc_1000C70C:				; CODE XREF: sub_1000C5FB+79j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000C679
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+0Ch+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	14h
sub_1000C5FB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C72B	proc near		; CODE XREF: sub_1000C4DA+22p

arg_4		= dword	ptr  8

		push	ebx
		push	esi
		call	sub_1000C778
		mov	ebx, eax
		lea	esi, [ebx+10h]
		mov	word ptr [ebx+0Ch], 0
		test	esi, esi
		jz	short loc_1000C771
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		call	sub_1000388D
		push	ecx
		push	ecx
		lea	ecx, [esi+18h]
		call	sub_1000C310
		mov	eax, [edi+18h]
		mov	ecx, [esi+18h]
		mov	[esi+18h], eax
		mov	[edi+18h], ecx
		mov	eax, [edi+1Ch]
		mov	ecx, [esi+1Ch]
		mov	[esi+1Ch], eax
		mov	[edi+1Ch], ecx
		pop	edi

loc_1000C771:				; CODE XREF: sub_1000C72B+14j
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn	8
sub_1000C72B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C778	proc near		; CODE XREF: sub_1000C72B+2p
					; sub_1000C850+C5p
		push	esi
		push	30h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_1000C790
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C790:				; CODE XREF: sub_1000C778+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000C79F
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C79F:				; CODE XREF: sub_1000C778+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000C7AA
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7AA:				; CODE XREF: sub_1000C778+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_1000C778	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C7AE	proc near		; CODE XREF: sub_1000C5FB+19p
					; sub_1000CF84+19p
		push	esi
		push	28h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_1000C7C6
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C7C6:				; CODE XREF: sub_1000C7AE+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000C7D5
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7D5:				; CODE XREF: sub_1000C7AE+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000C7E0
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7E0:				; CODE XREF: sub_1000C7AE+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_1000C7AE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C7E4	proc near		; CODE XREF: sub_1000CA8B+A6p
					; sub_1000CA8B+DCp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002DDB8
		call	__SEH_prolog4
		mov	edi, edx
		mov	ebx, ecx
		mov	esi, dword_10031F60
		test	esi, esi
		jnz	short loc_1000C813
		mov	edx, offset dword_10031F60
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_1001881C
		mov	esi, dword_10031F60

loc_1000C813:				; CODE XREF: sub_1000C7E4+18j
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+arg_0]
		push	eax
		push	dword ptr [eax]
		push	edi
		push	2
		push	ebx
		call	esi ; dword_10031F60
		jmp	short loc_1000C840
; ---------------------------------------------------------------------------

loc_1000C825:				; DATA XREF: .rdata:stru_1002DDB8o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1000C7E4
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	dword ptr [eax], 0C0000008h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1000C838:				; DATA XREF: .rdata:stru_1002DDB8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000C7E4
		mov	eax, 0C0000008h

loc_1000C840:				; CODE XREF: sub_1000C7E4+3Fj
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_1000C7E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C850	proc near		; CODE XREF: sub_10017D76+106p

var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= byte ptr -0F0h
var_EC		= byte ptr -0ECh
Dst		= byte ptr -38h
Src		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 10Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10Ch+var_8], eax
		mov	eax, g_handles_to_close
		push	ebx
		push	ebp
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		mov	[esp+118h+var_10C], esi
		mov	[esp+118h+var_100], ebx
		push	edi
		test	eax, eax
		jnz	short loc_1000C8A2
		push	3
		push	2Eh
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+128h+var_EC]
		inc	ebx
		call	sub_10001B31
		mov	edx, offset aCheckFailedG_h ; "Check failed: g_handles_to_close	!= NUL"...
		lea	ecx, [eax+8]
		call	sub_10002830
		mov	eax, g_handles_to_close

loc_1000C8A2:				; CODE XREF: sub_1000C850+2Bj
		test	bl, 1
		jz	short loc_1000C8B8
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFEh
		call	sub_10001BD6
		mov	eax, g_handles_to_close

loc_1000C8B8:				; CODE XREF: sub_1000C850+55j
		xor	ebp, ebp
		lea	edi, [eax+8]
		mov	[esp+11Ch+var_108], ebp
		cmp	[eax+4], ebp
		jbe	loc_1000CA5D

loc_1000C8CA:				; CODE XREF: sub_1000C850+207j
		lea	eax, [edi+0Ch]
		push	eax		; Src
		lea	ecx, [esp+120h+Dst] ; Dst
		call	sub_10001C68
		lea	eax, [esp+11Ch+Dst]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+120h+var_104]
		push	eax
		call	sub_1000C274
		mov	eax, [esp+11Ch+var_10C]
		mov	esi, [esp+11Ch+var_104]
		cmp	esi, [eax]
		jz	short loc_1000C913
		lea	eax, [esi+10h]
		push	eax
		lea	eax, [esp+120h+Dst]
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000C962
		mov	eax, [esp+11Ch+var_10C]

loc_1000C913:				; CODE XREF: sub_1000C850+A8j
		mov	ecx, eax
		call	sub_1000C778
		mov	ebp, eax
		lea	eax, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	eax, eax
		jz	short loc_1000C945
		lea	ecx, [esp+11Ch+Dst]
		push	ecx
		mov	ecx, eax
		call	sub_1000388D
		push	ecx
		push	ecx
		lea	ecx, [ebp+28h]
		call	sub_1000C310
		lea	eax, [ebp+10h]

loc_1000C945:				; CODE XREF: sub_1000C850+D7j
		mov	ecx, [esp+11Ch+var_10C]
		push	ebp
		push	eax
		push	esi
		lea	eax, [esp+128h+var_F8]
		push	eax
		call	sub_1000CE22
		mov	esi, [esp+11Ch+var_F8]
		mov	ebp, [esp+11Ch+var_108]
		mov	[esp+11Ch+var_104], esi

loc_1000C962:				; CODE XREF: sub_1000C850+BDj
		push	0
		lea	eax, [esi+28h]
		push	1
		lea	ecx, [esp+124h+Dst]
		mov	[esp+124h+var_100], eax
		call	sub_100022FA
		mov	esi, [edi+4]
		and	[esp+11Ch+var_FC], 0
		add	esi, edi
		cmp	dword ptr [edi+8], 0
		jbe	loc_1000CA22
		mov	ebp, [esp+11Ch+var_FC]

loc_1000C991:				; CODE XREF: sub_1000C850+1C8j
		push	esi		; Src
		lea	ecx, [esp+120h+Src] ; Dst
		call	sub_10001C68
		movzx	eax, byte_10031F3C
		push	eax		; int
		lea	eax, [esp+120h+Src]
		push	eax		; Src
		push	ecx		; int
		mov	ecx, [esp+128h+var_100]
		lea	eax, [esp+128h+var_F4]
		push	eax		; int
		call	sub_1000CD81
		push	0
		push	1
		lea	ecx, [esp+124h+Src]
		call	sub_100022FA
		cmp	[esp+11Ch+var_F0], 0
		jnz	short loc_1000C9F6
		push	3
		push	3Ch
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+128h+var_EC]
		or	ebx, 2
		call	sub_10001B31
		mov	edx, offset aCheckFailedNam ; "Check failed: name.second. "
		lea	ecx, [eax+8]
		call	sub_10002830

loc_1000C9F6:				; CODE XREF: sub_1000C850+182j
		test	bl, 2
		jz	short loc_1000CA07
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFDh
		call	sub_10001BD6

loc_1000CA07:				; CODE XREF: sub_1000C850+1A9j
		mov	eax, [esp+11Ch+var_F4]
		mov	eax, [eax+20h]
		lea	esi, [esi+eax*2]
		add	esi, 2
		inc	ebp
		cmp	ebp, [edi+8]
		jb	loc_1000C991
		mov	ebp, [esp+11Ch+var_108]

loc_1000CA22:				; CODE XREF: sub_1000C850+137j
		add	edi, [edi]
		test	bl, 4
		jz	short loc_1000CA35
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFBh
		call	sub_10001BD6

loc_1000CA35:				; CODE XREF: sub_1000C850+1D7j
		test	bl, 8
		jz	short loc_1000CA46
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFF7h
		call	sub_10001BD6

loc_1000CA46:				; CODE XREF: sub_1000C850+1E8j
		mov	eax, g_handles_to_close
		inc	ebp
		mov	esi, [esp+11Ch+var_10C]
		mov	[esp+11Ch+var_108], ebp
		cmp	ebp, [eax+4]
		jb	loc_1000C8CA

loc_1000CA5D:				; CODE XREF: sub_1000C850+74j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	eax		; lpAddress
		call	ds:VirtualFree
		mov	ecx, [esp+11Ch+var_8]
		and	g_handles_to_close, 0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10Ch
		retn
sub_1000C850	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CA8B	proc near		; CODE XREF: sub_10017D76+10Fp

pdwHandleCount	= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= word ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Dst		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_8], eax
		or	[esp+5Ch+pdwHandleCount], 0FFFFFFFFh
		lea	eax, [esp+5Ch+pdwHandleCount]
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	eax		; pdwHandleCount
		mov	[esp+70h+var_4C], ecx
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:GetProcessHandleCount
		test	eax, eax
		jnz	short loc_1000CAC3
		xor	al, al
		jmp	loc_1000CC52
; ---------------------------------------------------------------------------

loc_1000CAC3:				; CODE XREF: sub_1000CA8B+2Fj
		mov	ebx, 0A0h
		push	ebx
		call	sub_10001AB4
		mov	esi, eax
		push	ebx		; Size
		push	0		; Val
		push	esi		; Dst
		lea	edi, [esi+0A0h]
		mov	[esp+78h+var_48], esi
		mov	[esp+78h+var_40], edi
		call	memset
		and	[esp+78h+var_28], 0
		xor	eax, eax
		xor	ebp, ebp
		mov	[esp+78h+var_44], edi
		add	esp, 0Ch
		mov	[esp+6Ch+var_24], 7
		xor	ebx, ebx
		mov	[esp+6Ch+var_38], ax
		mov	[esp+6Ch+var_50], ebp
		cmp	[esp+6Ch+pdwHandleCount], eax
		jz	loc_1000CC35

loc_1000CB14:				; CODE XREF: sub_1000CA8B+1A4j
		cmp	ebp, 64h
		jge	loc_1000CC35
		mov	eax, edi
		add	ebx, 4
		sub	eax, esi
		mov	edx, esi
		mov	[esp+6Ch+var_54], eax
		mov	ecx, ebx
		lea	eax, [esp+6Ch+var_54]
		push	eax
		call	sub_1000C7E4
		pop	ecx
		mov	ecx, eax

loc_1000CB39:				; CODE XREF: sub_1000CA8B+EAj
					; sub_1000CA8B+F4j ...
		cmp	ecx, 0C0000004h
		jz	short loc_1000CB49
		cmp	ecx, 80000005h
		jnz	short loc_1000CB88

loc_1000CB49:				; CODE XREF: sub_1000CA8B+B4j
		mov	eax, [esp+6Ch+var_54]
		lea	ecx, [esp+6Ch+var_48]
		add	eax, 2
		push	eax
		call	sub_1000CCAA
		mov	esi, [esp+6Ch+var_48]
		lea	eax, [esp+6Ch+var_54]
		push	eax
		mov	edx, esi
		mov	ecx, ebx
		call	sub_1000C7E4
		mov	edi, [esp+70h+var_44]
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		js	short loc_1000CB39
		mov	eax, edi
		sub	eax, esi
		cmp	[esp+6Ch+var_54], eax
		jnz	short loc_1000CB39
		mov	ecx, 0C0000004h
		jmp	short loc_1000CB39
; ---------------------------------------------------------------------------

loc_1000CB88:				; CODE XREF: sub_1000CA8B+BCj
		test	ecx, ecx
		js	loc_1000CC65
		cmp	dword ptr [esi+4], 0
		jz	loc_1000CC65
		dec	[esp+6Ch+pdwHandleCount]
		xor	edx, edx
		movzx	ecx, word ptr [esi]
		mov	eax, [esi+4]
		shr	ecx, 1
		mov	[eax+ecx*2], dx
		lea	ecx, [esp+6Ch+Dst] ; Dst
		push	dword ptr [esi+4] ; Src
		call	sub_10001C68
		mov	ecx, [esp+6Ch+var_4C]
		lea	eax, [esp+6Ch+Dst]
		push	eax
		lea	eax, [esp+70h+var_3C]
		push	eax
		call	sub_1000C203
		push	0
		push	1
		lea	ecx, [esp+74h+Dst]
		call	sub_100022FA
		mov	ecx, [esp+6Ch+var_4C]
		mov	eax, [esp+6Ch+var_3C]
		cmp	eax, [ecx]
		jz	short loc_1000CC2A
		lea	ebp, [eax+28h]
		cmp	dword ptr [ebp+4], 0
		jz	short loc_1000CC0C
		lea	edx, [esp+6Ch+var_38]
		mov	ecx, ebx
		call	sub_1000C07B
		test	al, al
		jz	short loc_1000CC26
		lea	eax, [esp+6Ch+var_38]
		mov	ecx, ebp
		push	eax
		call	sub_1000CC70
		test	eax, eax
		jz	short loc_1000CC26

loc_1000CC0C:				; CODE XREF: sub_1000CA8B+160j
		push	0		; dwFlags
		push	2		; dwMask
		push	ebx		; hObject
		call	ds:SetHandleInformation
		test	eax, eax
		jz	short loc_1000CC6C
		push	ebx		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jz	short loc_1000CC6C

loc_1000CC26:				; CODE XREF: sub_1000CA8B+16Fj
					; sub_1000CA8B+17Fj
		mov	ebp, [esp+6Ch+var_50]

loc_1000CC2A:				; CODE XREF: sub_1000CA8B+157j
					; sub_1000CA8B+1DFj
		cmp	[esp+6Ch+pdwHandleCount], 0
		jnz	loc_1000CB14

loc_1000CC35:				; CODE XREF: sub_1000CA8B+83j
					; sub_1000CA8B+8Cj
		mov	bl, 1

loc_1000CC37:				; CODE XREF: sub_1000CA8B+1E3j
		push	0
		push	1
		lea	ecx, [esp+74h+var_38]
		call	sub_100022FA
		test	esi, esi
		jz	short loc_1000CC50
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000CC50:				; CODE XREF: sub_1000CA8B+1BBj
		mov	al, bl

loc_1000CC52:				; CODE XREF: sub_1000CA8B+33j
		mov	ecx, [esp+6Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CC65:				; CODE XREF: sub_1000CA8B+FFj
					; sub_1000CA8B+109j
		inc	ebp
		mov	[esp+6Ch+var_50], ebp
		jmp	short loc_1000CC2A
; ---------------------------------------------------------------------------

loc_1000CC6C:				; CODE XREF: sub_1000CA8B+18Ej
					; sub_1000CA8B+199j
		xor	bl, bl
		jmp	short loc_1000CC37
sub_1000CA8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000CC70	proc near		; CODE XREF: sub_1000CA8B+178p
					; sub_1000D9F7+34p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_1000CCED
		mov	eax, [ebp+var_8]
		xor	edi, edi
		mov	esi, [ebp+var_4]
		mov	[ebp+arg_0], eax
		cmp	eax, esi
		jz	short loc_1000CCA0

loc_1000CC92:				; CODE XREF: sub_1000CC70+2Ej
		lea	ecx, [ebp+arg_0]
		inc	edi
		call	sub_10004B74
		cmp	[ebp+arg_0], esi
		jnz	short loc_1000CC92

loc_1000CCA0:				; CODE XREF: sub_1000CC70+20j
		mov	eax, edi
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000CC70	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CCAA	proc near		; CODE XREF: sub_1000CA8B+CAp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		mov	eax, [esi]
		sub	ecx, eax
		cmp	ecx, edi
		ja	short loc_1000CCE3
		jnb	short loc_1000CCE8
		sub	eax, [esi+4]
		mov	ecx, esi
		add	eax, edi
		push	eax
		call	sub_10003158
		mov	eax, [esi]
		sub	eax, [esi+4]
		add	eax, edi
		push	eax		; Size
		push	0		; Val
		push	dword ptr [esi+4] ; Dst
		call	memset
		mov	eax, [esi]
		add	esp, 0Ch

loc_1000CCE3:				; CODE XREF: sub_1000CCAA+11j
		add	eax, edi
		mov	[esi+4], eax

loc_1000CCE8:				; CODE XREF: sub_1000CCAA+13j
		pop	edi
		pop	esi
		retn	4
sub_1000CCAA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CCED	proc near		; CODE XREF: sub_1000CC70+Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, [eax]
		mov	edi, ebx
		mov	[esp+10h+var_4], eax
		mov	esi, [ebx+4]
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000CD40
		push	ebp

loc_1000CD05:				; CODE XREF: sub_1000CCED+4Cj
		push	[esp+14h+arg_4]
		lea	ebp, [esi+10h]
		push	ebp
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CD1B
		mov	esi, [esi+8]
		jmp	short loc_1000CD35
; ---------------------------------------------------------------------------

loc_1000CD1B:				; CODE XREF: sub_1000CCED+27j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000CD31
		push	ebp
		push	[esp+18h+arg_4]
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CD31
		mov	edi, esi

loc_1000CD31:				; CODE XREF: sub_1000CCED+32j
					; sub_1000CCED+40j
		mov	ebx, esi
		mov	esi, [esi]

loc_1000CD35:				; CODE XREF: sub_1000CCED+2Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CD05
		mov	eax, [esp+14h+var_4]
		pop	ebp

loc_1000CD40:				; CODE XREF: sub_1000CCED+15j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000CD4D
		mov	eax, [eax]
		mov	esi, [eax+4]
		jmp	short loc_1000CD6B
; ---------------------------------------------------------------------------

loc_1000CD4D:				; CODE XREF: sub_1000CCED+57j
		mov	esi, [edi]
		jmp	short loc_1000CD6B
; ---------------------------------------------------------------------------

loc_1000CD51:				; CODE XREF: sub_1000CCED+82j
		lea	eax, [esi+10h]
		push	eax
		push	[esp+14h+arg_4]
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CD68
		mov	edi, esi
		mov	esi, [esi]
		jmp	short loc_1000CD6B
; ---------------------------------------------------------------------------

loc_1000CD68:				; CODE XREF: sub_1000CCED+73j
		mov	esi, [esi+8]

loc_1000CD6B:				; CODE XREF: sub_1000CCED+5Ej
					; sub_1000CCED+62j ...
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CD51
		mov	eax, [esp+10h+arg_0]
		mov	[eax+4], edi
		pop	edi
		pop	esi
		mov	[eax], ebx
		pop	ebx
		pop	ecx
		retn	8
sub_1000CCED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000CD81(int, int, void *Src, int)
sub_1000CD81	proc near		; CODE XREF: sub_1000C850+168p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
Src		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000CDB3
; ---------------------------------------------------------------------------

loc_1000CD97:				; CODE XREF: sub_1000CD81+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+Src]
		call	sub_1000C2A8
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000CDB0
		mov	esi, [esi]
		jmp	short loc_1000CDB3
; ---------------------------------------------------------------------------

loc_1000CDB0:				; CODE XREF: sub_1000CD81+29j
		mov	esi, [esi+8]

loc_1000CDB3:				; CODE XREF: sub_1000CD81+14j
					; sub_1000CD81+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CD97
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000CDF4
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000CDE9
		push	[ebp+arg_C]	; int
		push	[ebp+Src]	; Src
		push	edi		; int
		push	1		; int

loc_1000CDD1:				; CODE XREF: sub_1000CD81+8Dj
		lea	eax, [ebp+Src]
		mov	ecx, ebx
		push	eax		; int
		call	sub_1000CF84
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000CE19
; ---------------------------------------------------------------------------

loc_1000CDE9:				; CODE XREF: sub_1000CD81+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EDC
		mov	esi, [ebp+var_4]

loc_1000CDF4:				; CODE XREF: sub_1000CD81+3Fj
		push	[ebp+Src]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CE10
		push	[ebp+arg_C]
		push	[ebp+Src]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000CDD1
; ---------------------------------------------------------------------------

loc_1000CE10:				; CODE XREF: sub_1000CD81+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000CE19:				; CODE XREF: sub_1000CD81+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000CD81	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CE22	proc near		; CODE XREF: sub_1000C850+101p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+14h+var_C], ebp
		cmp	[edi+4], ebp
		jnz	short loc_1000CE4F
		push	[esp+14h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+24h+arg_0]
		call	sub_1000D0DB
		mov	eax, [esp+14h+arg_0]
		jmp	loc_1000CF7C
; ---------------------------------------------------------------------------

loc_1000CE4F:				; CODE XREF: sub_1000CE22+10j
		mov	ecx, [edi]
		mov	eax, [esp+14h+arg_4]
		push	ebx
		mov	ebx, [esp+18h+arg_8]
		push	esi
		cmp	eax, [ecx]
		jnz	short loc_1000CE81
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2A8
		test	al, al
		jz	loc_1000CF60
		push	[esp+1Ch+arg_C]
		push	ecx
		push	[esp+24h+arg_4]
		mov	ecx, edi
		jmp	loc_1000CF4F
; ---------------------------------------------------------------------------

loc_1000CE81:				; CODE XREF: sub_1000CE22+3Bj
		cmp	eax, ecx
		jnz	short loc_1000CEAC
		mov	eax, [ecx+8]
		add	eax, 10h
		push	ebx
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	loc_1000CF60
		push	[esp+1Ch+arg_C]
		mov	eax, [edi]
		push	ecx
		mov	ecx, edi
		push	dword ptr [eax+8]
		push	ebp
		jmp	loc_1000CF51
; ---------------------------------------------------------------------------

loc_1000CEAC:				; CODE XREF: sub_1000CE22+61j
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CEF8
		mov	eax, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], eax
		call	sub_10004EDC
		push	ebx
		mov	eax, [eax]
		add	eax, 10h
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CEF8
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000CEF2
		push	eax
		jmp	short loc_1000CF48
; ---------------------------------------------------------------------------

loc_1000CEF2:				; CODE XREF: sub_1000CE22+CBj
		push	[esp+24h+arg_4]
		jmp	short loc_1000CF4F
; ---------------------------------------------------------------------------

loc_1000CEF8:				; CODE XREF: sub_1000CE22+96j
					; sub_1000CE22+B7j
		mov	eax, [esp+1Ch+arg_4]
		push	ebx
		add	eax, 10h
		push	eax
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CF60
		mov	esi, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B74
		mov	eax, [eax]
		cmp	eax, [edi]
		jz	short loc_1000CF37
		mov	eax, [esp+1Ch+var_C]
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2A8
		test	al, al
		jz	short loc_1000CF60
		mov	esi, [esp+1Ch+arg_4]

loc_1000CF37:				; CODE XREF: sub_1000CE22+FDj
		mov	eax, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [eax+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000CF4B
		push	esi

loc_1000CF48:				; CODE XREF: sub_1000CE22+CEj
		push	ebp
		jmp	short loc_1000CF51
; ---------------------------------------------------------------------------

loc_1000CF4B:				; CODE XREF: sub_1000CE22+123j
		push	[esp+24h+var_C]

loc_1000CF4F:				; CODE XREF: sub_1000CE22+5Aj
					; sub_1000CE22+D4j
		push	1

loc_1000CF51:				; CODE XREF: sub_1000CE22+85j
					; sub_1000CE22+127j
		push	[esp+2Ch+arg_0]
		call	sub_1000D0DB
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_1000CF7A
; ---------------------------------------------------------------------------

loc_1000CF60:				; CODE XREF: sub_1000CE22+49j
					; sub_1000CE22+72j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_1000D1FC
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_1000CF7A:				; CODE XREF: sub_1000CE22+13Cj
		pop	esi
		pop	ebx

loc_1000CF7C:				; CODE XREF: sub_1000CE22+28j
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn	10h
sub_1000CE22	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000CF84(int, int, int, void *Src, int)
sub_1000CF84	proc near		; CODE XREF: sub_1000CD81+56p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
Src		= dword	ptr  10h

		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 6666665h
		jb	short loc_1000CF9B
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000CF9B:				; CODE XREF: sub_1000CF84+Aj
		push	esi
		push	edi
		call	sub_1000C7AE
		mov	edi, eax
		lea	ecx, [edi+10h]
		mov	word ptr [edi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000CFBA
		push	[esp+0Ch+Src]	; Src
		call	sub_1000346E

loc_1000CFBA:				; CODE XREF: sub_1000CF84+2Bj
		inc	dword ptr [ebx+4]
		mov	eax, [esp+0Ch+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000CFD8
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000CFF8
; ---------------------------------------------------------------------------

loc_1000CFD8:				; CODE XREF: sub_1000CF84+44j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000CFEB
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000CFF8
		mov	[ecx], edi
		jmp	short loc_1000CFF8
; ---------------------------------------------------------------------------

loc_1000CFEB:				; CODE XREF: sub_1000CF84+59j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000CFF8
		mov	[ecx+8], edi

loc_1000CFF8:				; CODE XREF: sub_1000CF84+52j
					; sub_1000CF84+61j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000D095
; ---------------------------------------------------------------------------

loc_1000D002:				; CODE XREF: sub_1000CF84+115j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000D046
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000D04C
		cmp	esi, [eax+8]
		jnz	short loc_1000D026
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_1000D026:				; CODE XREF: sub_1000CF84+96j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1000D092
; ---------------------------------------------------------------------------

loc_1000D046:				; CODE XREF: sub_1000CF84+88j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D066

loc_1000D04C:				; CODE XREF: sub_1000CF84+91j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000D092
; ---------------------------------------------------------------------------

loc_1000D066:				; CODE XREF: sub_1000CF84+C6j
		cmp	esi, [eax]
		jnz	short loc_1000D074
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_1000D074:				; CODE XREF: sub_1000CF84+E4j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1000D092:				; CODE XREF: sub_1000CF84+C0j
					; sub_1000CF84+E0j
		mov	eax, [esi+4]

loc_1000D095:				; CODE XREF: sub_1000CF84+79j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000D002
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+0Ch+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	14h
sub_1000CF84	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D0B4	proc near		; CODE XREF: sub_1000D0DB+15p
					; sub_1000D1FC:loc_1000D287p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		lea	ecx, [edi+28h]
		call	sub_1000C24A
		push	0
		push	1
		lea	ecx, [edi+10h]
		call	sub_100022FA
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		pop	esi
		retn	4
sub_1000D0B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D0DB	proc near		; CODE XREF: sub_1000CE22+1Fp
					; sub_1000CE22+133p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 5555554h
		jb	short loc_1000D100
		push	[ebp+arg_10]
		call	sub_1000D0B4
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000D100:				; CODE XREF: sub_1000D0DB+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000D121
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000D140
; ---------------------------------------------------------------------------

loc_1000D121:				; CODE XREF: sub_1000D0DB+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000D133
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000D140
		mov	[ecx], edi
		jmp	short loc_1000D140
; ---------------------------------------------------------------------------

loc_1000D133:				; CODE XREF: sub_1000D0DB+4Aj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000D140
		mov	[ecx+8], edi

loc_1000D140:				; CODE XREF: sub_1000D0DB+44j
					; sub_1000D0DB+52j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000D1DD
; ---------------------------------------------------------------------------

loc_1000D14A:				; CODE XREF: sub_1000D0DB+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000D18E
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000D194
		cmp	esi, [eax+8]
		jnz	short loc_1000D16E
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_1000D16E:				; CODE XREF: sub_1000D0DB+87j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1000D1DA
; ---------------------------------------------------------------------------

loc_1000D18E:				; CODE XREF: sub_1000D0DB+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D1AE

loc_1000D194:				; CODE XREF: sub_1000D0DB+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000D1DA
; ---------------------------------------------------------------------------

loc_1000D1AE:				; CODE XREF: sub_1000D0DB+B7j
		cmp	esi, [eax]
		jnz	short loc_1000D1BC
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_1000D1BC:				; CODE XREF: sub_1000D0DB+D5j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1000D1DA:				; CODE XREF: sub_1000D0DB+B1j
					; sub_1000D0DB+D1j
		mov	eax, [esi+4]

loc_1000D1DD:				; CODE XREF: sub_1000D0DB+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000D14A
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000D0DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D1FC	proc near		; CODE XREF: sub_1000CE22+14Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000D22E
; ---------------------------------------------------------------------------

loc_1000D212:				; CODE XREF: sub_1000D1FC+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2A8
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000D22B
		mov	esi, [esi]
		jmp	short loc_1000D22E
; ---------------------------------------------------------------------------

loc_1000D22B:				; CODE XREF: sub_1000D1FC+29j
		mov	esi, [esi+8]

loc_1000D22E:				; CODE XREF: sub_1000D1FC+14j
					; sub_1000D1FC+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000D212
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000D26D
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000D262
		push	[ebp+arg_C]
		push	ecx
		push	edi
		push	1

loc_1000D24A:				; CODE XREF: sub_1000D1FC+89j
		lea	eax, [ebp+arg_C]
		mov	ecx, ebx
		push	eax
		call	sub_1000D0DB
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000D295
; ---------------------------------------------------------------------------

loc_1000D262:				; CODE XREF: sub_1000D1FC+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EDC
		mov	esi, [ebp+var_4]

loc_1000D26D:				; CODE XREF: sub_1000D1FC+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2A8
		push	[ebp+arg_C]
		test	al, al
		jz	short loc_1000D287
		push	ecx
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000D24A
; ---------------------------------------------------------------------------

loc_1000D287:				; CODE XREF: sub_1000D1FC+82j
		call	sub_1000D0B4
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000D295:				; CODE XREF: sub_1000D1FC+64j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000D1FC	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D29E	proc near		; DATA XREF: .rdata:1002C01Co

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C014
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_1000D2BB
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D2BB:				; CODE XREF: sub_1000D29E+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000D29E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D2C1	proc near		; DATA XREF: .rdata:1002C018o

arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 12h
		setz	al
		retn	8
sub_1000D2C1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D2CC(int, HANDLE hSourceHandle,	int, int, int)
sub_1000D2CC	proc near		; DATA XREF: .rdata:1002C010o

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
TargetHandle	= dword	ptr -0BCh
var_B8		= word ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= word ptr -0A4h
var_A0		= dword	ptr -0A0h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
hSourceHandle	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0C8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0C8h+var_4], eax
		cmp	dword_10031F64,	0
		push	ebx
		push	ebp
		mov	ebp, [esp+0D0h+hSourceHandle]
		push	esi
		mov	esi, [esp+0D4h+arg_0]
		push	edi
		mov	[esp+0D8h+var_C0], ecx
		jnz	short loc_1000D30E
		mov	edx, offset dword_10031F64
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_1001881C

loc_1000D30E:				; CODE XREF: sub_1000D2CC+31j
		mov	edi, [esp+0D8h+arg_10]
		xor	ebx, ebx
		mov	eax, edi
		or	eax, 2
		push	eax		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		lea	eax, [esp+0E4h+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	ebp		; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000D34B
		call	ds:GetLastError
		mov	[esi+10h], eax
		xor	al, al
		jmp	loc_1000D40B
; ---------------------------------------------------------------------------

loc_1000D34B:				; CODE XREF: sub_1000D2CC+6Dj
		push	[esp+0D8h+TargetHandle]
		lea	ecx, [esp+0DCh+var_C8]
		mov	[esp+0DCh+var_C8], ebx
		and	edi, 0FFFFFFFEh
		call	sub_100045FD
		lea	eax, [esp+0D8h+var_C4]
		mov	ecx, 9Eh
		push	eax
		push	ecx
		lea	eax, [esp+0E0h+var_A4]
		mov	[esp+0E0h+var_C4], ecx
		push	eax
		push	2
		pop	ebp
		push	ebp
		push	[esp+0E8h+var_C8]
		call	dword_10031F64
		test	eax, eax
		js	short loc_1000D3FD
		movzx	ecx, [esp+0D8h+var_A4]
		xor	edx, edx
		mov	eax, [esp+0D8h+var_A0]
		shr	ecx, 1
		mov	dword ptr [esp+0D8h+var_B8], ebp
		mov	[eax+ecx*2], dx
		inc	edx
		lea	eax, [esp+0D8h+var_B4]
		mov	ecx, edx

loc_1000D3A1:				; CODE XREF: sub_1000D2CC+DEj
		dec	ecx
		mov	[eax], ebx
		mov	[eax+4], ebx
		lea	eax, [eax+8]
		jns	short loc_1000D3A1
		mov	ecx, [esp+0D8h+var_C0]
		lea	eax, [esp+0D8h+var_A0]
		mov	[esp+0D8h+var_B0], eax
		lea	eax, [esp+0D8h+arg_8]
		mov	[esp+0D8h+var_A8], eax
		lea	eax, [esp+0D8h+var_B8]
		push	eax
		mov	ecx, [ecx+10h]
		push	12h
		mov	[esp+0E0h+var_B4], edx
		mov	[esp+0E0h+var_AC], ebp
		call	sub_10015057
		mov	edx, [esp+0D8h+var_C8]
		mov	ecx, eax
		push	edi
		push	[esp+0DCh+arg_C]
		lea	eax, [esi+18h]
		push	eax
		push	[esp+0E4h+arg_8]
		call	sub_1000D6C3
		add	esp, 10h
		mov	bl, 1

loc_1000D3FD:				; CODE XREF: sub_1000D2CC+B7j
		lea	ecx, [esp+0D8h+var_C8]
		mov	[esi+10h], eax
		call	sub_10004633
		mov	al, bl

loc_1000D40B:				; CODE XREF: sub_1000D2CC+7Aj
		mov	ecx, [esp+0D8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C8h
		retn	14h
sub_1000D2CC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D426	proc near		; CODE XREF: sub_10017ED8+12p

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Dst		= byte ptr -30h
dwErrCode	= dword	ptr -2Ch
var_24		= dword	ptr -24h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 48h
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[esp+50h+var_44], edx
		mov	[esp+50h+var_3C], edi
		mov	[esp+50h+var_40], ecx
		mov	[esi], edi
		call	sub_10013DD2
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000D454
		push	4
		pop	eax
		jmp	short loc_1000D4D1
; ---------------------------------------------------------------------------

loc_1000D454:				; CODE XREF: sub_1000D426+27j
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	[esp+50h+var_3C], ecx
		push	30h		; Size
		mov	[esp+54h+var_38], eax
		lea	eax, [esp+54h+Dst]
		push	edi		; Val
		push	eax		; Dst
		mov	[esp+5Ch+var_34], edi
		call	memset
		lea	eax, [esp+5Ch+var_34]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; void *
		lea	eax, [esp+68h+var_44]
		push	eax		; void *
		lea	eax, [esp+6Ch+var_40]
		push	eax		; int
		lea	ecx, [esp+70h+var_3C]
		call	sub_1000D4D7
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1000D4D1
		cmp	[esp+50h+dwErrCode], edi
		jz	short loc_1000D4BD
		push	[esp+50h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		push	2
		xor	edx, edx
		mov	ecx, offset aDuplicatehandl ; "DuplicateHandle"
		call	sub_100029CB
		xor	eax, eax
		pop	ecx
		inc	eax
		jmp	short loc_1000D4D1
; ---------------------------------------------------------------------------

loc_1000D4BD:				; CODE XREF: sub_1000D426+77j
		mov	eax, [esp+50h+var_24]
		xor	edx, edx
		mov	ecx, offset aDuplicatehandl ; "DuplicateHandle"
		mov	[esi], eax
		call	sub_10002ACE
		xor	eax, eax

loc_1000D4D1:				; CODE XREF: sub_1000D426+2Cj
					; sub_1000D426+71j ...
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D426	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000D4D7(int,	void *,	void *,	void *,	int)
sub_1000D4D7	proc near		; CODE XREF: sub_1000D426+67p

Src		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159B0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000D4EF
		push	4
		pop	eax
		jmp	loc_1000D591
; ---------------------------------------------------------------------------

loc_1000D4EF:				; CODE XREF: sub_1000D4D7+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+Src]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 12h
		push	ebp		; char
		push	ebx		; Size
		mov	[esi+4], ebp
		mov	[esi+3Ch], ebx
		push	ecx		; Src
		mov	dword ptr [esi+44h], 7Ch
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+Src], eax
		call	sub_1000D595
		test	al, al
		jz	short loc_1000D58D
		push	2		; int
		push	ebp		; char
		push	ebx		; Size
		push	[esp+20h+arg_4]	; Src
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1000D58D
		push	2		; int
		push	0		; char
		push	ebx		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, esi
		push	2		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1000D58D
		push	2		; int
		push	0		; char
		push	ebx		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, esi
		push	3		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1000D58D
		push	[esp+14h+arg_10]
		mov	ecx, edi
		push	esi
		call	sub_10015A29
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1000D58D
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000D58D:				; CODE XREF: sub_1000D4D7+4Ej
					; sub_1000D4D7+63j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_1000D591:				; CODE XREF: sub_1000D4D7+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_1000D4D7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000D595(int, void *Src, size_t Size, char,	int)
sub_1000D595	proc near		; CODE XREF: sub_1000D4D7+47p
					; sub_1000D4D7+5Cp ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DDD8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 4
		jnb	loc_1000D63B
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000D63B
		test	esi, esi
		jz	short loc_1000D5C5
		cmp	[ebp+Src], 0
		jz	short loc_1000D63B

loc_1000D5C5:				; CODE XREF: sub_1000D595+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000D63B
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000D63B
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000D606
		mov	dword ptr [edi+4], 1

loc_1000D606:				; CODE XREF: sub_1000D595+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000D63D
; ---------------------------------------------------------------------------

loc_1000D62D:				; DATA XREF: .rdata:stru_1002DDD8o
		xor	eax, eax	; Exception filter 0 for function 1000D595
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000D631:				; DATA XREF: .rdata:stru_1002DDD8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000D595
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000D63B:				; CODE XREF: sub_1000D595+14j
					; sub_1000D595+20j ...
		xor	al, al

loc_1000D63D:				; CODE XREF: sub_1000D595+96j
		call	__SEH_epilog4
		retn	14h
sub_1000D595	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D645	proc near		; CODE XREF: sub_1001525E+B7p

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F976
		sub	esi, 4
		jz	short loc_1000D673
		dec	esi
		jnz	short loc_1000D6B0
		push	esi
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	esi
		jmp	short loc_1000D681
; ---------------------------------------------------------------------------

loc_1000D673:				; CODE XREF: sub_1000D645+1Aj
		push	0
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	ebx

loc_1000D681:				; CODE XREF: sub_1000D645+2Cj
		lea	ecx, [ebp+var_14]
		call	sub_1000FC65
		test	al, al
		jz	short loc_1000D6B0
		push	ebx
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1000D6B0
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	12h
		call	sub_1000F6D9
		test	al, al
		jnz	short loc_1000D6B2

loc_1000D6B0:				; CODE XREF: sub_1000D645+1Dj
					; sub_1000D645+46j ...
		xor	bl, bl

loc_1000D6B2:				; CODE XREF: sub_1000D645+69j
		lea	ecx, [ebp+var_14]
		call	sub_1000FD8D
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D645	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D6C3	proc near		; CODE XREF: sub_1000D2CC+127p

hTargetProcessHandle= dword ptr	-4
dwProcessId	= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch
dwDesiredAccess	= dword	ptr  10h
dwOptions	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, edx
		cmp	ecx, 3
		jz	short loc_1000D6D7
		push	5
		pop	eax
		jmp	loc_1000D765
; ---------------------------------------------------------------------------

loc_1000D6D7:				; CODE XREF: sub_1000D6C3+Aj
		push	esi
		xor	esi, esi
		mov	[ebp+hTargetProcessHandle], esi
		call	ds:GetCurrentProcessId
		cmp	[ebp+dwProcessId], eax
		jz	short loc_1000D723
		push	[ebp+dwProcessId]
		call	sub_1000D76A
		mov	ecx, eax
		call	sub_100089DC
		test	al, al
		jnz	short loc_1000D700
		push	5
		pop	esi
		jmp	short loc_1000D75A
; ---------------------------------------------------------------------------

loc_1000D700:				; CODE XREF: sub_1000D6C3+36j
		push	[ebp+dwProcessId] ; dwProcessId
		push	esi		; bInheritHandle
		push	40h		; dwDesiredAccess
		call	ds:OpenProcess
		push	eax
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_100045FD
		mov	eax, [ebp+hTargetProcessHandle]
		test	eax, eax
		jz	short loc_1000D752
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D726
		jmp	short loc_1000D752
; ---------------------------------------------------------------------------

loc_1000D723:				; CODE XREF: sub_1000D6C3+23j
		mov	eax, [ebp+hTargetProcessHandle]

loc_1000D726:				; CODE XREF: sub_1000D6C3+5Cj
		test	eax, eax
		jz	short loc_1000D72F
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D735

loc_1000D72F:				; CODE XREF: sub_1000D6C3+65j
		call	ds:GetCurrentProcess

loc_1000D735:				; CODE XREF: sub_1000D6C3+6Aj
		push	[ebp+dwOptions]	; dwOptions
		push	esi		; bInheritHandle
		push	[ebp+dwDesiredAccess] ;	dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	eax		; hTargetProcessHandle
		push	ebx		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000D75A

loc_1000D752:				; CODE XREF: sub_1000D6C3+57j
					; sub_1000D6C3+5Ej
		call	ds:GetLastError
		mov	esi, eax

loc_1000D75A:				; CODE XREF: sub_1000D6C3+3Bj
					; sub_1000D6C3+8Dj
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_10004633
		mov	eax, esi
		pop	esi

loc_1000D765:				; CODE XREF: sub_1000D6C3+Fj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D6C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D76A	proc near		; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+22p
					; sub_1000D6C3+28p ...
		mov	eax, dword_10031F68
		test	eax, eax
		jnz	short locret_1000D7A5
		push	4Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000D78E
		mov	ecx, eax
		call	sub_10007F31
		mov	dword_10031F68,	eax
		jmp	short loc_1000D795
; ---------------------------------------------------------------------------

loc_1000D78E:				; CODE XREF: sub_1000D76A+14j
		and	dword_10031F68,	0

loc_1000D795:				; CODE XREF: sub_1000D76A+22j
		push	offset Func	; Func
		call	sub_10018D8D
		mov	eax, dword_10031F68
		pop	ecx

locret_1000D7A5:			; CODE XREF: sub_1000D76A+7j
		retn
; ---------------------------------------------------------------------------

; int __cdecl Func()
Func:					; DATA XREF: sub_1000D76A:loc_1000D795o
		push	esi
		call	sub_1000D76A
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000D7C1
		mov	ecx, esi
		call	sub_10008051
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D7C1:				; CODE XREF: sub_1000D76A+46j
		xor	eax, eax
		pop	esi
		retn
sub_1000D76A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D7C5	proc near		; DATA XREF: .rdata:off_1002C030o
					; .rdata:off_1002C048o	...

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C030
		jz	short loc_1000D7DD
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D7DD:				; CODE XREF: sub_1000D7C5+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_1000D7C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D7E3	proc near		; CODE XREF: sub_1000DE70+8Ep

var_B8		= byte ptr -0B8h
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, 10000h
		mov	[ebp+var_8], esi
		cmp	esi, edi
		jbe	short loc_1000D82C
		push	offset aSizeKallocgran ; "size <= kAllocGranularity"
		mov	edx, offset dword_1001AB2C
		lea	ecx, [ebp+var_8]
		call	sub_10003248
		pop	ecx
		test	eax, eax
		jz	short loc_1000D82C
		push	eax
		push	ecx
		push	ecx
		lea	ecx, [ebp+var_B8]
		call	sub_10001B7E
		lea	ecx, [ebp+var_B8]
		call	sub_10001BD6

loc_1000D82C:				; CODE XREF: sub_1000D7E3+17j
					; sub_1000D7E3+2Ej
		sub	edi, esi

loc_1000D82E:				; CODE XREF: sub_1000D7E3+64j
		lea	eax, [ebp+var_4]
		push	eax
		call	ds:rand_s
		pop	ecx
		mov	ecx, [ebp+var_4]
		and	ecx, 0FFFFh
		mov	[ebp+var_4], ecx
		cmp	ecx, edi
		ja	short loc_1000D82E
		mov	eax, 800h
		mov	edx, 1000h
		cmp	esi, eax
		ja	short loc_1000D85F

loc_1000D857:				; CODE XREF: sub_1000D7E3+7Aj
		mov	edx, eax
		shr	eax, 1
		cmp	eax, esi
		jnb	short loc_1000D857

loc_1000D85F:				; CODE XREF: sub_1000D7E3+72j
		lea	eax, [edx-1]
		not	eax
		pop	edi
		and	eax, ecx
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D7E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D86C	proc near		; CODE XREF: sub_1000D8BF+24p
					; sub_1001510E+ABp
		mov	dword ptr [ecx+1Ch], 7
		xor	edx, edx
		mov	[ecx+18h], edx
		xor	eax, eax
		mov	[ecx+8], ax
		push	0Fh
		pop	eax
		mov	[ecx+34h], eax
		mov	[ecx+30h], edx
		mov	[ecx+20h], dl
		mov	[ecx+4Ch], eax
		mov	eax, ecx
		mov	[ecx+48h], edx
		mov	[ecx+38h], dl
		retn
sub_1000D86C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D896	proc near		; CODE XREF: sub_1000D8BF+8Bp
					; sub_1000DA8C+1AFp ...
		push	esi
		mov	esi, ecx
		push	0		; Size
		push	1		; char
		lea	ecx, [esi+38h]
		call	sub_10001883
		push	0		; Size
		push	1		; char
		lea	ecx, [esi+20h]
		call	sub_10001883
		push	0
		push	1
		lea	ecx, [esi+8]
		call	sub_100022FA
		pop	esi
		retn
sub_1000D896	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D8BF(void *, void *Src,	int, void *, int)
sub_1000D8BF	proc near		; CODE XREF: sub_10009C20+A2p
					; sub_1000DE70+4Bp ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
Dst		= byte ptr -38h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		push	ebx
		mov	ebx, [esp+5Ch+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+64h+arg_0]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+68h+Src]
		lea	ecx, [esp+68h+var_58]
		call	sub_1000D86C
		mov	eax, [esp+68h+arg_8]
		mov	ecx, esi
		mov	[esp+68h+var_58], eax
		mov	eax, [esp+68h+arg_10]
		mov	[esp+68h+var_54], eax
		call	sub_10001ADC
		push	eax		; int
		push	esi		; Src
		lea	ecx, [esp+70h+var_50] ;	Dst
		call	sub_1000233F
		mov	ecx, edi
		call	sub_100010C6
		push	eax		; Size
		push	edi		; Src
		lea	ecx, [esp+70h+Dst] ; Dst
		call	sub_100018C4
		mov	ecx, ebx
		call	sub_100010C6
		push	eax		; Size
		push	ebx		; Src
		lea	ecx, [esp+70h+var_20] ;	Dst
		call	sub_100018C4
		and	[esp+68h+var_8], 0
		lea	eax, [esp+68h+var_58]
		lea	ecx, [ebp+4]
		push	eax
		push	dword ptr [ecx]
		call	sub_1000E428
		lea	ecx, [esp+68h+var_58]
		mov	byte ptr [ebp+0Ch], 1
		call	sub_1000D896
		mov	ecx, [esp+68h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn	14h
sub_1000D8BF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D966	proc near		; CODE XREF: sub_1001510E+117p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+8], 0
		jnz	short loc_1000D979
		mov	al, 1
		jmp	short loc_1000D9F0
; ---------------------------------------------------------------------------

loc_1000D979:				; CODE XREF: sub_1000D966+Dj
		call	sub_1000D9F7
		mov	ebx, eax
		push	ebx
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebx
		push	esi
		call	sub_1000DA8C
		test	al, al
		jz	short loc_1000D9E0
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		push	ebx		; dwSize
		push	esi		; lpBuffer
		call	sub_1000DD86
		test	al, al
		jz	short loc_1000D9E0
		test	ebx, ebx
		mov	ecx, edi
		setnz	al
		movzx	eax, al
		push	eax
		call	sub_1000DE70
		test	al, al
		jz	short loc_1000D9E0
		mov	eax, [ebp+var_4]
		push	4		; nSize
		push	offset g_interceptions ; lpBuffer
		mov	g_interceptions, eax
		mov	ecx, [edi]
		push	offset aG_intercepti_0 ; "g_interceptions"
		call	sub_10017AC0
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000D9E2
; ---------------------------------------------------------------------------

loc_1000D9E0:				; CODE XREF: sub_1000D966+2Ej
					; sub_1000D966+3Fj ...
		xor	bl, bl

loc_1000D9E2:				; CODE XREF: sub_1000D966+78j
		test	esi, esi
		jz	short loc_1000D9EE
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1000D9EE:				; CODE XREF: sub_1000D966+7Ej
		mov	al, bl

loc_1000D9F0:				; CODE XREF: sub_1000D966+11j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D966	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D9F7	proc near		; CODE XREF: sub_1000D966:loc_1000D979p

var_14		= byte ptr -14h
var_C		= byte ptr -0Ch

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	ecx
		mov	ebx, ecx
		push	ecx
		lea	ecx, [esp+2Ch+var_14]
		call	sub_1000C310
		mov	eax, [ebx+4]
		xor	edi, edi
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_1000DA79

loc_1000DA16:				; CODE XREF: sub_1000D9F7+79j
		lea	eax, [esi+8]
		push	eax
		call	sub_1000DDF9
		test	al, al
		jz	short loc_1000DA6B
		lea	ebp, [esi+10h]
		push	ebp
		lea	ecx, [esp+28h+var_14]
		call	sub_1000CC70
		test	eax, eax
		jnz	short loc_1000DA5C
		mov	eax, [esi+20h]
		lea	eax, ds:13h[eax*2]
		shr	eax, 2
		lea	edi, [edi+eax*4]
		movzx	eax, byte_10031F2B
		push	eax
		push	ebp
		push	ecx
		lea	eax, [esp+30h+var_C]
		push	eax
		lea	ecx, [esp+34h+var_14]
		call	sub_1000C439

loc_1000DA5C:				; CODE XREF: sub_1000D9F7+3Bj
		mov	eax, [esi+38h]
		add	eax, 15h
		add	eax, [esi+50h]
		shr	eax, 2
		lea	edi, [edi+eax*4]

loc_1000DA6B:				; CODE XREF: sub_1000D9F7+2Aj
		mov	esi, [esi]
		cmp	esi, [ebx+4]
		jnz	short loc_1000DA16
		test	edi, edi
		jz	short loc_1000DA79
		add	edi, 8

loc_1000DA79:				; CODE XREF: sub_1000D9F7+1Dj
					; sub_1000D9F7+7Dj
		lea	ecx, [esp+24h+var_14]
		call	sub_1000C24A
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1000D9F7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000DA8C	proc near		; CODE XREF: sub_1000D966+27p

var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= byte ptr -234h
var_184		= byte ptr -184h
var_D4		= byte ptr -0D4h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 254h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+254h+var_8], eax
		mov	edx, [esp+254h+arg_0]
		push	ebx
		push	ebp
		xor	ebx, ebx
		mov	[esp+25Ch+var_24C], ecx
		mov	[esp+25Ch+var_244], ebx
		mov	ebp, [esp+25Ch+arg_4]
		mov	[esp+25Ch+var_238], edx
		push	esi
		push	edi
		test	ebp, ebp
		jz	loc_1000DCA0
		and	[esp+264h+var_248], ebx
		lea	esi, [edx+8]
		mov	[esp+264h+var_240], esi
		cmp	[ecx+0Ch], bl
		jz	short loc_1000DADF
		mov	eax, [ecx]
		mov	eax, [eax+28h]
		jmp	short loc_1000DAE1
; ---------------------------------------------------------------------------

loc_1000DADF:				; CODE XREF: sub_1000DA8C+4Aj
		xor	eax, eax

loc_1000DAE1:				; CODE XREF: sub_1000DA8C+51j
		mov	[edx+4], eax
		sub	ebp, 8
		mov	eax, [ecx+4]
		mov	edi, [eax]
		cmp	edi, eax
		jz	loc_1000DC9A

loc_1000DAF4:				; CODE XREF: sub_1000DA8C+204j
		lea	ecx, [edi+8]
		push	ecx
		call	sub_1000DDF9
		test	al, al
		jnz	short loc_1000DB08
		mov	edi, [edi]
		jmp	loc_1000DC89
; ---------------------------------------------------------------------------

loc_1000DB08:				; CODE XREF: sub_1000DA8C+73j
		lea	eax, [edi+10h]
		push	eax
		lea	ecx, [esp+268h+var_20]
		call	sub_1000388D
		test	bl, 2
		jz	short loc_1000DB29
		lea	ecx, [esp+264h+var_234]
		and	ebx, 0FFFFFFFDh
		call	sub_10001BD6

loc_1000DB29:				; CODE XREF: sub_1000DA8C+8Fj
		test	bl, 4
		jz	short loc_1000DB3D
		lea	ecx, [esp+264h+var_D4]
		and	ebx, 0FFFFFFFBh
		call	sub_10001BD6

loc_1000DB3D:				; CODE XREF: sub_1000DA8C+A0j
		test	bl, 8
		jz	short loc_1000DB51
		lea	ecx, [esp+264h+var_184]
		and	ebx, 0FFFFFFF7h
		call	sub_10001BD6

loc_1000DB51:				; CODE XREF: sub_1000DA8C+B4j
		mov	eax, [edi+20h]
		mov	[esp+264h+var_250], esi
		lea	ecx, ds:13h[eax*2]
		and	ecx, 0FFFFFFFCh
		cmp	ebp, ecx
		jb	loc_1000DCBD
		add	esi, ecx
		sub	ebp, ecx
		cmp	dword ptr [edi+8], 5
		mov	[esp+264h+var_244], esi
		mov	[esp+264h+var_23C], esi
		setz	al
		mov	esi, [esp+264h+var_250]
		push	ecx
		mov	[esp+268h+arg_4], ebp
		and	dword ptr [esi+8], 0
		mov	[esi+0Ch], al
		lea	eax, [esi+0Eh]
		mov	[esi], ecx
		mov	[esi+4], ecx
		lea	ecx, [edi+10h]
		push	dword ptr [edi+20h]
		push	dword ptr [edi+20h]
		push	eax
		call	sub_1000C16A
		mov	eax, [edi+20h]
		xor	ecx, ecx
		mov	[esi+eax*2+0Eh], cx
		mov	esi, edi
		mov	eax, [esp+264h+var_24C]
		mov	[esp+264h+var_250], esi
		cmp	edi, [eax+4]
		jz	loc_1000DC6D
		mov	ebp, eax

loc_1000DBC6:				; CODE XREF: sub_1000DA8C+1CEj
		cmp	[esp+264h+var_C], 8
		lea	ecx, [esi+10h]
		mov	eax, [esp+264h+var_20]
		jnb	short loc_1000DBE1
		lea	eax, [esp+264h+var_20]

loc_1000DBE1:				; CODE XREF: sub_1000DA8C+14Cj
		push	[esp+264h+var_10]
		push	eax
		push	dword ptr [ecx+10h]
		push	0
		call	sub_10003F01
		test	eax, eax
		jnz	short loc_1000DC51
		push	[esp+264h+var_240] ; int
		lea	eax, [esp+268h+arg_4]
		push	eax		; int
		lea	eax, [esp+26Ch+var_23C]
		push	eax		; int
		lea	ebp, [esi+8]
		push	ebp		; DstSize
		call	sub_1000DCD1
		test	al, al
		jz	loc_1000DCBD
		cmp	edi, esi
		jnz	short loc_1000DC1F
		mov	edi, [edi]

loc_1000DC1F:				; CODE XREF: sub_1000DA8C+18Fj
		mov	eax, [esp+264h+var_250]
		mov	ecx, ebp
		mov	esi, [esi]
		mov	edx, [eax+4]
		mov	[edx], esi
		mov	edx, [eax]
		mov	eax, [eax+4]
		mov	[edx+4], eax
		mov	eax, [esp+264h+var_24C]
		dec	dword ptr [eax+8]
		call	sub_1000D896
		push	[esp+264h+var_250]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	ebp, [esp+268h+var_24C]
		pop	ecx
		jmp	short loc_1000DC53
; ---------------------------------------------------------------------------

loc_1000DC51:				; CODE XREF: sub_1000DA8C+169j
		mov	esi, [esi]

loc_1000DC53:				; CODE XREF: sub_1000DA8C+1C3j
		mov	[esp+264h+var_250], esi
		cmp	esi, [ebp+4]
		jnz	loc_1000DBC6
		mov	ebp, [esp+264h+arg_4]
		mov	esi, [esp+264h+var_23C]
		jmp	short loc_1000DC71
; ---------------------------------------------------------------------------

loc_1000DC6D:				; CODE XREF: sub_1000DA8C+132j
		mov	esi, [esp+264h+var_244]

loc_1000DC71:				; CODE XREF: sub_1000DA8C+1DFj
		inc	[esp+264h+var_248]
		lea	ecx, [esp+264h+var_20]
		push	0
		push	1
		mov	[esp+26Ch+var_240], esi
		call	sub_100022FA

loc_1000DC89:				; CODE XREF: sub_1000DA8C+77j
		mov	eax, [esp+264h+var_24C]
		cmp	edi, [eax+4]
		jnz	loc_1000DAF4
		mov	edx, [esp+264h+var_238]

loc_1000DC9A:				; CODE XREF: sub_1000DA8C+62j
		mov	ecx, [esp+264h+var_248]
		mov	[edx], ecx

loc_1000DCA0:				; CODE XREF: sub_1000DA8C+36j
		mov	al, 1

loc_1000DCA2:				; CODE XREF: sub_1000DA8C+243j
		mov	ecx, [esp+264h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 254h
		retn	8
; ---------------------------------------------------------------------------

loc_1000DCBD:				; CODE XREF: sub_1000DA8C+D8j
					; sub_1000DA8C+187j
		push	0
		push	1
		lea	ecx, [esp+26Ch+var_20]
		call	sub_100022FA
		xor	al, al
		jmp	short loc_1000DCA2
sub_1000DA8C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DCD1(rsize_t DstSize, int, int,	int)
sub_1000DCD1	proc near		; CODE XREF: sub_1000DA8C+180p

var_4		= dword	ptr -4
DstSize		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		and	[esp+4+var_4], 0
		push	ebx
		mov	ebx, [esp+8+DstSize]
		push	ebp
		mov	ebp, [esp+0Ch+arg_C]
		push	esi
		push	edi
		cmp	byte ptr [ebp+0Ch], 0
		jz	short loc_1000DCFB
		push	1		; int
		lea	ecx, [ebx+20h]	; Buf1
		push	offset a@	; "@"
		push	dword ptr [ecx+10h] ; Size
		push	ecx		; int
		call	sub_10003975

loc_1000DCFB:				; CODE XREF: sub_1000DCD1+15j
		mov	eax, [ebx+48h]
		mov	ecx, [ebx+30h]
		mov	edx, [esp+14h+arg_4]
		mov	[esp+14h+DstSize], eax
		lea	edi, [eax+15h]
		mov	[esp+14h+arg_4], ecx
		mov	eax, [esp+14h+arg_8]
		add	edi, ecx
		mov	esi, [edx]
		and	edi, 0FFFFFFFCh
		mov	eax, [eax]
		cmp	eax, edi
		jnb	short loc_1000DD25
		xor	al, al
		jmp	short loc_1000DD7E
; ---------------------------------------------------------------------------

loc_1000DD25:				; CODE XREF: sub_1000DCD1+4Ej
		mov	ebp, [esp+14h+arg_8]
		sub	eax, edi
		push	ecx		; int
		push	ecx		; MaxCount
		push	ecx		; DstSize
		mov	[ebp+0], eax
		lea	ecx, [ebx+20h]	; Src
		add	[edx], edi
		mov	[esi], edi
		mov	eax, [ebx]
		mov	[esi+4], eax
		mov	eax, [ebx+4]
		mov	[esi+8], eax
		mov	eax, [ebx+50h]
		mov	[esi+0Ch], eax
		add	esi, 10h
		push	esi		; Dst
		call	sub_1000E386
		add	esi, [esp+14h+arg_4]
		mov	eax, [esp+14h+DstSize]
		push	ecx		; int
		push	eax		; MaxCount
		mov	byte ptr [esi],	0
		lea	ecx, [ebx+38h]	; Src
		push	eax		; DstSize
		inc	esi
		push	esi		; Dst
		call	sub_1000E386
		mov	ecx, [esp+14h+DstSize]
		mov	al, 1
		mov	ebp, [esp+14h+arg_C]
		mov	byte ptr [esi+ecx], 0
		inc	dword ptr [ebp+8]
		add	[ebp+0], edi

loc_1000DD7E:				; CODE XREF: sub_1000DCD1+52j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000DCD1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DD86(LPCVOID lpBuffer, SIZE_T dwSize, int)
sub_1000DD86	proc near		; CODE XREF: sub_1000D966+38p

var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
dwSize		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+dwSize]
		xor	ebp, ebp
		mov	[esp+10h+var_4], ebp
		push	edi
		test	esi, esi
		jnz	short loc_1000DDA3
		mov	eax, [esp+14h+arg_8]
		mov	[eax], ebp

loc_1000DD9F:				; CODE XREF: sub_1000DD86+59j
		mov	al, 1
		jmp	short loc_1000DDF1
; ---------------------------------------------------------------------------

loc_1000DDA3:				; CODE XREF: sub_1000DD86+11j
		mov	eax, [ecx]
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	esi		; dwSize
		mov	ebx, [eax]
		push	ebp		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000DDEF
		lea	eax, [esp+14h+dwSize]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000DDE1
		cmp	[esp+14h+dwSize], esi
		jnz	short loc_1000DDE1
		mov	eax, [esp+14h+arg_8]
		mov	[eax], edi
		jmp	short loc_1000DD9F
; ---------------------------------------------------------------------------

loc_1000DDE1:				; CODE XREF: sub_1000DD86+4Bj
					; sub_1000DD86+51j
		push	8000h		; dwFreeType
		push	ebp		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000DDEF:				; CODE XREF: sub_1000DD86+35j
		xor	al, al

loc_1000DDF1:				; CODE XREF: sub_1000DD86+1Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	0Ch
sub_1000DD86	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000DDF9	proc near		; CODE XREF: sub_1000D9F7+23p
					; sub_1000DA8C+6Cp

Dst		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_1000DE17

loc_1000DE13:				; CODE XREF: sub_1000DDF9+21j
					; sub_1000DDF9+26j
		xor	al, al
		jmp	short loc_1000DE5E
; ---------------------------------------------------------------------------

loc_1000DE17:				; CODE XREF: sub_1000DDF9+18j
		cmp	dword ptr [esi], 1
		jz	short loc_1000DE13
		cmp	dword ptr [esi], 6
		jge	short loc_1000DE13
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_10001C68
		lea	eax, [esi+8]
		cmp	dword ptr [eax+14h], 8
		mov	ecx, [eax+10h]
		jb	short loc_1000DE3C
		mov	eax, [eax]

loc_1000DE3C:				; CODE XREF: sub_1000DDF9+3Fj
		push	ecx
		push	eax
		push	[ebp+var_10]
		lea	ecx, [ebp+Dst]
		push	0
		call	sub_10003F01
		test	eax, eax
		lea	ecx, [ebp+Dst]
		push	0
		push	1
		setnz	bl
		call	sub_100022FA
		mov	al, bl

loc_1000DE5E:				; CODE XREF: sub_1000DDF9+1Cj
		mov	ecx, [ebp+var_8]
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000DDF9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000DE70	proc near		; CODE XREF: sub_1000D966+4Cp

var_11C		= dword	ptr -11Ch
hProcess	= dword	ptr -118h
NumberOfBytesWritten= dword ptr	-114h
var_110		= dword	ptr -110h
flOldProtect	= dword	ptr -10Ch
var_108		= byte ptr -108h
Buffer		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  4

		sub	esp, 120h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+120h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		xor	ebp, ebp
		inc	edi
		mov	[esp+130h+var_11C], ebp
		cmp	[esp+130h+arg_0], 0
		mov	ebx, ecx
		jnz	short loc_1000DEA9
		cmp	[ebx+8], ebp
		jnz	short loc_1000DED4
		mov	al, 1
		jmp	loc_1000E002
; ---------------------------------------------------------------------------

loc_1000DEA9:				; CODE XREF: sub_1000DE70+2Bj
		push	ebp		; int
		push	offset a_targetntmap_0 ; "_TargetNtMapViewOfSection@44"
		push	edi		; int
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		mov	esi, offset aNtdll_dll_0 ; "ntdll.dll"
		push	esi		; void *
		call	sub_1000D8BF
		push	edi		; int
		push	offset a_targetntunm_0 ; "_TargetNtUnmapViewOfSection@12"
		push	edi		; int
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		push	esi		; void *
		mov	ecx, ebx
		call	sub_1000D8BF

loc_1000DED4:				; CODE XREF: sub_1000DE70+30j
		mov	eax, [ebx]
		push	edi		; flProtect
		mov	edi, ds:VirtualAllocEx
		push	2000h		; flAllocationType
		mov	eax, [eax]
		push	10000h		; dwSize
		push	ebp		; lpAddress
		push	eax		; hProcess
		mov	[esp+144h+hProcess], eax
		call	edi ; VirtualAllocEx
		mov	ebp, [ebx+8]
		mov	esi, eax
		shl	ebp, 6
		add	ebp, 50h
		mov	ecx, ebp
		call	sub_1000D7E3
		mov	ecx, eax
		mov	edx, 0FFFFF000h
		and	ecx, edx
		and	eax, 0FFFh
		add	esi, ecx
		mov	[esp+130h+var_110], eax
		push	40h		; flProtect
		push	1000h		; flAllocationType
		lea	ecx, [ebp+0FFFh]
		and	ecx, edx
		push	ecx		; dwSize
		push	esi		; lpAddress
		push	[esp+140h+hProcess] ; hProcess
		call	edi ; VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000DF5E
		push	3
		push	195h
		push	offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+13Ch+var_108]
		mov	[esp+13Ch+var_11C], 1
		call	sub_10001B31
		mov	edx, offset aCheckFailedThu ; "Check failed: thunk_base. "
		lea	ecx, [eax+8]
		call	sub_10002830

loc_1000DF5E:				; CODE XREF: sub_1000DE70+C2j
		test	byte ptr [esp+130h+var_11C], 1
		jz	short loc_1000DF6E
		lea	ecx, [esp+130h+var_108]
		call	sub_10001BD6

loc_1000DF6E:				; CODE XREF: sub_1000DE70+F3j
		add	esi, [esp+130h+var_110]
		and	[esp+130h+var_4C], 0
		push	10h
		pop	edi
		push	64h		; Size
		push	0		; Val
		push	offset g_originals ; Dst
		mov	[esp+13Ch+Buffer], ebp
		mov	[esp+13Ch+var_54], edi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+130h+Buffer]
		mov	ecx, ebx
		push	eax
		push	ebp
		push	esi
		call	sub_1000E01D
		test	al, al
		jz	short loc_1000E000
		lea	eax, [esp+130h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		mov	edi, [esp+138h+hProcess]
		lea	eax, [esp+138h+Buffer]
		push	eax		; lpBuffer
		push	esi		; lpBaseAddress
		push	edi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000E000
		cmp	[esp+130h+NumberOfBytesWritten], 10h
		jnz	short loc_1000E000
		lea	eax, [esp+130h+flOldProtect]
		push	eax		; lpflOldProtect
		push	20h		; flNewProtect
		push	ebp		; dwSize
		push	esi		; lpAddress
		push	edi		; hProcess
		call	ds:VirtualProtectEx
		mov	ecx, [ebx]
		push	64h		; nSize
		push	offset g_originals ; lpBuffer
		push	offset aG_originals_0 ;	"g_originals"
		call	sub_10017AC0
		neg	eax
		sbb	eax, eax
		inc	eax
		jmp	short loc_1000E002
; ---------------------------------------------------------------------------

loc_1000E000:				; CODE XREF: sub_1000DE70+13Fj
					; sub_1000DE70+15Dj ...
		xor	al, al

loc_1000E002:				; CODE XREF: sub_1000DE70+34j
					; sub_1000DE70+18Ej
		mov	ecx, [esp+130h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 120h
		retn	4
sub_1000DE70	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E01D	proc near		; CODE XREF: sub_1000DE70+138p

var_FC		= dword	ptr -0FCh
phModule	= dword	ptr -0F8h
hLibModule	= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= byte ptr -0D0h
Dst		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 100h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+100h+var_4], eax
		mov	eax, [esp+100h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	[esp+110h+var_E4], eax
		mov	eax, [esp+110h+arg_8]
		xor	ebx, ebx
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		mov	[esp+114h+var_DC], ebp
		mov	[esp+114h+var_FC], eax
		mov	[esp+114h+var_F0], ebx
		call	ds:GetModuleHandleW
		mov	[esp+110h+phModule], eax
		test	eax, eax
		jnz	short loc_1000E071
		xor	al, al
		jmp	loc_1000E36B
; ---------------------------------------------------------------------------

loc_1000E071:				; CODE XREF: sub_1000E01D+4Bj
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [esp+114h+var_D8]
		mov	[esp+114h+var_D8], offset off_1001AA20
		mov	[esp+114h+var_D4], eax
		call	sub_1000578C
		test	eax, eax
		jz	short loc_1000E0A5
		lea	ecx, [esp+110h+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW
		test	eax, eax
		jz	loc_1000E369

loc_1000E0A5:				; CODE XREF: sub_1000E01D+70j
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jg	loc_1000E13D
		mov	eax, [ebp+0]
		lea	ecx, [esp+110h+Dst]
		mov	[esp+110h+Dst],	eax
		mov	eax, [esp+110h+phModule]
		mov	[esp+110h+var_18], eax
		mov	[esp+110h+hObject], ebx
		mov	[esp+110h+var_10], ebx
		call	sub_1000671B
		mov	esi, ds:CloseHandle
		test	al, al
		jnz	short loc_1000E119
		cmp	[esp+110h+hObject], ebx
		jz	short loc_1000E0FE
		push	[esp+110h+hObject] ; hObject
		call	esi ; CloseHandle

loc_1000E0FE:				; CODE XREF: sub_1000E01D+D6j
		cmp	[esp+110h+var_10], ebx
		jz	loc_1000E369
		push	[esp+110h+var_10] ; hObject
		call	esi ; CloseHandle
		jmp	loc_1000E369
; ---------------------------------------------------------------------------

loc_1000E119:				; CODE XREF: sub_1000E01D+CDj
		cmp	[esp+110h+hObject], ebx
		jz	short loc_1000E12B
		push	[esp+110h+hObject] ; hObject
		call	esi ; CloseHandle

loc_1000E12B:				; CODE XREF: sub_1000E01D+103j
		cmp	[esp+110h+var_10], ebx
		jz	short loc_1000E13D
		push	[esp+110h+var_10] ; hObject
		call	esi ; CloseHandle

loc_1000E13D:				; CODE XREF: sub_1000E01D+90j
					; sub_1000E01D+115j
		mov	eax, [ebp+0]
		mov	ecx, [eax+28h]
		push	dword ptr [eax+2Ch] ; lpLibFileName
		mov	[esp+114h+var_E8], ecx
		call	ds:LoadLibraryW
		mov	[esp+110h+hLibModule], eax
		call	sub_100063BF
		push	1Ch
		cmp	dword ptr [eax+28h], 1
		jnz	short loc_1000E1A0
		cmp	dword ptr [eax], 5
		jl	short loc_1000E183
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E1EB
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C070
		jmp	short loc_1000E1DD
; ---------------------------------------------------------------------------

loc_1000E183:				; CODE XREF: sub_1000E01D+147j
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E1EB
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C098
		jmp	short loc_1000E1DD
; ---------------------------------------------------------------------------

loc_1000E1A0:				; CODE XREF: sub_1000E01D+142j
		cmp	dword ptr [eax], 5
		jl	short loc_1000E1C2
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E1EB
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C0C0
		jmp	short loc_1000E1DD
; ---------------------------------------------------------------------------

loc_1000E1C2:				; CODE XREF: sub_1000E01D+186j
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E1EB
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C048

loc_1000E1DD:				; CODE XREF: sub_1000E01D+164j
					; sub_1000E01D+181j ...
		mov	[edi+18h], ebx
		mov	[edi+14h], cl
		mov	[edi+10h], eax
		mov	[edi+0Ch], ebx
		jmp	short loc_1000E1ED
; ---------------------------------------------------------------------------

loc_1000E1EB:				; CODE XREF: sub_1000E01D+154j
					; sub_1000E01D+171j ...
		mov	edi, ebx

loc_1000E1ED:				; CODE XREF: sub_1000E01D+1CCj
		mov	eax, [ebp+4]
		mov	esi, [eax]
		cmp	esi, eax
		jz	loc_1000E347

loc_1000E1FA:				; CODE XREF: sub_1000E01D+313j
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [esp+114h+Dst] ; Dst
		call	sub_10001C68
		cmp	[esp+110h+var_8], 8
		lea	ecx, [esi+10h]
		mov	eax, [esp+110h+Dst]
		jnb	short loc_1000E226
		lea	eax, [esp+110h+Dst]

loc_1000E226:				; CODE XREF: sub_1000E01D+200j
		push	[esp+110h+var_C]
		push	eax
		push	dword ptr [ecx+10h]
		push	ebx
		call	sub_10003F01
		test	eax, eax
		jnz	loc_1000E338
		cmp	dword ptr [esi+8], 1
		jnz	loc_1000E338
		cmp	[esi+58h], ebx
		jnz	short loc_1000E281
		lea	ecx, [esi+40h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E259
		mov	ecx, [ecx]

loc_1000E259:				; CODE XREF: sub_1000E01D+238j
		mov	eax, [edi]
		lea	edx, [esp+110h+var_E0]
		push	edx
		push	ecx
		push	[esp+118h+hLibModule]
		mov	ecx, edi
		call	dword ptr [eax+8]
		test	eax, eax
		js	loc_1000E338
		mov	eax, [esp+110h+var_E0]
		sub	eax, [esp+110h+hLibModule]
		add	eax, [esp+110h+var_E8]
		mov	[esi+58h], eax

loc_1000E281:				; CODE XREF: sub_1000E01D+22Fj
		lea	eax, [esi+40h]
		cmp	dword ptr [eax+14h], 10h
		mov	[esp+110h+var_EC], eax
		jb	short loc_1000E294
		mov	eax, [eax]
		mov	[esp+110h+var_EC], eax

loc_1000E294:				; CODE XREF: sub_1000E01D+26Fj
		lea	ecx, [esi+28h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E29F
		mov	ecx, [ecx]

loc_1000E29F:				; CODE XREF: sub_1000E01D+27Ej
		mov	ebp, [esp+110h+var_FC]
		mov	eax, [esp+110h+arg_4]
		mov	edx, [edi]
		push	ebx
		sub	eax, [ebp+4]
		push	eax
		mov	eax, ebp
		mov	ebp, [esp+118h+var_E4]
		add	ebp, 10h
		mov	eax, [eax+0Ch]
		shl	eax, 6
		add	eax, ebp
		push	eax
		push	dword ptr [esi+58h]
		push	[esp+120h+var_EC]
		push	ecx
		push	[esp+128h+var_E8]
		mov	ecx, edi
		push	[esp+12Ch+phModule]
		call	dword ptr [edx+4]
		mov	ebp, [esp+110h+var_DC]
		test	eax, eax
		js	short loc_1000E338
		mov	eax, [esp+110h+var_F0]
		test	al, 4
		jz	short loc_1000E2F8
		and	eax, 0FFFFFFFBh
		lea	ecx, [esp+110h+var_D0]
		mov	[esp+110h+var_F0], eax
		call	sub_10001BD6

loc_1000E2F8:				; CODE XREF: sub_1000E01D+2C9j
		mov	edx, [esp+110h+var_FC]
		mov	ecx, [esp+110h+var_E4]
		add	ecx, 10h
		push	ebx
		mov	eax, [edx+0Ch]
		shl	eax, 6
		add	ecx, eax
		mov	eax, [esi+0Ch]
		push	1
		mov	g_originals[eax*4], ecx
		lea	ecx, [esp+118h+Dst]
		inc	dword ptr [edx+0Ch]
		add	dword ptr [edx+4], 40h
		call	sub_100022FA
		mov	esi, [esi]
		cmp	esi, [ebp+4]
		jnz	loc_1000E1FA
		jmp	short loc_1000E347
; ---------------------------------------------------------------------------

loc_1000E338:				; CODE XREF: sub_1000E01D+21Cj
					; sub_1000E01D+226j ...
		push	ebx
		push	1
		lea	ecx, [esp+118h+Dst]
		call	sub_100022FA

loc_1000E347:				; CODE XREF: sub_1000E01D+1D7j
					; sub_1000E01D+319j
		test	edi, edi
		jz	short loc_1000E353
		mov	eax, [edi]
		mov	ecx, edi
		push	1
		call	dword ptr [eax]

loc_1000E353:				; CODE XREF: sub_1000E01D+32Cj
		mov	eax, [esp+110h+hLibModule]
		test	eax, eax
		jz	short loc_1000E362
		push	eax		; hLibModule
		call	ds:FreeLibrary

loc_1000E362:				; CODE XREF: sub_1000E01D+33Cj
		cmp	esi, [ebp+4]
		jnz	short loc_1000E369
		mov	bl, 1

loc_1000E369:				; CODE XREF: sub_1000E01D+82j
					; sub_1000E01D+E8j ...
		mov	al, bl

loc_1000E36B:				; CODE XREF: sub_1000E01D+4Fj
		mov	ecx, [esp+110h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 100h
		retn	0Ch
sub_1000E01D	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000E386(void *Src, void *Dst, rsize_t DstSize, rsize_t MaxCount, int)
sub_1000E386	proc near		; CODE XREF: sub_1000DCD1+7Cp
					; sub_1000DCD1+94p

Dst		= dword	ptr  4
DstSize		= dword	ptr  8
MaxCount	= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+MaxCount]
		cmp	[ecx+10h], esi
		jnb	short loc_1000E393
		mov	esi, [ecx+10h]

loc_1000E393:				; CODE XREF: sub_1000E386+8j
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E39B
		mov	ecx, [ecx]

loc_1000E39B:				; CODE XREF: sub_1000E386+11j
		test	esi, esi
		jz	short loc_1000E3B2
		push	esi		; MaxCount
		push	ecx		; Src
		push	[esp+0Ch+DstSize] ; DstSize
		push	[esp+10h+Dst]	; Dst
		call	ds:memcpy_s
		add	esp, 10h

loc_1000E3B2:				; CODE XREF: sub_1000E386+17j
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000E386	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E3B8	proc near		; CODE XREF: sub_1001510E+131p
		push	ebx
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ebx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ebx, [edi]
		jz	short loc_1000E3E9
		push	esi

loc_1000E3D0:				; CODE XREF: sub_1000E3B8+2Ej
		mov	esi, [ebx]
		lea	ecx, [ebx+8]
		call	sub_1000D896
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	ebx, esi
		pop	ecx
		cmp	esi, [edi]
		jnz	short loc_1000E3D0
		pop	esi

loc_1000E3E9:				; CODE XREF: sub_1000E3B8+15j
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		pop	ebx
		retn
sub_1000E3B8	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E3F5	proc near		; CODE XREF: sub_1000E428+13p
					; sub_1001510E+32p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	5Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000E408
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000E408:				; CODE XREF: sub_1000E3F5+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000E416
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_1000E41A
; ---------------------------------------------------------------------------

loc_1000E416:				; CODE XREF: sub_1000E3F5+19j
		mov	edx, [esp+arg_4]

loc_1000E41A:				; CODE XREF: sub_1000E3F5+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_1000E425
		mov	[ecx], edx

locret_1000E425:			; CODE XREF: sub_1000E3F5+2Cj
		retn	8
sub_1000E3F5	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E428	proc near		; CODE XREF: sub_1000D8BF+7Ep
					; sub_1001510E+EDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		mov	edi, ecx
		mov	[esp+14h+var_4], edi
		push	dword ptr [esi+4]
		push	esi
		call	sub_1000E3F5
		mov	ebx, eax
		lea	ebp, [ebx+8]
		test	ebp, ebp
		jz	short loc_1000E486
		mov	edi, [esp+14h+arg_4]
		mov	ecx, [edi]
		lea	eax, [edi+8]
		mov	[ebp+0], ecx
		mov	ecx, [edi+4]
		mov	[ebp+4], ecx
		lea	ecx, [ebp+8]
		push	eax
		call	sub_1000388D
		lea	eax, [edi+20h]
		push	eax
		lea	ecx, [ebp+20h]
		call	sub_1000344B
		lea	eax, [edi+38h]
		push	eax
		lea	ecx, [ebp+38h]
		call	sub_1000344B
		mov	eax, [edi+50h]
		mov	edi, [esp+14h+var_4]
		mov	[ebp+50h], eax

loc_1000E486:				; CODE XREF: sub_1000E428+1Fj
		mov	ecx, [edi+4]
		mov	eax, 2C8590Ah
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_1000E4A0
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000E4A0:				; CODE XREF: sub_1000E428+6Bj
		lea	eax, [ecx+1]
		mov	[edi+4], eax
		mov	[esi+4], ebx
		mov	eax, [ebx+4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ebx
		pop	ebx
		pop	ecx
		retn	8
sub_1000E428	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E4B6	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x):loc_100176AFp
					; TargetNtUnmapViewOfSection(x,x,x)+1Fp
		push	esi
		mov	esi, dword_10031F74
		test	esi, esi
		jnz	short loc_1000E513
		mov	eax, g_interceptions
		test	eax, eax
		jnz	short loc_1000E4CC
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000E4CC:				; CODE XREF: sub_1000E4B6+12j
		mov	eax, [eax]
		xor	esi, esi
		push	edi
		lea	edi, ds:8[eax*4]
		call	sub_10013DE4
		test	al, al
		jz	short loc_1000E4F1
		push	edi
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax

loc_1000E4F1:				; CODE XREF: sub_1000E4B6+29j
		mov	eax, g_interceptions
		xor	ecx, ecx
		mov	[esi], eax
		mov	dword_10031F74,	esi
		pop	edi
		cmp	[eax], ecx
		jle	short loc_1000E513
		lea	edx, [esi+4]

loc_1000E508:				; CODE XREF: sub_1000E4B6+5Bj
		and	dword ptr [edx], 0
		inc	ecx
		lea	edx, [edx+4]
		cmp	ecx, [eax]
		jl	short loc_1000E508

loc_1000E513:				; CODE XREF: sub_1000E4B6+9j
					; sub_1000E4B6+4Dj
		mov	eax, esi
		pop	esi
		retn
sub_1000E4B6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E517	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1A9p

var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	eax, [ebx]
		xor	edi, edi
		lea	ebp, [eax+8]
		cmp	[eax], edi
		jle	short loc_1000E588

loc_1000E52B:				; CODE XREF: sub_1000E517+6Fj
		lea	esi, [ebp+0Eh]
		push	esi
		call	dword_10031D58
		add	eax, eax
		mov	[esp+28h+var_4], esi
		cmp	[esp+28h+arg_0], 0
		pop	ecx
		mov	[esp+24h+var_8], ax
		mov	[esp+24h+var_6], ax
		jz	short loc_1000E562
		push	1
		push	[esp+28h+arg_0]
		lea	eax, [esp+2Ch+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000E588

loc_1000E562:				; CODE XREF: sub_1000E517+34j
		cmp	[esp+24h+arg_4], 0
		jz	short loc_1000E57E
		push	1
		push	[esp+28h+arg_4]
		lea	eax, [esp+2Ch+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000E588

loc_1000E57E:				; CODE XREF: sub_1000E517+50j
		mov	eax, [ebx]
		add	ebp, [ebp+0]
		inc	edi
		cmp	edi, [eax]
		jl	short loc_1000E52B

loc_1000E588:				; CODE XREF: sub_1000E517+12j
					; sub_1000E517+49j ...
		mov	ecx, [ebx]
		cmp	edi, [ecx]
		jz	short loc_1000E60D
		cmp	byte ptr [ebp+0Ch], 0
		jz	short loc_1000E598
		xor	al, al
		jmp	short loc_1000E60F
; ---------------------------------------------------------------------------

loc_1000E598:				; CODE XREF: sub_1000E517+7Bj
		cmp	dword ptr [ebx+edi*4+4], 0
		jnz	short loc_1000E60D
		mov	esi, [ebp+8]
		xor	edx, edx
		shl	esi, 6
		inc	edx
		add	esi, 10h
		push	ecx
		mov	ecx, esi
		call	sub_100142D5
		mov	[ebx+edi*4+4], eax
		pop	ecx
		test	eax, eax
		jz	short loc_1000E60D
		mov	[eax], esi
		mov	eax, [ebx+edi*4+4]
		and	dword ptr [eax+0Ch], 0
		mov	ecx, [ebx+edi*4+4]
		mov	eax, [esp+24h+arg_8]
		mov	[ecx+8], eax
		mov	ecx, ebx
		mov	eax, [ebx+edi*4+4]
		mov	dword ptr [eax+4], 10h
		push	dword ptr [ebx+edi*4+4]
		push	ebp
		call	sub_1000E65B
		mov	eax, [ebx+edi*4+4]
		mov	[esp+24h+var_10], eax
		lea	eax, [esp+24h+var_C]
		push	eax
		push	20h
		lea	eax, [esp+2Ch+var_14]
		mov	dword ptr [esp+2Ch+var_14], esi
		push	eax
		lea	eax, [esp+30h+var_10]
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D1C

loc_1000E60D:				; CODE XREF: sub_1000E517+75j
					; sub_1000E517+86j ...
		mov	al, 1

loc_1000E60F:				; CODE XREF: sub_1000E517+7Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn	0Ch
sub_1000E517	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E619	proc near		; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+2Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	esi, esi
		mov	eax, [edi]
		mov	edx, [eax]
		test	edx, edx
		jle	short loc_1000E656
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		lea	eax, [edi+4]

loc_1000E62F:				; CODE XREF: sub_1000E619+27j
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000E63A
		cmp	[ecx+8], ebx
		jz	short loc_1000E644

loc_1000E63A:				; CODE XREF: sub_1000E619+1Aj
		inc	esi
		add	eax, 4
		cmp	esi, edx
		jl	short loc_1000E62F
		jmp	short loc_1000E655
; ---------------------------------------------------------------------------

loc_1000E644:				; CODE XREF: sub_1000E619+1Fj
		mov	ecx, [edi+esi*4+4]
		xor	edx, edx
		inc	edx
		call	sub_1001430B
		and	dword ptr [edi+esi*4+4], 0

loc_1000E655:				; CODE XREF: sub_1000E619+29j
		pop	ebx

loc_1000E656:				; CODE XREF: sub_1000E619+Cj
		pop	edi
		pop	esi
		retn	4
sub_1000E619	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E65B	proc near		; CODE XREF: sub_1000E517+CCp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		and	[esp+18h+arg_0], 0
		mov	[esp+18h+var_4], ecx
		mov	esi, [edi+4]
		add	esi, edi
		cmp	dword ptr [edi+8], 0
		jle	loc_1000E71C
		mov	ebx, [esp+18h+arg_4]
		lea	ebp, [ebx+10h]

loc_1000E684:				; CODE XREF: sub_1000E65B+BBj
		mov	eax, [edi]
		lea	ecx, [esi+10h]
		add	eax, edi
		cmp	ecx, eax
		jnb	loc_1000E727
		push	dword ptr [esi+4]
		call	sub_1000E72B
		mov	[esp+18h+arg_4], eax
		test	eax, eax
		jz	loc_1000E727
		lea	ecx, [esi+10h]
		push	ecx
		call	dword_10031D54
		pop	ecx
		mov	ecx, [esi]
		lea	edx, [esi+11h]
		add	edx, eax
		add	ecx, esi
		mov	[esp+18h+var_8], edx
		cmp	edx, ecx
		jnb	short loc_1000E727
		mov	eax, [edi]
		add	eax, edi
		cmp	edx, eax
		jnb	short loc_1000E727
		mov	ecx, [esp+18h+arg_4]
		lea	eax, [esi+10h]
		push	0
		push	40h
		push	ebp
		push	dword ptr [esi+0Ch]
		mov	edx, [ecx]
		push	[esp+28h+var_8]
		push	eax
		mov	eax, [esp+30h+var_4]
		mov	eax, [eax]
		push	dword ptr [eax+4]
		push	dword ptr [ebx+8]
		call	dword ptr [edx+4]
		test	eax, eax
		js	short loc_1000E727
		mov	eax, [esi+8]
		mov	ecx, [esp+18h+arg_0]
		mov	g_originals[eax*4], ebp
		add	ebp, 40h
		inc	dword ptr [ebx+0Ch]
		add	dword ptr [ebx+4], 40h
		add	esi, [esi]
		inc	ecx
		mov	[esp+18h+arg_0], ecx
		cmp	ecx, [edi+8]
		jl	loc_1000E684

loc_1000E71C:				; CODE XREF: sub_1000E65B+1Cj
		mov	al, 1

loc_1000E71E:				; CODE XREF: sub_1000E65B+CEj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_1000E727:				; CODE XREF: sub_1000E65B+32j
					; sub_1000E65B+46j ...
		xor	al, al
		jmp	short loc_1000E71E
sub_1000E65B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E72B	proc near		; CODE XREF: sub_1000E65B+3Bp

arg_0		= dword	ptr  4

		push	esi
		xor	esi, esi
		cmp	dword_10031F70,	esi
		jnz	short loc_1000E768
		call	sub_10013DE4
		test	al, al
		jz	short loc_1000E762
		push	10h
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E762
		mov	dword ptr [eax], offset	off_1002C258
		mov	[eax+0Ch], esi
		mov	dword_10031F70,	eax
		jmp	short loc_1000E768
; ---------------------------------------------------------------------------

loc_1000E762:				; CODE XREF: sub_1000E72B+12j
					; sub_1000E72B+25j
		mov	dword_10031F70,	esi

loc_1000E768:				; CODE XREF: sub_1000E72B+9j
					; sub_1000E72B+35j
		cmp	dword_10031F78,	esi
		jnz	short loc_1000E79F
		call	sub_10013DE4
		test	al, al
		jz	short loc_1000E799
		push	0Ch
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E799
		mov	dword ptr [eax], offset	off_1002C270
		mov	dword_10031F78,	eax
		jmp	short loc_1000E79F
; ---------------------------------------------------------------------------

loc_1000E799:				; CODE XREF: sub_1000E72B+4Cj
					; sub_1000E72B+5Fj
		mov	dword_10031F78,	esi

loc_1000E79F:				; CODE XREF: sub_1000E72B+43j
					; sub_1000E72B+6Cj
		mov	eax, dword_10031F6C
		test	eax, eax
		jnz	short loc_1000E7D3
		call	sub_10013DE4
		test	al, al
		jz	short loc_1000E7CC
		push	0Ch
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E7CC
		mov	dword ptr [eax], offset	off_1002C240
		jmp	short loc_1000E7CE
; ---------------------------------------------------------------------------

loc_1000E7CC:				; CODE XREF: sub_1000E72B+84j
					; sub_1000E72B+97j
		mov	eax, esi

loc_1000E7CE:				; CODE XREF: sub_1000E72B+9Fj
		mov	dword_10031F6C,	eax

loc_1000E7D3:				; CODE XREF: sub_1000E72B+7Bj
		mov	ecx, [esp+4+arg_0]
		dec	ecx
		pop	esi
		dec	ecx
		jz	short loc_1000E7ED
		dec	ecx
		jz	short loc_1000E7E6
		dec	ecx
		jz	short locret_1000E7F2
		xor	eax, eax
		jmp	short locret_1000E7F2
; ---------------------------------------------------------------------------

loc_1000E7E6:				; CODE XREF: sub_1000E72B+B2j
		mov	eax, dword_10031F78
		jmp	short locret_1000E7F2
; ---------------------------------------------------------------------------

loc_1000E7ED:				; CODE XREF: sub_1000E72B+AFj
		mov	eax, dword_10031F70

locret_1000E7F2:			; CODE XREF: sub_1000E72B+B5j
					; sub_1000E72B+B9j ...
		retn	4
sub_1000E72B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E7F5	proc near		; CODE XREF: sub_10014DA3+1Bp

var_7C		= dword	ptr -7Ch
JobObjectInformation= dword ptr	-78h
Dst		= byte ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_18		= dword	ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, ecx
		push	esi
		xor	esi, esi
		push	edi
		cmp	[ebx], esi
		jz	short loc_1000E81A
		mov	eax, 4DFh
		jmp	loc_1000E8EA
; ---------------------------------------------------------------------------

loc_1000E81A:				; CODE XREF: sub_1000E7F5+19j
		push	esi		; lpName
		push	esi		; lpJobAttributes
		call	ds:CreateJobObjectW
		mov	edi, eax
		mov	[ebx], edi
		test	edi, edi
		jnz	short loc_1000E835

loc_1000E82A:				; CODE XREF: sub_1000E7F5+D1j
					; sub_1000E7F5+EDj
		call	ds:GetLastError
		jmp	loc_1000E8EA
; ---------------------------------------------------------------------------

loc_1000E835:				; CODE XREF: sub_1000E7F5+33j
		push	6Ch		; Size
		lea	eax, [ebp+Dst]
		mov	[ebp+JobObjectInformation], esi
		push	esi		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch
		mov	[ebp+var_7C], esi
		sub	eax, esi
		jz	short loc_1000E87B
		dec	eax
		jz	short loc_1000E876
		dec	eax
		jz	short loc_1000E871
		dec	eax
		jz	short loc_1000E86C
		dec	eax
		jz	short loc_1000E867
		mov	eax, 0A0h
		jmp	loc_1000E8EA
; ---------------------------------------------------------------------------

loc_1000E867:				; CODE XREF: sub_1000E7F5+66j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E89C
; ---------------------------------------------------------------------------

loc_1000E86C:				; CODE XREF: sub_1000E7F5+63j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E893
; ---------------------------------------------------------------------------

loc_1000E871:				; CODE XREF: sub_1000E7F5+60j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E886
; ---------------------------------------------------------------------------

loc_1000E876:				; CODE XREF: sub_1000E7F5+5Dj
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E883
; ---------------------------------------------------------------------------

loc_1000E87B:				; CODE XREF: sub_1000E7F5+5Aj
		mov	eax, [ebp+var_68]
		or	eax, 400h

loc_1000E883:				; CODE XREF: sub_1000E7F5+84j
		push	27h
		pop	esi

loc_1000E886:				; CODE XREF: sub_1000E7F5+7Fj
		or	esi, 10h
		mov	[ebp+var_5C], 1
		or	eax, 8

loc_1000E893:				; CODE XREF: sub_1000E7F5+7Aj
		or	esi, 0C8h
		mov	[ebp+var_7C], esi

loc_1000E89C:				; CODE XREF: sub_1000E7F5+75j
		mov	ecx, [ebp+arg_C]
		test	ecx, ecx
		jz	short loc_1000E8AB
		or	eax, 100h
		mov	[ebp+var_18], ecx

loc_1000E8AB:				; CODE XREF: sub_1000E7F5+ACj
		mov	esi, ds:SetInformationJobObject
		or	eax, 2000h
		push	70h		; cbJobObjectInformationLength
		mov	[ebp+var_68], eax
		lea	eax, [ebp+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	9		; JobObjectInformationClass
		push	edi		; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jz	loc_1000E82A
		mov	eax, [ebp+arg_8]
		not	eax
		and	[ebp+var_7C], eax
		lea	eax, [ebp+var_7C]
		push	4		; cbJobObjectInformationLength
		push	eax		; lpJobObjectInformation
		push	4		; JobObjectInformationClass
		push	dword ptr [ebx]	; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jz	loc_1000E82A
		xor	eax, eax

loc_1000E8EA:				; CODE XREF: sub_1000E7F5+20j
					; sub_1000E7F5+3Bj ...
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000E7F5	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E8FD	proc near		; DATA XREF: .rdata:1002C2E0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C2D8
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_1000E91A
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000E91A:				; CODE XREF: sub_1000E8FD+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000E8FD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E920	proc near		; DATA XREF: .rdata:1002C2DCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 8
		jnz	short loc_1000E94E
		mov	eax, offset _TargetCreateNamedPipeW@36 ; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000E94E
		mov	ecx, [esp+arg_0]
		push	0Eh		; int
		push	offset a_targetcreat_3 ; "_TargetCreateNamedPipeW@36"
		push	2		; int
		push	offset aCreatenamedpip ; "CreateNamedPipeW"
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		call	sub_1000D8BF
		jmp	short locret_1000E950
; ---------------------------------------------------------------------------

loc_1000E94E:				; CODE XREF: sub_1000E920+5j
					; sub_1000E920+Ej
		xor	al, al

locret_1000E950:			; CODE XREF: sub_1000E920+2Cj
		retn	8
sub_1000E920	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000E953(int, LPCWSTR lpName, DWORD	dwOpenMode, DWORD dwPipeMode, DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize, DWORD nDefaultTimeOut)
sub_1000E953	proc near		; DATA XREF: .rdata:1002C30Co

TargetHandle	= dword	ptr -0E8h
hTargetProcessHandle= dword ptr	-0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= byte ptr -0C0h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpName		= dword	ptr  0Ch
dwOpenMode	= dword	ptr  10h
dwPipeMode	= dword	ptr  14h
nMaxInstances	= dword	ptr  18h
nOutBufferSize	= dword	ptr  1Ch
nInBufferSize	= dword	ptr  20h
nDefaultTimeOut	= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0ECh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0ECh+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+lpName]
		push	esi
		or	dword ptr [eax+18h], 0FFFFFFFFh
		push	edi
		push	5
		pop	esi
		mov	[esp+0F8h+hTargetProcessHandle], eax
		mov	[eax+10h], esi
		lea	eax, [esp+0F8h+var_D0]
		mov	[esp+0F8h+TargetHandle], ecx
		xor	ecx, ecx
		push	eax		; int
		push	ecx		; int
		mov	[esp+100h+var_E0], ecx
		mov	[esp+100h+var_D0], ecx
		mov	[esp+100h+var_CC], ecx
		mov	[esp+100h+var_C8], ecx
		mov	[esp+100h+var_DC], ecx
		mov	[esp+100h+var_D8], ecx
		mov	[esp+100h+var_D4], ecx
		mov	ecx, ebx	; int
		push	2Fh
		pop	edx
		call	sub_100034D9
		mov	edi, [esp+100h+var_D0]
		pop	ecx
		pop	ecx
		cmp	edi, [esp+0F8h+var_CC]
		jz	short loc_1000EA2B

loc_1000E9C2:				; CODE XREF: sub_1000E953+D3j
		mov	eax, [esp+0F8h+var_E0]
		test	al, 2
		jz	short loc_1000E9DA
		and	eax, 0FFFFFFFDh
		lea	ecx, [esp+0F8h+var_C0]
		mov	[esp+0F8h+var_E0], eax
		call	sub_10001BD6

loc_1000E9DA:				; CODE XREF: sub_1000E953+75j
		lea	eax, [esp+0F8h+var_DC]
		push	eax		; int
		push	ecx		; int
		push	5Ch
		pop	edx
		mov	ecx, edi	; int
		call	sub_100034D9
		mov	esi, [esp+100h+var_DC]
		pop	ecx
		pop	ecx
		jmp	short loc_1000EA19
; ---------------------------------------------------------------------------

loc_1000E9F2:				; CODE XREF: sub_1000E953+CAj
		mov	ecx, offset a__	; ".."
		call	sub_10001ADC
		push	eax
		push	offset a__	; ".."
		push	dword ptr [esi+10h]
		mov	ecx, esi
		push	0
		call	sub_10003F01
		test	eax, eax
		jz	loc_1000EB25
		add	esi, 18h

loc_1000EA19:				; CODE XREF: sub_1000E953+9Dj
		cmp	esi, [esp+0F8h+var_D8]
		jnz	short loc_1000E9F2
		add	edi, 18h
		cmp	edi, [esp+0F8h+var_CC]
		jnz	short loc_1000E9C2
		push	5
		pop	esi

loc_1000EA2B:				; CODE XREF: sub_1000E953+6Dj
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000EA35
		mov	eax, [ebx]
		jmp	short loc_1000EA37
; ---------------------------------------------------------------------------

loc_1000EA35:				; CODE XREF: sub_1000E953+DCj
		mov	eax, ebx

loc_1000EA37:				; CODE XREF: sub_1000E953+E0j
		mov	ecx, [esp+0F8h+TargetHandle]
		mov	[esp+0F8h+var_C4], eax
		lea	eax, [esp+0F8h+var_C4]
		mov	[esp+0F8h+var_8], eax
		lea	eax, [esp+0F8h+var_10]
		push	eax
		mov	ecx, [ecx+10h]
		push	8
		mov	[esp+100h+var_10], 1
		mov	[esp+100h+var_C], 1
		call	sub_10015057
		mov	edi, offset a_	; "\\\\.\\"
		mov	[esp+0F8h+TargetHandle], eax
		mov	ecx, edi
		call	sub_10001ADC
		push	eax
		push	edi
		push	4
		push	0
		mov	ecx, ebx
		call	sub_10003F01
		test	eax, eax
		jnz	short loc_1000EAAC
		mov	edi, offset a?	; "\\\\?\\"
		mov	ecx, edi
		call	sub_10001ADC
		push	eax		; int
		push	edi		; Src
		push	4		; int
		push	0		; int
		mov	ecx, ebx
		call	sub_10003F5F

loc_1000EAAC:				; CODE XREF: sub_1000E953+13Ej
		cmp	[esp+0F8h+TargetHandle], 3
		mov	edi, [esp+0F8h+hTargetProcessHandle]
		mov	eax, [edi+4]
		jz	short loc_1000EAC0
		mov	eax, [esp+0F8h+hTargetProcessHandle]
		jmp	short loc_1000EB1F
; ---------------------------------------------------------------------------

loc_1000EAC0:				; CODE XREF: sub_1000E953+165j
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000EAC8
		mov	ebx, [ebx]

loc_1000EAC8:				; CODE XREF: sub_1000E953+171j
		mov	eax, [eax]
		push	0		; lpSecurityAttributes
		push	[ebp+nDefaultTimeOut] ;	nDefaultTimeOut
		mov	[esp+100h+hTargetProcessHandle], eax
		push	[ebp+nInBufferSize] ; nInBufferSize
		push	[ebp+nOutBufferSize] ; nOutBufferSize
		push	[ebp+nMaxInstances] ; nMaxInstances
		push	[ebp+dwPipeMode] ; dwPipeMode
		push	[ebp+dwOpenMode] ; dwOpenMode
		push	ebx		; lpName
		call	ds:CreateNamedPipeW
		or	ebx, 0FFFFFFFFh
		cmp	eax, ebx
		jnz	short loc_1000EAF4

loc_1000EAF0:				; CODE XREF: sub_1000E953+1C0j
		mov	eax, ebx
		jmp	short loc_1000EB1F
; ---------------------------------------------------------------------------

loc_1000EAF4:				; CODE XREF: sub_1000E953+19Bj
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	ecx, [esp+104h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[esp+108h+hTargetProcessHandle]	; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000EAF0
		mov	eax, [esp+0F8h+TargetHandle]
		cmp	eax, ebx
		jz	short loc_1000EB1F
		xor	esi, esi

loc_1000EB1F:				; CODE XREF: sub_1000E953+16Bj
					; sub_1000E953+19Fj ...
		mov	[edi+10h], esi
		mov	[edi+18h], eax

loc_1000EB25:				; CODE XREF: sub_1000E953+BDj
		lea	ecx, [esp+0F8h+var_DC]
		call	sub_1000393B
		lea	ecx, [esp+0F8h+var_D0]
		call	sub_1000393B
		mov	ecx, [esp+0F8h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_1000E953	endp

; Exported entry  17. _TargetCreateNamedPipeW@36

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateNamedPipeW(x, x, x, x, x, x, x,	x, x)
		public _TargetCreateNamedPipeW@36
_TargetCreateNamedPipeW@36 proc	near	; DATA XREF: sub_1000E920+7o
					; .rdata:off_1002E058o

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
Src		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
Dst		= byte ptr -40h
dwErrCode	= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_18]
		mov	edx, [ebp+arg_14]
		and	[esp+74h+var_10], 0
		push	ebx
		mov	ebx, [ebp+arg_8]
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[esp+80h+var_48], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+80h+var_54], ebx
		mov	[esp+80h+Src], ebx
		mov	ebx, [ebp+arg_20]
		push	ebx
		mov	[esp+84h+var_64], eax
		mov	[esp+84h+var_70], eax
		mov	eax, [ebp+arg_1C]
		push	eax
		push	ecx
		push	edx
		push	esi
		push	edi
		mov	[esp+98h+var_5C], ebx
		mov	ebx, [esp+98h+var_54]
		push	ebx
		push	[esp+9Ch+var_64]
		mov	[esp+0A0h+var_58], edi
		mov	[esp+0A0h+var_60], esi
		mov	[esp+0A0h+var_68], edx
		mov	[esp+0A0h+var_6C], ecx
		mov	[esp+0A0h+var_4C], eax
		call	[esp+0A0h+var_48]
		or	ebx, 0FFFFFFFFh
		cmp	eax, ebx
		jnz	loc_1000ECC0
		mov	edx, [esp+80h+var_70]
		mov	ecx, offset aCreatenamedpip ; "CreateNamedPipeW"
		call	sub_100029E7
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_1000ECBE
		call	ds:GetLastError
		cmp	[esp+80h+var_5C], 0
		mov	edi, eax
		jnz	loc_1000ECBE
		call	sub_10013DD2
		mov	esi, eax
		test	esi, esi
		jz	loc_1000ECB7
		xor	ecx, ecx
		lea	eax, [esp+80h+var_70]
		inc	ecx
		mov	[esp+80h+var_8], eax
		mov	[esp+80h+var_10], ecx
		lea	edx, [esp+80h+var_10]
		mov	[esp+80h+var_C], ecx
		push	8
		pop	ecx
		call	sub_10010153
		test	al, al
		jz	loc_1000ECB7
		mov	eax, [esi+8]
		and	[esp+80h+var_44], 0
		add	eax, esi
		push	30h		; Size
		mov	[esp+84h+var_C], eax
		lea	eax, [esp+84h+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+8Ch+var_10], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+80h+var_44]
		lea	ecx, [esp+80h+var_10]
		push	eax		; int
		lea	eax, [esp+84h+var_4C]
		push	eax		; void *
		lea	eax, [esp+88h+var_6C]
		push	eax		; void *
		lea	eax, [esp+8Ch+var_68]
		push	eax		; void *
		lea	eax, [esp+90h+var_60]
		push	eax		; void *
		lea	eax, [esp+94h+var_58]
		push	eax		; void *
		lea	eax, [esp+98h+Src]
		push	eax		; Src
		lea	eax, [esp+9Ch+var_70]
		push	eax		; int
		call	sub_1000ECD4
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1000ECB7
		push	[esp+80h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+80h+dwErrCode], 0
		jnz	short loc_1000ECBE
		mov	edx, [esp+80h+var_70]
		mov	ecx, offset aCreatenamedpip ; "CreateNamedPipeW"
		call	sub_10002AE8
		mov	eax, [esp+80h+var_34]
		jmp	short loc_1000ECC0
; ---------------------------------------------------------------------------

loc_1000ECB7:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+BAj
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+E1j ...
		push	edi		; dwErrCode
		call	ds:SetLastError

loc_1000ECBE:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+98j
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+ABj ...
		mov	eax, ebx

loc_1000ECC0:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+7Bj
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+165j
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	24h
_TargetCreateNamedPipeW@36 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ECD4(int,	void *Src, void	*, void	*, void	*, void	*, void	*, int)
sub_1000ECD4	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+136p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ECEC
		push	4
		pop	eax
		jmp	loc_1000EDE8
; ---------------------------------------------------------------------------

loc_1000ECEC:				; CODE XREF: sub_1000ECD4+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 8
		inc	ebp
		mov	dword ptr [edi+3Ch], 7
		push	ebp		; int
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		mov	ecx, edi
		call	sub_1000B190
		test	al, al
		jnz	short loc_1000ED36
		push	4
		pop	eax
		jmp	loc_1000EDE6
; ---------------------------------------------------------------------------

loc_1000ED36:				; CODE XREF: sub_1000ECD4+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B190
		test	al, al
		jz	loc_1000EDE4
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, edi
		push	2		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000EDE4
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, edi
		push	3		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000EDE4
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_10] ; Src
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000EDE4
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_14] ; Src
		mov	ecx, edi
		push	5		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000EDE4
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_18] ; Src
		mov	ecx, edi
		push	6		; int
		call	sub_1000B190
		test	al, al
		jz	short loc_1000EDE4
		push	[esp+14h+arg_1C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000EDE4
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000EDE4:				; CODE XREF: sub_1000ECD4+78j
					; sub_1000ECD4+92j ...
		mov	eax, esi

loc_1000EDE6:				; CODE XREF: sub_1000ECD4+5Dj
		pop	esi
		pop	ebp

loc_1000EDE8:				; CODE XREF: sub_1000ECD4+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ECD4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EDEC	proc near		; CODE XREF: sub_1001525E+11Bp

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		push	esi
		mov	esi, ecx
		cmp	edx, 6
		jz	short loc_1000EDFF
		xor	al, al
		jmp	short loc_1000EE3B
; ---------------------------------------------------------------------------

loc_1000EDFF:				; CODE XREF: sub_1000EDEC+Dj
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F976
		xor	ebx, ebx
		inc	ebx
		push	ebx
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1000EE2F
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	8
		call	sub_1000F6D9
		test	al, al
		jnz	short loc_1000EE31

loc_1000EE2F:				; CODE XREF: sub_1000EDEC+2Fj
		xor	bl, bl

loc_1000EE31:				; CODE XREF: sub_1000EDEC+41j
		lea	ecx, [ebp+var_14]
		call	sub_1000FD8D
		mov	al, bl

loc_1000EE3B:				; CODE XREF: sub_1000EDEC+11j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EDEC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EE41	proc near		; CODE XREF: sub_1001510E+122p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
phModule	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		push	offset aNtdll_dll_1 ; "ntdll.dll"
		mov	esi, ecx
		call	ds:GetModuleHandleW
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [ebp+var_C]
		mov	[ebp+phModule],	eax
		mov	[ebp+var_C], offset off_1001AA20
		mov	[ebp+var_8], eax
		call	sub_1000578C
		test	eax, eax
		jz	short loc_1000EE80
		lea	ecx, [ebp+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW

loc_1000EE80:				; CODE XREF: sub_1000EE41+30j
		push	offset aNtallocatevirt ; "NtAllocateVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	g_nt, eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtclose	; "NtClose"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D0C,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtduplicateobj ; "NtDuplicateObject"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D10,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtfreevirtualm ; "NtFreeVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D14,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D18,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtprotectvirtu ; "NtProtectVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D1C,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtqueryinforma ; "NtQueryInformationProcess"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D20,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtqueryobject ;	"NtQueryObject"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D24,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtquerysection ; "NtQuerySection"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D28,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtqueryvirtual ; "NtQueryVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D2C,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D30,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlallocatehea ; "RtlAllocateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D34,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlansistringt ; "RtlAnsiStringToUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D38,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlcompareunic ; "RtlCompareUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D3C,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlcreateheap ;	"RtlCreateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D40,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlcreateusert ; "RtlCreateUserThread"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D44,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtldestroyheap ; "RtlDestroyHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D48,	eax
		test	eax, eax
		jz	loc_1000F0C3
		push	offset aRtlfreeheap ; "RtlFreeHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D4C,	eax
		test	eax, eax
		jz	short loc_1000F0C3
		push	offset a_strnicmp ; "_strnicmp"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D50,	eax
		test	eax, eax
		jz	short loc_1000F0C3
		push	offset aStrlen	; "strlen"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D54,	eax
		test	eax, eax
		jz	short loc_1000F0C3
		push	offset aWcslen	; "wcslen"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D58,	eax
		test	eax, eax
		jz	short loc_1000F0C3
		push	offset aMemcpy	; "memcpy"
		lea	ecx, [ebp+var_C]
		call	sub_1000578C
		mov	dword_10031D5C,	eax
		test	eax, eax
		jz	short loc_1000F0C3
		push	58h		; nSize
		push	offset g_nt	; lpBuffer
		push	offset aG_nt_0	; "g_nt"
		mov	ecx, esi
		call	sub_10017AC0
		neg	eax
		sbb	al, al
		inc	al
		jmp	short loc_1000F0C5
; ---------------------------------------------------------------------------

loc_1000F0C3:				; CODE XREF: sub_1000EE41+53j
					; sub_1000EE41+6Dj ...
		xor	al, al

loc_1000F0C5:				; CODE XREF: sub_1000EE41+280j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EE41	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F0CA	proc near		; CODE XREF: sub_1001510E+10Ap
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		mov	eax, offset _TargetNtOpenThread@20 ; TargetNtOpenThread(x,x,x,x,x)
		xor	ebx, ebx
		inc	edi
		mov	esi, ecx
		mov	ebp, offset aNtdll_dll_1 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_1000F0F9
		push	5		; int
		push	offset a_targetntope_8 ; "_TargetNtOpenThread@20"
		push	edi		; int
		push	offset aNtopenthread ; "NtOpenThread"
		push	ebp		; void *
		call	sub_1000D8BF
		jmp	short loc_1000F0FB
; ---------------------------------------------------------------------------

loc_1000F0F9:				; CODE XREF: sub_1000F0CA+18j
		mov	al, bl

loc_1000F0FB:				; CODE XREF: sub_1000F0CA+2Dj
		test	al, al
		jz	loc_1000F201
		mov	eax, offset _TargetNtOpenProcess@20 ; TargetNtOpenProcess(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F123
		push	6		; int
		push	offset a_targetntope_9 ; "_TargetNtOpenProcess@20"
		push	edi		; int
		push	offset aNtopenprocess ;	"NtOpenProcess"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		jmp	short loc_1000F125
; ---------------------------------------------------------------------------

loc_1000F123:				; CODE XREF: sub_1000F0CA+40j
		mov	al, bl

loc_1000F125:				; CODE XREF: sub_1000F0CA+57j
		test	al, al
		jz	loc_1000F201
		mov	eax, offset _TargetNtOpenProcessToken@16 ; TargetNtOpenProcessToken(x,x,x,x)
		test	eax, eax
		jz	short loc_1000F14D
		push	7		; int
		push	offset a_targetntop_10 ; "_TargetNtOpenProcessToken@16"
		push	edi		; int
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		jmp	short loc_1000F14F
; ---------------------------------------------------------------------------

loc_1000F14D:				; CODE XREF: sub_1000F0CA+6Aj
		mov	al, bl

loc_1000F14F:				; CODE XREF: sub_1000F0CA+81j
		test	al, al
		jz	loc_1000F201
		mov	eax, offset _TargetNtSetInformationThread@20 ; TargetNtSetInformationThread(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F177
		push	2		; int
		push	offset a_targetntset_2 ; "_TargetNtSetInformationThread@20"
		push	edi		; int
		push	offset aNtsetinforma_0 ; "NtSetInformationThread"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		jmp	short loc_1000F179
; ---------------------------------------------------------------------------

loc_1000F177:				; CODE XREF: sub_1000F0CA+94j
		mov	al, bl

loc_1000F179:				; CODE XREF: sub_1000F0CA+ABj
		test	al, al
		jz	loc_1000F201
		mov	eax, offset _TargetNtOpenThreadToken@20	; TargetNtOpenThreadToken(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F1A1
		push	3		; int
		push	offset a_targetntop_11 ; "_TargetNtOpenThreadToken@20"
		push	edi		; int
		push	offset aNtopenthreadto ; "NtOpenThreadToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		jmp	short loc_1000F1A3
; ---------------------------------------------------------------------------

loc_1000F1A1:				; CODE XREF: sub_1000F0CA+BEj
		mov	al, bl

loc_1000F1A3:				; CODE XREF: sub_1000F0CA+D5j
		test	al, al
		jz	short loc_1000F201
		call	sub_100063BF
		cmp	dword ptr [eax], 1
		jl	short loc_1000F1FD
		mov	eax, offset _TargetNtOpenProcessTokenEx@20 ; TargetNtOpenProcessTokenEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F1D2
		push	8		; int
		push	offset a_targetntop_12 ; "_TargetNtOpenProcessTokenEx@20"
		push	1		; int
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		jmp	short loc_1000F1D4
; ---------------------------------------------------------------------------

loc_1000F1D2:				; CODE XREF: sub_1000F0CA+EEj
		mov	al, bl

loc_1000F1D4:				; CODE XREF: sub_1000F0CA+106j
		test	al, al
		jz	short loc_1000F201
		mov	eax, offset _TargetNtOpenThreadTokenEx@24 ; TargetNtOpenThreadTokenEx(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F1F9
		push	4		; int
		push	offset a_targetntop_13 ; "_TargetNtOpenThreadTokenEx@24"
		push	1		; int
		push	offset aNtopenthread_0 ; "NtOpenThreadTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8BF
		mov	bl, al

loc_1000F1F9:				; CODE XREF: sub_1000F0CA+115j
		mov	al, bl
		jmp	short loc_1000F203
; ---------------------------------------------------------------------------

loc_1000F1FD:				; CODE XREF: sub_1000F0CA+E5j
		mov	al, 1
		jmp	short loc_1000F203
; ---------------------------------------------------------------------------

loc_1000F201:				; CODE XREF: sub_1000F0CA+33j
					; sub_1000F0CA+5Dj ...
		xor	al, al

loc_1000F203:				; CODE XREF: sub_1000F0CA+131j
					; sub_1000F0CA+135j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1000F0CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F209	proc near		; CODE XREF: sub_1000F47C+34p
					; sub_1000FA25+50p

var_BC		= byte ptr -0BCh
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	ebx, ebx
		mov	eax, 0FFFFh
		mov	[ebp+var_8], ebx
		cmp	eax, esi
		push	edi
		sbb	eax, eax
		mov	edi, ecx
		and	eax, 2
		jz	short loc_1000F24F
		push	3
		push	1Ch
		push	offset aCBuildsMoz2__1 ; "c:\\builds\\moz2_slave\\rel-m-rel-w32_b"...
		lea	ecx, [ebp+var_BC]
		inc	ebx
		call	sub_10001B31
		mov	edx, offset aCheckFailedIsv ; "Check failed: IsValueInRangeForNumericT"...
		lea	ecx, [eax+8]
		call	sub_10002830

loc_1000F24F:				; CODE XREF: sub_1000F209+22j
		test	bl, 1
		jz	short loc_1000F25F
		lea	ecx, [ebp+var_BC]
		call	sub_10001BD6

loc_1000F25F:				; CODE XREF: sub_1000F209+49j
		mov	[edi+6], si
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000F209	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F26C	proc near		; CODE XREF: sub_1000F349+97p
					; sub_1000F349+A8p ...

arg_0		= dword	ptr  4

		lea	eax, [edx+edx]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	[esi+4], ecx
		mov	[esi], ax
		cmp	edx, 0FFFCh
		jbe	short loc_1000F286
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F286:				; CODE XREF: sub_1000F26C+14j
		test	ecx, ecx
		jz	short loc_1000F292
		movzx	eax, ax
		add	eax, 2
		jmp	short loc_1000F294
; ---------------------------------------------------------------------------

loc_1000F292:				; CODE XREF: sub_1000F26C+1Cj
		xor	eax, eax

loc_1000F294:				; CODE XREF: sub_1000F26C+24j
		mov	[esi+2], ax
		mov	al, 1
		pop	esi
		retn
sub_1000F26C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000F29C(int, LPCWSTR lpString, int, int, int)
sub_1000F29C	proc near		; CODE XREF: sub_1000FA25+B6p
					; sub_1000FA25+DEp

lpString	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+lpString]
		xor	eax, eax
		mov	ebx, ecx
		test	edi, edi
		jz	loc_1000F342
		cmp	ax, [edi]
		jz	loc_1000F340
		push	edi		; lpString
		call	ds:lstrlenW
		xor	ebp, ebp
		mov	[esp+10h+lpString], eax
		push	ebp
		push	[esp+14h+arg_10]
		mov	ecx, ebx
		push	5
		call	sub_1000F47C
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000F340
		mov	ecx, edi
		lea	edx, [ecx+2]

loc_1000F2DF:				; CODE XREF: sub_1000F29C+4Cj
		mov	ax, [ecx]
		add	ecx, 2
		cmp	ax, bp
		jnz	short loc_1000F2DF
		sub	ecx, edx
		sar	ecx, 1
		lea	ebp, ds:2[ecx*2]
		mov	ecx, [ebx+4]
		mov	eax, ecx
		sub	eax, [ebx]
		cmp	eax, ebp
		jb	short loc_1000F340
		sub	ecx, ebp
		mov	[ebx+4], ecx
		test	cl, 1
		jz	short loc_1000F310
		call	ds:DebugBreak

loc_1000F310:				; CODE XREF: sub_1000F29C+6Cj
		push	ebp		; Size
		push	edi		; Src
		push	dword ptr [ebx+4] ; Dst
		call	memcpy
		mov	eax, [ebx+4]
		add	esp, 0Ch
		sub	eax, esi
		jz	short loc_1000F340
		mov	[esi+8], eax
		mov	eax, [esp+10h+lpString]
		mov	[esi+0Ch], eax
		mov	eax, [esp+10h+arg_8]
		mov	[esi+10h], eax
		mov	eax, [esp+10h+arg_C]
		mov	[esi+14h], eax
		mov	eax, esi
		jmp	short loc_1000F342
; ---------------------------------------------------------------------------

loc_1000F340:				; CODE XREF: sub_1000F29C+17j
					; sub_1000F29C+3Cj ...
		xor	eax, eax

loc_1000F342:				; CODE XREF: sub_1000F29C+Ej
					; sub_1000F29C+A2j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	14h
sub_1000F29C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F349	proc near		; CODE XREF: sub_1000F542+39p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebx
		push	ebp
		mov	ebp, [esp+20h+arg_0]
		push	esi
		push	edi
		test	ebp, ebp
		jz	loc_1000F471
		cmp	dword ptr [edx], 1
		jnz	loc_1000F471
		mov	eax, [edx+4]
		mov	esi, [ecx+0Ch]
		mov	edi, [ecx+10h]
		mov	edx, [eax]
		mov	eax, [ecx+14h]
		mov	[esp+28h+var_14], eax
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	ecx, [ebp+0]
		mov	[esp+28h+arg_0], eax
		lea	eax, [edx+ecx*2]
		push	eax
		mov	[esp+2Ch+var_18], eax
		call	dword_10031D58
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_1000F3A0

loc_1000F398:				; CODE XREF: sub_1000F349+59j
					; sub_1000F349+83j ...
		xor	eax, eax
		inc	eax
		jmp	loc_1000F474
; ---------------------------------------------------------------------------

loc_1000F3A0:				; CODE XREF: sub_1000F349+4Dj
		cmp	esi, ebx
		jg	short loc_1000F398
		mov	ecx, [esp+28h+var_14]
		mov	al, cl
		and	al, 1
		mov	byte ptr [esp+28h+var_14], al
		test	edi, edi
		js	short loc_1000F41B
		cmp	edi, 0FFFFFh
		jnz	short loc_1000F3C2
		mov	edi, ebx
		sub	edi, esi
		jmp	short loc_1000F3CE
; ---------------------------------------------------------------------------

loc_1000F3C2:				; CODE XREF: sub_1000F349+71j
		test	cl, 2
		jz	short loc_1000F3CE
		lea	eax, [esi+edi]
		cmp	eax, ebx
		jnz	short loc_1000F398

loc_1000F3CE:				; CODE XREF: sub_1000F349+77j
					; sub_1000F349+7Cj
		lea	eax, [esi+edi]
		cmp	eax, ebx
		jg	short loc_1000F398
		mov	ecx, [esp+28h+arg_0]
		lea	eax, [esp+28h+var_8]
		push	eax
		mov	edx, esi
		call	sub_1000F26C
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	eax, [esp+30h+var_18]
		lea	ecx, [eax+edi*2]
		call	sub_1000F26C
		add	esp, 8
		lea	eax, [esp+28h+var_10]
		push	[esp+28h+var_14]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jnz	short loc_1000F398
		lea	eax, [esi+edi]

loc_1000F414:				; CODE XREF: sub_1000F349+126j
		add	[ebp+0], eax
		xor	eax, eax
		jmp	short loc_1000F474
; ---------------------------------------------------------------------------

loc_1000F41B:				; CODE XREF: sub_1000F349+69j
		mov	ecx, [esp+28h+arg_0]
		lea	eax, [esp+28h+var_8]
		push	eax
		mov	edx, esi
		call	sub_1000F26C
		mov	edi, [esp+2Ch+var_18]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	ecx, edi
		call	sub_1000F26C
		add	esp, 8

loc_1000F43E:				; CODE XREF: sub_1000F349+115j
		push	[esp+28h+var_14]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000F465
		add	[esp+28h+var_C], 2
		dec	ebx
		cmp	ebx, esi
		jge	short loc_1000F43E
		jmp	loc_1000F398
; ---------------------------------------------------------------------------

loc_1000F465:				; CODE XREF: sub_1000F349+10Bj
		mov	eax, [esp+28h+var_C]
		sub	eax, edi
		sar	eax, 1
		add	eax, esi
		jmp	short loc_1000F414
; ---------------------------------------------------------------------------

loc_1000F471:				; CODE XREF: sub_1000F349+Dj
					; sub_1000F349+16j
		push	2
		pop	eax

loc_1000F474:				; CODE XREF: sub_1000F349+52j
					; sub_1000F349+D0j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_1000F349	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F47C	proc near		; CODE XREF: sub_1000F29C+33p
					; sub_1000F6D9+1Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= word ptr  0Ch

		mov	edx, ecx
		push	esi
		push	edi
		mov	eax, [edx+4]
		mov	esi, [edx]
		sub	eax, esi
		cmp	eax, 18h
		jnb	short loc_1000F490
		xor	eax, eax
		jmp	short loc_1000F4C0
; ---------------------------------------------------------------------------

loc_1000F490:				; CODE XREF: sub_1000F47C+Ej
		test	esi, esi
		jz	short loc_1000F49F
		push	6
		pop	ecx
		xor	eax, eax
		mov	edi, esi
		rep stosd
		jmp	short loc_1000F4A1
; ---------------------------------------------------------------------------

loc_1000F49F:				; CODE XREF: sub_1000F47C+16j
		xor	esi, esi

loc_1000F4A1:				; CODE XREF: sub_1000F47C+21j
		add	dword ptr [edx], 18h
		mov	ecx, [esp+8+arg_0]
		push	[esp+8+arg_4]
		mov	[esi], ecx
		mov	ecx, esi
		call	sub_1000F209
		mov	cx, [esp+8+arg_8]
		mov	eax, esi
		mov	[esi+4], cx

loc_1000F4C0:				; CODE XREF: sub_1000F47C+12j
		pop	edi
		pop	esi
		retn	0Ch
sub_1000F47C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F4C5	proc near		; CODE XREF: sub_1000F5ED+8Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		test	eax, eax
		jnz	short loc_1000F4D6

loc_1000F4D1:				; CODE XREF: sub_1000F4C5+23j
		push	2
		pop	eax
		jmp	short loc_1000F53D
; ---------------------------------------------------------------------------

loc_1000F4D6:				; CODE XREF: sub_1000F4C5+Aj
		movzx	ecx, word ptr [edi+4]
		xor	edx, edx
		test	cx, cx
		js	short loc_1000F4ED
		movsx	ecx, cx
		cmp	ecx, [esp+8+arg_4]
		jnb	short loc_1000F4D1
		lea	edx, [eax+ecx*8]

loc_1000F4ED:				; CODE XREF: sub_1000F4C5+1Aj
		mov	esi, [esp+8+arg_8]
		mov	ecx, edi
		push	esi
		push	edx
		call	sub_1000F542
		movzx	ecx, word ptr [edi+6]
		xor	edx, edx
		cmp	dx, cx
		jz	short loc_1000F53D
		test	cl, 1
		jz	short loc_1000F522
		test	eax, eax
		jnz	short loc_1000F511
		inc	eax
		jmp	short loc_1000F522
; ---------------------------------------------------------------------------

loc_1000F511:				; CODE XREF: sub_1000F4C5+47j
		cmp	eax, 1
		jnz	short loc_1000F51A
		xor	eax, eax
		jmp	short loc_1000F522
; ---------------------------------------------------------------------------

loc_1000F51A:				; CODE XREF: sub_1000F4C5+4Fj
		cmp	eax, 2
		jz	short loc_1000F522
		push	2
		pop	eax

loc_1000F522:				; CODE XREF: sub_1000F4C5+43j
					; sub_1000F4C5+4Aj ...
		test	esi, esi
		jz	short loc_1000F53D
		test	cl, 2
		jz	short loc_1000F530
		and	[esi], edx
		and	[esi+4], edx

loc_1000F530:				; CODE XREF: sub_1000F4C5+64j
		test	byte ptr [edi+6], 4
		jz	short loc_1000F53D
		mov	dword ptr [esi+4], 4

loc_1000F53D:				; CODE XREF: sub_1000F4C5+Fj
					; sub_1000F4C5+3Ej ...
		pop	edi
		pop	esi
		retn	0Ch
sub_1000F4C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F542	proc near		; CODE XREF: sub_1000F4C5+30p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		xor	edx, edx
		mov	eax, [esi]
		sub	eax, edx
		jz	loc_1000F5E4
		dec	eax
		jz	loc_1000F5E0
		dec	eax
		jz	short loc_1000F5C0
		dec	eax
		jz	short loc_1000F59C
		dec	eax
		jz	short loc_1000F583
		dec	eax
		jz	short loc_1000F575
		dec	eax
		jz	short loc_1000F570
		push	2
		pop	eax
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F570:				; CODE XREF: sub_1000F542+27j
		mov	eax, [esi+8]
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F575:				; CODE XREF: sub_1000F542+24j
		push	[ebp+arg_4]
		mov	edx, [ebp+arg_0]
		call	sub_1000F349
		pop	ecx
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F583:				; CODE XREF: sub_1000F542+21j
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jnz	short loc_1000F5DC
		mov	eax, [eax+4]
		mov	ecx, [esi+8]
		and	ecx, [eax]
		neg	ecx
		sbb	ecx, ecx
		inc	ecx
		jmp	short loc_1000F5DC
; ---------------------------------------------------------------------------

loc_1000F59C:				; CODE XREF: sub_1000F542+1Ej
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jnz	short loc_1000F5BA
		mov	eax, [eax+4]
		mov	eax, [eax]
		cmp	[esi+8], eax
		ja	short loc_1000F5B5
		cmp	[esi+0Ch], eax
		jnb	short loc_1000F5BC

loc_1000F5B5:				; CODE XREF: sub_1000F542+6Cj
		xor	edx, edx
		inc	edx
		jmp	short loc_1000F5BC
; ---------------------------------------------------------------------------

loc_1000F5BA:				; CODE XREF: sub_1000F542+62j
		mov	edx, ecx

loc_1000F5BC:				; CODE XREF: sub_1000F542+71j
					; sub_1000F542+76j
		mov	eax, edx
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F5C0:				; CODE XREF: sub_1000F542+1Bj
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jz	short loc_1000F5CF
		cmp	dword ptr [eax], 4
		jnz	short loc_1000F5DC

loc_1000F5CF:				; CODE XREF: sub_1000F542+86j
		mov	eax, [eax+4]
		xor	ecx, ecx
		mov	eax, [eax]
		cmp	[esi+8], eax
		setnz	cl

loc_1000F5DC:				; CODE XREF: sub_1000F542+49j
					; sub_1000F542+58j ...
		mov	eax, ecx
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F5E0:				; CODE XREF: sub_1000F542+14j
		xor	eax, eax
		jmp	short loc_1000F5E7
; ---------------------------------------------------------------------------

loc_1000F5E4:				; CODE XREF: sub_1000F542+Dj
		xor	eax, eax
		inc	eax

loc_1000F5E7:				; CODE XREF: sub_1000F542+2Cj
					; sub_1000F542+31j ...
		pop	esi
		pop	ecx
		pop	ebp
		retn	8
sub_1000F542	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F5ED	proc near		; CODE XREF: sub_10010153+66p
					; sub_10015057+57p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 14h
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+8]
		test	eax, eax
		jz	loc_1000F6CE
		xor	edx, edx
		cmp	[eax], edx
		jz	loc_1000F6CE
		mov	[esi], edx
		mov	ecx, edx
		mov	dword ptr [esi+4], 1
		mov	bh, dl
		mov	eax, [eax]
		mov	bl, dl
		mov	[esp+20h+var_8], edx
		mov	edi, edx
		mov	[esp+20h+var_4], ecx
		mov	[esp+20h+var_C], eax
		test	eax, eax
		jz	loc_1000F6CE
		mov	[esp+20h+var_10], edx

loc_1000F63B:				; CODE XREF: sub_1000F5ED+CCj
		mov	eax, [esi+8]
		add	edx, eax
		test	bl, bl
		jz	short loc_1000F669
		cmp	dword ptr [edx+4], 6
		jnz	short loc_1000F661
		and	[esp+20h+var_8], 0
		mov	eax, ecx
		xor	ecx, ecx
		xor	bl, bl
		cmp	eax, 4
		mov	[esp+20h+var_4], ecx
		setnz	al
		jmp	short loc_1000F665
; ---------------------------------------------------------------------------

loc_1000F661:				; CODE XREF: sub_1000F5ED+5Bj
		mov	bl, 1
		mov	al, bl

loc_1000F665:				; CODE XREF: sub_1000F5ED+72j
		test	al, al
		jnz	short loc_1000F6A9

loc_1000F669:				; CODE XREF: sub_1000F5ED+55j
		lea	eax, [esp+20h+var_8]
		push	eax
		push	[ebp+arg_8]
		lea	ecx, [edx+4]
		push	[ebp+arg_4]
		call	sub_1000F4C5
		mov	ecx, eax
		sub	eax, 0
		jz	short loc_1000F69C
		dec	eax
		jz	short loc_1000F68F
		dec	eax
		jnz	short loc_1000F6C4
		mov	ecx, [esp+20h+var_4]
		jmp	short loc_1000F6A9
; ---------------------------------------------------------------------------

loc_1000F68F:				; CODE XREF: sub_1000F5ED+97j
		mov	ecx, [esp+20h+var_4]
		xor	bh, bh
		cmp	ecx, 4
		jz	short loc_1000F6A9
		jmp	short loc_1000F6A7
; ---------------------------------------------------------------------------

loc_1000F69C:				; CODE XREF: sub_1000F5ED+94j
		mov	ecx, [esp+20h+var_4]
		mov	bh, 1
		cmp	ecx, 4
		jnz	short loc_1000F6A9

loc_1000F6A7:				; CODE XREF: sub_1000F5ED+ADj
		mov	bl, 1

loc_1000F6A9:				; CODE XREF: sub_1000F5ED+7Aj
					; sub_1000F5ED+A0j ...
		mov	edx, [esp+20h+var_10]
		inc	edi
		add	edx, 18h
		mov	[esp+20h+var_10], edx
		cmp	edi, [esp+20h+var_C]
		jnz	short loc_1000F63B
		test	bh, bh
		jz	short loc_1000F6CE
		push	2
		pop	eax
		jmp	short loc_1000F6D0
; ---------------------------------------------------------------------------

loc_1000F6C4:				; CODE XREF: sub_1000F5ED+9Aj
		xor	eax, eax
		mov	[esi], edi
		mov	[esi+4], ecx
		inc	eax
		jmp	short loc_1000F6D0
; ---------------------------------------------------------------------------

loc_1000F6CE:				; CODE XREF: sub_1000F5ED+13j
					; sub_1000F5ED+1Dj ...
		xor	eax, eax

loc_1000F6D0:				; CODE XREF: sub_1000F5ED+D5j
					; sub_1000F5ED+DFj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000F5ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F6D9	proc near		; CODE XREF: sub_1000B390+15Fp
					; sub_1000B390+191p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_4]
		mov	ebx, ecx
		push	edi
		xor	edi, edi
		cmp	byte ptr [esi+0Ch], 0
		jnz	short loc_1000F70C
		mov	ecx, [esi+4]
		mov	ebp, [esi+8]
		push	edi
		push	edi
		push	6
		call	sub_1000F47C
		test	eax, eax
		jz	short loc_1000F747
		mov	[eax+8], ebp
		mov	eax, [esi]
		inc	dword ptr [eax]
		mov	byte ptr [esi+0Ch], 1

loc_1000F70C:				; CODE XREF: sub_1000F6D9+13j
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000F723
		push	esi
		mov	ecx, eax
		call	sub_1000F9BE
		mov	edi, eax

loc_1000F723:				; CODE XREF: sub_1000F6D9+3Ej
		mov	ecx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_8], ecx
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		mov	ecx, ebx
		mov	[esp+20h+var_C], edi
		call	sub_1000FDA5
		mov	al, 1

loc_1000F73D:				; CODE XREF: sub_1000F6D9+70j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	8
; ---------------------------------------------------------------------------

loc_1000F747:				; CODE XREF: sub_1000F6D9+26j
		xor	al, al
		jmp	short loc_1000F73D
sub_1000F6D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F74B	proc near		; CODE XREF: sub_10014EB0+15p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 2Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	1Ch
		mov	esi, ecx
		xor	ebx, ebx
		pop	ebp
		push	ebp
		mov	[esp+40h+var_20], esi
		mov	[esp+40h+var_C], ebx
		mov	[esp+40h+var_8], ebx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000F779

loc_1000F773:				; CODE XREF: sub_1000F74B+8Ej
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000F779:				; CODE XREF: sub_1000F74B+26j
		lea	eax, [ecx+4]
		mov	[ecx], ecx
		test	eax, eax
		jz	short loc_1000F784
		mov	[eax], ecx

loc_1000F784:				; CODE XREF: sub_1000F74B+35j
		lea	eax, [ecx+8]
		test	eax, eax
		jz	short loc_1000F78D
		mov	[eax], ecx

loc_1000F78D:				; CODE XREF: sub_1000F74B+3Ej
		mov	word ptr [ecx+0Ch], 101h
		mov	eax, [esi]
		mov	[esp+3Ch+var_C], ecx
		mov	edi, [eax]
		cmp	edi, eax
		jz	loc_1000F88D

loc_1000F7A3:				; CODE XREF: sub_1000F74B+132j
		mov	edx, [edi+0Ch]
		mov	esi, ecx
		mov	[esp+3Ch+var_14], edx
		mov	eax, [ecx+4]
		jmp	short loc_1000F7BF
; ---------------------------------------------------------------------------

loc_1000F7B1:				; CODE XREF: sub_1000F74B+77j
		cmp	[eax+10h], edx
		jnb	short loc_1000F7BB
		mov	eax, [eax+8]
		jmp	short loc_1000F7BF
; ---------------------------------------------------------------------------

loc_1000F7BB:				; CODE XREF: sub_1000F74B+69j
		mov	esi, eax
		mov	eax, [eax]

loc_1000F7BF:				; CODE XREF: sub_1000F74B+64j
					; sub_1000F74B+6Ej
		cmp	[eax+0Dh], bl
		jz	short loc_1000F7B1
		cmp	esi, ecx
		jz	short loc_1000F7CD
		cmp	edx, [esi+10h]
		jnb	short loc_1000F835

loc_1000F7CD:				; CODE XREF: sub_1000F74B+7Bj
		push	ebp
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebp, eax
		pop	ecx
		test	ebp, ebp
		jz	short loc_1000F773
		mov	eax, [esp+3Ch+var_C]
		lea	ecx, [ebp+4]
		mov	[ebp+0], eax
		test	ecx, ecx
		jz	short loc_1000F7EF
		mov	eax, [esp+3Ch+var_C]
		mov	[ecx], eax

loc_1000F7EF:				; CODE XREF: sub_1000F74B+9Cj
		lea	ecx, [ebp+8]
		test	ecx, ecx
		jz	short loc_1000F7FC
		mov	eax, [esp+3Ch+var_C]
		mov	[ecx], eax

loc_1000F7FC:				; CODE XREF: sub_1000F74B+A9j
		lea	ecx, [ebp+10h]
		mov	[ebp+0Ch], bx
		test	ecx, ecx
		jz	short loc_1000F820
		mov	eax, [esp+3Ch+var_14]
		push	ebx
		mov	[ecx], eax
		push	ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		call	sub_1000916C
		lea	ecx, [ebp+10h]
		mov	[ecx+4], eax

loc_1000F820:				; CODE XREF: sub_1000F74B+BAj
		push	ebp
		push	ecx
		push	esi
		lea	eax, [esp+48h+var_18]
		push	eax
		lea	ecx, [esp+4Ch+var_C]
		call	sub_1000FE5F
		mov	esi, [esp+3Ch+var_18]

loc_1000F835:				; CODE XREF: sub_1000F74B+80j
		mov	ebp, [esi+14h]
		push	dword ptr [ebp+4]
		push	ebp
		call	sub_1000916C
		mov	ecx, eax
		lea	edx, [ecx+8]
		test	edx, edx
		jz	short loc_1000F84F
		mov	eax, [edi+8]
		mov	[edx], eax

loc_1000F84F:				; CODE XREF: sub_1000F74B+FDj
		mov	edx, [esi+18h]
		mov	eax, 15555554h
		sub	eax, edx
		cmp	eax, 1
		jb	short loc_1000F882
		lea	eax, [edx+1]
		mov	[esi+18h], eax
		mov	esi, [esp+3Ch+var_20]
		mov	[ebp+4], ecx
		mov	eax, [ecx+4]
		mov	[eax], ecx
		mov	edi, [edi]
		mov	ecx, [esp+3Ch+var_C]
		cmp	edi, [esi]
		jz	short loc_1000F88D
		push	1Ch
		pop	ebp
		jmp	loc_1000F7A3
; ---------------------------------------------------------------------------

loc_1000F882:				; CODE XREF: sub_1000F74B+111j
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000F88D:				; CODE XREF: sub_1000F74B+52j
					; sub_1000F74B+12Dj
		mov	eax, [esi+8]
		mov	ebp, [eax+80h]
		lea	esi, [eax+84h]
		mov	[esp+3Ch+var_24], esi
		lea	eax, [esi+ebp]
		mov	[esp+3Ch+var_28], eax
		mov	eax, [ecx]
		mov	[esp+3Ch+var_14], eax
		cmp	eax, ecx
		jz	loc_1000F961

loc_1000F8B5:				; CODE XREF: sub_1000F74B+210j
		mov	edx, [eax+10h]
		cmp	edx, 20h
		jnb	loc_1000F963
		mov	ecx, [esp+3Ch+var_20]
		mov	ecx, [ecx+8]
		mov	[ecx+edx*4], esi
		mov	ecx, ebx
		mov	edi, [eax+14h]
		mov	esi, [edi]
		jmp	short loc_1000F927
; ---------------------------------------------------------------------------

loc_1000F8D4:				; CODE XREF: sub_1000F74B+1E2j
		mov	eax, [esi+8]
		mov	eax, [eax]
		mov	eax, [eax]
		imul	edx, eax, 18h
		mov	[esp+3Ch+var_10], eax
		cmp	ebp, edx
		jb	short loc_1000F963
		mov	eax, ebp
		sub	eax, edx
		mov	[esp+3Ch+var_1C], eax
		lea	eax, [esp+3Ch+var_1C]
		push	eax
		push	[esp+40h+var_28]
		imul	eax, ecx, 18h
		mov	ecx, [esp+44h+var_24]
		add	ecx, 4
		push	edx
		add	eax, ecx
		mov	ecx, [esi+8]
		push	eax
		call	sub_1000FCCE
		test	al, al
		jz	short loc_1000F963
		mov	ecx, [esp+3Ch+var_18]
		mov	eax, ebp
		sub	eax, [esp+3Ch+var_1C]
		sub	[esp+3Ch+var_28], eax
		sub	ebp, eax
		add	ecx, [esp+3Ch+var_10]
		mov	esi, [esi]

loc_1000F927:				; CODE XREF: sub_1000F74B+187j
		mov	[esp+3Ch+var_18], ecx
		cmp	esi, edi
		jnz	short loc_1000F8D4
		mov	esi, [esp+3Ch+var_24]
		xor	edx, edx
		imul	eax, ecx, 18h
		push	1Ch
		add	[esi], ecx
		pop	ecx
		div	ecx
		add	esi, ecx
		lea	ecx, [esp+3Ch+var_14]
		imul	eax, 1Ch
		add	esi, eax
		mov	[esp+3Ch+var_24], esi
		call	sub_10004B74
		mov	eax, [esp+3Ch+var_14]
		cmp	eax, [esp+3Ch+var_C]
		jnz	loc_1000F8B5

loc_1000F961:				; CODE XREF: sub_1000F74B+164j
		mov	bl, 1

loc_1000F963:				; CODE XREF: sub_1000F74B+170j
					; sub_1000F74B+199j ...
		lea	ecx, [esp+3Ch+var_C]
		call	sub_1000FDFA
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 2Ch
		retn
sub_1000F74B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F976	proc near		; CODE XREF: sub_1000B390+AAp
					; sub_1000B390+B5p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	101Ch
		mov	[esi+8], eax
		mov	byte ptr [esi+0Ch], 0
		call	sub_10018CA2
		mov	[esi], eax
		push	8
		and	dword ptr [eax], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1000F9B3
		mov	ecx, [esi]
		add	ecx, 4
		mov	[eax], ecx
		add	ecx, 1018h
		mov	[eax+4], ecx
		jmp	short loc_1000F9B5
; ---------------------------------------------------------------------------

loc_1000F9B3:				; CODE XREF: sub_1000F976+29j
		xor	eax, eax

loc_1000F9B5:				; CODE XREF: sub_1000F976+3Bj
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_1000F976	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F9BE	proc near		; CODE XREF: sub_1000F6D9+43p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		cmp	esi, edi
		jz	short loc_1000FA1E
		mov	eax, [edi+8]
		push	ebx
		mov	[esi+8], eax
		mov	ebx, 101Ch
		mov	al, [edi+0Ch]
		push	ebx
		mov	[esi+0Ch], al
		call	sub_10018CA2
		push	ebx		; Size
		mov	[esi], eax
		push	dword ptr [edi]	; Src
		push	eax		; Dst
		call	memcpy
		mov	ecx, [esi]
		push	8
		imul	eax, [ecx], 18h
		lea	ebx, [ecx+4]
		add	ebx, eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000FA18
		mov	ecx, [edi+4]
		mov	edx, [ecx+4]
		sub	edx, [ecx]
		mov	[eax], ebx
		lea	ecx, [edx+ebx]
		mov	[eax+4], ecx
		jmp	short loc_1000FA1A
; ---------------------------------------------------------------------------

loc_1000FA18:				; CODE XREF: sub_1000F9BE+46j
		xor	eax, eax

loc_1000FA1A:				; CODE XREF: sub_1000F9BE+58j
		mov	[esi+4], eax
		pop	ebx

loc_1000FA1E:				; CODE XREF: sub_1000F9BE+Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn	4
sub_1000F9BE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FA25	proc near		; CODE XREF: sub_1000FB2D+7Ep
					; sub_1000FB2D+D0p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	dl, [esp+arg_10]
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	ebx, ecx
		mov	eax, ebp
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_1000FA45
		mov	eax, [esp+10h+arg_0]
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 3
		jmp	short loc_1000FA4F
; ---------------------------------------------------------------------------

loc_1000FA45:				; CODE XREF: sub_1000FA25+10j
		cmp	[esp+10h+arg_0], 1
		jnz	short loc_1000FA4F
		push	5
		pop	eax

loc_1000FA4F:				; CODE XREF: sub_1000FA25+1Ej
					; sub_1000FA25+25j
		mov	edi, [esp+10h+arg_18]
		cmp	[edi+10h], ebp
		jnz	short loc_1000FA7F
		test	dl, dl
		jz	loc_1000FB24
		mov	edx, [ebx]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_1000FB24
		imul	ecx, 18h
		push	eax
		add	ecx, 0FFFFFFECh
		add	ecx, edx
		call	sub_1000F209
		jmp	loc_1000FB24
; ---------------------------------------------------------------------------

loc_1000FA7F:				; CODE XREF: sub_1000FA25+31j
		cmp	[esp+10h+arg_C], 1
		jnz	short loc_1000FAB8
		test	dl, dl
		jz	short loc_1000FAA3
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FA94
		mov	ecx, [edi]
		jmp	short loc_1000FA96
; ---------------------------------------------------------------------------

loc_1000FA94:				; CODE XREF: sub_1000FA25+69j
		mov	ecx, edi

loc_1000FA96:				; CODE XREF: sub_1000FA25+6Dj
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFh

loc_1000FAA0:				; CODE XREF: sub_1000FA25+91j
		push	ecx
		jmp	short loc_1000FAFF
; ---------------------------------------------------------------------------

loc_1000FAA3:				; CODE XREF: sub_1000FA25+63j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FAAD
		mov	ecx, [edi]
		jmp	short loc_1000FAAF
; ---------------------------------------------------------------------------

loc_1000FAAD:				; CODE XREF: sub_1000FA25+82j
		mov	ecx, edi

loc_1000FAAF:				; CODE XREF: sub_1000FA25+86j
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFFFFh
		jmp	short loc_1000FAA0
; ---------------------------------------------------------------------------

loc_1000FAB8:				; CODE XREF: sub_1000FA25+5Fj
		cmp	[esp+10h+arg_C], 2
		jnz	short loc_1000FAE4
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FAC9
		mov	ecx, [edi]
		jmp	short loc_1000FACB
; ---------------------------------------------------------------------------

loc_1000FAC9:				; CODE XREF: sub_1000FA25+9Ej
		mov	ecx, edi

loc_1000FACB:				; CODE XREF: sub_1000FA25+A2j
		mov	esi, [esp+10h+arg_14]
		push	eax		; int
		push	[esp+14h+arg_4]	; int
		push	dword ptr [esi]	; int
		push	ecx		; lpString
		push	ecx		; int
		mov	ecx, [ebx+4]
		call	sub_1000F29C
		mov	[esi], ebp
		jmp	short loc_1000FB08
; ---------------------------------------------------------------------------

loc_1000FAE4:				; CODE XREF: sub_1000FA25+98j
		mov	ecx, [esp+10h+arg_4]
		test	dl, dl
		jz	short loc_1000FAEF
		or	ecx, 2

loc_1000FAEF:				; CODE XREF: sub_1000FA25+C5j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FAF9
		mov	edx, [edi]
		jmp	short loc_1000FAFB
; ---------------------------------------------------------------------------

loc_1000FAF9:				; CODE XREF: sub_1000FA25+CEj
		mov	edx, edi

loc_1000FAFB:				; CODE XREF: sub_1000FA25+D2j
		push	eax		; int
		push	ecx		; int
		push	ebp		; int
		push	edx		; lpString

loc_1000FAFF:				; CODE XREF: sub_1000FA25+7Cj
		push	ecx		; int
		mov	ecx, [ebx+4]
		call	sub_1000F29C

loc_1000FB08:				; CODE XREF: sub_1000FA25+BDj
		test	eax, eax
		jnz	short loc_1000FB10
		xor	al, al
		jmp	short loc_1000FB26
; ---------------------------------------------------------------------------

loc_1000FB10:				; CODE XREF: sub_1000FA25+E5j
		mov	eax, [ebx]
		inc	dword ptr [eax]
		cmp	dword ptr [edi+14h], 8
		mov	[edi+10h], ebp
		jb	short loc_1000FB1F
		mov	edi, [edi]

loc_1000FB1F:				; CODE XREF: sub_1000FA25+F6j
		xor	eax, eax
		mov	[edi], ax

loc_1000FB24:				; CODE XREF: sub_1000FA25+35j
					; sub_1000FA25+41j ...
		mov	al, 1

loc_1000FB26:				; CODE XREF: sub_1000FA25+E9j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	1Ch
sub_1000FA25	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FB2D	proc near		; CODE XREF: sub_1000B390+149p
					; sub_1000B390+17Bp ...

var_24		= dword	ptr -24h
var_20		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+0Ch], 0
		jz	short loc_1000FB4E
		xor	al, al
		jmp	loc_1000FC50
; ---------------------------------------------------------------------------

loc_1000FB4E:				; CODE XREF: sub_1000FB2D+18j
		mov	esi, [esp+34h+arg_8]
		xor	eax, eax
		and	[esp+34h+var_24], eax
		xor	ecx, ecx
		and	[esp+34h+var_10], eax
		xor	ebx, ebx
		mov	[esp+34h+var_C], 7
		mov	[esp+34h+var_20], cx
		cmp	cx, [esi]
		jz	loc_1000FC1A
		push	3Fh
		pop	ebp

loc_1000FB79:				; CODE XREF: sub_1000FB2D+E7j
		movzx	ecx, word ptr [esi]
		cmp	ecx, 2Ah
		jz	short loc_1000FBE1
		cmp	ecx, 2Fh
		jz	short loc_1000FBC4
		cmp	ecx, ebp
		jnz	short loc_1000FBCD
		cmp	eax, 6
		jz	loc_1000FC3B
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	0
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA25
		test	al, al
		jz	loc_1000FC3B
		inc	[esp+34h+var_24]
		push	0Ah
		pop	eax
		push	2
		pop	ebx
		jmp	short loc_1000FC0C
; ---------------------------------------------------------------------------

loc_1000FBC4:				; CODE XREF: sub_1000FB2D+57j
		cmp	bp, [esi+2]
		jnz	short loc_1000FBCD
		add	esi, 2

loc_1000FBCD:				; CODE XREF: sub_1000FB2D+5Bj
					; sub_1000FB2D+9Bj
		movzx	eax, word ptr [esi]
		lea	ecx, [esp+34h+var_20]
		push	eax
		push	1
		call	sub_100030B4
		xor	eax, eax
		inc	eax
		jmp	short loc_1000FC0C
; ---------------------------------------------------------------------------

loc_1000FBE1:				; CODE XREF: sub_1000FB2D+52j
		test	al, 2
		jnz	short loc_1000FC3B
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	0
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA25
		test	al, al
		jz	short loc_1000FC3B
		push	6
		xor	ebx, ebx
		pop	eax
		inc	ebx

loc_1000FC0C:				; CODE XREF: sub_1000FB2D+95j
					; sub_1000FB2D+B2j
		add	esi, 2
		xor	ecx, ecx
		cmp	cx, [esi]
		jnz	loc_1000FB79

loc_1000FC1A:				; CODE XREF: sub_1000FB2D+43j
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	1
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA25
		test	al, al
		jnz	short loc_1000FC3F

loc_1000FC3B:				; CODE XREF: sub_1000FB2D+60j
					; sub_1000FB2D+85j ...
		xor	bl, bl
		jmp	short loc_1000FC41
; ---------------------------------------------------------------------------

loc_1000FC3F:				; CODE XREF: sub_1000FB2D+10Cj
		mov	bl, 1

loc_1000FC41:				; CODE XREF: sub_1000FB2D+110j
		push	0
		push	1
		lea	ecx, [esp+3Ch+var_20]
		call	sub_100022FA
		mov	al, bl

loc_1000FC50:				; CODE XREF: sub_1000FB2D+1Cj
		mov	ecx, [esp+34h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	10h
sub_1000FB2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FC65	proc near		; CODE XREF: sub_1000B390+F8p
					; sub_1000B390+108p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		cmp	byte ptr [esi+0Ch], 0
		jz	short loc_1000FC76

loc_1000FC72:				; CODE XREF: sub_1000FC65+32j
					; sub_1000FC65+55j
		xor	al, al
		jmp	short loc_1000FCC8
; ---------------------------------------------------------------------------

loc_1000FC76:				; CODE XREF: sub_1000FC65+Bj
		xor	eax, eax
		cmp	[ebp+arg_0], 1
		setz	al
		cmp	[ebp+arg_C], 0
		jnz	short loc_1000FCA2
		push	[ebp+arg_4]
		mov	ecx, [esi+4]
		push	eax
		push	2
		call	sub_1000F47C
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_1000FC72
		mov	dword ptr [ecx+0Ch], 2
		jmp	short loc_1000FCBC
; ---------------------------------------------------------------------------

loc_1000FCA2:				; CODE XREF: sub_1000FC65+1Ej
		cmp	[ebp+arg_C], 1
		jnz	short loc_1000FCC2
		push	[ebp+arg_4]
		mov	ecx, [esi+4]
		push	eax
		push	4
		call	sub_1000F47C
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_1000FC72

loc_1000FCBC:				; CODE XREF: sub_1000FC65+3Bj
		mov	eax, [ebp+arg_8]
		mov	[ecx+8], eax

loc_1000FCC2:				; CODE XREF: sub_1000FC65+41j
		mov	ecx, [esi]
		mov	al, 1
		inc	dword ptr [ecx]

loc_1000FCC8:				; CODE XREF: sub_1000FC65+Fj
		pop	esi
		pop	ecx
		pop	ebp
		retn	10h
sub_1000FC65	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FCCE	proc near		; CODE XREF: sub_1000F74B+1BDp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		xor	ebx, ebx
		push	edi
		mov	[esp+1Ch+var_4], esi
		mov	eax, [esi]
		mov	eax, [eax]
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jz	loc_1000FD81
		mov	ebp, [esp+1Ch+arg_0]
		mov	ecx, ebx
		mov	eax, [esp+1Ch+arg_4]
		mov	edx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_8], ecx

loc_1000FCFF:				; CODE XREF: sub_1000FCCE+ADj
		cmp	eax, 18h
		jb	short loc_1000FD7D
		mov	eax, [esi]
		add	ecx, 4
		add	eax, ecx
		mov	edi, ebp
		push	6
		pop	ecx
		mov	esi, eax
		mov	[esp+1Ch+arg_0], eax
		rep movsd
		cmp	dword ptr [eax], 5
		jnz	short loc_1000FD59
		mov	edx, [esp+1Ch+arg_C]
		mov	eax, [eax+0Ch]
		add	eax, eax
		mov	ecx, [edx]
		cmp	ecx, eax
		jb	short loc_1000FD7D
		mov	esi, [esp+1Ch+arg_8]
		sub	ecx, eax
		mov	[edx], ecx
		sub	esi, eax
		mov	ecx, [esp+1Ch+arg_0]
		push	eax		; Size
		mov	[esp+20h+arg_8], esi
		mov	eax, [ecx+8]
		add	eax, ecx
		push	eax		; Src
		push	esi		; Dst
		call	memcpy
		mov	edx, [esp+28h+var_C]
		mov	eax, esi
		add	esp, 0Ch
		sub	eax, ebp
		mov	[ebp+8], eax

loc_1000FD59:				; CODE XREF: sub_1000FCCE+4Dj
		mov	eax, [esp+1Ch+arg_4]
		add	ebp, 18h
		mov	ecx, [esp+1Ch+var_8]
		sub	eax, 18h
		inc	ebx
		mov	[esp+1Ch+arg_4], eax
		add	ecx, 18h
		mov	[esp+1Ch+var_8], ecx
		cmp	ebx, edx
		jz	short loc_1000FD81
		mov	esi, [esp+1Ch+var_4]
		jmp	short loc_1000FCFF
; ---------------------------------------------------------------------------

loc_1000FD7D:				; CODE XREF: sub_1000FCCE+34j
					; sub_1000FCCE+5Cj
		xor	al, al
		jmp	short loc_1000FD83
; ---------------------------------------------------------------------------

loc_1000FD81:				; CODE XREF: sub_1000FCCE+19j
					; sub_1000FCCE+A7j
		mov	al, 1

loc_1000FD83:				; CODE XREF: sub_1000FCCE+B1j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	10h
sub_1000FCCE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FD8D	proc near		; CODE XREF: sub_1000B390+222p
					; sub_1000B390+22Bp ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		push	dword ptr [esi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ecx
		pop	esi
		retn
sub_1000FD8D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FDA5	proc near		; CODE XREF: sub_1000F6D9+5Dp
					; sub_10017EF6+4Dp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, [edi]
		push	dword ptr [ebx+4]
		push	ebx
		call	sub_10009139
		mov	esi, eax
		lea	eax, [esi+8]
		test	eax, eax
		jz	short loc_1000FDCC
		mov	edx, [esp+0Ch+arg_0]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx

loc_1000FDCC:				; CODE XREF: sub_1000FDA5+17j
		mov	ecx, [edi+4]
		mov	eax, 0FFFFFFEh
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_1000FDE6
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000FDE6:				; CODE XREF: sub_1000FDA5+34j
		lea	eax, [ecx+1]
		mov	[edi+4], eax
		mov	[ebx+4], esi
		mov	eax, [esi+4]
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebx
		retn	4
sub_1000FDA5	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FDFA	proc near		; CODE XREF: sub_1000F74B+21Cp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000FE24
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000FDFA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FE24	proc near		; CODE XREF: sub_1000FDFA+8p
					; sub_1000FE24+16p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000FE59

loc_1000FE35:				; CODE XREF: sub_1000FE24+33j
		push	dword ptr [edi+8]
		mov	ecx, ebx
		call	sub_1000FE24
		mov	edi, [edi]
		lea	ecx, [esi+14h]
		call	sub_10008CED
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000FE35

loc_1000FE59:				; CODE XREF: sub_1000FE24+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000FE24	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FE5F	proc near		; CODE XREF: sub_1000F74B+E1p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_1000FE8B
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_1000FF72
		mov	eax, [esp+10h+arg_0]
		jmp	loc_1000FF6B
; ---------------------------------------------------------------------------

loc_1000FE8B:				; CODE XREF: sub_1000FE5F+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_1000FEB3
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_1000FF4E
		push	[esp+1Ch+arg_C]
		push	ecx

loc_1000FEAD:				; CODE XREF: sub_1000FE5F+A0j
		push	esi
		jmp	loc_1000FF3D
; ---------------------------------------------------------------------------

loc_1000FEB3:				; CODE XREF: sub_1000FE5F+3Cj
		cmp	esi, ebp
		jnz	short loc_1000FED0
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_1000FF4E
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_1000FF3F
; ---------------------------------------------------------------------------

loc_1000FED0:				; CODE XREF: sub_1000FE5F+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_1000FF09
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EDC
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_1000FF04
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000FEAD
		push	eax
		jmp	short loc_1000FF38
; ---------------------------------------------------------------------------

loc_1000FF04:				; CODE XREF: sub_1000FE5F+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_1000FF09:				; CODE XREF: sub_1000FE5F+76j
		jnb	short loc_1000FF4E
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B74
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_1000FF27
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_1000FF4E

loc_1000FF27:				; CODE XREF: sub_1000FE5F+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000FF3C
		push	esi

loc_1000FF38:				; CODE XREF: sub_1000FE5F+A3j
		push	0
		jmp	short loc_1000FF3F
; ---------------------------------------------------------------------------

loc_1000FF3C:				; CODE XREF: sub_1000FE5F+D6j
		push	eax

loc_1000FF3D:				; CODE XREF: sub_1000FE5F+4Fj
		push	1

loc_1000FF3F:				; CODE XREF: sub_1000FE5F+6Fj
					; sub_1000FE5F+DBj
		push	[esp+2Ch+arg_0]
		call	sub_1000FF72
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_1000FF68
; ---------------------------------------------------------------------------

loc_1000FF4E:				; CODE XREF: sub_1000FE5F+43j
					; sub_1000FE5F+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_1001009F
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_1000FF68:				; CODE XREF: sub_1000FE5F+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_1000FF6B:				; CODE XREF: sub_1000FE5F+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_1000FE5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FF72	proc near		; CODE XREF: sub_1000FE5F+1Ep
					; sub_1000FE5F+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_1000FFA3
		mov	esi, [ebp+arg_10]
		lea	ecx, [esi+14h]
		call	sub_10008CED
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000FFA3:				; CODE XREF: sub_1000FF72+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000FFC4
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000FFE3
; ---------------------------------------------------------------------------

loc_1000FFC4:				; CODE XREF: sub_1000FF72+42j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000FFD6
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000FFE3
		mov	[ecx], edi
		jmp	short loc_1000FFE3
; ---------------------------------------------------------------------------

loc_1000FFD6:				; CODE XREF: sub_1000FF72+56j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000FFE3
		mov	[ecx+8], edi

loc_1000FFE3:				; CODE XREF: sub_1000FF72+50j
					; sub_1000FF72+5Ej ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10010080
; ---------------------------------------------------------------------------

loc_1000FFED:				; CODE XREF: sub_1000FF72+112j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10010031
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10010037
		cmp	esi, [eax+8]
		jnz	short loc_10010011
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004AF0

loc_10010011:				; CODE XREF: sub_1000FF72+93j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B31
		jmp	short loc_1001007D
; ---------------------------------------------------------------------------

loc_10010031:				; CODE XREF: sub_1000FF72+85j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10010051

loc_10010037:				; CODE XREF: sub_1000FF72+8Ej
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1001007D
; ---------------------------------------------------------------------------

loc_10010051:				; CODE XREF: sub_1000FF72+C3j
		cmp	esi, [eax]
		jnz	short loc_1001005F
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B31

loc_1001005F:				; CODE XREF: sub_1000FF72+E1j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004AF0

loc_1001007D:				; CODE XREF: sub_1000FF72+BDj
					; sub_1000FF72+DDj
		mov	eax, [esi+4]

loc_10010080:				; CODE XREF: sub_1000FF72+76j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000FFED
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000FF72	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001009F	proc near		; CODE XREF: sub_1000FE5F+FCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100100DD
		mov	esi, [ebx]

loc_100100C0:				; CODE XREF: sub_1001009F+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_100100D4
		mov	eax, [eax]
		jmp	short loc_100100D7
; ---------------------------------------------------------------------------

loc_100100D4:				; CODE XREF: sub_1001009F+2Fj
		mov	eax, [eax+8]

loc_100100D7:				; CODE XREF: sub_1001009F+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_100100C0

loc_100100DD:				; CODE XREF: sub_1001009F+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_1001011A
		cmp	edi, [ecx]
		jnz	short loc_1001010D
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_100100F3:				; CODE XREF: sub_1001009F+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_1000FF72
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1001014B
; ---------------------------------------------------------------------------

loc_1001010D:				; CODE XREF: sub_1001009F+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EDC
		mov	esi, [esp+14h+arg_8]

loc_1001011A:				; CODE XREF: sub_1001009F+46j
		mov	eax, [esi+10h]
		cmp	eax, [ebx]
		jnb	short loc_1001012D
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_100100F3
; ---------------------------------------------------------------------------

loc_1001012D:				; CODE XREF: sub_1001009F+80j
		mov	edi, [esp+14h+arg_C]
		lea	ecx, [edi+14h]
		call	sub_10008CED
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1001014B:				; CODE XREF: sub_1001009F+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1001009F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010153	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+122p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+10Dp	...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 20h
		jnb	short loc_100101CE
		mov	edx, dword_10031DEC
		cmp	dword ptr [edx+ecx*4], 0
		jz	short loc_100101CE
		mov	eax, [edx+ecx*4]
		mov	edi, dword_10031DEC
		mov	ecx, [edx+80h]
		add	edi, eax
		cmp	eax, ecx
		ja	short loc_100101CE
		cmp	g_shared_policy_size, ecx
		jb	short loc_100101CE
		xor	eax, eax
		cmp	[esi], eax
		jle	short loc_100101A2
		lea	ecx, [esi+4]

loc_10010195:				; CODE XREF: sub_10010153+4Dj
		cmp	dword ptr [ecx], 0
		jz	short loc_100101CE
		inc	eax
		add	ecx, 8
		cmp	eax, [esi]
		jl	short loc_10010195

loc_100101A2:				; CODE XREF: sub_10010153+3Dj
		push	dword ptr [esi]
		and	[ebp+var_C], 0
		lea	eax, [esi+4]
		push	eax
		xor	ebx, ebx
		mov	[ebp+var_4], edi
		push	ecx
		inc	ebx
		lea	ecx, [ebp+var_C]
		mov	[ebp+var_8], ebx
		call	sub_1000F5ED
		cmp	eax, ebx
		jnz	short loc_100101C8
		cmp	[ebp+var_8], 3
		jz	short loc_100101CA

loc_100101C8:				; CODE XREF: sub_10010153+6Dj
		xor	ebx, ebx

loc_100101CA:				; CODE XREF: sub_10010153+73j
		mov	al, bl
		jmp	short loc_100101D0
; ---------------------------------------------------------------------------

loc_100101CE:				; CODE XREF: sub_10010153+Ej
					; sub_10010153+1Aj ...
		xor	al, al

loc_100101D0:				; CODE XREF: sub_10010153+79j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10010153	endp

; Exported entry  39. _TargetNtSetInformationThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationThread(x, x, x, x, x)
		public _TargetNtSetInformationThread@20
_TargetNtSetInformationThread@20 proc near ; DATA XREF:	sub_1000F0CA+8Do
					; .rdata:off_1002E058o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 2
		jg	short loc_10010214
		cmp	[ebp+arg_8], 5
		jnz	short loc_10010214
		cmp	[ebp+arg_C], 0
		jz	short loc_10010214
		cmp	[ebp+arg_10], 4
		jb	short loc_10010214
		mov	edx, [ebp+arg_C]
		lea	ecx, [ebp+var_4]
		push	4
		call	sub_10013EA4
		pop	ecx
		test	eax, eax
		js	short loc_10010214
		cmp	[ebp+var_4], 0
		jnz	short loc_10010214
		xor	eax, eax
		jmp	short loc_10010223
; ---------------------------------------------------------------------------

loc_10010214:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+Dj
					; TargetNtSetInformationThread(x,x,x,x,x)+13j ...
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]

loc_10010223:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+3Bj
		mov	esp, ebp
		pop	ebp
		retn	14h
_TargetNtSetInformationThread@20 endp

; Exported entry  34. _TargetNtOpenThreadToken@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadToken(x, x, x, x,	x)
		public _TargetNtOpenThreadToken@20
_TargetNtOpenThreadToken@20 proc near	; DATA XREF: sub_1000F0CA+B7o
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		call	sub_10013CB8
		push	[ebp+arg_10]
		cmp	dword ptr [eax+4], 2
		setle	al
		dec	al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	14h
_TargetNtOpenThreadToken@20 endp

; Exported entry  35. _TargetNtOpenThreadTokenEx@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadTokenEx(x, x, x, x, x, x)
		public _TargetNtOpenThreadTokenEx@24
_TargetNtOpenThreadTokenEx@24 proc near	; DATA XREF: sub_1000F0CA+10Eo
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		call	sub_10013CB8
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		cmp	dword ptr [eax+4], 2
		setle	al
		dec	al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	18h
_TargetNtOpenThreadTokenEx@24 endp


; =============== S U B	R O U T	I N E =======================================


sub_1001027A	proc near		; CODE XREF: sub_10017D76+141p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 14h
		push	ebx
		mov	ebx, dword_10031E1C
		push	ebp
		push	esi
		mov	esi, g_shared_delayed_mitigations
		push	edi
		push	ebx
		push	esi
		call	sub_10010668
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_100102A1

loc_1001029A:				; CODE XREF: sub_1001027A+73j
					; sub_1001027A+96j ...
		xor	al, al
		jmp	loc_10010498
; ---------------------------------------------------------------------------

loc_100102A1:				; CODE XREF: sub_1001027A+1Ej
		call	sub_100063BF
		push	offset aKernel32_dll_3 ; "kernel32.dll"
		mov	edi, [eax]
		mov	[esp+28h+var_4], edi
		call	ds:GetModuleHandleA
		cmp	edi, 3
		mov	ebp, eax
		mov	edi, ds:GetLastError
		jl	short loc_10010312
		and	ebx, 1
		xor	eax, eax
		or	eax, ebx
		jz	short loc_100102EF
		push	offset aSetdefaultdlld ; "SetDefaultDllDirectories"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_100102EF
		push	1000h
		call	eax
		test	eax, eax
		jnz	short loc_100102EF
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_1001029A

loc_100102EF:				; CODE XREF: sub_1001027A+51j
					; sub_1001027A+61j ...
		mov	eax, esi
		and	eax, 20h
		or	eax, 0
		jz	short loc_10010312
		push	0		; HeapInformationLength
		push	0		; HeapInformation
		push	1		; HeapInformationClass
		push	0		; HeapHandle
		call	ds:HeapSetInformation
		test	eax, eax
		jnz	short loc_10010312
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_1001029A

loc_10010312:				; CODE XREF: sub_1001027A+48j
					; sub_1001027A+7Dj ...
		mov	eax, esi
		and	eax, 1
		or	eax, 0
		jz	loc_100103AF
		xor	ebx, ebx
		mov	eax, esi
		inc	ebx
		cmp	[esp+24h+var_4], 3
		setnl	byte ptr [esp+24h+var_10+3]
		and	eax, 2
		or	eax, 0
		jz	short loc_1001033A
		push	3
		pop	ebx

loc_1001033A:				; CODE XREF: sub_1001027A+BBj
		push	offset aSetprocessdepp ; "SetProcessDEPPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10010364
		push	ebx
		call	eax
		test	eax, eax
		jnz	short loc_100103AF

loc_10010351:				; CODE XREF: sub_1001027A+133j
		call	edi ; GetLastError
		cmp	eax, 5
		jz	short loc_100103AF
		cmp	byte ptr [esp+24h+var_10+3], 0
		jz	short loc_100103AF
		jmp	loc_1001029A
; ---------------------------------------------------------------------------

loc_10010364:				; CODE XREF: sub_1001027A+CEj
		and	[esp+24h+var_C], 0
		lea	edx, [esp+24h+var_C]
		mov	ecx, offset aNtsetinforma_1 ; "NtSetInformationProcess"
		call	sub_1001881C
		cmp	[esp+24h+var_C], 0
		jz	loc_1001029A
		mov	[esp+24h+var_8], 0Ah
		test	bl, 2
		jnz	short loc_10010397
		mov	[esp+24h+var_8], 0Eh

loc_10010397:				; CODE XREF: sub_1001027A+113j
		push	4
		lea	eax, [esp+28h+var_8]
		push	eax
		push	22h
		call	ds:GetCurrentProcess
		push	eax
		call	[esp+34h+var_C]
		test	eax, eax
		js	short loc_10010351

loc_100103AF:				; CODE XREF: sub_1001027A+A0j
					; sub_1001027A+D5j ...
		cmp	[esp+24h+var_4], 5
		jl	loc_10010496
		push	offset aSetprocessmiti ; "SetProcessMitigationPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1001029A
		mov	eax, esi
		xor	ebp, ebp
		and	eax, 8
		or	eax, ebp
		jz	short loc_10010412
		mov	eax, esi
		and	eax, 10h
		or	eax, ebp
		jz	short loc_100103E9
		xor	eax, eax
		inc	eax
		jmp	short loc_100103EB
; ---------------------------------------------------------------------------

loc_100103E9:				; CODE XREF: sub_1001027A+168j
		mov	eax, ebp

loc_100103EB:				; CODE XREF: sub_1001027A+16Dj
		and	eax, 1
		shl	eax, 3
		or	eax, 2
		mov	[esp+24h+var_4], eax
		lea	eax, [esp+24h+var_4]
		push	4
		push	eax
		push	1
		call	ebx
		test	eax, eax
		jnz	short loc_10010412
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_1001029A

loc_10010412:				; CODE XREF: sub_1001027A+15Fj
					; sub_1001027A+18Bj
		mov	eax, esi
		and	eax, 100h
		or	eax, ebp
		jz	short loc_1001043D
		push	3
		pop	ecx
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], ecx
		push	eax
		push	ecx
		call	ebx
		test	eax, eax
		jnz	short loc_1001043D
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_1001029A

loc_1001043D:				; CODE XREF: sub_1001027A+1A1j
					; sub_1001027A+1B6j
		mov	eax, esi
		and	eax, 200h
		or	eax, ebp
		jz	short loc_1001046A
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], 1
		push	eax
		push	4
		call	ebx
		test	eax, eax
		jnz	short loc_1001046A
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_1001029A

loc_1001046A:				; CODE XREF: sub_1001027A+1CCj
					; sub_1001027A+1E3j
		and	esi, 400h
		or	esi, ebp
		jz	short loc_10010496
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], 1
		push	eax
		push	6
		call	ebx
		test	eax, eax
		jnz	short loc_10010496
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_1001029A

loc_10010496:				; CODE XREF: sub_1001027A+13Aj
					; sub_1001027A+1F8j ...
		mov	al, 1

loc_10010498:				; CODE XREF: sub_1001027A+22j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1001027A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100104A0	proc near		; CODE XREF: sub_100083D0+2B2p

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		call	sub_100063BF
		xor	ebx, ebx
		push	3
		mov	edx, [eax]
		xor	eax, eax
		cmp	edx, 5
		mov	[edi], ebx
		mov	[edi+4], ebx
		setnl	al
		lea	eax, ds:4[eax*4]
		mov	[esi], eax
		pop	esi
		cmp	edx, esi
		jle	loc_100105B8
		mov	ecx, [esp+14h+arg_0]
		xor	ebp, ebp
		inc	ebp
		mov	eax, ecx
		and	eax, ebp
		or	eax, ebx
		jz	short loc_100104F5
		mov	eax, ecx
		mov	[edi], ebp
		and	eax, 2
		mov	[edi+4], ebx
		or	eax, ebx
		jnz	short loc_100104F5
		mov	[edi], esi
		mov	[edi+4], ebx

loc_100104F5:				; CODE XREF: sub_100104A0+40j
					; sub_100104A0+4Ej
		mov	eax, ecx
		and	eax, 4
		or	eax, ebx
		jz	short loc_10010507
		mov	eax, [edi+4]
		or	dword ptr [edi], 4
		mov	[edi+4], eax

loc_10010507:				; CODE XREF: sub_100104A0+5Cj
		cmp	edx, 5
		jl	loc_100105B8
		mov	eax, ecx
		mov	edx, 100h
		and	eax, 8
		or	eax, ebx
		jz	short loc_1001053B
		mov	eax, [edi+4]
		or	[edi], edx
		mov	[edi+4], eax
		mov	eax, ecx
		and	eax, 10h
		or	eax, ebx
		jz	short loc_1001053B
		mov	eax, [edi+4]
		or	dword ptr [edi], 300h
		mov	[edi+4], eax

loc_1001053B:				; CODE XREF: sub_100104A0+7Cj
					; sub_100104A0+8Dj
		mov	eax, ecx
		and	eax, 20h
		or	eax, ebx
		jz	short loc_10010550
		mov	eax, [edi+4]
		or	dword ptr [edi], 1000h
		mov	[edi+4], eax

loc_10010550:				; CODE XREF: sub_100104A0+A2j
		mov	eax, ecx
		and	eax, 40h
		or	eax, ebx
		jz	short loc_10010565
		mov	eax, [edi+4]
		or	dword ptr [edi], 10000h
		mov	[edi+4], eax

loc_10010565:				; CODE XREF: sub_100104A0+B7j
		mov	eax, ecx
		and	eax, 80h
		or	eax, ebx
		jz	short loc_1001057C
		mov	eax, [edi+4]
		or	dword ptr [edi], 100000h
		mov	[edi+4], eax

loc_1001057C:				; CODE XREF: sub_100104A0+CEj
		mov	eax, ecx
		and	eax, edx
		or	eax, ebx
		jz	short loc_10010590
		mov	eax, [edi+4]
		or	dword ptr [edi], 1000000h
		mov	[edi+4], eax

loc_10010590:				; CODE XREF: sub_100104A0+E2j
		mov	eax, ecx
		and	eax, 200h
		or	eax, ebx
		jz	short loc_100105A7
		mov	eax, [edi+4]
		or	dword ptr [edi], 10000000h
		mov	[edi+4], eax

loc_100105A7:				; CODE XREF: sub_100104A0+F9j
		and	ecx, 400h
		or	ecx, ebx
		jz	short loc_100105B8
		mov	eax, [edi]
		or	[edi+4], ebp
		mov	[edi], eax

loc_100105B8:				; CODE XREF: sub_100104A0+2Dj
					; sub_100104A0+6Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100104A0	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100105BE@<eax>(HANDLE hProcess@<ecx>, int)
sub_100105BE	proc near		; CODE XREF: sub_10014EB0+27p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-1Ch
arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	esp, 24h
		and	eax, 40h
		push	ebp
		push	edi
		xor	edi, edi
		mov	ebp, ecx
		or	eax, edi
		jz	loc_10010660
		lea	eax, [esp+2Ch+arg_0]
		push	esi
		push	eax
		call	ds:rand_s
		mov	esi, [esp+34h+arg_0]
		and	esi, 3FFFh
		add	esi, 200h
		shl	esi, 0Ah
		pop	ecx
		and	esi, 0FFFF0000h
		jbe	short loc_1001065F
		push	ebx

loc_100105FF:				; CODE XREF: sub_100105BE+9Ej
		push	1Ch		; dwLength
		lea	eax, [esp+38h+Buffer]
		push	eax		; lpBuffer
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualQueryEx
		test	eax, eax
		jz	short loc_1001065E
		mov	eax, [esp+34h+Buffer.RegionSize]
		mov	ecx, esi
		add	eax, 0FFFFh
		sub	ecx, edi
		and	eax, 0FFFF0000h
		mov	[esp+34h+var_24], ecx
		mov	[esp+34h+var_20], eax
		cmp	ecx, eax
		lea	eax, [esp+34h+var_24]
		jb	short loc_10010638
		lea	eax, [esp+34h+var_20]

loc_10010638:				; CODE XREF: sub_100105BE+74j
		mov	ebx, [eax]
		test	edi, edi
		jz	short loc_10010658
		cmp	[esp+34h+Buffer.State],	10000h
		jnz	short loc_10010658
		push	1		; flProtect
		push	2000h		; flAllocationType
		push	ebx		; dwSize
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualAllocEx

loc_10010658:				; CODE XREF: sub_100105BE+7Ej
					; sub_100105BE+88j
		add	edi, ebx
		cmp	edi, esi
		jb	short loc_100105FF

loc_1001065E:				; CODE XREF: sub_100105BE+52j
		pop	ebx

loc_1001065F:				; CODE XREF: sub_100105BE+3Ej
		pop	esi

loc_10010660:				; CODE XREF: sub_100105BE+12j
		pop	edi
		mov	al, 1
		pop	ebp
		add	esp, 24h
		retn
sub_100105BE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010668	proc near		; CODE XREF: sub_1001027A+15p
					; sub_10014B3A+Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		and	ecx, 0FFFFFA84h
		and	eax, 0FFFFFFFEh
		or	ecx, eax
		jnz	short loc_10010681
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010681:				; CODE XREF: sub_10010668+13j
		xor	eax, eax
		retn
sub_10010668	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010684	proc near		; DATA XREF: .rdata:1002C7D8o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C7D0
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_100106A1
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100106A1:				; CODE XREF: sub_10010684+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10010684	endp


; =============== S U B	R O U T	I N E =======================================


sub_100106A7	proc near		; DATA XREF: .rdata:1002C7D4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [ecx+10h]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+44h]
		xor	ecx, ecx
		and	eax, 200h
		and	edx, ecx
		or	eax, edx
		jnz	short loc_100106C3

loc_100106BF:				; CODE XREF: sub_100106A7+29j
		xor	al, al
		jmp	short locret_10010735
; ---------------------------------------------------------------------------

loc_100106C3:				; CODE XREF: sub_100106A7+16j
		mov	eax, [esp+arg_4]
		sub	eax, 13h
		jz	short loc_10010709
		dec	eax
		jz	short loc_100106F0
		dec	eax
		jnz	short loc_100106BF
		mov	eax, offset _TargetRegisterClassW@8 ; TargetRegisterClassW(x,x)
		test	eax, eax
		jz	short loc_10010730
		push	18h
		push	offset a_targetregis_0 ; "_TargetRegisterClassW@8"
		push	2
		push	offset aRegisterclassw ; "RegisterClassW"
		push	offset aUser32_dll_0 ; "user32.dll"
		jmp	short loc_10010725
; ---------------------------------------------------------------------------

loc_100106F0:				; CODE XREF: sub_100106A7+26j
		mov	eax, offset _TargetGetStockObject@8 ; TargetGetStockObject(x,x)
		test	eax, eax
		jz	short loc_10010730
		push	17h
		push	offset a_targetgetst_0 ; "_TargetGetStockObject@8"
		push	2
		push	offset aGetstockobject ; "GetStockObject"
		jmp	short loc_10010720
; ---------------------------------------------------------------------------

loc_10010709:				; CODE XREF: sub_100106A7+23j
		mov	eax, offset _TargetGdiDllInitialize@12 ; TargetGdiDllInitialize(x,x,x)
		test	eax, eax
		jz	short loc_10010730
		push	16h		; int
		push	offset a_targetgdidl_0 ; "_TargetGdiDllInitialize@12"
		push	2		; int
		push	offset aGdidllinitiali ; "GdiDllInitialize"

loc_10010720:				; CODE XREF: sub_100106A7+60j
		push	offset aGdi32_dll ; "gdi32.dll"

loc_10010725:				; CODE XREF: sub_100106A7+47j
		mov	ecx, [esp+14h+arg_0]
		call	sub_1000D8BF
		mov	cl, al

loc_10010730:				; CODE XREF: sub_100106A7+32j
					; sub_100106A7+50j ...
		test	cl, cl
		setnz	al

locret_10010735:			; CODE XREF: sub_100106A7+1Aj
		retn	8
sub_100106A7	endp

; Exported entry  20. _TargetGdiDllInitialize@12

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGdiDllInitialize(x, x, x)
		public _TargetGdiDllInitialize@12
_TargetGdiDllInitialize@12 proc	near	; DATA XREF: sub_100106A7:loc_10010709o
					; .rdata:off_1002E058o
		xor	eax, eax
		inc	eax
		retn	0Ch
_TargetGdiDllInitialize@12 endp

; Exported entry  21. _TargetGetStockObject@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGetStockObject(x, x)
		public _TargetGetStockObject@8
_TargetGetStockObject@8	proc near	; DATA XREF: sub_100106A7:loc_100106F0o
					; .rdata:off_1002E058o
		xor	eax, eax
		retn	8
_TargetGetStockObject@8	endp

; Exported entry  41. _TargetRegisterClassW@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetRegisterClassW(x, x)
		public _TargetRegisterClassW@8
_TargetRegisterClassW@8	proc near	; DATA XREF: sub_100106A7+2Bo
					; .rdata:off_1002E058o
		xor	eax, eax
		inc	eax
		retn	8
_TargetRegisterClassW@8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010749	proc near		; CODE XREF: sub_1001525E+9Fp

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		lea	ecx, [ebp+var_14]
		push	ebx
		push	0Ah
		call	sub_1000F976
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	13h
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10010794
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	14h
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10010794
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	15h
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10010794
		mov	bl, 1
		jmp	short loc_10010796
; ---------------------------------------------------------------------------

loc_10010794:				; CODE XREF: sub_10010749+21j
					; sub_10010749+33j ...
		xor	bl, bl

loc_10010796:				; CODE XREF: sub_10010749+49j
		lea	ecx, [ebp+var_14]
		call	sub_1000FD8D
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10010749	endp


; =============== S U B	R O U T	I N E =======================================


sub_100107A5	proc near		; DATA XREF: .rdata:1002C878o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C870
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_100107C2
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100107C2:				; CODE XREF: sub_100107A5+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_100107A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100107C8	proc near		; CODE XREF: sub_10010BE5+73p

var_3C		= dword	ptr -3Ch
Src		= word ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
Dst		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		mov	[esp+48h+var_24], 7
		xor	ebp, ebp
		xor	eax, eax
		push	edi
		mov	ebx, ecx
		mov	[esp+4Ch+var_28], ebp
		cmp	dword ptr [esi+14h], 8
		mov	[esp+4Ch+Src], ax
		jb	short loc_100107FD
		mov	eax, [esi]
		jmp	short loc_100107FF
; ---------------------------------------------------------------------------

loc_100107FD:				; CODE XREF: sub_100107C8+2Fj
		mov	eax, esi

loc_100107FF:				; CODE XREF: sub_100107C8+33j
		push	22h
		xor	edi, edi
		pop	ecx
		inc	edi
		cmp	[eax], cx
		push	edi
		lea	eax, [esp+50h+var_3C]
		jnz	short loc_10010830
		push	edi
		mov	[esp+54h+var_3C], ecx
		mov	ecx, esi
		push	eax
		call	sub_100036C4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001082B
		push	esi
		mov	ecx, ebx
		call	sub_1000388D
		jmp	short loc_1001088A
; ---------------------------------------------------------------------------

loc_1001082B:				; CODE XREF: sub_100107C8+57j
		dec	eax
		push	eax
		push	edi
		jmp	short loc_1001085D
; ---------------------------------------------------------------------------

loc_10010830:				; CODE XREF: sub_100107C8+45j
		push	ebp
		push	eax
		mov	ecx, esi
		mov	[esp+58h+var_3C], 20h
		call	sub_100036C4
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1001085B
		lea	eax, [esp+4Ch+Src]
		cmp	eax, esi
		jz	short loc_1001087E
		push	0FFFFFFFFh	; int
		push	ebp		; int
		push	esi		; int
		mov	ecx, eax	; Dst
		call	sub_100023C2
		jmp	short loc_1001087E
; ---------------------------------------------------------------------------

loc_1001085B:				; CODE XREF: sub_100107C8+7Cj
		push	eax		; int
		push	ebp		; int

loc_1001085D:				; CODE XREF: sub_100107C8+66j
		lea	eax, [esp+54h+Dst]
		mov	ecx, esi	; int
		push	eax		; Dst
		call	sub_100035A2
		push	eax		; Src
		lea	ecx, [esp+50h+Src]
		call	sub_10003B23
		push	ebp
		push	edi
		lea	ecx, [esp+54h+Dst]
		call	sub_100022FA

loc_1001087E:				; CODE XREF: sub_100107C8+84j
					; sub_100107C8+91j
		lea	eax, [esp+4Ch+Src]
		mov	ecx, ebx
		push	eax		; Src
		call	sub_1000346E

loc_1001088A:				; CODE XREF: sub_100107C8+61j
		push	ebp
		push	edi
		lea	ecx, [esp+54h+Src]
		call	sub_100022FA
		mov	ecx, [esp+4Ch+var_8]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
sub_100107C8	endp


; =============== S U B	R O U T	I N E =======================================


sub_100108AA	proc near		; CODE XREF: sub_10010BE5+93p
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, offset asc_1002C7E4 ; "\\\\"
		mov	ecx, edi
		call	sub_10001ADC
		push	eax
		push	0
		push	edi
		mov	ecx, esi
		call	sub_100036C4
		test	eax, eax
		jz	short loc_100108E9
		mov	edi, offset asc_1002C7DC ; ":\\"
		mov	ecx, edi
		call	sub_10001ADC
		push	eax
		push	0
		push	edi
		mov	ecx, esi
		call	sub_100036C4
		cmp	eax, 1
		jz	short loc_100108E9
		mov	al, 1
		jmp	short loc_100108EB
; ---------------------------------------------------------------------------

loc_100108E9:				; CODE XREF: sub_100108AA+1Dj
					; sub_100108AA+39j
		xor	al, al

loc_100108EB:				; CODE XREF: sub_100108AA+3Dj
		pop	edi
		pop	esi
		retn
sub_100108AA	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100108EE@<eax>(LPCWSTR lpPath@<ecx>, void *Dst)
sub_100108EE	proc near		; CODE XREF: sub_10010BE5+ACp

FilePart	= dword	ptr -210h
Buffer		= word ptr -20Ch
var_4		= dword	ptr -4
Dst		= dword	ptr  4

		sub	esp, 210h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+210h+var_4], eax
		and	[esp+210h+FilePart], 0
		push	ebp
		mov	ebp, 104h
		push	esi
		mov	esi, [esp+218h+Dst]
		push	edi
		mov	edi, ecx
		test	dl, dl
		jz	short loc_10010941
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10010925
		mov	eax, [esi]
		jmp	short loc_10010927
; ---------------------------------------------------------------------------

loc_10010925:				; CODE XREF: sub_100108EE+31j
		mov	eax, esi

loc_10010927:				; CODE XREF: sub_100108EE+35j
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	ebp		; nBufferLength
		push	0		; lpExtension
		push	eax		; lpFileName
		push	0		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jnz	short loc_1001096E

loc_10010941:				; CODE XREF: sub_100108EE+2Bj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001094B
		mov	eax, [esi]
		jmp	short loc_1001094D
; ---------------------------------------------------------------------------

loc_1001094B:				; CODE XREF: sub_100108EE+57j
		mov	eax, esi

loc_1001094D:				; CODE XREF: sub_100108EE+5Bj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10010955
		mov	edi, [edi]

loc_10010955:				; CODE XREF: sub_100108EE+63j
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	ebp		; nBufferLength
		push	0		; lpExtension
		push	eax		; lpFileName
		push	edi		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jz	short loc_1001098C

loc_1001096E:				; CODE XREF: sub_100108EE+51j
		cmp	eax, ebp
		jnb	short loc_1001098C
		lea	ecx, [esp+21Ch+Buffer]
		call	sub_10001ADC
		push	eax		; int
		lea	eax, [esp+220h+Buffer]
		mov	ecx, esi	; Dst
		push	eax		; Src
		call	sub_1000233F
		mov	al, 1
		jmp	short loc_1001098E
; ---------------------------------------------------------------------------

loc_1001098C:				; CODE XREF: sub_100108EE+7Ej
					; sub_100108EE+82j
		xor	al, al

loc_1001098E:				; CODE XREF: sub_100108EE+9Cj
		mov	ecx, [esp+21Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 210h
		retn
sub_100108EE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100109A6	proc near		; CODE XREF: sub_1001436D+13Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1002C8D4
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1002C870
		mov	[edi+10h], eax
		call	sub_1000A1B0
		push	offset dword_1002C900
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002C8A8
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002C844
		mov	ecx, esi
		call	sub_1000A1B0
		push	offset dword_1002C87C
		mov	ecx, esi
		call	sub_1000A1B0
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100109A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010A07	proc near		; DATA XREF: .rdata:1002C874o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_4], 9
		mov	[esp+8+var_4], ebx
		jl	short loc_10010A86
		cmp	[ebp+arg_4], 0Ch
		jle	short loc_10010A86
		cmp	[ebp+arg_4], 0Dh
		jnz	short loc_10010A86
		mov	eax, offset _TargetCreateProcessW@44 ; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010A4D
		mov	ecx, [ebp+arg_0]
		push	0Fh		; int
		push	offset a_targetcreat_1 ; "_TargetCreateProcessW@44"
		push	2		; int
		push	offset aCreateprocessw ; "CreateProcessW"
		push	offset aKernel32_dll_2 ; "kernel32.dll"
		call	sub_1000D8BF
		jmp	short loc_10010A4F
; ---------------------------------------------------------------------------

loc_10010A4D:				; CODE XREF: sub_10010A07+27j
		mov	al, bl

loc_10010A4F:				; CODE XREF: sub_10010A07+44j
		test	al, al
		jz	short loc_10010A82
		mov	eax, offset _TargetCreateProcessA@44 ; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010A79
		mov	ecx, [ebp+arg_0]
		push	10h		; int
		push	offset a_targetcreat_2 ; "_TargetCreateProcessA@44"
		push	2		; int
		push	offset aCreateprocessa ; "CreateProcessA"
		push	offset ModuleName ; "kernel32.dll"
		call	sub_1000D8BF
		jmp	short loc_10010A7B
; ---------------------------------------------------------------------------

loc_10010A79:				; CODE XREF: sub_10010A07+53j
		mov	al, bl

loc_10010A7B:				; CODE XREF: sub_10010A07+70j
		test	al, al
		jz	short loc_10010A82
		xor	ebx, ebx
		inc	ebx

loc_10010A82:				; CODE XREF: sub_10010A07+4Aj
					; sub_10010A07+76j
		mov	al, bl
		jmp	short loc_10010A88
; ---------------------------------------------------------------------------

loc_10010A86:				; CODE XREF: sub_10010A07+12j
					; sub_10010A07+18j ...
		xor	al, al

loc_10010A88:				; CODE XREF: sub_10010A07+7Dj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10010A07	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010A8F	proc near		; DATA XREF: .rdata:1002C8FCo

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_4]
		lea	eax, [ebp+TargetHandle]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, [esi+4]
		call	sub_10011A72
		pop	ecx
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		pop	ecx
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10010A8F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010ABD	proc near		; DATA XREF: .rdata:1002C928o

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_4]
		lea	eax, [ebp+TargetHandle]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, [esi+4]
		call	sub_10011B05
		pop	ecx
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		pop	ecx
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10010ABD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010AEB	proc near		; DATA XREF: .rdata:1002C8D0o

TargetHandle	= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		lea	edx, [esp+18h+arg_0]
		xor	ebp, ebp
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		mov	[esp+18h+TargetHandle],	ebp
		mov	[esp+18h+arg_0], ebp
		mov	ebx, [edi+4]
		call	sub_1001881C
		cmp	[esp+18h+arg_4], 0FFFFFFFFh
		jnz	short loc_10010B4C
		lea	eax, [esp+18h+hSourceHandle]
		push	eax
		push	[esp+1Ch+arg_8]
		push	dword ptr [ebx]
		call	[esp+24h+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10010B51
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		lea	eax, [esp+24h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+2Ch+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10010B51

loc_10010B4C:				; CODE XREF: sub_10010AEB+2Aj
		mov	esi, 0C0000022h

loc_10010B51:				; CODE XREF: sub_10010AEB+3Fj
					; sub_10010AEB+5Fj
		mov	eax, [esp+18h+TargetHandle]
		mov	[edi+10h], esi
		mov	[edi+18h], eax
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_10010AEB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010B66	proc near		; DATA XREF: .rdata:1002C86Co

TargetHandle	= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		lea	edx, [esp+18h+arg_0]
		xor	ebp, ebp
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		mov	[esp+18h+TargetHandle],	ebp
		mov	[esp+18h+arg_0], ebp
		mov	ebx, [edi+4]
		call	sub_1001881C
		cmp	[esp+18h+arg_4], 0FFFFFFFFh
		jnz	short loc_10010BCB
		lea	eax, [esp+18h+hSourceHandle]
		push	eax
		push	[esp+1Ch+arg_C]
		push	[esp+20h+arg_8]
		push	dword ptr [ebx]
		call	[esp+28h+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10010BD0
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		lea	eax, [esp+24h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+2Ch+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10010BD0

loc_10010BCB:				; CODE XREF: sub_10010B66+2Aj
		mov	esi, 0C0000022h

loc_10010BD0:				; CODE XREF: sub_10010B66+43j
					; sub_10010B66+63j
		mov	eax, [esp+18h+TargetHandle]
		mov	[edi+10h], esi
		mov	[edi+18h], eax
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	10h
sub_10010B66	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010BE5	proc near		; DATA XREF: .rdata:1002C8A4o

var_44		= dword	ptr -44h
Str		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
lpPath		= dword	ptr -38h
ApplicationName	= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_8]
		push	ebx
		mov	ebx, [ebp+arg_10]
		push	esi
		mov	esi, [ebp+arg_4]
		mov	[esp+4Ch+var_44], ecx
		cmp	dword ptr [ebx], 10h
		mov	ecx, [ebp+arg_C]
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[esp+50h+Str], eax
		mov	[esp+50h+lpPath], ecx
		jz	short loc_10010C23
		xor	al, al
		jmp	loc_10010D08
; ---------------------------------------------------------------------------

loc_10010C23:				; CODE XREF: sub_10010BE5+35j
		xor	edx, edx
		mov	[esp+50h+var_20], 7
		xor	ecx, ecx
		mov	[esp+50h+var_24], edx
		mov	[esp+50h+ApplicationName], cx
		cmp	[esi+10h], edx
		jz	short loc_10010C52
		lea	eax, [esp+50h+ApplicationName]
		cmp	eax, esi
		jz	short loc_10010C74
		push	0FFFFFFFFh	; int
		push	edx		; int
		push	esi		; int
		mov	ecx, eax	; Dst
		call	sub_100023C2
		jmp	short loc_10010C74
; ---------------------------------------------------------------------------

loc_10010C52:				; CODE XREF: sub_10010BE5+56j
		mov	edx, eax
		lea	ecx, [esp+50h+var_1C]
		call	sub_100107C8
		push	eax		; Src
		lea	ecx, [esp+54h+ApplicationName]
		call	sub_10003B23
		push	0
		push	1
		lea	ecx, [esp+58h+var_1C]
		call	sub_100022FA

loc_10010C74:				; CODE XREF: sub_10010BE5+5Ej
					; sub_10010BE5+6Bj
		lea	ecx, [esp+50h+ApplicationName]
		call	sub_100108AA
		test	al, al
		jz	short loc_10010CA4
		cmp	dword ptr [esi+10h], 0
		lea	eax, [esp+50h+ApplicationName]
		mov	ecx, [esp+50h+lpPath] ;	lpPath
		setz	dl
		push	eax		; Dst
		call	sub_100108EE
		pop	ecx
		test	al, al
		jnz	short loc_10010CA4
		mov	dword ptr [edi+10h], 2
		jmp	short loc_10010CF9
; ---------------------------------------------------------------------------

loc_10010CA4:				; CODE XREF: sub_10010BE5+9Aj
					; sub_10010BE5+B4j
		cmp	[esp+50h+var_20], 8
		mov	eax, dword ptr [esp+50h+ApplicationName]
		jnb	short loc_10010CB3
		lea	eax, [esp+50h+ApplicationName]

loc_10010CB3:				; CODE XREF: sub_10010BE5+C8j
		xor	ecx, ecx
		mov	[esp+50h+var_3C], eax
		inc	ecx
		lea	eax, [esp+50h+var_3C]
		mov	[esp+50h+var_1C], ecx
		mov	[esp+50h+var_18], ecx
		mov	ecx, [esp+50h+var_44]
		mov	[esp+50h+var_14], eax
		lea	eax, [esp+50h+var_1C]
		push	eax
		push	0Dh
		mov	ecx, [ecx+10h]
		call	sub_10015057
		push	dword ptr [ebx+4] ; lpProcessInformation
		mov	edx, [edi+4]
		lea	ecx, [esp+54h+ApplicationName]
		push	[esp+54h+Str]	; Str
		push	ecx		; lpApplicationName
		mov	ecx, eax
		call	sub_10011B9D
		add	esp, 0Ch
		mov	[edi+10h], eax

loc_10010CF9:				; CODE XREF: sub_10010BE5+BDj
		push	0
		push	1
		lea	ecx, [esp+58h+ApplicationName]
		call	sub_100022FA
		mov	al, 1

loc_10010D08:				; CODE XREF: sub_10010BE5+39j
		mov	ecx, [esp+50h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_10010BE5	endp

; Exported entry  33. _TargetNtOpenThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	TargetNtOpenThread(int,	int, int Src, int, int)
		public _TargetNtOpenThread@20
_TargetNtOpenThread@20 proc near	; DATA XREF: sub_1000F0CA+7o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
Dst		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_28		= byte ptr -28h
var_1D		= byte ptr -1Dh
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Src		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	4Ch
		push	offset stru_1002DDF8
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_10]
		push	ebx
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+Src]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_10], esi
		test	esi, esi
		jns	loc_10010E49
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		call	sub_100029CB
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_10010E47
		test	ebx, ebx
		jz	loc_10010E47
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[ebx], eax
		jz	short loc_10010D7C
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010D7C:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+59j
		test	cl, cl
		jnz	short loc_10010DA2
		test	edi, edi
		jz	short loc_10010DA2
		cmp	[edi+0Ch], eax
		jnz	short loc_10010D9D
		cmp	[edi+8], eax
		jnz	short loc_10010D9D
		cmp	[edi+4], eax
		jnz	short loc_10010D9D
		cmp	[edi+10h], eax
		jnz	short loc_10010D9D
		cmp	[edi+14h], eax
		jz	short loc_10010DA2

loc_10010D9D:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+6Bj
					; TargetNtOpenThread(x,x,x,x,x)+70j ...
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010DA2:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+62j
					; TargetNtOpenThread(x,x,x,x,x)+66j ...
		mov	eax, [ebx+4]
		mov	[ebp+arg_C], eax
		push	0FFFFFFFEh
		pop	edi
		mov	[ebp+ms_exc.registration.TryLevel], edi
		test	cl, cl
		jnz	loc_10010E47
		push	1
		push	4
		pop	edx
		mov	ebx, [ebp+arg_4]
		mov	ecx, ebx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	short loc_10010E47
		call	sub_10013DD2
		test	eax, eax
		jz	short loc_10010E47
		push	eax
		lea	ecx, [ebp+var_28]
		call	sub_10015A07
		and	[ebp+var_5C], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+Src]
		push	eax		; Src
		push	9
		pop	edx
		lea	ecx, [ebp+var_28]
		call	sub_100114AE
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10010E47
		cmp	[ebp+var_54], eax
		jl	short loc_10010E47
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_4C]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], edi
		xor	edx, edx
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		call	sub_10002ACE
		mov	eax, [ebp+var_54]
		jmp	short loc_10010E49
; ---------------------------------------------------------------------------

loc_10010E30:				; DATA XREF: .rdata:stru_1002DDF8o
		xor	eax, eax	; Exception filter 1 for function 10010D1C
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010E34:				; DATA XREF: .rdata:stru_1002DDF8o
		jmp	short loc_10010E3A ; Exception handler 1 for function 10010D1C
; ---------------------------------------------------------------------------

loc_10010E36:				; DATA XREF: .rdata:stru_1002DDF8o
		xor	eax, eax	; Exception filter 0 for function 10010D1C
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010E3A:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x):loc_10010E34j
					; DATA XREF: .rdata:stru_1002DDF8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010D1C
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_10]

loc_10010E47:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+42j
					; TargetNtOpenThread(x,x,x,x,x)+4Aj ...
		mov	eax, esi

loc_10010E49:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+24j
					; TargetNtOpenThread(x,x,x,x,x)+112j
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenThread@20 endp

; Exported entry  30. _TargetNtOpenProcess@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	TargetNtOpenProcess(int, int, int Src, int, int)
		public _TargetNtOpenProcess@20
_TargetNtOpenProcess@20	proc near	; DATA XREF: sub_1000F0CA+39o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
Dst		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_28		= byte ptr -28h
var_1D		= byte ptr -1Dh
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Src		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	4Ch
		push	offset stru_1002DE20
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_10]
		push	ebx
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+Src]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	edi, eax
		mov	[ebp+arg_10], edi
		test	edi, edi
		jns	loc_10010F58
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_10010F56
		test	ebx, ebx
		jz	loc_10010F56
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		test	esi, esi
		jz	short loc_10010EBB
		cmp	[esi+0Ch], eax
		jnz	short loc_10010EB6
		cmp	[esi+8], eax
		jnz	short loc_10010EB6
		cmp	[esi+4], eax
		jnz	short loc_10010EB6
		cmp	[esi+10h], eax
		jnz	short loc_10010EB6
		cmp	[esi+14h], eax
		jz	short loc_10010EBB

loc_10010EB6:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+4Fj
					; TargetNtOpenProcess(x,x,x,x,x)+54j ...
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010EBB:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+4Aj
					; TargetNtOpenProcess(x,x,x,x,x)+63j
		mov	eax, [ebx]
		mov	[ebp+arg_C], eax
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		test	cl, cl
		jnz	loc_10010F56
		push	1
		push	4
		pop	edx
		mov	ebx, [ebp+arg_4]
		mov	ecx, ebx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	short loc_10010F56
		call	sub_10013DD2
		test	eax, eax
		jz	short loc_10010F56
		push	eax
		lea	ecx, [ebp+var_28]
		call	sub_10015A07
		and	[ebp+var_5C], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+Src]
		push	eax		; Src
		push	0Ah
		pop	edx
		lea	ecx, [ebp+var_28]
		call	sub_100114AE
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10010F56
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jns	short loc_10010F2E

loc_10010F2A:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+ECj
		mov	eax, ecx
		jmp	short loc_10010F58
; ---------------------------------------------------------------------------

loc_10010F2E:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+D7j
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_4C]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_10010F2A
; ---------------------------------------------------------------------------

loc_10010F3F:				; DATA XREF: .rdata:stru_1002DE20o
		xor	eax, eax	; Exception filter 1 for function 10010E51
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010F43:				; DATA XREF: .rdata:stru_1002DE20o
		jmp	short loc_10010F49 ; Exception handler 1 for function 10010E51
; ---------------------------------------------------------------------------

loc_10010F45:				; DATA XREF: .rdata:stru_1002DE20o
		xor	eax, eax	; Exception filter 0 for function 10010E51
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010F49:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x):loc_10010F43j
					; DATA XREF: .rdata:stru_1002DE20o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010E51
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+arg_10]

loc_10010F56:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+33j
					; TargetNtOpenProcess(x,x,x,x,x)+3Bj ...
		mov	eax, edi

loc_10010F58:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+24j
					; TargetNtOpenProcess(x,x,x,x,x)+DBj
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenProcess@20	endp

; Exported entry  31. _TargetNtOpenProcessToken@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessToken(x,	x, x, x)
		public _TargetNtOpenProcessToken@16
_TargetNtOpenProcessToken@16 proc near	; DATA XREF: sub_1000F0CA+63o
					; .rdata:off_1002E058o

var_58		= dword	ptr -58h
Dst		= byte ptr -54h
var_50		= dword	ptr -50h
var_48		= dword	ptr -48h
var_24		= byte ptr -24h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	48h
		push	offset stru_1002DE48
		call	__SEH_prolog4
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_C], esi
		test	esi, esi
		jns	loc_10011034
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_100029CB
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_10011032
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	loc_10011032
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	short loc_10011032
		call	sub_10013DD2
		test	eax, eax
		jz	short loc_10011032
		push	eax
		lea	ecx, [ebp+var_24]
		call	sub_10015A07
		and	[ebp+var_58], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_58]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; int
		lea	ecx, [ebp+var_24]
		call	sub_10011531
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10011032
		mov	esi, [ebp+var_50]
		test	esi, esi
		js	short loc_10011032
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_48]
		mov	[edi], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edx, edx
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_10002ACE
		jmp	short loc_10011032
; ---------------------------------------------------------------------------

loc_10011021:				; DATA XREF: .rdata:stru_1002DE48o
		xor	eax, eax	; Exception filter 0 for function 10010F60
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10011025:				; DATA XREF: .rdata:stru_1002DE48o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010F60
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_C]

loc_10011032:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+3Ej
					; TargetNtOpenProcessToken(x,x,x,x)+48j ...
		mov	eax, esi

loc_10011034:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+20j
		call	__SEH_epilog4
		retn	10h
_TargetNtOpenProcessToken@16 endp

; Exported entry  32. _TargetNtOpenProcessTokenEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessTokenEx(x, x, x,	x, x)
		public _TargetNtOpenProcessTokenEx@20
_TargetNtOpenProcessTokenEx@20 proc near ; DATA	XREF: sub_1000F0CA+E7o
					; .rdata:off_1002E058o

var_54		= dword	ptr -54h
Dst		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_20		= byte ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	44h
		push	offset stru_1002DE68
		call	__SEH_prolog4
		mov	edi, [ebp+arg_10]
		push	edi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_10], esi
		test	esi, esi
		jns	loc_10011117
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_100029CB
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_10011115
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	loc_10011115
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	short loc_10011115
		call	sub_10013DD2
		test	eax, eax
		jz	short loc_10011115
		push	eax
		lea	ecx, [ebp+var_20]
		call	sub_10015A07
		and	[ebp+var_54], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; int
		lea	ecx, [ebp+var_20]
		call	sub_100115C4
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_10011115
		mov	esi, [ebp+var_4C]
		test	esi, esi
		js	short loc_10011115
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_44]
		mov	[edi], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edx, edx
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_10002ACE
		jmp	short loc_10011115
; ---------------------------------------------------------------------------

loc_10011104:				; DATA XREF: .rdata:stru_1002DE68o
		xor	eax, eax	; Exception filter 0 for function 1001103C
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10011108:				; DATA XREF: .rdata:stru_1002DE68o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001103C
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_10]

loc_10011115:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+41j
					; TargetNtOpenProcessTokenEx(x,x,x,x,x)+4Bj ...
		mov	eax, esi

loc_10011117:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+23j
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenProcessTokenEx@20 endp

; Exported entry  19. _TargetCreateProcessW@44

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateProcessW(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessW@44
_TargetCreateProcessW@44 proc near	; DATA XREF: sub_10010A07+20o
					; .rdata:off_1002E058o

var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
Dst		= byte ptr -240h
dwErrCode	= dword	ptr -23Ch
Buffer		= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_20]
		mov	edx, [ebp+arg_1C]
		push	ebx
		mov	ebx, [ebp+arg_8]
		and	[esp+270h+var_254], 0
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[esp+278h+var_264], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+278h+var_268], ebx
		mov	[esp+278h+var_258], ebx
		mov	ebx, [ebp+arg_28]
		push	ebx
		mov	[esp+27Ch+var_24C], eax
		mov	[esp+27Ch+var_248], eax
		mov	eax, [ebp+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[ebp+arg_18]
		mov	[esp+28Ch+var_260], ebx
		push	[ebp+arg_14]
		mov	ebx, [esp+290h+var_268]
		push	esi
		mov	esi, [esp+294h+var_24C]
		push	edi
		push	ebx
		push	esi
		call	[esp+2A0h+var_264]
		test	eax, eax
		jz	short loc_1001119A

loc_10011192:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+165j
		xor	eax, eax
		inc	eax
		jmp	loc_10011295
; ---------------------------------------------------------------------------

loc_1001119A:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+71j
		mov	edx, esi
		mov	ecx, offset aCreateprocessw ; "CreateProcessW"
		call	sub_100029E7
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_10011293
		call	ds:GetLastError
		mov	ebx, [esp+278h+var_260]
		mov	ecx, ebx
		push	1
		push	10h
		pop	edx
		mov	[esp+27Ch+var_264], eax
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_10011289
		call	sub_10013DD2
		mov	edi, eax
		test	edi, edi
		jz	loc_10011289
		and	[esp+278h+var_268], 0
		lea	eax, [esp+278h+Buffer]
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_1001120F
		cmp	eax, 104h
		jnb	short loc_1001120F
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_268], eax

loc_1001120F:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+DFj
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+E6j
		mov	eax, [edi+8]
		and	[esp+278h+var_244], 0
		add	eax, edi
		push	30h		; Size
		mov	[esp+27Ch+var_25C], eax
		lea	eax, [esp+27Ch+Dst]
		push	0		; Val
		push	eax		; Dst
		mov	[esp+284h+var_260], edi
		call	memset
		add	esp, 0Ch
		mov	[esp+278h+var_254], 10h
		lea	eax, [esp+278h+var_244]
		mov	[esp+278h+var_250], ebx
		lea	ecx, [esp+278h+var_260]
		push	eax
		lea	eax, [esp+27Ch+var_254]
		push	eax
		lea	eax, [esp+280h+var_268]
		push	eax
		lea	eax, [esp+284h+var_258]
		push	eax
		lea	eax, [esp+288h+var_248]
		push	eax
		call	sub_10011670
		add	esp, 14h
		test	eax, eax
		jnz	short loc_10011289
		push	[esp+278h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+278h+dwErrCode], 0
		jnz	short loc_10011293
		mov	edx, esi
		mov	ecx, offset aCreateprocessw ; "CreateProcessW"
		call	sub_10002AE8
		jmp	loc_10011192
; ---------------------------------------------------------------------------

loc_10011289:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+B3j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+C2j ...
		push	[esp+278h+var_264] ; dwErrCode
		call	ds:SetLastError

loc_10011293:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+90j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+157j
		xor	eax, eax

loc_10011295:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+76j
		mov	ecx, [esp+278h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	2Ch
_TargetCreateProcessW@44 endp

; Exported entry  18. _TargetCreateProcessA@44

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateProcessA(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessA@44
_TargetCreateProcessA@44 proc near	; DATA XREF: sub_10010A07+4Co
					; .rdata:off_1002E058o

var_26C		= dword	ptr -26Ch
var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
dwErrCode	= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
Dst		= byte ptr -240h
var_23C		= dword	ptr -23Ch
Buffer		= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_20]
		mov	edx, [ebp+arg_1C]
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		and	[esp+278h+dwErrCode], 0
		mov	[esp+278h+var_26C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+278h+var_264], ebx
		mov	ebx, [ebp+arg_28]
		push	ebx
		mov	[esp+27Ch+var_268], eax
		mov	eax, [ebp+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[ebp+arg_18]
		mov	[esp+28Ch+var_260], ebx
		push	[ebp+arg_14]
		mov	ebx, [esp+290h+var_264]
		push	esi
		mov	esi, [esp+294h+var_268]
		push	edi
		push	esi
		push	[esp+29Ch+var_26C]
		call	ebx
		test	eax, eax
		jz	short loc_10011320

loc_10011318:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1FDj
		xor	eax, eax
		inc	eax
		jmp	loc_100113AF
; ---------------------------------------------------------------------------

loc_10011320:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+6Aj
		mov	ebx, [esp+278h+var_26C]
		mov	ecx, offset aCreateprocessa ; "CreateProcessA"
		push	2
		mov	edx, ebx
		call	sub_100029CB
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	short loc_100113AD
		call	ds:GetLastError
		mov	ecx, [esp+278h+var_260]
		push	1
		push	10h
		pop	edx
		mov	[esp+27Ch+dwErrCode], eax
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	short loc_100113A3
		call	sub_10013DD2
		mov	[esp+278h+var_254], eax
		test	eax, eax
		jz	short loc_100113A3
		xor	ecx, ecx
		xor	edi, edi
		mov	[esp+278h+var_26C], ecx
		test	esi, esi
		jz	short loc_10011385
		mov	ecx, esi
		call	sub_1001408D
		mov	edi, eax
		test	edi, edi
		jz	short loc_100113A3
		mov	ecx, [esp+278h+var_26C]

loc_10011385:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+C6j
		test	ebx, ebx
		jz	short loc_100113C6
		mov	ecx, ebx
		call	sub_1001408D
		mov	ecx, eax
		mov	[esp+278h+var_26C], eax
		test	ecx, ecx
		jnz	short loc_100113C6
		xor	edx, edx
		mov	ecx, edi
		call	sub_1001430B

loc_100113A3:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+ADj
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+BAj ...
		push	[esp+278h+dwErrCode] ; dwErrCode
		call	ds:SetLastError

loc_100113AD:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+90j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1EBj
		xor	eax, eax

loc_100113AF:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+6Fj
		mov	ecx, [esp+278h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	2Ch
; ---------------------------------------------------------------------------

loc_100113C6:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+DBj
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+ECj
		xor	esi, esi
		test	edi, edi
		jz	short loc_100113D5
		mov	eax, [edi+4]
		mov	[esp+278h+var_264], eax
		jmp	short loc_100113D9
; ---------------------------------------------------------------------------

loc_100113D5:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+11Ej
		mov	[esp+278h+var_264], esi

loc_100113D9:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+127j
		test	ecx, ecx
		jz	short loc_100113E6
		mov	eax, [ecx+4]
		mov	[esp+278h+var_268], eax
		jmp	short loc_100113EA
; ---------------------------------------------------------------------------

loc_100113E6:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+12Fj
		mov	[esp+278h+var_268], esi

loc_100113EA:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+138j
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_258], esi
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_10011411
		cmp	eax, 104h
		jnb	short loc_10011411
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_258], eax

loc_10011411:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+154j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+15Bj
		mov	ecx, [esp+278h+var_254]
		push	30h		; Size
		push	esi		; Val
		mov	[esp+280h+var_24C], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	[esp+280h+var_244], esi
		mov	[esp+280h+var_248], eax
		lea	eax, [esp+280h+Dst]
		push	eax		; Dst
		call	memset
		mov	eax, [esp+284h+var_260]
		lea	ecx, [esp+284h+var_24C]
		add	esp, 0Ch
		mov	[esp+278h+var_250], eax
		lea	eax, [esp+278h+var_244]
		mov	[esp+278h+var_254], 10h
		push	eax
		lea	eax, [esp+27Ch+var_254]
		push	eax
		lea	eax, [esp+280h+var_258]
		push	eax
		lea	eax, [esp+284h+var_264]
		push	eax
		lea	eax, [esp+288h+var_268]
		push	eax
		call	sub_10011795
		add	esp, 14h
		xor	edx, edx
		mov	ecx, edi
		mov	esi, eax
		call	sub_1001430B
		mov	ecx, [esp+278h+var_26C]
		xor	edx, edx
		call	sub_1001430B
		test	esi, esi
		jnz	loc_100113A3
		push	[esp+278h+var_23C] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+278h+var_23C], esi
		jnz	loc_100113AD
		mov	edx, ebx
		mov	ecx, offset aCreateprocessa ; "CreateProcessA"
		call	sub_10002ACE
		jmp	loc_10011318
_TargetCreateProcessA@44 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100114AE(void	*Src, void *, int)
sub_100114AE	proc near		; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+E3p
					; TargetNtOpenProcess(x,x,x,x,x)+C6p

Src		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	ebx, edx
		mov	edi, ecx
		call	sub_100159B0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100114C5
		push	4
		pop	eax
		jmp	short loc_1001152D
; ---------------------------------------------------------------------------

loc_100114C5:				; CODE XREF: sub_100114AE+10j
		push	ebp
		push	2
		pop	eax
		push	eax		; int
		xor	ebp, ebp
		mov	[esi], ebx
		push	ebp		; char
		push	4
		pop	ebx
		push	ebx		; Size
		push	[esp+1Ch+Src]	; Src
		mov	[esi+4], ebp
		mov	ecx, esi
		mov	[esi+3Ch], eax
		push	ebp		; int
		mov	dword ptr [esi+44h], 64h
		call	sub_100118BA
		test	al, al
		jz	short loc_1001152A
		push	2		; int
		push	ebp		; char
		push	ebx		; Size
		push	[esp+1Ch+arg_4]	; Src
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_100118BA
		test	al, al
		jz	short loc_1001152A
		push	[esp+10h+arg_8]
		mov	ecx, edi
		push	esi
		call	sub_10015A29
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1001152A
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1001152A:				; CODE XREF: sub_100114AE+40j
					; sub_100114AE+55j ...
		mov	eax, ebx
		pop	ebp

loc_1001152D:				; CODE XREF: sub_100114AE+15j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100114AE	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011531(int,	void *,	int)
sub_10011531	proc near		; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+91p

Src		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159B0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10011546
		push	4
		pop	eax
		jmp	short loc_100115C0
; ---------------------------------------------------------------------------

loc_10011546:				; CODE XREF: sub_10011531+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+Src]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 0Bh
		push	ebp		; char
		push	ebx		; Size
		mov	[esi+4], ebp
		mov	dword ptr [esi+3Ch], 2
		push	ecx		; Src
		mov	dword ptr [esi+44h], 64h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+Src], eax
		call	sub_100118BA
		test	al, al
		jz	short loc_100115BC
		push	2		; int
		push	ebp		; char
		push	ebx		; Size
		push	[esp+20h+arg_4]	; Src
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_100118BA
		test	al, al
		jz	short loc_100115BC
		push	[esp+14h+arg_8]
		mov	ecx, edi
		push	esi
		call	sub_10015A29
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_100115BC
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_100115BC:				; CODE XREF: sub_10011531+4Fj
					; sub_10011531+64j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_100115C0:				; CODE XREF: sub_10011531+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_10011531	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100115C4(int,	void *,	void *,	int)
sub_100115C4	proc near		; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+98p

Src		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159B0
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100115DC
		push	4
		pop	eax
		jmp	loc_1001166C
; ---------------------------------------------------------------------------

loc_100115DC:				; CODE XREF: sub_100115C4+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+Src]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 0Ch
		push	ebp		; char
		push	ebx		; Size
		mov	[esi+4], ebp
		mov	dword ptr [esi+3Ch], 3
		push	ecx		; Src
		mov	dword ptr [esi+44h], 70h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+Src], eax
		call	sub_1000B0E0
		test	al, al
		jz	short loc_10011668
		push	2		; int
		push	ebp		; char
		push	ebx		; Size
		push	[esp+20h+arg_4]	; Src
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_10011668
		push	2		; int
		push	0		; char
		push	ebx		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, esi
		push	2		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_10011668
		push	[esp+14h+arg_C]
		mov	ecx, edi
		push	esi
		call	sub_10015A29
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_10011668
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10011668:				; CODE XREF: sub_100115C4+52j
					; sub_100115C4+67j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_1001166C:				; CODE XREF: sub_100115C4+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100115C4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011670	proc near		; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+13Cp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001168B

loc_10011683:				; CODE XREF: sub_10011670+59j
					; sub_10011670+7Dj ...
		push	4

loc_10011685:				; CODE XREF: sub_10011670+10Aj
		pop	eax
		jmp	loc_1001178E
; ---------------------------------------------------------------------------

loc_1001168B:				; CODE XREF: sub_10011670+11j
		mov	esi, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_8]
		and	dword ptr [edi+4], 0
		xor	ebx, ebx
		mov	dword ptr [edi], 0Dh
		inc	ebx
		mov	dword ptr [edi+3Ch], 4
		push	ebx		; int
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		push	0		; char
		mov	[esp+20h+var_8], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	short loc_10011683
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+var_8]
		mov	esi, [esi]
		mov	[esp+18h+var_8], esi
		call	sub_1000A353
		push	ebx		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	short loc_10011683
		mov	esi, [esp+18h+arg_8]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	2		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	loc_10011683
		mov	eax, [esp+18h+arg_C]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; Size
		push	eax		; Src
		mov	[esp+28h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+2Ch+var_4], eax
		call	sub_1000D595
		test	al, al
		jz	loc_10011683
		push	[esp+18h+arg_10]
		mov	ecx, ebp
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1001178C
		mov	ecx, [edi+68h]
		add	ecx, edi
		push	ecx		; Src
		lea	ecx, [esp+1Ch+var_8]
		call	sub_1000A3A8
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_1001177F
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_10011685
; ---------------------------------------------------------------------------

loc_1001177F:				; CODE XREF: sub_10011670+F9j
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_1001178C:				; CODE XREF: sub_10011670+E0j
		mov	eax, esi

loc_1001178E:				; CODE XREF: sub_10011670+16j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10011670	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011795	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1B7p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100117B0

loc_100117A8:				; CODE XREF: sub_10011795+59j
					; sub_10011795+7Dj ...
		push	4

loc_100117AA:				; CODE XREF: sub_10011795+10Aj
		pop	eax
		jmp	loc_100118B3
; ---------------------------------------------------------------------------

loc_100117B0:				; CODE XREF: sub_10011795+11j
		mov	esi, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_8]
		and	dword ptr [edi+4], 0
		xor	ebx, ebx
		inc	ebx
		mov	dword ptr [edi], 0Dh
		push	ebx		; int
		mov	esi, [esi]
		mov	dword ptr [edi+3Ch], 4
		push	0		; char
		mov	dword ptr [edi+44h], 7Ch
		mov	[esp+20h+var_8], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	short loc_100117A8
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	short loc_100117A8
		mov	esi, [esp+18h+arg_8]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	2		; int
		mov	ecx, edi
		call	sub_1000D595
		test	al, al
		jz	loc_100117A8
		mov	eax, [esp+18h+arg_C]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; Size
		push	eax		; Src
		mov	[esp+28h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+2Ch+var_4], eax
		call	sub_1000D595
		test	al, al
		jz	loc_100117A8
		push	[esp+18h+arg_10]
		mov	ecx, ebp
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_100118B1
		mov	ecx, [edi+68h]
		add	ecx, edi
		push	ecx		; Src
		lea	ecx, [esp+1Ch+var_8]
		call	sub_1000A3A8
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_100118A4
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_100117AA
; ---------------------------------------------------------------------------

loc_100118A4:				; CODE XREF: sub_10011795+F9j
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_100118B1:				; CODE XREF: sub_10011795+E0j
		mov	eax, esi

loc_100118B3:				; CODE XREF: sub_10011795+16j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10011795	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100118BA(int, void *Src, size_t Size, char,	int)
sub_100118BA	proc near		; CODE XREF: sub_100114AE+39p
					; sub_100114AE+4Ep ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DE88
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 2
		jnb	loc_10011960
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_10011960
		test	esi, esi
		jz	short loc_100118EA
		cmp	[ebp+Src], 0
		jz	short loc_10011960

loc_100118EA:				; CODE XREF: sub_100118BA+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_10011960
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_10011960
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1001192B
		mov	dword ptr [edi+4], 1

loc_1001192B:				; CODE XREF: sub_100118BA+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_10011962
; ---------------------------------------------------------------------------

loc_10011952:				; DATA XREF: .rdata:stru_1002DE88o
		xor	eax, eax	; Exception filter 0 for function 100118BA
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10011956:				; DATA XREF: .rdata:stru_1002DE88o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100118BA
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10011960:				; CODE XREF: sub_100118BA+14j
					; sub_100118BA+20j ...
		xor	al, al

loc_10011962:				; CODE XREF: sub_100118BA+96j
		call	__SEH_epilog4
		retn	14h
sub_100118BA	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1001196A@<eax>(HANDLE hTargetProcessHandle@<ecx>, LPCWSTR lpApplicationName, LPWSTR lpCommandLine,	int, int, int, int, int, int, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
sub_1001196A	proc near		; CODE XREF: sub_10011B9D+69p

lpApplicationName= dword ptr  4
lpCommandLine	= dword	ptr  8
lpStartupInfo	= dword	ptr  24h
lpProcessInformation= dword ptr	 28h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+lpProcessInformation]
		xor	eax, eax
		push	esi		; lpProcessInformation
		push	[esp+10h+lpStartupInfo]	; lpStartupInfo
		mov	ebx, edx
		mov	ebp, ecx
		push	eax		; lpCurrentDirectory
		push	eax		; lpEnvironment
		push	eax		; dwCreationFlags
		push	eax		; bInheritHandles
		push	eax		; lpThreadAttributes
		push	eax		; lpProcessAttributes
		push	[esp+2Ch+lpCommandLine]	; lpCommandLine
		push	[esp+30h+lpApplicationName] ; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_100119F2
		mov	eax, 101C01h
		push	edi
		mov	edi, 100C43h
		test	ebx, ebx
		jz	short loc_100119AD
		mov	eax, 1F0FFFh
		mov	edi, 1F03FFh

loc_100119AD:				; CODE XREF: sub_1001196A+37j
		mov	ebx, ds:GetCurrentProcess
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	eax		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	ebp		; hTargetProcessHandle
		push	dword ptr [esi]	; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_100119D6
		push	dword ptr [esi+4] ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	short loc_100119F1
; ---------------------------------------------------------------------------

loc_100119D6:				; CODE XREF: sub_1001196A+5Dj
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	edi		; dwDesiredAccess
		lea	eax, [esi+4]
		push	eax		; lpTargetHandle
		push	ebp		; hTargetProcessHandle
		push	dword ptr [eax]	; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		neg	eax

loc_100119F1:				; CODE XREF: sub_1001196A+6Aj
		pop	edi

loc_100119F2:				; CODE XREF: sub_1001196A+28j
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001196A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100119F6	proc near		; CODE XREF: sub_1001525E+106p

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ecx
		sub	edx, 7
		jz	short loc_10011A17
		dec	edx
		jnz	short loc_10011A56
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10011A31
		push	6
		jmp	short loc_10011A26
; ---------------------------------------------------------------------------

loc_10011A17:				; CODE XREF: sub_100119F6+Bj
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10011A31
		push	5

loc_10011A26:				; CODE XREF: sub_100119F6+1Fj
		mov	ecx, eax
		call	sub_1000F976
		mov	esi, eax
		jmp	short loc_10011A33
; ---------------------------------------------------------------------------

loc_10011A31:				; CODE XREF: sub_100119F6+1Bj
					; sub_100119F6+2Cj
		xor	esi, esi

loc_10011A33:				; CODE XREF: sub_100119F6+39j
		xor	ebx, ebx
		inc	ebx
		push	ebx
		push	edi
		push	ecx
		push	0
		mov	ecx, esi
		call	sub_1000FB2D
		test	al, al
		jz	short loc_10011A56
		mov	ecx, [esp+10h+arg_0]
		push	esi
		push	0Dh
		call	sub_1000F6D9
		test	al, al
		jnz	short loc_10011A58

loc_10011A56:				; CODE XREF: sub_100119F6+Ej
					; sub_100119F6+4Ej
		xor	bl, bl

loc_10011A58:				; CODE XREF: sub_100119F6+5Ej
		test	esi, esi
		jz	short loc_10011A6B
		mov	ecx, esi
		call	sub_1000FD8D
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10011A6B:				; CODE XREF: sub_100119F6+64j
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		pop	ecx
		retn
sub_100119F6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011A72(int,	LPHANDLE lpTargetHandle)
sub_10011A72	proc near		; CODE XREF: sub_10010A8F+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		sub	esp, 24h
		push	ebx
		push	ebp
		mov	ebp, [esp+2Ch+lpTargetHandle]
		mov	ebx, ecx
		and	[esp+2Ch+lpTargetHandle], 0
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		push	esi
		mov	esi, edx
		lea	edx, [esp+30h+lpTargetHandle]
		and	dword ptr [ebp+0], 0
		push	edi
		call	sub_1001881C
		xor	eax, eax
		lea	edi, [esp+34h+var_14]
		stosd
		stosd
		stosd
		stosd
		stosd
		mov	eax, [ebx+8]
		xor	edi, edi
		mov	[esp+34h+var_20], eax
		mov	eax, [esp+34h+arg_0]
		mov	[esp+34h+var_1C], edi
		mov	[esp+34h+var_1C], eax
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+var_18], 18h
		push	eax
		push	esi
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	esi, eax
		test	esi, esi
		js	short loc_10011AFB
		push	3		; dwOptions
		push	edi		; bInheritHandle
		push	edi		; dwDesiredAccess
		push	ebp		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10011AFD

loc_10011AFB:				; CODE XREF: sub_10011A72+66j
		mov	eax, esi

loc_10011AFD:				; CODE XREF: sub_10011A72+87j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10011A72	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011B05(int,	LPHANDLE lpTargetHandle)
sub_10011B05	proc near		; CODE XREF: sub_10010ABD+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		sub	esp, 24h
		push	ebx
		mov	ebx, [esp+28h+lpTargetHandle]
		and	[esp+28h+lpTargetHandle], 0
		push	ebp
		push	esi
		and	dword ptr [ebx], 0
		mov	ebp, edx
		mov	esi, ecx
		lea	edx, [esp+30h+lpTargetHandle]
		mov	ecx, offset aNtopenprocess ; "NtOpenProcess"
		call	sub_1001881C
		mov	ecx, [esi+8]
		cmp	ecx, [esp+30h+arg_0]
		jz	short loc_10011B39
		mov	eax, 0C0000022h
		jmp	short loc_10011B96
; ---------------------------------------------------------------------------

loc_10011B39:				; CODE XREF: sub_10011B05+2Bj
		push	edi
		xor	eax, eax
		and	[esp+34h+var_1C], 0
		lea	edi, [esp+34h+var_14]
		mov	[esp+34h+var_20], ecx
		stosd
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+var_18], 18h
		push	eax
		push	ebp
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	edi, eax
		test	edi, edi
		js	short loc_10011B93
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	ebx		; lpTargetHandle
		push	dword ptr [esi]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10011B95

loc_10011B93:				; CODE XREF: sub_10011B05+69j
		mov	eax, edi

loc_10011B95:				; CODE XREF: sub_10011B05+8Cj
		pop	edi

loc_10011B96:				; CODE XREF: sub_10011B05+32j
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10011B05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10011B9D(LPCWSTR lpApplicationName, wchar_t *Str, LPPROCESS_INFORMATION lpProcessInformation)
sub_10011B9D	proc near		; CODE XREF: sub_10010BE5+109p

StartupInfo	= _STARTUPINFOW	ptr -44h
lpApplicationName= dword ptr  8
Str		= dword	ptr  0Ch
lpProcessInformation= dword ptr	 10h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		push	ebx
		push	edi
		mov	edi, ecx
		mov	ebx, edx
		cmp	edi, 6
		jz	short loc_10011BB8
		cmp	edi, 5
		jz	short loc_10011BB8
		push	5
		pop	eax
		jmp	short loc_10011C27
; ---------------------------------------------------------------------------

loc_10011BB8:				; CODE XREF: sub_10011B9D+Fj
					; sub_10011B9D+14j
		push	40h		; Size
		lea	eax, [ebp+StartupInfo.lpReserved]
		push	0		; Val
		push	eax		; Dst
		call	memset
		mov	eax, [ebp+Str]
		add	esp, 0Ch
		mov	[ebp+StartupInfo.cb], 44h
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10011BDA
		mov	eax, [eax]

loc_10011BDA:				; CODE XREF: sub_10011B9D+39j
		push	esi
		push	eax		; Str
		call	ds:_wcsdup
		xor	edx, edx
		mov	esi, eax
		mov	eax, [ebp+lpApplicationName]
		cmp	edi, 6
		pop	ecx
		setz	dl
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10011BF8
		mov	eax, [eax]

loc_10011BF8:				; CODE XREF: sub_10011B9D+57j
		push	[ebp+lpProcessInformation] ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		push	ecx		; lpStartupInfo
		mov	ecx, [ebx]	; hTargetProcessHandle
		sub	esp, 18h
		push	esi		; lpCommandLine
		push	eax		; lpApplicationName
		call	sub_1001196A
		add	esp, 28h
		mov	edi, eax
		neg	edi
		sbb	edi, edi
		and	edi, 0FFFFFFFBh
		test	esi, esi
		jz	short loc_10011C23
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_10011C23:				; CODE XREF: sub_10011B9D+7Cj
		lea	eax, [edi+5]
		pop	esi

loc_10011C27:				; CODE XREF: sub_10011B9D+19j
		pop	edi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10011B9D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011C2D	proc near		; DATA XREF: .rdata:1002C9F4o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C9EC
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_10011C4A
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10011C4A:				; CODE XREF: sub_10011C2D+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10011C2D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011C50	proc near		; CODE XREF: sub_10011D5F+7Ap
					; sub_10011EC7+7Ap

Dst		= dword	ptr  4

		push	esi
		mov	esi, edx
		test	ecx, ecx
		jz	short loc_10011C8F
		mov	edx, [esp+4+Dst]
		call	sub_10018724
		test	al, al
		jnz	short loc_10011C66
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10011C66:				; CODE XREF: sub_10011C50+12j
		push	edi
		mov	edi, offset asc_1002BB98 ; "\\"
		mov	ecx, edi
		call	sub_10001ADC
		mov	ecx, [esp+8+Dst]
		push	eax		; int
		push	edi		; Src
		call	sub_10003375
		mov	ecx, [esp+8+Dst]
		push	0FFFFFFFFh
		push	0
		push	esi
		call	sub_100032E1
		pop	edi
		jmp	short loc_10011CA1
; ---------------------------------------------------------------------------

loc_10011C8F:				; CODE XREF: sub_10011C50+5j
		mov	ecx, [esp+4+Dst] ; Dst
		cmp	ecx, esi
		jz	short loc_10011CA1
		push	0FFFFFFFFh	; int
		push	0		; int
		push	esi		; int
		call	sub_100023C2

loc_10011CA1:				; CODE XREF: sub_10011C50+3Dj
					; sub_10011C50+45j
		mov	al, 1
		pop	esi
		retn
sub_10011C50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011CA5	proc near		; DATA XREF: .rdata:1002C9F0o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 10h
		jnz	short loc_10011CDB
		mov	eax, offset _TargetNtCreateKey@32 ; TargetNtCreateKey(x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	loc_10011D59
		mov	ecx, [ebp+arg_0]
		push	11h		; int
		push	offset a_targetntcre_3 ; "_TargetNtCreateKey@32"
		push	1		; int
		push	offset aNtcreatekey ; "NtCreateKey"
		push	offset aNtdll_dll_2 ; "ntdll.dll"
		call	sub_1000D8BF
		jmp	loc_10011D5B
; ---------------------------------------------------------------------------

loc_10011CDB:				; CODE XREF: sub_10011CA5+7j
		cmp	[ebp+arg_4], 11h
		jnz	short loc_10011D59
		push	ebx
		mov	eax, offset _TargetNtOpenKey@16	; TargetNtOpenKey(x,x,x,x)
		push	esi
		mov	esi, offset aNtdll_dll_2 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_10011D0C
		mov	ecx, [ebp+arg_0]
		push	12h		; int
		push	offset a_targetntope_6 ; "_TargetNtOpenKey@16"
		push	1		; int
		push	offset aNtopenkey ; "NtOpenKey"
		push	esi		; void *
		call	sub_1000D8BF
		mov	bl, al
		jmp	short loc_10011D0E
; ---------------------------------------------------------------------------

loc_10011D0C:				; CODE XREF: sub_10011CA5+4Aj
		xor	bl, bl

loc_10011D0E:				; CODE XREF: sub_10011CA5+65j
		call	sub_100063BF
		cmp	dword ptr [eax], 4
		jge	short loc_10011D2D
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jnz	short loc_10011D53
		call	sub_100063BF
		cmp	dword ptr [eax+10h], 2
		jnz	short loc_10011D53

loc_10011D2D:				; CODE XREF: sub_10011CA5+71j
		mov	eax, offset _TargetNtOpenKeyEx@20 ; TargetNtOpenKeyEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_10011D4F
		mov	ecx, [ebp+arg_0]
		push	13h		; int
		push	offset a_targetntope_7 ; "_TargetNtOpenKeyEx@20"
		push	1		; int
		push	offset aNtopenkeyex ; "NtOpenKeyEx"
		push	esi		; void *
		call	sub_1000D8BF
		jmp	short loc_10011D51
; ---------------------------------------------------------------------------

loc_10011D4F:				; CODE XREF: sub_10011CA5+8Fj
		xor	eax, eax

loc_10011D51:				; CODE XREF: sub_10011CA5+A8j
		and	bl, al

loc_10011D53:				; CODE XREF: sub_10011CA5+7Bj
					; sub_10011CA5+86j
		pop	esi
		mov	al, bl
		pop	ebx
		jmp	short loc_10011D5B
; ---------------------------------------------------------------------------

loc_10011D59:				; CODE XREF: sub_10011CA5+10j
					; sub_10011CA5+3Aj
		xor	al, al

loc_10011D5B:				; CODE XREF: sub_10011CA5+31j
					; sub_10011CA5+B2j
		pop	ebp
		retn	8
sub_10011CA5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011D5F	proc near		; DATA XREF: .rdata:1002C9BCo

hSourceHandle	= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
TargetHandle	= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[esp+4Ch+var_40], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [esp+58h+var_1C]
		push	edi
		mov	[esp+5Ch+hSourceHandle], eax
		call	sub_1000388D
		mov	ecx, [esp+58h+hSourceHandle]
		test	ecx, ecx
		jz	short loc_10011DD2
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+64h+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[esp+6Ch+hSourceHandle]	; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10011DE3
		push	[esp+58h+hSourceHandle]
		lea	ecx, [esp+5Ch+var_40]
		call	sub_100045FD
		mov	ecx, [esp+58h+hSourceHandle]

loc_10011DD2:				; CODE XREF: sub_10011D5F+3Bj
		lea	eax, [esp+58h+var_1C]
		mov	edx, edi
		push	eax
		call	sub_10011C50
		pop	ecx
		test	al, al
		jnz	short loc_10011DEA

loc_10011DE3:				; CODE XREF: sub_10011D5F+60j
		xor	bl, bl
		jmp	loc_10011E9B
; ---------------------------------------------------------------------------

loc_10011DEA:				; CODE XREF: sub_10011D5F+82j
		cmp	[esp+58h+var_8], 8
		mov	eax, [esp+58h+var_1C]
		jnb	short loc_10011DF9
		lea	eax, [esp+58h+var_1C]

loc_10011DF9:				; CODE XREF: sub_10011D5F+94j
		xor	edx, edx
		mov	[esp+58h+var_3C], eax
		inc	edx
		mov	[esp+58h+var_30], 2
		lea	eax, [esp+58h+var_2C]
		mov	ecx, edx

loc_10011E0E:				; CODE XREF: sub_10011D5F+BAj
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10011E0E
		mov	ecx, [ebx+10h]
		lea	eax, [esp+58h+var_3C]
		mov	[esp+58h+var_28], eax
		lea	eax, [ebp+arg_10]
		mov	[esp+58h+var_20], eax
		lea	eax, [esp+58h+var_30]
		push	eax
		push	10h
		mov	[esp+60h+var_2C], edx
		mov	[esp+60h+var_24], 2
		call	sub_10015057
		mov	edx, [esi+4]
		lea	ecx, [esp+58h+var_44]
		push	ecx		; int
		and	[esp+5Ch+var_44], 0
		lea	ecx, [esp+5Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+60h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_18]	; int
		mov	ecx, eax
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[esp+70h+hSourceHandle]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_100128B4
		add	esp, 24h
		mov	bl, 1
		test	al, al
		jnz	short loc_10011E86
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_10011E9B
; ---------------------------------------------------------------------------

loc_10011E86:				; CODE XREF: sub_10011D5F+11Cj
		mov	eax, [esp+58h+var_44]
		mov	[esi+1Ch], eax
		mov	eax, [esp+58h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+58h+TargetHandle]
		mov	[esi+18h], eax

loc_10011E9B:				; CODE XREF: sub_10011D5F+86j
					; sub_10011D5F+125j
		push	0
		push	1
		lea	ecx, [esp+60h+var_1C]
		call	sub_100022FA
		lea	ecx, [esp+58h+var_40]
		call	sub_10004633
		mov	ecx, [esp+58h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	1Ch
sub_10011D5F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011EC7	proc near		; DATA XREF: .rdata:1002C9E8o

hSourceHandle	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
TargetHandle	= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[esp+44h+var_40], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [esp+50h+var_1C]
		push	edi
		mov	[esp+54h+hSourceHandle], eax
		call	sub_1000388D
		mov	ecx, [esp+50h+hSourceHandle]
		test	ecx, ecx
		jz	short loc_10011F3A
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+5Ch+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[esp+64h+hSourceHandle]	; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10011F4B
		push	[esp+50h+hSourceHandle]
		lea	ecx, [esp+54h+var_40]
		call	sub_100045FD
		mov	ecx, [esp+50h+hSourceHandle]

loc_10011F3A:				; CODE XREF: sub_10011EC7+3Bj
		lea	eax, [esp+50h+var_1C]
		mov	edx, edi
		push	eax
		call	sub_10011C50
		pop	ecx
		test	al, al
		jnz	short loc_10011F52

loc_10011F4B:				; CODE XREF: sub_10011EC7+60j
		xor	bl, bl
		jmp	loc_10011FEC
; ---------------------------------------------------------------------------

loc_10011F52:				; CODE XREF: sub_10011EC7+82j
		cmp	[esp+50h+var_8], 8
		mov	eax, [esp+50h+var_1C]
		jnb	short loc_10011F61
		lea	eax, [esp+50h+var_1C]

loc_10011F61:				; CODE XREF: sub_10011EC7+94j
		xor	edx, edx
		mov	[esp+50h+var_34], eax
		inc	edx
		mov	[esp+50h+var_30], 2
		lea	eax, [esp+50h+var_2C]
		mov	ecx, edx

loc_10011F76:				; CODE XREF: sub_10011EC7+BAj
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10011F76
		mov	ecx, [ebx+10h]
		lea	eax, [esp+50h+var_34]
		mov	[esp+50h+var_28], eax
		lea	eax, [ebp+arg_10]
		mov	[esp+50h+var_20], eax
		lea	eax, [esp+50h+var_30]
		push	eax
		push	11h
		mov	[esp+58h+var_2C], edx
		mov	[esp+58h+var_24], 2
		call	sub_10015057
		mov	edx, [esi+4]
		lea	ecx, [esp+50h+var_3C]
		push	ecx		; int
		lea	ecx, [esp+54h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_10]	; int
		mov	ecx, eax
		push	[esp+5Ch+hSourceHandle]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_10012934
		add	esp, 18h
		mov	bl, 1
		test	al, al
		jnz	short loc_10011FDE
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_10011FEC
; ---------------------------------------------------------------------------

loc_10011FDE:				; CODE XREF: sub_10011EC7+10Cj
		mov	eax, [esp+50h+var_3C]
		mov	[esi+10h], eax
		mov	eax, [esp+50h+TargetHandle]
		mov	[esi+18h], eax

loc_10011FEC:				; CODE XREF: sub_10011EC7+86j
					; sub_10011EC7+115j
		push	0
		push	1
		lea	ecx, [esp+58h+var_1C]
		call	sub_100022FA
		lea	ecx, [esp+50h+var_40]
		call	sub_10004633
		mov	ecx, [esp+50h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_10011EC7	endp

; Exported entry  24. _TargetNtCreateKey@32

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateKey(x, x, x, x, x, x,	x, x)
		public _TargetNtCreateKey@32
_TargetNtCreateKey@32 proc near		; DATA XREF: sub_10011CA5+9o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
Dst		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_28		= byte ptr -28h
var_20		= dword	ptr -20h
Src		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	4Ch
		push	offset stru_1002DEA8
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_1C]
		push	ebx
		push	[ebp+arg_18]
		mov	esi, [ebp+arg_14]
		push	esi
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		mov	ecx, [ebp+arg_4]
		push	ecx
		call	[ebp+arg_0]
		mov	edi, eax
		mov	[ebp+var_20], edi
		test	edi, edi
		jns	loc_100121A9
		cmp	edi, 0C0000034h
		jz	short loc_1001206C
		mov	eax, [ebp+arg_C]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002A52
		pop	ecx

loc_1001206C:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+3Aj
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_100121A7
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+arg_4]
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_100121A7
		test	ebx, ebx
		jz	short loc_100120AA
		push	1
		push	4
		pop	edx
		mov	ecx, ebx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_100121A7

loc_100120AA:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+7Bj
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_100120BE
		cmp	[esi+4], ebx
		jz	short loc_100120BE
		cmp	[esi], bx
		jnz	loc_100121A7

loc_100120BE:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+96j
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+9Bj
		cmp	[ebp+arg_18], 0
		jnz	loc_100121A7
		call	sub_10013DD2
		mov	esi, eax
		test	esi, esi
		jz	loc_100121A7
		mov	[ebp+Src], ebx
		mov	[ebp+arg_0], ebx
		lea	eax, [ebp+arg_0]
		push	eax
		lea	eax, [ebp+Src]
		push	eax
		lea	edx, [ebp+arg_14]
		mov	ecx, [ebp+arg_C]
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_100121A7
		cmp	[ebp+arg_14], 0
		jz	loc_100121A7
		push	esi
		lea	ecx, [ebp+var_28]
		call	sub_10015A07
		mov	[ebp+var_5C], ebx
		push	30h		; Size
		push	ebx		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_0]
		push	eax		; int
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+arg_14]
		push	eax		; int
		lea	ecx, [ebp+var_28]
		call	sub_10012351
		add	esp, 28h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, [ebp+arg_14]
		call	sub_1001430B
		test	esi, esi
		jnz	short loc_100121A7
		cmp	[ebp+var_54], esi
		jl	short loc_100121A7
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		mov	eax, [ebp+var_4C]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	ecx, [ebp+arg_1C]
		test	ecx, ecx
		jz	short loc_1001216F
		mov	eax, [ebp+var_48]
		mov	[ecx], eax

loc_1001216F:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+150j
		mov	edi, [ebp+var_54]
		mov	[ebp+var_20], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+arg_C]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_100121A7
; ---------------------------------------------------------------------------

loc_10012196:				; DATA XREF: .rdata:stru_1002DEA8o
		xor	eax, eax	; Exception filter 0 for function 10012018
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001219A:				; DATA XREF: .rdata:stru_1002DEA8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012018
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_20]

loc_100121A7:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+5Dj
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+73j ...
		mov	eax, edi

loc_100121A9:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+2Ej
		call	__SEH_epilog4
		retn	20h
_TargetNtCreateKey@32 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100121B1	proc near		; CODE XREF: TargetNtOpenKey(x,x,x,x)+3Ep
					; TargetNtOpenKeyEx(x,x,x,x,x)+47p

var_64		= dword	ptr -64h
Dst		= byte ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_30		= byte ptr -30h
Src		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	54h
		push	offset stru_1002DEC8
		call	__SEH_prolog4
		mov	ebx, edx
		mov	edi, ecx
		mov	[ebp+var_20], edi
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jle	loc_100122AC
		push	1
		push	4
		pop	edx
		mov	ecx, ebx
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_100122AC
		call	sub_10013DD2
		mov	esi, eax
		test	esi, esi
		jz	loc_100122AC
		lea	eax, [ebp+var_24]
		push	eax
		lea	eax, [ebp+Src]
		push	eax
		lea	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_4]
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_100122AC
		cmp	[ebp+var_1C], 0
		jz	loc_100122AC
		push	esi
		lea	ecx, [ebp+var_30]
		call	sub_10015A07
		and	[ebp+var_64], 0
		push	30h		; Size
		push	0		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		lea	eax, [ebp+var_64]
		push	eax		; int
		lea	eax, [ebp+arg_0]
		push	eax		; void *
		lea	eax, [ebp+var_24]
		push	eax		; int
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	ecx, [ebp+var_30]
		call	sub_1001245D
		add	esp, 20h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, [ebp+var_1C]
		call	sub_1001430B
		test	esi, esi
		jnz	short loc_100122AC
		cmp	[ebp+var_5C], esi
		jl	short loc_100122AC
		and	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, [ebp+var_54]
		mov	[ebx], eax
		mov	edi, [ebp+var_5C]
		mov	[ebp+var_20], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenkeyEx ; "NtOpenKey[Ex]"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_100122AC
; ---------------------------------------------------------------------------

loc_1001229B:				; DATA XREF: .rdata:stru_1002DEC8o
		xor	eax, eax	; Exception filter 0 for function 100121B1
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001229F:				; DATA XREF: .rdata:stru_1002DEC8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100121B1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_20]

loc_100122AC:				; CODE XREF: sub_100121B1+1Cj
					; sub_100121B1+31j ...
		mov	eax, edi
		call	__SEH_epilog4
		retn	8
sub_100121B1	endp

; Exported entry  28. _TargetNtOpenKey@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKey(x, x, x, x)
		public _TargetNtOpenKey@16
_TargetNtOpenKey@16 proc near		; DATA XREF: sub_10011CA5+3Do
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_100122F9
		cmp	esi, 0C0000034h
		jz	short loc_100122EB
		mov	edx, [edi+8]
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A52
		pop	ecx

loc_100122EB:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+1Ej
		mov	edx, [ebp+arg_4]
		mov	ecx, esi
		push	edi
		push	[ebp+arg_8]
		call	sub_100121B1

loc_100122F9:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+16j
		pop	edi
		pop	esi
		pop	ebp
		retn	10h
_TargetNtOpenKey@16 endp

; Exported entry  29. _TargetNtOpenKeyEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKeyEx(x, x, x, x, x)
		public _TargetNtOpenKeyEx@20
_TargetNtOpenKeyEx@20 proc near		; DATA XREF: sub_10011CA5:loc_10011D2Do
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_10]
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_1001234B
		cmp	[ebp+arg_10], 0
		jnz	short loc_1001234B
		cmp	esi, 0C0000034h
		jz	short loc_1001233D
		mov	edx, [edi+8]
		mov	ecx, offset aNtopenkeyex ; "NtOpenKeyEx"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A52
		pop	ecx

loc_1001233D:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+27j
		mov	edx, [ebp+arg_4]
		mov	ecx, esi
		push	edi
		push	[ebp+arg_8]
		call	sub_100121B1

loc_1001234B:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+19j
					; TargetNtOpenKeyEx(x,x,x,x,x)+1Fj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
_TargetNtOpenKeyEx@20 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012351(int,	void *Src, int,	void *,	void *,	void *,	int)
sub_10012351	proc near		; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+123p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10012369
		push	4
		pop	eax
		jmp	loc_10012459
; ---------------------------------------------------------------------------

loc_10012369:				; CODE XREF: sub_10012351+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 10h
		mov	dword ptr [edi+3Ch], 6
		mov	dword ptr [edi+44h], 94h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A353
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		call	sub_10012537
		test	al, al
		jnz	short loc_100123B3
		push	4
		pop	eax
		jmp	loc_10012457
; ---------------------------------------------------------------------------

loc_100123B3:				; CODE XREF: sub_10012351+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_10012537
		test	al, al
		jz	loc_10012455
		mov	eax, [esp+14h+arg_8]
		mov	ecx, edi
		push	esi		; int
		push	0		; char
		push	esi		; Size
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; Src
		push	2		; int
		call	sub_10012537
		test	al, al
		jz	short loc_10012455
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, edi
		push	3		; int
		call	sub_10012537
		test	al, al
		jz	short loc_10012455
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_10] ; Src
		mov	ecx, edi
		push	esi		; int
		call	sub_10012537
		test	al, al
		jz	short loc_10012455
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_14] ; Src
		mov	ecx, edi
		push	5		; int
		call	sub_10012537
		test	al, al
		jz	short loc_10012455
		push	[esp+14h+arg_18]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10012455
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10012455:				; CODE XREF: sub_10012351+78j
					; sub_10012351+9Cj ...
		mov	eax, esi

loc_10012457:				; CODE XREF: sub_10012351+5Dj
		pop	esi
		pop	ebp

loc_10012459:				; CODE XREF: sub_10012351+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10012351	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001245D(int,	void *Src, int,	void *,	int)
sub_1001245D	proc near		; CODE XREF: sub_100121B1+9Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10012475
		push	4
		pop	eax
		jmp	loc_10012533
; ---------------------------------------------------------------------------

loc_10012475:				; CODE XREF: sub_1001245D+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 11h
		mov	dword ptr [edi+3Ch], 4
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A353
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		call	sub_1000D595
		test	al, al
		jnz	short loc_100124BC
		push	4
		pop	eax
		jmp	short loc_10012531
; ---------------------------------------------------------------------------

loc_100124BC:				; CODE XREF: sub_1001245D+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1001252F
		mov	eax, [esp+14h+arg_8]
		mov	ecx, edi
		push	esi		; int
		push	0		; char
		push	esi		; Size
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; Src
		push	2		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1001252F
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_C]	; Src
		mov	ecx, edi
		push	3		; int
		call	sub_1000D595
		test	al, al
		jz	short loc_1001252F
		push	[esp+14h+arg_10]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1001252F
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1001252F:				; CODE XREF: sub_1001245D+75j
					; sub_1001245D+95j ...
		mov	eax, esi

loc_10012531:				; CODE XREF: sub_1001245D+5Dj
		pop	esi
		pop	ebp

loc_10012533:				; CODE XREF: sub_1001245D+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1001245D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10012537(int, void *Src, size_t Size, char,	int)
sub_10012537	proc near		; CODE XREF: sub_10012351+51p
					; sub_10012351+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
Src		= dword	ptr  0Ch
Size		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DEE8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 6
		jnb	loc_100125DD
		mov	esi, [ebp+Size]
		cmp	esi, 0FFFFFFFFh
		jz	loc_100125DD
		test	esi, esi
		jz	short loc_10012567
		cmp	[ebp+Src], 0
		jz	short loc_100125DD

loc_10012567:				; CODE XREF: sub_10012537+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_100125DD
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_100125DD
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; Size
		push	[ebp+Src]	; Src
		push	eax		; Dst
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_100125A8
		mov	dword ptr [edi+4], 1

loc_100125A8:				; CODE XREF: sub_10012537+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_100125DF
; ---------------------------------------------------------------------------

loc_100125CF:				; DATA XREF: .rdata:stru_1002DEE8o
		xor	eax, eax	; Exception filter 0 for function 10012537
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100125D3:				; DATA XREF: .rdata:stru_1002DEE8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10012537
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_100125DD:				; CODE XREF: sub_10012537+14j
					; sub_10012537+20j ...
		xor	al, al

loc_100125DF:				; CODE XREF: sub_10012537+96j
		call	__SEH_epilog4
		retn	14h
sub_10012537	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100125E7	proc near		; CODE XREF: sub_1001268B+30p
					; sub_10012718+2Ep

var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
Dst		= dword	ptr -3Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, ecx
		xor	ebx, ebx
		lea	edx, [ebp+var_4C]
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		mov	[ebp+var_4C], ebx
		call	sub_1001881C
		lea	edx, [ebp+var_48]
		mov	[ebp+var_48], ebx
		mov	ecx, offset aNtclose ; "NtClose"
		call	sub_1001881C
		lea	edx, [ebp+var_50]
		mov	[ebp+var_50], ebx
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_1001881C
		push	esi
		push	dword ptr [edi]
		lea	eax, [ebp+var_44]
		push	eax
		call	[ebp+var_4C]
		test	eax, eax
		js	short loc_1001267A
		push	34h		; Size
		lea	eax, [ebp+Dst]
		mov	[ebp+var_40], ebx
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+var_40]
		push	ebx
		push	38h
		push	eax
		push	ebx
		push	[ebp+var_44]
		call	[ebp+var_50]
		push	[ebp+var_44]
		mov	esi, eax
		call	[ebp+var_48]
		test	esi, esi
		jns	short loc_1001266E
		mov	eax, esi
		jmp	short loc_1001267A
; ---------------------------------------------------------------------------

loc_1001266E:				; CODE XREF: sub_100125E7+81j
		mov	eax, [ebp+Dst]
		and	eax, 0A0020019h
		mov	[edi], eax
		xor	eax, eax

loc_1001267A:				; CODE XREF: sub_100125E7+55j
					; sub_100125E7+85j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100125E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_1001268B@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int, int, int, int, HANDLE hTargetProcessHandle)
sub_1001268B	proc near		; CODE XREF: sub_100128B4+6Ap

hSourceHandle	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
hTargetProcessHandle= dword ptr	 1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		xor	ebx, ebx
		mov	[ebp+var_4], esi
		lea	edx, [ebp+var_8]
		mov	[ebp+var_8], ebx
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_1001881C
		test	esi, 2000000h
		jz	short loc_100126CE
		mov	ecx, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		call	sub_100125E7
		test	eax, eax
		jns	short loc_100126CB
		mov	eax, 0C0000022h
		jmp	short loc_10012711
; ---------------------------------------------------------------------------

loc_100126CB:				; CODE XREF: sub_1001268B+37j
		mov	esi, [ebp+var_4]

loc_100126CE:				; CODE XREF: sub_1001268B+28j
		push	[ebp+arg_10]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		lea	eax, [ebp+hSourceHandle]
		push	[ebp+arg_C]
		push	ebx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	esi
		push	eax
		call	[ebp+var_8]
		test	eax, eax
		js	short loc_10012711
		push	3		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		push	edi		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_10012711:				; CODE XREF: sub_1001268B+3Ej
					; sub_1001268B+5Ej
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001268B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_10012718@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	HANDLE hTargetProcessHandle)
sub_10012718	proc near		; CODE XREF: sub_10012934+57p

hSourceHandle	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
hTargetProcessHandle= dword ptr	 0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		and	[ebp+var_8], 0
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		lea	edx, [ebp+var_8]
		mov	[ebp+var_4], esi
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		call	sub_1001881C
		test	esi, 2000000h
		jz	short loc_10012759
		mov	ecx, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		call	sub_100125E7
		test	eax, eax
		jns	short loc_10012756
		mov	eax, 0C0000022h
		jmp	short loc_10012794
; ---------------------------------------------------------------------------

loc_10012756:				; CODE XREF: sub_10012718+35j
		mov	esi, [ebp+var_4]

loc_10012759:				; CODE XREF: sub_10012718+26j
		push	[ebp+arg_0]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		lea	eax, [ebp+hSourceHandle]
		push	esi
		push	eax
		call	[ebp+var_8]
		test	eax, eax
		js	short loc_10012794
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	edi		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_10012794:				; CODE XREF: sub_10012718+3Cj
					; sub_10012718+52j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10012718	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_1001279A@<eax>(void *Src@<ecx>, int)
sub_1001279A	proc near		; CODE XREF: sub_1001525E+E4p

var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_30		= byte ptr -30h
Dst		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		and	[ebp+var_44], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ecx		; Src
		lea	ecx, [ebp+Dst]	; Dst
		mov	edi, edx
		call	sub_10001C68
		cmp	[ebp+var_10], 0
		jz	loc_10012893
		sub	esp, 18h
		lea	eax, [ebp+Dst]
		mov	ecx, esp
		push	eax
		call	sub_1000388D
		lea	ecx, [ebp+Dst]
		call	sub_10018078
		add	esp, 18h
		test	al, al
		jz	loc_10012893
		cmp	[ebp+var_C], 8
		mov	esi, [ebp+Dst]
		jnb	short loc_100127F6
		lea	esi, [ebp+Dst]

loc_100127F6:				; CODE XREF: sub_1001279A+57j
		push	3
		lea	ecx, [ebp+var_40]
		call	sub_1000F976
		push	3
		lea	ecx, [ebp+var_30]
		call	sub_1000F976
		sub	edi, 0Bh
		jz	short loc_10012826
		dec	edi
		jz	short loc_10012849

loc_10012812:				; CODE XREF: sub_1001279A+BFj
					; sub_1001279A+D0j ...
		xor	bl, bl

loc_10012814:				; CODE XREF: sub_1001279A+F7j
		lea	ecx, [ebp+var_30]
		call	sub_1000FD8D
		lea	ecx, [ebp+var_40]
		call	sub_1000FD8D
		jmp	short loc_10012895
; ---------------------------------------------------------------------------

loc_10012826:				; CODE XREF: sub_1001279A+73j
		push	1
		mov	edi, 5DFDFFE6h
		lea	ecx, [ebp+var_40]
		push	edi
		push	1
		push	1
		call	sub_1000FC65
		push	1
		push	edi
		push	1
		push	1
		lea	ecx, [ebp+var_30]
		call	sub_1000FC65

loc_10012849:				; CODE XREF: sub_1001279A+76j
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_30]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_10012812
		lea	eax, [ebp+var_30]
		mov	ecx, ebx
		push	eax
		push	10h
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10012812
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_40]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_10012812
		lea	eax, [ebp+var_40]
		mov	ecx, ebx
		push	eax
		push	11h
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10012812
		mov	bl, 1
		jmp	short loc_10012814
; ---------------------------------------------------------------------------

loc_10012893:				; CODE XREF: sub_1001279A+29j
					; sub_1001279A+4Aj
		xor	bl, bl

loc_10012895:				; CODE XREF: sub_1001279A+8Aj
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		mov	ecx, [ebp+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001279A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100128B4(int,	int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_100128B4	proc near		; CODE XREF: sub_10011D5F+110p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
lpTargetHandle	= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_100128D1

loc_100128C4:				; CODE XREF: sub_100128B4+21j
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_1001292D
; ---------------------------------------------------------------------------

loc_100128D1:				; CODE XREF: sub_100128B4+Ej
		cmp	[ebp+arg_14], 0
		jnz	short loc_100128C4
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		xor	ebx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_24], ebx
		stosd
		mov	[ebp+var_A], ebx
		mov	[ebp+var_6], bx
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	[ebp+arg_8]
		call	sub_1001541F
		mov	edx, [ebp+arg_C]
		lea	eax, [ebp+var_24]
		add	esp, 0Ch
		push	dword ptr [esi]	; hTargetProcessHandle
		push	[ebp+arg_20]	; int
		push	ebx		; int
		push	ecx		; int
		push	[ebp+arg_10]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	eax		; int
		call	sub_1001268B
		mov	ecx, [ebp+arg_1C]
		add	esp, 18h
		mov	[ecx], eax
		mov	al, 1

loc_1001292D:				; CODE XREF: sub_100128B4+1Bj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_100128B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10012934(int,	int, int, int, LPHANDLE	lpTargetHandle,	int)
sub_10012934	proc near		; CODE XREF: sub_10011EC7+100p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
lpTargetHandle	= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1001294E
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_10012997
; ---------------------------------------------------------------------------

loc_1001294E:				; CODE XREF: sub_10012934+Dj
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		mov	[ebp+var_20], eax
		lea	edi, [ebp+var_1C]
		mov	[ebp+var_8], ax
		mov	[ebp+var_6], eax
		mov	[ebp+var_2], ax
		stosd
		mov	ecx, [ebp+arg_0]
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	[ebp+arg_8]
		call	sub_1001541F
		mov	edx, [ebp+arg_C]
		lea	eax, [ebp+var_20]
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		add	esp, 0Ch
		push	dword ptr [esi]	; hTargetProcessHandle
		push	eax		; int
		call	sub_10012718
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+arg_14]
		mov	[ecx], eax

loc_10012997:				; CODE XREF: sub_10012934+18j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10012934	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001299F	proc near		; DATA XREF: .rdata:1002C044o
					; .rdata:1002C05Co ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_14], 0
		push	esi
		mov	esi, ecx
		jz	short loc_10012A0C
		cmp	[ebp+arg_18], 0
		jz	short loc_10012A0C
		cmp	[ebp+arg_0], 0
		jz	short loc_10012A0C
		cmp	[ebp+arg_8], 0
		jz	short loc_10012A0C
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		cmp	[ebp+arg_18], eax
		jnb	short loc_100129CE
		mov	eax, 0C0000023h
		jmp	short loc_10012A11
; ---------------------------------------------------------------------------

loc_100129CE:				; CODE XREF: sub_1001299F+26j
		cmp	[ebp+arg_10], 0
		jnz	short loc_100129E9
		mov	eax, [esi]
		lea	ecx, [ebp+arg_10]
		push	ecx
		push	[ebp+arg_C]
		mov	ecx, esi
		push	[ebp+arg_4]
		call	dword ptr [eax+8]
		test	eax, eax
		js	short loc_10012A11

loc_100129E9:				; CODE XREF: sub_1001299F+33j
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	ecx, eax
		test	ecx, ecx
		jns	short loc_10012A04

loc_10012A00:				; CODE XREF: sub_1001299F+6Bj
		mov	eax, ecx
		jmp	short loc_10012A11
; ---------------------------------------------------------------------------

loc_10012A04:				; CODE XREF: sub_1001299F+5Fj
		mov	eax, [ebp+arg_10]
		mov	[esi+8], eax
		jmp	short loc_10012A00
; ---------------------------------------------------------------------------

loc_10012A0C:				; CODE XREF: sub_1001299F+Aj
					; sub_1001299F+10j ...
		mov	eax, 0C000000Dh

loc_10012A11:				; CODE XREF: sub_1001299F+2Dj
					; sub_1001299F+48j ...
		pop	esi
		pop	ebp
		retn	1Ch
sub_1001299F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012A16	proc near		; CODE XREF: sub_10012AC6j
					; DATA XREF: .rdata:1002C038o ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_10012A29
		mov	eax, 0C000000Dh
		jmp	short loc_10012A63
; ---------------------------------------------------------------------------

loc_10012A29:				; CODE XREF: sub_10012A16+Aj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100058C0
		test	al, al
		jnz	short loc_10012A46
		mov	eax, 0C000007Bh
		jmp	short loc_10012A63
; ---------------------------------------------------------------------------

loc_10012A46:				; CODE XREF: sub_10012A16+27j
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_1000578C
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10012A61
		mov	eax, 0C000007Ah
		jmp	short loc_10012A63
; ---------------------------------------------------------------------------

loc_10012A61:				; CODE XREF: sub_10012A16+42j
		xor	eax, eax

loc_10012A63:				; CODE XREF: sub_10012A16+11j
					; sub_10012A16+2Ej ...
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10012A16	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012A69	proc near		; CODE XREF: sub_10009A54+41p
					; sub_100156B4+6Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	[esp+arg_4], 1Eh
		jnb	short loc_10012A74
		xor	al, al
		jmp	short locret_10012AC3
; ---------------------------------------------------------------------------

loc_10012A74:				; CODE XREF: sub_10012A69+5j
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jz	short loc_10012AB1
		and	dword ptr [ecx+10h], 0
		mov	eax, 0C35Ah
		and	dword ptr [ecx+18h], 0
		mov	dword ptr [ecx], 5208EC83h
		mov	dword ptr [ecx+4], 0C24548Bh
		mov	dword ptr [ecx+8], 8245489h
		mov	dword ptr [ecx+0Ch], 0C2444C7h
		mov	dword ptr [ecx+14h], 42444C7h
		mov	[ecx+1Ch], ax
		jmp	short loc_10012AB3
; ---------------------------------------------------------------------------

loc_10012AB1:				; CODE XREF: sub_10012A69+11j
		xor	ecx, ecx

loc_10012AB3:				; CODE XREF: sub_10012A69+46j
		mov	eax, [esp+arg_C]
		mov	[ecx+18h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+10h], eax
		mov	al, 1

locret_10012AC3:			; CODE XREF: sub_10012A69+9j
		retn	10h
sub_10012A69	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame thunk

sub_10012AC6	proc near		; DATA XREF: .rdata:1002C03Co
					; .rdata:1002C24Co ...
		jmp	sub_10012A16
sub_10012AC6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012ACB	proc near		; CODE XREF: sub_10012D92+1Cp
					; sub_10013563+129p

var_6C		= dword	ptr -6Ch
phNewToken	= dword	ptr -68h
var_64		= dword	ptr -64h
DisableSidCount	= dword	ptr -60h
RestrictedSidCount= dword ptr -5Ch
SidsToDisable	= dword	ptr -58h
lpTargetHandle	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 70h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		and	[esp+70h+DisableSidCount], 0
		mov	eax, [esp+70h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+80h+lpTargetHandle], eax
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10012AFC
		mov	eax, 3F0h
		jmp	loc_10012D7D
; ---------------------------------------------------------------------------

loc_10012AFC:				; CODE XREF: sub_10012ACB+25j
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		push	44h
		pop	ecx
		idiv	ecx
		mov	ebp, [edi+10h]
		mov	esi, eax
		sub	ebp, [edi+0Ch]
		mov	eax, [edi+4]
		sub	eax, [edi]
		cdq
		idiv	ecx
		and	[esp+80h+SidsToDisable], 0
		sar	ebp, 3
		mov	ebx, eax
		mov	[esp+80h+var_6C], ecx
		mov	[esp+80h+DisableSidCount], esi
		mov	[esp+80h+RestrictedSidCount], ebx
		mov	[esp+80h+var_64], ebp
		push	8
		pop	edx
		test	esi, esi
		jz	short loc_10012B94
		xor	ecx, ecx
		mov	eax, esi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		pop	ecx
		mov	ecx, eax
		xor	esi, esi
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		idiv	[esp+80h+var_6C]
		mov	[esp+80h+SidsToDisable], ecx
		test	eax, eax
		jz	short loc_10012B91
		push	44h
		xor	ebx, ebx
		pop	ebp

loc_10012B69:				; CODE XREF: sub_10012ACB+BCj
		mov	dword ptr [ecx+esi*8+4], 10h
		mov	eax, [edi+18h]
		add	eax, ebx
		add	ebx, ebp
		mov	[ecx+esi*8], eax
		inc	esi
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		idiv	ebp
		cmp	esi, eax
		jb	short loc_10012B69
		mov	ebp, [esp+80h+var_64]
		mov	ebx, [esp+80h+RestrictedSidCount]

loc_10012B91:				; CODE XREF: sub_10012ACB+97j
		push	8
		pop	edx

loc_10012B94:				; CODE XREF: sub_10012ACB+6Cj
		xor	esi, esi
		mov	[esp+80h+var_6C], esi
		test	ebx, ebx
		jz	short loc_10012BDA
		xor	ecx, ecx
		mov	eax, ebx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		xor	ecx, ecx
		mov	[esp+80h+var_6C], esi
		test	ebx, ebx
		jz	short loc_10012BDA
		push	44h
		xor	edx, edx
		pop	ebp

loc_10012BC3:				; CODE XREF: sub_10012ACB+109j
		and	dword ptr [esi+ecx*8+4], 0
		mov	eax, [edi]
		add	eax, edx
		add	edx, ebp
		mov	[esi+ecx*8], eax
		inc	ecx
		cmp	ecx, ebx
		jb	short loc_10012BC3
		mov	ebp, [esp+80h+var_64]

loc_10012BDA:				; CODE XREF: sub_10012ACB+D1j
					; sub_10012ACB+F1j
		xor	ebx, ebx
		test	ebp, ebp
		jz	short loc_10012C27
		xor	ecx, ecx
		mov	eax, ebp
		push	0Ch
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		and	[esp+84h+var_64], 0
		mov	ebx, eax
		pop	ecx
		test	ebp, ebp
		jz	short loc_10012C27
		mov	esi, [esp+80h+var_64]
		mov	edx, ebx

loc_10012C08:				; CODE XREF: sub_10012ACB+156j
		and	dword ptr [edx+8], 0
		mov	ecx, [edi+0Ch]
		mov	eax, [ecx+esi*8]
		mov	[edx], eax
		lea	edx, [edx+0Ch]
		mov	eax, [ecx+esi*8+4]
		inc	esi
		mov	[edx-8], eax
		cmp	esi, ebp
		jb	short loc_10012C08
		mov	esi, [esp+80h+var_6C]

loc_10012C27:				; CODE XREF: sub_10012ACB+113j
					; sub_10012ACB+135j
		and	[esp+80h+phNewToken], 0
		mov	ecx, [esp+80h+DisableSidCount]
		mov	eax, [esp+80h+RestrictedSidCount]
		test	ecx, ecx
		jnz	short loc_10012C5A
		test	eax, eax
		jnz	short loc_10012C5A
		test	ebp, ebp
		jnz	short loc_10012C5A
		lea	eax, [esp+80h+phNewToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	ebp		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	dword ptr [edi+24h] ; hExistingToken
		call	ds:DuplicateTokenEx
		jmp	short loc_10012C73
; ---------------------------------------------------------------------------

loc_10012C5A:				; CODE XREF: sub_10012ACB+16Bj
					; sub_10012ACB+16Fj ...
		lea	edx, [esp+80h+phNewToken]
		push	edx		; NewTokenHandle
		push	esi		; SidsToRestrict
		push	eax		; RestrictedSidCount
		push	ebx		; PrivilegesToDelete
		push	ebp		; DeletePrivilegeCount
		push	[esp+94h+SidsToDisable]	; SidsToDisable
		push	ecx		; DisableSidCount
		push	2		; Flags
		push	dword ptr [edi+24h] ; ExistingTokenHandle
		call	ds:CreateRestrictedToken

loc_10012C73:				; CODE XREF: sub_10012ACB+18Dj
		mov	ebp, ds:??_V@YAXPAX@Z ;	operator delete[](void *)
		mov	[esp+80h+var_6C], eax
		mov	eax, [esp+80h+SidsToDisable]
		test	eax, eax
		jz	short loc_10012C89
		push	eax
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012C89:				; CODE XREF: sub_10012ACB+1B8j
		test	esi, esi
		jz	short loc_10012C91
		push	esi
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012C91:				; CODE XREF: sub_10012ACB+1C0j
		test	ebx, ebx
		jz	short loc_10012C99
		push	ebx
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012C99:				; CODE XREF: sub_10012ACB+1C8j
		cmp	[esp+80h+var_6C], 0
		jnz	short loc_10012CAB

loc_10012CA0:				; CODE XREF: sub_10012ACB+1FCj
					; sub_10012ACB+229j ...
		call	ds:GetLastError
		jmp	loc_10012D7D
; ---------------------------------------------------------------------------

loc_10012CAB:				; CODE XREF: sub_10012ACB+1D3j
		push	12h		; WellKnownSidType
		lea	ecx, [esp+84h+pDestinationSid] ; pSid
		call	sub_1001624D
		push	ecx
		mov	ecx, [esp+84h+phNewToken] ; TokenHandle
		lea	edx, [esp+84h+pDestinationSid]
		call	sub_100078FE
		pop	ecx
		test	al, al
		jz	short loc_10012CA0
		mov	ebx, [esp+80h+phNewToken]
		push	4Ch
		pop	ebp
		push	ebp		; Size
		mov	[esp+84h+DisableSidCount], ebp
		call	ds:malloc
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+80h+DisableSidCount]
		push	eax		; ReturnLength
		push	ebp		; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	ebx		; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10012D00
		test	esi, esi
		jz	short loc_10012CA0
		push	esi		; Memory
		call	ds:free
		pop	ecx
		jmp	short loc_10012CA0
; ---------------------------------------------------------------------------

loc_10012D00:				; CODE XREF: sub_10012ACB+225j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [esp+84h+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h
		pop	eax
		push	eax		; nDestinationSidLength
		call	ds:CopySid
		push	ecx
		lea	edx, [esp+84h+pDestinationSid]
		mov	ecx, ebx	; TokenHandle
		call	sub_100078FE
		pop	ecx
		push	esi		; Memory
		mov	bl, al
		call	ds:free
		pop	ecx
		test	bl, bl
		jz	loc_10012CA0
		mov	edx, [edi+28h]
		mov	ecx, [esp+80h+phNewToken] ; TokenHandle
		call	sub_10013C11
		test	eax, eax
		jnz	short loc_10012D7D
		mov	esi, ds:GetCurrentProcess
		push	eax		; dwOptions
		push	eax		; bInheritHandle
		push	0F01FFh		; dwDesiredAccess
		push	[esp+8Ch+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+94h+phNewToken] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		mov	ecx, [esp+80h+phNewToken]
		mov	esi, eax
		cmp	ecx, [edi+24h]
		jz	short loc_10012D73
		push	ecx		; hObject
		call	ds:CloseHandle

loc_10012D73:				; CODE XREF: sub_10012ACB+29Fj
		test	esi, esi
		jz	loc_10012CA0
		xor	eax, eax

loc_10012D7D:				; CODE XREF: sub_10012ACB+2Cj
					; sub_10012ACB+1DBj ...
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn	4
sub_10012ACB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10012D92(LPHANDLE lpTargetHandle)
sub_10012D92	proc near		; CODE XREF: sub_10013563+48Cp

DuplicateTokenHandle= dword ptr	-8
ExistingTokenHandle= dword ptr -4
lpTargetHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		xor	esi, esi
		mov	[ebp+DuplicateTokenHandle], esi
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_10012DAA
		mov	eax, 3F0h
		jmp	short loc_10012E11
; ---------------------------------------------------------------------------

loc_10012DAA:				; CODE XREF: sub_10012D92+Fj
		lea	eax, [ebp+ExistingTokenHandle]
		push	eax
		call	sub_10012ACB
		test	eax, eax
		jnz	short loc_10012E11
		lea	eax, [ebp+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	[ebp+ExistingTokenHandle] ; ExistingTokenHandle
		call	ds:DuplicateToken
		push	[ebp+ExistingTokenHandle] ; hObject
		test	eax, eax
		jnz	short loc_10012DDB
		call	ds:CloseHandle

loc_10012DD3:				; CODE XREF: sub_10012D92+7Bj
		call	ds:GetLastError
		jmp	short loc_10012E11
; ---------------------------------------------------------------------------

loc_10012DDB:				; CODE XREF: sub_10012D92+39j
		call	ds:CloseHandle
		push	esi		; dwOptions
		push	esi		; bInheritHandle
		mov	esi, ds:GetCurrentProcess
		push	0F01FFh		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+DuplicateTokenHandle] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		push	[ebp+DuplicateTokenHandle] ; hObject
		mov	esi, eax
		call	ds:CloseHandle
		test	esi, esi
		jz	short loc_10012DD3
		xor	eax, eax

loc_10012E11:				; CODE XREF: sub_10012D92+16j
					; sub_10012D92+23j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10012D92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012E18	proc near		; CODE XREF: sub_10013563+463p

var_69		= byte ptr -69h
ReturnLength	= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [esp+6Ch+arg_0]
		push	ebx
		mov	ebx, ecx
		mov	[esp+70h+var_54], eax
		push	ebp
		xor	ecx, ecx
		push	esi
		push	edi
		mov	[esp+7Ch+var_58], ecx
		cmp	[ebx+2Ch], cl
		jnz	short loc_10012E49
		mov	eax, 3F0h
		jmp	loc_10012F71
; ---------------------------------------------------------------------------

loc_10012E49:				; CODE XREF: sub_10012E18+25j
		mov	edi, ds:GetTokenInformation
		lea	eax, [esp+7Ch+ReturnLength]
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		mov	[esp+90h+ReturnLength],	ecx
		call	edi ; GetTokenInformation
		cmp	[esp+7Ch+ReturnLength],	0
		jnz	short loc_10012E73

loc_10012E68:				; CODE XREF: sub_10012E18+84j
		call	ds:GetLastError
		jmp	loc_10012F71
; ---------------------------------------------------------------------------

loc_10012E73:				; CODE XREF: sub_10012E18+4Ej
		push	[esp+7Ch+ReturnLength]
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+7Ch+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+80h+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	edi ; GetTokenInformation
		test	eax, eax
		jnz	short loc_10012E9E
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_10012E68
; ---------------------------------------------------------------------------

loc_10012E9E:				; CODE XREF: sub_10012E18+7Aj
		xor	ebp, ebp
		cmp	[esi], ebp
		jbe	loc_10012F67
		push	44h
		pop	ecx
		lea	edi, [esi+4]
		mov	[esp+7Ch+var_58], ecx

loc_10012EB2:				; CODE XREF: sub_10012E18+149j
		test	byte ptr [edi+4], 20h
		jnz	loc_10012F5B
		test	dword ptr [edi+4], 0C0000000h
		jnz	loc_10012F5B
		mov	ecx, [esp+7Ch+var_54]
		mov	[esp+7Ch+var_69], 0
		push	44h
		test	ecx, ecx
		jz	short loc_10012F37
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	[esp+80h+var_64], edx
		mov	edx, [ecx]
		sub	eax, edx
		mov	[esp+80h+var_5C], edx
		cdq
		pop	ecx
		idiv	ecx
		test	eax, eax
		jz	short loc_10012F38
		xor	ecx, ecx
		mov	[esp+7Ch+var_60], ecx

loc_10012EF7:				; CODE XREF: sub_10012E18+11Bj
		mov	eax, [esp+7Ch+var_5C]
		push	dword ptr [edi]	; pSid2
		add	eax, ecx
		push	eax		; pSid1
		call	ds:EqualSid
		push	44h
		test	eax, eax
		jnz	short loc_10012F86
		mov	ecx, [esp+80h+var_60]
		pop	eax
		add	ecx, eax
		inc	[esp+7Ch+var_64]
		mov	eax, [esp+7Ch+var_54]
		mov	[esp+7Ch+var_60], ecx
		mov	edx, [eax]
		mov	eax, [eax+4]
		sub	eax, edx
		mov	[esp+7Ch+var_5C], edx
		cdq
		idiv	[esp+7Ch+var_58]
		cmp	[esp+7Ch+var_64], eax
		jb	short loc_10012EF7
		push	44h

loc_10012F37:				; CODE XREF: sub_10012E18+BEj
		pop	ecx

loc_10012F38:				; CODE XREF: sub_10012E18+D7j
		mov	al, [esp+7Ch+var_69]

loc_10012F3C:				; CODE XREF: sub_10012E18+171j
		test	al, al
		jnz	short loc_10012F5B
		push	dword ptr [edi]	; pSourceSid
		lea	eax, [esp+80h+pDestinationSid]
		push	eax		; pDestinationSid
		push	ecx		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [esp+7Ch+pDestinationSid]
		push	eax
		lea	ecx, [ebx+18h]
		call	sub_10013399

loc_10012F5B:				; CODE XREF: sub_10012E18+9Ej
					; sub_10012E18+ABj ...
		inc	ebp
		add	edi, 8
		cmp	ebp, [esi]
		jb	loc_10012EB2

loc_10012F67:				; CODE XREF: sub_10012E18+8Aj
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10012F71:				; CODE XREF: sub_10012E18+2Cj
					; sub_10012E18+56j
		mov	ecx, [esp+7Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn	4
; ---------------------------------------------------------------------------

loc_10012F86:				; CODE XREF: sub_10012E18+F2j
		mov	al, 1
		pop	ecx
		jmp	short loc_10012F3C
sub_10012E18	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012F8B	proc near		; CODE XREF: sub_10013563+413p
					; sub_10013563+433p

TokenInformationLength=	dword ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10012FB0
		mov	eax, 3F0h
		jmp	short loc_1001300A
; ---------------------------------------------------------------------------

loc_10012FB0:				; CODE XREF: sub_10012F8B+1Cj
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10012FE6
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_1001300A
; ---------------------------------------------------------------------------

loc_10012FE6:				; CODE XREF: sub_10012F8B+49j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		push	eax
		lea	ecx, [edi+18h]
		call	sub_10013399
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_1001300A:				; CODE XREF: sub_10012F8B+23j
					; sub_10012F8B+59j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10012F8B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001301A	proc near		; CODE XREF: sub_10013563+47Bp

ReturnLength	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Luid		= _LUID	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+28h+var_C], ebp
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10013039
		mov	eax, 3F0h
		jmp	loc_1001313B
; ---------------------------------------------------------------------------

loc_10013039:				; CODE XREF: sub_1001301A+13j
		mov	ebx, ds:GetTokenInformation
		lea	eax, [esp+28h+ReturnLength]
		push	eax		; ReturnLength
		push	ebp		; TokenInformationLength
		push	ebp		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		mov	[esp+3Ch+ReturnLength],	ebp
		call	ebx ; GetTokenInformation
		cmp	[esp+28h+ReturnLength],	ebp
		jnz	short loc_10013062

loc_10013057:				; CODE XREF: sub_1001301A+71j
		call	ds:GetLastError
		jmp	loc_1001313B
; ---------------------------------------------------------------------------

loc_10013062:				; CODE XREF: sub_1001301A+3Bj
		push	[esp+28h+ReturnLength]
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+28h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+2Ch+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ebx ; GetTokenInformation
		test	eax, eax
		jnz	short loc_1001308D
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_10013057
; ---------------------------------------------------------------------------

loc_1001308D:				; CODE XREF: sub_1001301A+67j
		cmp	[esi], ebp
		jbe	loc_10013131
		lea	ebx, [esi+4]
		mov	[esp+28h+var_C], 18h

loc_100130A0:				; CODE XREF: sub_1001301A+111j
		mov	ecx, [esp+28h+arg_0]
		test	ecx, ecx
		jz	short loc_1001311C
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	ecx, [ecx]
		sub	eax, ecx
		mov	[esp+28h+var_14], edx
		cdq
		idiv	[esp+28h+var_C]
		test	eax, eax
		jz	short loc_1001311C
		xor	eax, eax
		mov	[esp+28h+var_10], eax

loc_100130C4:				; CODE XREF: sub_1001301A+100j
		and	[esp+28h+Luid.LowPart],	0
		add	eax, ecx
		and	[esp+28h+Luid.HighPart], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_100130D8
		mov	eax, [eax]

loc_100130D8:				; CODE XREF: sub_1001301A+BAj
		lea	ecx, [esp+28h+Luid]
		push	ecx		; lpLuid
		push	eax		; lpName
		push	0		; lpSystemName
		call	ds:LookupPrivilegeValueW
		mov	eax, [ebx+4]
		cmp	eax, [esp+28h+Luid.HighPart]
		jnz	short loc_100130F7
		mov	eax, [ebx]
		cmp	eax, [esp+28h+Luid.LowPart]
		jz	short loc_10013125

loc_100130F7:				; CODE XREF: sub_1001301A+D3j
		push	18h
		pop	eax
		add	[esp+28h+var_10], eax
		mov	eax, [esp+28h+arg_0]
		inc	[esp+28h+var_14]
		mov	ecx, [eax]
		mov	eax, [eax+4]
		sub	eax, ecx
		cdq
		idiv	[esp+28h+var_C]
		cmp	[esp+28h+var_14], eax
		mov	eax, [esp+28h+var_10]
		jb	short loc_100130C4

loc_1001311C:				; CODE XREF: sub_1001301A+8Cj
					; sub_1001301A+A2j
		push	ebx
		lea	ecx, [edi+0Ch]
		call	sub_10013401

loc_10013125:				; CODE XREF: sub_1001301A+DBj
		inc	ebp
		add	ebx, 0Ch
		cmp	ebp, [esi]
		jb	loc_100130A0

loc_10013131:				; CODE XREF: sub_1001301A+75j
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_1001313B:				; CODE XREF: sub_1001301A+1Aj
					; sub_1001301A+43j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn	4
sub_1001301A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013145	proc near		; CODE XREF: sub_100132C3+ACp
					; sub_10013563+298p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_1001315A
		mov	eax, 3F0h
		jmp	short loc_10013164
; ---------------------------------------------------------------------------

loc_1001315A:				; CODE XREF: sub_10013145+Cj
		push	[ebp+arg_0]
		call	sub_10013399
		xor	eax, eax

loc_10013164:				; CODE XREF: sub_10013145+13j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10013145	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001316A	proc near		; CODE XREF: sub_10013563+2ECp

ReturnLength	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	ebx, ecx
		xor	esi, esi
		mov	[ebp+ReturnLength], esi
		push	edi
		cmp	byte ptr [ebx+2Ch], 0
		jnz	short loc_10013194
		mov	eax, 3F0h
		jmp	loc_10013224
; ---------------------------------------------------------------------------

loc_10013194:				; CODE XREF: sub_1001316A+1Ej
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], esi
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		cmp	[ebp+ReturnLength], esi
		jnz	short loc_100131B5

loc_100131AD:				; CODE XREF: sub_1001316A+75j
		call	ds:GetLastError
		jmp	short loc_10013224
; ---------------------------------------------------------------------------

loc_100131B5:				; CODE XREF: sub_1001316A+41j
		push	[ebp+ReturnLength]
		call	sub_10018CA2
		pop	ecx
		mov	edi, eax
		lea	eax, [ebp+ReturnLength]
		push	eax		; ReturnLength
		push	[ebp+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_100131E1
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_100131AD
; ---------------------------------------------------------------------------

loc_100131E1:				; CODE XREF: sub_1001316A+6Bj
		cmp	[edi], esi
		jbe	short loc_1001321A
		lea	eax, [edi+8]

loc_100131E8:				; CODE XREF: sub_1001316A+8Cj
		test	dword ptr [eax], 0C0000000h
		jnz	short loc_100131FA
		inc	esi
		add	eax, 8
		cmp	esi, [edi]
		jb	short loc_100131E8
		jmp	short loc_1001321A
; ---------------------------------------------------------------------------

loc_100131FA:				; CODE XREF: sub_1001316A+84j
		mov	eax, [edi+esi*8+4]
		test	eax, eax
		jz	short loc_1001321A
		push	eax		; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, ebx
		push	eax
		call	sub_10013399

loc_1001321A:				; CODE XREF: sub_1001316A+79j
					; sub_1001316A+8Ej ...
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10013224:				; CODE XREF: sub_1001316A+25j
					; sub_1001316A+49j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001316A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013235	proc near		; CODE XREF: sub_100132C3:loc_100132EDp
					; sub_10013563+2E1p

TokenInformationLength=	dword ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_1001325A
		mov	eax, 3F0h
		jmp	short loc_100132B3
; ---------------------------------------------------------------------------

loc_1001325A:				; CODE XREF: sub_10013235+1Cj
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10013290
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_100132B3
; ---------------------------------------------------------------------------

loc_10013290:				; CODE XREF: sub_10013235+49j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, edi
		push	eax
		call	sub_10013399
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_100132B3:				; CODE XREF: sub_10013235+23j
					; sub_10013235+59j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10013235	endp


; =============== S U B	R O U T	I N E =======================================


sub_100132C3	proc near		; CODE XREF: sub_10013563+FCp

ReturnLength	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	ebx, ecx
		xor	esi, esi
		mov	[esp+60h+ReturnLength],	esi
		push	edi
		cmp	byte ptr [ebx+2Ch], 0
		jnz	short loc_100132ED
		mov	eax, 3F0h
		jmp	loc_10013386
; ---------------------------------------------------------------------------

loc_100132ED:				; CODE XREF: sub_100132C3+1Ej
		call	sub_10013235
		test	eax, eax
		jnz	loc_10013386
		mov	ebp, ds:GetTokenInformation
		lea	eax, [esp+64h+ReturnLength]
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		mov	[esp+78h+ReturnLength],	esi
		call	ebp ; GetTokenInformation
		cmp	[esp+64h+ReturnLength],	esi
		jnz	short loc_10013320

loc_10013318:				; CODE XREF: sub_100132C3+86j
		call	ds:GetLastError
		jmp	short loc_10013386
; ---------------------------------------------------------------------------

loc_10013320:				; CODE XREF: sub_100132C3+53j
		push	[esp+64h+ReturnLength]
		call	sub_10018CA2
		pop	ecx
		mov	edi, eax
		lea	eax, [esp+64h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+68h+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ebp ; GetTokenInformation
		test	eax, eax
		jnz	short loc_1001334B
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_10013318
; ---------------------------------------------------------------------------

loc_1001334B:				; CODE XREF: sub_100132C3+7Cj
		cmp	[edi], esi
		jbe	short loc_1001337C
		lea	ebp, [edi+4]

loc_10013352:				; CODE XREF: sub_100132C3+B7j
		test	byte ptr [ebp+4], 20h
		jnz	short loc_10013374
		push	dword ptr [ebp+0] ; pSourceSid
		lea	eax, [esp+68h+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [esp+64h+pDestinationSid]
		mov	ecx, ebx
		push	eax
		call	sub_10013145

loc_10013374:				; CODE XREF: sub_100132C3+93j
		inc	esi
		add	ebp, 8
		cmp	esi, [edi]
		jb	short loc_10013352

loc_1001337C:				; CODE XREF: sub_100132C3+8Aj
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10013386:				; CODE XREF: sub_100132C3+25j
					; sub_100132C3+31j ...
		mov	ecx, [esp+64h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
sub_100132C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013399	proc near		; CODE XREF: sub_10012E18+13Ep
					; sub_10012F8B+70p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_100133DE
		cmp	[ebx], esi
		ja	short loc_100133DE
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	44h
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_100133C7
		push	ecx
		mov	ecx, ebx
		call	sub_10013460

loc_100133C7:				; CODE XREF: sub_10013399+24j
		mov	edi, [ebx+4]
		imul	esi, 44h
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_100133D8
		push	11h
		pop	ecx
		rep movsd

loc_100133D8:				; CODE XREF: sub_10013399+38j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_100133FB
; ---------------------------------------------------------------------------

loc_100133DE:				; CODE XREF: sub_10013399+Ej
					; sub_10013399+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_100133EB
		push	ecx
		mov	ecx, ebx
		call	sub_10013460

loc_100133EB:				; CODE XREF: sub_10013399+48j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_100133F7
		push	11h
		pop	ecx
		rep movsd

loc_100133F7:				; CODE XREF: sub_10013399+57j
		add	dword ptr [ebx+4], 44h

loc_100133FB:				; CODE XREF: sub_10013399+43j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10013399	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013401	proc near		; CODE XREF: sub_1001301A+106p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [esi+4]
		cmp	edi, eax
		jnb	short loc_1001343B
		cmp	[esi], edi
		ja	short loc_1001343B
		sub	edi, [esi]
		sar	edi, 3
		cmp	eax, [esi+8]
		jnz	short loc_10013424
		push	ecx
		call	sub_10007DAB

loc_10013424:				; CODE XREF: sub_10013401+1Bj
		mov	edx, [esi+4]
		test	edx, edx
		jz	short loc_10013457
		mov	ecx, [esi]
		mov	eax, [ecx+edi*8]
		mov	[edx], eax
		mov	eax, [ecx+edi*8+4]
		mov	[edx+4], eax
		jmp	short loc_10013457
; ---------------------------------------------------------------------------

loc_1001343B:				; CODE XREF: sub_10013401+Dj
					; sub_10013401+11j
		cmp	eax, [esi+8]
		jnz	short loc_10013446
		push	ecx
		call	sub_10007DAB

loc_10013446:				; CODE XREF: sub_10013401+3Dj
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10013457
		mov	eax, [edi]
		mov	[ecx], eax
		mov	eax, [edi+4]
		mov	[ecx+4], eax

loc_10013457:				; CODE XREF: sub_10013401+28j
					; sub_10013401+38j ...
		add	dword ptr [esi+4], 8
		pop	edi
		pop	esi
		retn	4
sub_10013401	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013460	proc near		; CODE XREF: sub_10013399+29p
					; sub_10013399+4Dp
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	44h
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_100134C4
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 3C3C3C3h
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_1001349B
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1001349B:				; CODE XREF: sub_10013460+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_100134B3
		xor	eax, eax
		jmp	short loc_100134B5
; ---------------------------------------------------------------------------

loc_100134B3:				; CODE XREF: sub_10013460+4Dj
		add	eax, edx

loc_100134B5:				; CODE XREF: sub_10013460+51j
		cmp	eax, ecx
		jnb	short loc_100134BB
		mov	eax, ecx

loc_100134BB:				; CODE XREF: sub_10013460+57j
		push	eax
		mov	ecx, esi
		call	sub_100134CA
		pop	ebx

loc_100134C4:				; CODE XREF: sub_10013460+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_10013460	endp


; =============== S U B	R O U T	I N E =======================================


sub_100134CA	proc near		; CODE XREF: sub_10013460+5Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		mov	ebp, ecx
		test	esi, esi
		jz	short loc_100134F9
		cmp	esi, 3C3C3C3h
		ja	short loc_100134F3
		imul	eax, esi, 44h
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_100134F9

loc_100134F3:				; CODE XREF: sub_100134CA+16j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100134F9:				; CODE XREF: sub_100134CA+Ej
					; sub_100134CA+27j
		mov	ecx, [ebp+4]
		mov	edx, ebx
		mov	eax, [ebp+0]
		mov	[esp+10h+var_4], ecx
		push	edi
		push	44h
		pop	edi
		cmp	eax, ecx
		jz	short loc_1001352D

loc_1001350D:				; CODE XREF: sub_100134CA+5Dj
		test	edx, edx
		jz	short loc_10013521
		push	11h
		pop	ecx
		mov	esi, eax
		mov	edi, edx
		rep movsd
		mov	ecx, [esp+14h+var_4]
		push	44h
		pop	edi

loc_10013521:				; CODE XREF: sub_100134CA+45j
		add	eax, edi
		add	edx, edi
		cmp	eax, ecx
		jnz	short loc_1001350D
		mov	esi, [esp+14h+arg_0]

loc_1001352D:				; CODE XREF: sub_100134CA+41j
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		cdq
		idiv	edi
		cmp	dword ptr [ebp+0], 0
		mov	edi, eax
		jz	short loc_10013548
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10013548:				; CODE XREF: sub_100134CA+72j
		imul	ecx, esi, 44h
		imul	eax, edi, 44h
		pop	edi
		pop	esi
		mov	[ebp+0], ebx
		add	ecx, ebx
		add	eax, ebx
		mov	[ebp+8], ecx
		mov	[ebp+4], eax
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_100134CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_10013563@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int)
sub_10013563	proc near		; CODE XREF: sub_10014DF3+13p
					; sub_10014DF3+A5p

var_608		= dword	ptr -608h
var_604		= dword	ptr -604h
var_600		= dword	ptr -600h
var_5FC		= dword	ptr -5FCh
var_5F8		= dword	ptr -5F8h
var_5F4		= dword	ptr -5F4h
var_5F0		= dword	ptr -5F0h
var_5EC		= dword	ptr -5ECh
var_5E8		= dword	ptr -5E8h
var_5E4		= dword	ptr -5E4h
var_5E0		= dword	ptr -5E0h
var_5DC		= dword	ptr -5DCh
TokenHandle	= dword	ptr -5D8h
var_5D4		= dword	ptr -5D4h
var_5D0		= byte ptr -5D0h
var_5CC		= dword	ptr -5CCh
var_5C8		= dword	ptr -5C8h
var_5C4		= dword	ptr -5C4h
var_5C0		= byte ptr -5C0h
var_578		= byte ptr -578h
var_530		= byte ptr -530h
var_4E8		= byte ptr -4E8h
var_4A0		= byte ptr -4A0h
var_458		= byte ptr -458h
var_410		= byte ptr -410h
var_3C8		= byte ptr -3C8h
var_380		= byte ptr -380h
var_338		= byte ptr -338h
var_2F0		= byte ptr -2F0h
var_2A8		= byte ptr -2A8h
var_260		= byte ptr -260h
var_218		= byte ptr -218h
pSid		= byte ptr -1D0h
var_188		= byte ptr -188h
var_140		= byte ptr -140h
var_F8		= byte ptr -0F8h
var_B0		= byte ptr -0B0h
var_64		= byte ptr -64h
var_4C		= byte ptr -4Ch
Dst		= byte ptr -34h
Src		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 60Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		test	edi, edi
		jnz	short loc_1001358B
		mov	eax, 0A0h
		jmp	loc_10013A5F
; ---------------------------------------------------------------------------

loc_1001358B:				; CODE XREF: sub_10013563+1Cj
		xor	ebx, ebx
		mov	[ebp+var_5D4], 7
		lea	eax, [ebp+TokenHandle]
		mov	[ebp+var_5FC], ebx
		push	eax		; TokenHandle
		push	0F01FFh		; DesiredAccess
		mov	[ebp+var_5F8], ebx
		mov	[ebp+var_5F4], ebx
		mov	[ebp+var_5F0], ebx
		mov	[ebp+var_5EC], ebx
		mov	[ebp+var_5E8], ebx
		mov	[ebp+var_5E4], ebx
		mov	[ebp+var_5E0], ebx
		mov	[ebp+var_5DC], ebx
		mov	[ebp+TokenHandle], ebx
		mov	[ebp+var_5D0], bl
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_100135FE
		call	ds:GetLastError
		jmp	short loc_10013605
; ---------------------------------------------------------------------------

loc_100135FE:				; CODE XREF: sub_10013563+91j
		mov	[ebp+var_5D0], 1

loc_10013605:				; CODE XREF: sub_10013563+99j
		mov	[ebp+var_608], ebx
		mov	[ebp+var_604], ebx
		mov	[ebp+var_600], ebx
		mov	[ebp+var_5CC], ebx
		mov	[ebp+var_5C8], ebx
		mov	[ebp+var_5C4], ebx
		sub	esi, ebx
		jz	loc_10013990
		dec	esi
		jz	loc_10013949
		dec	esi
		jz	loc_10013859
		dec	esi
		jz	loc_1001373E
		dec	esi
		jz	short loc_10013696
		dec	esi
		jz	short loc_10013659
		dec	esi
		jz	short loc_1001366E

loc_1001364F:				; CODE XREF: sub_10013563+120j
		mov	esi, 0A0h
		jmp	loc_100139F6
; ---------------------------------------------------------------------------

loc_10013659:				; CODE XREF: sub_10013563+E7j
		lea	ecx, [ebp+var_5FC]
		call	sub_100132C3

loc_10013664:				; CODE XREF: sub_10013563+480j
		mov	esi, eax
		test	esi, esi
		jnz	loc_100139F6

loc_1001366E:				; CODE XREF: sub_10013563+EAj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_5D4], eax
		mov	eax, [ebp+arg_4]
		sub	eax, ebx
		jz	loc_100139E8
		dec	eax
		jnz	short loc_1001364F
		push	edi
		lea	ecx, [ebp+var_5FC]
		call	sub_10012ACB
		jmp	loc_100139F4
; ---------------------------------------------------------------------------

loc_10013696:				; CODE XREF: sub_10013563+E4j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+pSid]	; pSid
		call	sub_1001624D
		lea	eax, [ebp+pSid]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_410] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_410]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_260] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_260]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+var_578] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_578]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+Src]	; Dst
		call	sub_10001C68
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	ecx, [ebp+var_608]
		call	sub_100035CD
		push	ebx
		push	1
		lea	ecx, [ebp+Src]
		call	sub_100022FA
		jmp	loc_100139B9
; ---------------------------------------------------------------------------

loc_1001373E:				; CODE XREF: sub_10013563+DDj
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_2F0] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_2F0]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_B0] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_B0]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_380] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_380]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+var_140] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_140]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_10001C68
		lea	eax, [ebp+Dst]
		push	eax		; Src
		lea	ecx, [ebp+var_608]
		call	sub_100035CD
		push	ebx
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_F8] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_F8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_218] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_218]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_2A8] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_2A8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		lea	ecx, [ebp+var_5FC]
		call	sub_10013235

loc_10013849:				; CODE XREF: sub_10013563+3E1j
		lea	ecx, [ebp+var_5FC]
		call	sub_1001316A
		jmp	loc_100139B9
; ---------------------------------------------------------------------------

loc_10013859:				; CODE XREF: sub_10013563+D6j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_338] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_338]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_3C8] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_3C8]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_458] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_458]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_10013399
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_64] ; Dst
		call	sub_10001C68
		lea	eax, [ebp+var_64]
		push	eax		; Src
		lea	ecx, [ebp+var_608]
		call	sub_100035CD
		push	ebx
		push	1
		lea	ecx, [ebp+var_64]
		call	sub_100022FA
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_530] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_530]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_5C0] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_5C0]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_4E8] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_4E8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jl	short loc_100139B9
		jmp	loc_10013849
; ---------------------------------------------------------------------------

loc_10013949:				; CODE XREF: sub_10013563+CFj
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_4C] ; Dst
		call	sub_10001C68
		lea	eax, [ebp+var_4C]
		push	eax		; Src
		lea	ecx, [ebp+var_608]
		call	sub_100035CD
		push	ebx
		push	1
		lea	ecx, [ebp+var_4C]
		call	sub_100022FA
		lea	ecx, [ebp+var_5FC]
		call	sub_10012F8B
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_4A0] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_4A0]
		jmp	short loc_100139AD
; ---------------------------------------------------------------------------

loc_10013990:				; CODE XREF: sub_10013563+C8j
		lea	ecx, [ebp+var_5FC]
		call	sub_10012F8B
		push	ebx		; WellKnownSidType
		lea	ecx, [ebp+var_188] ; pSid
		call	sub_1001624D
		lea	eax, [ebp+var_188]

loc_100139AD:				; CODE XREF: sub_10013563+42Bj
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10013145

loc_100139B9:				; CODE XREF: sub_10013563+1D6j
					; sub_10013563+2F1j ...
		lea	eax, [ebp+var_5CC]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10012E18
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100139F6
		lea	eax, [ebp+var_608]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001301A
		jmp	loc_10013664
; ---------------------------------------------------------------------------

loc_100139E8:				; CODE XREF: sub_10013563+119j
		push	edi		; lpTargetHandle
		lea	ecx, [ebp+var_5FC]
		call	sub_10012D92

loc_100139F4:				; CODE XREF: sub_10013563+12Ej
		mov	esi, eax

loc_100139F6:				; CODE XREF: sub_10013563+F1j
					; sub_10013563+105j ...
		lea	ecx, [ebp+var_5CC]
		call	sub_10013C9B
		lea	ecx, [ebp+var_608]
		call	sub_1000393B
		cmp	[ebp+TokenHandle], ebx
		jz	short loc_10013A20
		push	[ebp+TokenHandle] ; hObject
		call	ds:CloseHandle

loc_10013A20:				; CODE XREF: sub_10013563+4AFj
		lea	ecx, [ebp+var_5E4]
		call	sub_10013C9B
		cmp	[ebp+var_5F0], ebx
		jz	short loc_10013A52
		push	[ebp+var_5F0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	[ebp+var_5F0], ebx
		mov	[ebp+var_5EC], ebx
		mov	[ebp+var_5E8], ebx

loc_10013A52:				; CODE XREF: sub_10013563+4CEj
		lea	ecx, [ebp+var_5FC]
		call	sub_10013C9B
		mov	eax, esi

loc_10013A5F:				; CODE XREF: sub_10013563+23j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10013563	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10013A70(int,	void *Src)
sub_10013A70	proc near		; CODE XREF: sub_10014DF3+56p

bSaclPresent	= dword	ptr -2Ch
bSaclDefaulted	= dword	ptr -28h
pSacl		= dword	ptr -24h
SecurityDescriptor= dword ptr -20h
StringSecurityDescriptor= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+Src]
		lea	ecx, [ebp+StringSecurityDescriptor] ; Dst
		push	edi
		mov	edi, handle
		push	offset aS	; "S:("
		call	sub_10001C68
		mov	ebx, offset aMl	; "ML"
		mov	ecx, ebx
		call	sub_10001ADC
		push	eax		; int
		push	ebx		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	ebx, offset asc_1002CA40 ; ";;"
		mov	ecx, ebx
		call	sub_10001ADC
		push	eax		; int
		push	ebx		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	ebx, offset Src
		mov	ecx, ebx
		call	sub_10001ADC
		push	eax		; int
		push	ebx		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	ebx, offset asc_1002CA54 ; ";;;"
		mov	ecx, ebx
		call	sub_10001ADC
		push	eax		; int
		push	ebx		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	ecx, esi
		call	sub_10001ADC
		push	eax		; int
		push	esi		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	esi, offset asc_1002CA50 ; ")"
		mov	ecx, esi
		call	sub_10001ADC
		push	eax		; int
		push	esi		; Src
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003375
		mov	eax, [ebp+StringSecurityDescriptor]
		xor	ebx, ebx
		cmp	[ebp+var_8], 8
		mov	[ebp+SecurityDescriptor], ebx
		mov	[ebp+pSacl], ebx
		mov	[ebp+bSaclPresent], ebx
		mov	[ebp+bSaclDefaulted], ebx
		jnb	short loc_10013B32
		lea	eax, [ebp+StringSecurityDescriptor]

loc_10013B32:				; CODE XREF: sub_10013A70+BDj
		push	ebx		; SecurityDescriptorSize
		lea	ecx, [ebp+SecurityDescriptor]
		push	ecx		; SecurityDescriptor
		push	1		; StringSDRevision
		push	eax		; StringSecurityDescriptor
		call	ds:ConvertStringSecurityDescriptorToSecurityDescriptorW
		test	eax, eax
		jz	short loc_10013B83
		lea	eax, [ebp+bSaclDefaulted]
		push	eax		; lpbSaclDefaulted
		lea	eax, [ebp+pSacl]
		push	eax		; pSacl
		lea	eax, [ebp+bSaclPresent]
		push	eax		; lpbSaclPresent
		push	[ebp+SecurityDescriptor] ; pSecurityDescriptor
		call	ds:GetSecurityDescriptorSacl
		test	eax, eax
		jz	short loc_10013B70
		push	[ebp+pSacl]	; pSacl
		push	ebx		; pDacl
		push	ebx		; psidGroup
		push	ebx		; psidOwner
		push	10h		; SecurityInfo
		push	7		; ObjectType
		push	edi		; handle
		call	ds:SetSecurityInfo
		jmp	short loc_10013B76
; ---------------------------------------------------------------------------

loc_10013B70:				; CODE XREF: sub_10013A70+EBj
		call	ds:GetLastError

loc_10013B76:				; CODE XREF: sub_10013A70+FEj
		push	[ebp+SecurityDescriptor] ; hMem
		mov	esi, eax
		call	ds:LocalFree
		jmp	short loc_10013B8B
; ---------------------------------------------------------------------------

loc_10013B83:				; CODE XREF: sub_10013A70+D2j
		call	ds:GetLastError
		mov	esi, eax

loc_10013B8B:				; CODE XREF: sub_10013A70+111j
		push	ebx
		push	1
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_100022FA
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10013A70	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013BA9	proc near		; CODE XREF: sub_10013C11+1Dp
					; sub_10014DF3+4Fp

var_4		= dword	ptr -4

		push	ecx
		and	[esp+4+var_4], 0
		cmp	ecx, 7		; switch 8 cases
		ja	short loc_10013BEB ; jumptable 10013BB3	default	case
		jmp	ds:off_10013BF1[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10013BBA:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS11616384 ; jumptable 10013BB3 case 0
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BC1:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS11612288 ; jumptable 10013BB3 case 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BC8:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS1168192 ;	jumptable 10013BB3 case	2
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BCF:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS1166144 ;	jumptable 10013BB3 case	3
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BD6:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS1164096 ;	jumptable 10013BB3 case	4
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BDD:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS1162048 ;	jumptable 10013BB3 case	5
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BE4:				; CODE XREF: sub_10013BA9+Aj
					; DATA XREF: .text:off_10013BF1o
		mov	eax, offset aS1160 ; jumptable 10013BB3	case 6
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BEB:				; CODE XREF: sub_10013BA9+8j
					; sub_10013BA9+Aj
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10013BB3 default case
		pop	ecx
		retn
sub_10013BA9	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_10013BF1	dd offset loc_10013BBA	; DATA XREF: sub_10013BA9+Ar
		dd offset loc_10013BC1	; jump table for switch	statement
		dd offset loc_10013BC8
		dd offset loc_10013BCF
		dd offset loc_10013BD6
		dd offset loc_10013BDD
		dd offset loc_10013BE4
		dd offset loc_10013BEB

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10013C11(HANDLE TokenHandle)
sub_10013C11	proc near		; CODE XREF: sub_10012ACB+26Cp
					; sub_10017D76+69p

TokenInformation= dword	ptr -0Ch
var_8		= dword	ptr -8
Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, ecx
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jge	short loc_10013C2C

loc_10013C28:				; CODE XREF: sub_10013C11+24j
		xor	eax, eax
		jmp	short loc_10013C94
; ---------------------------------------------------------------------------

loc_10013C2C:				; CODE XREF: sub_10013C11+15j
		mov	ecx, esi
		call	sub_10013BA9
		test	eax, eax
		jz	short loc_10013C28
		lea	ecx, [ebp+Sid]
		xor	edi, edi
		push	ecx		; Sid
		push	eax		; StringSid
		mov	[ebp+Sid], edi
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10013C53
		call	ds:GetLastError
		jmp	short loc_10013C94
; ---------------------------------------------------------------------------

loc_10013C53:				; CODE XREF: sub_10013C11+38j
		mov	eax, [ebp+Sid]
		mov	[ebp+var_8], edi
		push	eax		; pSid
		mov	[ebp+var_8], 20h
		mov	[ebp+TokenInformation],	eax
		call	ds:GetLengthSid
		add	eax, 8
		push	eax		; TokenInformationLength
		lea	eax, [ebp+TokenInformation]
		push	eax		; TokenInformation
		push	19h		; TokenInformationClass
		push	ebx		; TokenHandle
		call	ds:SetTokenInformation
		push	[ebp+Sid]	; hMem
		mov	esi, eax
		call	ds:LocalFree
		test	esi, esi
		jnz	short loc_10013C92
		call	ds:GetLastError
		mov	edi, eax

loc_10013C92:				; CODE XREF: sub_10013C11+77j
		mov	eax, edi

loc_10013C94:				; CODE XREF: sub_10013C11+19j
					; sub_10013C11+40j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10013C11	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013C9B	proc near		; CODE XREF: sub_10013563+499p
					; sub_10013563+4C3p ...
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi], 0
		jz	short loc_10013CB6
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax

loc_10013CB6:				; CODE XREF: sub_10013C9B+6j
		pop	esi
		retn
sub_10013C9B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013CB8	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+60p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+4Fp ...
		cmp	g_shared_section, 0
		jnz	short loc_10013CC4
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10013CC4:				; CODE XREF: sub_10013CB8+7j
		mov	eax, dword_10031E14
		mov	byte_10031CB9, 0
		test	eax, eax
		jnz	short locret_10013CEE
		and	dword_10031E10,	eax
		mov	eax, offset dword_10031E0C
		mov	dword_10031E0C,	offset off_1002D9CC
		mov	dword_10031E14,	eax

locret_10013CEE:			; CODE XREF: sub_10013CB8+1Aj
		retn
sub_10013CB8	endp

; Exported entry  16. IsSandboxedProcess

; =============== S U B	R O U T	I N E =======================================


		public IsSandboxedProcess
IsSandboxedProcess proc	near		; DATA XREF: .rdata:off_1002E058o
		xor	eax, eax
		cmp	g_shared_section, eax
		setnz	al
		retn
IsSandboxedProcess endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013CFB	proc near		; CODE XREF: sub_100142D5+2Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, edx

loc_10013D03:				; CODE XREF: sub_10013CFB+37j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	1
		push	2000h
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], 10000h
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10013D59
		cmp	[ebp+var_4], 80000h
		jb	short loc_10013D03
		push	4
		push	1000h
		lea	eax, [ebp+var_8]
		mov	[ebp+var_8], esi
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10013D59
		mov	eax, [ebp+var_4]
		jmp	short loc_10013D5B
; ---------------------------------------------------------------------------

loc_10013D59:				; CODE XREF: sub_10013CFB+2Ej
					; sub_10013CFB+57j
		xor	eax, eax

loc_10013D5B:				; CODE XREF: sub_10013CFB+5Cj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10013CFB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013D60	proc near		; CODE XREF: sub_10013DD2p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		xor	ecx, ecx
		cmp	dword_10031DF0,	ecx
		jnz	short loc_10013DC8
		push	4
		push	ecx
		push	2
		lea	eax, [ebp+var_8]
		mov	[ebp+var_4], ecx
		push	eax
		push	ecx
		push	ecx
		push	ecx
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], ecx
		push	eax
		push	0FFFFFFFFh
		push	g_shared_section
		call	dword_10031D18
		test	eax, eax
		js	short loc_10013DCE
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jz	short loc_10013DCE
		mov	edx, offset dword_10031DF0
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_10013DB8
		push	[ebp+var_4]
		push	0FFFFFFFFh
		call	dword_10031D30

loc_10013DB8:				; CODE XREF: sub_10013D60+4Bj
		mov	eax, dword_10031DF0
		add	eax, g_shared_IPC_size
		mov	dword_10031DEC,	eax

loc_10013DC8:				; CODE XREF: sub_10013D60+Dj
		mov	al, 1

loc_10013DCA:				; CODE XREF: sub_10013D60+70j
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10013DCE:				; CODE XREF: sub_10013D60+35j
					; sub_10013D60+3Cj
		xor	al, al
		jmp	short loc_10013DCA
sub_10013D60	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013DD2	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+A1p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+90p ...
		call	sub_10013D60
		test	al, al
		jnz	short loc_10013DDE
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10013DDE:				; CODE XREF: sub_10013DD2+7j
		mov	eax, dword_10031DF0
		retn
sub_10013DD2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013DE4	proc near		; CODE XREF: sub_1000E4B6+22p
					; sub_1000E72B+Bp ...
		cmp	dword_10031DF8,	0
		jnz	short loc_10013E1F
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	2
		call	dword_10031D40
		mov	edx, eax
		test	edx, edx
		jnz	short loc_10013E05
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10013E05:				; CODE XREF: sub_10013DE4+1Cj
		push	esi
		mov	ecx, edx
		mov	esi, offset dword_10031DF8
		xor	eax, eax
		lock cmpxchg [esi], ecx
		pop	esi
		test	eax, eax
		jz	short loc_10013E1F
		push	edx
		call	dword_10031D48

loc_10013E1F:				; CODE XREF: sub_10013DE4+7j
					; sub_10013DE4+32j
		xor	eax, eax
		cmp	dword_10031DF8,	eax
		setnz	al
		retn
sub_10013DE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013E2B	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+7Ep
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+93p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	10h
		push	offset stru_1002DF08
		call	__SEH_prolog4
		mov	eax, edx
		xor	edx, edx
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	[ebp+var_20], edx
		mov	[ebp+var_1C], ecx
		lea	esi, [ecx-1]
		add	esi, eax
		cmp	[ebp+arg_0], 1
		jnz	short loc_10013E64

loc_10013E4F:				; CODE XREF: sub_10013E2B+33j
		cmp	ecx, esi
		jnb	short loc_10013E60
		mov	[ecx], dl
		add	ecx, 1000h
		mov	[ebp+var_1C], ecx
		jmp	short loc_10013E4F
; ---------------------------------------------------------------------------

loc_10013E60:				; CODE XREF: sub_10013E2B+26j
		mov	[esi], dl
		jmp	short loc_10013E83
; ---------------------------------------------------------------------------

loc_10013E64:				; CODE XREF: sub_10013E2B+22j
					; sub_10013E2B+4Ej
		cmp	ecx, esi
		jnb	short loc_10013E7B
		movsx	eax, byte ptr [ecx]
		add	edx, eax
		mov	[ebp+var_20], edx
		add	ecx, 1000h
		mov	[ebp+var_1C], ecx
		jmp	short loc_10013E64
; ---------------------------------------------------------------------------

loc_10013E7B:				; CODE XREF: sub_10013E2B+3Bj
		movsx	eax, byte ptr [esi]
		add	edx, eax
		mov	[ebp+var_20], edx

loc_10013E83:				; CODE XREF: sub_10013E2B+37j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_10013E9E
; ---------------------------------------------------------------------------

loc_10013E8E:				; DATA XREF: .rdata:stru_1002DF08o
		xor	eax, eax	; Exception filter 0 for function 10013E2B
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013E92:				; DATA XREF: .rdata:stru_1002DF08o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013E2B
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_10013E9E:				; CODE XREF: sub_10013E2B+61j
		call	__SEH_epilog4
		retn
sub_10013E2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013EA4	proc near		; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+29p
					; sub_10013EE8+ABp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002DF28
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_0]
		push	edx
		push	ecx
		call	dword_10031D5C
		add	esp, 0Ch
		jmp	short loc_10013ED9
; ---------------------------------------------------------------------------

loc_10013EC5:				; DATA XREF: .rdata:stru_1002DF28o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10013EA4
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013ED3:				; DATA XREF: .rdata:stru_1002DF28o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013EA4
		mov	esi, [ebp+var_1C]

loc_10013ED9:				; CODE XREF: sub_10013EA4+1Fj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, esi
		call	__SEH_epilog4
		retn
sub_10013EA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013EE8	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+C0p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+ABp ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	24h
		push	offset stru_1002DF48
		call	__SEH_prolog4
		mov	ebx, edx
		mov	[ebp+var_34], ebx
		mov	[ebp+var_1C], ecx
		call	sub_10013DE4
		test	al, al
		jnz	short loc_10013F0F
		mov	eax, 0C0000017h
		jmp	loc_1001400F
; ---------------------------------------------------------------------------

loc_10013F0F:				; CODE XREF: sub_10013EE8+1Bj
		xor	edi, edi
		mov	[ebx], edi
		mov	esi, 0C0000001h
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_1C]
		cmp	[eax+4], edi
		jz	short loc_10013F2C
		cmp	[ebp+arg_4], edi
		jz	loc_10013FCE

loc_10013F2C:				; CODE XREF: sub_10013EE8+39j
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_10013FCE
		cmp	[eax+4], edi
		jz	loc_10013FCE
		movzx	eax, word ptr [eax]
		push	2
		pop	edx
		add	eax, edx
		mov	[ebp+var_28], eax
		shr	eax, 1
		mov	[ebp+var_2C], eax
		xor	ecx, ecx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		mov	[ebp+var_24], ecx
		call	sub_10013DE4
		test	al, al
		jz	short loc_10013F7B
		push	[ebp+var_24]
		push	edi
		push	dword_10031DF8
		call	dword_10031D34
		mov	ecx, eax
		jmp	short loc_10013F7D
; ---------------------------------------------------------------------------

loc_10013F7B:				; CODE XREF: sub_10013EE8+7Dj
		mov	ecx, edi

loc_10013F7D:				; CODE XREF: sub_10013EE8+91j
		mov	[ebx], ecx
		test	ecx, ecx
		jz	short loc_10013FCE
		mov	eax, [ebp+var_28]
		add	eax, 0FFFFFFFEh
		push	eax
		mov	edx, [ebp+var_1C]
		mov	edx, [edx+8]
		mov	edx, [edx+4]
		call	sub_10013EA4
		pop	ecx
		mov	esi, eax
		mov	[ebp+var_20], esi
		test	esi, esi
		js	short loc_10013FCE
		mov	eax, [ebx]
		xor	edx, edx
		mov	ecx, [ebp+var_2C]
		mov	[eax+ecx*2-2], dx
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_1C]
		test	edx, edx
		jz	short loc_10013FBD
		mov	eax, [ecx+0Ch]
		mov	[edx], eax

loc_10013FBD:				; CODE XREF: sub_10013EE8+CEj
		mov	edx, [ebp+arg_4]
		test	edx, edx
		jz	short loc_10013FC9
		mov	eax, [ecx+4]
		mov	[edx], eax

loc_10013FC9:				; CODE XREF: sub_10013EE8+DAj
		mov	esi, edi
		mov	[ebp+var_20], esi

loc_10013FCE:				; CODE XREF: sub_10013EE8+3Ej
					; sub_10013EE8+49j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_10013FFA
; ---------------------------------------------------------------------------

loc_10013FD7:				; DATA XREF: .rdata:stru_1002DF48o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10013EE8
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_30], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013FE5:				; DATA XREF: .rdata:stru_1002DF48o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013EE8
		mov	esi, [ebp+var_30]
		mov	[ebp+var_20], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edi, edi
		mov	ebx, [ebp+var_34]

loc_10013FFA:				; CODE XREF: sub_10013EE8+EDj
		test	esi, esi
		jns	short loc_1001400D
		mov	ecx, [ebx]
		test	ecx, ecx
		jz	short loc_1001400D
		xor	edx, edx
		call	sub_1001430B
		mov	[ebx], edi

loc_1001400D:				; CODE XREF: sub_10013EE8+114j
					; sub_10013EE8+11Aj
		mov	eax, esi

loc_1001400F:				; CODE XREF: sub_10013EE8+22j
		call	__SEH_epilog4
		retn
sub_10013EE8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014015	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+7Ap
					; TargetNtUnmapViewOfSection(x,x,x)+16p

var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	esi
		mov	esi, ecx
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_10014027
		mov	al, 1
		jmp	short loc_10014088
; ---------------------------------------------------------------------------

loc_10014027:				; CODE XREF: sub_10014015+Cj
		cmp	dword_10031F7C,	0
		jnz	short loc_10014056
		lea	eax, [ebp+var_4]
		push	eax
		push	18h
		lea	eax, [ebp+var_1C]
		push	eax
		push	0
		push	0FFFFFFFFh
		call	dword_10031D20
		test	eax, eax
		js	short loc_10014086
		cmp	[ebp+var_4], 18h
		jnz	short loc_10014056
		mov	eax, [ebp+var_C]
		mov	dword_10031F7C,	eax

loc_10014056:				; CODE XREF: sub_10014015+19j
					; sub_10014015+37j
		lea	eax, [ebp+var_4]
		push	eax
		push	18h
		lea	eax, [ebp+var_1C]
		push	eax
		push	0
		push	esi
		call	dword_10031D20
		test	eax, eax
		js	short loc_10014086
		cmp	[ebp+var_4], 18h
		mov	ecx, [ebp+var_C]
		jz	short loc_10014079
		mov	ecx, [ebp+var_4]

loc_10014079:				; CODE XREF: sub_10014015+5Fj
		xor	eax, eax
		cmp	ecx, dword_10031F7C
		setz	al
		jmp	short loc_10014088
; ---------------------------------------------------------------------------

loc_10014086:				; CODE XREF: sub_10014015+31j
					; sub_10014015+56j
		xor	al, al

loc_10014088:				; CODE XREF: sub_10014015+10j
					; sub_10014015+6Fj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10014015	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001408D	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+CAp
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+DFp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, ecx
		push	esi
		call	dword_10031D54
		mov	word ptr [ebp+var_8], ax
		mov	edx, [ebp+var_8]
		inc	edx
		mov	[ebp+var_4], esi
		mov	word ptr [ebp+var_8+2],	dx
		pop	ecx
		cmp	ax, dx
		ja	short loc_10014102
		movzx	eax, dx
		lea	esi, ds:8[eax*2]
		call	sub_10013DE4
		test	al, al
		jz	short loc_10014102
		push	esi
		push	0
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax
		test	esi, esi
		jz	short loc_10014102
		mov	ecx, [ebp+var_8+2]
		lea	eax, [ebp+var_8]
		add	ecx, ecx
		push	0
		mov	[esi+2], cx
		lea	ecx, [esi+8]
		push	eax
		push	esi
		mov	[esi+4], ecx
		call	dword_10031D38
		test	eax, eax
		jns	short loc_10014109
		xor	edx, edx
		mov	ecx, esi
		call	sub_1001430B

loc_10014102:				; CODE XREF: sub_1001408D+22j
					; sub_1001408D+35j ...
		xor	eax, eax

loc_10014104:				; CODE XREF: sub_1001408D+7Ej
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014109:				; CODE XREF: sub_1001408D+6Aj
		mov	eax, esi
		jmp	short loc_10014104
sub_1001408D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001410D	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+112p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	14h
		push	offset stru_1002DF68
		call	__SEH_prolog4
		mov	esi, edx
		mov	edx, ecx
		xor	edi, edi
		mov	[ebp+var_1C], edi
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	[esi], edi
		mov	ebx, offset off_1001AA20
		mov	[ebp+var_24], ebx
		mov	[ebp+var_20], edx
		lea	ecx, [ebp+var_24]
		call	sub_100058C0
		test	al, al
		jz	short loc_10014187
		mov	dword ptr [esi], 1
		mov	eax, [edx+3Ch]
		push	dword ptr [eax+edx+78h]
		lea	ecx, [ebp+var_24]
		call	ds:off_1001AA24
		test	eax, eax
		jz	short loc_1001416D
		push	dword ptr [eax+0Ch]
		lea	ecx, [ebp+var_24]
		call	sub_100058F3
		mov	ecx, eax
		call	sub_1001408D
		mov	[ebp+var_1C], eax

loc_1001416D:				; CODE XREF: sub_1001410D+49j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		jz	short loc_10014187
		cmp	[ecx+28h], edi
		jz	short loc_1001417F
		or	dword ptr [esi], 2

loc_1001417F:				; CODE XREF: sub_1001410D+6Dj
		cmp	[ecx+1Ch], edi
		jz	short loc_10014187
		or	dword ptr [esi], 4

loc_10014187:				; CODE XREF: sub_1001410D+2Fj
					; sub_1001410D+68j ...
		mov	[ebp+var_24], ebx
		jmp	short loc_10014193
; ---------------------------------------------------------------------------

loc_1001418C:				; DATA XREF: .rdata:stru_1002DF68o
		xor	eax, eax	; Exception filter 0 for function 1001410D
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10014190:				; DATA XREF: .rdata:stru_1002DF68o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001410D

loc_10014193:				; CODE XREF: sub_1001410D+7Dj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
sub_1001410D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100141A3	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+192p
		push	ebx
		push	esi
		push	edi
		test	ecx, ecx
		jz	short loc_100141D9
		mov	edx, [ecx+4]
		test	edx, edx
		jz	short loc_100141D9
		movzx	eax, word ptr [ecx]
		xor	edi, edi
		shr	eax, 1
		dec	eax
		mov	ecx, eax
		js	short loc_100141E3
		lea	esi, [edx+eax*2]

loc_100141C0:				; CODE XREF: sub_100141A3+27j
		cmp	word ptr [esi],	5Ch
		jz	short loc_100141CE
		sub	esi, 2
		dec	ecx
		jns	short loc_100141C0
		jmp	short loc_100141D1
; ---------------------------------------------------------------------------

loc_100141CE:				; CODE XREF: sub_100141A3+21j
		lea	edi, [edx+ecx*2]

loc_100141D1:				; CODE XREF: sub_100141A3+29j
		cmp	ecx, eax
		jnz	short loc_100141DF
		test	edi, edi
		jz	short loc_100141E3

loc_100141D9:				; CODE XREF: sub_100141A3+5j
					; sub_100141A3+Cj ...
		xor	eax, eax

loc_100141DB:				; CODE XREF: sub_100141A3+A9j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100141DF:				; CODE XREF: sub_100141A3+30j
		test	edi, edi
		jnz	short loc_100141E6

loc_100141E3:				; CODE XREF: sub_100141A3+18j
					; sub_100141A3+34j
		lea	edi, [edx-2]

loc_100141E6:				; CODE XREF: sub_100141A3+3Ej
		sub	eax, ecx
		lea	ebx, ds:2[eax*2]
		call	sub_10013DE4
		test	al, al
		jz	short loc_100141D9
		lea	eax, [ebx+8]
		push	eax
		push	0
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax
		test	esi, esi
		jz	short loc_100141D9
		lea	edx, [ebx-2]
		mov	[esi+2], bx
		movzx	eax, dx
		lea	ecx, [esi+8]
		mov	[esi], dx
		lea	edx, [edi+2]
		push	eax
		mov	[esi+4], ecx
		call	sub_10013EA4
		pop	ecx
		test	eax, eax
		jns	short loc_1001423C
		xor	edx, edx
		mov	ecx, esi
		call	sub_1001430B
		jmp	short loc_100141D9
; ---------------------------------------------------------------------------

loc_1001423C:				; CODE XREF: sub_100141A3+8Cj
		movzx	ecx, word ptr [esi]
		mov	eax, [esi+4]
		shr	ecx, 1
		xor	edx, edx
		mov	[eax+ecx*2], dx
		mov	eax, esi
		jmp	short loc_100141DB
sub_100141A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001424E	proc near		; CODE XREF: sub_10009A54+67p
					; sub_1001674A+6Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, ecx
		mov	[ebp+arg_4], eax
		lea	eax, [esi+0Ch]
		push	eax
		push	4
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+arg_0]
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D1C
		test	eax, eax
		js	short loc_10014283
		mov	ecx, [ebp+arg_0]
		mov	[esi+4], ecx
		mov	ecx, [ebp+arg_4]
		mov	byte ptr [esi],	1
		mov	[esi+8], ecx

loc_10014283:				; CODE XREF: sub_1001424E+24j
		pop	esi
		pop	ebp
		retn	0Ch
sub_1001424E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014288	proc near		; CODE XREF: sub_1000A073+4Bp
					; TargetNtSetInformationFile(x,x,x,x,x,x)+C2p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0Ah
		jnz	short loc_100142D2
		cmp	edx, 10h
		jb	short loc_100142D2
		lea	eax, [edx-0Ch]
		cmp	eax, [ecx+8]
		jb	short loc_100142D2
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_100142D2
		cmp	dword ptr [ecx+8], 8
		jb	short loc_100142D2
		cmp	dword ptr [ecx+8], 0FFFFh
		ja	short loc_100142D2
		push	5Ch
		pop	eax
		cmp	[ecx+0Ch], ax
		jnz	short loc_100142D2
		push	3Fh
		pop	edx
		cmp	[ecx+0Eh], dx
		jnz	short loc_100142D2
		cmp	[ecx+10h], dx
		jnz	short loc_100142D2
		cmp	[ecx+12h], ax
		jnz	short loc_100142D2
		mov	al, 1
		retn
; ---------------------------------------------------------------------------

loc_100142D2:				; CODE XREF: sub_10014288+5j
					; sub_10014288+Aj ...
		xor	al, al
		retn
sub_10014288	endp


; =============== S U B	R O U T	I N E =======================================


sub_100142D5	proc near		; CODE XREF: sub_1000E517+97p
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ecx
		test	edx, edx
		jnz	short loc_100142F8
		call	sub_10013DE4
		test	al, al
		jz	short loc_10014306
		push	edi
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		jmp	short loc_10014304
; ---------------------------------------------------------------------------

loc_100142F8:				; CODE XREF: sub_100142D5+8j
		cmp	edx, 1
		jnz	short loc_10014306
		mov	edx, edi
		call	sub_10013CFB

loc_10014304:				; CODE XREF: sub_100142D5+21j
		mov	esi, eax

loc_10014306:				; CODE XREF: sub_100142D5+11j
					; sub_100142D5+26j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100142D5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001430B	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1CFp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+1B2p	...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		test	edx, edx
		jnz	short loc_10014324
		push	ecx
		push	edx
		push	dword_10031DF8
		call	dword_10031D4C
		jmp	short loc_10014345
; ---------------------------------------------------------------------------

loc_10014324:				; CODE XREF: sub_1001430B+7j
		cmp	edx, 1
		jnz	short loc_10014345
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	8000h
		push	eax
		lea	eax, [ebp+var_8]
		mov	[ebp+var_8], ecx
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D14

loc_10014345:				; CODE XREF: sub_1001430B+17j
					; sub_1001430B+1Cj
		mov	esp, ebp
		pop	ebp
		retn
sub_1001430B	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10014349(HANDLE hFile)
sub_10014349	proc near		; CODE XREF: sub_10014B71+Ap
					; sub_10014B93+Ap
		test	ecx, ecx
		jnz	short loc_10014350

loc_1001434D:				; CODE XREF: sub_10014349+Aj
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10014350:				; CODE XREF: sub_10014349+2j
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_1001434D
		push	ecx		; hFile
		call	ds:GetFileType
		mov	ecx, eax
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jz	short locret_1001436C
		cmp	ecx, 3
		jz	short locret_1001436C
		xor	eax, eax

locret_1001436C:			; CODE XREF: sub_10014349+1Aj
					; sub_10014349+1Fj
		retn
sub_10014349	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001436D	proc near		; CODE XREF: sub_10008193+15p
		push	ebx
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		mov	[edi+4], ebx
		mov	[edi+8], ebx
		mov	[edi+0Ch], ebx
		mov	dword ptr [edi+10h], offset off_1002CC74
		mov	dword ptr [edi], offset	off_1002CD44
		mov	dword ptr [edi+10h], offset off_1002CCDC
		mov	[edi+2Ch], ebx
		mov	[edi+30h], ebx
		call	sub_1000916C
		mov	[edi+2Ch], eax
		lea	ecx, [edi+0DCh]
		or	dword ptr [edi+50h], 0FFFFFFFFh
		or	dword ptr [edi+54h], 0FFFFFFFFh
		push	7
		pop	eax
		mov	dword ptr [edi+34h], 1
		mov	[edi+38h], ebx
		mov	[edi+3Ch], ebx
		mov	[edi+40h], ebx
		mov	[edi+44h], ebx
		mov	[edi+48h], ebx
		mov	dword ptr [edi+4Ch], 1000000h
		mov	[edi+58h], eax
		mov	[edi+5Ch], eax
		mov	[edi+60h], ebx
		mov	[edi+64h], ebx
		mov	[edi+68h], ebx
		mov	[edi+6Ch], ebx
		mov	[edi+0C8h], ebx
		mov	[edi+0CCh], ebx
		mov	[edi+0D0h], ebx
		mov	[edi+0D4h], ebx
		mov	[edi+0D8h], ebx
		call	sub_1000C19C
		lea	eax, [edi+14h]
		mov	[edi+0E4h], ebx
		mov	[edi+0E8h], ebx
		mov	[edi+0ECh], ebx
		push	eax		; lpCriticalSection
		mov	[edi+0F0h], ebx
		call	ds:InitializeCriticalSection
		push	58h		; Size
		lea	eax, [edi+70h]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		mov	ebp, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		push	14h
		call	ebp ; operator new(uint) ; operator new(uint)
		add	esp, 10h
		test	eax, eax
		jz	short loc_1001444D
		push	edi
		mov	ecx, eax
		call	sub_10009BBF
		jmp	short loc_1001444F
; ---------------------------------------------------------------------------

loc_1001444D:				; CODE XREF: sub_1001436D+D4j
		mov	eax, ebx

loc_1001444F:				; CODE XREF: sub_1001436D+DEj
		push	esi
		push	14h
		mov	[edi+7Ch], eax
		mov	[edi+80h], eax
		mov	[edi+8Ch], eax
		mov	[edi+84h], eax
		mov	[edi+88h], eax
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10014496
		lea	ecx, [esi+4]
		mov	[ecx], ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		push	offset dword_1002C2E4
		mov	dword ptr [esi], offset	off_1002C2D8
		mov	[esi+10h], edi
		call	sub_1000A1B0
		jmp	short loc_10014498
; ---------------------------------------------------------------------------

loc_10014496:				; CODE XREF: sub_1001436D+107j
		mov	esi, ebx

loc_10014498:				; CODE XREF: sub_1001436D+127j
		push	14h
		mov	[edi+90h], esi
		call	ebp ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100144B1
		push	edi
		mov	ecx, eax
		call	sub_100109A6
		jmp	short loc_100144B3
; ---------------------------------------------------------------------------

loc_100144B1:				; CODE XREF: sub_1001436D+138j
		mov	eax, ebx

loc_100144B3:				; CODE XREF: sub_1001436D+142j
		push	14h
		mov	[edi+94h], eax
		mov	[edi+98h], eax
		mov	[edi+0A4h], eax
		mov	[edi+9Ch], eax
		mov	[edi+0A0h], eax
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_1001450C
		lea	esi, [ebx+4]
		xor	eax, eax
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		push	offset dword_1002D8D0
		mov	dword ptr [ebx], offset	off_1002D898
		mov	[ebx+10h], edi
		call	sub_1000A1B0
		push	offset dword_1002D8A4
		mov	ecx, esi
		call	sub_1000A1B0
		jmp	short loc_1001450E
; ---------------------------------------------------------------------------

loc_1001450C:				; CODE XREF: sub_1001436D+16Dj
		xor	ebx, ebx

loc_1001450E:				; CODE XREF: sub_1001436D+19Dj
		push	14h
		mov	[edi+0A8h], ebx
		mov	[edi+0ACh], ebx
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_10014555
		lea	esi, [ebx+4]
		xor	eax, eax
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		push	offset dword_1002C994
		mov	dword ptr [ebx], offset	off_1002C9EC
		mov	[ebx+10h], edi
		call	sub_1000A1B0
		push	offset dword_1002C9C0
		mov	ecx, esi
		call	sub_1000A1B0
		jmp	short loc_10014557
; ---------------------------------------------------------------------------

loc_10014555:				; CODE XREF: sub_1001436D+1B6j
		xor	ebx, ebx

loc_10014557:				; CODE XREF: sub_1001436D+1E6j
		push	14h
		mov	[edi+0B0h], ebx
		mov	[edi+0B4h], ebx
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	esi, eax
		xor	ebx, ebx
		pop	ecx
		test	esi, esi
		jz	short loc_10014590
		lea	ecx, [esi+4]
		mov	[ecx], ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		push	offset dword_1002BFE8
		mov	dword ptr [esi], offset	off_1002C014
		mov	[esi+10h], edi
		call	sub_1000A1B0
		jmp	short loc_10014592
; ---------------------------------------------------------------------------

loc_10014590:				; CODE XREF: sub_1001436D+201j
		mov	esi, ebx

loc_10014592:				; CODE XREF: sub_1001436D+221j
		push	14h
		mov	[edi+0B8h], esi
		call	ebp ; operator new(uint) ; operator new(uint)
		pop	ecx
		pop	esi
		test	eax, eax
		jz	short loc_100145B6
		mov	[eax+4], ebx
		mov	[eax+8], ebx
		mov	[eax+0Ch], ebx
		mov	dword ptr [eax], offset	off_1002C7D0
		mov	[eax+10h], edi
		jmp	short loc_100145B8
; ---------------------------------------------------------------------------

loc_100145B6:				; CODE XREF: sub_1001436D+233j
		mov	eax, ebx

loc_100145B8:				; CODE XREF: sub_1001436D+247j
		mov	[edi+0BCh], eax
		mov	[edi+0C0h], eax
		mov	[edi+0C4h], eax
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_1001436D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100145D0	proc near		; DATA XREF: .rdata:1002CD4Co

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_100145ED
		test	[esp+4+arg_0], 1
		jz	short loc_100145E7
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100145E7:				; CODE XREF: sub_100145D0+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100145D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100145ED	proc near		; CODE XREF: sub_100145D0+3p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		push	esi
		push	edi
		mov	edi, ecx
		mov	eax, [edi+2Ch]
		mov	dword ptr [edi], offset	off_1002CD44
		mov	dword ptr [edi+10h], offset off_1002CCDC
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10014629

loc_10014610:				; CODE XREF: sub_100145ED+3Aj
		mov	ebx, [esi+8]
		test	ebx, ebx
		jz	short loc_10014622
		mov	ecx, ebx
		call	sub_100177EE
		push	ebx
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_10014622:				; CODE XREF: sub_100145ED+28j
		mov	esi, [esi]
		cmp	esi, [edi+2Ch]
		jnz	short loc_10014610

loc_10014629:				; CODE XREF: sub_100145ED+21j
		mov	ecx, [edi+7Ch]
		xor	esi, esi
		inc	esi
		test	ecx, ecx
		jz	short loc_10014639
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014639:				; CODE XREF: sub_100145ED+44j
		mov	ecx, [edi+90h]
		test	ecx, ecx
		jz	short loc_10014649
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014649:				; CODE XREF: sub_100145ED+54j
		mov	ecx, [edi+94h]
		test	ecx, ecx
		jz	short loc_10014659
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014659:				; CODE XREF: sub_100145ED+64j
		mov	ecx, [edi+0A8h]
		test	ecx, ecx
		jz	short loc_10014669
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014669:				; CODE XREF: sub_100145ED+74j
		mov	ecx, [edi+0B0h]
		test	ecx, ecx
		jz	short loc_10014679
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014679:				; CODE XREF: sub_100145ED+84j
		mov	ecx, [edi+0B8h]
		test	ecx, ecx
		jz	short loc_10014689
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014689:				; CODE XREF: sub_100145ED+94j
		mov	ebx, [edi+0C8h]
		test	ebx, ebx
		jz	short loc_100146C5
		mov	eax, [ebx]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100146BA

loc_1001469B:				; CODE XREF: sub_100145ED+CBj
		mov	eax, [esi+8]
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	short loc_100146B4
		mov	ecx, eax
		call	sub_1000FD8D
		push	[esp+14h+var_4]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_100146B4:				; CODE XREF: sub_100145ED+B7j
		mov	esi, [esi]
		cmp	esi, [ebx]
		jnz	short loc_1001469B

loc_100146BA:				; CODE XREF: sub_100145ED+ACj
		mov	ecx, ebx
		call	sub_10008CED
		push	ebx
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_100146C5:				; CODE XREF: sub_100145ED+A4j
		push	dword ptr [edi+0CCh]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		lea	eax, [edi+14h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		mov	esi, [edi+0F0h]
		test	esi, esi
		jz	short loc_1001472E
		mov	eax, [esi+14h]
		xor	ebx, ebx
		sub	eax, [esi+10h]
		sar	eax, 3
		test	eax, eax
		jz	short loc_1001470B

loc_100146F1:				; CODE XREF: sub_100145ED+11Cj
		mov	eax, [esi+10h]
		push	dword ptr [eax+ebx*8] ;	hMem
		call	ds:LocalFree
		mov	eax, [esi+14h]
		inc	ebx
		sub	eax, [esi+10h]
		sar	eax, 3
		cmp	ebx, eax
		jb	short loc_100146F1

loc_1001470B:				; CODE XREF: sub_100145ED+102j
		push	dword ptr [esi]	; hMem
		call	ds:LocalFree
		cmp	dword ptr [esi+10h], 0
		jz	short loc_1001472A
		push	dword ptr [esi+10h]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+18h], eax

loc_1001472A:				; CODE XREF: sub_100145ED+12Aj
		push	esi
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_1001472E:				; CODE XREF: sub_100145ED+F3j
		lea	ecx, [edi+0E4h]
		call	sub_1000393B
		lea	ecx, [edi+0DCh]
		call	sub_1000C1D9
		lea	ecx, [edi+0D0h]
		call	sub_1000393B
		lea	ecx, [edi+2Ch]
		call	sub_10008CED
		mov	ecx, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 4
		jmp	sub_10009B59
sub_100145ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014765	proc near		; DATA XREF: .rdata:off_1002CCDCo
		xor	eax, eax
		add	ecx, 24h
		inc	eax
		lock xadd [ecx], eax
		retn
sub_10014765	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014770	proc near		; DATA XREF: .rdata:1002CCE0o
		lea	eax, [ecx+24h]
		or	edx, 0FFFFFFFFh
		lock xadd [eax], edx
		jnz	short locret_10014788
		add	ecx, 0FFFFFFF0h
		jz	short locret_10014788
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

locret_10014788:			; CODE XREF: sub_10014770+Aj
					; sub_10014770+Fj
		retn
sub_10014770	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014789	proc near		; DATA XREF: .rdata:1002CCE4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		cmp	eax, edx
		jge	short loc_1001479A
		push	2
		pop	eax
		jmp	short locret_100147A2
; ---------------------------------------------------------------------------

loc_1001479A:				; CODE XREF: sub_10014789+Aj
		mov	[ecx+2Ch], eax
		xor	eax, eax
		mov	[ecx+28h], edx

locret_100147A2:			; CODE XREF: sub_10014789+Fj
		retn	8
sub_10014789	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147A5	proc near		; DATA XREF: .rdata:1002CCE8o
		mov	eax, [ecx+2Ch]
		retn
sub_100147A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147A9	proc near		; DATA XREF: .rdata:1002CCECo
		mov	eax, [ecx+28h]
		retn
sub_100147A9	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147AD	proc near		; DATA XREF: .rdata:1002CCF0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword ptr [ecx+38h], 0
		mov	eax, [esp+arg_0]
		jz	short loc_100147C1
		cmp	eax, 5
		jnz	short loc_100147C1
		push	2
		pop	eax
		jmp	short locret_100147CD
; ---------------------------------------------------------------------------

loc_100147C1:				; CODE XREF: sub_100147AD+8j
					; sub_100147AD+Dj
		mov	[ecx+30h], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+34h], eax
		xor	eax, eax

locret_100147CD:			; CODE XREF: sub_100147AD+12j
		retn	8
sub_100147AD	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147D0	proc near		; DATA XREF: .rdata:1002CCF4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100147E3
		cmp	dword ptr [ecx+30h], 5
		jnz	short loc_100147E3
		push	2
		pop	eax
		jmp	short locret_100147E8
; ---------------------------------------------------------------------------

loc_100147E3:				; CODE XREF: sub_100147D0+6j
					; sub_100147D0+Cj
		mov	[ecx+38h], eax
		xor	eax, eax

locret_100147E8:			; CODE XREF: sub_100147D0+11j
		retn	4
sub_100147D0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147EB	proc near		; DATA XREF: .rdata:1002CCF8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	edx, [ecx]
		push	eax
		mov	byte ptr [ecx+3Ch], 1
		mov	[ecx+3Dh], al
		call	dword ptr [edx+24h]
		retn	4
sub_100147EB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100147FF	proc near		; DATA XREF: .rdata:1002CCFCo

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	al, [ecx+3Ch]
		test	al, al
		jnz	short loc_10014825
		cmp	[ecx+3Dh], al
		jnz	short loc_10014823

loc_1001480E:				; CODE XREF: sub_100147FF+2Fj
					; sub_100147FF+39j ...
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax+10h], 0
		xor	ecx, ecx
		mov	dword ptr [eax+14h], 7
		mov	[eax], cx
		jmp	short loc_10014850
; ---------------------------------------------------------------------------

loc_10014823:				; CODE XREF: sub_100147FF+Dj
		test	al, al

loc_10014825:				; CODE XREF: sub_100147FF+8j
		mov	eax, handle
		jz	short loc_10014830
		test	eax, eax
		jz	short loc_1001480E

loc_10014830:				; CODE XREF: sub_100147FF+2Bj
		cmp	byte ptr [ecx+3Dh], 0
		jz	short loc_10014843
		test	eax, eax
		jz	short loc_1001480E
		cmp	hObj, 0
		jz	short loc_1001480E

loc_10014843:				; CODE XREF: sub_100147FF+35j
		push	ecx
		mov	ecx, [ebp+arg_0]
		call	sub_10018B7D
		mov	eax, [ebp+arg_0]
		pop	ecx

loc_10014850:				; CODE XREF: sub_100147FF+22j
		pop	ebp
		retn	4
sub_100147FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014854	proc near		; DATA XREF: .rdata:1002CD00o

var_21		= byte ptr -21h
var_20		= dword	ptr -20h
Dst		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		xor	ebx, ebx
		mov	[esp+28h+var_20], ebx
		cmp	[ebp+arg_0], bl
		jz	loc_10014951
		cmp	hObj, ebx
		jnz	short loc_10014890
		cmp	handle,	ebx
		jz	short loc_1001489C

loc_10014888:				; CODE XREF: sub_10014854+103j
		push	3

loc_1001488A:				; CODE XREF: sub_10014854+99j
		pop	eax
		jmp	loc_1001493F
; ---------------------------------------------------------------------------

loc_10014890:				; CODE XREF: sub_10014854+2Aj
		cmp	handle,	ebx
		jnz	loc_1001493D

loc_1001489C:				; CODE XREF: sub_10014854+32j
		call	sub_10018947
		test	eax, eax
		jnz	loc_1001493F
		mov	edx, hObj	; hObj
		test	edx, edx
		jz	short loc_100148CA
		push	2
		pop	ebx
		lea	ecx, [esp+28h+Dst] ; Dst
		call	sub_10018AE9
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_100148CF

loc_100148CA:				; CODE XREF: sub_10014854+5Dj
		mov	[esp+28h+var_21], 1

loc_100148CF:				; CODE XREF: sub_10014854+74j
		test	bl, 2
		jz	short loc_100148E4
		push	0
		push	1
		lea	ecx, [esp+30h+Dst]
		and	ebx, 0FFFFFFFDh
		call	sub_100022FA

loc_100148E4:				; CODE XREF: sub_10014854+7Ej
		cmp	[esp+28h+var_21], 0
		jz	short loc_100148EF

loc_100148EB:				; CODE XREF: sub_10014854+E7j
		push	0Bh
		jmp	short loc_1001488A
; ---------------------------------------------------------------------------

loc_100148EF:				; CODE XREF: sub_10014854+95j
		mov	ecx, hObj	; hWinSta
		call	sub_100189A5
		test	eax, eax
		jnz	short loc_1001493F
		mov	edx, handle	; hObj
		test	edx, edx
		jz	short loc_1001491F
		lea	ecx, [esp+28h+Dst] ; Dst
		or	ebx, 4
		call	sub_10018AE9
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_10014924

loc_1001491F:				; CODE XREF: sub_10014854+B2j
		mov	[esp+28h+var_21], 1

loc_10014924:				; CODE XREF: sub_10014854+C9j
		test	bl, 4

loc_10014927:				; CODE XREF: sub_10014854+145j
		jz	short loc_10014936
		push	0
		push	1
		lea	ecx, [esp+30h+Dst]
		call	sub_100022FA

loc_10014936:				; CODE XREF: sub_10014854:loc_10014927j
		cmp	[esp+28h+var_21], 0
		jnz	short loc_100148EB

loc_1001493D:				; CODE XREF: sub_10014854+42j
					; sub_10014854+10Fj
		xor	eax, eax

loc_1001493F:				; CODE XREF: sub_10014854+37j
					; sub_10014854+4Fj ...
		mov	ecx, [esp+28h+var_4]
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_10014951:				; CODE XREF: sub_10014854+1Ej
		cmp	hObj, ebx
		jnz	loc_10014888
		cmp	handle,	ebx
		jnz	short loc_1001493D
		xor	ecx, ecx	; hWinSta
		call	sub_100189A5
		test	eax, eax
		jnz	short loc_1001493F
		mov	edx, handle	; hObj
		test	edx, edx
		jz	short loc_10014991
		push	8
		pop	ebx
		lea	ecx, [esp+28h+Dst] ; Dst
		call	sub_10018AE9
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_10014996

loc_10014991:				; CODE XREF: sub_10014854+124j
		mov	[esp+28h+var_21], 1

loc_10014996:				; CODE XREF: sub_10014854+13Bj
		test	bl, 8
		jmp	short loc_10014927
sub_10014854	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001499B	proc near		; DATA XREF: .rdata:1002CD04o
		mov	eax, handle
		test	eax, eax
		jz	short loc_100149B2
		push	eax		; hDesktop
		call	ds:CloseDesktop
		and	handle,	0

loc_100149B2:				; CODE XREF: sub_1001499B+7j
		mov	eax, hObj
		test	eax, eax
		jz	short locret_100149C9
		push	eax		; hWinSta
		call	ds:CloseWindowStation
		and	hObj, 0

locret_100149C9:			; CODE XREF: sub_1001499B+1Ej
		retn
sub_1001499B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149CA	proc near		; DATA XREF: .rdata:1002CD08o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+48h], eax
		xor	eax, eax
		retn	4
sub_100149CA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149D6	proc near		; DATA XREF: .rdata:1002CD0Co
		mov	eax, [ecx+48h]
		retn
sub_100149D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149DA	proc near		; DATA XREF: .rdata:1002CD10o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+4Ch], eax
		xor	eax, eax
		retn	4
sub_100149DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100149E6	proc near		; DATA XREF: .rdata:1002CD14o

Src		= dword	ptr -24h
var_20		= dword	ptr -20h
StringSid	= word ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		and	[esp+24h+var_20], 0
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	esi, ecx
		mov	[esp+30h+Src], edi
		call	sub_100063BF
		cmp	dword ptr [eax], 5
		jge	short loc_10014A1C
		xor	eax, eax
		jmp	loc_10014AA5
; ---------------------------------------------------------------------------

loc_10014A1C:				; CODE XREF: sub_100149E6+2Dj
		mov	eax, [esi+28h]
		cmp	eax, 2
		jl	short loc_10014AA2
		cmp	eax, [esi+2Ch]
		jnz	short loc_10014AA2
		push	1Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_10014A4F
		xor	eax, eax
		mov	edi, ebx
		mov	[ebx+10h], eax
		mov	[ebx+14h], eax
		mov	[ebx+18h], eax
		stosd
		stosd
		stosd
		stosd
		mov	edi, [esp+30h+Src]
		jmp	short loc_10014A51
; ---------------------------------------------------------------------------

loc_10014A4F:				; CODE XREF: sub_100149E6+50j
		xor	ebx, ebx

loc_10014A51:				; CODE XREF: sub_100149E6+67j
		mov	ecx, [esi+0E0h]
		and	dword ptr [esi+0E0h], 0
		test	ecx, ecx
		jz	short loc_10014A68
		push	ecx
		call	sub_100153C1

loc_10014A68:				; CODE XREF: sub_100149E6+7Aj
		push	edi		; Src
		lea	ecx, [esp+34h+StringSid] ; Dst
		mov	[esi+0E0h], ebx
		call	sub_10001C68
		mov	ecx, [esi+0E0h]
		lea	eax, [esi+0D4h]
		push	eax		; int
		lea	eax, [esp+34h+StringSid]
		push	eax		; StringSid
		call	sub_10007A59
		push	0
		push	1
		lea	ecx, [esp+38h+StringSid]
		mov	esi, eax
		call	sub_100022FA
		mov	eax, esi
		jmp	short loc_10014AA5
; ---------------------------------------------------------------------------

loc_10014AA2:				; CODE XREF: sub_100149E6+3Cj
					; sub_100149E6+41j
		push	10h
		pop	eax

loc_10014AA5:				; CODE XREF: sub_100149E6+31j
					; sub_100149E6+BAj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100149E6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014AB9(void *)
sub_10014AB9	proc near		; DATA XREF: .rdata:1002CD18o

Src		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+Src]	; Dst
		push	eax		; Src
		call	sub_10001C68
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	ecx, [esi+0D4h]
		call	sub_100035CD
		push	0
		push	1
		lea	ecx, [ebp+Src]
		call	sub_100022FA
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014AB9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B06	proc near		; DATA XREF: .rdata:1002CD1Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, esi
		push	edi
		mov	edi, [esp+8+arg_4]
		and	edx, 100h
		mov	eax, edi
		and	eax, 1
		or	edx, eax
		jz	short loc_10014B26
		push	2
		pop	eax
		jmp	short loc_10014B2E
; ---------------------------------------------------------------------------

loc_10014B26:				; CODE XREF: sub_10014B06+19j
		mov	[ecx+50h], esi
		xor	eax, eax
		mov	[ecx+54h], edi

loc_10014B2E:				; CODE XREF: sub_10014B06+1Ej
		pop	edi
		pop	esi
		retn	8
sub_10014B06	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B33	proc near		; DATA XREF: .rdata:1002CD20o
		mov	eax, [ecx+50h]
		mov	edx, [ecx+54h]
		retn
sub_10014B33	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B3A	proc near		; DATA XREF: .rdata:1002CD24o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	edx
		push	esi
		mov	edi, ecx
		call	sub_10010668
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10014B58
		push	2
		pop	eax
		jmp	short loc_10014B60
; ---------------------------------------------------------------------------

loc_10014B58:				; CODE XREF: sub_10014B3A+17j
		mov	[edi+58h], esi
		xor	eax, eax
		mov	[edi+5Ch], edx

loc_10014B60:				; CODE XREF: sub_10014B3A+1Cj
		pop	edi
		pop	esi
		retn	8
sub_10014B3A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B65	proc near		; DATA XREF: .rdata:1002CD28o
		mov	eax, [ecx+58h]
		mov	edx, [ecx+5Ch]
		retn
sub_10014B65	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B6C	proc near		; DATA XREF: .rdata:1002CD2Co
		mov	byte ptr [ecx+3Fh], 0
		retn
sub_10014B6C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014B71(HANDLE hFile)
sub_10014B71	proc near		; DATA XREF: .rdata:1002CD30o

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		mov	edi, ecx
		mov	ecx, esi	; hFile
		call	sub_10014349
		test	al, al
		jnz	short loc_10014B89
		push	2
		pop	eax
		jmp	short loc_10014B8E
; ---------------------------------------------------------------------------

loc_10014B89:				; CODE XREF: sub_10014B71+11j
		mov	[edi+40h], esi
		xor	eax, eax

loc_10014B8E:				; CODE XREF: sub_10014B71+16j
		pop	edi
		pop	esi
		retn	4
sub_10014B71	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014B93(HANDLE hFile)
sub_10014B93	proc near		; DATA XREF: .rdata:1002CD34o

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		mov	edi, ecx
		mov	ecx, esi	; hFile
		call	sub_10014349
		test	al, al
		jnz	short loc_10014BAB
		push	2
		pop	eax
		jmp	short loc_10014BB0
; ---------------------------------------------------------------------------

loc_10014BAB:				; CODE XREF: sub_10014B93+11j
		mov	[edi+44h], esi
		xor	eax, eax

loc_10014BB0:				; CODE XREF: sub_10014B93+16j
		pop	edi
		pop	esi
		retn	4
sub_10014B93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014BB5(int, int, void *Src)
sub_10014BB5	proc near		; DATA XREF: .rdata:1002CD38o

var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
Src		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0B8h
		push	ebx
		push	esi
		push	[ebp+Src]	; Src
		xor	ebx, ebx
		add	ecx, 0FFFFFFF0h
		push	[ebp+arg_4]	; int
		mov	[esp+0C8h+var_B4], ebx
		push	[ebp+arg_0]	; int
		call	sub_1001525E
		cmp	dword_10031374,	2
		mov	esi, eax
		jg	loc_10014C79
		test	esi, esi
		jz	loc_10014C79
		push	2
		push	17Ch
		push	offset aCBuildsMoz2__2 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+0CCh+var_B0]
		inc	ebx
		call	sub_10001B31
		push	[ebp+arg_4]
		mov	edx, offset aFailedToAddSan ; "Failed to add sandbox rule."
		push	[ebp+arg_0]
		lea	ecx, [eax+8]
		push	esi
		call	sub_10002830
		mov	edx, offset aError ; " error = "
		mov	ecx, eax
		call	sub_10002830
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aSubsystem ; ", subsystem =	"
		mov	ecx, eax
		call	sub_10002830
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aSemantics ; ", semantics =	"
		mov	ecx, eax
		call	sub_10002830
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aPattern ; ", pattern = '"
		mov	ecx, eax
		call	sub_10002830
		mov	edx, [ebp+Src]
		mov	ecx, eax
		call	sub_10001BEE
		mov	edx, offset asc_1002CB94 ; "'"
		mov	ecx, eax
		call	sub_10002830

loc_10014C79:				; CODE XREF: sub_10014BB5+2Ej
					; sub_10014BB5+36j
		test	bl, 1
		jz	short loc_10014C87
		lea	ecx, [esp+0C0h+var_B0]
		call	sub_10001BD6

loc_10014C87:				; CODE XREF: sub_10014BB5+C7j
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10014BB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014C91(void *)
sub_10014C91	proc near		; DATA XREF: .rdata:1002CD3Co

Src		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+Src]	; Dst
		push	eax		; Src
		call	sub_10001C68
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	ecx, [esi+0C0h]
		call	sub_100035CD
		push	0
		push	1
		lea	ecx, [ebp+Src]
		call	sub_100022FA
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014C91	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014CDE	proc near		; DATA XREF: .rdata:1002CD40o
		add	ecx, 0CCh
		jmp	sub_1000BC30
sub_10014CDE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014CE9	proc near		; DATA XREF: .rdata:off_1002CD44o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, offset dword_1002CC24
		push	edi
		mov	edi, ecx
		xor	ecx, ecx
		mov	[esp+10h+var_4], ecx
		mov	edx, ecx

loc_10014D05:				; CODE XREF: sub_10014CE9+28j
		mov	eax, [ebx+edx*4]
		cmp	eax, [esi+edx*4]
		jnz	short loc_10014D15
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_10014D05
		jmp	short loc_10014D2A
; ---------------------------------------------------------------------------

loc_10014D15:				; CODE XREF: sub_10014CE9+22j
		mov	ebx, offset dword_1002CC4C
		mov	edx, ecx

loc_10014D1C:				; CODE XREF: sub_10014CE9+3Fj
		mov	eax, [ebx+edx*4]
		cmp	eax, [esi+edx*4]
		jnz	short loc_10014D37
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_10014D1C

loc_10014D2A:				; CODE XREF: sub_10014CE9+2Aj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], offset	sub_100150CB
		mov	eax, edi
		jmp	short loc_10014D55
; ---------------------------------------------------------------------------

loc_10014D37:				; CODE XREF: sub_10014CE9+39j
		mov	edx, [esi]
		lea	eax, [edx-1]
		cmp	eax, 14h
		ja	short loc_10014D45
		mov	ecx, [edi+edx*4+70h]

loc_10014D45:				; CODE XREF: sub_10014CE9+56j
		test	ecx, ecx
		jnz	short loc_10014D4D
		xor	eax, eax
		jmp	short loc_10014D55
; ---------------------------------------------------------------------------

loc_10014D4D:				; CODE XREF: sub_10014CE9+5Ej
		push	[ebp+arg_4]
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax]

loc_10014D55:				; CODE XREF: sub_10014CE9+4Cj
					; sub_10014CE9+62j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10014CE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014D5E	proc near		; DATA XREF: .rdata:1002CD48o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		mov	edx, [ebp+arg_4]
		push	esi
		mov	esi, ecx
		xor	ecx, ecx
		mov	[esp+8+var_4], ecx
		cmp	edx, 1
		jz	short loc_10014D9A
		cmp	edx, 2
		jz	short loc_10014D9A
		lea	eax, [edx-1]
		cmp	eax, 14h
		ja	short loc_10014D87
		mov	ecx, [esi+edx*4+70h]

loc_10014D87:				; CODE XREF: sub_10014D5E+23j
		test	ecx, ecx
		jnz	short loc_10014D8F
		xor	al, al
		jmp	short loc_10014D9C
; ---------------------------------------------------------------------------

loc_10014D8F:				; CODE XREF: sub_10014D5E+2Bj
		mov	eax, [ecx]
		push	edx
		push	[ebp+arg_0]
		call	dword ptr [eax+4]
		jmp	short loc_10014D9C
; ---------------------------------------------------------------------------

loc_10014D9A:				; CODE XREF: sub_10014D5E+16j
					; sub_10014D5E+1Bj
		mov	al, 1

loc_10014D9C:				; CODE XREF: sub_10014D5E+2Fj
					; sub_10014D5E+3Aj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10014D5E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014DA3	proc near		; CODE XREF: sub_100083D0+20Ap

hObject		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword ptr [ecx+40h], 5
		jz	short loc_10014DE5
		push	dword ptr [ecx+48h]
		and	[ebp+hObject], 0
		push	dword ptr [ecx+44h]
		push	ecx
		push	dword ptr [ecx+40h]
		lea	ecx, [ebp+hObject]
		call	sub_1000E7F5
		test	eax, eax
		jz	short loc_10014DDB
		cmp	[ebp+hObject], 0
		jz	short loc_10014DD6
		push	[ebp+hObject]	; hObject
		call	ds:CloseHandle

loc_10014DD6:				; CODE XREF: sub_10014DA3+28j
		xor	eax, eax
		inc	eax
		jmp	short loc_10014DED
; ---------------------------------------------------------------------------

loc_10014DDB:				; CODE XREF: sub_10014DA3+22j
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+hObject]
		mov	[ecx], eax
		jmp	short loc_10014DEB
; ---------------------------------------------------------------------------

loc_10014DE5:				; CODE XREF: sub_10014DA3+8j
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax], 0

loc_10014DEB:				; CODE XREF: sub_10014DA3+40j
		xor	eax, eax

loc_10014DED:				; CODE XREF: sub_10014DA3+36j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014DA3	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014DF3(LPHANDLE, LPHANDLE	lpTargetHandle)
sub_10014DF3	proc near		; CODE XREF: sub_100083D0+123p
					; sub_100083D0+1D0p

arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+0Ch+lpTargetHandle]
		mov	ecx, edi	; lpTargetHandle
		push	1		; int
		push	dword ptr [esi+58h] ; int
		mov	edx, [esi+38h]
		call	sub_10013563
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10014E16

loc_10014E11:				; CODE XREF: sub_10014DF3+5Fj
					; sub_10014DF3+B8j
		xor	eax, eax
		inc	eax
		jmp	short loc_10014E81
; ---------------------------------------------------------------------------

loc_10014E16:				; CODE XREF: sub_10014DF3+1Cj
		cmp	handle,	0
		jz	short loc_10014E5C
		cmp	byte ptr [esi+4Ch], 0
		jz	short loc_10014E5C
		mov	eax, [esi+58h]
		cmp	eax, 7
		jz	short loc_10014E5C
		cmp	dword_10031E04,	eax
		jge	short loc_10014E5C
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jl	short loc_10014E5C
		mov	ecx, [esi+58h]
		call	sub_10013BA9
		push	eax		; Src
		push	ecx		; int
		call	sub_10013A70
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10014E11
		mov	eax, [esi+58h]
		mov	dword_10031E04,	eax

loc_10014E5C:				; CODE XREF: sub_10014DF3+2Aj
					; sub_10014DF3+30j ...
		mov	eax, [esi+0F0h]
		test	eax, eax
		jz	short loc_10014E8C
		cmp	dword ptr [eax], 0
		jz	short loc_10014E8C
		mov	eax, [esi+38h]
		cmp	eax, 2
		jl	short loc_10014E87
		cmp	eax, [esi+3Ch]
		jnz	short loc_10014E87
		mov	eax, [esp+0Ch+arg_0]
		or	dword ptr [eax], 0FFFFFFFFh

loc_10014E7F:				; CODE XREF: sub_10014DF3+AEj
		xor	eax, eax

loc_10014E81:				; CODE XREF: sub_10014DF3+21j
					; sub_10014DF3+97j
		pop	edi
		pop	esi
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_10014E87:				; CODE XREF: sub_10014DF3+7Ej
					; sub_10014DF3+83j
		push	10h
		pop	eax
		jmp	short loc_10014E81
; ---------------------------------------------------------------------------

loc_10014E8C:				; CODE XREF: sub_10014DF3+71j
					; sub_10014DF3+76j
		mov	edx, [esi+3Ch]
		mov	ecx, [esp+0Ch+arg_0] ; lpTargetHandle
		push	0		; int
		push	dword ptr [esi+58h] ; int
		call	sub_10013563
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10014E7F
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		jmp	loc_10014E11
sub_10014DF3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014EB0	proc near		; CODE XREF: sub_100083D0+493p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+0CCh], 0
		jz	short loc_10014ECA
		mov	ecx, [edi+0C8h]
		call	sub_1000F74B

loc_10014ECA:				; CODE XREF: sub_10014EB0+Dj
		mov	ebp, [esp+10h+arg_0]
		push	dword ptr [edi+64h]
		push	dword ptr [edi+60h] ; int
		mov	ecx, [ebp+0]	; hProcess
		call	sub_100105BE
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10014EE9

loc_10014EE2:				; CODE XREF: sub_10014EB0+43j
					; sub_10014EB0+53j ...
		xor	al, al
		jmp	loc_10014FDD
; ---------------------------------------------------------------------------

loc_10014EE9:				; CODE XREF: sub_10014EB0+30j
		push	ebp
		mov	ecx, edi
		call	sub_1001510E
		test	al, al
		jz	short loc_10014EE2
		push	ebp
		lea	ecx, [edi+0DCh]
		call	sub_1000BE9E
		test	al, al
		jz	short loc_10014EE2
		push	ecx		; int
		push	ecx		; int
		push	dword ptr [edi+0CCh] ; Src
		mov	ecx, ebp
		push	edi		; int
		call	sub_10017B3A
		test	eax, eax
		jnz	short loc_10014EE2
		mov	eax, [edi+5Ch]
		mov	ecx, ebp
		push	4		; nSize
		push	offset g_shared_delayed_integrity_level	; lpBuffer
		push	offset aG_shared_del_1 ; "g_shared_delayed_integrity_level"
		mov	g_shared_delayed_integrity_level, eax
		call	sub_10017AC0
		mov	g_shared_delayed_integrity_level, 7
		test	eax, eax
		jnz	short loc_10014EE2
		mov	esi, [edi+60h]
		mov	ebx, [edi+64h]
		call	sub_100063BF
		cmp	dword ptr [eax], 3
		jge	short loc_10014F59
		and	esi, 3
		xor	ebx, ebx
		jmp	short loc_10014F6E
; ---------------------------------------------------------------------------

loc_10014F59:				; CODE XREF: sub_10014EB0+A0j
		cmp	dword ptr [eax], 4
		jge	short loc_10014F63

loc_10014F5E:				; CODE XREF: sub_10014EB0+B6j
		and	esi, 60h
		jmp	short loc_10014F6B
; ---------------------------------------------------------------------------

loc_10014F63:				; CODE XREF: sub_10014EB0+ACj
		cmp	dword ptr [eax], 5
		jl	short loc_10014F5E
		and	esi, 40h

loc_10014F6B:				; CODE XREF: sub_10014EB0+B1j
		and	ebx, 1

loc_10014F6E:				; CODE XREF: sub_10014EB0+A7j
		mov	eax, [edi+6Ch]
		mov	ecx, [edi+68h]
		or	eax, ebx
		or	ecx, esi
		mov	dword_10031E1C,	eax
		push	eax
		push	ecx
		mov	g_shared_delayed_mitigations, ecx
		call	sub_10010668
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_10014EE2
		push	8		; nSize
		push	offset g_shared_delayed_mitigations ; lpBuffer
		push	offset aG_shared_del_2 ; "g_shared_delayed_mitigations"
		mov	ecx, ebp
		call	sub_10017AC0
		and	g_shared_delayed_mitigations, 0
		and	dword_10031E1C,	0
		test	eax, eax
		jnz	loc_10014EE2
		lea	esi, [edi+14h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	ecx, [esp+10h+arg_0]
		push	ecx
		lea	ecx, [edi+2Ch]
		call	sub_10008D20
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_10014FDD:				; CODE XREF: sub_10014EB0+34j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10014EB0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014FE4	proc near		; CODE XREF: sub_100081BC+26p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ebp, [edi+14h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [edi+2Ch]
		mov	eax, [edx]
		cmp	eax, edx
		jz	short loc_10015013
		mov	esi, [esp+10h+arg_0]

loc_10015001:				; CODE XREF: sub_10014FE4+29j
		mov	ecx, [eax+8]
		cmp	[ecx+1Ch], esi
		jz	short loc_1001500F
		mov	eax, [eax]
		cmp	eax, edx
		jnz	short loc_10015001

loc_1001500F:				; CODE XREF: sub_10014FE4+23j
		cmp	eax, edx
		jnz	short loc_10015017

loc_10015013:				; CODE XREF: sub_10014FE4+17j
		xor	bl, bl
		jmp	short loc_10015047
; ---------------------------------------------------------------------------

loc_10015017:				; CODE XREF: sub_10014FE4+2Dj
		mov	edx, [eax+4]
		mov	ecx, [eax]
		mov	esi, [eax+8]
		push	eax
		mov	[edx], ecx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		dec	dword ptr [edi+30h]
		mov	edi, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		test	esi, esi
		jz	short loc_10015045
		mov	ecx, esi
		call	sub_100177EE
		push	esi
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_10015045:				; CODE XREF: sub_10014FE4+54j
		mov	bl, 1

loc_10015047:				; CODE XREF: sub_10014FE4+31j
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		retn	4
sub_10014FE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015057	proc near		; CODE XREF: sub_10009CCF+98p
					; sub_10009DD3+98p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 14h
		and	[esp+14h+var_10], 0
		mov	ecx, [ecx+0CCh]
		push	esi
		test	ecx, ecx
		jz	short loc_100150C1
		mov	eax, [ebp+arg_0]
		mov	esi, [ecx+eax*4]
		test	esi, esi
		jz	short loc_100150C1
		mov	edx, [ebp+arg_4]
		xor	eax, eax
		cmp	[edx], eax
		jle	short loc_10015093
		lea	ecx, [edx+4]

loc_10015086:				; CODE XREF: sub_10015057+3Aj
		cmp	dword ptr [ecx], 0
		jz	short loc_100150BD
		inc	eax
		add	ecx, 8
		cmp	eax, [edx]
		jl	short loc_10015086

loc_10015093:				; CODE XREF: sub_10015057+2Aj
		push	dword ptr [edx]
		and	[esp+1Ch+var_C], 0
		lea	eax, [edx+4]
		mov	[esp+1Ch+var_4], esi
		xor	esi, esi
		push	eax
		push	ecx
		inc	esi
		lea	ecx, [esp+24h+var_C]
		mov	[esp+24h+var_8], esi
		call	sub_1000F5ED
		cmp	eax, esi
		jnz	short loc_100150C1
		mov	eax, [esp+18h+var_8]
		jmp	short loc_100150C4
; ---------------------------------------------------------------------------

loc_100150BD:				; CODE XREF: sub_10015057+32j
		push	9
		jmp	short loc_100150C3
; ---------------------------------------------------------------------------

loc_100150C1:				; CODE XREF: sub_10015057+17j
					; sub_10015057+21j ...
		push	4

loc_100150C3:				; CODE XREF: sub_10015057+68j
		pop	eax

loc_100150C4:				; CODE XREF: sub_10015057+64j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10015057	endp


; =============== S U B	R O U T	I N E =======================================


sub_100150CB	proc near		; DATA XREF: sub_10014CE9+44o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		dec	eax
		jz	short loc_100150EF
		dec	eax
		jnz	short loc_100150E1
		mov	ecx, [esp+4+arg_4]
		cmp	dword ptr [ecx], 4
		jz	short loc_100150E5

loc_100150E1:				; CODE XREF: sub_100150CB+Bj
		xor	al, al
		jmp	short loc_1001510A
; ---------------------------------------------------------------------------

loc_100150E5:				; CODE XREF: sub_100150CB+14j
		mov	ecx, [ecx+4]
		imul	eax, [ecx], 3
		mov	[ecx], eax
		jmp	short loc_10015108
; ---------------------------------------------------------------------------

loc_100150EF:				; CODE XREF: sub_100150CB+8j
		mov	dword ptr [esi+14h], 2
		call	ds:GetTickCount
		mov	[esi+1Ch], eax
		mov	eax, [esp+4+arg_4]
		add	eax, eax
		mov	[esi+20h], eax

loc_10015108:				; CODE XREF: sub_100150CB+22j
		mov	al, 1

loc_1001510A:				; CODE XREF: sub_100150CB+18j
		pop	esi
		retn	8
sub_100150CB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001510E	proc near		; CODE XREF: sub_10014EB0+3Cp

var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_58		= byte ptr -58h
Dst		= byte ptr -40h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+80h+arg_0]
		xor	eax, eax
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+88h+var_64], ebp
		push	eax
		push	eax
		mov	[esp+90h+var_74], ebp
		mov	bl, [edi+4Fh]
		mov	[esp+90h+var_70], eax
		mov	[esp+90h+var_6C], eax
		call	sub_1000E3F5
		xor	edx, edx
		mov	[esp+88h+var_70], eax
		mov	byte ptr [esp+88h+var_68], dl
		mov	byte ptr [esp+88h+var_68+1], bl
		cmp	[edi+0CCh], edx
		jz	short loc_10015197
		push	0FFFFFF90h
		pop	ebp
		mov	esi, edx
		lea	ebx, [edi+70h]
		sub	ebp, edi

loc_10015165:				; CODE XREF: sub_1001510E+83j
		mov	eax, [edi+0CCh]
		lea	ecx, [ebx+ebp]
		cmp	[ecx+eax], edx
		jz	short loc_1001518A
		mov	ecx, [ebx]
		lea	edx, [esp+88h+var_74]
		push	esi
		push	edx
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	loc_10015239
		xor	edx, edx

loc_1001518A:				; CODE XREF: sub_1001510E+63j
		inc	esi
		add	ebx, 4
		cmp	esi, 16h
		jl	short loc_10015165
		mov	ebp, [esp+88h+var_64]

loc_10015197:				; CODE XREF: sub_1001510E+4Bj
		mov	eax, [edi+0D0h]
		cmp	eax, [edi+0D4h]
		jz	short loc_10015214
		mov	esi, eax
		jmp	short loc_1001520C
; ---------------------------------------------------------------------------

loc_100151A9:				; CODE XREF: sub_1001510E+104j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100151B3
		mov	ebx, [esi]
		jmp	short loc_100151B5
; ---------------------------------------------------------------------------

loc_100151B3:				; CODE XREF: sub_1001510E+9Fj
		mov	ebx, esi

loc_100151B5:				; CODE XREF: sub_1001510E+A3j
		lea	ecx, [esp+88h+var_60]
		call	sub_1000D86C
		mov	ecx, ebx
		mov	dword ptr [esp+88h+var_60], 5
		call	sub_10001ADC
		push	eax		; int
		push	ebx		; Src
		lea	ecx, [esp+90h+var_58] ;	Dst
		call	sub_1000233F
		xor	ebx, ebx
		lea	ecx, [esp+88h+Dst] ; Dst
		inc	ebx
		push	ebx		; Size
		push	offset a@	; "@"
		call	sub_100018C4
		lea	eax, [esp+88h+var_60]
		mov	[esp+88h+var_10], ebx
		push	eax
		push	[esp+8Ch+var_70]
		lea	ecx, [esp+90h+var_70]
		call	sub_1000E428
		lea	ecx, [esp+88h+var_60]
		call	sub_1000D896
		add	esi, 18h

loc_1001520C:				; CODE XREF: sub_1001510E+99j
		cmp	esi, [edi+0D4h]
		jnz	short loc_100151A9

loc_10015214:				; CODE XREF: sub_1001510E+95j
		lea	ecx, [esp+88h+var_74]
		call	sub_1000F0CA
		test	al, al
		jz	short loc_10015239
		lea	ecx, [esp+88h+var_74]
		call	sub_1000D966
		test	al, al
		jz	short loc_10015239
		mov	ecx, ebp
		call	sub_1000EE41
		mov	bl, al
		jmp	short loc_1001523B
; ---------------------------------------------------------------------------

loc_10015239:				; CODE XREF: sub_1001510E+74j
					; sub_1001510E+111j ...
		xor	ebx, ebx

loc_1001523B:				; CODE XREF: sub_1001510E+129j
		lea	ecx, [esp+88h+var_70]
		call	sub_1000E3B8
		mov	ecx, [esp+88h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn	4
sub_1001510E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1001525E(int, int, void *Src)
sub_1001525E	proc near		; CODE XREF: sub_10014BB5+20p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
Src		= dword	ptr  0Ch

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ecx
		xor	ebp, ebp
		push	esi
		push	edi
		mov	[esp+18h+var_4], ebp
		cmp	[ebx+0CCh], ebp
		jnz	short loc_100152CE
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		mov	ebp, 0E000h
		push	ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		push	ebp		; Size
		xor	ebp, ebp
		mov	esi, eax
		push	ebp		; Val
		push	esi		; Dst
		call	memset
		add	esp, 0Ch
		mov	dword ptr [esi+80h], 0DF60h
		mov	[ebx+0CCh], esi
		push	0Ch
		call	edi ; operator new(uint) ; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_100152C6
		mov	esi, [ebx+0CCh]
		push	ebp
		push	ebp
		mov	[edi], ebp
		mov	[edi+4], ebp
		call	sub_10009139
		mov	[edi], eax
		mov	[edi+8], esi
		jmp	short loc_100152C8
; ---------------------------------------------------------------------------

loc_100152C6:				; CODE XREF: sub_1001525E+4Dj
		mov	edi, ebp

loc_100152C8:				; CODE XREF: sub_1001525E+66j
		mov	[ebx+0C8h], edi

loc_100152CE:				; CODE XREF: sub_1001525E+14j
		mov	eax, [esp+18h+arg_0]
		sub	eax, ebp
		jz	loc_10015380
		dec	eax
		jz	loc_1001536B
		dec	eax
		jz	short loc_10015349
		dec	eax
		jz	short loc_10015334
		dec	eax
		jz	short loc_1001531F
		dec	eax
		jz	short loc_10015307
		dec	eax
		jz	short loc_100152F7
		push	3
		jmp	loc_10015397
; ---------------------------------------------------------------------------

loc_100152F7:				; CODE XREF: sub_1001525E+90j
		push	dword ptr [ebx+0C8h]
		call	sub_10010749
		jmp	loc_100153B1
; ---------------------------------------------------------------------------

loc_10015307:				; CODE XREF: sub_1001525E+8Dj
		push	dword ptr [ebx+0C8h]
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+Src]
		call	sub_1000D645
		jmp	loc_100153B1
; ---------------------------------------------------------------------------

loc_1001531F:				; CODE XREF: sub_1001525E+8Aj
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+Src] ; Src
		call	sub_100172AA
		jmp	short loc_100153B1
; ---------------------------------------------------------------------------

loc_10015334:				; CODE XREF: sub_1001525E+87j
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+Src] ; Src
		call	sub_1001279A
		jmp	short loc_100153B1
; ---------------------------------------------------------------------------

loc_10015349:				; CODE XREF: sub_1001525E+84j
		mov	edx, [esp+18h+arg_4]
		push	3
		pop	eax
		cmp	[ebx+38h], eax
		jge	short loc_1001535A
		cmp	edx, 8
		jz	short loc_100153B8

loc_1001535A:				; CODE XREF: sub_1001525E+F5j
		push	dword ptr [ebx+0C8h]
		mov	ecx, [esp+1Ch+Src]
		call	sub_100119F6
		jmp	short loc_100153B1
; ---------------------------------------------------------------------------

loc_1001536B:				; CODE XREF: sub_1001525E+7Dj
		push	dword ptr [ebx+0C8h]
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+Src]
		call	sub_1000EDEC
		jmp	short loc_100153B1
; ---------------------------------------------------------------------------

loc_10015380:				; CODE XREF: sub_1001525E+76j
		cmp	byte ptr [ebx+4Eh], 0
		jnz	short loc_1001539E
		mov	ecx, [ebx+0C8h]
		call	sub_1000B604
		test	al, al
		jnz	short loc_1001539A

loc_10015395:				; CODE XREF: sub_1001525E+156j
		push	2

loc_10015397:				; CODE XREF: sub_1001525E+94j
		pop	eax
		jmp	short loc_100153B8
; ---------------------------------------------------------------------------

loc_1001539A:				; CODE XREF: sub_1001525E+135j
		mov	byte ptr [ebx+4Eh], 1

loc_1001539E:				; CODE XREF: sub_1001525E+126j
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+Src] ; Src
		call	sub_1000B390

loc_100153B1:				; CODE XREF: sub_1001525E+A4j
					; sub_1001525E+BCj ...
		pop	ecx
		test	al, al
		jz	short loc_10015395
		xor	eax, eax

loc_100153B8:				; CODE XREF: sub_1001525E+FAj
					; sub_1001525E+13Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_1001525E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100153C1	proc near		; CODE XREF: sub_100149E6+7Dp
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	eax, [esi+14h]
		sub	eax, [esi+10h]
		sar	eax, 3
		test	eax, eax
		jz	short loc_100153EE

loc_100153D4:				; CODE XREF: sub_100153C1+2Bj
		mov	eax, [esi+10h]
		push	dword ptr [eax+edi*8] ;	hMem
		call	ds:LocalFree
		mov	eax, [esi+14h]
		inc	edi
		sub	eax, [esi+10h]
		sar	eax, 3
		cmp	edi, eax
		jb	short loc_100153D4

loc_100153EE:				; CODE XREF: sub_100153C1+11j
		push	dword ptr [esi]	; hMem
		call	ds:LocalFree
		cmp	dword ptr [esi+10h], 0
		mov	edi, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		jz	short loc_10015414
		push	dword ptr [esi+10h]
		call	edi ; operator delete(void *) ;	operator delete(void *)
		and	dword ptr [esi+10h], 0
		and	dword ptr [esi+14h], 0
		and	dword ptr [esi+18h], 0
		pop	ecx

loc_10015414:				; CODE XREF: sub_100153C1+3Fj
		push	esi
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	4
sub_100153C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001541F	proc near		; CODE XREF: sub_1000B746+4Bp
					; sub_1000B7D4+4Ap ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		mov	eax, dword_10031FA0
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, edx
		test	eax, eax
		jnz	short loc_10015452
		push	offset aNtdll_dll_3 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		push	offset aRtlinitunicode ; "RtlInitUnicodeString"
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	dword_10031FA0,	eax

loc_10015452:				; CODE XREF: sub_1001541F+15j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001545A
		mov	esi, [esi]

loc_1001545A:				; CODE XREF: sub_1001541F+37j
		push	esi
		mov	esi, [ebp+arg_8]
		push	esi
		call	eax ; dword_10031FA0
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		and	dword ptr [ecx+10h], 0
		and	dword ptr [ecx+14h], 0
		mov	[ecx+0Ch], edi
		pop	edi
		mov	[ecx+8], esi
		mov	dword ptr [ecx], 18h
		mov	[ecx+4], eax
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001541F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015484	proc near		; DATA XREF: .rdata:1002C050o
					; .rdata:1002C078o ...
		mov	eax, [ecx]
		jmp	dword ptr [eax+0Ch]
sub_10015484	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015489	proc near		; DATA XREF: .rdata:1002C054o
					; .rdata:1002C07Co ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_1001549C

loc_10015495:				; CODE XREF: sub_10015489+2Fj
		mov	eax, 0C0000001h
		jmp	short loc_100154BC
; ---------------------------------------------------------------------------

loc_1001549C:				; CODE XREF: sub_10015489+Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_1000578C
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jz	short loc_10015495
		xor	eax, eax

loc_100154BC:				; CODE XREF: sub_10015489+11j
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10015489	endp


; =============== S U B	R O U T	I N E =======================================


sub_100154C2	proc near		; DATA XREF: .rdata:1002C060o
					; .rdata:1002C088o ...
		push	esi
		push	offset aNtdll_dll_5 ; "ntdll.dll"
		mov	esi, ecx
		call	ds:GetModuleHandleW
		mov	[esi+0Ch], eax
		pop	esi
		retn
sub_100154C2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100154D5	proc near		; DATA XREF: .rdata:1002C04Co
					; .rdata:1002C074o ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	[ebp+arg_18]
		mov	edi, ecx
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		mov	eax, [edi]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_1001555E
		mov	eax, [edi]
		mov	ecx, edi
		and	dword ptr [edi+18h], 0
		push	ebx
		push	esi
		call	dword ptr [eax+10h]
		mov	ebx, eax
		push	ebx
		call	sub_10018CA2
		mov	edx, [edi]
		mov	esi, eax
		pop	ecx
		push	esi
		mov	ecx, edi
		call	dword ptr [edx+20h]
		test	al, al
		jnz	short loc_10015538
		cmp	[edi+14h], al
		jz	short loc_10015531
		push	[ebp+arg_14]
		mov	ecx, edi
		push	esi
		call	sub_100157A0
		test	al, al
		jnz	short loc_10015538

loc_10015531:				; CODE XREF: sub_100154D5+4Bj
		mov	edi, 0C0000001h
		jmp	short loc_1001554E
; ---------------------------------------------------------------------------

loc_10015538:				; CODE XREF: sub_100154D5+46j
					; sub_100154D5+5Aj
		push	[ebp+arg_14]
		mov	eax, [edi]
		mov	ecx, edi
		push	esi
		call	dword ptr [eax+24h]
		mov	edi, eax
		mov	eax, [ebp+arg_1C]
		test	eax, eax
		jz	short loc_1001554E
		mov	[eax], ebx

loc_1001554E:				; CODE XREF: sub_100154D5+61j
					; sub_100154D5+75j
		test	esi, esi
		jz	short loc_1001555A
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1001555A:				; CODE XREF: sub_100154D5+7Bj
		pop	esi
		mov	eax, edi
		pop	ebx

loc_1001555E:				; CODE XREF: sub_100154D5+22j
		pop	edi
		pop	ebp
		retn	20h
sub_100154D5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015563	proc near		; DATA XREF: .rdata:1002C058o
					; .rdata:1002C080o ...
		push	36h
		pop	eax
		retn
sub_10015563	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015567	proc near		; DATA XREF: .rdata:1002C064o
					; .rdata:1002C08Co ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		push	edi
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	edi, eax
		test	edi, edi
		js	short loc_100155C9
		mov	eax, [esi]
		mov	ecx, esi
		push	ebx
		call	dword ptr [eax+10h]
		mov	ebx, eax
		cmp	[ebp+arg_C], ebx
		jb	short loc_100155B6
		mov	eax, [esi]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	dword ptr [eax+20h]
		test	al, al
		jnz	short loc_100155BD
		cmp	[esi+14h], al
		jz	short loc_100155B6
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	sub_100157A0
		test	al, al
		jnz	short loc_100155BD

loc_100155B6:				; CODE XREF: sub_10015567+29j
					; sub_10015567+3Cj
		mov	eax, 0C0000001h
		jmp	short loc_100155C8
; ---------------------------------------------------------------------------

loc_100155BD:				; CODE XREF: sub_10015567+37j
					; sub_10015567+4Dj
		mov	eax, [ebp+arg_10]
		test	eax, eax
		jz	short loc_100155C6
		mov	[eax], ebx

loc_100155C6:				; CODE XREF: sub_10015567+5Bj
		mov	eax, edi

loc_100155C8:				; CODE XREF: sub_10015567+54j
		pop	ebx

loc_100155C9:				; CODE XREF: sub_10015567+1Aj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
sub_10015567	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100155CF	proc near		; DATA XREF: .rdata:1002C068o

lpModuleName	= dword	ptr -24h
phModule	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= byte ptr -0Fh
lpBaseAddress	= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi
		push	edi
		mov	edi, ds:ReadProcessMemory
		mov	esi, ecx
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	loc_1001569F
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	loc_1001569F
		cmp	[ebp+Buffer], 0B8h
		jnz	loc_1001569F
		cmp	[ebp+var_F], 0BAh
		jnz	short loc_1001569F
		mov	eax, 12FFh
		mov	ecx, 0D2FFh
		cmp	ax, [ebp+var_A]
		jz	short loc_10015637
		cmp	cx, [ebp+var_A]
		jnz	short loc_1001569F

loc_10015637:				; CODE XREF: sub_100155CF+60j
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_1001569F
		cmp	cx, [ebp+var_A]
		jz	short loc_10015692
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	4		; nSize
		lea	eax, [ebp+lpModuleName]
		push	eax		; lpBuffer
		push	[ebp+lpBaseAddress] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	short loc_1001569F
		cmp	[ebp+NumberOfBytesRead], 4
		jnz	short loc_1001569F
		mov	edi, ds:GetModuleHandleExW
		lea	eax, [ebp+phModule]
		push	eax		; phModule
		push	[ebp+lpModuleName] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_1001569F
		mov	eax, [esi+0Ch]
		test	eax, eax
		jnz	short loc_1001568D
		lea	eax, [ebp+var_1C]
		push	eax		; phModule
		push	dword ptr [esi+4] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_1001569F
		mov	eax, [ebp+var_1C]

loc_1001568D:				; CODE XREF: sub_100155CF+AAj
		cmp	[ebp+phModule],	eax
		jnz	short loc_1001569F

loc_10015692:				; CODE XREF: sub_100155CF+72j
		mov	edi, ebx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		jmp	short loc_100156A1
; ---------------------------------------------------------------------------

loc_1001569F:				; CODE XREF: sub_100155CF+32j
					; sub_100155CF+3Cj ...
		xor	al, al

loc_100156A1:				; CODE XREF: sub_100155CF+CEj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100155CF	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100156B4(LPCVOID lpBuffer, int)
sub_100156B4	proc near		; DATA XREF: .rdata:1002C06Co
					; .rdata:1002C094o ...

NumberOfBytesWritten= dword ptr	-1Ch
lpBaseAddress	= dword	ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_F		= byte ptr -0Fh
var_E		= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+lpBuffer]
		mov	ebx, ecx
		mov	ecx, [esp+24h+arg_4]
		push	esi
		push	edi
		mov	eax, [ebp+1]
		lea	edi, [esp+2Ch+Buffer]
		mov	esi, ebp
		mov	[esp+2Ch+lpBaseAddress], ecx
		push	0Ch
		movsd
		movsd
		movsd
		movsd
		mov	[esp+30h+var_13], eax
		lea	eax, [ecx+18h]
		mov	[esp+30h+var_E], eax
		mov	eax, 0E2FFh
		mov	[esp+30h+var_A], ax
		mov	eax, [ebx+18h]
		mov	[esp+30h+Buffer], 0B8h
		mov	[esp+30h+var_F], 0BAh
		pop	esi
		test	eax, eax
		jz	short loc_10015716
		push	5
		mov	[esp+30h+Buffer], 0E9h
		mov	[esp+30h+var_13], eax
		pop	esi

loc_10015716:				; CODE XREF: sub_100156B4+54j
		push	dword ptr [ebx+8]
		lea	eax, [ebp+18h]
		push	ecx
		push	1Eh
		push	eax
		call	sub_10012A69
		mov	eax, [ebx]
		mov	ecx, ebx
		call	dword ptr [eax+10h]
		mov	edi, eax
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		push	ebp		; lpBuffer
		push	[esp+38h+lpBaseAddress]	; lpBaseAddress
		mov	ebp, ds:WriteProcessMemory
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax
		jnz	short loc_1001574F

loc_10015748:				; CODE XREF: sub_100156B4+9Fj
					; sub_100156B4:loc_10015770j
		mov	eax, 0C0000001h
		jmp	short loc_10015774
; ---------------------------------------------------------------------------

loc_1001574F:				; CODE XREF: sub_100156B4+92j
		cmp	edi, [esp+2Ch+NumberOfBytesWritten]
		jnz	short loc_10015748
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_10015789
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		lea	eax, [esp+34h+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ebx+4] ; lpBaseAddress
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax

loc_10015770:				; CODE XREF: sub_100156B4+EAj
		jz	short loc_10015748
		xor	eax, eax

loc_10015774:				; CODE XREF: sub_100156B4+99j
		mov	ecx, [esp+2Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn	8
; ---------------------------------------------------------------------------

loc_10015789:				; CODE XREF: sub_100156B4+A5j
		mov	edx, [ebx+4]	; lpAddress
		lea	eax, [esp+2Ch+Buffer]
		mov	ecx, [ebx+10h]	; hProcess
		push	esi		; dwSize
		push	eax		; lpBuffer
		call	sub_100187B5
		pop	ecx
		pop	ecx
		test	al, al
		jmp	short loc_10015770
sub_100156B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100157A0	proc near		; CODE XREF: sub_100154D5+53p
					; sub_10015567+46p

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		mov	esi, ecx
		lea	eax, [ebp+Buffer]
		push	10h		; nSize
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100157D5

loc_100157D1:				; CODE XREF: sub_100157A0+39j
		xor	al, al
		jmp	short loc_100157FE
; ---------------------------------------------------------------------------

loc_100157D5:				; CODE XREF: sub_100157A0+2Fj
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100157D1
		cmp	[ebp+Buffer], 0E9h
		jnz	short loc_100157F5
		mov	eax, [esi+4]
		mov	ecx, [ebp+arg_4]
		sub	eax, ecx
		sub	ecx, [esi+4]
		add	[ebp+var_13], eax
		add	ecx, 13h
		mov	[esi+18h], ecx

loc_100157F5:				; CODE XREF: sub_100157A0+3Fj
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd

loc_100157FE:				; CODE XREF: sub_100157A0+33j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100157A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015810	proc near		; DATA XREF: .rdata:1002C0B8o

NumberOfBytesRead= dword ptr -20h
Buffer		= byte ptr -1Ch
var_17		= word ptr -17h
var_15		= dword	ptr -15h
var_11		= dword	ptr -11h
var_D		= word ptr -0Dh
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	18h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_1001589E
		cmp	[ebp+NumberOfBytesRead], 18h
		jnz	short loc_1001589E
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_1001589E
		mov	eax, 0C933h
		cmp	ax, [ebp+var_17]
		jnz	short loc_1001589E
		cmp	[ebp+var_15], 424548Dh
		jnz	short loc_1001589E
		cmp	[ebp+var_11], 0C015FF64h
		jnz	short loc_1001589E
		xor	eax, eax
		cmp	ax, [ebp+var_D]
		jnz	short loc_1001589E
		cmp	[ebp+var_B], al
		jnz	short loc_1001589E
		mov	al, [ebp+var_A]
		cmp	al, 83h
		jnz	short loc_1001588C
		mov	ecx, 4C4h
		cmp	cx, [ebp+var_9]
		jnz	short loc_1001589E
		cmp	[ebp+var_7], 0C2h
		jz	short loc_10015890

loc_1001588C:				; CODE XREF: sub_10015810+69j
		cmp	al, 0C2h
		jnz	short loc_1001589E

loc_10015890:				; CODE XREF: sub_10015810+7Aj
		push	esi
		push	6
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_100158A0
; ---------------------------------------------------------------------------

loc_1001589E:				; CODE XREF: sub_10015810+2Cj
					; sub_10015810+32j ...
		xor	al, al

loc_100158A0:				; CODE XREF: sub_10015810+8Cj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015810	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100158B1	proc near		; DATA XREF: .rdata:1002C090o

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= dword	ptr -0Fh
var_B		= word ptr -0Bh
var_9		= byte ptr -9
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_10015914
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_10015914
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_10015914
		cmp	[ebp+var_F], 0C015FF64h
		jnz	short loc_10015914
		xor	eax, eax
		cmp	ax, [ebp+var_B]
		jnz	short loc_10015914
		cmp	[ebp+var_9], al
		jnz	short loc_10015914
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_10015914
		push	esi
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		pop	esi
		jmp	short loc_10015916
; ---------------------------------------------------------------------------

loc_10015914:				; CODE XREF: sub_100158B1+2Cj
					; sub_100158B1+32j ...
		xor	al, al

loc_10015916:				; CODE XREF: sub_100158B1+61j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100158B1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015927	proc near		; DATA XREF: .rdata:1002C0E0o

NumberOfBytesRead= dword ptr -1Ch
Buffer		= byte ptr -18h
var_13		= byte ptr -13h
var_12		= dword	ptr -12h
var_E		= byte ptr -0Eh
var_B		= word ptr -0Bh
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	14h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_1001599D
		cmp	[ebp+NumberOfBytesRead], 14h
		jnz	short loc_1001599D
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_1001599D
		cmp	[ebp+var_13], 0E8h
		jnz	short loc_1001599D
		cmp	[ebp+var_12], 3
		jnz	short loc_1001599D
		cmp	[ebp+var_E], 0C2h
		jnz	short loc_1001599D
		mov	eax, 0D48Bh
		cmp	ax, [ebp+var_B]
		jnz	short loc_1001599D
		mov	eax, 340Fh
		cmp	ax, [ebp+var_9]
		jnz	short loc_1001599D
		cmp	[ebp+var_7], 0C3h
		jnz	short loc_1001599D
		push	esi
		push	5
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_1001599F
; ---------------------------------------------------------------------------

loc_1001599D:				; CODE XREF: sub_10015927+2Cj
					; sub_10015927+32j ...
		xor	al, al

loc_1001599F:				; CODE XREF: sub_10015927+74j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015927	endp


; =============== S U B	R O U T	I N E =======================================


sub_100159B0	proc near		; CODE XREF: sub_1000ACA5+5p
					; sub_1000ADBD+5p ...
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		mov	ebx, [esi]
		cmp	dword ptr [ebx], 0
		jz	short loc_100159F4

loc_100159BC:				; CODE XREF: sub_100159B0+42j
		mov	eax, [esi]
		xor	edx, edx
		cmp	[eax], edx
		jz	short loc_100159E0
		lea	edi, [ebx+0Ch]

loc_100159C7:				; CODE XREF: sub_100159B0+2Ej
		push	2
		xor	eax, eax
		pop	ecx
		inc	eax
		lock cmpxchg [edi], ecx
		cmp	eax, 1
		jz	short loc_100159FA
		mov	eax, [esi]
		inc	edx
		add	edi, 14h
		cmp	edx, [eax]
		jnz	short loc_100159C7

loc_100159E0:				; CODE XREF: sub_100159B0+12j
		mov	eax, [esi]
		push	32h		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	short loc_100159BC

loc_100159F4:				; CODE XREF: sub_100159B0+Aj
		xor	eax, eax

loc_100159F6:				; CODE XREF: sub_100159B0+55j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100159FA:				; CODE XREF: sub_100159B0+24j
		mov	ecx, [esi]
		imul	eax, edx, 14h
		mov	eax, [eax+ecx+8]
		add	eax, ecx
		jmp	short loc_100159F6
sub_100159B0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015A07	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+135p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+120p	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		mov	edx, [ebp+arg_0]
		and	[esp+8+var_4], 0
		mov	[ecx], edx
		mov	eax, [edx+8]
		add	eax, edx
		mov	[ecx+4], eax
		mov	eax, ecx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015A07	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015A29	proc near		; CODE XREF: sub_1000ACA5+F2p
					; sub_1000ADBD+C2p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10015A3D
		push	0Ah
		pop	eax
		jmp	loc_10015AD0
; ---------------------------------------------------------------------------

loc_10015A3D:				; CODE XREF: sub_10015A29+Aj
		mov	ecx, [esp+8+arg_0]
		mov	eax, ecx
		sub	eax, [edi+4]
		push	ebx
		shr	eax, 0Ah
		imul	ebx, eax, 14h
		mov	eax, [ecx]
		push	0		; bAlertable
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hObjectToWaitOn
		mov	[ebx+esi+18h], eax
		push	dword ptr [ebx+esi+10h]	; hObjectToSignal
		call	ds:SignalObjectAndWait
		cmp	eax, 102h
		jnz	short loc_10015AB1

loc_10015A6F:				; CODE XREF: sub_10015A29+72j
		mov	eax, [edi]
		push	0		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jnz	short loc_10015A9F
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hHandle
		call	ds:WaitForSingleObject
		test	eax, eax
		jz	short loc_10015ABA
		cmp	eax, 102h
		jz	short loc_10015A6F
		jmp	short loc_10015AB5
; ---------------------------------------------------------------------------

loc_10015A9F:				; CODE XREF: sub_10015A29+58j
		push	5
		lea	eax, [esi+0Ch]
		pop	ecx
		add	eax, ebx
		xchg	ecx, [eax]
		mov	eax, [edi]
		and	dword ptr [eax+4], 0
		jmp	short loc_10015AB5
; ---------------------------------------------------------------------------

loc_10015AB1:				; CODE XREF: sub_10015A29+44j
		test	eax, eax
		jz	short loc_10015ABA

loc_10015AB5:				; CODE XREF: sub_10015A29+74j
					; sub_10015A29+86j
		push	0Ah
		pop	eax
		jmp	short loc_10015ACF
; ---------------------------------------------------------------------------

loc_10015ABA:				; CODE XREF: sub_10015A29+6Bj
					; sub_10015A29+8Aj
		mov	eax, [esp+0Ch+arg_4]
		mov	edi, eax
		mov	esi, [esp+0Ch+arg_0]
		push	0Dh
		add	esi, 8
		pop	ecx
		rep movsd
		mov	eax, [eax+4]

loc_10015ACF:				; CODE XREF: sub_10015A29+8Fj
		pop	ebx

loc_10015AD0:				; CODE XREF: sub_10015A29+Fj
		pop	edi
		pop	esi
		retn	8
sub_10015A29	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015AD5	proc near		; CODE XREF: sub_10017B3A+14Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	esi, ecx
		xor	edi, edi
		push	edi
		push	edi
		mov	[esi], edi
		mov	[esi+4], edi
		mov	[esi+8], edi
		call	sub_1000916C
		mov	[esi+4], eax
		mov	eax, [ebp+arg_C]
		mov	[esi+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	[esi+10h], eax
		mov	eax, [ebp+arg_4]
		mov	[esi+14h], eax
		mov	eax, [ebp+arg_8]
		mov	[esi+18h], eax
		mov	eax, [ebp+arg_10]
		mov	[esi+1Ch], eax
		cmp	hSourceHandle, edi
		jnz	short loc_10015B3A
		push	edi		; lpName
		push	1		; bInitialOwner
		push	edi		; lpMutexAttributes
		call	ds:CreateMutexW
		mov	edx, eax
		mov	edi, offset hSourceHandle
		mov	ecx, edx
		xor	eax, eax
		lock cmpxchg [edi], ecx
		test	eax, eax
		jz	short loc_10015B3A
		push	edx		; hObject
		call	ds:CloseHandle

loc_10015B3A:				; CODE XREF: sub_10015AD5+3Fj
					; sub_10015AD5+5Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	14h
sub_10015AD5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015B42	proc near		; CODE XREF: sub_10017B3A+16Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		push	esi
		mov	esi, ecx
		mov	[esp+14h+var_8], 94h
		push	edi
		mov	[esi], ebx
		and	dword ptr [ebx], 0
		xor	ebp, ebp

loc_10015B5D:				; CODE XREF: sub_10015B42+C3j
		mov	eax, [esi]
		add	eax, 8
		add	eax, ebp
		push	28h
		mov	[esp+1Ch+arg_0], eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		lea	eax, [esp+1Ch+var_4]
		pop	ecx
		push	eax
		lea	ecx, [esi+4]
		mov	[esp+1Ch+var_4], edi
		call	sub_10008D20
		mov	ecx, [esp+18h+arg_0]
		lea	eax, [ecx+0Ch]
		push	eax		; LPHANDLE
		lea	eax, [ecx+8]
		mov	ecx, esi
		push	eax		; lpTargetHandle
		lea	eax, [edi+4]
		push	eax		; int
		push	edi		; int
		call	sub_100161DB
		test	al, al
		jz	loc_10015C40
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [esp+18h+var_8]
		push	edi
		push	offset sub_1001615E
		mov	[ecx], edx
		add	edx, 400h
		mov	dword ptr [ecx+4], 1
		mov	[edi+10h], ebx
		mov	dword ptr [edi+8], 400h
		mov	[edi+14h], ecx
		mov	eax, [edi+10h]
		add	eax, [ecx]
		mov	[edi+0Ch], eax
		mov	eax, [esi+1Ch]
		mov	[edi+18h], eax
		mov	eax, [esi+10h]
		mov	[edi+1Ch], eax
		mov	eax, [esi+14h]
		mov	[edi+24h], eax
		mov	eax, [esi+18h]
		mov	[edi+20h], eax
		mov	ecx, [esi+0Ch]
		push	dword ptr [edi]
		mov	[esp+24h+var_8], edx
		push	esi
		mov	eax, [ecx]
		call	dword ptr [eax]
		add	ebp, 14h
		cmp	ebp, 8Ch
		jnz	loc_10015B5D
		mov	eax, [esi]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		add	eax, 4
		push	eax		; lpTargetHandle
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	hSourceHandle	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10015C40
		mov	ecx, [esi]
		mov	al, 1
		mov	dword ptr [ecx], 7
		jmp	short loc_10015C42
; ---------------------------------------------------------------------------

loc_10015C40:				; CODE XREF: sub_10015B42+5Cj
					; sub_10015B42+F0j
		xor	al, al

loc_10015C42:				; CODE XREF: sub_10015B42+FCj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_10015B42	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015C4B	proc near		; CODE XREF: sub_10015C92+145p
					; sub_10015C92+154p ...
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, edx
		lea	ebp, [ecx+4]
		xor	esi, esi

loc_10015C56:				; CODE XREF: sub_10015C4B+40j
		mov	eax, [ebp+0]
		dec	eax
		jz	short loc_10015C66
		sub	eax, 5
		jnz	short loc_10015C84
		push	dword ptr [edi+esi*4]
		jmp	short loc_10015C79
; ---------------------------------------------------------------------------

loc_10015C66:				; CODE XREF: sub_10015C4B+Fj
		mov	ebx, [edi+esi*4]
		test	ebx, ebx
		jz	short loc_10015C80
		push	0
		push	1
		mov	ecx, ebx
		call	sub_100022FA
		push	ebx

loc_10015C79:				; CODE XREF: sub_10015C4B+19j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10015C80:				; CODE XREF: sub_10015C4B+20j
		and	dword ptr [edi+esi*4], 0

loc_10015C84:				; CODE XREF: sub_10015C4B+14j
		inc	esi
		add	ebp, 4
		cmp	esi, 9
		jb	short loc_10015C56
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10015C4B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015C92	proc near		; CODE XREF: sub_10015E06+80p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		mov	[esp+24h+var_14], esi
		cmp	dword ptr [esi+3Ch], 9
		jbe	short loc_10015CAC
		xor	al, al
		jmp	loc_10015DCD
; ---------------------------------------------------------------------------

loc_10015CAC:				; CODE XREF: sub_10015C92+11j
		push	ebx
		push	edi
		xor	edi, edi
		cmp	[esi+3Ch], edi
		jbe	loc_10015DC9
		mov	ebx, [esp+2Ch+arg_0]
		lea	eax, [ebp+4]
		mov	[esp+2Ch+var_1C], eax

loc_10015CC4:				; CODE XREF: sub_10015C92+131j
		lea	eax, [esp+2Ch+var_10]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+30h+var_C]
		push	eax
		push	edi
		call	sub_10009935
		mov	[ebx+edi*4], eax
		test	eax, eax
		jz	loc_10015DBA
		mov	ecx, [esp+2Ch+var_1C]
		mov	eax, [esp+2Ch+var_10]
		mov	[ecx], eax
		dec	eax
		jz	loc_10015D81
		dec	eax
		jz	short loc_10015D51
		dec	eax
		dec	eax
		jz	short loc_10015D20
		dec	eax
		dec	eax
		jnz	loc_10015DBA
		push	8
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10015D1C
		mov	ecx, [esp+2Ch+var_C]
		mov	[eax], ecx
		mov	ecx, [ebx+edi*4]
		mov	[eax+4], ecx
		jmp	short loc_10015D7C
; ---------------------------------------------------------------------------

loc_10015D1C:				; CODE XREF: sub_10015C92+7Aj
		xor	eax, eax
		jmp	short loc_10015D7C
; ---------------------------------------------------------------------------

loc_10015D20:				; CODE XREF: sub_10015C92+65j
		and	[esp+2Ch+var_18], 0
		lea	eax, [esp+2Ch+var_8]
		push	eax
		lea	eax, [esp+30h+var_18]
		mov	ecx, esi
		push	eax
		push	edi
		call	sub_10009935
		test	eax, eax
		jz	loc_10015DD3
		cmp	[esp+2Ch+var_18], 4
		jnz	loc_10015DD3
		cmp	[esp+2Ch+var_8], 4
		jmp	short loc_10015D78
; ---------------------------------------------------------------------------

loc_10015D51:				; CODE XREF: sub_10015C92+61j
		and	[esp+2Ch+var_18], 0
		lea	eax, [esp+2Ch+var_4]
		push	eax
		lea	eax, [esp+30h+var_18]
		mov	ecx, esi
		push	eax
		push	edi
		call	sub_10009935
		test	eax, eax
		jz	short loc_10015DD3
		cmp	[esp+2Ch+var_18], 4
		jnz	short loc_10015DD3
		cmp	[esp+2Ch+var_4], 2

loc_10015D78:				; CODE XREF: sub_10015C92+BDj
		jnz	short loc_10015DD3
		mov	eax, [eax]

loc_10015D7C:				; CODE XREF: sub_10015C92+88j
					; sub_10015C92+8Cj
		mov	[ebx+edi*4], eax
		jmp	short loc_10015DBA
; ---------------------------------------------------------------------------

loc_10015D81:				; CODE XREF: sub_10015C92+5Aj
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10015DA2
		and	dword ptr [esi+10h], 0
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		jmp	short loc_10015DA4
; ---------------------------------------------------------------------------

loc_10015DA2:				; CODE XREF: sub_10015C92+FCj
		xor	esi, esi

loc_10015DA4:				; CODE XREF: sub_10015C92+10Ej
		mov	ecx, [esp+2Ch+var_14]
		push	esi		; Dst
		push	edi		; int
		call	sub_1000996B
		test	al, al
		jz	short loc_10015DDE
		mov	[ebx+edi*4], esi
		mov	esi, [esp+2Ch+var_14]

loc_10015DBA:				; CODE XREF: sub_10015C92+49j
					; sub_10015C92+69j ...
		add	[esp+2Ch+var_1C], 4
		inc	edi
		cmp	edi, [esi+3Ch]
		jb	loc_10015CC4

loc_10015DC9:				; CODE XREF: sub_10015C92+21j
		mov	al, 1

loc_10015DCB:				; CODE XREF: sub_10015C92+172j
		pop	edi
		pop	ebx

loc_10015DCD:				; CODE XREF: sub_10015C92+15j
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10015DD3:				; CODE XREF: sub_10015C92+A7j
					; sub_10015C92+B2j ...
		mov	edx, ebx
		mov	ecx, ebp
		call	sub_10015C4B
		jmp	short loc_10015E02
; ---------------------------------------------------------------------------

loc_10015DDE:				; CODE XREF: sub_10015C92+11Fj
		and	dword ptr [ebx+edi*4], 0
		mov	edx, ebx
		mov	ecx, ebp
		call	sub_10015C4B
		test	esi, esi
		jz	short loc_10015E02
		push	0
		push	1
		mov	ecx, esi
		call	sub_100022FA
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10015E02:				; CODE XREF: sub_10015C92+14Aj
					; sub_10015C92+15Bj
		xor	al, al
		jmp	short loc_10015DCB
sub_10015C92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015E06	proc near		; CODE XREF: sub_1001615E+4Ep

var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
Size		= dword	ptr -0A0h
Src		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
Dst		= dword	ptr -88h
var_84		= byte ptr -84h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0A8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0A8h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+0B0h+arg_0]
		mov	eax, ecx
		push	esi
		xor	ebx, ebx
		mov	[esp+0B4h+var_98], eax
		mov	[esp+0B4h+Src],	ebx
		lea	ecx, [esp+0B4h+Size]
		mov	esi, edx
		mov	dword ptr [ebp+4], 5
		push	edi
		mov	[ebp+0Ch], ebx
		mov	edx, [eax+8]
		push	ecx
		mov	ecx, esi
		mov	[esp+0BCh+var_94], esi
		mov	[esp+0BCh+Size], ebx
		call	sub_100097E2
		mov	esi, eax
		mov	[esp+0BCh+Src],	esi
		pop	ecx
		test	esi, esi
		jz	loc_1001611B
		mov	edx, [esi]
		lea	edi, [esp+0B8h+var_4C]
		push	9
		xor	eax, eax
		mov	[esp+0BCh+var_90], edx
		pop	ecx
		rep stosd
		lea	eax, [esp+0B8h+var_28]
		mov	[esp+0B8h+var_50], edx
		push	eax
		lea	edx, [esp+0BCh+var_50]
		mov	ecx, esi
		call	sub_10015C92
		pop	ecx
		test	al, al
		jz	loc_1001610F
		push	38h		; Size
		lea	eax, [esp+0BCh+Dst]
		push	ebx		; Val
		push	eax		; Dst
		call	memset
		mov	ecx, [esp+0C4h+var_98]
		lea	edx, [esp+0C4h+var_A4]
		mov	eax, [esp+0C4h+var_90]
		add	esp, 0Ch
		mov	[esp+0B8h+var_8C], eax
		mov	[esp+0B8h+var_A5], 1
		lea	eax, [ecx+1Ch]
		mov	ecx, [ecx+18h]
		mov	[esp+0B8h+Dst],	eax
		push	edx
		lea	edx, [esp+0BCh+var_50]
		mov	eax, [ecx]
		push	edx
		call	dword ptr [eax]
		test	eax, eax
		jz	loc_100160F8
		mov	ecx, [esi+3Ch]
		cmp	ecx, 9		; switch 10 cases
		ja	loc_100160EE	; jumptable 10015EE1 default case
		jmp	ds:off_10016136[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10015EE8:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		lea	ecx, [esp+0B8h+var_8C] ; jumptable 10015EE1 case 0
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0BCh+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015EF8:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_28] ; jumptable 10015EE1 case 1
		lea	ecx, [esp+0BCh+var_8C]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C0h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015F0F:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_24] ; jumptable 10015EE1 case 2
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C4h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015F2D:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_20] ; jumptable 10015EE1 case 3
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_24]
		push	[esp+0C0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C8h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015F52:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_1C] ; jumptable 10015EE1 case 4
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_20]
		push	[esp+0C0h+var_24]
		push	[esp+0C4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0CCh+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015F7E:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_18] ; jumptable 10015EE1 case 5
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_1C]
		push	[esp+0C0h+var_20]
		push	[esp+0C4h+var_24]
		push	[esp+0C8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D0h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015FB1:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_14] ; jumptable 10015EE1 case 6
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_18]
		push	[esp+0C0h+var_1C]
		push	[esp+0C4h+var_20]
		push	[esp+0C8h+var_24]
		push	[esp+0CCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D4h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_10015FEB:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_10] ; jumptable 10015EE1 case 7
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_14]
		push	[esp+0C0h+var_18]
		push	[esp+0C4h+var_1C]
		push	[esp+0C8h+var_20]
		push	[esp+0CCh+var_24]
		push	[esp+0D0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D8h+var_A4]
		jmp	loc_100160BB
; ---------------------------------------------------------------------------

loc_1001602C:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_C] ; jumptable 10015EE1 case 8
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_10]
		push	[esp+0C0h+var_14]
		push	[esp+0C4h+var_18]
		push	[esp+0C8h+var_1C]
		push	[esp+0CCh+var_20]
		push	[esp+0D0h+var_24]
		push	[esp+0D4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0DCh+var_A4]
		jmp	short loc_100160BB
; ---------------------------------------------------------------------------

loc_10016071:				; CODE XREF: sub_10015E06+DBj
					; DATA XREF: .text:off_10016136o
		push	[esp+0B8h+var_8] ; jumptable 10015EE1 case 9
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_C]
		push	[esp+0C0h+var_10]
		push	[esp+0C4h+var_14]
		push	[esp+0C8h+var_18]
		push	[esp+0CCh+var_1C]
		push	[esp+0D0h+var_20]
		push	[esp+0D4h+var_24]
		push	[esp+0D8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0E0h+var_A4]

loc_100160BB:				; CODE XREF: sub_10015E06+EDj
					; sub_10015E06+104j ...
		test	al, al
		jz	short loc_100160EE ; jumptable 10015EE1	default	case
		push	0Dh
		pop	ecx
		lea	esi, [esp+0B8h+var_84]
		mov	[esp+0B8h+var_A5], bl
		mov	edi, ebp
		rep movsd
		mov	esi, [esp+0B8h+Src]
		mov	[ebp+4], ebx
		cmp	dword ptr [esi+4], 1
		jnz	short loc_100160F8
		push	[esp+0B8h+Size]	; Size
		push	esi		; Src
		push	[esp+0C0h+var_94] ; Dst
		call	memcpy
		add	esp, 0Ch
		jmp	short loc_100160F8
; ---------------------------------------------------------------------------

loc_100160EE:				; CODE XREF: sub_10015E06+D5j
					; sub_10015E06+2B7j
		mov	dword ptr [ebp+4], 6 ; jumptable 10015EE1 default case
		mov	[ebp+0Ch], ebx

loc_100160F8:				; CODE XREF: sub_10015E06+C9j
					; sub_10015E06+2D3j ...
		lea	edx, [esp+0B8h+var_28]
		lea	ecx, [esp+0B8h+var_50]
		call	sub_10015C4B
		cmp	[esp+0B8h+var_A5], bl
		setz	bl

loc_1001610F:				; CODE XREF: sub_10015E06+88j
		test	esi, esi
		jz	short loc_1001611B
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1001611B:				; CODE XREF: sub_10015E06+57j
					; sub_10015E06+30Bj
		mov	ecx, [esp+0B8h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A8h
		retn
sub_10015E06	endp

; ---------------------------------------------------------------------------
off_10016136	dd offset loc_10015EE8	; DATA XREF: sub_10015E06+DBr
		dd offset loc_10015EF8	; jump table for switch	statement
		dd offset loc_10015F0F
		dd offset loc_10015F2D
		dd offset loc_10015F52
		dd offset loc_10015F7E
		dd offset loc_10015FB1
		dd offset loc_10015FEB
		dd offset loc_1001602C
		dd offset loc_10016071

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001615E	proc near		; DATA XREF: sub_10015B42+6Bo

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
Dst		= byte ptr -30h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		xor	esi, esi
		mov	[esp+44h+var_38], esi
		push	edi
		test	ebx, ebx
		jz	short loc_100161D2
		mov	ecx, [ebx+14h]
		push	3
		pop	edx
		push	2
		add	ecx, 4
		pop	eax
		lock cmpxchg [ecx], edx
		cmp	eax, 2
		jnz	short loc_100161D2
		push	30h		; Size
		lea	eax, [esp+4Ch+Dst]
		mov	[esp+4Ch+var_34], esi
		push	esi		; Val
		push	eax		; Dst
		call	memset
		mov	edi, [ebx+0Ch]
		lea	eax, [esp+54h+var_34]
		add	esp, 0Ch
		mov	edx, edi
		mov	ecx, ebx
		push	eax
		call	sub_10015E06
		pop	ecx
		push	0Dh
		pop	ecx
		add	edi, 8
		lea	esi, [esp+48h+var_34]
		rep movsd
		mov	eax, [ebx+14h]
		push	3
		add	eax, 4
		pop	ecx
		xchg	ecx, [eax]
		push	dword ptr [ebx+4] ; hEvent
		call	ds:SetEvent

loc_100161D2:				; CODE XREF: sub_1001615E+17j
					; sub_1001615E+2Cj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1001615E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100161DB(int, int, LPHANDLE	lpTargetHandle,	LPHANDLE)
sub_100161DB	proc near		; CODE XREF: sub_10015B42+55p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		push	ebx		; lpName
		push	ebx		; bInitialState
		push	ebx		; bManualReset
		push	ebx		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_0]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		mov	ebx, ds:GetCurrentProcess
		push	100002h		; dwDesiredAccess
		push	[esp+14h+lpTargetHandle] ; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10016217
		xor	al, al
		jmp	short loc_10016248
; ---------------------------------------------------------------------------

loc_10016217:				; CODE XREF: sub_100161DB+36j
		xor	eax, eax
		push	eax		; lpName
		push	eax		; bInitialState
		push	eax		; bManualReset
		push	eax		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_4]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	[esp+14h+arg_C]	; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		setnz	al

loc_10016248:				; CODE XREF: sub_100161DB+3Aj
		pop	esi
		pop	ebx
		retn	10h
sub_100161DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1001624D(PSID pSid, WELL_KNOWN_SID_TYPE WellKnownSidType)
sub_1001624D	proc near		; CODE XREF: sub_10012ACB+1E6p
					; sub_10013563+13Bp ...

cbSid		= dword	ptr -4
WellKnownSidType= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+cbSid], 0
		lea	eax, [ebp+cbSid]
		push	esi
		push	eax		; cbSid
		mov	esi, ecx
		mov	[ebp+cbSid], 44h
		push	esi		; pSid
		push	0		; DomainSid
		push	[ebp+WellKnownSidType] ; WellKnownSidType
		call	ds:CreateWellKnownSid
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1001624D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016278	proc near		; CODE XREF: sub_10016615+35p
					; sub_10016615+43p
		mov	al, [ecx+0Bh]
		mov	[ecx+0Ah], al
		mov	al, [ecx+0Dh]
		mov	[ecx+0Ch], al
		xor	eax, eax
		mov	[ecx+4], eax
		mov	[ecx+8], ax
		mov	dword ptr [ecx], 1
		mov	[ecx+0Eh], ax
		mov	[ecx+10h], al
		retn
sub_10016278	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001629B	proc near		; CODE XREF: sub_1001629B+68p
					; sub_10016615+53p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	edx, ecx
		push	8
		pop	esi
		movzx	eax, byte ptr [edi]
		imul	ecx, eax, 64h
		add	ecx, ds:off_1001B410
		mov	eax, [ecx+4]
		sub	eax, 3
		jz	short loc_100162D5
		dec	eax
		jz	short loc_100162CB
		dec	eax
		jnz	short loc_10016308
		cmp	[edx+0Bh], al
		setz	al
		mov	[edx+0Ah], al
		jmp	short loc_100162D5
; ---------------------------------------------------------------------------

loc_100162CB:				; CODE XREF: sub_1001629B+20j
		cmp	byte ptr [edx+0Dh], 0
		setz	al
		mov	[edx+0Ch], al

loc_100162D5:				; CODE XREF: sub_1001629B+1Dj
					; sub_1001629B+2Ej
		mov	al, [edi]
		cmp	al, 0F2h
		jnz	short loc_100162E1
		mov	byte ptr [edx+0Eh], 1
		jmp	short loc_100162F3
; ---------------------------------------------------------------------------

loc_100162E1:				; CODE XREF: sub_1001629B+3Ej
		cmp	al, 0F3h
		jnz	short loc_100162EB
		mov	byte ptr [edx+0Fh], 1
		jmp	short loc_100162F3
; ---------------------------------------------------------------------------

loc_100162EB:				; CODE XREF: sub_1001629B+48j
		cmp	al, 66h
		jnz	short loc_100162F3
		mov	byte ptr [edx+10h], 1

loc_100162F3:				; CODE XREF: sub_1001629B+44j
					; sub_1001629B+4Ej ...
		mov	esi, [ecx+4]
		mov	ecx, [esp+8+arg_4]
		push	ecx
		inc	dword ptr [ecx]
		lea	ecx, [edi+1]
		push	ecx
		mov	ecx, edx
		call	sub_1001629B

loc_10016308:				; CODE XREF: sub_1001629B+23j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_1001629B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001630F	proc near		; CODE XREF: sub_1001630F+6Dp
					; sub_10016615+7Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	cl, ds:byte_1001B414[ebx*8]
		mov	al, [ebp+0]
		shr	al, cl
		and	al, ds:byte_1001B415[ebx*8]
		cmp	al, ds:byte_1001B416[ebx*8]
		jb	loc_10016414
		cmp	al, ds:byte_1001B417[ebx*8]
		ja	loc_10016414
		movzx	eax, al
		imul	esi, eax, 64h
		add	esi, ds:off_1001B410[ebx*8]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10016367
		and	dword ptr [edi], 0
		xor	eax, eax
		jmp	loc_10016419
; ---------------------------------------------------------------------------

loc_10016367:				; CODE XREF: sub_1001630F+4Cj
		cmp	dword ptr [esi+4], 2
		jnz	short loc_10016388
		mov	eax, [esp+10h+arg_8]
		mov	ecx, edi
		push	eax
		push	dword ptr [esi]
		inc	dword ptr [eax]
		lea	eax, [ebp+1]
		push	eax
		call	sub_1001630F
		mov	eax, [edi]
		jmp	loc_10016419
; ---------------------------------------------------------------------------

loc_10016388:				; CODE XREF: sub_1001630F+5Cj
		cmp	byte ptr [esi+18h], 0
		jz	short loc_100163BB
		xor	eax, eax
		cmp	[edi+0Eh], al
		jz	short loc_1001639F
		cmp	[esi+30h], eax
		jz	short loc_1001639F
		add	esi, 1Ch
		jmp	short loc_100163BB
; ---------------------------------------------------------------------------

loc_1001639F:				; CODE XREF: sub_1001630F+84j
					; sub_1001630F+89j
		cmp	[edi+0Fh], al
		jz	short loc_100163AE
		cmp	[esi+48h], eax
		jz	short loc_100163AE
		add	esi, 34h
		jmp	short loc_100163BB
; ---------------------------------------------------------------------------

loc_100163AE:				; CODE XREF: sub_1001630F+93j
					; sub_1001630F+98j
		cmp	[edi+10h], al
		jz	short loc_100163BB
		cmp	[esi+60h], eax
		jz	short loc_100163BB
		add	esi, 4Ch

loc_100163BB:				; CODE XREF: sub_1001630F+7Dj
					; sub_1001630F+8Ej ...
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	[edi], eax
		push	dword ptr [esi+8]
		call	sub_10016420
		push	dword ptr [esi+0Ch]
		call	sub_10016420
		push	dword ptr [esi+10h]
		call	sub_10016420
		cmp	ds:byte_1001B415[ebx*8], 0FFh
		jz	short loc_10016401
		cmp	byte ptr [edi+8], 0
		jz	short loc_100163F9
		push	[esp+10h+arg_8]
		push	ebp

loc_100163EF:				; CODE XREF: sub_1001630F+103j
		call	sub_1001658A

loc_100163F4:				; CODE XREF: sub_1001630F+F0j
					; sub_1001630F+FCj
		push	8
		pop	eax
		jmp	short loc_10016419
; ---------------------------------------------------------------------------

loc_100163F9:				; CODE XREF: sub_1001630F+D9j
		mov	eax, [esp+10h+arg_8]
		inc	dword ptr [eax]
		jmp	short loc_100163F4
; ---------------------------------------------------------------------------

loc_10016401:				; CODE XREF: sub_1001630F+D3j
		mov	eax, [esp+10h+arg_8]
		inc	dword ptr [eax]
		cmp	byte ptr [edi+8], 0
		jz	short loc_100163F4
		push	eax
		lea	eax, [ebp+1]
		push	eax
		jmp	short loc_100163EF
; ---------------------------------------------------------------------------

loc_10016414:				; CODE XREF: sub_1001630F+28j
					; sub_1001630F+35j
		xor	eax, eax
		inc	eax
		mov	[edi], eax

loc_10016419:				; CODE XREF: sub_1001630F+53j
					; sub_1001630F+74j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_1001630F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016420	proc near		; CODE XREF: sub_1001630F+B6p
					; sub_1001630F+BEp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	ebx
		xor	ebx, ebx
		inc	ebx
		test	edx, edx
		jz	loc_10016584
		mov	eax, edx
		push	esi
		and	eax, 0FF0000h
		mov	esi, 0A0000h
		cmp	eax, esi
		jg	loc_1001654C
		jz	short loc_10016491
		cmp	eax, 20000h
		jz	loc_10016580
		cmp	eax, 30000h
		jz	loc_10016580
		cmp	eax, 40000h
		jz	loc_1001657D
		cmp	eax, 60000h
		jz	loc_10016580
		cmp	eax, 70000h
		jz	short loc_10016491
		cmp	eax, 80000h
		jz	short loc_10016491
		cmp	eax, 90000h
		jz	loc_1001657D
		jmp	loc_10016583
; ---------------------------------------------------------------------------

loc_10016491:				; CODE XREF: sub_10016420+25j
					; sub_10016420+58j ...
		and	edx, 0FF000000h
		mov	eax, 9000000h
		cmp	edx, eax
		jg	short loc_10016506
		jz	loc_10016536
		cmp	edx, 2000000h
		jz	short loc_10016501
		cmp	edx, 3000000h
		jz	short loc_100164FB
		cmp	edx, 4000000h
		jz	short loc_100164F2
		cmp	edx, 5000000h
		jz	short loc_100164DA
		cmp	edx, 6000000h
		jz	short loc_100164E3
		cmp	edx, 8000000h
		jnz	loc_10016583

loc_100164DA:				; CODE XREF: sub_10016420+A4j
		add	dword ptr [ecx+4], 10h
		jmp	loc_10016583
; ---------------------------------------------------------------------------

loc_100164E3:				; CODE XREF: sub_10016420+ACj
		cmp	byte ptr [ecx+0Ah], 0
		jz	short loc_100164F2

loc_100164E9:				; CODE XREF: sub_10016420+ECj
		add	dword ptr [ecx+4], 6
		jmp	loc_10016583
; ---------------------------------------------------------------------------

loc_100164F2:				; CODE XREF: sub_10016420+9Cj
					; sub_10016420+C7j ...
		add	dword ptr [ecx+4], 4
		jmp	loc_10016583
; ---------------------------------------------------------------------------

loc_100164FB:				; CODE XREF: sub_10016420+94j
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_10016542

loc_10016501:				; CODE XREF: sub_10016420+8Cj
		inc	dword ptr [ecx+4]
		jmp	short loc_10016583
; ---------------------------------------------------------------------------

loc_10016506:				; CODE XREF: sub_10016420+7Ej
		cmp	edx, 0A000000h
		jz	short loc_100164E9
		cmp	edx, 0B000000h
		jz	short loc_10016548
		cmp	edx, 0D000000h
		jz	short loc_1001653C
		cmp	edx, 0E000000h
		jz	short loc_10016542
		cmp	edx, 0F000000h
		jz	short loc_10016536
		cmp	edx, 10000000h
		jnz	short loc_10016583

loc_10016536:				; CODE XREF: sub_10016420+80j
					; sub_10016420+10Cj
		add	dword ptr [ecx+4], 8
		jmp	short loc_10016583
; ---------------------------------------------------------------------------

loc_1001653C:				; CODE XREF: sub_10016420+FCj
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_100164F2

loc_10016542:				; CODE XREF: sub_10016420+DFj
					; sub_10016420+104j
		add	dword ptr [ecx+4], 2
		jmp	short loc_10016583
; ---------------------------------------------------------------------------

loc_10016548:				; CODE XREF: sub_10016420+F4j
		xor	bl, bl
		jmp	short loc_10016583
; ---------------------------------------------------------------------------

loc_1001654C:				; CODE XREF: sub_10016420+1Fj
		cmp	eax, 0B0000h
		jz	short loc_10016580
		cmp	eax, 0C0000h
		jz	short loc_1001657D
		cmp	eax, 0D0000h
		jz	short loc_10016580
		cmp	eax, 0E0000h
		jz	short loc_10016580
		cmp	eax, 0F0000h
		jz	short loc_10016580
		cmp	eax, 100000h
		jz	short loc_10016580
		cmp	eax, 110000h
		jnz	short loc_10016583

loc_1001657D:				; CODE XREF: sub_10016420+42j
					; sub_10016420+66j ...
		mov	[ecx+9], bl

loc_10016580:				; CODE XREF: sub_10016420+2Cj
					; sub_10016420+37j ...
		mov	[ecx+8], bl

loc_10016583:				; CODE XREF: sub_10016420+6Cj
					; sub_10016420+B4j ...
		pop	esi

loc_10016584:				; CODE XREF: sub_10016420+Aj
		mov	al, bl
		pop	ebx
		retn	4
sub_10016420	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001658A	proc near		; CODE XREF: sub_1001630F:loc_100163EFp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	byte ptr [ecx+9], 0
		jnz	short loc_10016598
		mov	eax, [esp+arg_4]
		inc	dword ptr [eax]
		jmp	short loc_10016610
; ---------------------------------------------------------------------------

loc_10016598:				; CODE XREF: sub_1001658A+4j
		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	al, [edi]
		mov	dl, al
		and	al, 7
		shr	dl, 3
		and	dl, 18h
		or	al, dl
		shr	dl, 3
		cmp	byte ptr [ecx+0Ch], 0
		movzx	eax, al
		lea	esi, dword_1001ACD0[eax*8]
		jnz	short loc_100165C6
		lea	esi, dword_1001ABD0[eax*8]

loc_100165C6:				; CODE XREF: sub_1001658A+33j
		cmp	byte ptr [esi],	0
		jz	short loc_100165D1
		mov	eax, [esi+4]
		add	[ecx+4], eax

loc_100165D1:				; CODE XREF: sub_1001658A+3Fj
		cmp	byte ptr [esi+1], 0
		jz	short loc_10016608
		mov	esi, [esp+8+arg_4]
		mov	al, [edi+1]
		and	al, 7
		push	ebx
		inc	dword ptr [esi]
		mov	ebx, [esi]
		cmp	al, 5
		jnz	short loc_100165FB
		movzx	eax, dl
		sub	eax, 0
		jz	short loc_100165F7
		dec	eax
		jz	short loc_10016603
		dec	eax
		jnz	short loc_100165FB

loc_100165F7:				; CODE XREF: sub_1001658A+65j
		add	dword ptr [ecx+4], 4

loc_100165FB:				; CODE XREF: sub_1001658A+5Dj
					; sub_1001658A+6Bj ...
		lea	eax, [ebx+1]
		mov	[esi], eax
		pop	ebx
		jmp	short loc_1001660E
; ---------------------------------------------------------------------------

loc_10016603:				; CODE XREF: sub_1001658A+68j
		inc	dword ptr [ecx+4]
		jmp	short loc_100165FB
; ---------------------------------------------------------------------------

loc_10016608:				; CODE XREF: sub_1001658A+4Bj
		mov	eax, [esp+8+arg_4]
		inc	dword ptr [eax]

loc_1001660E:				; CODE XREF: sub_1001658A+77j
		pop	edi
		pop	esi

loc_10016610:				; CODE XREF: sub_1001658A+Cj
		mov	al, 1
		retn	8
sub_1001658A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016615	proc near		; CODE XREF: sub_1001674A+7Fp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_7		= byte ptr -7
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebp, edx
		test	edi, edi
		jz	loc_1001673F
		test	ebp, ebp
		jz	loc_1001673F
		mov	ebx, [esp+2Ch+arg_0]
		test	ebx, ebx
		jz	loc_1001673F
		lea	ecx, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_9], 1
		mov	[esp+2Ch+var_7], 1
		call	sub_10016278
		xor	esi, esi

loc_10016651:				; CODE XREF: sub_10016615+BBj
		lea	ecx, [esp+2Ch+var_14]
		lea	edx, [esi+edi]
		call	sub_10016278
		and	[esp+2Ch+var_1C], 0
		lea	eax, [esp+2Ch+var_1C]
		push	eax
		push	edx
		call	sub_1001629B
		cmp	eax, 1
		jz	loc_1001673B
		mov	eax, [esp+2Ch+var_1C]
		lea	ecx, [esi+edi]
		and	[esp+2Ch+var_1C], 0
		add	eax, ecx
		lea	ecx, [esp+2Ch+var_1C]
		mov	[esp+2Ch+var_18], eax
		push	ecx
		push	0
		push	eax
		lea	ecx, [esp+38h+var_14]
		call	sub_1001630F
		mov	ecx, [esp+2Ch+var_14]
		cmp	ecx, 1
		jz	short loc_100166BB
		test	ecx, ecx
		jz	short loc_100166BB
		mov	eax, [esp+2Ch+var_10]
		lea	edx, [esi+edi]
		sub	eax, edx
		add	eax, [esp+2Ch+var_1C]
		add	eax, [esp+2Ch+var_18]
		add	esi, eax
		jmp	short loc_100166BE
; ---------------------------------------------------------------------------

loc_100166BB:				; CODE XREF: sub_10016615+8Bj
					; sub_10016615+8Fj
		xor	ecx, ecx
		inc	ecx

loc_100166BE:				; CODE XREF: sub_10016615+A4j
		cmp	ecx, 6
		jz	short loc_10016736
		cmp	ecx, 7
		jz	short loc_10016732
		cmp	ecx, 8
		jnz	short loc_1001673B
		cmp	esi, 5
		jb	loc_10016651
		lea	eax, [esi+5]
		cmp	eax, 20h
		jbe	short loc_100166E2
		push	2
		jmp	short loc_10016738
; ---------------------------------------------------------------------------

loc_100166E2:				; CODE XREF: sub_10016615+C7j
		test	esi, esi
		jz	short loc_100166FB
		mov	edx, edi
		mov	ecx, ebx
		sub	edx, ebx
		mov	ebx, esi

loc_100166EE:				; CODE XREF: sub_10016615+E0j
		mov	al, [ecx+edx]
		mov	[ecx], al
		inc	ecx
		dec	ebx
		jnz	short loc_100166EE
		mov	ebx, [esp+2Ch+arg_0]

loc_100166FB:				; CODE XREF: sub_10016615+CFj
		mov	eax, edi
		mov	byte ptr [esi+ebx], 0E9h
		sub	eax, ebx
		sub	ebp, edi
		sub	eax, 5
		sub	ebp, 5
		mov	[esi+ebx+1], eax
		mov	byte ptr [edi],	0E9h
		mov	[edi+1], ebp
		cmp	esi, 5
		jbe	short loc_1001672E
		add	edi, 5
		add	esi, 0FFFFFFFBh
		jz	short loc_1001672E
		push	esi		; Size
		push	0FFFFFFCCh	; Val
		push	edi		; Dst
		call	memset
		add	esp, 0Ch

loc_1001672E:				; CODE XREF: sub_10016615+103j
					; sub_10016615+10Bj
		xor	eax, eax
		jmp	short loc_10016742
; ---------------------------------------------------------------------------

loc_10016732:				; CODE XREF: sub_10016615+B1j
		push	4
		jmp	short loc_10016738
; ---------------------------------------------------------------------------

loc_10016736:				; CODE XREF: sub_10016615+ACj
		push	3

loc_10016738:				; CODE XREF: sub_10016615+CBj
					; sub_10016615+11Fj ...
		pop	eax
		jmp	short loc_10016742
; ---------------------------------------------------------------------------

loc_1001673B:				; CODE XREF: sub_10016615+5Bj
					; sub_10016615+B6j
		push	5
		jmp	short loc_10016738
; ---------------------------------------------------------------------------

loc_1001673F:				; CODE XREF: sub_10016615+Dj
					; sub_10016615+15j ...
		xor	eax, eax
		inc	eax

loc_10016742:				; CODE XREF: sub_10016615+11Bj
					; sub_10016615+124j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_10016615	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001674A	proc near		; CODE XREF: sub_10016812+65p
					; DATA XREF: .rdata:1002C274o

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_14]
		push	esi
		mov	esi, [esp+18h+arg_18]
		push	edi
		push	esi
		push	ebx
		push	[esp+24h+arg_10]
		mov	edi, ecx
		push	[esp+28h+arg_C]
		push	[esp+2Ch+arg_8]
		mov	eax, [edi]
		push	[esp+30h+arg_4]
		push	[esp+34h+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	loc_10016805
		push	ebp
		push	dword ptr [edi+8]
		lea	eax, [esi-20h]
		push	ebx
		push	eax
		lea	ebp, [ebx+20h]
		push	ebp
		call	sub_10012A69
		test	al, al
		jnz	short loc_1001679A
		mov	eax, 0C0000023h
		jmp	short loc_10016804
; ---------------------------------------------------------------------------

loc_1001679A:				; CODE XREF: sub_1001674A+47j
		push	ecx
		xor	eax, eax
		lea	ecx, [esp+24h+var_10]
		push	20h
		push	dword ptr [edi+4]
		mov	[esp+2Ch+var_10], al
		mov	[esp+2Ch+var_C], eax
		mov	[esp+2Ch+var_8], eax
		mov	[esp+2Ch+var_4], eax
		call	sub_1001424E
		mov	esi, eax
		test	esi, esi
		js	short loc_100167F9
		push	ecx
		push	ecx
		mov	ecx, [edi+4]
		mov	edx, ebp
		push	ebx
		call	sub_10016615
		add	esp, 0Ch
		cmp	eax, 2
		jnz	short loc_100167DD
		mov	esi, 0C0000023h
		jmp	short loc_100167F9
; ---------------------------------------------------------------------------

loc_100167DD:				; CODE XREF: sub_1001674A+8Aj
		test	eax, eax
		jz	short loc_100167E8
		mov	esi, 0C0000001h
		jmp	short loc_100167F9
; ---------------------------------------------------------------------------

loc_100167E8:				; CODE XREF: sub_1001674A+95j
		mov	ebx, [esp+20h+arg_1C]
		test	ebx, ebx
		jz	short loc_100167F9
		mov	edx, [edi]
		mov	ecx, edi
		call	dword ptr [edx+10h]
		mov	[ebx], eax

loc_100167F9:				; CODE XREF: sub_1001674A+75j
					; sub_1001674A+91j ...
		lea	ecx, [esp+20h+var_10]
		call	sub_10009A18
		mov	eax, esi

loc_10016804:				; CODE XREF: sub_1001674A+4Ej
		pop	ebp

loc_10016805:				; CODE XREF: sub_1001674A+2Dj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn	20h
sub_1001674A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001680E	proc near		; DATA XREF: .rdata:1002C280o
		push	3Eh
		pop	eax
		retn
sub_1001680E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016812	proc near		; DATA XREF: .rdata:1002C244o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		mov	ebp, [esp+8+arg_18]
		cmp	ebp, eax
		jnb	short loc_1001682A
		mov	eax, 0C0000023h
		jmp	short loc_100168A4
; ---------------------------------------------------------------------------

loc_1001682A:				; CODE XREF: sub_10016812+Fj
		mov	eax, [esp+8+arg_10]
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	edi
		mov	edi, [esp+10h+arg_14]
		mov	[edi], ebx
		test	eax, eax
		jz	short loc_10016843
		mov	[edi+4], eax
		jmp	short loc_1001685A
; ---------------------------------------------------------------------------

loc_10016843:				; CODE XREF: sub_10016812+2Aj
		mov	edx, [esi]
		lea	eax, [edi+4]
		push	eax
		push	[esp+14h+arg_C]
		mov	ecx, esi
		push	[esp+18h+arg_4]
		call	dword ptr [edx+8]
		test	eax, eax
		js	short loc_100168A2

loc_1001685A:				; CODE XREF: sub_10016812+2Fj
		push	0
		lea	eax, [ebp-8]
		mov	ecx, esi
		push	eax
		lea	eax, [edi+8]
		mov	ebp, offset loc_100168AD
		push	eax
		push	ebp
		push	0
		push	[esp+24h+arg_8]
		push	[esp+28h+arg_4]
		push	ebx
		call	sub_1001674A
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_100168A0
		push	ebp
		push	edi
		push	1Eh
		lea	eax, [edi+28h]
		push	eax
		call	sub_10012A69
		mov	edi, [esp+10h+arg_1C]
		test	edi, edi
		jz	short loc_100168A0
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_100168A0:				; CODE XREF: sub_10016812+6Ej
					; sub_10016812+83j
		mov	eax, ebx

loc_100168A2:				; CODE XREF: sub_10016812+46j
		pop	edi
		pop	ebx

loc_100168A4:				; CODE XREF: sub_10016812+16j
		pop	esi
		pop	ebp
		retn	20h
sub_10016812	endp


; =============== S U B	R O U T	I N E =======================================


sub_100168A9	proc near		; DATA XREF: .rdata:1002C250o
		push	46h
		pop	eax
		retn
sub_100168A9	endp

; ---------------------------------------------------------------------------

loc_100168AD:				; DATA XREF: sub_10016812+53o
		push	eax
		push	eax
		push	ebx
		push	ecx
		push	edx
		mov	ebx, [esp+18h]
		mov	edx, [esp+14h]
		mov	eax, [ebx]
		push	edx
		push	eax
		call	sub_100168F0
		add	esp, 8
		test	eax, eax
		lea	edx, [ebx+8]
		jz	short loc_100168E0
		mov	ecx, [esp+14h]
		mov	[esp+18h], ecx
		mov	[esp+10h], edx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn	4
; ---------------------------------------------------------------------------

loc_100168E0:				; CODE XREF: .text:100168CBj
		mov	ecx, [ebx+4]
		mov	[esp+18h], edx
		mov	[esp+10h], ecx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100168F0	proc near		; CODE XREF: .text:100168BEp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8]
		push	[ebp+arg_4]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100056A9
		test	eax, eax
		setnz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_100168F0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016916	proc near		; DATA XREF: .rdata:1002D8A0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002D898
		call	sub_10009B59
		test	[esp+4+arg_0], 1
		jz	short loc_10016933
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10016933:				; CODE XREF: sub_10016916+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10016916	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016939	proc near		; DATA XREF: .rdata:1002D89Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 0Eh
		jnz	short loc_1001696B
		mov	eax, offset _TargetNtCreateEvent@24 ; TargetNtCreateEvent(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10016967
		mov	ecx, [esp+arg_0]
		push	14h		; int
		push	offset a_targetntcre_4 ; "_TargetNtCreateEvent@24"
		push	1		; int
		push	offset aNtcreateevent ;	"NtCreateEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000D8BF
		jmp	short locret_100169A7
; ---------------------------------------------------------------------------

loc_10016967:				; CODE XREF: sub_10016939+Ej
		xor	al, al
		jmp	short locret_100169A7
; ---------------------------------------------------------------------------

loc_1001696B:				; CODE XREF: sub_10016939+5j
		cmp	[esp+arg_4], 0Fh
		push	ebx
		jnz	short loc_100169A2
		xor	ebx, ebx
		mov	eax, offset _TargetNtOpenEvent@16 ; TargetNtOpenEvent(x,x,x,x)
		inc	ebx
		test	eax, eax
		jz	short loc_1001699C
		mov	ecx, [esp+4+arg_0]
		push	15h		; int
		push	offset a_targetntop_14 ; "_TargetNtOpenEvent@16"
		push	ebx		; int
		push	offset aNtopenevent ; "NtOpenEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000D8BF
		jmp	short loc_1001699E
; ---------------------------------------------------------------------------

loc_1001699C:				; CODE XREF: sub_10016939+44j
		xor	al, al

loc_1001699E:				; CODE XREF: sub_10016939+61j
		test	al, al
		jnz	short loc_100169A4

loc_100169A2:				; CODE XREF: sub_10016939+38j
		xor	ebx, ebx

loc_100169A4:				; CODE XREF: sub_10016939+67j
		mov	al, bl
		pop	ebx

locret_100169A7:			; CODE XREF: sub_10016939+2Cj
					; sub_10016939+30j
		retn	8
sub_10016939	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100169AA	proc near		; DATA XREF: .rdata:1002D8F8o

TargetHandle	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100169D1
		mov	eax, [esi]
		jmp	short loc_100169D3
; ---------------------------------------------------------------------------

loc_100169D1:				; CODE XREF: sub_100169AA+21j
		mov	eax, esi

loc_100169D3:				; CODE XREF: sub_100169AA+25j
		mov	ecx, [ecx+10h]
		xor	ebx, ebx
		mov	[esp+28h+var_14], eax
		inc	ebx
		lea	eax, [esp+28h+var_14]
		mov	[esp+28h+var_10], ebx
		mov	[esp+28h+var_8], eax
		lea	eax, [esp+28h+var_10]
		push	eax
		push	0Eh
		mov	[esp+30h+var_C], ebx
		call	sub_10015057
		mov	edx, [edi+4]
		lea	ecx, [esp+28h+TargetHandle]
		and	[esp+28h+TargetHandle],	0
		push	ecx		; lpTargetHandle
		push	[ebp+arg_C]	; int
		mov	ecx, eax
		push	[ebp+arg_8]	; int
		push	esi		; int
		call	sub_100173A1
		mov	ecx, [esp+38h+TargetHandle]
		add	esp, 10h
		mov	[edi+18h], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[edi+10h], eax
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_100169AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016A37	proc near		; DATA XREF: .rdata:1002D8CCo

TargetHandle	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+20h+var_4], eax
		push	esi
		mov	esi, [ebp+arg_4]
		mov	edx, ecx
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10016A5F
		mov	eax, [esi]
		jmp	short loc_10016A61
; ---------------------------------------------------------------------------

loc_10016A5F:				; CODE XREF: sub_10016A37+22j
		mov	eax, esi

loc_10016A61:				; CODE XREF: sub_10016A37+26j
		xor	ecx, ecx
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_18], 2
		lea	eax, [esp+28h+var_14]
		inc	ecx

loc_10016A74:				; CODE XREF: sub_10016A37+48j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10016A74
		mov	ecx, [edx+10h]
		lea	eax, [esp+28h+var_1C]
		mov	[esp+28h+var_10], eax
		lea	eax, [ebp+arg_8]
		mov	[esp+28h+var_8], eax
		lea	eax, [esp+28h+var_18]
		push	eax
		push	0Fh
		mov	[esp+30h+var_14], 1
		mov	[esp+30h+var_C], 2
		call	sub_10015057
		mov	edx, [edi+4]
		lea	ecx, [esp+28h+TargetHandle]
		and	[esp+28h+TargetHandle],	0
		push	ecx		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, eax
		push	esi		; int
		call	sub_10017460
		mov	ecx, [esp+34h+TargetHandle]
		add	esp, 0Ch
		mov	[edi+18h], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[edi+10h], eax
		mov	al, 1
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10016A37	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10016AE9(char	Src, int, int)
sub_10016AE9	proc near		; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+E2p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
Src		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		and	[esp+18h+var_10], 0
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	[esp+20h+var_18], ecx
		xor	edi, edi
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_14], edx
		inc	edi
		mov	[esp+20h+var_8], ecx
		push	0Eh
		lea	edx, [esp+24h+var_10]
		mov	[esp+24h+var_10], edi
		pop	ecx
		mov	[esp+20h+var_C], edi
		call	sub_10010153
		test	al, al
		jnz	short loc_10016B36
		mov	eax, edi
		jmp	short loc_10016B61
; ---------------------------------------------------------------------------

loc_10016B36:				; CODE XREF: sub_10016AE9+47j
		mov	ecx, [ebp+arg_4]
		push	esi		; int
		mov	[esp+24h+var_10], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		lea	ecx, [esp+24h+var_10]
		mov	[esp+24h+var_C], eax
		lea	eax, [esp+24h+var_14]
		push	eax		; void *
		lea	eax, [ebp+Src]
		push	eax		; Src
		lea	eax, [esp+2Ch+var_18]
		push	eax		; int
		call	sub_10016EA4
		add	esp, 10h

loc_10016B61:				; CODE XREF: sub_10016AE9+4Bj
		mov	ecx, [esp+20h+var_4]
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10016AE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016B72	proc near		; CODE XREF: TargetNtOpenEvent(x,x,x,x)+D6p

var_28		= dword	ptr -28h
Src		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		lea	eax, [esp+34h+var_14]
		push	edi
		mov	[esp+38h+Src], edx
		xor	edi, edi
		xor	edx, edx
		mov	[esp+38h+var_28], ecx
		push	2
		pop	ebx
		inc	edi
		mov	[esp+38h+var_20], edx
		mov	[esp+38h+var_18], ebx
		mov	ecx, edi

loc_10016BAA:				; CODE XREF: sub_10016B72+41j
		dec	ecx
		mov	[eax], edx
		mov	[eax+4], edx
		lea	eax, [eax+8]
		jns	short loc_10016BAA
		lea	ecx, [esp+38h+Src]
		mov	[esp+38h+var_14], edi
		lea	eax, [esp+38h+var_28]
		mov	[esp+38h+var_8], ecx
		push	0Fh
		lea	edx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_10], eax
		pop	ecx
		mov	[esp+38h+var_C], ebx
		call	sub_10010153
		test	al, al
		jnz	short loc_10016BE1
		mov	eax, edi
		jmp	short loc_10016C08
; ---------------------------------------------------------------------------

loc_10016BE1:				; CODE XREF: sub_10016B72+69j
		mov	ecx, [ebp+arg_0]
		push	esi		; int
		mov	[esp+3Ch+var_20], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		lea	ecx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_1C], eax
		lea	eax, [esp+3Ch+Src]
		push	eax		; Src
		lea	eax, [esp+40h+var_28]
		push	eax		; int
		call	sub_10016F5E
		add	esp, 0Ch

loc_10016C08:				; CODE XREF: sub_10016B72+6Dj
		mov	ecx, [esp+38h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10016B72	endp

; Exported entry  22. _TargetNtCreateEvent@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	TargetNtCreateEvent(int, int, int, int,	char Src, int)
		public _TargetNtCreateEvent@24
_TargetNtCreateEvent@24	proc near	; DATA XREF: sub_10016939+7o
					; .rdata:off_1002E058o

var_6C		= dword	ptr -6Ch
Dst		= byte ptr -68h
var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
Src		= byte ptr  18h
arg_14		= dword	ptr  1Ch

		push	5Ch
		push	offset stru_1002DF88
		call	__SEH_prolog4
		push	[ebp+arg_14]
		push	dword ptr [ebp+Src]
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+arg_8]
		mov	edi, [ebp+arg_4]
		push	edi
		call	[ebp+arg_0]
		mov	ebx, eax
		mov	[ebp+var_1C], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10016D5D
		test	esi, esi
		jz	loc_10016D5D
		mov	edx, [esi+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatevent ; "NtCreatEvent"
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_10016C7A
		mov	eax, ebx
		jmp	loc_10016D5D
; ---------------------------------------------------------------------------

loc_10016C7A:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+57j
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_10016D5B
		call	sub_10013DD2
		mov	[ebp+arg_0], eax
		test	eax, eax
		jz	loc_10016D5B
		push	6
		pop	ecx
		lea	edi, [ebp+var_38]
		rep movsd
		xor	esi, esi
		mov	[ebp+var_34], esi
		mov	[ebp+arg_8], esi
		push	esi
		lea	eax, [ebp+var_20]
		push	eax
		lea	edx, [ebp+arg_8]
		lea	ecx, [ebp+var_38]
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_10016D5B
		mov	edi, [ebp+arg_8]
		test	edi, edi
		jz	loc_10016D5B
		mov	[ebp+var_6C], esi
		push	30h		; Size
		push	esi		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		mov	[ebp+var_64], 0C0000022h
		lea	eax, [ebp+var_6C]
		push	eax		; int
		push	[ebp+arg_0]	; int
		push	dword ptr [ebp+Src] ; Src
		mov	eax, [ebp+arg_14]
		movzx	edx, al
		mov	ecx, edi
		call	sub_10016AE9
		add	esp, 18h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, edi
		call	sub_1001430B
		test	esi, esi
		jz	short loc_10016D18
		mov	ebx, [ebp+var_64]
		jmp	short loc_10016D5B
; ---------------------------------------------------------------------------

loc_10016D18:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+F7j
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+var_5C]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebp+arg_C]
		mov	edx, [edx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreateevent ; "NtCreateEvent"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_10016D5B
; ---------------------------------------------------------------------------

loc_10016D4A:				; DATA XREF: .rdata:stru_1002DF88o
		xor	eax, eax	; Exception filter 0 for function 10016C1A
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10016D4E:				; DATA XREF: .rdata:stru_1002DF88o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10016C1A
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_1C]

loc_10016D5B:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+6Fj
					; TargetNtCreateEvent(x,x,x,x,x,x)+7Fj	...
		mov	eax, ebx

loc_10016D5D:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+2Bj
					; TargetNtCreateEvent(x,x,x,x,x,x)+33j	...
		call	__SEH_epilog4
		retn	18h
_TargetNtCreateEvent@24	endp

; Exported entry  26. _TargetNtOpenEvent@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenEvent(x, x, x, x)
		public _TargetNtOpenEvent@16
_TargetNtOpenEvent@16 proc near		; DATA XREF: sub_10016939+3Co
					; .rdata:off_1002E058o

var_70		= dword	ptr -70h
Dst		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	60h
		push	offset stru_1002DFA8
		call	__SEH_prolog4
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+arg_8]
		mov	edi, [ebp+arg_4]
		push	edi
		call	[ebp+arg_0]
		mov	ebx, eax
		mov	[ebp+var_1C], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10016E9C
		test	esi, esi
		jz	loc_10016E9C
		mov	edx, [esi+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002A52
		pop	ecx
		call	sub_10013CB8
		cmp	dword ptr [eax+4], 1
		jg	short loc_10016DBF
		mov	eax, ebx
		jmp	loc_10016E9C
; ---------------------------------------------------------------------------

loc_10016DBF:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+51j
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E2B
		pop	ecx
		test	al, al
		jz	loc_10016E9A
		call	sub_10013DD2
		mov	[ebp+var_20], eax
		test	eax, eax
		jz	loc_10016E9A
		push	6
		pop	ecx
		lea	edi, [ebp+var_3C]
		rep movsd
		xor	esi, esi
		mov	[ebp+var_38], esi
		mov	[ebp+arg_0], esi
		push	esi
		lea	eax, [ebp+var_24]
		push	eax
		lea	edx, [ebp+arg_0]
		lea	ecx, [ebp+var_3C]
		call	sub_10013EE8
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_10016E9A
		mov	edi, [ebp+arg_0]
		test	edi, edi
		jz	loc_10016E9A
		mov	[ebp+var_70], esi
		push	30h		; Size
		push	esi		; Val
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		call	memset
		mov	[ebp+var_68], 0C0000022h
		lea	eax, [ebp+var_70]
		push	eax
		push	[ebp+var_20]
		mov	edx, [ebp+arg_8]
		mov	ecx, edi
		call	sub_10016B72
		add	esp, 14h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, edi
		call	sub_1001430B
		test	esi, esi
		jz	short loc_10016E57
		mov	ebx, [ebp+var_68]
		jmp	short loc_10016E9A
; ---------------------------------------------------------------------------

loc_10016E57:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+EBj
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+var_60]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebp+arg_C]
		mov	edx, [edx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002B50
		pop	ecx
		jmp	short loc_10016E9A
; ---------------------------------------------------------------------------

loc_10016E89:				; DATA XREF: .rdata:stru_1002DFA8o
		xor	eax, eax	; Exception filter 0 for function 10016D65
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10016E8D:				; DATA XREF: .rdata:stru_1002DFA8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10016D65
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_1C]

loc_10016E9A:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+69j
					; TargetNtOpenEvent(x,x,x,x)+79j ...
		mov	eax, ebx

loc_10016E9C:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+25j
					; TargetNtOpenEvent(x,x,x,x)+2Dj ...
		call	__SEH_epilog4
		retn	10h
_TargetNtOpenEvent@16 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016EA4(int,	void *Src, void	*, int)
sub_10016EA4	proc near		; CODE XREF: sub_10016AE9+70p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10016EBC
		push	4
		pop	eax
		jmp	loc_10016F5A
; ---------------------------------------------------------------------------

loc_10016EBC:				; CODE XREF: sub_10016EA4+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 0Eh
		inc	ebp
		mov	dword ptr [edi+3Ch], 3
		push	ebp		; int
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		mov	ecx, edi
		call	sub_1000B0E0
		test	al, al
		jnz	short loc_10016F03
		push	4
		pop	eax
		jmp	short loc_10016F58
; ---------------------------------------------------------------------------

loc_10016F03:				; CODE XREF: sub_10016EA4+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_10016F56
		push	2		; int
		push	0		; char
		push	esi		; Size
		push	[esp+20h+arg_8]	; Src
		mov	ecx, edi
		push	2		; int
		call	sub_1000B0E0
		test	al, al
		jz	short loc_10016F56
		push	[esp+14h+arg_C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10016F56
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10016F56:				; CODE XREF: sub_10016EA4+75j
					; sub_10016EA4+8Bj ...
		mov	eax, esi

loc_10016F58:				; CODE XREF: sub_10016EA4+5Dj
		pop	esi
		pop	ebp

loc_10016F5A:				; CODE XREF: sub_10016EA4+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10016EA4	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016F5E(int,	void *Src, int)
sub_10016F5E	proc near		; CODE XREF: sub_10016B72+8Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159B0
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10016F76
		push	4
		pop	eax
		jmp	loc_10016FFC
; ---------------------------------------------------------------------------

loc_10016F76:				; CODE XREF: sub_10016F5E+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 0Fh
		inc	ebp
		mov	dword ptr [edi+3Ch], 2
		push	ebp		; int
		mov	dword ptr [edi+44h], 64h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A353
		push	eax		; Size
		push	esi		; Src
		push	0		; int
		mov	ecx, edi
		call	sub_100118BA
		test	al, al
		jz	short loc_10016FCE
		push	2		; int
		push	0		; char
		push	4		; Size
		push	[esp+20h+Src]	; Src
		mov	ecx, edi
		push	ebp		; int
		call	sub_100118BA
		test	al, al
		jnz	short loc_10016FD3

loc_10016FCE:				; CODE XREF: sub_10016F5E+58j
		push	4
		pop	eax
		jmp	short loc_10016FFA
; ---------------------------------------------------------------------------

loc_10016FD3:				; CODE XREF: sub_10016F5E+6Ej
		push	[esp+14h+arg_8]
		mov	ecx, ebx
		push	edi
		call	sub_10015A29
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10016FF8
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10016FF8:				; CODE XREF: sub_10016F5E+86j
		mov	eax, esi

loc_10016FFA:				; CODE XREF: sub_10016F5E+73j
		pop	esi
		pop	ebp

loc_10016FFC:				; CODE XREF: sub_10016F5E+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10016F5E	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017000(void	*Dst)
sub_10017000	proc near		; CODE XREF: sub_1001719D+8Bp

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
Src		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_18		= byte ptr -18h
Dst		= dword	ptr  4

		sub	esp, 68h
		push	ebx
		push	ebp
		push	esi
		xor	ebp, ebp
		mov	ebx, edx
		mov	esi, ecx
		mov	[esp+74h+var_4C], ebp
		push	edi
		lea	edx, [esp+78h+var_50]
		mov	[esp+78h+var_50], ebp
		mov	ecx, offset aNtopendirector ; "NtOpenDirectoryObject"
		call	sub_1001881C
		lea	edx, [esp+78h+var_54]
		mov	[esp+78h+var_54], ebp
		mov	ecx, offset aNtquerysymboli ; "NtQuerySymbolicLinkObject"
		call	sub_1001881C
		lea	edx, [esp+78h+var_4C]
		mov	[esp+78h+var_4C], ebp
		mov	ecx, offset aNtopensymbolic ; "NtOpenSymbolicLinkObject"
		call	sub_1001881C
		lea	edx, [esp+78h+var_5C]
		mov	[esp+78h+var_5C], ebp
		mov	ecx, offset aNtclose ; "NtClose"
		call	sub_1001881C
		push	6
		pop	ecx
		xor	eax, eax
		mov	[esp+78h+var_40], ebp
		lea	edi, [esp+78h+var_30]
		mov	[esp+78h+var_3C], ebp
		rep stosd
		lea	eax, [esp+78h+var_40]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+7Ch+var_30]
		push	eax
		push	ebp
		push	40h
		pop	edx
		call	sub_1001541F
		add	esp, 0Ch
		mov	[esp+78h+var_58], ebp
		lea	eax, [esp+78h+var_30]
		push	eax
		push	1
		lea	eax, [esp+80h+var_58]
		push	eax
		call	[esp+84h+var_50]
		test	eax, eax
		jnz	loc_10017195
		push	6
		pop	ecx
		lea	edi, [esp+78h+var_18]
		mov	[esp+78h+var_38], ebp
		rep stosd
		lea	eax, [esp+78h+var_38]
		mov	[esp+78h+var_34], ebp
		push	eax
		lea	eax, [esp+7Ch+var_18]
		mov	ecx, ebx
		push	eax
		push	[esp+80h+var_58]
		push	40h
		pop	edx
		call	sub_1001541F
		add	esp, 0Ch
		mov	[esp+78h+var_64], ebp
		lea	eax, [esp+78h+var_18]
		push	eax
		push	80000000h
		lea	eax, [esp+80h+var_64]
		push	eax
		call	[esp+84h+var_4C]
		push	[esp+78h+var_58]
		mov	esi, eax
		call	[esp+7Ch+var_5C]
		test	esi, esi
		jnz	loc_10017193
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_48], ebp
		push	eax
		lea	eax, [esp+7Ch+var_48]
		mov	[esp+7Ch+Src], ebp
		push	eax
		push	[esp+80h+var_64]
		mov	[esp+84h+var_60], ebp
		call	[esp+84h+var_54]
		mov	esi, eax
		cmp	esi, 0C0000023h
		jz	short loc_10017127
		push	[esp+78h+var_64]
		call	[esp+7Ch+var_5C]
		jmp	short loc_10017193
; ---------------------------------------------------------------------------

loc_10017127:				; CODE XREF: sub_10017000+11Bj
		xor	eax, eax
		xor	ecx, ecx
		mov	word ptr [esp+78h+var_48], ax
		mov	eax, [esp+78h+var_60]
		mov	word ptr [esp+78h+var_48+2], ax
		movzx	eax, ax
		push	2
		inc	eax
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		pop	ecx
		mov	[esp+78h+Src], eax
		lea	eax, [esp+78h+var_60]
		push	eax
		lea	eax, [esp+7Ch+var_48]
		push	eax
		push	[esp+80h+var_64]
		call	[esp+84h+var_54]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10017180
		push	[esp+78h+var_60] ; int
		mov	ecx, [esp+7Ch+Dst] ; Dst
		push	[esp+7Ch+Src]	; Src
		call	sub_1000233F

loc_10017180:				; CODE XREF: sub_10017000+16Aj
		push	[esp+78h+var_64]
		call	[esp+7Ch+var_5C]
		push	[esp+78h+Src]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10017193:				; CODE XREF: sub_10017000+EFj
					; sub_10017000+125j
		mov	eax, esi

loc_10017195:				; CODE XREF: sub_10017000+9Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 68h
		retn
sub_10017000	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001719D	proc near		; CODE XREF: sub_100173A1+33p
					; sub_10017460+33p

var_74		= byte ptr -74h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
pSessionId	= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_34		= byte ptr -34h
Dst		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	[ebp+var_50], ebx
		mov	esi, ecx
		mov	eax, dword_10031F80
		push	edi
		test	eax, eax
		jz	short loc_100171C9
		mov	[esi], eax
		xor	eax, eax
		jmp	loc_10017299
; ---------------------------------------------------------------------------

loc_100171C9:				; CODE XREF: sub_1001719D+21j
		lea	edx, [ebp+var_50]
		mov	[ebp+var_50], ebx
		mov	ecx, offset aNtopendirector ; "NtOpenDirectoryObject"
		call	sub_1001881C
		lea	eax, [ebp+pSessionId]
		mov	[ebp+pSessionId], ebx
		push	eax		; pSessionId
		call	ds:GetCurrentProcessId
		push	eax		; dwProcessId
		call	ds:ProcessIdToSessionId
		xor	eax, eax
		mov	[ebp+var_8], 7
		push	offset aSessionsBnolin ; "\\Sessions\\BNOLINKS"
		lea	ecx, [ebp+var_34] ; Dst
		mov	[ebp+var_C], ebx
		mov	[ebp+Dst], ax
		call	sub_10001C68
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		push	ecx
		push	[ebp+pSessionId]
		lea	eax, [ebp+var_4C]
		push	offset aD	; "%d"
		push	eax
		call	sub_10004106
		add	esp, 10h
		lea	ecx, [ebp+var_34]
		mov	edx, eax
		call	sub_10017000
		pop	ecx
		push	ebx
		push	1
		lea	ecx, [ebp+var_4C]
		mov	edi, eax
		call	sub_100022FA
		push	ebx
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_100022FA
		test	edi, edi
		jnz	short loc_1001728C
		push	6
		pop	ecx
		xor	eax, eax
		mov	[ebp+var_5C], ebx
		lea	edi, [ebp+var_74]
		mov	[ebp+var_58], ebx
		rep stosd
		lea	eax, [ebp+var_5C]
		push	eax
		lea	eax, [ebp+var_74]
		push	eax
		push	ebx
		push	40h
		pop	edx
		lea	ecx, [ebp+Dst]
		call	sub_1001541F
		add	esp, 0Ch
		lea	eax, [ebp+var_74]
		push	eax
		push	0Fh
		push	offset dword_10031F80
		call	[ebp+var_50]
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001728C
		mov	eax, dword_10031F80
		mov	[esi], eax

loc_1001728C:				; CODE XREF: sub_1001719D+ABj
					; sub_1001719D+E6j
		push	ebx
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		mov	eax, edi

loc_10017299:				; CODE XREF: sub_1001719D+27j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001719D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100172AA@<eax>(void *Src@<ecx>, int)
sub_100172AA	proc near		; CODE XREF: sub_1001525E+CFp

var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_30		= byte ptr -30h
Dst		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		and	[ebp+var_44], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		push	edi		; Src
		lea	ecx, [ebp+Dst]	; Dst
		call	sub_10001C68
		cmp	[ebp+var_10], 0
		jz	loc_10017380
		cmp	esi, 9
		jz	short loc_100172E9
		cmp	esi, 0Ah
		jnz	loc_10017380

loc_100172E9:				; CODE XREF: sub_100172AA+34j
		push	3
		lea	ecx, [ebp+var_40]
		call	sub_1000F976
		push	1
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_40]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_10017374
		cmp	esi, 0Ah
		jnz	short loc_1001731D
		push	1
		push	7FEDFFFFh
		push	1
		push	1
		lea	ecx, [ebp+var_40]
		call	sub_1000FC65

loc_1001731D:				; CODE XREF: sub_100172AA+5Ej
		lea	eax, [ebp+var_40]
		mov	ecx, ebx
		push	eax
		push	0Fh
		call	sub_1000F6D9
		test	al, al
		jz	short loc_10017374
		cmp	esi, 0Ah
		jz	short loc_10017368
		push	3
		lea	ecx, [ebp+var_30]
		call	sub_1000F976
		push	1
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_30]
		call	sub_1000FB2D
		test	al, al
		jz	short loc_1001736C
		lea	eax, [ebp+var_30]
		mov	ecx, ebx
		push	eax
		push	0Eh
		call	sub_1000F6D9
		test	al, al
		jz	short loc_1001736C
		lea	ecx, [ebp+var_30]
		call	sub_1000FD8D

loc_10017368:				; CODE XREF: sub_100172AA+87j
		mov	bl, 1
		jmp	short loc_10017376
; ---------------------------------------------------------------------------

loc_1001736C:				; CODE XREF: sub_100172AA+A3j
					; sub_100172AA+B4j
		lea	ecx, [ebp+var_30]
		call	sub_1000FD8D

loc_10017374:				; CODE XREF: sub_100172AA+59j
					; sub_100172AA+82j
		xor	bl, bl

loc_10017376:				; CODE XREF: sub_100172AA+C0j
		lea	ecx, [ebp+var_40]
		call	sub_1000FD8D
		jmp	short loc_10017382
; ---------------------------------------------------------------------------

loc_10017380:				; CODE XREF: sub_100172AA+2Bj
					; sub_100172AA+39j
		xor	bl, bl

loc_10017382:				; CODE XREF: sub_100172AA+D4j
		push	0
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		mov	ecx, [ebp+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100172AA	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100173A1(int,	int, int, LPHANDLE lpTargetHandle)
sub_100173A1	proc near		; CODE XREF: sub_100169AA+65p

hSourceHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpTargetHandle	= dword	ptr  10h

		sub	esp, 34h
		push	ebx
		push	ebp
		push	esi
		mov	ebx, edx
		mov	esi, ecx
		xor	ebp, ebp
		lea	edx, [esp+40h+var_28]
		push	edi
		mov	ecx, offset aNtcreateevent ; "NtCreateEvent"
		mov	[esp+44h+var_28], ebp
		call	sub_1001881C
		cmp	esi, 3
		jz	short loc_100173CC
		xor	eax, eax
		jmp	loc_10017458
; ---------------------------------------------------------------------------

loc_100173CC:				; CODE XREF: sub_100173A1+22j
		lea	ecx, [esp+44h+var_2C]
		mov	[esp+44h+var_2C], ebp
		call	sub_1001719D
		test	eax, eax
		jnz	short loc_10017458
		push	6
		pop	ecx
		lea	edi, [esp+44h+var_1C]
		mov	[esp+44h+var_24], ebp
		rep stosd
		mov	ecx, [esp+44h+arg_0]
		lea	eax, [esp+44h+var_24]
		push	eax
		lea	eax, [esp+48h+var_1C]
		mov	[esp+48h+var_20], ebp
		push	eax
		push	[esp+4Ch+var_2C]
		push	40h
		pop	edx
		call	sub_1001541F
		add	esp, 0Ch
		mov	[esp+44h+hSourceHandle], ebp
		lea	eax, [esp+44h+var_1C]
		push	[esp+44h+arg_8]
		push	[esp+48h+arg_4]
		push	eax
		push	1F0003h
		lea	eax, [esp+54h+hSourceHandle]
		push	eax
		call	[esp+58h+var_28]
		mov	esi, eax
		cmp	[esp+44h+hSourceHandle], ebp
		jz	short loc_10017458
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	[esp+50h+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+58h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10017458
		mov	eax, esi

loc_10017458:				; CODE XREF: sub_100173A1+26j
					; sub_100173A1+3Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
sub_100173A1	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017460(int,	int, LPHANDLE lpTargetHandle)
sub_10017460	proc near		; CODE XREF: sub_10016A37+8Bp

hSourceHandle	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch

		sub	esp, 30h
		push	ebx
		push	ebp
		push	esi
		mov	ebx, edx
		mov	esi, ecx
		xor	ebp, ebp
		lea	edx, [esp+3Ch+var_24]
		push	edi
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		mov	[esp+40h+var_24], ebp
		call	sub_1001881C
		cmp	esi, 3
		jz	short loc_1001748B
		xor	eax, eax
		jmp	loc_1001750E
; ---------------------------------------------------------------------------

loc_1001748B:				; CODE XREF: sub_10017460+22j
		lea	ecx, [esp+40h+var_28]
		mov	[esp+40h+var_28], ebp
		call	sub_1001719D
		test	eax, eax
		jnz	short loc_1001750E
		push	6
		pop	ecx
		lea	edi, [esp+40h+var_18]
		mov	[esp+40h+var_20], ebp
		rep stosd
		mov	ecx, [esp+40h+arg_0]
		lea	eax, [esp+40h+var_20]
		push	eax
		lea	eax, [esp+44h+var_18]
		mov	[esp+44h+var_1C], ebp
		push	eax
		push	[esp+48h+var_28]
		push	40h
		pop	edx
		call	sub_1001541F
		add	esp, 0Ch
		mov	[esp+40h+hSourceHandle], ebp
		lea	eax, [esp+40h+var_18]
		push	eax
		push	[esp+44h+arg_4]
		lea	eax, [esp+48h+hSourceHandle]
		push	eax
		call	[esp+4Ch+var_24]
		mov	esi, eax
		cmp	[esp+40h+hSourceHandle], ebp
		jz	short loc_1001750E
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	[esp+4Ch+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+54h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_1001750E
		mov	eax, esi

loc_1001750E:				; CODE XREF: sub_10017460+26j
					; sub_10017460+3Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
sub_10017460	endp

; Exported entry  25. _TargetNtMapViewOfSection@44

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetNtMapViewOfSection(x,	x, x, x, x, x, x, x, x,	x, x)
		public _TargetNtMapViewOfSection@44
_TargetNtMapViewOfSection@44 proc near	; DATA XREF: .rdata:off_1002E058o

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+20h+arg_28]
		mov	ebp, [esp+24h+arg_C]
		push	[esp+24h+arg_24]
		mov	esi, [esp+28h+arg_4]
		push	[esp+28h+arg_20]
		push	[esp+2Ch+arg_1C]
		push	[esp+30h+arg_18]
		push	[esp+34h+arg_14]
		push	[esp+38h+arg_10]
		push	ebp
		push	[esp+40h+arg_8]
		push	esi
		call	[esp+48h+arg_0]
		mov	ebx, eax
		xor	edi, edi
		cmp	dword_10031F84,	1
		mov	[esp+20h+arg_28], ebx
		jnz	short loc_10017577
		call	sub_10013CB8
		cmp	[eax+4], edi
		jnz	short loc_1001756D
		mov	dword ptr [eax+4], 1

loc_1001756D:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+4Ej
		mov	dword_10031F84,	2

loc_10017577:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+44j
		test	ebx, ebx
		js	loc_100176FA
		call	sub_10013DE4
		test	al, al
		jz	loc_100176FA
		mov	ecx, [esp+20h+arg_8]
		call	sub_10014015
		test	al, al
		jz	loc_100176FA
		test	esi, esi
		jz	loc_100176FA
		test	ebp, ebp
		jz	loc_100176FA
		cmp	[esp+20h+arg_1C], edi
		jz	loc_100176FA
		cmp	[esp+20h+arg_18], edi
		jnz	loc_100176FA
		push	edi
		push	edi
		push	1
		lea	eax, [esp+2Ch+arg_1C]
		push	eax
		push	0FFFFFFFFh
		push	esi
		push	0FFFFFFFFh
		call	dword_10031D10
		test	eax, eax
		js	loc_100176FA
		lea	eax, [esp+20h+arg_18]
		push	eax
		push	10h
		lea	eax, [esp+28h+var_10]
		push	eax
		push	edi
		push	[esp+30h+arg_1C]
		call	dword_10031D28
		push	[esp+20h+arg_1C]
		mov	esi, eax
		call	dword_10031D0C
		test	esi, esi
		js	loc_100176FA
		cmp	[esp+20h+arg_18], 10h
		jnz	loc_100176FA
		test	[esp+20h+var_C], 1000000h
		jz	loc_100176FA
		mov	ecx, [ebp+0]
		lea	edx, [esp+20h+arg_20]
		call	sub_1001410D
		mov	esi, eax
		mov	ebx, 208h
		mov	eax, [ebp+0]
		mov	[esp+20h+arg_18], eax

loc_1001763B:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+172j
		mov	[esp+20h+arg_1C], ebx
		call	sub_10013DE4
		test	al, al
		jz	short loc_1001769B
		push	ebx
		push	edi
		push	dword_10031DF8
		call	dword_10031D34
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_1001769B
		lea	eax, [esp+20h+arg_24]
		push	eax
		push	[esp+24h+arg_1C]
		push	ebx
		push	2
		push	[esp+30h+arg_18]
		push	0FFFFFFFFh
		call	dword_10031D2C
		cmp	eax, 80000005h
		jnz	short loc_1001768A
		xor	edx, edx
		mov	ecx, ebx
		call	sub_1001430B
		mov	ebx, [esp+20h+arg_24]
		jmp	short loc_1001763B
; ---------------------------------------------------------------------------

loc_1001768A:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+163j
		test	eax, eax
		jns	short loc_10017699
		xor	edx, edx
		mov	ecx, ebx
		call	sub_1001430B
		jmp	short loc_1001769B
; ---------------------------------------------------------------------------

loc_10017699:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+176j
		mov	edi, ebx

loc_1001769B:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+130j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+144j	...
		test	esi, esi
		jnz	short loc_100176AF
		test	byte ptr [esp+20h+arg_20], 4
		jz	short loc_100176AF
		mov	ecx, edi
		call	sub_100141A3
		mov	esi, eax

loc_100176AF:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+187j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+18Ej
		call	sub_1000E4B6
		test	eax, eax
		jz	short loc_100176DC
		push	dword ptr [ebp+0]
		mov	ecx, eax
		push	esi
		push	edi
		call	sub_1000E517
		test	al, al
		jnz	short loc_100176DC
		push	dword ptr [ebp+0]
		push	[esp+24h+arg_8]
		call	dword_10031D30
		mov	ebx, 0C0000001h
		jmp	short loc_100176E0
; ---------------------------------------------------------------------------

loc_100176DC:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1A0j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1B0j
		mov	ebx, [esp+20h+arg_28]

loc_100176E0:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1C4j
		test	esi, esi
		jz	short loc_100176ED
		xor	edx, edx
		mov	ecx, esi
		call	sub_1001430B

loc_100176ED:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1CCj
		test	edi, edi
		jz	short loc_100176FA
		xor	edx, edx
		mov	ecx, edi
		call	sub_1001430B

loc_100176FA:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+63j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+70j ...
		cmp	dword_10031F84,	0
		jnz	short loc_1001770D
		mov	dword_10031F84,	1

loc_1001770D:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1EBj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 10h
		retn	2Ch
_TargetNtMapViewOfSection@44 endp

; Exported entry  40. _TargetNtUnmapViewOfSection@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtUnmapViewOfSection(x, x, x)
		public _TargetNtUnmapViewOfSection@12
_TargetNtUnmapViewOfSection@12 proc near ; DATA	XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_1001774D
		mov	ecx, [ebp+arg_4]
		call	sub_10014015
		test	al, al
		jz	short loc_1001774B
		call	sub_1000E4B6
		test	eax, eax
		jz	short loc_1001774B
		push	[ebp+arg_8]
		mov	ecx, eax
		call	sub_1000E619

loc_1001774B:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+1Dj
					; TargetNtUnmapViewOfSection(x,x,x)+26j
		mov	eax, esi

loc_1001774D:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+11j
		pop	esi
		pop	ebp
		retn	0Ch
_TargetNtUnmapViewOfSection@12 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10017752(LPCWSTR lpLibFileName)
sub_10017752	proc near		; CODE XREF: sub_1001789C+1BDp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		push	ecx		; lpLibFileName
		mov	edi, edx
		call	ds:LoadLibraryW
		mov	esi, eax
		test	esi, esi
		jz	short loc_10017798
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], esi
		call	sub_100058C0
		push	esi		; hLibModule
		test	al, al
		jnz	short loc_10017787
		call	ds:FreeLibrary
		jmp	short loc_10017796
; ---------------------------------------------------------------------------

loc_10017787:				; CODE XREF: sub_10017752+2Bj
		mov	eax, [esi+3Ch]
		sub	edi, [eax+esi+28h]
		call	ds:FreeLibrary
		mov	esi, edi

loc_10017796:				; CODE XREF: sub_10017752+33j
		mov	eax, esi

loc_10017798:				; CODE XREF: sub_10017752+14j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10017752	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001779E	proc near		; CODE XREF: sub_100083D0+460p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		xor	edi, edi
		mov	[esi], edi
		lea	ecx, [esi+10h]
		mov	[esi+4], edi
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		mov	[ecx], edi
		call	sub_100045FD
		push	[esp+0Ch+arg_0]
		lea	ecx, [esi+14h]
		mov	[ecx], edi
		call	sub_100045FD
		mov	eax, [esp+0Ch+arg_8]
		mov	[esi+18h], edi
		mov	[esi+1Ch], eax
		mov	eax, [esp+0Ch+arg_C]
		mov	[esi+20h], edi
		mov	[esi+24h], eax
		mov	eax, esi
		mov	[esi+28h], edi
		mov	[esi+2Ch], edi
		pop	edi
		pop	esi
		pop	ecx
		retn	10h
sub_1001779E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100177EE	proc near		; CODE XREF: sub_10007EBC+2Ep
					; sub_100145ED+2Cp ...

ExitCode	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, ecx
		mov	[ebp+ExitCode],	edi
		call	sub_100061E5
		test	al, al
		jz	short loc_10017848
		push	32h		; dwMilliseconds
		push	dword ptr [esi]	; hHandle
		call	ds:WaitForSingleObject
		lea	eax, [ebp+ExitCode]
		push	eax		; lpExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		jz	short loc_10017828
		cmp	[ebp+ExitCode],	103h
		jnz	short loc_10017848

loc_10017828:				; CODE XREF: sub_100177EE+2Fj
		lea	ecx, [esi+18h]
		cmp	[ecx], edi
		jz	short loc_10017839
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jz	short loc_10017839
		call	sub_1000628A

loc_10017839:				; CODE XREF: sub_100177EE+3Fj
					; sub_100177EE+44j
		mov	[esi+20h], edi
		mov	ecx, esi
		mov	[esi+8], edi
		call	sub_1000628A
		jmp	short loc_1001785B
; ---------------------------------------------------------------------------

loc_10017848:				; CODE XREF: sub_100177EE+15j
					; sub_100177EE+38j
		mov	ecx, [esi+20h]
		mov	[esi+20h], edi
		test	ecx, ecx
		jz	short loc_10017858
		push	ecx
		call	sub_10017CD2

loc_10017858:				; CODE XREF: sub_100177EE+62j
		mov	[esi+20h], edi

loc_1001785B:				; CODE XREF: sub_100177EE+58j
		cmp	[esi+2Ch], edi
		jz	short loc_1001786A
		push	dword ptr [esi+2Ch] ; Memory
		call	ds:free
		pop	ecx

loc_1001786A:				; CODE XREF: sub_100177EE+70j
		mov	ecx, [esi+20h]
		test	ecx, ecx
		jz	short loc_10017877
		push	ecx
		call	sub_10017CD2

loc_10017877:				; CODE XREF: sub_100177EE+81j
		lea	ecx, [esi+18h]
		call	sub_10004633
		lea	ecx, [esi+14h]
		call	sub_10004633
		lea	ecx, [esi+10h]
		call	sub_10004633
		mov	ecx, esi
		call	sub_100061B8
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100177EE	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1001789C(wchar_t *Str, wchar_t *, int, int,	int)
sub_1001789C	proc near		; CODE XREF: sub_100083D0+483p

lpStartupInfo	= dword	ptr -318h
dwCreationFlags	= dword	ptr -314h
hProcess	= dword	ptr -310h
hThread		= dword	ptr -30Ch
var_308		= dword	ptr -308h
var_304		= dword	ptr -304h
lpApplicationName= dword ptr -300h
var_2FC		= dword	ptr -2FCh
ProcessInformation= _PROCESS_INFORMATION ptr -2F8h
var_2E8		= byte ptr -2E8h
Context		= CONTEXT ptr -2D8h
var_4		= dword	ptr -4
Str		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 318h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+318h+var_4], eax
		mov	eax, [esp+318h+arg_C]
		push	ebx
		push	ebp
		push	esi
		mov	esi, ds:_wcsdup
		mov	ebp, ecx
		mov	ecx, [esp+324h+Str]
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+328h+arg_4]
		mov	[esp+328h+lpStartupInfo], eax
		mov	eax, [esp+328h+arg_10]
		push	ecx		; Str
		mov	[esp+32Ch+lpApplicationName], ecx
		mov	[esp+32Ch+var_2FC], eax
		mov	[esp+32Ch+dwCreationFlags], ebx
		call	esi ; _wcsdup
		pop	ecx
		mov	ecx, [ebp+2Ch]
		mov	[esp+328h+dwCreationFlags], eax
		mov	[ebp+2Ch], ebx
		test	ecx, ecx
		jz	short loc_10017908
		push	ecx		; Memory
		call	ds:free
		mov	eax, [esp+32Ch+dwCreationFlags]
		pop	ecx

loc_10017908:				; CODE XREF: sub_1001789C+5Ej
		push	edi		; Str
		mov	[ebp+2Ch], eax
		call	esi ; _wcsdup
		mov	esi, eax
		mov	edi, 40Ch
		mov	eax, [esp+32Ch+lpStartupInfo]
		pop	ecx
		mov	[esp+328h+dwCreationFlags], edi
		cmp	[eax+44h], ebx
		jz	short loc_1001792C
		mov	edi, 8040Ch
		mov	[esp+328h+dwCreationFlags], edi

loc_1001792C:				; CODE XREF: sub_1001789C+85j
		cmp	[ebp+1Ch], ebx
		jz	short loc_10017945
		call	sub_100063BF
		cmp	dword ptr [eax], 5
		jge	short loc_10017945
		or	edi, 1000000h
		mov	[esp+328h+dwCreationFlags], edi

loc_10017945:				; CODE XREF: sub_1001789C+93j
					; sub_1001789C+9Dj
		xor	eax, eax
		lea	edi, [esp+328h+ProcessInformation]
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+328h+ProcessInformation]
		push	eax		; lpProcessInformation
		push	[esp+32Ch+lpStartupInfo] ; lpStartupInfo
		mov	eax, [esp+330h+arg_8]
		push	ebx		; lpCurrentDirectory
		push	ebx		; lpEnvironment
		push	[esp+338h+dwCreationFlags] ; dwCreationFlags
		movzx	eax, al
		push	eax		; bInheritHandles
		push	ebx		; lpThreadAttributes
		push	ebx		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	[esp+34Ch+lpApplicationName] ; lpApplicationName
		push	dword ptr [ebp+10h] ; hToken
		call	ds:CreateProcessAsUserW
		test	eax, eax
		jnz	short loc_1001798A
		call	ds:GetLastError
		mov	ebx, eax
		jmp	loc_10017A97
; ---------------------------------------------------------------------------

loc_1001798A:				; CODE XREF: sub_1001789C+DFj
		lea	eax, [esp+328h+ProcessInformation]
		mov	[esp+328h+hProcess], ebx
		push	eax
		lea	ecx, [esp+32Ch+hProcess]
		mov	[esp+32Ch+hThread], ebx
		mov	[esp+32Ch+var_308], ebx
		mov	[esp+32Ch+var_304], ebx
		call	sub_100061FE
		lea	ecx, [ebp+10h]
		call	sub_10004633
		cmp	[ebp+1Ch], ebx
		jz	short loc_100179CA
		push	[esp+328h+hProcess] ; hProcess
		push	dword ptr [ebp+1Ch] ; hJob
		call	ds:AssignProcessToJobObject
		test	eax, eax
		jz	loc_10017A79

loc_100179CA:				; CODE XREF: sub_1001789C+117j
		lea	edi, [ebp+14h]
		cmp	[edi], ebx
		jz	short loc_100179FA
		cmp	dword ptr [edi], 0FFFFFFFFh
		jz	short loc_100179FA
		mov	eax, [esp+328h+hThread]
		push	dword ptr [edi]	; Token
		mov	[esp+32Ch+lpStartupInfo], eax
		lea	eax, [esp+32Ch+lpStartupInfo]
		push	eax		; Thread
		call	ds:SetThreadToken
		test	eax, eax
		jz	loc_10017A79
		mov	ecx, edi
		call	sub_10004633

loc_100179FA:				; CODE XREF: sub_1001789C+133j
					; sub_1001789C+138j
		lea	eax, [esp+328h+Context]
		mov	[esp+328h+Context.ContextFlags], 1003Fh
		push	eax		; lpContext
		push	[esp+32Ch+hThread] ; hThread
		call	ds:GetThreadContext
		test	eax, eax
		jz	short loc_10017A79
		mov	eax, [esp+328h+Context._Eax]
		mov	edi, [esp+328h+var_2FC]
		mov	edx, edi
		mov	ecx, [esp+328h+hProcess] ; hSourceHandle
		mov	[esp+328h+lpStartupInfo], eax
		call	sub_1000616A
		test	al, al
		jz	short loc_10017A79
		mov	ecx, [esp+328h+hThread]	; hSourceHandle
		lea	edx, [edi+4]
		call	sub_1000616A
		test	al, al
		jz	short loc_10017A79
		mov	eax, [esp+328h+var_308]
		mov	edx, [esp+328h+lpStartupInfo]
		mov	ecx, [esp+328h+lpApplicationName] ; lpLibFileName
		mov	[edi+8], eax
		mov	eax, [esp+328h+var_304]
		mov	[edi+0Ch], eax
		call	sub_10017752
		mov	[ebp+28h], eax
		lea	ecx, [esp+328h+hProcess]
		lea	eax, [esp+328h+var_2E8]
		push	eax
		call	sub_10006249
		push	eax
		mov	ecx, ebp
		call	sub_100061FE
		jmp	short loc_10017A8E
; ---------------------------------------------------------------------------

loc_10017A79:				; CODE XREF: sub_1001789C+128j
					; sub_1001789C+151j ...
		call	ds:GetLastError
		push	ebx		; uExitCode
		push	[esp+32Ch+hProcess] ; hProcess
		mov	edi, eax
		call	ds:TerminateProcess
		mov	ebx, edi

loc_10017A8E:				; CODE XREF: sub_1001789C+1DBj
		lea	ecx, [esp+328h+hProcess]
		call	sub_100061B8

loc_10017A97:				; CODE XREF: sub_1001789C+E9j
		test	esi, esi
		jz	short loc_10017AA3
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_10017AA3:				; CODE XREF: sub_1001789C+1FDj
		mov	ecx, [esp+328h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 318h
		retn	14h
sub_1001789C	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10017AC0(LPCSTR lpProcName,	LPCVOID	lpBuffer, SIZE_T nSize)
sub_10017AC0	proc near		; CODE XREF: sub_1000BE9E+8Ep
					; sub_1000D966+6Bp ...

NumberOfBytesWritten= dword ptr	-4
lpProcName	= dword	ptr  4
lpBuffer	= dword	ptr  8
nSize		= dword	ptr  0Ch

		push	ecx
		push	edi
		mov	edi, ecx
		call	sub_100061E5
		test	al, al
		jnz	short loc_10017AD2
		push	8
		pop	eax
		jmp	short loc_10017B35
; ---------------------------------------------------------------------------

loc_10017AD2:				; CODE XREF: sub_10017AC0+Bj
		push	esi
		push	dword ptr [edi+2Ch] ; lpLibFileName
		call	ds:LoadLibraryW
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10017AE5
		inc	eax
		jmp	short loc_10017B34
; ---------------------------------------------------------------------------

loc_10017AE5:				; CODE XREF: sub_10017AC0+20j
		push	ebx
		push	[esp+10h+lpProcName] ; lpProcName
		push	esi		; hModule
		call	ds:GetProcAddress
		push	esi		; hLibModule
		mov	ebx, eax
		call	ds:FreeLibrary
		test	ebx, ebx
		jnz	short loc_10017B03
		xor	eax, eax
		inc	eax
		jmp	short loc_10017B33
; ---------------------------------------------------------------------------

loc_10017B03:				; CODE XREF: sub_10017AC0+3Cj
		mov	eax, [edi+28h]
		lea	ecx, [esp+10h+NumberOfBytesWritten]
		push	ebp
		mov	ebp, [esp+14h+nSize]
		sub	eax, esi
		push	ecx		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		add	eax, ebx
		push	eax		; lpBaseAddress
		push	dword ptr [edi]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jnz	short loc_10017B29
		inc	eax
		jmp	short loc_10017B32
; ---------------------------------------------------------------------------

loc_10017B29:				; CODE XREF: sub_10017AC0+64j
		xor	eax, eax
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		setnz	al

loc_10017B32:				; CODE XREF: sub_10017AC0+67j
		pop	ebp

loc_10017B33:				; CODE XREF: sub_10017AC0+41j
		pop	ebx

loc_10017B34:				; CODE XREF: sub_10017AC0+23j
		pop	esi

loc_10017B35:				; CODE XREF: sub_10017AC0+10j
		pop	edi
		pop	ecx
		retn	0Ch
sub_10017AC0	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10017B3A(int, void *Src, int, int)
sub_10017B3A	proc near		; CODE XREF: sub_10014EB0+60p

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  4
Src		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	ebx, ebx
		mov	esi, ecx
		push	ebx		; lpName
		push	10000h		; dwMaximumSizeLow
		push	ebx		; dwMaximumSizeHigh
		push	8000004h	; flProtect
		push	ebx		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		lea	edi, [esi+18h]
		call	ds:CreateFileMappingW
		push	eax
		mov	ecx, edi
		call	sub_100045FD
		cmp	[edi], ebx
		jz	loc_10017C07
		cmp	dword ptr [edi], 0FFFFFFFFh
		jz	loc_10017C07
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		push	6		; dwDesiredAccess
		lea	eax, [esp+20h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [esi]	; hTargetProcessHandle
		push	dword ptr [edi]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10017C07
		push	ebx		; dwNumberOfBytesToMap
		push	ebx		; dwFileOffsetLow
		push	ebx		; dwFileOffsetHigh
		push	6		; dwDesiredAccess
		push	dword ptr [edi]	; hFileMappingObject
		call	ds:MapViewOfFile
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_10017C07
		mov	edi, [esp+14h+Src]
		lea	ebx, [ebp+2000h]
		test	edi, edi
		jz	short loc_10017BD6
		push	0E000h		; Size
		push	edi		; Src
		push	ebx		; Dst
		call	memcpy
		add	esp, 0Ch
		xor	eax, eax

loc_10017BC4:				; CODE XREF: sub_10017B3A+9Aj
		mov	ecx, [ebx+eax*4]
		test	ecx, ecx
		jz	short loc_10017BD0
		sub	ecx, edi
		mov	[ebx+eax*4], ecx

loc_10017BD0:				; CODE XREF: sub_10017B3A+8Fj
		inc	eax
		cmp	eax, 20h
		jb	short loc_10017BC4

loc_10017BD6:				; CODE XREF: sub_10017B3A+77j
		mov	eax, [esp+14h+TargetHandle]
		mov	ecx, esi
		push	4		; nSize
		push	offset g_shared_section	; lpBuffer
		push	offset aG_shared_sec_0 ; "g_shared_section"
		mov	g_shared_section, eax
		call	sub_10017AC0
		mov	ecx, eax
		xor	ebx, ebx
		mov	g_shared_section, ebx
		test	ecx, ecx
		jz	short loc_10017C15

loc_10017C00:				; CODE XREF: sub_10017B3A+102j
					; sub_10017B3A+12Bj
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jnz	short loc_10017C0D

loc_10017C07:				; CODE XREF: sub_10017B3A+2Bj
					; sub_10017B3A+34j ...
		call	ds:GetLastError

loc_10017C0D:				; CODE XREF: sub_10017B3A+CBj
					; sub_10017B3A+17Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10017C15:				; CODE XREF: sub_10017B3A+C4j
		push	4		; nSize
		push	offset g_shared_IPC_size ; lpBuffer
		push	offset aG_shared_ipc_0 ; "g_shared_IPC_size"
		mov	ecx, esi
		mov	g_shared_IPC_size, 2000h
		call	sub_10017AC0
		mov	ecx, eax
		mov	g_shared_IPC_size, ebx
		test	ecx, ecx
		jnz	short loc_10017C00
		push	4		; nSize
		push	offset g_shared_policy_size ; lpBuffer
		push	offset aG_shared_pol_0 ; "g_shared_policy_size"
		mov	ecx, esi
		mov	g_shared_policy_size, 0E000h
		call	sub_10017AC0
		mov	ecx, eax
		mov	g_shared_policy_size, ebx
		test	ecx, ecx
		jnz	short loc_10017C00
		push	20h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10017C8E
		push	[esp+14h+arg_0]
		mov	ecx, eax
		push	dword ptr [esi+24h]
		push	dword ptr [esi+1Ch]
		push	dword ptr [esi+8]
		push	dword ptr [esi]
		call	sub_10015AD5
		mov	edi, eax
		jmp	short loc_10017C90
; ---------------------------------------------------------------------------

loc_10017C8E:				; CODE XREF: sub_10017B3A+138j
		mov	edi, ebx

loc_10017C90:				; CODE XREF: sub_10017B3A+152j
		mov	ecx, [esi+20h]
		mov	[esi+20h], ebx
		test	ecx, ecx
		jz	short loc_10017CA0
		push	ecx
		call	sub_10017CD2

loc_10017CA0:				; CODE XREF: sub_10017B3A+15Ej
		push	ecx
		push	ecx
		push	ebp
		mov	ecx, edi
		mov	[esi+20h], edi
		call	sub_10015B42
		test	al, al
		jnz	short loc_10017CB9
		push	8
		pop	eax
		jmp	loc_10017C0D
; ---------------------------------------------------------------------------

loc_10017CB9:				; CODE XREF: sub_10017B3A+175j
		lea	ecx, [esi+4]
		mov	[esi+0Ch], ebx
		call	sub_1000628A
		push	eax		; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	loc_10017C0D
sub_10017B3A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017CD2	proc near		; CODE XREF: sub_100177EE+65p
					; sub_100177EE+84p ...
		push	ebx
		mov	ebx, ecx
		push	ebx
		mov	ecx, [ebx+0Ch]
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	short loc_10017D1F
		mov	eax, [ebx+4]
		push	esi
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10017D11
		push	edi

loc_10017CED:				; CODE XREF: sub_10017CD2+3Cj
		mov	edi, [esi+8]
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [edi+4] ; hObject
		call	ds:CloseHandle
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		cmp	esi, [ebx+4]
		jnz	short loc_10017CED
		pop	edi

loc_10017D11:				; CODE XREF: sub_10017CD2+18j
		cmp	dword ptr [ebx], 0
		pop	esi
		jz	short loc_10017D1F
		push	dword ptr [ebx]	; lpBaseAddress
		call	ds:UnmapViewOfFile

loc_10017D1F:				; CODE XREF: sub_10017CD2+Ej
					; sub_10017CD2+43j
		lea	ecx, [ebx+4]
		call	sub_10008CED
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	eax, ebx
		pop	ebx
		retn	4
sub_10017CD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10017D35(HKEY hKey)
sub_10017D35	proc near		; CODE XREF: sub_10017D76+ADp
					; sub_10017D76+BBp ...

phkResult	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		lea	eax, [ebp+phkResult]
		push	eax		; phkResult
		push	2000000h	; samDesired
		push	0		; ulOptions
		push	0		; lpSubKey
		push	ecx		; hKey
		call	ds:RegOpenKeyExW
		test	eax, eax
		jnz	short loc_10017D62
		push	[ebp+phkResult]	; hKey
		call	ds:RegCloseKey
		test	eax, eax
		jz	short loc_10017D62
		xor	al, al
		jmp	short loc_10017D64
; ---------------------------------------------------------------------------

loc_10017D62:				; CODE XREF: sub_10017D35+1Aj
					; sub_10017D35+27j
		mov	al, 1

loc_10017D64:				; CODE XREF: sub_10017D35+2Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_10017D35	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017D68	proc near		; DATA XREF: .rdata:off_1002D9CCo
		push	2
		pop	eax
		cmp	[ecx+4], eax
		jge	short loc_10017D73
		mov	[ecx+4], eax

loc_10017D73:				; CODE XREF: sub_10017D68+6j
		xor	eax, eax
		retn
sub_10017D68	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017D76	proc near		; DATA XREF: .rdata:1002D9D0o

var_C		= dword	ptr -0Ch
TokenHandle	= dword	ptr -8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	ebx, g_shared_delayed_integrity_level
		call	sub_100063BF
		mov	edi, ds:TerminateProcess
		mov	esi, ds:GetCurrentProcess
		cmp	dword ptr [eax], 3
		jl	short loc_10017DFD
		cmp	ebx, 7
		jz	short loc_10017DFD
		lea	eax, [esp+20h+TokenHandle]
		push	eax		; TokenHandle
		push	80h		; DesiredAccess
		call	esi ; GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_10017DC7
		call	ds:GetLastError
		mov	ebx, eax
		jmp	short loc_10017DEF
; ---------------------------------------------------------------------------

loc_10017DC7:				; CODE XREF: sub_10017D76+45j
		push	[esp+20h+TokenHandle]
		and	[esp+24h+var_C], 0
		lea	ecx, [esp+24h+var_C]
		call	sub_100045FD
		mov	ecx, [esp+20h+var_C] ; TokenHandle
		mov	edx, ebx
		call	sub_10013C11
		lea	ecx, [esp+20h+var_C]
		mov	ebx, eax
		call	sub_10004633

loc_10017DEF:				; CODE XREF: sub_10017D76+4Fj
		test	ebx, ebx
		jz	short loc_10017DFD
		push	1B5Eh		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017DFD:				; CODE XREF: sub_10017D76+29j
					; sub_10017D76+2Ej ...
		cmp	dword ptr [ebp+4], 3
		jge	short loc_10017E0A
		mov	dword ptr [ebp+4], 3

loc_10017E0A:				; CODE XREF: sub_10017D76+8Bj
		call	ds:RevertToSelf
		test	eax, eax
		jnz	short loc_10017E1E
		push	1B5Fh		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E1E:				; CODE XREF: sub_10017D76+9Cj
		mov	ecx, 80000002h	; hKey
		call	sub_10017D35
		test	al, al
		jz	short loc_10017E48
		mov	ecx, 80000000h	; hKey
		call	sub_10017D35
		test	al, al
		jz	short loc_10017E48
		mov	ecx, 80000003h	; hKey
		call	sub_10017D35
		test	al, al
		jnz	short loc_10017E52

loc_10017E48:				; CODE XREF: sub_10017D76+B4j
					; sub_10017D76+C2j
		push	1B60h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E52:				; CODE XREF: sub_10017D76+D0j
		call	ds:RegDisablePredefinedCache
		test	eax, eax
		jz	short loc_10017E66
		push	1B61h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E66:				; CODE XREF: sub_10017D76+E4j
		cmp	g_handles_to_close, 0
		jz	short loc_10017EA8
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000C19C
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000C850
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000CA8B
		lea	ecx, [esp+20h+TokenHandle]
		test	al, al
		jnz	short loc_10017EA3
		call	sub_1000C1D9
		push	1B62h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess
		jmp	short loc_10017EA8
; ---------------------------------------------------------------------------

loc_10017EA3:				; CODE XREF: sub_10017D76+11Aj
		call	sub_1000C1D9

loc_10017EA8:				; CODE XREF: sub_10017D76+F7j
					; sub_10017D76+12Bj
		mov	eax, g_shared_delayed_mitigations
		or	eax, dword_10031E1C
		jz	short loc_10017ECC
		push	ecx
		push	ecx
		call	sub_1001027A
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10017ECC
		push	1B63h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017ECC:				; CODE XREF: sub_10017D76+13Dj
					; sub_10017D76+14Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10017D76	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017ED4	proc near		; DATA XREF: .rdata:1002D9D4o
		lea	eax, [ecx+4]
		retn
sub_10017ED4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017ED8	proc near		; DATA XREF: .rdata:1002D9D8o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_10]
		mov	edx, [ebp+arg_4]
		push	[ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		push	[ebp+arg_8]
		call	sub_1000D426
		add	esp, 0Ch
		pop	ebp
		retn	14h
sub_10017ED8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10017EF6(HANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context)
sub_10017EF6	proc near		; DATA XREF: .rdata:off_1002BC80o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
phNewWaitObject	= dword	ptr  8
hObject		= dword	ptr  0Ch
Callback	= dword	ptr  10h
Context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+phNewWaitObject]
		push	edi
		mov	edi, ecx
		test	esi, esi
		jnz	short loc_10017F0A

loc_10017F06:				; CODE XREF: sub_10017EF6+31j
		xor	al, al
		jmp	short loc_10017F51
; ---------------------------------------------------------------------------

loc_10017F0A:				; CODE XREF: sub_10017EF6+Ej
		and	[ebp+phNewWaitObject], 0
		lea	eax, [ebp+phNewWaitObject]
		push	0		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	[ebp+Context]	; Context
		push	[ebp+Callback]	; Callback
		push	[ebp+hObject]	; hObject
		push	eax		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jz	short loc_10017F06
		mov	eax, [ebp+phNewWaitObject]
		mov	[ebp+var_8], esi
		lea	esi, [edi+0Ch]
		push	esi		; lpCriticalSection
		mov	[ebp+var_4], eax
		call	ds:EnterCriticalSection
		lea	eax, [ebp+var_8]
		push	eax
		lea	ecx, [edi+4]
		call	sub_1000FDA5
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_10017F51:				; CODE XREF: sub_10017EF6+12j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10017EF6	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017F59	proc near		; DATA XREF: .rdata:1002BC84o

var_5		= byte ptr -5
lpCriticalSection= dword ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		mov	ebp, ecx
		test	ebx, ebx
		jnz	short loc_10017F6B
		xor	al, al
		jmp	short loc_10017FDC
; ---------------------------------------------------------------------------

loc_10017F6B:				; CODE XREF: sub_10017F59+Cj
		lea	eax, [ebp+0Ch]
		push	edi
		push	eax		; lpCriticalSection
		mov	[esp+18h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		mov	eax, [ebp+4]
		mov	[esp+14h+var_5], 1
		mov	edi, [eax]
		cmp	edi, eax
		jz	short loc_10017FCD
		push	esi

loc_10017F89:				; CODE XREF: sub_10017F59+71j
		cmp	[edi+8], ebx
		jnz	short loc_10017FC5
		mov	eax, [edi+4]
		mov	ebx, [edi+0Ch]
		mov	esi, [edi]
		push	edi
		mov	[eax], esi
		mov	ecx, [edi]
		mov	eax, [edi+4]
		mov	[ecx+4], eax
		dec	dword ptr [ebp+8]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		push	0FFFFFFFFh	; CompletionEvent
		push	ebx		; WaitHandle
		mov	edi, esi
		call	ds:UnregisterWaitEx
		mov	ebx, [esp+18h+arg_0]
		test	eax, eax
		setnz	al
		and	[esp+18h+var_5], al
		jmp	short loc_10017FC7
; ---------------------------------------------------------------------------

loc_10017FC5:				; CODE XREF: sub_10017F59+33j
		mov	edi, [edi]

loc_10017FC7:				; CODE XREF: sub_10017F59+6Aj
		cmp	edi, [ebp+4]
		jnz	short loc_10017F89
		pop	esi

loc_10017FCD:				; CODE XREF: sub_10017F59+2Dj
		push	[esp+14h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, [esp+14h+var_5]
		pop	edi

loc_10017FDC:				; CODE XREF: sub_10017F59+10j
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	4
sub_10017F59	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017FE3	proc near		; CODE XREF: sub_10007E9F+3p
		push	esi
		mov	esi, ecx
		lea	eax, [esi+0Ch]
		mov	dword ptr [esi], offset	off_1002BC80
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		lea	ecx, [esi+4]
		call	sub_10008CED
		mov	dword ptr [esi], offset	off_1002BC8C
		pop	esi
		retn
sub_10017FE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018006	proc near		; CODE XREF: sub_10018169+64p
					; sub_1001826B+28p

var_10		= byte ptr -10h
var_4		= dword	ptr -4

		sub	esp, 10h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	ebp, ecx
		mov	esi, offset a??_2 ; "\\??\\"
		push	edi
		mov	ecx, esi
		xor	ebx, ebx
		call	sub_10001ADC
		push	eax
		push	esi
		push	4
		push	ebx
		mov	ecx, ebp
		call	sub_10003F01
		test	eax, eax
		jnz	short loc_1001803B
		push	4
		pop	ebx

loc_1001803B:				; CODE XREF: sub_10018006+30j
		mov	esi, offset aPipe ; "pipe\\"
		lea	edi, [esp+20h+var_10]
		lea	ecx, [esp+20h+var_10]
		movsd
		movsd
		movsd
		call	sub_10001ADC
		push	eax
		lea	eax, [esp+24h+var_10]
		mov	ecx, ebp
		push	eax
		push	5
		push	ebx
		call	sub_10003F01
		mov	ecx, [esp+20h+var_4]
		neg	eax
		pop	edi
		pop	esi
		pop	ebp
		sbb	eax, eax
		pop	ebx
		xor	ecx, esp
		inc	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10h
		retn
sub_10018006	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018078	proc near		; CODE XREF: sub_1000BC30+ACp
					; sub_1001279A+40p

phkResult	= dword	ptr -28h
dwDisposition	= dword	ptr -24h
Dst		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		xor	ebx, ebx
		mov	ebp, ecx
		push	edi
		mov	edi, ebx

loc_10018090:				; CODE XREF: sub_10018078+3Aj
		mov	esi, ds:off_1002B9E0[edi*8]
		mov	ecx, esi
		call	sub_10001ADC
		push	eax
		push	ebx
		push	esi
		lea	ecx, [esp+48h+arg_0]
		call	sub_100036C4
		test	eax, eax
		jz	short loc_100180B9
		inc	edi
		cmp	edi, 9
		jb	short loc_10018090
		jmp	loc_10018146
; ---------------------------------------------------------------------------

loc_100180B9:				; CODE XREF: sub_10018078+34j
		lea	eax, [esp+3Ch+dwDisposition]
		push	eax		; lpdwDisposition
		lea	eax, [esp+40h+phkResult]
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	2000000h	; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		push	ebx		; Reserved
		push	offset Src	; lpSubKey
		push	ds:hKey[edi*8]	; hKey
		call	ds:RegCreateKeyExW
		test	eax, eax
		jnz	short loc_10018146
		mov	ecx, [esp+3Ch+phkResult]
		mov	edx, ebp
		call	sub_10018724
		push	[esp+3Ch+phkResult] ; hKey
		mov	bl, al
		call	ds:RegCloseKey
		test	bl, bl
		jz	short loc_10018144
		mov	edx, ds:off_1002B9E0[edi*8]
		xor	esi, esi
		lea	ecx, [edx+2]

loc_10018109:				; CODE XREF: sub_10018078+9Aj
		mov	ax, [edx]
		add	edx, 2
		cmp	ax, si
		jnz	short loc_10018109
		sub	edx, ecx
		lea	eax, [esp+3Ch+Dst]
		push	0FFFFFFFFh	; int
		sar	edx, 1
		lea	ecx, [esp+40h+arg_0] ; int
		push	edx		; int
		push	eax		; Dst
		call	sub_100035A2
		push	0FFFFFFFFh
		push	esi
		push	eax
		mov	ecx, ebp
		call	sub_100032E1
		push	esi
		push	1
		lea	ecx, [esp+44h+Dst]
		call	sub_100022FA
		mov	bl, 1
		jmp	short loc_10018148
; ---------------------------------------------------------------------------

loc_10018144:				; CODE XREF: sub_10018078+83j
		xor	ebx, ebx

loc_10018146:				; CODE XREF: sub_10018078+3Cj
					; sub_10018078+68j
		xor	esi, esi

loc_10018148:				; CODE XREF: sub_10018078+CAj
		push	esi
		push	1
		lea	ecx, [esp+44h+arg_0]
		call	sub_100022FA
		mov	ecx, [esp+3Ch+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10018078	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018169	proc near		; CODE XREF: sub_1000B9C1+15p

Dst		= byte ptr -34h
lpFileName	= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		push	ecx
		lea	ecx, [ebp+lpFileName]
		mov	edi, edx
		call	sub_1000388D
		mov	esi, offset a??_2 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001ADC
		push	eax
		push	esi
		push	4
		xor	ebx, ebx
		lea	ecx, [ebp+lpFileName]
		push	ebx
		call	sub_10003F01
		test	eax, eax
		jnz	short loc_100181CA
		push	0FFFFFFFFh	; int
		push	4		; int
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		lea	ecx, [ebp+lpFileName] ;	int
		call	sub_100035A2
		push	eax		; Src
		lea	ecx, [ebp+lpFileName]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA

loc_100181CA:				; CODE XREF: sub_10018169+3Bj
		lea	ecx, [ebp+lpFileName]
		call	sub_10018006
		test	al, al
		jz	short loc_100181DA

loc_100181D6:				; CODE XREF: sub_10018169+DDj
		mov	[edi], bl
		jmp	short loc_1001824B
; ---------------------------------------------------------------------------

loc_100181DA:				; CODE XREF: sub_10018169+6Bj
		or	eax, 0FFFFFFFFh

loc_100181DD:				; CODE XREF: sub_10018169+DBj
		push	eax		; int
		push	ebx		; int
		lea	eax, [ebp+Dst]
		push	eax		; Dst
		lea	ecx, [ebp+lpFileName] ;	int
		call	sub_100035A2
		push	eax		; Src
		lea	ecx, [ebp+lpFileName]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [ebp+Dst]
		call	sub_100022FA
		cmp	[ebp+var_8], 8
		mov	eax, [ebp+lpFileName]
		jnb	short loc_1001820B
		lea	eax, [ebp+lpFileName]

loc_1001820B:				; CODE XREF: sub_10018169+9Dj
		push	eax		; lpFileName
		call	ds:GetFileAttributesW
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10018230
		call	ds:GetLastError
		mov	esi, eax
		cmp	esi, 2
		jz	short loc_10018237
		cmp	esi, 3
		jz	short loc_10018237
		cmp	esi, 7Bh
		jnz	short loc_1001824D
		jmp	short loc_10018237
; ---------------------------------------------------------------------------

loc_10018230:				; CODE XREF: sub_10018169+ACj
		test	eax, 400h
		jnz	short loc_10018248

loc_10018237:				; CODE XREF: sub_10018169+B9j
					; sub_10018169+BEj ...
		push	ecx
		push	ecx
		lea	ecx, [ebp+lpFileName]
		call	sub_10018886
		cmp	eax, 2
		ja	short loc_100181DD
		jmp	short loc_100181D6
; ---------------------------------------------------------------------------

loc_10018248:				; CODE XREF: sub_10018169+CCj
		mov	byte ptr [edi],	1

loc_1001824B:				; CODE XREF: sub_10018169+6Fj
		mov	esi, ebx

loc_1001824D:				; CODE XREF: sub_10018169+C3j
		push	ebx
		push	1
		lea	ecx, [ebp+lpFileName]
		call	sub_100022FA
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018169	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001826B	proc near		; CODE XREF: sub_1000B2F0+57p

var_268		= dword	ptr -268h
Str2		= dword	ptr -264h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
Str1		= dword	ptr -24Ch
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
Dst		= byte ptr -234h
DeviceName	= word ptr -21Ch
var_216		= word ptr -216h
TargetPath	= word ptr -214h
var_8		= dword	ptr -8

		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, ecx
		lea	ecx, [esp+27Ch+Str2] ; Dst
		push	edx		; Src
		call	sub_10001C68
		lea	ecx, [esp+27Ch+Str2]
		call	sub_10018006
		xor	ebx, ebx
		test	al, al
		jz	short loc_100182A5
		mov	bl, 1
		jmp	loc_1001847B
; ---------------------------------------------------------------------------

loc_100182A5:				; CODE XREF: sub_1001826B+31j
		xor	eax, eax
		mov	[esp+27Ch+var_238], 7
		lea	edx, [esp+27Ch+Str1]
		mov	[esp+27Ch+var_23C], ebx
		mov	ecx, esi
		mov	word ptr [esp+27Ch+Str1], ax
		call	sub_10018724
		test	al, al
		jz	loc_1001846D
		mov	ecx, [esp+27Ch+var_250]
		mov	eax, [esp+27Ch+Str2]
		mov	edx, eax
		push	8
		pop	ebp
		cmp	ecx, ebp
		jnb	short loc_100182E0
		lea	edx, [esp+27Ch+Str2]

loc_100182E0:				; CODE XREF: sub_1001826B+6Fj
		mov	esi, [esp+27Ch+var_254]
		push	5Ch
		pop	edi
		cmp	[edx+esi*2-2], di
		jnz	short loc_1001831F
		lea	eax, [esi-1]
		push	eax		; int
		push	ebx		; int
		lea	eax, [esp+284h+Dst]
		push	eax		; Dst
		lea	ecx, [esp+288h+Str2] ; int
		call	sub_100035A2
		push	eax		; Src
		lea	ecx, [esp+280h+Str2]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [esp+284h+Dst]
		call	sub_100022FA
		mov	ecx, [esp+27Ch+var_250]
		mov	eax, [esp+27Ch+Str2]

loc_1001831F:				; CODE XREF: sub_1001826B+81j
		cmp	ecx, ebp
		jnb	short loc_10018327
		lea	eax, [esp+27Ch+Str2]

loc_10018327:				; CODE XREF: sub_1001826B+B6j
		mov	ecx, [esp+27Ch+Str1]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_10018335
		lea	ecx, [esp+27Ch+Str1]

loc_10018335:				; CODE XREF: sub_1001826B+C4j
		mov	ebx, ds:_wcsicmp
		push	eax		; Str2
		push	ecx		; Str1
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_1001834C

loc_10018345:				; CODE XREF: sub_1001826B+1F2j
		mov	bl, 1
		jmp	loc_1001846D
; ---------------------------------------------------------------------------

loc_1001834C:				; CODE XREF: sub_1001826B+D8j
		push	1
		xor	eax, eax
		mov	[esp+280h+var_268], 3Ah
		push	eax
		lea	eax, [esp+284h+var_268]
		push	eax
		lea	ecx, [esp+288h+Str2]
		call	sub_100036C4
		mov	edi, eax
		test	edi, edi
		jz	loc_10018469
		cmp	edi, 0FFFFFFFFh
		jz	loc_10018469
		mov	eax, [esp+27Ch+Str2]
		cmp	edi, 1
		jbe	short loc_100183A2
		mov	ecx, eax
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_1001838F
		lea	ecx, [esp+27Ch+Str2]

loc_1001838F:				; CODE XREF: sub_1001826B+11Ej
		push	5Ch
		pop	edx
		cmp	[ecx+edi*2-4], dx
		jz	short loc_100183A2
		xor	edx, edx

loc_1001839B:				; CODE XREF: sub_1001826B+1A1j
		mov	bl, dl
		jmp	loc_1001846D
; ---------------------------------------------------------------------------

loc_100183A2:				; CODE XREF: sub_1001826B+116j
					; sub_1001826B+12Cj
		xor	ecx, ecx
		mov	[esp+27Ch+DeviceName], cx
		mov	dword ptr [esp+27Ch+DeviceName+2], ecx
		mov	[esp+27Ch+var_216], cx
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_100183BC
		lea	eax, [esp+27Ch+Str2]

loc_100183BC:				; CODE XREF: sub_1001826B+14Bj
		mov	eax, [eax+edi*2-2]
		mov	esi, 104h
		mov	dword ptr [esp+27Ch+DeviceName], eax
		lea	eax, [esp+27Ch+TargetPath]
		push	esi		; ucchMax
		push	eax		; lpTargetPath
		lea	eax, [esp+284h+DeviceName]
		push	eax		; lpDeviceName
		call	ds:QueryDosDeviceW
		cmp	eax, 2
		jb	loc_10018463
		cmp	eax, esi
		jz	short loc_10018463
		lea	esi, [esp+27Ch+TargetPath]
		xor	edx, edx
		lea	ecx, [esi+2]

loc_100183F0:				; CODE XREF: sub_1001826B+18Ej
		mov	ax, [esi]
		add	esi, 2
		cmp	ax, dx
		jnz	short loc_100183F0
		mov	eax, [esp+27Ch+var_254]
		sub	esi, ecx
		sub	eax, edi
		sar	esi, 1
		dec	eax
		add	eax, esi
		cmp	eax, [esp+27Ch+var_23C]
		jnz	short loc_1001839B
		mov	eax, [esp+27Ch+Str1]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_1001841C
		lea	eax, [esp+27Ch+Str1]

loc_1001841C:				; CODE XREF: sub_1001826B+1ABj
		push	esi		; MaxCount
		lea	ecx, [esp+280h+TargetPath]
		push	ecx		; Str2
		push	eax		; Str1
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_10018463
		mov	eax, [esp+27Ch+Str2]
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_1001843E
		lea	eax, [esp+27Ch+Str2]

loc_1001843E:				; CODE XREF: sub_1001826B+1CDj
		mov	ecx, [esp+27Ch+Str1]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_1001844C
		lea	ecx, [esp+27Ch+Str1]

loc_1001844C:				; CODE XREF: sub_1001826B+1DBj
		lea	eax, [eax+edi*2]
		add	eax, 2
		push	eax		; Str2
		lea	eax, [ecx+esi*2]
		push	eax		; Str1
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	loc_10018345

loc_10018463:				; CODE XREF: sub_1001826B+172j
					; sub_1001826B+17Aj ...
		xor	eax, eax
		mov	bl, al
		jmp	short loc_1001846F
; ---------------------------------------------------------------------------

loc_10018469:				; CODE XREF: sub_1001826B+100j
					; sub_1001826B+109j
		xor	eax, eax
		mov	bl, al

loc_1001846D:				; CODE XREF: sub_1001826B+5Aj
					; sub_1001826B+DCj ...
		xor	eax, eax

loc_1001846F:				; CODE XREF: sub_1001826B+1FCj
		push	eax
		push	1
		lea	ecx, [esp+284h+Str1]
		call	sub_100022FA

loc_1001847B:				; CODE XREF: sub_1001826B+35j
		xor	eax, eax
		lea	ecx, [esp+27Ch+Str2]
		push	eax
		push	1
		call	sub_100022FA
		mov	ecx, [esp+27Ch+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 26Ch
		retn
sub_1001826B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100184A4	proc near		; CODE XREF: sub_1000B9C1+7p
					; sub_100184A4+15Bp

var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
lpszShortPath	= dword	ptr -68h
var_54		= dword	ptr -54h
Src		= word ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_28		= dword	ptr -28h
Dst		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8

		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, edx
		xor	ebx, ebx
		push	ecx
		lea	ecx, [esp+88h+lpszShortPath]
		mov	[esp+88h+var_6C], ebp
		mov	[esp+88h+var_6D], bl
		call	sub_1000388D
		mov	esi, offset a??_2 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001ADC
		push	eax
		push	esi
		push	4
		push	ebx
		lea	ecx, [esp+94h+lpszShortPath]
		call	sub_10003F01
		test	eax, eax
		jnz	short loc_10018517
		push	0FFFFFFFFh	; int
		push	4		; int
		lea	eax, [esp+8Ch+Dst]
		push	eax		; Dst
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035A2
		push	eax		; Src
		lea	ecx, [esp+88h+lpszShortPath]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+Dst]
		call	sub_100022FA
		mov	[esp+84h+var_6D], 1

loc_10018517:				; CODE XREF: sub_100184A4+44j
		xor	ecx, ecx
		mov	edi, 104h
		push	2
		pop	edx
		mov	eax, edi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		cmp	[esp+88h+var_54], 8
		mov	esi, eax
		mov	eax, [esp+88h+lpszShortPath]
		pop	ecx
		jnb	short loc_10018544
		lea	eax, [esp+84h+lpszShortPath]

loc_10018544:				; CODE XREF: sub_100184A4+9Aj
		push	edi		; cchBuffer
		push	esi		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jb	short loc_1001859E
		push	2
		pop	ebp

loc_10018556:				; CODE XREF: sub_100184A4+F4j
		add	edi, edi
		xor	ecx, ecx
		mov	eax, edi
		mul	ebp
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		mov	ebx, eax
		pop	ecx
		test	esi, esi
		jz	short loc_1001857A
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1001857A:				; CODE XREF: sub_100184A4+CCj
		cmp	[esp+84h+var_54], 8
		mov	esi, ebx
		mov	eax, [esp+84h+lpszShortPath]
		jnb	short loc_1001858B
		lea	eax, [esp+84h+lpszShortPath]

loc_1001858B:				; CODE XREF: sub_100184A4+E1j
		push	edi		; cchBuffer
		push	ebx		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jnb	short loc_10018556
		mov	ebp, [esp+84h+var_6C]

loc_1001859E:				; CODE XREF: sub_100184A4+ADj
		call	ds:GetLastError
		test	ebx, ebx
		jnz	loc_100186A0
		push	2
		pop	ecx
		cmp	eax, ecx
		jz	short loc_100185BD
		cmp	eax, 3
		jz	short loc_100185BD
		cmp	eax, 7Bh
		jnz	short loc_100185CF

loc_100185BD:				; CODE XREF: sub_100184A4+10Dj
					; sub_100184A4+112j
		push	ecx
		push	ecx
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_10018886
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100185D6

loc_100185CF:				; CODE XREF: sub_100184A4+117j
		xor	bl, bl
		jmp	loc_100186F6
; ---------------------------------------------------------------------------

loc_100185D6:				; CODE XREF: sub_100184A4+129j
		push	edi		; int
		xor	ebx, ebx
		lea	eax, [esp+88h+var_38]
		push	ebx		; int
		push	eax		; Dst
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035A2
		push	0FFFFFFFFh	; int
		push	edi		; int
		lea	eax, [esp+8Ch+Dst]
		push	eax		; Dst
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035A2
		lea	edx, [esp+84h+var_38]
		mov	ecx, edx
		call	sub_100184A4
		test	al, al
		jnz	short loc_10018625
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+Dst]
		call	sub_100022FA
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_38]
		call	sub_100022FA
		jmp	loc_100186F6
; ---------------------------------------------------------------------------

loc_10018625:				; CODE XREF: sub_100184A4+162j
		xor	eax, eax
		mov	[esp+84h+var_3C], 7
		mov	[esp+84h+Src], ax
		lea	ecx, [esp+84h+Src]
		mov	eax, [esp+84h+var_10]
		add	eax, [esp+84h+var_28]
		push	eax
		mov	[esp+88h+var_40], ebx
		call	sub_1000321B
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+var_38]
		push	eax
		lea	ecx, [esp+90h+Src]
		call	sub_100032E1
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+Dst]
		push	eax
		lea	ecx, [esp+90h+Src]
		call	sub_100032E1
		lea	eax, [esp+84h+Src]
		push	eax		; Src
		lea	ecx, [esp+88h+lpszShortPath]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+Src]
		call	sub_100022FA
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+Dst]
		call	sub_100022FA
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_38]
		call	sub_100022FA
		jmp	short loc_100186B4
; ---------------------------------------------------------------------------

loc_100186A0:				; CODE XREF: sub_100184A4+102j
		mov	ecx, esi
		call	sub_10001ADC
		push	eax		; int
		push	esi		; Src
		lea	ecx, [esp+8Ch+lpszShortPath] ; Dst
		call	sub_1000233F
		xor	ebx, ebx

loc_100186B4:				; CODE XREF: sub_100184A4+1FAj
		cmp	[esp+84h+var_6D], 0
		jz	short loc_100186E1
		mov	edi, offset a??_2 ; "\\??\\"
		mov	ecx, edi
		call	sub_10001ADC
		push	eax		; int
		push	edi		; Src
		mov	ecx, ebp	; Dst
		call	sub_1000233F
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+lpszShortPath]
		mov	ecx, ebp
		push	eax
		call	sub_100032E1
		jmp	short loc_100186F4
; ---------------------------------------------------------------------------

loc_100186E1:				; CODE XREF: sub_100184A4+215j
		lea	eax, [esp+84h+lpszShortPath]
		cmp	ebp, eax
		jz	short loc_100186F4
		push	0FFFFFFFFh	; int
		push	ebx		; int
		push	eax		; int
		mov	ecx, ebp	; Dst
		call	sub_100023C2

loc_100186F4:				; CODE XREF: sub_100184A4+23Bj
					; sub_100184A4+243j
		mov	bl, 1

loc_100186F6:				; CODE XREF: sub_100184A4+12Dj
					; sub_100184A4+17Cj
		test	esi, esi
		jz	short loc_10018702
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10018702:				; CODE XREF: sub_100184A4+254j
		push	0
		push	1
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_100022FA
		mov	ecx, [esp+84h+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
sub_100184A4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018724	proc near		; CODE XREF: sub_10011C50+Bp
					; sub_10018078+70p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
Dst		= dword	ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	[esp+20h+Dst], edx
		mov	ebp, ecx
		xor	ebx, ebx
		lea	edx, [esp+20h+var_10]
		push	edi
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		mov	[esp+24h+var_10], ebx
		call	sub_1001881C
		push	8
		pop	ecx
		lea	eax, [esp+24h+var_14]
		mov	[esp+24h+var_14], ecx
		push	eax
		push	ecx
		lea	edi, [esp+2Ch+var_8]
		mov	eax, edi
		push	eax
		push	1
		push	ebp
		call	[esp+38h+var_10]
		mov	esi, ebx
		cmp	[esp+24h+var_14], ebx
		jz	short loc_10018787
		push	[esp+24h+var_14]
		call	sub_10018CA2
		pop	ecx
		mov	edi, eax
		lea	eax, [esp+24h+var_14]
		push	eax
		push	[esp+28h+var_14]
		mov	esi, edi
		push	edi
		push	1
		push	ebp
		call	[esp+38h+var_10]

loc_10018787:				; CODE XREF: sub_10018724+42j
		test	eax, eax
		jnz	short loc_1001879F
		movzx	eax, word ptr [edi]
		mov	ecx, [esp+24h+Dst] ; Dst
		shr	eax, 1
		push	eax		; int
		push	dword ptr [edi+4] ; Src
		call	sub_1000233F
		mov	bl, 1

loc_1001879F:				; CODE XREF: sub_10018724+65j
		test	esi, esi
		jz	short loc_100187AB
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100187AB:				; CODE XREF: sub_10018724+7Dj
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 14h
		retn
sub_10018724	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100187B5@<eax>(HANDLE hProcess@<ecx>, LPVOID lpAddress@<edx>, LPCVOID lpBuffer, SIZE_T dwSize)
sub_100187B5	proc near		; CODE XREF: sub_100156B4+E1p

flOldProtect	= dword	ptr -8
NumberOfBytesWritten= dword ptr	-4
lpBuffer	= dword	ptr  4
dwSize		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+10h+dwSize]
		lea	eax, [esp+10h+flOldProtect]
		push	edi
		push	eax		; lpflOldProtect
		push	8		; flNewProtect
		push	esi		; dwSize
		mov	edi, edx
		mov	ebp, ecx
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualProtectEx
		test	eax, eax
		jnz	short loc_100187DA
		xor	al, al
		jmp	short loc_10018816
; ---------------------------------------------------------------------------

loc_100187DA:				; CODE XREF: sub_100187B5+1Fj
		push	ebx
		lea	eax, [esp+18h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[esp+20h+lpBuffer] ; lpBuffer
		push	edi		; lpBaseAddress
		push	ebp		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_100187FB
		cmp	esi, [esp+18h+NumberOfBytesWritten]
		jnz	short loc_100187FB
		mov	bl, 1
		jmp	short loc_100187FD
; ---------------------------------------------------------------------------

loc_100187FB:				; CODE XREF: sub_100187B5+3Aj
					; sub_100187B5+40j
		xor	bl, bl

loc_100187FD:				; CODE XREF: sub_100187B5+44j
		lea	eax, [esp+18h+flOldProtect]
		push	eax		; lpflOldProtect
		push	[esp+1Ch+flOldProtect] ; flNewProtect
		push	esi		; dwSize
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualProtectEx
		neg	eax
		sbb	al, al
		and	al, bl
		pop	ebx

loc_10018816:				; CODE XREF: sub_100187B5+23j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_100187B5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1001881C(LPCSTR lpProcName)
sub_1001881C	proc near		; CODE XREF: sub_1000B2F0+19p
					; sub_1000B85F+25p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		cmp	hModule, 0
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	ebx, ecx
		jnz	short loc_1001886B
		push	offset aNtdll_dll_4 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		mov	esi, eax
		mov	[ebp+var_8], offset off_1001AA20
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_4], esi
		call	sub_100058C0
		test	al, al
		jnz	short loc_10018856
		int	3		; Trap to Debugger

loc_10018856:				; CODE XREF: sub_1001881C+37j
		mov	ecx, offset hModule
		xor	eax, eax
		lock cmpxchg [ecx], esi
		cmp	hModule, 0
		jnz	short loc_1001886B
		int	3		; Trap to Debugger

loc_1001886B:				; CODE XREF: sub_1001881C+14j
					; sub_1001881C+4Cj
		push	ebx		; lpProcName
		push	hModule		; hModule
		call	ds:GetProcAddress
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_1001887F
		int	3		; Trap to Debugger

loc_1001887F:				; CODE XREF: sub_1001881C+60j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001881C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018886	proc near		; CODE XREF: sub_10018169+D3p
					; sub_100184A4+11Fp

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edx, ecx
		push	5Ch
		pop	ebp
		mov	[esp+14h+var_4], ebp
		mov	eax, [edx+10h]
		cmp	eax, 1
		jb	short loc_10018906
		dec	eax
		cmp	eax, 0FFFFFFFFh
		jbe	short loc_100188A5
		or	eax, 0FFFFFFFFh

loc_100188A5:				; CODE XREF: sub_10018886+1Aj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_100188AD
		mov	ecx, [edx]

loc_100188AD:				; CODE XREF: sub_10018886+23j
		lea	ecx, [ecx+eax*2]

loc_100188B0:				; CODE XREF: sub_10018886+70j
		cmp	[ecx], bp
		jnz	short loc_100188E3
		xor	ebx, ebx
		lea	esi, [esp+14h+var_4]
		inc	ebx
		mov	edi, ecx

loc_100188BE:				; CODE XREF: sub_10018886+47j
		mov	ax, [edi]
		cmp	ax, [esi]
		jnz	short loc_100188D3
		add	edi, 2
		add	esi, 2
		dec	ebx
		jnz	short loc_100188BE
		xor	eax, eax
		jmp	short loc_100188DF
; ---------------------------------------------------------------------------

loc_100188D3:				; CODE XREF: sub_10018886+3Ej
		movzx	eax, word ptr [edi]
		cmp	ax, [esi]
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax

loc_100188DF:				; CODE XREF: sub_10018886+4Bj
		test	eax, eax
		jz	short loc_100188F8

loc_100188E3:				; CODE XREF: sub_10018886+2Dj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_100188ED
		mov	eax, [edx]
		jmp	short loc_100188EF
; ---------------------------------------------------------------------------

loc_100188ED:				; CODE XREF: sub_10018886+61j
		mov	eax, edx

loc_100188EF:				; CODE XREF: sub_10018886+65j
		cmp	ecx, eax
		jz	short loc_10018906
		sub	ecx, 2
		jmp	short loc_100188B0
; ---------------------------------------------------------------------------

loc_100188F8:				; CODE XREF: sub_10018886+5Bj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10018900
		mov	edx, [edx]

loc_10018900:				; CODE XREF: sub_10018886+76j
		sub	ecx, edx
		sar	ecx, 1
		jmp	short loc_10018909
; ---------------------------------------------------------------------------

loc_10018906:				; CODE XREF: sub_10018886+14j
					; sub_10018886+6Bj
		or	ecx, 0FFFFFFFFh

loc_10018909:				; CODE XREF: sub_10018886+7Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ecx
		pop	ebx
		pop	ecx
		retn	8
sub_10018886	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10018913(HANDLE handle)
sub_10018913	proc near		; CODE XREF: sub_10018947+1Dp
					; sub_100189A5+81p

ppDacl		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		xor	esi, esi
		mov	dword ptr [edx], 0Ch
		lea	eax, [edx+4]
		mov	[edx+8], esi
		push	eax		; ppSecurityDescriptor
		push	esi		; ppSacl
		lea	eax, [ebp+ppDacl]
		mov	[ebp+ppDacl], esi
		push	eax		; ppDacl
		push	esi		; ppsidGroup
		push	esi		; ppsidOwner
		push	4		; SecurityInfo
		push	7		; ObjectType
		push	ecx		; handle
		call	ds:GetSecurityInfo
		neg	eax
		pop	esi
		sbb	al, al
		inc	al
		mov	esp, ebp
		pop	ebp
		retn
sub_10018913	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018947	proc near		; CODE XREF: sub_10014854:loc_1001489Cp

sa		= _SECURITY_ATTRIBUTES ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		xor	esi, esi
		mov	[ebp+sa.nLength], esi
		mov	[ebp+sa.lpSecurityDescriptor], esi
		mov	[ebp+sa.bInheritHandle], esi
		call	ds:GetProcessWindowStation
		lea	edx, [ebp+sa]
		mov	ecx, eax	; handle
		call	sub_10018913
		test	al, al
		jnz	short loc_10018972
		push	0Ch
		pop	eax
		jmp	short loc_100189A0
; ---------------------------------------------------------------------------

loc_10018972:				; CODE XREF: sub_10018947+24j
		lea	eax, [ebp+sa]
		push	eax		; lpsa
		push	80000008h	; dwDesiredAccess
		push	esi		; dwFlags
		push	esi		; lpwinsta
		call	ds:CreateWindowStationW
		push	[ebp+sa.lpSecurityDescriptor] ;	hMem
		mov	hObj, eax
		call	ds:LocalFree
		mov	eax, hObj
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFF4h
		add	eax, 0Ch

loc_100189A0:				; CODE XREF: sub_10018947+29j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10018947	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100189A5(HWINSTA hWinSta)
sub_100189A5	proc near		; CODE XREF: sub_10014854+A1p
					; sub_10014854+113p

sa		= _SECURITY_ATTRIBUTES ptr -98h
lpszDesktop	= dword	ptr -8Ch
var_78		= dword	ptr -78h
pSid		= byte ptr -74h
DstBuf		= word ptr -28h
var_8		= dword	ptr -8

		sub	esp, 98h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+98h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		lea	ecx, [esp+0A4h+lpszDesktop] ; Dst
		push	offset aSbox_alternate ; "sbox_alternate_desktop_"
		call	sub_10001C68
		call	ds:GetCurrentProcessId
		push	eax		; ArgList
		push	offset Format	; "0x%X"
		lea	eax, [esp+0ACh+DstBuf]
		push	10h		; MaxCount
		push	eax		; DstBuf
		call	sub_10018C4E
		add	esp, 10h
		lea	ecx, [esp+0A4h+DstBuf]
		call	sub_10001ADC
		push	eax		; int
		lea	eax, [esp+0A8h+DstBuf]
		push	eax		; Src
		lea	ecx, [esp+0ACh+lpszDesktop]
		call	sub_10003375
		xor	ebp, ebp
		mov	[esp+0A4h+sa.nLength], ebp
		mov	[esp+0A4h+sa.lpSecurityDescriptor], ebp
		mov	[esp+0A4h+sa.bInheritHandle], ebp
		call	ds:GetCurrentThreadId
		push	eax		; dwThreadId
		call	ds:GetThreadDesktop
		lea	edx, [esp+0A4h+sa]
		mov	ecx, eax	; handle
		call	sub_10018913
		test	al, al
		jz	short loc_10018A50
		call	ds:GetProcessWindowStation
		mov	ebx, eax
		test	esi, esi
		jz	short loc_10018A79
		push	esi		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_10018A79
		push	[esp+0A4h+sa.lpSecurityDescriptor] ; hMem
		call	ds:LocalFree

loc_10018A50:				; CODE XREF: sub_100189A5+88j
					; sub_100189A5+11Fj
		push	0Bh

loc_10018A52:				; CODE XREF: sub_100189A5+117j
		pop	esi

loc_10018A53:				; CODE XREF: sub_100189A5+13Fj
		push	ebp
		push	1
		lea	ecx, [esp+0ACh+lpszDesktop]
		call	sub_100022FA
		mov	ecx, [esp+0A4h+var_8]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_10018A79:				; CODE XREF: sub_100189A5+94j
					; sub_100189A5+9Fj
		cmp	[esp+0A4h+var_78], 8
		mov	eax, [esp+0A4h+lpszDesktop]
		jnb	short loc_10018A88
		lea	eax, [esp+0A4h+lpszDesktop]

loc_10018A88:				; CODE XREF: sub_100189A5+DDj
		lea	ecx, [esp+0A4h+sa]
		push	ecx		; lpsa
		push	0E0003h		; dwDesiredAccess
		push	ebp		; dwFlags
		push	ebp		; pDevmode
		push	ebp		; lpszDevice
		push	eax		; lpszDesktop
		call	ds:CreateDesktopW
		push	[esp+0A4h+sa.lpSecurityDescriptor] ; hMem
		mov	handle,	eax
		call	ds:LocalFree
		test	esi, esi
		jz	short loc_10018ABE
		push	ebx		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_10018ABE
		push	0Dh
		jmp	short loc_10018A52
; ---------------------------------------------------------------------------

loc_10018ABE:				; CODE XREF: sub_100189A5+108j
					; sub_100189A5+113j
		cmp	handle,	ebp
		jz	short loc_10018A50
		push	ecx
		push	ecx
		push	12h		; WellKnownSidType
		lea	ecx, [esp+0B0h+pSid] ; pSid
		call	sub_1001624D
		mov	ecx, handle	; handle
		push	eax		; pSourceSid
		call	sub_10007988
		add	esp, 0Ch
		mov	esi, ebp
		jmp	loc_10018A53
sub_100189A5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_10018AE9(void *Dst, HANDLE	hObj)
sub_10018AE9	proc near		; CODE XREF: sub_10014854+66p
					; sub_10014854+BBp ...

nLengthNeeded	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	esi		; nLength
		push	esi		; pvInfo
		push	2
		pop	eax
		mov	ebx, edx
		mov	[ebp+nLengthNeeded], esi
		push	eax		; nIndex
		push	ebx		; hObj
		mov	edi, ecx
		mov	[ebp+nLengthNeeded], esi
		call	ds:GetUserObjectInformationW
		mov	eax, [ebp+nLengthNeeded]
		test	eax, eax
		jnz	short loc_10018B23
		mov	dword ptr [edi+14h], 7
		mov	[edi+10h], esi
		mov	[edi], ax
		jmp	short loc_10018B74
; ---------------------------------------------------------------------------

loc_10018B23:				; CODE XREF: sub_10018AE9+29j
		xor	ecx, ecx
		push	2
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CA2
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	[ebp+nLengthNeeded] ; nLength
		push	esi		; pvInfo
		push	2
		pop	eax
		push	eax		; nIndex
		push	ebx		; hObj
		call	ds:GetUserObjectInformationW
		test	eax, eax
		jnz	short loc_10018B60
		and	[edi+10h], eax
		mov	dword ptr [edi+14h], 7
		mov	[edi], ax
		jmp	short loc_10018B68
; ---------------------------------------------------------------------------

loc_10018B60:				; CODE XREF: sub_10018AE9+66j
		push	esi		; Src
		mov	ecx, edi	; Dst
		call	sub_10001C68

loc_10018B68:				; CODE XREF: sub_10018AE9+75j
		test	esi, esi
		jz	short loc_10018B74
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10018B74:				; CODE XREF: sub_10018AE9+38j
					; sub_10018AE9+81j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10018AE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018B7D	proc near		; CODE XREF: sub_100147FF+48p

var_38		= dword	ptr -38h
Src		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Dst		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		mov	edx, hObj	; hObj
		xor	eax, eax
		push	ebx
		push	esi
		push	edi
		mov	edi, handle
		xor	ebx, ebx
		mov	[esp+48h+var_38], ebx
		mov	esi, ecx
		test	edi, edi
		jnz	short loc_10018BBD
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], ebx
		mov	[esi], ax
		jmp	short loc_10018C3A
; ---------------------------------------------------------------------------

loc_10018BBD:				; CODE XREF: sub_10018B7D+2Fj
		mov	[esp+48h+var_20], 7
		mov	[esp+48h+var_24], ebx
		mov	[esp+48h+Src], ax
		test	edx, edx
		jz	short loc_10018BFE
		lea	ecx, [esp+48h+Dst] ; Dst
		call	sub_10018AE9
		push	eax		; Src
		lea	ecx, [esp+4Ch+Src]
		call	sub_10003B23
		push	ebx
		push	1
		lea	ecx, [esp+50h+Dst]
		call	sub_100022FA
		push	5Ch
		push	1
		lea	ecx, [esp+50h+Src]
		call	sub_100030B4

loc_10018BFE:				; CODE XREF: sub_10018B7D+53j
		mov	edx, edi	; hObj
		lea	ecx, [esp+48h+Dst] ; Dst
		call	sub_10018AE9
		push	0FFFFFFFFh
		push	ebx
		push	eax
		lea	ecx, [esp+54h+Src]
		call	sub_100032E1
		push	ebx
		push	1
		lea	ecx, [esp+50h+Dst]
		call	sub_100022FA
		lea	eax, [esp+48h+Src]
		mov	ecx, esi
		push	eax		; Src
		call	sub_1000346E
		push	ebx
		push	1
		lea	ecx, [esp+50h+Src]
		call	sub_100022FA

loc_10018C3A:				; CODE XREF: sub_10018B7D+3Ej
		mov	ecx, [esp+48h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018B7D	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10018C4E(wchar_t *DstBuf, size_t MaxCount, wchar_t *Format, char ArgList)
sub_10018C4E	proc near		; CODE XREF: sub_100189A5+3Dp

DstBuf		= dword	ptr  4
MaxCount	= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= byte ptr  10h

		lea	eax, [esp+ArgList]
		push	eax		; ArgList
		push	[esp+4+Format]	; Format
		push	[esp+8+MaxCount] ; MaxCount
		push	10h		; SizeInWords
		push	[esp+10h+DstBuf] ; DstBuf
		call	ds:_vsnwprintf_s
		add	esp, 14h
		retn
sub_10018C4E	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018CA2	proc near		; CODE XREF: sub_1000632D+2Ep
					; sub_100097E2+72p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	??2@YAPAXI@Z	; operator new(uint)
sub_10018CA2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018CAB	proc near		; CODE XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+Cp
		mov	ecx, [ecx+4]
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		test	eax, eax
		jz	short locret_10018CBF
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

locret_10018CBF:			; CODE XREF: sub_10018CAB+Aj
		retn
sub_10018CAB	endp

; [00000024 BYTES: COLLAPSED FUNCTION std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)]
; [00000028 BYTES: COLLAPSED FUNCTION std::_Facet_Register(std::_Facet_base *)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)]
; [0000000F BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]
; [0000003C BYTES: COLLAPSED FUNCTION ___atonexitinit]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018D8D(_onexit_t Func)
sub_10018D8D	proc near		; CODE XREF: sub_1000D76A+30p
					; sub_10018E36+6p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Ptr		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
Func		= dword	ptr  8

		push	14h
		push	offset stru_1002DFC8
		call	__SEH_prolog4
		and	[ebp+var_24], 0
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10018DBF
		push	[ebp+Func]	; Func
		call	ds:_onexit
		pop	ecx
		jmp	short loc_10018E24
; ---------------------------------------------------------------------------

loc_10018DBF:				; CODE XREF: sub_10018D8D+24j
		push	8
		call	_lock
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	Ptr		; Ptr
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		push	dword_10031FB0	; Ptr
		call	esi ; DecodePointer
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		push	eax
		lea	eax, [ebp+Ptr]
		push	eax
		push	[ebp+Func]	; Ptr
		mov	esi, ds:EncodePointer
		call	esi ; EncodePointer
		push	eax
		call	__dllonexit
		add	esp, 0Ch
		mov	edi, eax
		mov	[ebp+var_24], edi
		push	[ebp+Ptr]	; Ptr
		call	esi ; EncodePointer
		mov	Ptr, eax
		push	[ebp+var_20]	; Ptr
		call	esi ; EncodePointer
		mov	dword_10031FB0,	eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018E2D
; ---------------------------------------------------------------------------

loc_10018E22:				; CODE XREF: sub_10018D8D+A8j
		mov	eax, edi

loc_10018E24:				; CODE XREF: sub_10018D8D+30j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018E2A:				; DATA XREF: .rdata:stru_1002DFC8o
		mov	edi, [ebp+var_24] ; Finally handler 0 for function 10018D8D

loc_10018E2D:				; CODE XREF: sub_10018D8D+90j
		push	8
		call	_unlock
		pop	ecx
		retn
sub_10018D8D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018E36(_onexit_t Func)
sub_10018E36	proc near		; CODE XREF: sub_10001000+5p
					; sub_1000100C+5p ...

Func		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	[ebp+Func]	; Func
		call	sub_10018D8D
		neg	eax
		pop	ecx
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	ebp
		retn
sub_10018E36	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _purecall]
; [00000006 BYTES: COLLAPSED FUNCTION operator delete(void *)]
; [00000006 BYTES: COLLAPSED FUNCTION operator new(uint)]
; [0000004C BYTES: COLLAPSED FUNCTION _pre_c_init]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018EAA	proc near		; CODE XREF: ___DllMainCRTStartup+64p
					; ___DllMainCRTStartup+A3p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	[ebp+arg_4], 0
		push	ebx
		push	esi
		push	edi
		jnz	loc_10018FE5
		mov	eax, dword_10031038
		test	eax, eax
		jle	loc_10018FDE
		dec	eax
		mov	ebx, offset dword_10031FA4
		mov	dword_10031038,	eax
		xor	edi, edi
		mov	eax, large fs:18h
		mov	[ebp+var_4], edi
		mov	edx, [eax+4]
		jmp	short loc_10018EE8
; ---------------------------------------------------------------------------

loc_10018EE4:				; CODE XREF: sub_10018EAA+48j
		cmp	eax, edx
		jz	short loc_10018EF6

loc_10018EE8:				; CODE XREF: sub_10018EAA+38j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_10018EE4
		jmp	short loc_10018EFD
; ---------------------------------------------------------------------------

loc_10018EF6:				; CODE XREF: sub_10018EAA+3Cj
		mov	[ebp+var_4], 1

loc_10018EFD:				; CODE XREF: sub_10018EAA+4Aj
		cmp	dword_10031FA8,	2
		jz	short loc_10018F13
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	loc_10019095
; ---------------------------------------------------------------------------

loc_10018F13:				; CODE XREF: sub_10018EAA+5Aj
		push	Ptr		; Ptr
		call	ds:DecodePointer
		mov	esi, eax
		mov	[ebp+arg_8], esi
		test	esi, esi
		jz	loc_10018FC6
		push	dword_10031FB0	; Ptr
		call	ds:DecodePointer
		mov	ebx, eax
		mov	[ebp+arg_4], esi
		mov	[ebp+arg_0], ebx

loc_10018F40:				; CODE XREF: sub_10018EAA+9Fj
					; sub_10018EAA+AAj ...
		sub	ebx, 4
		cmp	ebx, esi
		jb	short loc_10018FA3
		cmp	[ebx], edi
		jz	short loc_10018F40
		push	edi		; Ptr
		call	ds:EncodePointer
		cmp	[ebx], eax
		jz	short loc_10018F40
		push	dword ptr [ebx]	; Ptr
		call	ds:DecodePointer
		push	edi		; Ptr
		mov	esi, eax
		call	ds:EncodePointer
		mov	[ebx], eax
		call	esi
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		push	dword_10031FB0	; Ptr
		mov	[ebp+var_8], eax
		call	esi ; DecodePointer
		mov	ecx, [ebp+var_8]
		cmp	[ebp+arg_4], ecx
		jnz	short loc_10018F94
		mov	esi, [ebp+arg_8]
		cmp	[ebp+arg_0], eax
		jz	short loc_10018F40

loc_10018F94:				; CODE XREF: sub_10018EAA+E0j
		mov	esi, ecx
		mov	[ebp+arg_4], ecx
		mov	[ebp+arg_8], esi
		mov	ebx, eax
		mov	[ebp+arg_0], eax
		jmp	short loc_10018F40
; ---------------------------------------------------------------------------

loc_10018FA3:				; CODE XREF: sub_10018EAA+9Bj
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10018FB0
		push	esi		; Memory
		call	ds:free
		pop	ecx

loc_10018FB0:				; CODE XREF: sub_10018EAA+FCj
		push	edi		; Ptr
		call	ds:EncodePointer
		mov	dword_10031FB0,	eax
		mov	ebx, offset dword_10031FA4
		mov	Ptr, eax

loc_10018FC6:				; CODE XREF: sub_10018EAA+7Cj
		mov	dword_10031FA8,	edi
		cmp	[ebp+var_4], edi
		jnz	loc_10019095
		xor	eax, eax
		xchg	eax, [ebx]
		jmp	loc_10019095
; ---------------------------------------------------------------------------

loc_10018FDE:				; CODE XREF: sub_10018EAA+19j
					; sub_10018EAA+19Fj
		xor	eax, eax
		jmp	loc_10019098
; ---------------------------------------------------------------------------

loc_10018FE5:				; CODE XREF: sub_10018EAA+Cj
		cmp	[ebp+arg_4], 1
		jnz	loc_10019095
		mov	eax, large fs:18h
		xor	edi, edi
		mov	esi, edi
		mov	ebx, offset dword_10031FA4
		mov	edx, [eax+4]
		jmp	short loc_10019007
; ---------------------------------------------------------------------------

loc_10019003:				; CODE XREF: sub_10018EAA+167j
		cmp	eax, edx
		jz	short loc_10019015

loc_10019007:				; CODE XREF: sub_10018EAA+157j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_10019003
		jmp	short loc_10019018
; ---------------------------------------------------------------------------

loc_10019015:				; CODE XREF: sub_10018EAA+15Bj
		xor	esi, esi
		inc	esi

loc_10019018:				; CODE XREF: sub_10018EAA+169j
		cmp	dword_10031FA8,	edi
		push	2
		pop	edi
		jz	short loc_1001902C
		push	1Fh
		call	_amsg_exit
		jmp	short loc_10019061
; ---------------------------------------------------------------------------

loc_1001902C:				; CODE XREF: sub_10018EAA+177j
		push	offset dword_1001A394
		push	offset dword_1001A388
		mov	dword_10031FA8,	1
		call	_initterm_e
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10018FDE
		push	offset dword_1001A384
		push	offset dword_1001A36C
		call	_initterm
		pop	ecx
		mov	dword_10031FA8,	edi

loc_10019061:				; CODE XREF: sub_10018EAA+180j
		pop	ecx
		test	esi, esi
		jnz	short loc_1001906A
		xor	eax, eax
		xchg	eax, [ebx]

loc_1001906A:				; CODE XREF: sub_10018EAA+1BAj
		cmp	dword_10031FAC,	0
		jz	short loc_1001908F
		push	offset dword_10031FAC
		call	__IsNonwritableInCurrentImage
		pop	ecx
		test	eax, eax
		jz	short loc_1001908F
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_10031FAC

loc_1001908F:				; CODE XREF: sub_10018EAA+1C7j
					; sub_10018EAA+1D6j
		inc	dword_10031038

loc_10019095:				; CODE XREF: sub_10018EAA+64j
					; sub_10018EAA+125j ...
		xor	eax, eax
		inc	eax

loc_10019098:				; CODE XREF: sub_10018EAA+136j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10018EAA	endp

; [00000023 BYTES: COLLAPSED FUNCTION DllEntryPoint]
; [00000133 BYTES: COLLAPSED FUNCTION ___DllMainCRTStartup]
; [0000003D BYTES: COLLAPSED FUNCTION ___raise_securityfailure]
; [000000FB BYTES: COLLAPSED FUNCTION ___report_gsfailure]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]
; [00000023 BYTES: COLLAPSED FUNCTION __except_handler4]
; [00000006 BYTES: COLLAPSED FUNCTION __CppXcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100193E0	proc near		; CODE XREF: __IsNonwritableInCurrentImage+59p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		push	ebx
		push	esi
		push	edi
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		movzx	ebx, word ptr [ecx+6]
		add	eax, 18h
		add	eax, ecx
		test	ebx, ebx
		jz	short loc_1001941C
		mov	edi, [ebp+arg_4]

loc_10019404:				; CODE XREF: sub_100193E0+3Aj
		mov	esi, [eax+0Ch]
		cmp	edi, esi
		jb	short loc_10019414
		mov	ecx, [eax+8]
		add	ecx, esi
		cmp	edi, ecx
		jb	short loc_1001941E

loc_10019414:				; CODE XREF: sub_100193E0+29j
		inc	edx
		add	eax, 28h
		cmp	edx, ebx
		jb	short loc_10019404

loc_1001941C:				; CODE XREF: sub_100193E0+1Fj
		xor	eax, eax

loc_1001941E:				; CODE XREF: sub_100193E0+32j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100193E0	endp

; ---------------------------------------------------------------------------
		align 10h
; [000000BA BYTES: COLLAPSED FUNCTION __IsNonwritableInCurrentImage]
		align 10h
; [00000031 BYTES: COLLAPSED FUNCTION __ValidateImageBase]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019521	proc near		; CODE XREF: DllEntryPoint+9p

PerformanceCount= LARGE_INTEGER	ptr -14h
SystemTimeAsFileTime= _FILETIME	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		mov	eax, ___security_cookie
		push	esi
		push	edi
		mov	edi, 0BB40E64Eh
		mov	esi, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_10019551
		test	esi, eax
		jz	short loc_10019551
		not	eax
		mov	dword_10031004,	eax
		jmp	short loc_100195B7
; ---------------------------------------------------------------------------

loc_10019551:				; CODE XREF: sub_10019521+21j
					; sub_10019521+25j
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	eax, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	eax, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		mov	[ebp+var_4], eax
		call	ds:GetCurrentThreadId
		xor	[ebp+var_4], eax
		call	ds:GetCurrentProcessId
		xor	[ebp+var_4], eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	ecx, dword ptr [ebp+PerformanceCount+4]
		lea	eax, [ebp+var_4]
		xor	ecx, dword ptr [ebp+PerformanceCount]
		xor	ecx, [ebp+var_4]
		xor	ecx, eax
		cmp	ecx, edi
		jnz	short loc_10019599
		mov	ecx, 0BB40E64Fh
		jmp	short loc_100195A9
; ---------------------------------------------------------------------------

loc_10019599:				; CODE XREF: sub_10019521+6Fj
		test	esi, ecx
		jnz	short loc_100195A9
		mov	eax, ecx
		or	eax, 4711h
		shl	eax, 10h
		or	ecx, eax

loc_100195A9:				; CODE XREF: sub_10019521+76j
					; sub_10019521+7Aj
		mov	___security_cookie, ecx
		not	ecx
		mov	dword_10031004,	ecx

loc_100195B7:				; CODE XREF: sub_10019521+2Ej
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10019521	endp

; [00000022 BYTES: COLLAPSED FUNCTION DllMain(x,x,x)]

; =============== S U B	R O U T	I N E =======================================


sub_100195DF	proc near		; CODE XREF: _pre_c_init+2Cp
		push	esi
		push	edi
		mov	esi, offset dword_1002DC68
		mov	edi, offset dword_1002DC68
		jmp	short loc_100195F8
; ---------------------------------------------------------------------------

loc_100195ED:				; CODE XREF: sub_100195DF+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_100195F5
		call	eax

loc_100195F5:				; CODE XREF: sub_100195DF+12j
		add	esi, 4

loc_100195F8:				; CODE XREF: sub_100195DF+Cj
		cmp	esi, edi
		jb	short loc_100195ED
		pop	edi
		pop	esi
		retn
sub_100195DF	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100195FF()
sub_100195FF	proc near		; DATA XREF: _pre_c_init+31o
		push	esi
		push	edi
		mov	esi, offset dword_1002DC70
		mov	edi, offset dword_1002DC70
		jmp	short loc_10019618
; ---------------------------------------------------------------------------

loc_1001960D:				; CODE XREF: sub_100195FF+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10019615
		call	eax

loc_10019615:				; CODE XREF: sub_100195FF+12j
		add	esi, 4

loc_10019618:				; CODE XREF: sub_100195FF+Cj
		cmp	esi, edi
		jb	short loc_1001960D
		pop	edi
		pop	esi
		retn
sub_100195FF	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm_e]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001962C()
sub_1001962C	proc near		; DATA XREF: _pre_c_init+3Bo
		push	offset dword_10031360
		call	__clean_type_info_names_internal
		pop	ecx
		retn
sub_1001962C	endp

; [00000006 BYTES: COLLAPSED FUNCTION _crt_debugger_hook]
; [00000006 BYTES: COLLAPSED FUNCTION __crtUnhandledException]
; [00000006 BYTES: COLLAPSED FUNCTION __crtTerminateProcess]
; [00000006 BYTES: COLLAPSED FUNCTION _except_handler4_common]
; [00000006 BYTES: COLLAPSED FUNCTION __clean_type_info_names_internal]
; [00000006 BYTES: COLLAPSED FUNCTION IsProcessorFeaturePresent]
		align 10h
; [00000048 BYTES: COLLAPSED FUNCTION __SEH_prolog4_GS]
; [0000000F BYTES: COLLAPSED FUNCTION __SEH_epilog4_GS]
		align 10h
; [000000AA BYTES: COLLAPSED FUNCTION __alldiv]
		align 10h
; [00000034 BYTES: COLLAPSED FUNCTION __allmul]
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197C0()
sub_100197C0	proc near		; DATA XREF: sub_10001018o
		mov	off_1003101C, offset off_1001A92C
		retn
sub_100197C0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197CB()
sub_100197CB	proc near		; DATA XREF: sub_1000100Co
		mov	off_10031024, offset off_1001A92C
		retn
sub_100197CB	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197D6()
sub_100197D6	proc near		; DATA XREF: sub_10001000o
		mov	off_10031020, offset off_1001A92C
		retn
sub_100197D6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197E1()
sub_100197E1	proc near		; DATA XREF: sub_10001024+10o
		push	offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		retn
sub_100197E1	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197ED()
sub_100197ED	proc near		; DATA XREF: sub_10001040o
		mov	ecx, offset dword_10031034
		jmp	??1_Fac_tidy_reg_t@std@@QAE@XZ ; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)
sub_100197ED	endp

; ---------------------------------------------------------------------------
		align 10h
		dd 200h	dup(?)
_text		ends

; Section 2. (virtual address 0001A000)
; Virtual size			: 000166BC (  91836.)
; Section size in file		: 00016800 (  92160.)
; Offset to raw	data for section: 00018C00
; Flags	40300040: Data Readable
; Alignment	: 4 bytes
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: sub_10007988+48p
					; sub_10012ACB+240p ...
; LSTATUS __stdcall RegCreateKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD Reserved, LPWSTR	lpClass, DWORD dwOptions, REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult,	LPDWORD	lpdwDisposition)
		extrn RegCreateKeyExW:dword ; CODE XREF: sub_10018078+60p
					; DATA XREF: sub_10018078+60r
; LSTATUS __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_10017D35+1Fp
					; sub_10018078+7Bp
					; DATA XREF: ...
; LSTATUS __stdcall RegOpenKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions,	REGSAM samDesired, PHKEY phkResult)
		extrn RegOpenKeyExW:dword ; CODE XREF: sub_10017D35+12p
					; DATA XREF: sub_10017D35+12r
; BOOL __stdcall RevertToSelf()
		extrn RevertToSelf:dword ; CODE	XREF: sub_10017D76:loc_10017E0Ap
					; DATA XREF: sub_10017D76:loc_10017E0Ar
; LSTATUS __stdcall RegDisablePredefinedCache()
		extrn RegDisablePredefinedCache:dword
					; CODE XREF: sub_10017D76:loc_10017E52p
					; DATA XREF: sub_10017D76:loc_10017E52r
; BOOL __stdcall CreateWellKnownSid(WELL_KNOWN_SID_TYPE	WellKnownSidType, PSID DomainSid, PSID pSid, DWORD *cbSid)
		extrn CreateWellKnownSid:dword ; CODE XREF: sub_1001624D+1Cp
					; DATA XREF: sub_1001624D+1Cr
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: sub_10013C11+53p
					; DATA XREF: sub_10013C11+53r
; BOOL __stdcall GetSecurityDescriptorSacl(PSECURITY_DESCRIPTOR	pSecurityDescriptor, LPBOOL lpbSaclPresent, PACL *pSacl, LPBOOL	lpbSaclDefaulted)
		extrn GetSecurityDescriptorSacl:dword ;	CODE XREF: sub_10013A70+E3p
					; DATA XREF: sub_10013A70+E3r
; BOOL __stdcall ConvertStringSecurityDescriptorToSecurityDescriptorW(LPCWSTR StringSecurityDescriptor,	DWORD StringSDRevision,	PSECURITY_DESCRIPTOR *SecurityDescriptor, PULONG SecurityDescriptorSize)
		extrn ConvertStringSecurityDescriptorToSecurityDescriptorW:dword
					; CODE XREF: sub_10013A70+CAp
					; DATA XREF: sub_10013A70+CAr
; BOOL __stdcall CreateProcessAsUserW(HANDLE hToken, LPCWSTR lpApplicationName,	LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL	bInheritHandles, DWORD dwCreationFlags,	LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessAsUserW:dword ; CODE	XREF: sub_1001789C+D7p
					; DATA XREF: sub_1001789C+D7r
; BOOL __stdcall SetThreadToken(PHANDLE	Thread,	HANDLE Token)
		extrn SetThreadToken:dword ; CODE XREF:	sub_1001789C+149p
					; DATA XREF: sub_1001789C+149r
; BOOL __stdcall LookupPrivilegeValueW(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid)
		extrn LookupPrivilegeValueW:dword ; CODE XREF: sub_1001301A+C6p
					; DATA XREF: sub_1001301A+C6r
; BOOL __stdcall EqualSid(PSID pSid1, PSID pSid2)
		extrn EqualSid:dword	; CODE XREF: sub_10012E18+E8p
					; DATA XREF: sub_10012E18+E8r
; BOOL __stdcall CreateRestrictedToken(HANDLE ExistingTokenHandle, DWORD Flags,	DWORD DisableSidCount, PSID_AND_ATTRIBUTES SidsToDisable, DWORD	DeletePrivilegeCount, PLUID_AND_ATTRIBUTES PrivilegesToDelete, DWORD RestrictedSidCount, PSID_AND_ATTRIBUTES SidsToRestrict, PHANDLE NewTokenHandle)
		extrn CreateRestrictedToken:dword ; CODE XREF: sub_10012ACB+1A2p
					; DATA XREF: sub_10012ACB+1A2r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_10013563+89p
					; sub_10017D76+3Dp
					; DATA XREF: ...
; BOOL __stdcall DuplicateTokenEx(HANDLE hExistingToken, DWORD dwDesiredAccess,	LPSECURITY_ATTRIBUTES lpTokenAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, TOKEN_TYPE TokenType,	PHANDLE	phNewToken)
		extrn DuplicateTokenEx:dword ; CODE XREF: sub_100083D0+1B2p
					; sub_10012ACB+187p
					; DATA XREF: ...
; BOOL __stdcall DuplicateToken(HANDLE ExistingTokenHandle, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, PHANDLE DuplicateTokenHandle)
		extrn DuplicateToken:dword ; CODE XREF:	sub_100083D0+194p
					; sub_10012D92+2Ep
					; DATA XREF: ...
; BOOL __stdcall ConvertStringSidToSidW(LPCWSTR	StringSid, PSID	*Sid)
		extrn ConvertStringSidToSidW:dword ; CODE XREF:	sub_10007A37+11p
					; sub_10007B72+18p ...
; DWORD	__stdcall SetEntriesInAclW(ULONG cCountOfExplicitEntries, PEXPLICIT_ACCESS_W pListOfExplicitEntries, PACL OldAcl, PACL *NewAcl)
		extrn SetEntriesInAclW:dword ; CODE XREF: sub_100078B1+3Bp
					; DATA XREF: sub_100078B1+3Br
; DWORD	__stdcall SetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOwner, PSID psidGroup, PACL pDacl, PACL	pSacl)
		extrn SetSecurityInfo:dword ; CODE XREF: sub_10007988+81p
					; sub_10013A70+F8p
					; DATA XREF: ...
; DWORD	__stdcall GetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID *ppsidOwner, PSID *ppsidGroup, PACL	*ppDacl, PACL *ppSacl, PSECURITY_DESCRIPTOR *ppSecurityDescriptor)
		extrn GetSecurityInfo:dword ; CODE XREF: sub_10007988+33p
					; sub_10018913+23p
					; DATA XREF: ...
; BOOL __stdcall SetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength)
		extrn SetTokenInformation:dword	; CODE XREF: sub_100078FE+5Cp
					; sub_10013C11+64p
					; DATA XREF: ...
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: sub_10007840+25p
					; sub_10007840+5Fp ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_100053AA+74p
					; sub_10005564+1Dp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_10019521+34p
					; DATA XREF: sub_10019521+34r
; BOOL __stdcall QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency)
		extrn QueryPerformanceFrequency:dword ;	CODE XREF: sub_100053AA+58p
					; DATA XREF: sub_100053AA+58r
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn GetModuleHandleW:dword ; CODE XREF: sub_100062AA+48p
					; sub_10006413+3Fp ...
; void __stdcall GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetNativeSystemInfo:dword	; CODE XREF: sub_10006413+12Dp
					; DATA XREF: sub_10006413+12Dr
; BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW	lpVersionInformation)
		extrn GetVersionExW:dword ; CODE XREF: sub_10006413+A1p
					; DATA XREF: sub_10006413+A1r
; BOOL __stdcall CreateProcessW(LPCWSTR	lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessW:dword ; CODE XREF:	sub_10006831+1FDp
					; sub_1001196A+20p
					; DATA XREF: ...
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn SetEvent:dword	; CODE XREF: sub_10006AE8+99p
					; StartAddress+D5p ...
; BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead)
		extrn ReadProcessMemory:dword ;	CODE XREF: sub_10006690+1Fp
					; sub_10006690+4Dp ...
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_10006831+23Cp
					; sub_100177EE+27p
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize)
		extrn GetModuleFileNameW:dword ; CODE XREF: sub_10006831+35p
					; DATA XREF: sub_10006831+35r
; LPVOID __stdcall VirtualAllocEx(HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAllocEx:dword ; CODE XREF:	sub_1000671B+93p
					; sub_1000BE9E+53p ...
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword	; CODE XREF: sub_10006AE8+4Dp
					; StartAddress:loc_1000830Fp
					; DATA XREF: ...
; HANDLE __stdcall CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCWSTR	lpName)
		extrn CreateEventW:dword ; CODE	XREF: sub_1000671B+2Bp
					; sub_1000671B+35p ...
; BOOL __stdcall WriteProcessMemory(HANDLE hProcess, LPVOID lpBaseAddress, LPCVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesWritten)
		extrn WriteProcessMemory:dword ; CODE XREF: sub_10006690+6Bp
					; sub_1000671B+D0p ...
; DWORD	__stdcall SuspendThread(HANDLE hThread)
		extrn SuspendThread:dword ; CODE XREF: sub_10006AE8+8Cp
					; DATA XREF: sub_10006AE8+8Cr
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; CODE XREF: sub_100078FE+68p
					; sub_10007988+6Ep ...
; BOOL __stdcall SetInformationJobObject(HANDLE	hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength)
		extrn SetInformationJobObject:dword ; CODE XREF: sub_100083D0+504p
					; sub_1000E7F5+CDp ...
; BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, PULONG_PTR lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds)
		extrn GetQueuedCompletionStatus:dword ;	CODE XREF: StartAddress+1B9p
					; DATA XREF: StartAddress+1B9r
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_10007FF0+14p
					; sub_100083D0+411p ...
; DWORD	__stdcall GetProcessId(HANDLE Process)
		extrn GetProcessId:dword ; CODE	XREF: sub_10008A71+22p
					; DATA XREF: sub_10008A71+22r
; BOOL __stdcall RegisterWaitForSingleObject(PHANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context, ULONG dwMilliseconds, ULONG dwFlags)
		extrn RegisterWaitForSingleObject:dword	; CODE XREF: sub_10008A71+BEp
					; sub_10017EF6+29p
					; DATA XREF: ...
; BOOL __stdcall PostQueuedCompletionStatus(HANDLE CompletionPort, DWORD dwNumberOfBytesTransferred, ULONG_PTR dwCompletionKey,	LPOVERLAPPED lpOverlapped)
		extrn PostQueuedCompletionStatus:dword ; CODE XREF: sub_10008051+2Cp
					; Callback+Ep
					; DATA XREF: ...
; HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, ULONG_PTR CompletionKey, DWORD NumberOfConcurrentThreads)
		extrn CreateIoCompletionPort:dword ; CODE XREF:	sub_10007FF0+1Fp
					; DATA XREF: sub_10007FF0+1Fr
; BOOL __stdcall TerminateJobObject(HANDLE hJob, UINT uExitCode)
		extrn TerminateJobObject:dword ; CODE XREF: sub_100081BC+13p
					; StartAddress+82p
					; DATA XREF: ...
; BOOL __stdcall UnregisterWaitEx(HANDLE WaitHandle, HANDLE CompletionEvent)
		extrn UnregisterWaitEx:dword ; CODE XREF: sub_10007F05+Ep
					; sub_10017F59+57p
					; DATA XREF: ...
; BOOL __stdcall VirtualFreeEx(HANDLE hProcess,	LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFreeEx:dword ; CODE XREF: sub_1000BE9E+A6p
					; sub_1000DD86+63p
					; DATA XREF: ...
; BOOL __stdcall SetHandleInformation(HANDLE hObject, DWORD dwMask, DWORD dwFlags)
		extrn SetHandleInformation:dword ; CODE	XREF: sub_1000CA8B+186p
					; DATA XREF: sub_1000CA8B+186r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: sub_1000C850+215p
					; DATA XREF: sub_1000C850+215r
; BOOL __stdcall GetProcessHandleCount(HANDLE hProcess,	PDWORD pdwHandleCount)
		extrn GetProcessHandleCount:dword ; CODE XREF: sub_1000CA8B+27p
					; DATA XREF: sub_1000CA8B+27r
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_1000D6C3+43p
					; DATA XREF: sub_1000D6C3+43r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_1000D645+20p
					; sub_1000D645+30p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_1000E01D+33Fp
					; sub_10017752+2Dp ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_1000E01D+12Dp
					; sub_10017752+Ap ...
; HANDLE __stdcall CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes, LPCWSTR lpName)
		extrn CreateJobObjectW:dword ; CODE XREF: sub_1000E7F5+27p
					; DATA XREF: sub_1000E7F5+27r
; BOOL __stdcall AssignProcessToJobObject(HANDLE hJob, HANDLE hProcess)
		extrn AssignProcessToJobObject:dword ; CODE XREF: sub_1001789C+120p
					; DATA XREF: sub_1001789C+120r
; HANDLE __stdcall CreateNamedPipeW(LPCWSTR lpName, DWORD dwOpenMode, DWORD dwPipeMode,	DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize,	DWORD nDefaultTimeOut, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateNamedPipeW:dword ; CODE XREF: sub_1000E953+190p
					; DATA XREF: sub_1000E953+190r
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn lstrlenW:dword	; CODE XREF: sub_1000F29C+1Ep
					; DATA XREF: sub_1000F29C+1Er
; void __stdcall DebugBreak()
		extrn DebugBreak:dword	; CODE XREF: sub_1000F29C+6Ep
					; DATA XREF: sub_1000F29C+6Er
; SIZE_T __stdcall VirtualQueryEx(HANDLE hProcess, LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION	lpBuffer, SIZE_T dwLength)
		extrn VirtualQueryEx:dword ; CODE XREF:	sub_100105BE+4Ap
					; DATA XREF: sub_100105BE+4Ar
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_1001027A+37p
					; DATA XREF: sub_1001027A+37r
; BOOL __stdcall HeapSetInformation(HANDLE HeapHandle, HEAP_INFORMATION_CLASS HeapInformationClass, PVOID HeapInformation, SIZE_T HeapInformationLength)
		extrn HeapSetInformation:dword ; CODE XREF: sub_1001027A+87p
					; DATA XREF: sub_1001027A+87r
; DWORD	__stdcall SearchPathW(LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart)
		extrn SearchPathW:dword	; CODE XREF: sub_100108EE+49p
					; sub_100108EE+76p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentDirectoryW(DWORD nBufferLength, LPWSTR lpBuffer)
		extrn GetCurrentDirectoryW:dword
					; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+D7p
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+14Cp
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10007EBC+22p
					; sub_1001789C+1EAp ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_100150CB+2Bp
					; DATA XREF: sub_100150CB+2Br
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_10014349+Dp
					; DATA XREF: sub_10014349+Dr
; DWORD	__stdcall SignalObjectAndWait(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable)
		extrn SignalObjectAndWait:dword	; CODE XREF: sub_10015A29+39p
					; DATA XREF: sub_10015A29+39r
; HANDLE __stdcall CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName)
		extrn CreateMutexW:dword ; CODE	XREF: sub_10015AD5+45p
					; DATA XREF: sub_10015AD5+45r
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: sub_10017CD2+47p
					; DATA XREF: sub_10017CD2+47r
; BOOL __stdcall ProcessIdToSessionId(DWORD dwProcessId, DWORD *pSessionId)
		extrn ProcessIdToSessionId:dword ; CODE	XREF: sub_1001719D+4Ap
					; DATA XREF: sub_1001719D+4Ar
; BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext)
		extrn GetThreadContext:dword ; CODE XREF: sub_1001789C+16Fp
					; DATA XREF: sub_1001789C+16Fr
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_10017B3A+5Fp
					; DATA XREF: sub_10017B3A+5Fr
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn CreateFileMappingW:dword ; CODE XREF: sub_10017B3A+1Bp
					; DATA XREF: sub_10017B3A+1Br
; DWORD	__stdcall GetFileAttributesW(LPCWSTR lpFileName)
		extrn GetFileAttributesW:dword ; CODE XREF: sub_10018169+A3p
					; DATA XREF: sub_10018169+A3r
; DWORD	__stdcall GetLongPathNameW(LPCWSTR lpszShortPath, LPWSTR lpszLongPath, DWORD cchBuffer)
		extrn GetLongPathNameW:dword ; CODE XREF: sub_100184A4+A3p
					; sub_100184A4+EAp
					; DATA XREF: ...
; DWORD	__stdcall QueryDosDeviceW(LPCWSTR lpDeviceName,	LPWSTR lpTargetPath, DWORD ucchMax)
		extrn QueryDosDeviceW:dword ; CODE XREF: sub_1001826B+169p
					; DATA XREF: sub_1001826B+169r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+29p
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+39p
					; DATA XREF: ...
; BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule)
		extrn DisableThreadLibraryCalls:dword ;	CODE XREF: DllMain(x,x,x)+15p
					; DATA XREF: DllMain(x,x,x)+15r
; BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)
		extrn __imp_IsProcessorFeaturePresent:dword
					; DATA XREF: IsProcessorFeaturePresentr
; PVOID	__stdcall DecodePointer(PVOID Ptr)
		extrn DecodePointer:dword ; CODE XREF: sub_10018D8D+1Cp
					; sub_10018D8D+44p ...
; PVOID	__stdcall EncodePointer(PVOID Ptr)
		extrn EncodePointer:dword ; CODE XREF: ___atonexitinit+1Cp
					; sub_10018D8D+65p ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+85p
					; sub_10005908+Ep ...
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+7Cp
					; sub_10006AE8+22p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_10001B31+27p
					; sub_10001B7E+27p ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: sub_10001BD6+9p
					; sub_10007EBC+3Cp ...
; BOOL __stdcall GetModuleHandleExW(DWORD dwFlags, LPCWSTR lpModuleName, HMODULE *phModule)
		extrn GetModuleHandleExW:dword ; CODE XREF: sub_1000E01D+7Ap
					; sub_1000EE41+39p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_100062AA+5Cp
					; sub_100062AA+69p ...
; BOOL __stdcall InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount)
		extrn InitializeCriticalSectionAndSpinCount:dword
					; CODE XREF: sub_10001024+Ap
					; sub_1000468B+1Ap ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_10004633+48p
					; sub_1000468B+10Ep ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_10004633+2Cp
					; sub_1000468B+DDp ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags,	LPDWORD	lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_10007FF0+47p
					; DATA XREF: sub_10007FF0+47r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_1000616A+2Ep
					; sub_1000671B+56p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_1000457F+11p
					; sub_1000457F:loc_100045E1p ...
; BOOL __stdcall IsDebuggerPresent()
		extrn IsDebuggerPresent:dword ;	CODE XREF: sub_1000457F:loc_100045CEp
					; ___raise_securityfailure+3p
					; DATA XREF: ...
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments)
		extrn RaiseException:dword ; CODE XREF:	sub_10004532+31p
					; DATA XREF: sub_10004532+31r
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_10002F24+16p
					; sub_100047B4+40p
					; DATA XREF: ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_10006831+22Bp
					; sub_10006AE8+36p ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_1000616A+1Fp
					; sub_1000616A+27p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_10008051+C1p
					; sub_100145ED+E5p ...
; BOOL __stdcall VirtualProtectEx(HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flNewProtect,	PDWORD lpflOldProtect)
		extrn VirtualProtectEx:dword ; CODE XREF: sub_1000DE70+170p
					; sub_100187B5+17p ...

;
; Imports from MSVCP120.dll
;
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)r
					; .rdata:1002E910o
; public: virtual __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10006C50+45r
; public: class	std::locale __thiscall std::ios_base::getloc(void)const
		extrn ?getloc@ios_base@std@@QBE?AVlocale@2@XZ:dword
					; CODE XREF: sub_10007665+72p
					; DATA XREF: sub_10007665+72r
; protected: __thiscall	std::basic_ios<char, struct std::char_traits<char>>::basic_ios<char, struct std::char_traits<char>>(void)
		extrn ??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10001C96+15p
					; DATA XREF: sub_10001C96+15r
; public: static unsigned int __cdecl std::ctype<wchar_t>::_Getcat(class std::locale::facet const * *, class std::locale const *)
		extrn ?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z:dword
					; CODE XREF: sub_10007371+6Bp
					; DATA XREF: sub_10007371+6Br
; public: wchar_t __thiscall std::ctype<wchar_t>::widen(char)const
		extrn ?widen@?$ctype@_W@std@@QBE_WD@Z:dword ; CODE XREF: sub_10007665+119p
					; DATA XREF: sub_10007665+119r
; public: __thiscall std::locale::id::operator unsigned	int(void)
		extrn ??Bid@locale@std@@QAEIXZ:dword ; CODE XREF: sub_10007371+24p
					; DATA XREF: sub_10007371+24r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)r
; char const * __cdecl std::_Winerror_map(int)
		extrn ?_Winerror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_100011EC+4p
					; DATA XREF: sub_100011EC+4r
; char const * __cdecl std::_Syserror_map(int)
		extrn ?_Syserror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_10001191+4p
					; sub_10001211+6p
					; DATA XREF: ...
; void __cdecl std::_Xbad_alloc(void)
		extrn ?_Xbad_alloc@std@@YAXXZ:dword ; CODE XREF: sub_10001AB4:loc_10001AD1p
					; sub_10002640:loc_10002661p ...
; void __cdecl std::_Xout_of_range(char	const *)
		extrn ?_Xout_of_range@std@@YAXPBD@Z:dword ; CODE XREF: sub_100017EB+1Ap
					; sub_100023C2+1Ap ...
; void __cdecl std::_Xlength_error(char	const *)
		extrn ?_Xlength_error@std@@YAXPBD@Z:dword ; CODE XREF: sub_1000198C+Fp
					; sub_10002447+12p ...
; __int64 const	std::_BADOFF
		extrn ?_BADOFF@std@@3_JB:dword ; DATA XREF: sub_10001FAA+38r
					; sub_10001FAA+107r ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(unsigned int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z:dword
					; CODE XREF: sub_10003248+3Bp
					; sub_10003248+4Fp
					; DATA XREF: ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z:dword
					; CODE XREF: sub_10014BB5+74p
					; sub_10014BB5+88p ...
; public: __int64 __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::sputn(char const *, __int64)
		extrn ?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z:dword
					; CODE XREF: sub_1000266C+A0p
					; sub_10002830+C2p
					; DATA XREF: ...
; public: void __thiscall std::basic_ostream<char, struct std::char_traits<char>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_10002538+5p
					; DATA XREF: sub_10002538+5r
; public: int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sputc(char)
		extrn ?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z:dword
					; CODE XREF: sub_1000266C+79p
					; sub_1000266C+C9p ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::flush(void)
		extrn ?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_100024E7+34p
					; DATA XREF: sub_100024E7+34r
; protected: __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::basic_streambuf<char, struct	std::char_traits<char>>(void)
		extrn ??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10001C96+43p
					; DATA XREF: sub_10001C96+43r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)r
; protected: char * __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ:dword
					; CODE XREF: sub_10001D73+5Fp
					; sub_10001D73+17Ep
					; DATA XREF: ...
; public: virtual __thiscall std::basic_ostream<char, struct std::char_traits<char>>::~basic_ostream<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10001CF8+2Ar
; public: __thiscall std::basic_ostream<char, struct std::char_traits<char>>::basic_ostream<char, struct std::char_traits<char>>(class std::basic_streambuf<char, struct std::char_traits<char>> *, bool)
		extrn ??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z:dword
					; CODE XREF: sub_10001C96+23p
					; DATA XREF: sub_10001C96+23r
; public: void __thiscall std::basic_ios<char, struct std::char_traits<char>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_1000266C+FFp
					; sub_10002830+126p
					; DATA XREF: ...
; public: virtual __thiscall std::basic_ios<char, struct std::char_traits<char>>::~basic_ios<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; CODE XREF: sub_10003248+8Bp
					; DATA XREF: sub_10001B6A+Er ...
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<char, struct std::char_traits<char>>::imbue(class std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::sync(void)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<char, struct std::char_traits<char>> * __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::setbuf(char *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsputn(char const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsgetn(char *,	__int64)
		extrn __imp_?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::uflow(void)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)r
; public: virtual __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::~basic_streambuf<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10001D28+45r
; public: static class std::locale::id std::ctype<wchar_t>::id
		extrn ?id@?$ctype@_W@std@@2V0locale@2@A:dword ;	DATA XREF: sub_10007371+1Br
; public: __thiscall std::_Lockit::~_Lockit(void)
		extrn ??1_Lockit@std@@QAE@XZ:dword ; CODE XREF:	sub_10007371+98p
					; DATA XREF: sub_10007371+98r
; public: __thiscall std::_Lockit::_Lockit(int)
		extrn ??0_Lockit@std@@QAE@H@Z:dword ; CODE XREF: sub_10007371+10p
					; DATA XREF: sub_10007371+10r
; private: static class	std::locale::_Locimp * __cdecl std::locale::_Getgloballocale(void)
		extrn ?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ:dword
					; CODE XREF: sub_10007371+46p
					; DATA XREF: sub_10007371+46r
; public: __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputn(wchar_t const *, __int64)
		extrn ?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z:dword
					; CODE XREF: sub_10007418+BBp
					; sub_1000754F+9Fp
					; DATA XREF: ...
; public: unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputc(wchar_t)
		extrn ?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z:dword
					; CODE XREF: sub_10007418+88p
					; sub_10007418+E0p ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::flush(void)
		extrn ?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_100072FF+34p
					; DATA XREF: sub_100072FF+34r
; public: void __thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_10007350+5p
					; DATA XREF: sub_10007350+5r
; protected: __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10006BBC+49p
					; DATA XREF: sub_10006BBC+49r
; public: __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> *)
		extrn ??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z:dword
					; CODE XREF: sub_10006BBC+29p
					; DATA XREF: sub_10006BBC+29r
; protected: __thiscall	std::basic_ios<wchar_t,	struct std::char_traits<wchar_t>>::basic_ios<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10006BBC+1Cp
					; DATA XREF: sub_10006BBC+1Cr
; protected: wchar_t * __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ:dword
					; CODE XREF: sub_10006C9B+71p
					; sub_10006C9B+1C8p
					; DATA XREF: ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::pbump(int)
		extrn ?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10006F32+17Dp
					; sub_100070F3+F6p
					; DATA XREF: ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::gbump(int)
		extrn ?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10006E77+34p
					; sub_10006F32+BCp ...
; public: virtual __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::~basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10006C20+2Ar
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(unsigned long)
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z:dword
					; CODE XREF: sub_10006831+16Ep
					; sub_10006831+17Ep
					; DATA XREF: ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(class std::ios_base & (__cdecl *)(class std::ios_base &))
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z:dword
					; CODE XREF: sub_10006831+137p
					; sub_10006831+13Fp
					; DATA XREF: ...
; public: void __thiscall std::basic_ios<wchar_t, struct std::char_traits<wchar_t>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_10007418+11Ep
					; sub_1000754F+FDp ...
; public: virtual __thiscall std::basic_ios<wchar_t, struct std::char_traits<wchar_t>>::~basic_ios<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; CODE XREF: sub_10006831+284p
					; sub_10007838-615p
					; DATA XREF: ...
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<wchar_t, struct	std::char_traits<wchar_t>>::imbue(class	std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale	const &)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> * __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::setbuf(wchar_t *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsputn(wchar_t const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsgetn(wchar_t *, __int64)
		extrn __imp_?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)r

;
; Imports from MSVCR120.dll
;
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
					; .rdata:1002E924o
		extrn _malloc_crt:dword	; CODE XREF: _pre_c_init+6p
					; DATA XREF: _pre_c_init+6r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __imp__initterm_e:dword ;	DATA XREF: _initterm_er
		extrn __imp__crt_debugger_hook:dword ; DATA XREF: _crt_debugger_hookr
		extrn __imp___crtUnhandledException:dword
					; DATA XREF: __crtUnhandledExceptionr
		extrn __imp___crtTerminateProcess:dword	; DATA XREF: __crtTerminateProcessr
		extrn __imp__except_handler4_common:dword
					; DATA XREF: _except_handler4_commonr
		extrn __imp___clean_type_info_names_internal:dword
					; DATA XREF: __clean_type_info_names_internalr
; int __cdecl memcmp(const void	*Buf1, const void *Buf2, size_t	Size)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *Dst, const	void *Src, size_t Size)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *Dst, int Val, size_t Size)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; void *__cdecl	memmove(void *Dst, const void *Src, size_t Size)
		extrn memmove:dword	; CODE XREF: sub_100010F8+Dp
					; sub_10001B16+Dp ...
		extrn __imp__purecall:dword ; DATA XREF: _purecallr
; __declspec(dllimport)	void __cdecl operator delete(void *)
		extrn __imp_??3@YAXPAX@Z:dword ; CODE XREF: sub_10001074+2Bp
					; sub_10001074+45p ...
; __declspec(dllimport)	void * __cdecl operator	new(unsigned int)
		extrn __imp_??2@YAPAXI@Z:dword ; CODE XREF: sub_10001AB4+10p
					; sub_10002640+14p ...
; int __cdecl strnicmp(const char *Str1, const char *Str, size_t MaxCount)
		extrn _strnicmp:dword	; CODE XREF: sub_100056E6+3Ap
					; DATA XREF: sub_100056E6+3Ar
; int __cdecl vscwprintf_p(const wchar_t *Format, va_list ArgList)
		extrn _vscwprintf_p:dword ; CODE XREF: sub_100040C5+33p
					; sub_10004130+5Cp
					; DATA XREF: ...
; int __cdecl vswprintf_p(wchar_t *DstBuf, size_t MaxCount, const wchar_t *Format, va_list ArgList)
		extrn _vswprintf_p:dword ; CODE	XREF: sub_100040C5+17p
					; sub_10004130+41p
					; DATA XREF: ...
; void __cdecl free(void *Memory)
		extrn free:dword	; CODE XREF: sub_10006831+26Ap
					; sub_10007840+47p ...
; void *__cdecl	malloc(size_t Size)
		extrn malloc:dword	; CODE XREF: sub_10007840+33p
					; sub_1000C07B+41p ...
; void __cdecl operator	delete[](void *)
		extrn ??_V@YAXPAX@Z:dword ; CODE XREF: sub_1000632D+4Dp
					; sub_100083D0+5B9p ...
; void __cdecl abort()
		extrn abort:dword	; CODE XREF: sub_10007371+78p
					; DATA XREF: sub_10007371+78r
; wchar_t *__cdecl wcsdup(const	wchar_t	*Str)
		extrn _wcsdup:dword	; CODE XREF: sub_10006831+1B1p
					; sub_10011B9D+3Fp ...
; char *__cdecl	getenv(const char *VarName)
		extrn getenv:dword	; CODE XREF: sub_100083D0+3A5p
					; DATA XREF: sub_100083D0+3A5r
; int __cdecl wcsnicmp(const wchar_t *Str1, const wchar_t *Str2, size_t	MaxCount)
		extrn _wcsnicmp:dword	; CODE XREF: sub_1000B390+4Ep
					; sub_1001826B+1B8p
					; DATA XREF: ...
		extrn wmemcpy_s:dword	; CODE XREF: sub_1000C16A+23p
					; DATA XREF: sub_1000C16A+23r
		extrn rand_s:dword	; CODE XREF: sub_1000D7E3+4Fp
					; sub_100105BE+1Ep
					; DATA XREF: ...
; errno_t __cdecl memcpy_s(void	*Dst, rsize_t DstSize, const void *Src,	rsize_t	MaxCount)
		extrn memcpy_s:dword	; CODE XREF: sub_1000E386+23p
					; DATA XREF: sub_1000E386+23r
; int __cdecl wcsicmp(const wchar_t *Str1, const wchar_t *Str2)
		extrn _wcsicmp:dword	; CODE XREF: sub_1001826B+D2p
					; sub_1001826B+1ECp
					; DATA XREF: ...
; int __cdecl vsnwprintf_s(wchar_t *DstBuf, size_t SizeInWords,	size_t MaxCount, const wchar_t *Format,	va_list	ArgList)
		extrn _vsnwprintf_s:dword ; CODE XREF: sub_10018C4E+13p
					; DATA XREF: sub_10018C4E+13r
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _calloc_crt:dword	; CODE XREF: ___atonexitinit+11p
					; DATA XREF: ___atonexitinit+11r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; _onexit_t __cdecl onexit(_onexit_t Func)
		extrn _onexit:dword	; CODE XREF: sub_10018D8D+29p
					; DATA XREF: sub_10018D8D+29r
		extrn __imp___CppXcptFilter:dword ; DATA XREF: __CppXcptFilterr

;
; Imports from USER32.dll
;
; HWINSTA __stdcall CreateWindowStationW(LPCWSTR lpwinsta, DWORD dwFlags, ACCESS_MASK dwDesiredAccess, LPSECURITY_ATTRIBUTES lpsa)
		extrn CreateWindowStationW:dword ; CODE	XREF: sub_10018947+36p
					; DATA XREF: sub_10018947+36r ...
; BOOL __stdcall CloseDesktop(HDESK hDesktop)
		extrn CloseDesktop:dword ; CODE	XREF: sub_1001499B+Ap
					; DATA XREF: sub_1001499B+Ar
; BOOL __stdcall CloseWindowStation(HWINSTA hWinSta)
		extrn CloseWindowStation:dword ; CODE XREF: sub_1001499B+21p
					; DATA XREF: sub_1001499B+21r
; HDESK	__stdcall CreateDesktopW(LPCWSTR lpszDesktop, LPCWSTR lpszDevice, DEVMODEW *pDevmode, DWORD dwFlags, ACCESS_MASK dwDesiredAccess, LPSECURITY_ATTRIBUTES	lpsa)
		extrn CreateDesktopW:dword ; CODE XREF:	sub_100189A5+F1p
					; DATA XREF: sub_100189A5+F1r
; BOOL __stdcall SetProcessWindowStation(HWINSTA hWinSta)
		extrn SetProcessWindowStation:dword ; CODE XREF: sub_100189A5+97p
					; sub_100189A5+10Bp
					; DATA XREF: ...
; HDESK	__stdcall GetThreadDesktop(DWORD dwThreadId)
		extrn GetThreadDesktop:dword ; CODE XREF: sub_100189A5+75p
					; DATA XREF: sub_100189A5+75r
; BOOL __stdcall GetUserObjectInformationW(HANDLE hObj,	int nIndex, PVOID pvInfo, DWORD	nLength, LPDWORD lpnLengthNeeded)
		extrn GetUserObjectInformationW:dword ;	CODE XREF: sub_10018AE9+1Ep
					; sub_10018AE9+5Ep
					; DATA XREF: ...
; HWINSTA __stdcall GetProcessWindowStation()
		extrn GetProcessWindowStation:dword ; CODE XREF: sub_10018947+12p
					; sub_100189A5+8Ap
					; DATA XREF: ...

;
; Imports from WINMM.dll
;
; DWORD	__stdcall timeGetTime()
		extrn __imp_timeGetTime:dword ;	DATA XREF: timeGetTimer
					; .rdata:1002E8E8o


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	dword public 'DATA' use32
		assume cs:_rdata
		;org 1001A36Ch
dword_1001A36C	dd 0			; DATA XREF: sub_10018EAA+1A6o
		dd offset sub_10001040
		dd offset sub_10001000
		dd offset sub_1000100C
		dd offset sub_10001018
		dd offset sub_10001024
dword_1001A384	dd 0			; DATA XREF: sub_10018EAA+1A1o
dword_1001A388	dd 0			; DATA XREF: sub_10018EAA+187o
		dd offset _pre_c_init
		dd offset ___atonexitinit
dword_1001A394	dd 3 dup(0)		; DATA XREF: sub_10018EAA:loc_1001902Co
; Debug	Directory entries
		dd 0			; Characteristics
		dd 56E8A9D4h		; TimeDateStamp: Wed Mar 16 00:33:24 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 2			; Type:	IMAGE_DEBUG_TYPE_CODEVIEW
		dd 97h			; SizeOfData
		dd rva asc_1002DBA8	; AddressOfRawData
		dd 2C7A8h		; PointerToRawData
		dd 0			; Characteristics
		dd 56E8A9D4h		; TimeDateStamp: Wed Mar 16 00:33:24 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 0Ch			; Type
		dd 14h			; SizeOfData
		dd rva dword_1002DC40	; AddressOfRawData
		dd 2C840h		; PointerToRawData
		dd 0			; Characteristics
		dd 56E8A9D4h		; TimeDateStamp: Wed Mar 16 00:33:24 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 0Ah			; Type:	IMAGE_DEBUG_TYPE_RESERVED10
		dd 4			; SizeOfData
		dd rva dword_1002DC54	; AddressOfRawData
		dd 2C854h		; PointerToRawData
dword_1001A3F4	dd 0			; DATA XREF: ___DllMainCRTStartup:loc_10019102r
					; ___DllMainCRTStartup+A8r ...
off_1001A3F8	dd offset dword_10031040 ; DATA	XREF: ___report_gsfailure+EDo
		dd offset dword_10031090
aGeneric	db 'generic',0          ; DATA XREF: sub_1000118Bo
aUnknownError	db 'unknown error',0    ; DATA XREF: sub_10001191+Fo
					; sub_100011EC+Fo
		align 4
aIostream	db 'iostream',0         ; DATA XREF: sub_100011B6o
		align 4
aIostreamStream	db 'iostream stream error',0 ; DATA XREF: sub_100011BC+Co
		align 4
aSystem		db 'system',0           ; DATA XREF: sub_100011E6o
		align 4
a??PipeChrome_:				; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+D6o
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+E5o
		unicode	0, <\??\pipe\chrome.*>,0
a??PipeGeckoCra:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+FBo
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+10Ao
		unicode	0, <\??\pipe\gecko-crash-server-pipe.*>,0
		align 10h
aSection:				; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+120o
		unicode	0, <Section>,0
a??PipeJpi2_pid:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+164o
		unicode	0, <\??\pipe\jpi2_pid*_pipe*>,0
		align 4
aHkey_current_u:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+131o
					; .rdata:1002B9E8o
		unicode	0, <HKEY_CURRENT_USER>,0
aHkey_current_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+15Ao
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop>,0
aHkey_current_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+17Do
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\LanguageConfigura>
		unicode	0, <tion>,0
		align 8
aHkey_local_mac:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1A0o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide>,0
aHkey_local_m_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1C3o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MUI\Settin>
		unicode	0, <gs>,0
aHkey_current_2:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1E6o
		unicode	0, <HKEY_CURRENT_USER\Software\Policies\Microsoft\Control Pan>
		unicode	0, <el\Desktop>,0
aHkey_current_3:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+209o
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\PreferredUILangua>
		unicode	0, <ges>,0
		align 8
aHkey_local_m_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+22Co
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide\PreferExternalManifest>,0
		align 4
aStringTooLong	db 'string too long',0  ; DATA XREF: sub_1000198C+Ao
					; sub_10002447+Do ...
aInvalidStringP	db 'invalid string position',0 ; DATA XREF: sub_100017EB:loc_10001800o
					; sub_100023C2:loc_100023D7o ...
; Exported entry   5. ??_7SandboxBroker@mozilla@@6B@
		public ??_7SandboxBroker@mozilla@@6B@
; const	mozilla::SandboxBroker::`vftable'
??_7SandboxBroker@mozilla@@6B@ dd offset sub_10001074
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker const	&)+4o
					; mozilla::SandboxBroker::SandboxBroker(void)+3o ...
off_1001A8E4	dd offset sub_10001113	; DATA XREF: .data:off_10031020o
		dd offset sub_1000118B
		dd offset sub_10001191
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A8FC	dd offset sub_10001113	; DATA XREF: .data:off_1003101Co
		dd offset sub_100011E6
		dd offset sub_100011EC
		dd offset sub_10001211
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A914	dd offset sub_10001113	; DATA XREF: .data:off_10031024o
		dd offset sub_100011B6
		dd offset sub_100011BC
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A92C	dd offset sub_10001113	; DATA XREF: sub_10001113+8o
					; sub_100197C0o ...
		dd offset _purecall
		dd offset _purecall
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
dword_1001A944	dd 29h			; DATA XREF: sub_10003248+55o
aVs_		db ' vs. ',0            ; DATA XREF: sub_10003248+41o
		align 10h
asc_1001A950	db ' (',0               ; DATA XREF: sub_10003248+2Do
		align 4
off_1001A954	dd offset sub_1000296F	; DATA XREF: sub_10001C96+2Eo
					; sub_10001CF8+Co
off_1001A958	dd offset sub_10002296	; DATA XREF: sub_10001C96+4Fo
					; sub_10001D28+7o
		dd offset ?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)
		dd offset sub_10001D73
		dd offset sub_10001F07
		dd offset ?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ ; std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)
		dd offset sub_10001F53
		dd offset ?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ; std::basic_streambuf<char,std::char_traits<char>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)
		dd offset ?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)
		dd offset sub_10001FAA
		dd offset sub_1000215D
		dd offset ?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z ; std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)
		dd offset ?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ;	std::basic_streambuf<char,std::char_traits<char>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)
dword_1001A994	dd 0			; DATA XREF: sub_10001C96+Fo
		dd 50h
aDummy:					; DATA XREF: sub_10002977+4o
		unicode	0, <dummy>,0
aHkey_current_4:			; DATA XREF: sub_10002977+23o
		unicode	0, <HKEY_CURRENT_USER\dummy>,0
aBlocked	db 'BLOCKED',0          ; DATA XREF: sub_100029CB+11o
aBrokerAllowed	db 'Broker ALLOWED',0   ; DATA XREF: sub_10002ACE+Fo
		align 10h
aCheckFailedFal	db 'Check failed: false. ',0 ; DATA XREF: sub_10005908+2Co
					; sub_10005952+9Fo ...
		align 4
aUnknown	db 'unknown',0          ; DATA XREF: sub_10002BEF+6o
; char Str[]
Str		db '.thunks',0          ; DATA XREF: sub_10002E78+13o
; char a_syzygy[]
a_syzygy	db '.syzygy',0          ; DATA XREF: sub_10002E78+32o
off_1001AA20	dd offset sub_10002E5A	; DATA XREF: sub_10002E5A+8o
					; sub_10002E78+1Bo ...
off_1001AA24	dd offset sub_100058F3	; DATA XREF: sub_1001410D+41r
aVectorTTooLong	db 'vector<T> too long',0 ; DATA XREF: sub_10003158+1Fo
					; sub_10003759+30o ...
		align 10h
		dd 0C0B0A09h
		db 0Dh,	20h, 0
byte_1001AA47	db 0			; DATA XREF: sub_1000468B+BDo
		dw 9, 0Ah, 0Bh
		dw 0Ch
		dw 0Dh
		unicode	0, < >
		dw 85h
aA		db '',0
		dd 20001680h, 20022001h, 20042003h, 20062005h, 20082007h
		dd 200A2009h, 20292028h, 205F202Fh, 3000h
asc_1001AA7C:				; DATA XREF: sub_100038D1+1Bo
		dw 9, 0Ah, 0Bh
		dw 0Ch
		dw 0Dh
		unicode	0, < >
		dw 85h
aA_0		db '',0
		dd 20001680h, 20022001h, 20042003h, 20062005h, 20082007h
		dd 200A2009h, 20292028h, 205F202Fh, 3000h
		dd offset dword_10031380
off_1001AAB4	dd offset timeGetTime	; DATA XREF: sub_10005320+Er
		dd 1
; const	WCHAR aKernel32_dll_1
aKernel32_dll_1:			; DATA XREF: sub_10007B72+36o
					; sub_10007C0E+35o ...
		unicode	0, <kernel32.dll>,0
		align 4
; const	WCHAR aKernelbase_dll
aKernelbase_dll:			; DATA XREF: sub_10007B72+4Eo
					; sub_10007C0E+4Do ...
		unicode	0, <kernelbase.dll>,0
		align 4
aNtdll_dll:				; DATA XREF: sub_10009C20+9Do
		unicode	0, <ntdll.dll>,0
; wchar_t Str2
Str2:					; DATA XREF: sub_1000B390+48o
		unicode	0, <\Device\>,0
		align 10h
a??_1:					; DATA XREF: sub_1000B9F0+28o
		unicode	0, <\??\>,0
		align 4
dword_1001AB2C	dd 10000h		; DATA XREF: sub_1000D7E3+1Eo
; const	WCHAR aNtdll_dll_0
aNtdll_dll_0:				; DATA XREF: sub_1000DDF9+28o
					; sub_1000DE70+45o ...
		unicode	0, <ntdll.dll>,0
a@:					; DATA XREF: sub_1000DCD1+1Co
					; sub_1001510E+D2o
		unicode	0, <@>,0
aKernel32_dll_0:			; DATA XREF: sub_1000E920+22o
		unicode	0, <kernel32.dll>,0
		align 4
; const	WCHAR aNtdll_dll_1
aNtdll_dll_1:				; DATA XREF: sub_1000EE41+7o
					; sub_1000F0CA+11o
		unicode	0, <ntdll.dll>,0
aKernel32_dll_2:			; DATA XREF: sub_10010A07+3Ao
		unicode	0, <kernel32.dll>,0
		align 4
aNtdll_dll_2:				; DATA XREF: sub_10011CA5+27o
					; sub_10011CA5+43o
		unicode	0, <ntdll.dll>,0
; const	WCHAR aNtdll_dll_3
aNtdll_dll_3:				; DATA XREF: sub_1001541F+17o
		unicode	0, <ntdll.dll>,0
; const	WCHAR aNtdll_dll_5
aNtdll_dll_5:				; DATA XREF: sub_100154C2+1o
		unicode	0, <ntdll.dll>,0
dword_1001ABD0	dd 0Ch dup(0)		; DATA XREF: sub_1001658A+35o
		dd 1, 2, 2 dup(0)
		dd 11h dup(1), 2, 1, 2,	1, 2, 1, 2, 1, 2, 1, 2,	1, 2, 1
		dd 2, 10h dup(0)
dword_1001ACD0	dd 8 dup(0)		; DATA XREF: sub_1001658A+2Co
		dd 100h, 0
		dd 1, 4, 4 dup(0)
dword_1001AD10	dd 8 dup(1), 101h, 8 dup(1), 4,	1, 4, 1, 4, 1, 4, 101h
		dd 4, 1, 4, 1, 4, 1, 4,	11h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSgdt		; "sgdt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSidt		; "sidt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLgdt		; "lgdt"
		align 80h
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLidt		; "lidt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSmsw		; "smsw"
		dd 2Dh dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLmsw		; "lmsw"
		dd 14h dup(0)
		dd 8, 2090000h,	2 dup(0)
		dd offset aInvlpg	; "invlpg"
dword_1001B0A4	dd 14h dup(0)
		dd 8, 80090000h, 2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 77h dup(0)
off_1001B410	dd offset dword_1001B8C0 ; DATA	XREF: sub_1001629B+11r
					; sub_1001630F+41r
byte_1001B414	db 0			; DATA XREF: sub_1001630F+Er
byte_1001B415	db 0FFh			; DATA XREF: sub_1001630F+1Ar
					; sub_1001630F+CBr
byte_1001B416	db 0			; DATA XREF: sub_1001630F+21r
byte_1001B417	db 0FFh			; DATA XREF: sub_1001630F+2Er
		dd offset dword_10024948
		dd 0FF00FF00h
		dd offset dword_10024628
		dd 7000703h
		dd offset dword_1002B6A8
		dd 7000703h
		dd offset dword_10022C60
		dd 7000703h
		dd offset dword_100239A8
		dd 7000703h
		dd offset dword_1002B068
		dd 7000703h
		dd offset dword_10021FE0
		dd 7000703h
		dd offset dword_100232A0
		dd 7000703h
		dd offset dword_10022620
		dd 7000703h
		dd offset dword_10023CC8
		dd 7000703h
		dd offset dword_10022F80
		dd 7000703h
		dd offset dword_10024308
		dd 7000703h
		dd offset dword_1002AD48
		dd 7000703h
		dd offset dword_100235C0
		dd 1000703h
		dd offset dword_10021CC0
		dd 7000703h
		dd offset dword_1001B5A0
		dd 7000703h
		dd offset dword_1001AD10+0C0h
		dd 7000703h
		dd offset dword_1001B0A4+4Ch
		dd 7000703h
		dd offset dword_10022300
		dd 7000703h
		dd offset dword_1002B388
		dd 7000703h
		dd offset dword_10023688
		dd 7000703h
		dd offset dword_10022940
		dd 7000703h
		dd offset dword_10023FE8
		dd 7000703h
		dd offset dword_1001B4D8
		dd 1000703h
dword_1001B4D8	dd 1Ah dup(0)		; DATA XREF: .rdata:1001B4D0o
		dd 8, 9090000h,	2 dup(0)
		dd offset aCmpxch8b	; "cmpxch8b"
		dd 13h dup(0)
dword_1001B5A0	dd 0			; DATA XREF: .rdata:1001B490o
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSldt		; "sldt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aStr		; "str"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLldt		; "lldt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLtr		; "ltr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerr		; "verr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerw		; "verw"
		dd 45h dup(0)
dword_1001B8C0	dd 0			; DATA XREF: .rdata:off_1001B410o
		dd 8, 2040000h,	2060000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		align 80h
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 13h dup(0)
		dd 1, 2, 18h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDaa		; "daa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDas		; "das"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAaa		; "aaa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAas		; "aas"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		align 80h
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushad	; "pushad"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopad	; "popad"
		dd 14h dup(0)
		dd 8, 0D060000h, 1090000h, 0
		dd offset aBound	; "bound"
		dd 14h dup(0)
		dd 8, 0E040000h, 0E060000h, 0
		dd offset aArpl		; "arpl"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 3, 18h dup(0)
		dd 5, 18h dup(0)
		dd 4, 18h dup(0)
		dd 8, 0D070000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0D070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 2070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aInsb		; "insb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aInsd		; "insd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJc		; "jc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJg		; "jg"
		dd 13h dup(0)
		dd 2 dup(2), 2040000h, 2070000h, 15h dup(0)
		dd 3, 2, 0D040000h, 0D070000h, 15h dup(0)
		dd 4, 2, 0D040000h, 2070000h, 15h dup(0)
		dd 5, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXchg		; "xchg"
		align 80h
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E040000h, 0E0E0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 80090000h, 0
		dd offset aLea		; "lea"
		dd 14h dup(0)
		dd 8, 0E0E0000h, 0E040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aNop		; "nop"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCwde		; "cwde"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCdq		; "cdq"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aCallf	; "callf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWait		; "wait"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushfd	; "pushfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopfd	; "popfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSahf		; "sahf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLahf		; "lahf"
		dd 14h dup(0)
		dd 8, 2140000h,	20A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D0A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 20A0000h,	2140000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D0A0000h, 0D140000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aMovsb	; "movsb"
		dd 14h dup(0)
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aMovsd	; "movsd"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aCmpsb	; "cmpsb"
		align 80h
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aCmpsd	; "cmpsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aStosb	; "stosb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aStosd	; "stosd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aLodsb	; "lodsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aLodsd	; "lodsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2130000h, 0
		dd offset aScasb	; "scasb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D130000h, 0
		dd offset aScasd	; "scasd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 13h dup(0)
		dd 6, 2, 2040000h, 2070000h, 15h dup(0)
		dd 7, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRet		; "ret"
		dd 14h dup(0)
		dd 7, 3	dup(0)
		dd offset aRet		; "ret"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLes		; "les"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLds		; "lds"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aMov		; "mov"
		align 80h
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E070000h, 2070000h, 0
		dd offset aEnter	; "enter"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLeave	; "leave"
		dd 14h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 7, 3	dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInt3		; "int3"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aInt		; "int"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInto		; "into"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aIret		; "iret"
		align 80h
		dd 8, 2, 2040000h, 16h dup(0)
		dd 9, 2, 0D040000h, 16h	dup(0)
		dd 0Ah,	2, 2040000h, 16h dup(0)
		dd 0Bh,	2, 0D040000h, 17h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAam		; "aam"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAad		; "aad"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aXlat		; "xlat"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopnz	; "loopnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopz	; "loopz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoop		; "loop"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJcxz		; "jcxz"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		align 80h
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 2140000h,	0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0D140000h, 0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0E140000h, 2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 8, 0E140000h, 0D140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aLock		; "lock:"
		dd 2Dh dup(0)
		dd 3, 3	dup(0)
		dd offset aRepne	; "repne:"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aRep		; "rep:"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aHlt		; "hlt"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCmc		; "cmc"
		dd 13h dup(0)
		dd 0Ch,	2, 2040000h, 16h dup(0)
		dd 0Dh,	2, 0D040000h, 17h dup(0)
		dd 8, 3	dup(0)
		dd offset aClc		; "clc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStc		; "stc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCli		; "cli"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSti		; "sti"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCld		; "cld"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStd		; "std"
		dd 13h dup(0)
		dd 0Eh,	2, 17h dup(0)
		dd 0Fh,	2, 17h dup(0)
dword_10021CC0	dd 0			; DATA XREF: .rdata:1001B488o
		dd 8, 0D040000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 2Ch dup(0)
dword_10021FE0	dd 0			; DATA XREF: .rdata:1001B448o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSar		; "sar"
		align 80h
dword_10022300	dd 33h dup(0)		; DATA XREF: .rdata:1001B4A8o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 19h dup(0)
dword_10022620	dd 0			; DATA XREF: .rdata:1001B458o
		dd 8, 0D040000h, 150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_10022940	dd 0			; DATA XREF: .rdata:1001B4C0o
		dd 8, 3	dup(0)
		dd offset aFxsave	; "fxsave"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aFxrstor	; "fxrstor"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLdmxcsr	; "ldmxcsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStmxcsr	; "stmxcsr"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aLfence	; "lfence"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aMfence	; "mfence"
		align 80h
		dd 8, 3	dup(0)
		dd offset aClflushSfence ; "clflush/sfence"
		dd 13h dup(0)
dword_10022C60	dd 0			; DATA XREF: .rdata:1001B430o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		align 80h
dword_10022F80	dd 0			; DATA XREF: .rdata:1001B468o
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_100232A0	dd 0			; DATA XREF: .rdata:1001B450o
		dd 8, 2040000h,	150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_100235C0	dd 0			; DATA XREF: .rdata:1001B480o
		dd 8, 2040000h,	2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aDec		; "dec"
		dd 13h dup(0)
dword_10023688	dd 33h dup(0)		; DATA XREF: .rdata:1001B4B8o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 4Ch dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		align 8
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
dword_100239A8	dd 0			; DATA XREF: .rdata:1001B438o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_10023CC8	dd 0			; DATA XREF: .rdata:1001B460o
		dd 8, 2040000h,	2140000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_10023FE8	dd 65h dup(0)		; DATA XREF: .rdata:1001B4C8o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtc		; "btc"
		dd 13h dup(0)
dword_10024308	dd 0			; DATA XREF: .rdata:1001B470o
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aMul		; "mul"
		align 80h
		dd 8, 2140000h,	2040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_10024628	dd 0			; DATA XREF: .rdata:1001B420o
		dd 8, 2040000h,	2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_10024948	dd 10h,	2, 17h dup(0)	; DATA XREF: .rdata:1001B418o
		dd 11h,	2, 18h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLar		; "lar"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLsl		; "lsl"
		dd 46h dup(0)
		dd 8, 3	dup(0)
		dd offset aClts		; "clts"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aInvd		; "invd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWbinvd	; "wbinvd"
		dd 31h dup(0)
		dd offset aUd2		; "ud2"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMovsd	; "movsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMovss	; "movss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovupd	; "movupd"
		align 10h
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F110000h, 0F100000h, 0
		dd offset aMovsd	; "movsd"
		dd 0
		dd 8, 0B110000h, 0B100000h, 0
		dd offset aMovss	; "movss"
		dd 0
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovupd	; "movupd"
		dd 0
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 8
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 10h
		dd 8, 9100000h,	0A110000h, 0
		dd offset aMovlpd	; "movlpd"
		align 8
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0Dh dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlpd	; "movlpd"
		dd 0
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpcklps	; "unpcklps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpcklpd	; "unpcklpd"
		align 10h
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpckhps	; "unpckhps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpckhpd	; "unpckhpd"
		dd 0
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 8
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 10h
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhpd	; "movhpd"
		align 8
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0Dh dup(0)
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhpd	; "movhpd"
		dd 12h,	2, 0C7h	dup(0)
		dd 8, 40D0000h,	4020000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 40D0000h,	4030000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 4020000h,	40D0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 4030000h,	40D0000h, 0
		dd offset aMov		; "mov"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovapd	; "movapd"
		align 10h
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovapd	; "movapd"
		dd 0
		dd 8, 8100000h,	90C0000h, 0
		dd offset aCvtpi2ps	; "cvtpi2ps"
		dd 1, 0
		dd 8, 0F100000h, 4040000h, 0
		dd offset aCvtsi2sd	; "cvtsi2sd"
		align 8
		dd 8, 0B100000h, 4040000h, 0
		dd offset aCvtsi2ss	; "cvtsi2ss"
		align 10h
		dd 8, 10100000h, 50C0000h, 0
		dd offset aCvtpi2pd	; "cvtpi2pd"
		align 8
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovntps	; "movntps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovntpd	; "movntpd"
		dd 0
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvttps2pi	; "cvttps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvttsd2si	; "cvttsd2si"
		align 10h
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvttss2si	; "cvttss2si"
		align 8
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvttpd2pi	; "cvttpd2pi"
		align 10h
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvtps2pi	; "cvtps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvtsd2si	; "cvtsd2si"
		dd 0
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvtss2si	; "cvtss2si"
		dd 0
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvtpd2pi	; "cvtpd2pi"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aUcomiss	; "ucomiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aUcomisd	; "ucomisd"
		align 8
		dd 8, 8100000h,	0B110000h, 0
		dd offset aComiss	; "comiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aComisd	; "comisd"
		dd 0
		dd 8, 3	dup(0)
		dd offset aWrmsr	; "wrmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdtsc	; "rdtsc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdmsr	; "rdmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdpmc	; "rdpmc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSysenter	; "sysenter"
		align 80h
		dd 8, 3	dup(0)
		dd offset aSysexit	; "sysexit"
		dd 0AAh	dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMovnti	; "movnti"
		dd 5Fh dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovo	; "cmovo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovno	; "cmovno"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovc	; "cmovc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnc	; "cmovnc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovz	; "cmovz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnz	; "cmovnz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovbe	; "cmovbe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmova	; "cmova"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovs	; "cmovs"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovns	; "cmovns"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpe	; "cmovpe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpo	; "cmovpo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovl	; "cmovl"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovge	; "cmovge"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovle	; "cmovle"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovg	; "cmovg"
		dd 14h dup(0)
		dd 8, 4040000h,	8100000h, 0
		dd offset aMovmskps	; "movmskps"
		dd 1, 0Dh dup(0)
		dd 8, 4040000h,	10100000h, 0
		dd offset aMovmskpd	; "movmskpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aSqrtps	; "sqrtps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSqrtsd	; "sqrtsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSqrtss	; "sqrtss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aSqrtpd	; "sqrtpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aRsqrtps	; "rsqrtps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRsqrtss	; "rsqrtss"
		dd 7 dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aRcpps	; "rcpps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRcpss	; "rcpss"
		dd 7 dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndps	; "andps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndpd	; "andpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndnps	; "andnps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndnpd	; "andnpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aOrps		; "orps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aOrpd		; "orpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aXorps	; "xorps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aXorpd	; "xorpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aAddps	; "addps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aAddsd	; "addsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aAddss	; "addss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aAddpd	; "addpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aMulps	; "mulps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMulsd	; "mulsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMulss	; "mulss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMulpd	; "mulpd"
		dd 0
		dd 8, 10100000h, 8110000h, 0
		dd offset aCvtps2pd	; "cvtps2pd"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aCvtsd2ss	; "cvtsd2ss"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aCvtss2sd	; "cvtss2sd"
		align 10h
		dd 8, 8100000h,	10110000h, 0
		dd offset aCvtpd2ps	; "cvtpd2ps"
		align 8
		dd 8, 8100000h,	5110000h, 0
		dd offset aCvtdq2ps	; "cvtdq2ps"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvttps2dq	; "cvttps2dq"
		dd 0
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvtps2dq	; "cvtps2dq"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aSubps	; "subps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSubsd	; "subsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSubss	; "subss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aSubpd	; "subpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aMinps	; "minps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMinsd	; "minsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMinss	; "minss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMinpd	; "minpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aDivps	; "divps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aDivsd	; "divsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aDivss	; "divss"
		align 10h
		dd 8, 10100000h, 10110000h, 0
		dd offset aDivpd	; "divpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aMaxps	; "maxps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMaxsd	; "maxsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMaxss	; "maxss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMaxpd	; "maxpd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckldq	; "punpckldq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpckldq	; "punpckldq"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		align 10h
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		dd 0
		dd 8, 40B0000h,	4040000h, 0
		dd offset aMovd		; "movd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 0
		dd offset aMovd		; "movd"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 8, 90B0000h,	90C0000h, 2070000h
		dd offset aPshuf	; "pshuf"
		dd 1, 0
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshuflw	; "pshuflw"
		align 10h
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufhw	; "pshufhw"
		align 8
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufd	; "pshufd"
		dd 13h,	2, 17h dup(0)
		dd 14h,	2, 17h dup(0)
		dd 15h,	2, 18h dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		align 8
		dd 8, 3	dup(0)
		dd offset aEmms		; "emms"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 4040000h,	40B0000h, 0
		dd offset aMovd		; "movd"
		dd 1, 7	dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovq		; "movq"
		align 10h
		dd 8, 4040000h,	5100000h, 0
		dd offset aMovd		; "movd"
		align 8
		dd 8, 90C0000h,	90B0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJc		; "jc"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJg		; "jg"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeto		; "seto"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetno	; "setno"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetc		; "setc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnc	; "setnc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetz		; "setz"
		align 80h
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnz	; "setnz"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetbe	; "setbe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeta		; "seta"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSets		; "sets"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetns	; "setns"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpe	; "setpe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpo	; "setpo"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetl		; "setl"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetge	; "setge"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetle	; "setle"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetg		; "setg"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCpuid	; "cpuid"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRsm		; "rsm"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShrd		; "shrd"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShrd		; "shrd"
		dd 13h dup(0)
		dd 16h,	2, 18h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLss		; "lss"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLfs		; "lfs"
		align 80h
		dd 8, 6090000h,	2 dup(0)
		dd offset aLgs		; "lgs"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 3	dup(0)
		dd offset aUd1		; "ud1"
		dd 13h dup(0)
		dd 17h,	2, 18h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtc		; "btc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsf		; "bsf"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsr		; "bsr"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aCmpps	; "cmpps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 2070000h
		dd offset aCmpsd	; "cmpsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 2070000h
		dd offset aCmpss	; "cmpss"
		align 10h
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aCmppd	; "cmppd"
		align 8
		dd 8, 4040000h,	4060000h, 0
		dd offset aMovnti	; "movnti"
		dd 14h dup(0)
		dd 8, 90B0000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		align 10h
		dd 8, 4060000h,	90B0000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 0
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aShufps	; "shufps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aShufpd	; "shufpd"
		dd 18h,	2, 18h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 2Dh dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrld	; "psrld"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddq	; "paddq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddq	; "paddq"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmullw	; "pmullw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmullw	; "pmullw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aUnusedWithoutP ; "unused without prefix"
		dd 1, 0
		dd 8, 90B0000h,	9110000h, 0
		dd offset aMovdq2q	; "movdq2q"
		align 8
		dd 8, 5100000h,	90C0000h, 0
		dd offset aMovq2dq	; "movq2dq"
		align 10h
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovq		; "movq"
		align 8
		dd 8, 4060000h,	90B0000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusb	; "psubusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusb	; "psubusb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminub	; "pminub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminub	; "pminub"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPand		; "pand"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPand		; "pand"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusb	; "paddusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusb	; "paddusb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxub	; "pmaxub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxub	; "pmaxub"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPandn	; "pandn"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPandn	; "pandn"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgb	; "pavgb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgb	; "pavgb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrqw	; "psrqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrad	; "psrad"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgw	; "pavgw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgw	; "pavgw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhw	; "pmulhw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvtpd2dq	; "cvtpd2dq"
		align 8
		dd 8, 10100000h, 5110000h, 0
		dd offset aCvtdq2pd	; "cvtdq2pd"
		align 10h
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvttpd2dq	; "cvttpd2dq"
		align 8
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovntq	; "movntq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovntdq	; "movntdq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsb	; "psubsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsb	; "psubsb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminsw	; "pminsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminsw	; "pminsw"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPor		; "por"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPor		; "por"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsb	; "paddsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsb	; "paddsb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPxor		; "pxor"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPxor		; "pxor"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllw	; "psllw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPslld	; "pslld"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllq	; "psllq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmuludq	; "pmuludq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmuludq	; "pmuludq"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsadbw	; "psadbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsadbw	; "psadbw"
		align 8
		dd 8, 70B0000h,	70C0000h, 0
		dd offset aMaskmovq	; "maskmovq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMaskmovdqu	; "maskmovdqu"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubb	; "psubb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubb	; "psubb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubw	; "psubw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubw	; "psubw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubd	; "psubd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubd	; "psubd"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubq	; "psubq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubq	; "psubq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddb	; "paddb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddb	; "paddb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddw	; "paddw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddw	; "paddw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddd	; "paddd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddd	; "paddd"
		dd 19h dup(0)
dword_1002AD48	dd 0			; DATA XREF: .rdata:1001B478o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aMul		; "mul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_1002B068	dd 0			; DATA XREF: .rdata:1001B440o
		dd 8, 2040000h,	2070000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002B388	dd 33h dup(0)		; DATA XREF: .rdata:1001B4B0o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 19h dup(0)
dword_1002B6A8	dd 0			; DATA XREF: .rdata:1001B428o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
aNtdll_dll_6:				; DATA XREF: sub_10016939+22o
					; sub_10016939+57o
		unicode	0, <ntdll.dll>,0
		align 10h
off_1002B9E0	dd offset aHkey_classes_r ; DATA XREF: sub_10018078:loc_10018090r
					; sub_10018078+85r
					; "HKEY_CLASSES_ROOT"
; HKEY hKey
hKey		dd 80000000h		; DATA XREF: sub_10018078+59r
		dd offset aHkey_current_u ; "HKEY_CURRENT_USER"
		dd 80000001h
		dd offset aHkey_local_m_2 ; "HKEY_LOCAL_MACHINE"
		dd 80000002h
		dd offset aHkey_users	; "HKEY_USERS"
		dd 80000003h
		dd offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		dd 80000004h
		dd offset aHkey_perform_0 ; "HKEY_PERFORMANCE_TEXT"
		dd 80000050h
		dd offset aHkey_perform_1 ; "HKEY_PERFORMANCE_NLSTEXT"
		dd 80000060h
		dd offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		dd 80000005h
		dd offset aHkey_dyn_data ; "HKEY_DYN_DATA"
		dd 80000006h
a??_2:					; DATA XREF: sub_10018006+13o
					; sub_10018169+1Eo ...
		unicode	0, <\??\>,0
		align 4
; const	WCHAR aNtdll_dll_4
aNtdll_dll_4:				; DATA XREF: sub_1001881C+16o
		unicode	0, <ntdll.dll>,0
aBrokerevent	db 'BrokerEvent',0      ; DATA XREF: sub_10004532+13o
					; sub_1000457F+27o ...
aMapSetTTooLong	db 'map/set<T> too long',0 ; DATA XREF: sub_10004F20+1Ao
					; sub_100050E3+1Bo ...
aAuthenticamd	db 'AuthenticAMD',0     ; DATA XREF: sub_10005383+5o
		align 4
aCBuildsMoz2_sl	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_10005908+1Co
					; sub_10005952+91o ...
		db 'y/sandbox/chromium/base/win/scoped_handle.cc',0
		align 4
aListTTooLong	db 'list<T> too long',0 ; DATA XREF: sub_10005F49+3Do
					; sub_10008D20+2Fo ...
		align 4
; const	WCHAR ModuleName
ModuleName:				; DATA XREF: sub_100062AA:loc_100062EDo
					; sub_10006413+38o ...
		unicode	0, <kernel32.dll>,0
		align 4
; CHAR ProcName[]
ProcName	db 'InitializeProcThreadAttributeList',0 ; DATA XREF: sub_100062AA+56o
		align 4
; CHAR aUpdateprocthre[]
aUpdateprocthre	db 'UpdateProcThreadAttribute',0 ; DATA XREF: sub_100062AA+5Eo
		align 4
; CHAR aDeleteprocthre[]
aDeleteprocthre	db 'DeleteProcThreadAttributeList',0 ; DATA XREF: sub_100062AA+6Bo
		align 4
; CHAR aGetproductinfo[]
aGetproductinfo	db 'GetProductInfo',0   ; DATA XREF: sub_10006413+179o
		align 4
; CHAR aIswow64process[]
aIswow64process	db 'IsWow64Process',0   ; DATA XREF: sub_10006413+33o
		align 4
asc_1002BB98	db '\',0                ; DATA XREF: sub_10006831+4Fo
					; sub_10006831+A3o ...
		align 4
asc_1002BB9C	db ' ',0                ; DATA XREF: sub_10007665+FBo
		align 10h
aWow_helper_exe:			; DATA XREF: sub_10006831+15Fo
		unicode	0, <wow_helper.exe" >,0
		align 4
asc_1002BBC4:				; DATA XREF: sub_10006831+145o
		unicode	0, <">,0
dword_1002BBC8	dd 0			; DATA XREF: sub_10006BBC+Fo
		dd 68h
off_1002BBD0	dd offset sub_1000723F	; DATA XREF: sub_10006BBC+58o
					; sub_10006C50+7o
		dd offset ?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)
		dd offset sub_10006C9B
		dd offset sub_10006E77
		dd offset ?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)
		dd offset sub_10006ED0
		dd offset ?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)
		dd offset ?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)
		dd offset sub_10006F32
		dd offset sub_100070F3
		dd offset ?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)
		dd offset ?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ	; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const	&)
off_1002BC0C	dd offset sub_10007838	; DATA XREF: sub_10006BBC+34o
					; sub_10006C20+Co
dword_1002BC10	dd 0			; DATA XREF: sub_10006BBC+15o
		dd 58h
; CHAR aAppcontainerre[]
aAppcontainerre	db 'AppContainerRegisterSid',0 ; DATA XREF: sub_10007B72+3Do
; CHAR aAppcontainerun[]
aAppcontainerun	db 'AppContainerUnregisterSid',0 ; DATA XREF: sub_10007C0E+3Co
		align 4
; CHAR aAppcontainerlo[]
aAppcontainerlo	db 'AppContainerLookupMoniker',0 ; DATA XREF: sub_10007C92+5Co
					; sub_10007C92+6Fo
		align 4
; CHAR aAppcontainerfr[]
aAppcontainerfr	db 'AppContainerFreeMemory',0 ; DATA XREF: sub_10007C92+83o
					; sub_10007C92+96o
		align 10h
off_1002BC80	dd offset sub_10017EF6	; DATA XREF: sub_100083D0+3F7o
					; sub_10017FE3+6o
		dd offset sub_10017F59
		dd offset sub_10007E9F
off_1002BC8C	dd offset _purecall	; DATA XREF: sub_10007E81+8o
					; sub_10017FE3+1Bo
		dd offset _purecall
		dd offset sub_10007E81
off_1002BC98	dd offset sub_10007FF0	; DATA XREF: sub_10007F31+9o
					; sub_10008051+17o
		dd offset sub_10008193
		dd offset sub_100083D0
		dd offset sub_100089CE
		dd offset sub_10008A71
		dd offset sub_10008B78
		dd offset sub_10008C53
; char VarName[]
VarName		db 'MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA',0
					; DATA XREF: sub_100083D0:loc_10008770o
		align 4
; const	WCHAR Src
Src		dw 0			; DATA XREF: sub_1000996B+27o
					; sub_10013A70+55o ...
		align 10h
a_targetntcre_2	db '_TargetNtCreateFile@48',0 ; DATA XREF: sub_10009C20+8Eo
		align 4
; CHAR aNtcreatefile[]
aNtcreatefile	db 'NtCreateFile',0     ; DATA XREF: sub_10009C20+95o
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+55o ...
		align 4
a_targetntope_5	db '_TargetNtOpenFile@28',0 ; DATA XREF: sub_10009C20+75o
		align 10h
aNtopenfile	db 'NtOpenFile',0       ; DATA XREF: sub_10009C20+7Co
					; TargetNtOpenFile(x,x,x,x,x,x,x)+44o ...
		align 4
a_targetntque_2	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: sub_10009C20+5Co
; CHAR aNtqueryattribu[]
aNtqueryattribu	db 'NtQueryAttributesFile',0 ; DATA XREF: sub_10009C20+63o
					; TargetNtQueryAttributesFile(x,x,x)+39o ...
		align 4
a_targetntque_1	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: sub_10009C20+43o
; CHAR aNtqueryfullatt[]
aNtqueryfullatt	db 'NtQueryFullAttributesFile',0 ; DATA XREF: sub_10009C20+4Ao
					; TargetNtQueryFullAttributesFile(x,x,x)+39o ...
		align 4
a_targetntset_1	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: sub_10009C20+2Ao
		align 4
; CHAR aNtsetinformati[]
aNtsetinformati	db 'NtSetInformationFile',0 ; DATA XREF: sub_10009C20+31o
					; TargetNtSetInformationFile(x,x,x,x,x,x)+42o ...
		align 4
off_1002BDDC	dd offset sub_100099CE	; DATA XREF: sub_10009B9C+3o
					; sub_10009BBF+1Co
		dd offset sub_10009C20
		dd offset sub_10009B9C
dword_1002BDE8	dd 3, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_10009BBF+6o
		dd offset sub_10009CCF
dword_1002BE14	dd 7, 4, 2 dup(6), 2 dup(2), 4 dup(0) ;	DATA XREF: sub_10009BBF+4Eo
		dd offset sub_1000A073
dword_1002BE40	dd 5, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_10009BBF+36o
		dd offset sub_10009ED1
dword_1002BE6C	dd 4, 1, 4 dup(2), 4 dup(0) ; DATA XREF: sub_10009BBF+2Ao
		dd offset sub_10009DD3
off_1002BE98	dd offset sub_100099CE	; DATA XREF: sub_10009B59+3o
		dd offset _purecall
		dd offset sub_10009B7F
dword_1002BEA4	dd 6, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_10009BBF+42o
		dd offset sub_10009FA2
a??:					; DATA XREF: sub_1000B604+36o
		unicode	0, <\/?/?\*>,0
asc_1002BEE0:				; DATA XREF: sub_1000B604+59o
		unicode	0, <*~*>,0
a??_0:					; DATA XREF: sub_1000B9F0+1Bo
		unicode	0, <\/?/?\>,0
		align 4
aKey:					; DATA XREF: sub_1000BC30+5Do
		unicode	0, <Key>,0
; CHAR aG_handles_to_0[]
aG_handles_to_0	db 'g_handles_to_close',0 ; DATA XREF: sub_1000BE9E+83o
		align 4
; CHAR aNtqueryobject[]
aNtqueryobject	db 'NtQueryObject',0    ; DATA XREF: sub_1000C07B+25o
					; sub_1000C7E4+1Fo ...
		align 4
aCheckFailedG_h	db 'Check failed: g_handles_to_close != NULL. ',0
					; DATA XREF: sub_1000C850+40o
		align 10h
aCBuildsMoz2__3	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_1000C850+31o
					; sub_1000C850+188o
		db 'y/sandbox/chromium/sandbox/win/src/handle_closer_agent.cc',0
		align 4
aCheckFailedNam	db 'Check failed: name.second. ',0 ; DATA XREF: sub_1000C850+199o
dword_1002BFE8	dd 12h,	4, 3 dup(2), 5 dup(0) ;	DATA XREF: sub_1001436D+20Eo
		dd offset sub_1000D2CC
off_1002C014	dd offset sub_100099CE	; DATA XREF: sub_1000D29E+3o
					; sub_1001436D+213o
		dd offset sub_1000D2C1
		dd offset sub_1000D29E
aDuplicatehandl	db 'DuplicateHandle',0  ; DATA XREF: sub_1000D426+87o
					; sub_1000D426+9Do
off_1002C030	dd offset sub_1000D7C5	; DATA XREF: sub_1000D7C5+8o
		dd offset _purecall
		dd offset sub_10012A16
		dd offset sub_10012AC6
		dd offset _purecall
		dd offset sub_1001299F
off_1002C048	dd offset sub_1000D7C5	; DATA XREF: sub_1000E01D+1BAo
		dd offset sub_100154D5
		dd offset sub_10015484
		dd offset sub_10015489
		dd offset sub_10015563
		dd offset sub_1001299F
		dd offset sub_100154C2
		dd offset sub_10015567
		dd offset sub_100155CF
		dd offset sub_100156B4
off_1002C070	dd offset sub_1000D7C5	; DATA XREF: sub_1000E01D+15Eo
		dd offset sub_100154D5
		dd offset sub_10015484
		dd offset sub_10015489
		dd offset sub_10015563
		dd offset sub_1001299F
		dd offset sub_100154C2
		dd offset sub_10015567
		dd offset sub_100158B1
		dd offset sub_100156B4
off_1002C098	dd offset sub_1000D7C5	; DATA XREF: sub_1000E01D+17Bo
		dd offset sub_100154D5
		dd offset sub_10015484
		dd offset sub_10015489
		dd offset sub_10015563
		dd offset sub_1001299F
		dd offset sub_100154C2
		dd offset sub_10015567
		dd offset sub_10015810
		dd offset sub_100156B4
off_1002C0C0	dd offset sub_1000D7C5	; DATA XREF: sub_1000E01D+19Do
		dd offset sub_100154D5
		dd offset sub_10015484
		dd offset sub_10015489
		dd offset sub_10015563
		dd offset sub_1001299F
		dd offset sub_100154C2
		dd offset sub_10015567
		dd offset sub_10015927
		dd offset sub_100156B4
aSizeKallocgran	db 'size <= kAllocGranularity',0 ; DATA XREF: sub_1000D7E3+19o
		align 8
aCBuildsMoz2__0	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_10001B7E+13o
					; sub_1000DE70+CBo
		db 'y/sandbox/chromium/sandbox/win/src/interception.cc',0
; CHAR aG_intercepti_0[]
aG_intercepti_0	db 'g_interceptions',0  ; DATA XREF: sub_1000D966+66o
a_targetntmap_0	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: sub_1000DE70+3Ao
		align 10h
aNtmapviewofsec	db 'NtMapViewOfSection',0 ; DATA XREF: sub_1000DE70+40o
					; sub_1000EE41+A7o
		align 4
a_targetntunm_0	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: sub_1000DE70+51o
		align 10h
aNtunmapviewofs	db 'NtUnmapViewOfSection',0 ; DATA XREF: sub_1000DE70+57o
					; sub_1000EE41+143o
		align 4
aCheckFailedThu	db 'Check failed: thunk_base. ',0 ; DATA XREF: sub_1000DE70+E1o
		align 4
; CHAR aG_originals_0[]
aG_originals_0	db 'g_originals',0      ; DATA XREF: sub_1000DE70+17Fo
aLdrgetdllhandl	db 'LdrGetDllHandle',0  ; DATA XREF: sub_1000E01D:loc_1000E071o
					; sub_1000EE41+14o
off_1002C240	dd offset sub_1000D7C5	; DATA XREF: sub_1000E72B+99o
		dd offset sub_10016812
		dd offset sub_10012A16
		dd offset sub_10012AC6
		dd offset sub_100168A9
		dd offset sub_1001299F
off_1002C258	dd offset sub_1000D7C5	; DATA XREF: sub_1000E72B+27o
		dd offset sub_10009A54
		dd offset sub_10012A16
		dd offset sub_10009AF1
		dd offset sub_10009B55
		dd offset sub_1001299F
off_1002C270	dd offset sub_1000D7C5	; DATA XREF: sub_1000E72B+61o
		dd offset sub_1001674A
		dd offset sub_10012A16
		dd offset sub_10012AC6
		dd offset sub_1001680E
		dd offset sub_1001299F
a_targetcreat_3	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: sub_1000E920+16o
		align 4
a__:					; DATA XREF: sub_1000E953:loc_1000E9F2o
					; sub_1000E953+AAo
		unicode	0, <..>,0
		align 4
aCreatenamedpip	db 'CreateNamedPipeW',0 ; DATA XREF: sub_1000E920+1Do
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+85o ...
		align 10h
a?:					; DATA XREF: sub_1000E953+140o
		unicode	0, <\\?\>,0
		align 4
a_:					; DATA XREF: sub_1000E953+11Fo
		unicode	0, <\\.\>,0
		align 4
off_1002C2D8	dd offset sub_100099CE	; DATA XREF: sub_1000E8FD+3o
					; sub_1001436D+119o
		dd offset sub_1000E920
		dd offset sub_1000E8FD
dword_1002C2E4	dd 8, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_1001436D+114o
		dd offset sub_1000E953
aNtallocatevirt	db 'NtAllocateVirtualMemory',0 ; DATA XREF: sub_1000EE41:loc_1000EE80o
		align 10h
aNtduplicateobj	db 'NtDuplicateObject',0 ; DATA XREF: sub_1000EE41+73o
		align 4
; CHAR aNtclose[]
aNtclose	db 'NtClose',0          ; DATA XREF: sub_1000EE41+59o
					; sub_100125E7+2Fo ...
		align 10h
aNtprotectvirtu	db 'NtProtectVirtualMemory',0 ; DATA XREF: sub_1000EE41+C1o
		align 10h
aNtfreevirtualm	db 'NtFreeVirtualMemory',0 ; DATA XREF: sub_1000EE41+8Do
aNtquerysection	db 'NtQuerySection',0   ; DATA XREF: sub_1000EE41+10Fo
		align 10h
aNtqueryinforma	db 'NtQueryInformationProcess',0 ; DATA XREF: sub_1000EE41+DBo
		align 10h
aRtlallocatehea	db 'RtlAllocateHeap',0  ; DATA XREF: sub_1000EE41+15Do
aNtqueryvirtual	db 'NtQueryVirtualMemory',0 ; DATA XREF: sub_1000EE41+129o
		align 10h
aRtlcompareunic	db 'RtlCompareUnicodeString',0 ; DATA XREF: sub_1000EE41+191o
		align 10h
aRtlansistringt	db 'RtlAnsiStringToUnicodeString',0 ; DATA XREF: sub_1000EE41+177o
		align 10h
aRtlcreateusert	db 'RtlCreateUserThread',0 ; DATA XREF: sub_1000EE41+1C5o
aRtlcreateheap	db 'RtlCreateHeap',0    ; DATA XREF: sub_1000EE41+1ABo
		align 4
aRtlfreeheap	db 'RtlFreeHeap',0      ; DATA XREF: sub_1000EE41+1F9o
aRtldestroyheap	db 'RtlDestroyHeap',0   ; DATA XREF: sub_1000EE41+1DFo
		align 10h
aStrlen		db 'strlen',0           ; DATA XREF: sub_1000EE41+225o
		align 4
a_strnicmp	db '_strnicmp',0        ; DATA XREF: sub_1000EE41+20Fo
		align 4
aMemcpy		db 'memcpy',0           ; DATA XREF: sub_1000EE41+251o
		align 4
aWcslen		db 'wcslen',0           ; DATA XREF: sub_1000EE41+23Bo
		align 4
a_targetntope_8	db '_TargetNtOpenThread@20',0 ; DATA XREF: sub_1000F0CA+1Co
		align 4
; CHAR aG_nt_0[]
aG_nt_0		db 'g_nt',0             ; DATA XREF: sub_1000EE41+26Eo
		align 4
a_targetntope_9	db '_TargetNtOpenProcess@20',0 ; DATA XREF: sub_1000F0CA+44o
; CHAR aNtopenthread[]
aNtopenthread	db 'NtOpenThread',0     ; DATA XREF: sub_1000F0CA+22o
					; TargetNtOpenThread(x,x,x,x,x)+2Eo ...
		align 4
a_targetntop_10	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: sub_1000F0CA+6Eo
		align 4
; CHAR aNtopenprocess[]
aNtopenprocess	db 'NtOpenProcess',0    ; DATA XREF: sub_1000F0CA+4Ao
					; sub_10011B05+1Ao
		align 4
a_targetntset_2	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: sub_1000F0CA+98o
		align 10h
; CHAR aNtopenprocesst[]
aNtopenprocesst	db 'NtOpenProcessToken',0 ; DATA XREF: sub_1000F0CA+74o
					; sub_10010AEB+10o ...
		align 4
a_targetntop_11	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: sub_1000F0CA+C2o
aNtsetinforma_0	db 'NtSetInformationThread',0 ; DATA XREF: sub_1000F0CA+9Eo
		align 4
a_targetntop_12	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: sub_1000F0CA+F2o
		align 4
aNtopenthreadto	db 'NtOpenThreadToken',0 ; DATA XREF: sub_1000F0CA+C8o
		align 4
a_targetntop_13	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: sub_1000F0CA+119o
		align 4
; CHAR aNtopenproces_0[]
aNtopenproces_0	db 'NtOpenProcessTokenEx',0 ; DATA XREF: sub_1000F0CA+F9o
					; sub_10010B66+10o ...
		align 4
aNtopenthread_0	db 'NtOpenThreadTokenEx',0 ; DATA XREF: sub_1000F0CA+120o
aCheckFailedIsv	db 'Check failed: IsValueInRangeForNumericType<Dst>(value). ',0
					; DATA XREF: sub_1000F209+39o
		align 8
aCBuildsMoz2__1	db 'c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\securit'
					; DATA XREF: sub_1000F209+28o
		db 'y\sandbox\chromium\base/numerics/safe_conversions.h',0
		align 10h
; CHAR aKernel32_dll_3[]
aKernel32_dll_3	db 'kernel32.dll',0     ; DATA XREF: sub_1001027A+2Co
		align 10h
; CHAR aSetprocessdepp[]
aSetprocessdepp	db 'SetProcessDEPPolicy',0 ; DATA XREF: sub_1001027A:loc_1001033Ao
; CHAR aSetdefaultdlld[]
aSetdefaultdlld	db 'SetDefaultDllDirectories',0 ; DATA XREF: sub_1001027A+53o
		align 10h
; CHAR aSetprocessmiti[]
aSetprocessmiti	db 'SetProcessMitigationPolicy',0 ; DATA XREF: sub_1001027A+140o
		align 4
; CHAR aNtsetinforma_1[]
aNtsetinforma_1	db 'NtSetInformationProcess',0 ; DATA XREF: sub_1001027A+F3o
a_targetgdidl_0	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: sub_100106A7+6Do
		align 10h
aGdi32_dll:				; DATA XREF: sub_100106A7:loc_10010720o
		unicode	0, <gdi32.dll>,0
aGdidllinitiali	db 'GdiDllInitialize',0 ; DATA XREF: sub_100106A7+74o
		align 4
aGetstockobject	db 'GetStockObject',0   ; DATA XREF: sub_100106A7+5Bo
		align 4
a_targetgetst_0	db '_TargetGetStockObject@8',0 ; DATA XREF: sub_100106A7+54o
aRegisterclassw	db 'RegisterClassW',0   ; DATA XREF: sub_100106A7+3Do
		align 10h
a_targetregis_0	db '_TargetRegisterClassW@8',0 ; DATA XREF: sub_100106A7+36o
aUser32_dll_0:				; DATA XREF: sub_100106A7+42o
		unicode	0, <user32.dll>,0
		align 10h
off_1002C7D0	dd offset sub_100099CE	; DATA XREF: sub_10010684+3o
					; sub_1001436D+23Eo
		dd offset sub_100106A7
		dd offset sub_10010684
asc_1002C7DC:				; DATA XREF: sub_100108AA+1Fo
		unicode	0, <:\>,0
		align 4
asc_1002C7E4:				; DATA XREF: sub_100108AA+4o
		unicode	0, <\\>,0
		align 4
a_targetcreat_1	db '_TargetCreateProcessW@44',0 ; DATA XREF: sub_10010A07+2Eo
		align 4
a_targetcreat_2	db '_TargetCreateProcessA@44',0 ; DATA XREF: sub_10010A07+5Ao
		align 4
aCreateprocessw	db 'CreateProcessW',0   ; DATA XREF: sub_10010A07+35o
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+7Do ...
		align 4
aCreateprocessa	db 'CreateProcessA',0   ; DATA XREF: sub_10010A07+61o
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+78o ...
		align 4
dword_1002C844	dd 0Ch,	4, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_100109A6+42o
		dd offset sub_10010B66
off_1002C870	dd offset sub_100099CE	; DATA XREF: sub_100107A5+3o
					; sub_100109A6+1Co
		dd offset sub_10010A07
		dd offset sub_100107A5
dword_1002C87C	dd 0Dh,	3 dup(1), 6, 5 dup(0) ;	DATA XREF: sub_100109A6+4Eo
		dd offset sub_10010BE5
dword_1002C8A8	dd 0Bh,	4, 2, 7	dup(0)	; DATA XREF: sub_100109A6+36o
		dd offset sub_10010AEB
dword_1002C8D4	dd 9, 2	dup(2),	7 dup(0) ; DATA	XREF: sub_100109A6+6o
		dd offset sub_10010A8F
dword_1002C900	dd 0Ah,	2 dup(2), 7 dup(0) ; DATA XREF:	sub_100109A6+2Ao
		dd offset sub_10010ABD
a_targetntcre_3	db '_TargetNtCreateKey@32',0 ; DATA XREF: sub_10011CA5+1Bo
		align 4
a_targetntope_6	db '_TargetNtOpenKey@16',0 ; DATA XREF: sub_10011CA5+51o
; CHAR aNtcreatekey[]
aNtcreatekey	db 'NtCreateKey',0      ; DATA XREF: sub_10011CA5+22o
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+49o ...
a_targetntope_7	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: sub_10011CA5+96o
		align 4
; CHAR aNtopenkey[]
aNtopenkey	db 'NtOpenKey',0        ; DATA XREF: sub_10011CA5+58o
					; TargetNtOpenKey(x,x,x,x)+23o	...
		align 4
aNtopenkeyex	db 'NtOpenKeyEx',0      ; DATA XREF: sub_10011CA5+9Do
					; TargetNtOpenKeyEx(x,x,x,x,x)+2Co
dword_1002C994	dd 10h,	1, 2, 4, 3 dup(2), 3 dup(0) ; DATA XREF: sub_1001436D+1C7o
		dd offset sub_10011D5F
dword_1002C9C0	dd 11h,	1, 2, 4, 2, 5 dup(0) ; DATA XREF: sub_1001436D+1DAo
		dd offset sub_10011EC7
off_1002C9EC	dd offset sub_100099CE	; DATA XREF: sub_10011C2D+3o
					; sub_1001436D+1CCo
		dd offset sub_10011CA5
		dd offset sub_10011C2D
aNtopenkeyEx	db 'NtOpenKey[Ex]',0    ; DATA XREF: sub_100121B1+DDo
		align 4
aS:					; DATA XREF: sub_10013A70+1Fo
		unicode	0, <S:(>,0
aSechangenotify:			; DATA XREF: sub_10013563+1AFo
					; sub_10013563+257o ...
		unicode	0, <SeChangeNotifyPrivilege>,0
asc_1002CA40:				; DATA XREF: sub_10013A70+3Fo
		unicode	0, <;;>,0
		align 4
aMl:					; DATA XREF: sub_10013A70+29o
		unicode	0, <ML>,0
		align 10h
asc_1002CA50:				; DATA XREF: sub_10013A70+92o
		unicode	0, <)>,0
asc_1002CA54:				; DATA XREF: sub_10013A70+6Bo
		unicode	0, <;;;>,0
aS11612288:				; DATA XREF: sub_10013BA9:loc_10013BC1o
		unicode	0, <S-1-16-12288>,0
		align 4
aS11616384:				; DATA XREF: sub_10013BA9:loc_10013BBAo
		unicode	0, <S-1-16-16384>,0
		align 4
aS1166144:				; DATA XREF: sub_10013BA9:loc_10013BCFo
		unicode	0, <S-1-16-6144>,0
aS1168192:				; DATA XREF: sub_10013BA9:loc_10013BC8o
		unicode	0, <S-1-16-8192>,0
aS1162048:				; DATA XREF: sub_10013BA9:loc_10013BDDo
		unicode	0, <S-1-16-2048>,0
aS1164096:				; DATA XREF: sub_10013BA9:loc_10013BD6o
		unicode	0, <S-1-16-4096>,0
aS1160:					; DATA XREF: sub_10013BA9:loc_10013BE4o
		unicode	0, <S-1-16-0>,0
		align 4
aCBuildsMoz2__2	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_10014BB5+43o
		db 'y/sandbox/chromium/sandbox/win/src/sandbox_policy_base.cc',0
		align 4
aPattern	db ', pattern = ',27h,0 ; DATA XREF: sub_10014BB5+A2o
		align 4
asc_1002CB94	db 27h,0		; DATA XREF: sub_10014BB5+B8o
		align 4
aSubsystem	db ', subsystem = ',0   ; DATA XREF: sub_10014BB5+7Ao
		align 4
aSemantics	db ', semantics = ',0   ; DATA XREF: sub_10014BB5+8Eo
		align 4
aFailedToAddSan	db 'Failed to add sandbox rule.',0 ; DATA XREF: sub_10014BB5+55o
aError		db ' error = ',0        ; DATA XREF: sub_10014BB5+66o
		align 10h
; CHAR aG_shared_del_2[]
aG_shared_del_2	db 'g_shared_delayed_mitigations',0 ; DATA XREF: sub_10014EB0+EBo
		align 10h
; CHAR aG_shared_del_1[]
aG_shared_del_1	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: sub_10014EB0+75o
		align 4
dword_1002CC24	dd 1, 2, 8 dup(0)	; DATA XREF: sub_10014CE9+Co
dword_1002CC4C	dd 2, 6, 8 dup(0)	; DATA XREF: sub_10014CE9:loc_10014D15o
off_1002CC74	dd offset _purecall	; DATA XREF: sub_1001436D+12o
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
off_1002CCDC	dd offset sub_10014765	; DATA XREF: sub_1001436D+1Fo
					; sub_100145ED+16o
		dd offset sub_10014770
		dd offset sub_10014789
		dd offset sub_100147A5
		dd offset sub_100147A9
		dd offset sub_100147AD
		dd offset sub_100147D0
		dd offset sub_100147EB
		dd offset sub_100147FF
		dd offset sub_10014854
		dd offset sub_1001499B
		dd offset sub_100149CA
		dd offset sub_100149D6
		dd offset sub_100149DA
		dd offset sub_100149E6
		dd offset sub_10014AB9
		dd offset sub_10014B06
		dd offset sub_10014B33
		dd offset sub_10014B3A
		dd offset sub_10014B65
		dd offset sub_10014B6C
		dd offset sub_10014B71
		dd offset sub_10014B93
		dd offset sub_10014BB5
		dd offset sub_10014C91
		dd offset sub_10014CDE
off_1002CD44	dd offset sub_10014CE9	; DATA XREF: sub_1001436D+19o
					; sub_100145ED+10o
		dd offset sub_10014D5E
		dd offset sub_100145D0
; CHAR aRtlinitunicode[]
aRtlinitunicode	db 'RtlInitUnicodeString',0 ; DATA XREF: sub_1001541F+22o
		align 4
aAdd		db 'add',0              ; DATA XREF: .rdata:1001B8D4o
					; .rdata:1001B938o ...
aPop		db 'pop',0              ; DATA XREF: .rdata:1001BB90o
					; .rdata:1001C1D0o ...
aPush		db 'push',0             ; DATA XREF: .rdata:1001BB2Co
					; .rdata:1001BE4Co ...
		align 4
aAdc		db 'adc',0              ; DATA XREF: .rdata:1001BF14o
					; .rdata:1001BF78o ...
aOr		db 'or',0               ; DATA XREF: .rdata:1001BBF4o
					; .rdata:1001BC58o ...
		align 10h
aAnd		db 'and',0              ; DATA XREF: .rdata:1001C554o
					; .rdata:1001C5B8o ...
aSbb		db 'sbb',0              ; DATA XREF: .rdata:1001C234o
					; .rdata:1001C298o ...
aSub		db 'sub',0              ; DATA XREF: .rdata:1001C874o
					; .rdata:1001C8D8o ...
aDaa		db 'daa',0              ; DATA XREF: .rdata:1001C810o
aXor		db 'xor',0              ; DATA XREF: .rdata:1001CB94o
					; .rdata:1001CBF8o ...
aDas		db 'das',0              ; DATA XREF: .rdata:1001CB30o
aCmp		db 'cmp',0              ; DATA XREF: .rdata:1001CEB4o
					; .rdata:1001CF18o ...
aAaa		db 'aaa',0              ; DATA XREF: .rdata:1001CE50o
aInc		db 'inc',0              ; DATA XREF: .rdata:1001D1D4o
					; .rdata:1001D238o ...
aAas		db 'aas',0              ; DATA XREF: .rdata:1001D170o
aPushad		db 'pushad',0           ; DATA XREF: .rdata:1001DE54o
		align 10h
aDec		db 'dec',0              ; DATA XREF: .rdata:1001D4F4o
					; .rdata:1001D558o ...
aBound		db 'bound',0            ; DATA XREF: .rdata:1001DF1Co
		align 4
aPopad		db 'popad',0            ; DATA XREF: .rdata:1001DEB8o
		align 4
aImul		db 'imul',0             ; DATA XREF: .rdata:1001E1D8o
					; .rdata:1001E2A0o ...
		align 4
aArpl		db 'arpl',0             ; DATA XREF: .rdata:1001DF80o
		align 4
aInsd		db 'insd',0             ; DATA XREF: .rdata:1001E368o
		align 4
aInsb		db 'insb',0             ; DATA XREF: .rdata:1001E304o
		align 4
aJo		db 'jo',0               ; DATA XREF: .rdata:1001E494o
					; .rdata:10027B5Co
		align 4
aOutsb		db 'outsb',0            ; DATA XREF: .rdata:1001E3CCo
					; .rdata:1001E430o
		align 10h
aJc		db 'jc',0               ; DATA XREF: .rdata:1001E55Co
					; .rdata:10027C24o
		align 4
aJno		db 'jno',0              ; DATA XREF: .rdata:1001E4F8o
					; .rdata:10027BC0o
aJz		db 'jz',0               ; DATA XREF: .rdata:1001E624o
					; .rdata:10027CECo
		align 4
aJnc		db 'jnc',0              ; DATA XREF: .rdata:1001E5C0o
					; .rdata:10027C88o
aJbe		db 'jbe',0              ; DATA XREF: .rdata:1001E6ECo
					; .rdata:10027DB4o
aJnz		db 'jnz',0              ; DATA XREF: .rdata:1001E688o
					; .rdata:10027D50o
aJs		db 'js',0               ; DATA XREF: .rdata:1001E7B4o
					; .rdata:10027E7Co
		align 4
aJa		db 'ja',0               ; DATA XREF: .rdata:1001E750o
					; .rdata:10027E18o
		align 10h
aJpe		db 'jpe',0              ; DATA XREF: .rdata:1001E87Co
					; .rdata:10027F44o
aJns		db 'jns',0              ; DATA XREF: .rdata:1001E818o
					; .rdata:10027EE0o
aJl		db 'jl',0               ; DATA XREF: .rdata:1001E944o
					; .rdata:1002800Co
		align 4
aJpo		db 'jpo',0              ; DATA XREF: .rdata:1001E8E0o
					; .rdata:10027FA8o
aJle		db 'jle',0              ; DATA XREF: .rdata:1001EA0Co
					; .rdata:100280D4o
aJge		db 'jge',0              ; DATA XREF: .rdata:1001E9A8o
					; .rdata:10028070o
aTest		db 'test',0             ; DATA XREF: .rdata:1001EC64o
					; .rdata:1001ECC8o ...
		align 10h
aJg		db 'jg',0               ; DATA XREF: .rdata:1001EA70o
					; .rdata:10028138o
		align 4
aMov		db 'mov',0              ; DATA XREF: .rdata:1001EDF4o
					; .rdata:1001EE58o ...
aXchg		db 'xchg',0             ; DATA XREF: .rdata:1001ED2Co
					; .rdata:1001ED90o ...
		align 10h
aNop		db 'nop',0              ; DATA XREF: .rdata:1001F114o
aLea		db 'lea',0              ; DATA XREF: .rdata:1001EFE8o
aCdq		db 'cdq',0              ; DATA XREF: .rdata:1001F498o
aCwde		db 'cwde',0             ; DATA XREF: .rdata:1001F434o
		align 4
aWait		db 'wait',0             ; DATA XREF: .rdata:1001F560o
		align 4
aCallf		db 'callf',0            ; DATA XREF: .rdata:1001F4FCo
		align 4
aPopfd		db 'popfd',0            ; DATA XREF: .rdata:1001F628o
		align 4
aPushfd		db 'pushfd',0           ; DATA XREF: .rdata:1001F5C4o
		align 4
aLahf		db 'lahf',0             ; DATA XREF: .rdata:1001F6F0o
		align 4
aSahf		db 'sahf',0             ; DATA XREF: .rdata:1001F68Co
		align 4
aMovsd		db 'movsd',0            ; DATA XREF: .rdata:1001F948o
					; .rdata:10024FB8o ...
		align 4
aMovsb		db 'movsb',0            ; DATA XREF: .rdata:1001F8E4o
		align 4
aCmpsd		db 'cmpsd',0            ; DATA XREF: .rdata:1001FA10o
					; .rdata:10029540o
		align 4
aCmpsb		db 'cmpsb',0            ; DATA XREF: .rdata:1001F9ACo
		align 4
aStosd		db 'stosd',0            ; DATA XREF: .rdata:1001FBA0o
		align 4
aStosb		db 'stosb',0            ; DATA XREF: .rdata:1001FB3Co
		align 4
aLodsd		db 'lodsd',0            ; DATA XREF: .rdata:1001FC68o
		align 4
aLodsb		db 'lodsb',0            ; DATA XREF: .rdata:1001FC04o
		align 4
aScasd		db 'scasd',0            ; DATA XREF: .rdata:1001FD30o
		align 4
aScasb		db 'scasb',0            ; DATA XREF: .rdata:1001FCCCo
		align 4
aLes		db 'les',0              ; DATA XREF: .rdata:10020564o
aRet		db 'ret',0              ; DATA XREF: .rdata:1002049Co
					; .rdata:10020500o
aEnter		db 'enter',0            ; DATA XREF: .rdata:100206F4o
		align 4
aLds		db 'lds',0              ; DATA XREF: .rdata:100205C8o
aRetf		db 'retf',0             ; DATA XREF: .rdata:100207BCo
					; .rdata:10020820o
		align 10h
aLeave		db 'leave',0            ; DATA XREF: .rdata:10020758o
		align 4
aInt		db 'int',0              ; DATA XREF: .rdata:100208E8o
aInt3		db 'int3',0             ; DATA XREF: .rdata:10020884o
		align 4
aIret		db 'iret',0             ; DATA XREF: .rdata:100209B0o
		align 4
aInto		db 'into',0             ; DATA XREF: .rdata:1002094Co
		align 4
aAad		db 'aad',0              ; DATA XREF: .rdata:10020C08o
aAam		db 'aam',0              ; DATA XREF: .rdata:10020BA4o
aLoopnz		db 'loopnz',0           ; DATA XREF: .rdata:10021054o
		align 4
aXlat		db 'xlat',0             ; DATA XREF: .rdata:10020CD0o
		align 4
aLoop		db 'loop',0             ; DATA XREF: .rdata:1002111Co
		align 4
aLoopz		db 'loopz',0            ; DATA XREF: .rdata:100210B8o
		align 4
aIn		db 'in',0               ; DATA XREF: .rdata:100211E4o
					; .rdata:10021248o ...
		align 10h
aJcxz		db 'jcxz',0             ; DATA XREF: .rdata:10021180o
		align 4
aCall		db 'call',0             ; DATA XREF: .rdata:10021374o
					; .rdata:10021D9Co ...
		align 10h
aOut		db 'out',0              ; DATA XREF: .rdata:100212ACo
					; .rdata:10021310o ...
aLock		db 'lock:',0            ; DATA XREF: .rdata:10021694o
		align 4
aJmp		db 'jmp',0              ; DATA XREF: .rdata:100213D8o
					; .rdata:1002143Co ...
aRep		db 'rep:',0             ; DATA XREF: .rdata:100217C0o
		align 4
aRepne		db 'repne:',0           ; DATA XREF: .rdata:1002175Co
		align 10h
aCmc		db 'cmc',0              ; DATA XREF: .rdata:10021888o
aHlt		db 'hlt',0              ; DATA XREF: .rdata:10021824o
aStc		db 'stc',0              ; DATA XREF: .rdata:10021A18o
aClc		db 'clc',0              ; DATA XREF: .rdata:100219B4o
aSti		db 'sti',0              ; DATA XREF: .rdata:10021AE0o
aCli		db 'cli',0              ; DATA XREF: .rdata:10021A7Co
aStd		db 'std',0              ; DATA XREF: .rdata:10021BA8o
aCld		db 'cld',0              ; DATA XREF: .rdata:10021B44o
aLsl		db 'lsl',0              ; DATA XREF: .rdata:10024A88o
aLar		db 'lar',0              ; DATA XREF: .rdata:10024A24o
aInvd		db 'invd',0             ; DATA XREF: .rdata:10024C7Co
		align 10h
aClts		db 'clts',0             ; DATA XREF: .rdata:10024BB4o
		align 4
aUd2		db 'ud2',0              ; DATA XREF: .rdata:10024DA8o
aWbinvd		db 'wbinvd',0           ; DATA XREF: .rdata:10024CE0o
		align 4
aMovss		db 'movss',0            ; DATA XREF: .rdata:10024FD0o
					; .rdata:10025034o
		align 4
aMovups		db 'movups',0           ; DATA XREF: .rdata:10024F9Co
					; .rdata:10025000o
		align 4
aMovlps		db 'movlps',0           ; DATA XREF: .rdata:10025064o
					; .rdata:100250C8o
		align 4
aMovupd		db 'movupd',0           ; DATA XREF: .rdata:10024FE8o
					; .rdata:1002504Co
		align 4
aMovlpd		db 'movlpd',0           ; DATA XREF: .rdata:100250B0o
					; .rdata:10025114o
		align 4
aMovhlps	db 'movhlps',0          ; DATA XREF: .rdata:10025080o
					; .rdata:10025098o
aUnpcklpd	db 'unpcklpd',0         ; DATA XREF: .rdata:10025178o
		align 10h
aUnpcklps	db 'unpcklps',0         ; DATA XREF: .rdata:1002512Co
		align 4
aUnpckhpd	db 'unpckhpd',0         ; DATA XREF: .rdata:100251DCo
		align 4
aUnpckhps	db 'unpckhps',0         ; DATA XREF: .rdata:10025190o
		align 4
aMovlhps	db 'movlhps',0          ; DATA XREF: .rdata:10025210o
					; .rdata:10025228o
aMovhps		db 'movhps',0           ; DATA XREF: .rdata:100251F4o
					; .rdata:10025258o
		align 4
aMovaps		db 'movaps',0           ; DATA XREF: .rdata:100258FCo
					; .rdata:10025960o
		align 4
aMovhpd		db 'movhpd',0           ; DATA XREF: .rdata:10025240o
					; .rdata:100252A4o
		align 4
aCvtpi2ps	db 'cvtpi2ps',0         ; DATA XREF: .rdata:100259C4o
		align 10h
aMovapd		db 'movapd',0           ; DATA XREF: .rdata:10025948o
					; .rdata:100259ACo
		align 4
aCvtsi2ss	db 'cvtsi2ss',0         ; DATA XREF: .rdata:100259F8o
		align 4
aCvtsi2sd	db 'cvtsi2sd',0         ; DATA XREF: .rdata:100259E0o
		align 10h
aMovntps	db 'movntps',0          ; DATA XREF: .rdata:10025A28o
aCvtpi2pd	db 'cvtpi2pd',0         ; DATA XREF: .rdata:10025A10o
		align 4
aCvttps2pi	db 'cvttps2pi',0        ; DATA XREF: .rdata:10025A8Co
		align 10h
aMovntpd	db 'movntpd',0          ; DATA XREF: .rdata:10025A74o
aCvttss2si	db 'cvttss2si',0        ; DATA XREF: .rdata:10025AC0o
		align 4
aCvttsd2si	db 'cvttsd2si',0        ; DATA XREF: .rdata:10025AA8o
		align 10h
aCvtps2pi	db 'cvtps2pi',0         ; DATA XREF: .rdata:10025AF0o
		align 4
aCvttpd2pi	db 'cvttpd2pi',0        ; DATA XREF: .rdata:10025AD8o
		align 4
aCvtss2si	db 'cvtss2si',0         ; DATA XREF: .rdata:10025B24o
		align 4
aCvtsd2si	db 'cvtsd2si',0         ; DATA XREF: .rdata:10025B0Co
		align 10h
aUcomiss	db 'ucomiss',0          ; DATA XREF: .rdata:10025B54o
aCvtpd2pi	db 'cvtpd2pi',0         ; DATA XREF: .rdata:10025B3Co
		align 4
aComiss		db 'comiss',0           ; DATA XREF: .rdata:10025BB8o
		align 4
aUcomisd	db 'ucomisd',0          ; DATA XREF: .rdata:10025BA0o
aWrmsr		db 'wrmsr',0            ; DATA XREF: .rdata:10025C1Co
		align 4
aComisd		db 'comisd',0           ; DATA XREF: .rdata:10025C04o
		align 4
aRdmsr		db 'rdmsr',0            ; DATA XREF: .rdata:10025CE4o
		align 4
aRdtsc		db 'rdtsc',0            ; DATA XREF: .rdata:10025C80o
		align 4
aSysenter	db 'sysenter',0         ; DATA XREF: .rdata:10025DACo
		align 10h
aRdpmc		db 'rdpmc',0            ; DATA XREF: .rdata:10025D48o
		align 4
aMovnti		db 'movnti',0           ; DATA XREF: .rdata:100260CCo
					; .rdata:10029588o
		align 10h
aSysexit	db 'sysexit',0          ; DATA XREF: .rdata:10025E10o
aCmovno		db 'cmovno',0           ; DATA XREF: .rdata:100262C0o
		align 10h
aCmovo		db 'cmovo',0            ; DATA XREF: .rdata:1002625Co
		align 4
aCmovnc		db 'cmovnc',0           ; DATA XREF: .rdata:10026388o
		align 10h
aCmovc		db 'cmovc',0            ; DATA XREF: .rdata:10026324o
		align 4
aCmovnz		db 'cmovnz',0           ; DATA XREF: .rdata:10026450o
		align 10h
aCmovz		db 'cmovz',0            ; DATA XREF: .rdata:100263ECo
		align 4
aCmova		db 'cmova',0            ; DATA XREF: .rdata:10026518o
		align 10h
aCmovbe		db 'cmovbe',0           ; DATA XREF: .rdata:100264B4o
		align 4
aCmovns		db 'cmovns',0           ; DATA XREF: .rdata:100265E0o
		align 10h
aCmovs		db 'cmovs',0            ; DATA XREF: .rdata:1002657Co
		align 4
aCmovpo		db 'cmovpo',0           ; DATA XREF: .rdata:100266A8o
		align 10h
aCmovpe		db 'cmovpe',0           ; DATA XREF: .rdata:10026644o
		align 4
aCmovge		db 'cmovge',0           ; DATA XREF: .rdata:10026770o
		align 10h
aCmovl		db 'cmovl',0            ; DATA XREF: .rdata:1002670Co
		align 4
aCmovg		db 'cmovg',0            ; DATA XREF: .rdata:10026838o
		align 10h
aCmovle		db 'cmovle',0           ; DATA XREF: .rdata:100267D4o
		align 4
aMovmskpd	db 'movmskpd',0         ; DATA XREF: .rdata:100268E8o
		align 4
aMovmskps	db 'movmskps',0         ; DATA XREF: .rdata:1002689Co
		align 10h
aSqrtsd		db 'sqrtsd',0           ; DATA XREF: .rdata:1002691Co
		align 4
aSqrtps		db 'sqrtps',0           ; DATA XREF: .rdata:10026900o
		align 10h
aSqrtpd		db 'sqrtpd',0           ; DATA XREF: .rdata:1002694Co
		align 4
aSqrtss		db 'sqrtss',0           ; DATA XREF: .rdata:10026934o
		align 10h
aRsqrtss	db 'rsqrtss',0          ; DATA XREF: .rdata:10026998o
aRsqrtps	db 'rsqrtps',0          ; DATA XREF: .rdata:10026964o
aRcpss		db 'rcpss',0            ; DATA XREF: .rdata:100269FCo
		align 4
aRcpps		db 'rcpps',0            ; DATA XREF: .rdata:100269C8o
		align 10h
aAndpd		db 'andpd',0            ; DATA XREF: .rdata:10026A78o
		align 4
aAndps		db 'andps',0            ; DATA XREF: .rdata:10026A2Co
		align 10h
aAndnpd		db 'andnpd',0           ; DATA XREF: .rdata:10026ADCo
		align 4
aAndnps		db 'andnps',0           ; DATA XREF: .rdata:10026A90o
		align 10h
aOrpd		db 'orpd',0             ; DATA XREF: .rdata:10026B40o
		align 4
aOrps		db 'orps',0             ; DATA XREF: .rdata:10026AF4o
		align 10h
aXorpd		db 'xorpd',0            ; DATA XREF: .rdata:10026BA4o
		align 4
aXorps		db 'xorps',0            ; DATA XREF: .rdata:10026B58o
		align 10h
aAddsd		db 'addsd',0            ; DATA XREF: .rdata:10026BD8o
		align 4
aAddps		db 'addps',0            ; DATA XREF: .rdata:10026BBCo
		align 10h
aAddpd		db 'addpd',0            ; DATA XREF: .rdata:10026C08o
		align 4
aAddss		db 'addss',0            ; DATA XREF: .rdata:10026BF0o
		align 10h
aMulsd		db 'mulsd',0            ; DATA XREF: .rdata:10026C3Co
		align 4
aMulps		db 'mulps',0            ; DATA XREF: .rdata:10026C20o
		align 10h
aMulpd		db 'mulpd',0            ; DATA XREF: .rdata:10026C6Co
		align 4
aMulss		db 'mulss',0            ; DATA XREF: .rdata:10026C54o
		align 10h
aCvtsd2ss	db 'cvtsd2ss',0         ; DATA XREF: .rdata:10026CA0o
		align 4
aCvtps2pd	db 'cvtps2pd',0         ; DATA XREF: .rdata:10026C84o
		align 4
aCvtpd2ps	db 'cvtpd2ps',0         ; DATA XREF: .rdata:10026CD0o
		align 4
aCvtss2sd	db 'cvtss2sd',0         ; DATA XREF: .rdata:10026CB8o
		align 10h
aCvttps2dq	db 'cvttps2dq',0        ; DATA XREF: .rdata:10026D1Co
		align 4
aCvtdq2ps	db 'cvtdq2ps',0         ; DATA XREF: .rdata:10026CE8o
		align 4
aSubps		db 'subps',0            ; DATA XREF: .rdata:10026D4Co
		align 10h
aCvtps2dq	db 'cvtps2dq',0         ; DATA XREF: .rdata:10026D34o
		align 4
aSubss		db 'subss',0            ; DATA XREF: .rdata:10026D80o
		align 4
aSubsd		db 'subsd',0            ; DATA XREF: .rdata:10026D68o
		align 4
aMinps		db 'minps',0            ; DATA XREF: .rdata:10026DB0o
		align 4
aSubpd		db 'subpd',0            ; DATA XREF: .rdata:10026D98o
		align 4
aMinss		db 'minss',0            ; DATA XREF: .rdata:10026DE4o
		align 4
aMinsd		db 'minsd',0            ; DATA XREF: .rdata:10026DCCo
		align 4
aDivps		db 'divps',0            ; DATA XREF: .rdata:10026E14o
		align 4
aMinpd		db 'minpd',0            ; DATA XREF: .rdata:10026DFCo
		align 4
aDivss		db 'divss',0            ; DATA XREF: .rdata:10026E48o
		align 4
aDivsd		db 'divsd',0            ; DATA XREF: .rdata:10026E30o
		align 4
aMaxps		db 'maxps',0            ; DATA XREF: .rdata:10026E78o
		align 4
aDivpd		db 'divpd',0            ; DATA XREF: .rdata:10026E60o
		align 4
aMaxss		db 'maxss',0            ; DATA XREF: .rdata:10026EACo
		align 4
aMaxsd		db 'maxsd',0            ; DATA XREF: .rdata:10026E94o
		align 4
aPunpcklbw	db 'punpcklbw',0        ; DATA XREF: .rdata:10026EDCo
					; .rdata:10026F28o
		align 4
aMaxpd		db 'maxpd',0            ; DATA XREF: .rdata:10026EC4o
		align 10h
aPunpckldq	db 'punpckldq',0        ; DATA XREF: .rdata:10026FA4o
					; .rdata:10026FF0o
		align 4
aPunpcklwd	db 'punpcklwd',0        ; DATA XREF: .rdata:10026F40o
					; .rdata:10026F8Co
		align 4
aPcmpgtb	db 'pcmpgtb',0          ; DATA XREF: .rdata:1002706Co
					; .rdata:100270B8o
aPacksswb	db 'packsswb',0         ; DATA XREF: .rdata:10027008o
					; .rdata:10027054o
		align 4
aPcmpgtd	db 'pcmpgtd',0          ; DATA XREF: .rdata:10027134o
					; .rdata:10027180o
aPcmpgtw	db 'pcmpgtw',0          ; DATA XREF: .rdata:100270D0o
					; .rdata:1002711Co
aPunpckhbw	db 'punpckhbw',0        ; DATA XREF: .rdata:100271FCo
					; .rdata:10027248o
		align 4
aPackuswb	db 'packuswb',0         ; DATA XREF: .rdata:10027198o
					; .rdata:100271E4o
		align 4
aPunpckhdq	db 'punpckhdq',0        ; DATA XREF: .rdata:100272C4o
					; .rdata:10027310o
		align 10h
aPunpckhwd	db 'punpckhwd',0        ; DATA XREF: .rdata:10027260o
					; .rdata:100272ACo
		align 4
aNotUsedWithout	db 'not used without prefix',0 ; DATA XREF: .rdata:1002738Co
					; .rdata:100273F0o ...
aPackssdw	db 'packssdw',0         ; DATA XREF: .rdata:10027328o
					; .rdata:10027374o
		align 10h
aMovd		db 'movd',0             ; DATA XREF: .rdata:10027454o
					; .rdata:100274A0o ...
		align 4
aPunpcklqdq	db 'punpcklqdq',0       ; DATA XREF: .rdata:100273D8o
					; .rdata:1002743Co
		align 4
aMovdqu		db 'movdqu',0           ; DATA XREF: .rdata:100274ECo
					; .rdata:10027B2Co
		align 4
aMovq		db 'movq',0             ; DATA XREF: .rdata:100274B8o
					; .rdata:10027AC8o ...
		align 4
aPshuf		db 'pshuf',0            ; DATA XREF: .rdata:1002751Co
		align 4
aMovdqa		db 'movdqa',0           ; DATA XREF: .rdata:10027504o
					; .rdata:10027B44o
		align 4
aPshufhw	db 'pshufhw',0          ; DATA XREF: .rdata:10027550o
aPshuflw	db 'pshuflw',0          ; DATA XREF: .rdata:10027538o
aPcmpeqb	db 'pcmpeqb',0          ; DATA XREF: .rdata:100276ACo
					; .rdata:100276F8o
aPshufd		db 'pshufd',0           ; DATA XREF: .rdata:10027568o
		align 4
aPcmpeqd	db 'pcmpeqd',0          ; DATA XREF: .rdata:10027774o
					; .rdata:100277C0o
aPcmpeqw	db 'pcmpeqw',0          ; DATA XREF: .rdata:10027710o
					; .rdata:1002775Co
aSeto		db 'seto',0             ; DATA XREF: .rdata:1002819Co
		align 4
aEmms		db 'emms',0             ; DATA XREF: .rdata:100277D8o
		align 4
aSetc		db 'setc',0             ; DATA XREF: .rdata:10028264o
		align 4
aSetno		db 'setno',0            ; DATA XREF: .rdata:10028200o
		align 4
aSetz		db 'setz',0             ; DATA XREF: .rdata:1002832Co
		align 4
aSetnc		db 'setnc',0            ; DATA XREF: .rdata:100282C8o
		align 4
aSetbe		db 'setbe',0            ; DATA XREF: .rdata:100283F4o
		align 4
aSetnz		db 'setnz',0            ; DATA XREF: .rdata:10028390o
		align 4
aSets		db 'sets',0             ; DATA XREF: .rdata:100284BCo
		align 4
aSeta		db 'seta',0             ; DATA XREF: .rdata:10028458o
		align 4
aSetpe		db 'setpe',0            ; DATA XREF: .rdata:10028584o
		align 4
aSetns		db 'setns',0            ; DATA XREF: .rdata:10028520o
		align 4
aSetl		db 'setl',0             ; DATA XREF: .rdata:1002864Co
		align 4
aSetpo		db 'setpo',0            ; DATA XREF: .rdata:100285E8o
		align 4
aSetle		db 'setle',0            ; DATA XREF: .rdata:10028714o
		align 4
aSetge		db 'setge',0            ; DATA XREF: .rdata:100286B0o
		align 4
aCpuid		db 'cpuid',0            ; DATA XREF: .rdata:100288A4o
		align 4
aSetg		db 'setg',0             ; DATA XREF: .rdata:10028778o
		align 4
aShld		db 'shld',0             ; DATA XREF: .rdata:1002896Co
					; .rdata:100289D0o
		align 4
aBt		db 'bt',0               ; DATA XREF: .rdata:1002418Co
					; .rdata:10028908o
		align 10h
aBts		db 'bts',0              ; DATA XREF: .rdata:100241F0o
					; .rdata:10028C28o
aRsm		db 'rsm',0              ; DATA XREF: .rdata:10028BC4o
aCmpxchg	db 'cmpxchg',0          ; DATA XREF: .rdata:10028E1Co
					; .rdata:10028E80o
aShrd		db 'shrd',0             ; DATA XREF: .rdata:10028C8Co
					; .rdata:10028CF0o
		align 4
aBtr		db 'btr',0              ; DATA XREF: .rdata:10024254o
					; .rdata:10028F48o
aLss		db 'lss',0              ; DATA XREF: .rdata:10028EE4o
aLgs		db 'lgs',0              ; DATA XREF: .rdata:10029010o
aLfs		db 'lfs',0              ; DATA XREF: .rdata:10028FACo
aUd1		db 'ud1',0              ; DATA XREF: .rdata:100291A0o
aMovzx		db 'movzx',0            ; DATA XREF: .rdata:10029074o
					; .rdata:100290D8o
		align 4
aBsf		db 'bsf',0              ; DATA XREF: .rdata:100292CCo
aBtc		db 'btc',0              ; DATA XREF: .rdata:100242B8o
					; .rdata:10029268o
aMovsx		db 'movsx',0            ; DATA XREF: .rdata:10029394o
					; .rdata:100293F8o
		align 4
aBsr		db 'bsr',0              ; DATA XREF: .rdata:10029330o
aCmpps		db 'cmpps',0            ; DATA XREF: .rdata:10029524o
		align 10h
aXadd		db 'xadd',0             ; DATA XREF: .rdata:1002945Co
					; .rdata:100294C0o
		align 4
aCmppd		db 'cmppd',0            ; DATA XREF: .rdata:10029570o
		align 10h
aCmpss		db 'cmpss',0            ; DATA XREF: .rdata:10029558o
		align 4
aPextrw		db 'pextrw',0           ; DATA XREF: .rdata:10029650o
					; .rdata:1002969Co
		align 10h
aPinsrw		db 'pinsrw',0           ; DATA XREF: .rdata:100295ECo
					; .rdata:10029638o
		align 4
aShufpd		db 'shufpd',0           ; DATA XREF: .rdata:10029700o
		align 10h
aShufps		db 'shufps',0           ; DATA XREF: .rdata:100296B4o
		align 4
aPsrlw		db 'psrlw',0            ; DATA XREF: .rdata:100223DCo
					; .rdata:10022428o ...
		align 10h
aBswap		db 'bswap',0            ; DATA XREF: .rdata:1002977Co
					; .rdata:100297E0o ...
		align 4
aPsrlq		db 'psrlq',0            ; DATA XREF: .rdata:10023764o
					; .rdata:100237B0o ...
		align 10h
aPsrld		db 'psrld',0            ; DATA XREF: .rdata:10029B64o
					; .rdata:10029BB0o ...
		align 4
aPmullw		db 'pmullw',0           ; DATA XREF: .rdata:10029C90o
					; .rdata:10029CDCo
		align 10h
aPaddq		db 'paddq',0            ; DATA XREF: .rdata:10029C2Co
					; .rdata:10029C78o
		align 4
aMovdq2q	db 'movdq2q',0          ; DATA XREF: .rdata:10029D10o
aUnusedWithoutP	db 'unused without prefix',0 ; DATA XREF: .rdata:10029CF4o
		align 4
aPmovmskb	db 'pmovmskb',0         ; DATA XREF: .rdata:10029D58o
					; .rdata:10029DA4o
		align 4
aMovq2dq	db 'movq2dq',0          ; DATA XREF: .rdata:10029D28o
aPsubusw	db 'psubusw',0          ; DATA XREF: .rdata:10029E20o
					; .rdata:10029E6Co
aPsubusb	db 'psubusb',0          ; DATA XREF: .rdata:10029DBCo
					; .rdata:10029E08o
aPand		db 'pand',0             ; DATA XREF: .rdata:10029EE8o
					; .rdata:10029F34o
		align 4
aPminub		db 'pminub',0           ; DATA XREF: .rdata:10029E84o
					; .rdata:10029ED0o
		align 4
aPaddusw	db 'paddusw',0          ; DATA XREF: .rdata:10029FB0o
					; .rdata:10029FFCo
aPaddusb	db 'paddusb',0          ; DATA XREF: .rdata:10029F4Co
					; .rdata:10029F98o
aPandn		db 'pandn',0            ; DATA XREF: .rdata:1002A078o
					; .rdata:1002A0C4o
		align 4
aPmaxub		db 'pmaxub',0           ; DATA XREF: .rdata:1002A014o
					; .rdata:1002A060o
		align 4
aPsraw		db 'psraw',0            ; DATA XREF: .rdata:100224A4o
					; .rdata:100224F0o ...
		align 4
aPavgb		db 'pavgb',0            ; DATA XREF: .rdata:1002A0DCo
					; .rdata:1002A128o
		align 4
aPsrad		db 'psrad',0            ; DATA XREF: .rdata:1002A1A4o
					; .rdata:1002A1F0o ...
		align 4
aPsrqw		db 'psrqw',0            ; DATA XREF: .rdata:1002A18Co
		align 4
aPmulhuw	db 'pmulhuw',0          ; DATA XREF: .rdata:1002A26Co
					; .rdata:1002A2B8o ...
aPavgw		db 'pavgw',0            ; DATA XREF: .rdata:1002A208o
					; .rdata:1002A254o
		align 4
aCvtpd2dq	db 'cvtpd2dq',0         ; DATA XREF: .rdata:1002A350o
		align 4
aPmulhw		db 'pmulhw',0           ; DATA XREF: .rdata:1002A31Co
		align 10h
aCvttpd2dq	db 'cvttpd2dq',0        ; DATA XREF: .rdata:1002A380o
		align 4
aCvtdq2pd	db 'cvtdq2pd',0         ; DATA XREF: .rdata:1002A368o
		align 4
aMovntdq	db 'movntdq',0          ; DATA XREF: .rdata:1002A3E4o
aMovntq		db 'movntq',0           ; DATA XREF: .rdata:1002A398o
		align 4
aPsubsw		db 'psubsw',0           ; DATA XREF: .rdata:1002A460o
					; .rdata:1002A4ACo
		align 10h
aPsubsb		db 'psubsb',0           ; DATA XREF: .rdata:1002A3FCo
					; .rdata:1002A448o
		align 4
aPor		db 'por',0              ; DATA XREF: .rdata:1002A528o
					; .rdata:1002A574o
aPminsw		db 'pminsw',0           ; DATA XREF: .rdata:1002A4C4o
					; .rdata:1002A510o
		align 4
aPaddsw		db 'paddsw',0           ; DATA XREF: .rdata:1002A5F0o
					; .rdata:1002A63Co
		align 4
aPaddsb		db 'paddsb',0           ; DATA XREF: .rdata:1002A58Co
					; .rdata:1002A5D8o
		align 4
aPxor		db 'pxor',0             ; DATA XREF: .rdata:1002A6B8o
					; .rdata:1002A704o
		align 4
aPmaxsw		db 'pmaxsw',0           ; DATA XREF: .rdata:1002A654o
					; .rdata:1002A6A0o
		align 4
aPslld		db 'pslld',0            ; DATA XREF: .rdata:1002A7E4o
					; .rdata:1002A830o ...
		align 4
aPsllw		db 'psllw',0            ; DATA XREF: .rdata:1002256Co
					; .rdata:100225B8o ...
		align 4
aPmuludq	db 'pmuludq',0          ; DATA XREF: .rdata:1002A8ACo
					; .rdata:1002A8F8o
aPsllq		db 'psllq',0            ; DATA XREF: .rdata:100238F4o
					; .rdata:10023940o ...
		align 4
aPsadbw		db 'psadbw',0           ; DATA XREF: .rdata:1002A974o
					; .rdata:1002A9C0o
		align 4
aPmaddwd	db 'pmaddwd',0          ; DATA XREF: .rdata:1002A910o
					; .rdata:1002A95Co
aMaskmovdqu	db 'maskmovdqu',0       ; DATA XREF: .rdata:1002AA24o
		align 10h
aMaskmovq	db 'maskmovq',0         ; DATA XREF: .rdata:1002A9D8o
		align 4
aPsubw		db 'psubw',0            ; DATA XREF: .rdata:1002AAA0o
					; .rdata:1002AAECo
		align 4
aPsubb		db 'psubb',0            ; DATA XREF: .rdata:1002AA3Co
					; .rdata:1002AA88o
		align 4
aPsubq		db 'psubq',0            ; DATA XREF: .rdata:1002AB68o
					; .rdata:1002ABB4o
		align 4
aPsubd		db 'psubd',0            ; DATA XREF: .rdata:1002AB04o
					; .rdata:1002AB50o
		align 4
aPaddw		db 'paddw',0            ; DATA XREF: .rdata:1002AC30o
					; .rdata:1002AC7Co
		align 4
aPaddb		db 'paddb',0            ; DATA XREF: .rdata:1002ABCCo
					; .rdata:1002AC18o
		align 4
aSldt		db 'sldt',0             ; DATA XREF: .rdata:1001B5B4o
		align 4
aPaddd		db 'paddd',0            ; DATA XREF: .rdata:1002AC94o
					; .rdata:1002ACE0o
		align 4
aLldt		db 'lldt',0             ; DATA XREF: .rdata:1001B67Co
		align 4
aStr		db 'str',0              ; DATA XREF: .rdata:1001B618o
aVerr		db 'verr',0             ; DATA XREF: .rdata:1001B744o
		align 10h
aLtr		db 'ltr',0              ; DATA XREF: .rdata:1001B6E0o
aSgdt		db 'sgdt',0             ; DATA XREF: .rdata:1001ADE4o
		align 4
aVerw		db 'verw',0             ; DATA XREF: .rdata:1001B7A8o
		align 4
aLgdt		db 'lgdt',0             ; DATA XREF: .rdata:1001AEACo
		align 4
aSidt		db 'sidt',0             ; DATA XREF: .rdata:1001AE48o
		align 4
aSmsw		db 'smsw',0             ; DATA XREF: .rdata:1001AF74o
		align 4
aLidt		db 'lidt',0             ; DATA XREF: .rdata:1001AF10o
		align 4
aInvlpg		db 'invlpg',0           ; DATA XREF: .rdata:1001B0A0o
		align 4
aLmsw		db 'lmsw',0             ; DATA XREF: .rdata:1001B03Co
		align 4
aPslldq		db 'pslldq',0           ; DATA XREF: .rdata:10023958o
					; .rdata:100239A4o
		align 4
aPrefetch	db 'prefetch',0         ; DATA XREF: .rdata:1001B104o
					; .rdata:1001B168o ...
		align 4
aFxrstor	db 'fxrstor',0          ; DATA XREF: .rdata:100229B8o
aFxsave		db 'fxsave',0           ; DATA XREF: .rdata:10022954o
		align 4
aStmxcsr	db 'stmxcsr',0          ; DATA XREF: .rdata:10022A80o
aLdmxcsr	db 'ldmxcsr',0          ; DATA XREF: .rdata:10022A1Co
aMfence		db 'mfence',0           ; DATA XREF: .rdata:10022BACo
		align 10h
aLfence		db 'lfence',0           ; DATA XREF: .rdata:10022B48o
		align 4
aCmpxch8b	db 'cmpxch8b',0         ; DATA XREF: .rdata:1001B550o
		align 4
aClflushSfence	db 'clflush/sfence',0   ; DATA XREF: .rdata:10022C10o
		align 4
aRor		db 'ror',0              ; DATA XREF: .rdata:10022058o
					; .rdata:10022698o ...
aRol		db 'rol',0              ; DATA XREF: .rdata:10021FF4o
					; .rdata:10022634o ...
aRcr		db 'rcr',0              ; DATA XREF: .rdata:10022120o
					; .rdata:10022760o ...
aRcl		db 'rcl',0              ; DATA XREF: .rdata:100220BCo
					; .rdata:100226FCo ...
aShr		db 'shr',0              ; DATA XREF: .rdata:100221E8o
					; .rdata:10022828o ...
aShl		db 'shl',0              ; DATA XREF: .rdata:10022184o
					; .rdata:100227C4o ...
aSar		db 'sar',0              ; DATA XREF: .rdata:100222B0o
					; .rdata:100228F0o ...
aSal		db 'sal',0              ; DATA XREF: .rdata:1002224Co
					; .rdata:1002288Co ...
aNeg		db 'neg',0              ; DATA XREF: .rdata:10024448o
					; .rdata:1002AE88o
aNot		db 'not',0              ; DATA XREF: .rdata:100243E4o
					; .rdata:1002AE24o
aDiv		db 'div',0              ; DATA XREF: .rdata:10024574o
					; .rdata:1002AFB4o
aMul		db 'mul',0              ; DATA XREF: .rdata:100244ACo
					; .rdata:1002AEECo
aIdiv		db 'idiv',0             ; DATA XREF: .rdata:100245D8o
					; .rdata:1002B018o
		align 4
; CHAR aNtcreateevent[]
aNtcreateevent	db 'NtCreateEvent',0    ; DATA XREF: sub_10016939+1Do
					; TargetNtCreateEvent(x,x,x,x,x,x)+123o ...
		align 4
a_targetntcre_4	db '_TargetNtCreateEvent@24',0 ; DATA XREF: sub_10016939+16o
; CHAR aNtopenevent[]
aNtopenevent	db 'NtOpenEvent',0      ; DATA XREF: sub_10016939+52o
					; TargetNtOpenEvent(x,x,x,x)+3Do ...
a_targetntop_14	db '_TargetNtOpenEvent@16',0 ; DATA XREF: sub_10016939+4Co
		align 4
off_1002D898	dd offset sub_100099CE	; DATA XREF: sub_1001436D+183o
					; sub_10016916+3o
		dd offset sub_10016939
		dd offset sub_10016916
dword_1002D8A4	dd 0Fh,	1, 2, 7	dup(0)	; DATA XREF: sub_1001436D+191o
		dd offset sub_10016A37
dword_1002D8D0	dd 0Eh,	1, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_1001436D+17Eo
		dd offset sub_100169AA
aNtcreatevent	db 'NtCreatEvent',0     ; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+43o
		align 4
aD:					; DATA XREF: sub_1001719D+78o
		unicode	0, <%d>,0
		align 4
; CHAR aNtopendirector[]
aNtopendirector	db 'NtOpenDirectoryObject',0 ; DATA XREF: sub_10017000+19o
					; sub_1001719D+32o
		align 4
; CHAR aNtopensymbolic[]
aNtopensymbolic	db 'NtOpenSymbolicLinkObject',0 ; DATA XREF: sub_10017000+3Do
		align 4
; CHAR aNtquerysymboli[]
aNtquerysymboli	db 'NtQuerySymbolicLinkObject',0 ; DATA XREF: sub_10017000+2Bo
		align 4
aSessionsBnolin:			; DATA XREF: sub_1001719D+59o
		unicode	0, <\Sessions\BNOLINKS>,0
		align 4
; CHAR aG_shared_sec_0[]
aG_shared_sec_0	db 'g_shared_section',0 ; DATA XREF: sub_10017B3A+A9o
		align 10h
; CHAR aG_shared_pol_0[]
aG_shared_pol_0	db 'g_shared_policy_size',0 ; DATA XREF: sub_10017B3A+10Bo
		align 4
; CHAR aG_shared_ipc_0[]
aG_shared_ipc_0	db 'g_shared_IPC_size',0 ; DATA XREF: sub_10017B3A+E2o
		align 4
off_1002D9CC	dd offset sub_10017D68	; DATA XREF: sub_10013CB8+27o
		dd offset sub_10017D76
		dd offset sub_10017ED4
		dd offset sub_10017ED8
aHkey_classes_r:			; DATA XREF: .rdata:off_1002B9E0o
		unicode	0, <HKEY_CLASSES_ROOT>,0
aHkey_users:				; DATA XREF: .rdata:1002B9F8o
		unicode	0, <HKEY_USERS>,0
		align 4
aHkey_local_m_2:			; DATA XREF: .rdata:1002B9F0o
		unicode	0, <HKEY_LOCAL_MACHINE>,0
		align 10h
aHkey_perform_0:			; DATA XREF: .rdata:1002BA08o
		unicode	0, <HKEY_PERFORMANCE_TEXT>,0
aHkey_performan:			; DATA XREF: .rdata:1002BA00o
		unicode	0, <HKEY_PERFORMANCE_DATA>,0
aHkey_current_c:			; DATA XREF: .rdata:1002BA18o
		unicode	0, <HKEY_CURRENT_CONFIG>,0
aHkey_perform_1:			; DATA XREF: .rdata:1002BA10o
		unicode	0, <HKEY_PERFORMANCE_NLSTEXT>,0
		align 4
aPipe:					; DATA XREF: sub_10018006:loc_1001803Bo
		unicode	0, <pipe\>,0
aHkey_dyn_data:				; DATA XREF: .rdata:1002BA20o
		unicode	0, <HKEY_DYN_DATA>,0
aSbox_alternate:			; DATA XREF: sub_100189A5+1Do
		unicode	0, <sbox_alternate_desktop_>,0
; wchar_t Format
Format:					; DATA XREF: sub_100189A5+2Eo
		unicode	0, <0x%X>,0
		align 4
flt_1002DB58	dd 4.2949673e9		; DATA XREF: sub_100060D9+19r
					; sub_100060D9+2Fr
		align 10h
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 1			; SEHandlerCount
; Debug	information (IMAGE_DEBUG_TYPE_CODEVIEW)
asc_1002DBA8	db 'RSDS'               ; DATA XREF: .rdata:1001A3B4o
					; CV signature
		dd 5D93741Dh		; Data1	; GUID
		dw 0B5ACh		; Data2
		dw 4073h		; Data3
		db 8Bh,	2Bh, 25h, 3Ch, 85h, 32h, 9Ch, 32h; Data4
		dd 2			; Age
		db 'c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\obj-fir' ; PdbFileName
		db 'efox\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb',0
		align 10h
; Debug	information (type 12)
dword_1002DC40	dd 0			; DATA XREF: .rdata:1001A3D0o
		dd 2 dup(7Ah), 2 dup(0)
; Debug	information (IMAGE_DEBUG_TYPE_RESERVED10)
dword_1002DC54	dd 50475500h, 2	dup(0)	; DATA XREF: .rdata:1001A3ECo
___safe_se_handler_table dd rva	__except_handler4 ; DATA XREF: .rdata:1002DBA0o
		align 8
dword_1002DC68	dd 2 dup(0)		; DATA XREF: sub_100195DF+2o
					; sub_100195DF+7o
dword_1002DC70	dd 2 dup(0)		; DATA XREF: sub_100195FF+2o
					; sub_100195FF+7o
stru_1002DC78	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10004532+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10004532
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000456B	; ScopeRecord.FilterFunc
		dd offset loc_1000456F	; ScopeRecord.HandlerFunc
		align 8
stru_1002DC98	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100097E2+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100097E2
		dd 0FFFFFFB4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10009915	; ScopeRecord.FilterFunc
		dd offset loc_10009919	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCB8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000A353+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A353
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A391	; ScopeRecord.FilterFunc
		dd offset loc_1000A395	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCD8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000A3A8+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A3A8
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A3D3	; ScopeRecord.FilterFunc
		dd offset loc_1000A3D7	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCF8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A3EB
		dd 0FFFFFF7Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A5A0	; ScopeRecord.FilterFunc
		dd offset loc_1000A5A4	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD18	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A5C9
		dd 0FFFFFF7Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A761	; ScopeRecord.FilterFunc
		dd offset loc_1000A765	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD38	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000AAB4
		dd 0FFFFFF58h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000AC7C	; ScopeRecord.FilterFunc
		dd offset loc_1000AC80	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD58	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B0E0+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B0E0
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B178	; ScopeRecord.FilterFunc
		dd offset loc_1000B17C	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD78	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B190+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B190
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B228	; ScopeRecord.FilterFunc
		dd offset loc_1000B22C	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD98	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B240+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B240
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B2D8	; ScopeRecord.FilterFunc
		dd offset loc_1000B2DC	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDB8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000C7E4+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000C7E4
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000C825	; ScopeRecord.FilterFunc
		dd offset loc_1000C838	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDD8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000D595+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000D595
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000D62D	; ScopeRecord.FilterFunc
		dd offset loc_1000D631	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDF8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenThread(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010D1C
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010E36	; ScopeRecord.FilterFunc
		dd offset loc_10010E3A	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010E30	; ScopeRecord.FilterFunc
		dd offset loc_10010E34	; ScopeRecord.HandlerFunc
stru_1002DE20	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcess(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010E51
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010F45	; ScopeRecord.FilterFunc
		dd offset loc_10010F49	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010F3F	; ScopeRecord.FilterFunc
		dd offset loc_10010F43	; ScopeRecord.HandlerFunc
stru_1002DE48	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessToken(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010F60
		dd 0FFFFFF98h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011021	; ScopeRecord.FilterFunc
		dd offset loc_10011025	; ScopeRecord.HandlerFunc
		align 8
stru_1002DE68	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001103C
		dd 0FFFFFF9Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011104	; ScopeRecord.FilterFunc
		dd offset loc_10011108	; ScopeRecord.HandlerFunc
		align 8
stru_1002DE88	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100118BA+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100118BA
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011952	; ScopeRecord.FilterFunc
		dd offset loc_10011956	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEA8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012018
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10012196	; ScopeRecord.FilterFunc
		dd offset loc_1001219A	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEC8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100121B1+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100121B1
		dd 0FFFFFF8Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001229B	; ScopeRecord.FilterFunc
		dd offset loc_1001229F	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEE8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10012537+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10012537
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100125CF	; ScopeRecord.FilterFunc
		dd offset loc_100125D3	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF08	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013E2B+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013E2B
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013E8E	; ScopeRecord.FilterFunc
		dd offset loc_10013E92	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF28	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013EA4+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013EA4
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013EC5	; ScopeRecord.FilterFunc
		dd offset loc_10013ED3	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF48	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013EE8+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013EE8
		dd 0FFFFFFBCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013FD7	; ScopeRecord.FilterFunc
		dd offset loc_10013FE5	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF68	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001410D+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001410D
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1001418C	; ScopeRecord.FilterFunc
		dd offset loc_10014190	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF88	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016C1A
		dd 0FFFFFF84h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10016D4A	; ScopeRecord.FilterFunc
		dd offset loc_10016D4E	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFA8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenEvent(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016D65
		dd 0FFFFFF80h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10016E89	; ScopeRecord.FilterFunc
		dd offset loc_10016E8D	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFC8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018D8D+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018D8D
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018E2A	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFE8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: ___DllMainCRTStartup+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100190C4
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset $LN18		; ScopeRecord.HandlerFunc
		dd 0			; ScopeRecord.EnclosingLevel
		dd offset $LN22		; ScopeRecord.FilterFunc
		dd offset $LN23		; ScopeRecord.HandlerFunc
stru_1002E010	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: __IsNonwritableInCurrentImage+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10019430
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100194B9	; ScopeRecord.FilterFunc
		dd offset loc_100194CC	; ScopeRecord.HandlerFunc
		align 10h
;
; Export directory for sandboxbroker.dll
;
		dd 0			; Characteristics
		dd 56E8A9CFh		; TimeDateStamp: Wed Mar 16 00:33:19 2016
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSandboxbroker_	; Name
		dd 1			; Base
		dd 32h			; NumberOfFunctions
		dd 32h			; NumberOfNames
		dd rva off_1002E058	; AddressOfFunctions
		dd rva off_1002E120	; AddressOfNames
		dd rva word_1002E1E8	; AddressOfNameOrdinals
;
; Export Address Table for sandboxbroker.dll
;
off_1002E058	dd rva ??0SandboxBroker@mozilla@@QAE@ABV01@@Z, rva ??0SandboxBroker@mozilla@@QAE@XZ
					; DATA XREF: .rdata:1002E04Co
		dd rva ??1SandboxBroker@mozilla@@UAE@XZ, rva ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z ; mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker	const &)
		dd rva ??_7SandboxBroker@mozilla@@6B@, rva ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z
		dd rva ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
		dd rva ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
		dd rva ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
		dd rva ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		dd rva IsSandboxedProcess, rva _TargetCreateNamedPipeW@36
		dd rva _TargetCreateProcessA@44, rva _TargetCreateProcessW@44
		dd rva _TargetGdiDllInitialize@12, rva _TargetGetStockObject@8
		dd rva _TargetNtCreateEvent@24,	rva _TargetNtCreateFile@48
		dd rva _TargetNtCreateKey@32, rva _TargetNtMapViewOfSection@44
		dd rva _TargetNtOpenEvent@16, rva _TargetNtOpenFile@28
		dd rva _TargetNtOpenKey@16, rva	_TargetNtOpenKeyEx@20
		dd rva _TargetNtOpenProcess@20,	rva _TargetNtOpenProcessToken@16
		dd rva _TargetNtOpenProcessTokenEx@20, rva _TargetNtOpenThread@20
		dd rva _TargetNtOpenThreadToken@20, rva	_TargetNtOpenThreadTokenEx@24
		dd rva _TargetNtQueryAttributesFile@12,	rva _TargetNtQueryFullAttributesFile@12
		dd rva _TargetNtSetInformationFile@24, rva _TargetNtSetInformationThread@20
		dd rva _TargetNtUnmapViewOfSection@12, rva _TargetRegisterClassW@8
		dd rva g_handles_to_close, rva g_interceptions,	rva g_nt
		dd rva g_originals, rva	g_shared_IPC_size, rva g_shared_delayed_integrity_level
		dd rva g_shared_delayed_mitigations, rva g_shared_policy_size
		dd rva g_shared_section
;
; Export Names Table for sandboxbroker.dll
;
off_1002E120	dd rva a??0sandboxbrok,	rva a??0sandboxbr_0, rva a??1sandboxbrok
					; DATA XREF: .rdata:1002E050o
		dd rva a??4sandboxbrok,	rva a??_7sandboxbro, rva a?addtargetpeer ; "??0SandboxBroker@mozilla@@QAE@ABV01@@Z"
		dd rva a?allowdirector,	rva a?allowreadfile, rva a?allowreadwrit
		dd rva a?launchapp@san,	rva a?providelogfun, rva a?setsecurityle
		dd rva a?setsecurity_0,	rva a?setsecurity_1, rva a?sbrokerservic
		dd rva aIssandboxedpro,	rva a_targetcreaten, rva a_targetcreatep
		dd rva a_targetcreat_0,	rva a_targetgdidlli, rva a_targetgetstoc
		dd rva a_targetntcreat,	rva a_targetntcre_0, rva a_targetntcre_1
		dd rva a_targetntmapvi,	rva a_targetntopene, rva a_targetntopenf
		dd rva a_targetntopenk,	rva a_targetntope_0, rva a_targetntopenp
		dd rva a_targetntope_1,	rva a_targetntope_2, rva a_targetntopent
		dd rva a_targetntope_3,	rva a_targetntope_4, rva a_targetntquery
		dd rva a_targetntque_0,	rva a_targetntsetin, rva a_targetntset_0
		dd rva a_targetntunmap,	rva a_targetregiste, rva aG_handles_to_c
		dd rva aG_interception,	rva aG_nt, rva aG_originals, rva aG_shared_ipc_s
		dd rva aG_shared_delay,	rva aG_shared_del_0, rva aG_shared_polic
		dd rva aG_shared_secti
;
; Export Ordinals Table	for sandboxbroker.dll
;
word_1002E1E8	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:1002E054o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h,	31h
aSandboxbroker_	db 'sandboxbroker.dll',0 ; DATA XREF: .rdata:1002E03Co
a??0sandboxbrok	db '??0SandboxBroker@mozilla@@QAE@ABV01@@Z',0
					; DATA XREF: .rdata:off_1002E120o
a??0sandboxbr_0	db '??0SandboxBroker@mozilla@@QAE@XZ',0 ; DATA XREF: .rdata:off_1002E120o
a??1sandboxbrok	db '??1SandboxBroker@mozilla@@UAE@XZ',0 ; DATA XREF: .rdata:off_1002E120o
a??4sandboxbrok	db '??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z',0
					; DATA XREF: .rdata:off_1002E120o
a??_7sandboxbro	db '??_7SandboxBroker@mozilla@@6B@',0 ; DATA XREF: .rdata:off_1002E120o
a?addtargetpeer	db '?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowdirector	db '?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowreadfile	db '?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowreadwrit	db '?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?launchapp@san	db '?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?providelogfun	db '?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?setsecurityle	db '?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ',0
					; DATA XREF: .rdata:off_1002E120o
a?setsecurity_0	db '?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QA'
					; DATA XREF: .rdata:off_1002E120o
		db 'E_NXZ',0
a?setsecurity_1	db '?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z'
					; DATA XREF: .rdata:off_1002E120o
		db 0
a?sbrokerservic	db '?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox'
					; DATA XREF: .rdata:off_1002E120o
		db '@@A',0
aIssandboxedpro	db 'IsSandboxedProcess',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreaten	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreatep	db '_TargetCreateProcessA@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreat_0	db '_TargetCreateProcessW@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetgdidlli	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetgetstoc	db '_TargetGetStockObject@8',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcreat	db '_TargetNtCreateEvent@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcre_0	db '_TargetNtCreateFile@48',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcre_1	db '_TargetNtCreateKey@32',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntmapvi	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopene	db '_TargetNtOpenEvent@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenf	db '_TargetNtOpenFile@28',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenk	db '_TargetNtOpenKey@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_0	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenp	db '_TargetNtOpenProcess@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_1	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_2	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopent	db '_TargetNtOpenThread@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_3	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_4	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntquery	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntque_0	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntsetin	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntset_0	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntunmap	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetregiste	db '_TargetRegisterClassW@8',0 ; DATA XREF: .rdata:off_1002E120o
aG_handles_to_c	db 'g_handles_to_close',0 ; DATA XREF: .rdata:off_1002E120o
aG_interception	db 'g_interceptions',0  ; DATA XREF: .rdata:off_1002E120o
aG_nt		db 'g_nt',0             ; DATA XREF: .rdata:off_1002E120o
aG_originals	db 'g_originals',0      ; DATA XREF: .rdata:off_1002E120o
aG_shared_ipc_s	db 'g_shared_IPC_size',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_delay	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_del_0	db 'g_shared_delayed_mitigations',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_polic	db 'g_shared_policy_size',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_secti	db 'g_shared_section',0 ; DATA XREF: .rdata:off_1002E120o
		align 10h
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_1002E9A0 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva QueryPerformanceCounter ; Import	Address	Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_1002EC7C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva CreateWindowStationW ; Import Address Table
__IMPORT_DESCRIPTOR_WINMM dd rva off_1002ECA0 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWinmm_dll	; DLL Name
		dd rva __imp_timeGetTime ; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_1002E93C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva CopySid		; Import Address Table
__IMPORT_DESCRIPTOR_MSVCP120 dd	rva off_1002EAE8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcp120_dll	; DLL Name
		dd rva __imp_?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; Import Address Table
__IMPORT_DESCRIPTOR_MSVCR120 dd	rva off_1002EBE4 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcr120_dll	; DLL Name
		dd rva __imp__amsg_exit	; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_1002E93C	dd rva word_1002F50E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_1002F578
		dd rva word_1002F56A
		dd rva word_1002F55A
		dd rva word_1002F54A
		dd rva word_1002F52E
		dd rva word_1002F518
		dd rva word_1002F4FE
		dd rva word_1002F4E2
		dd rva word_1002F4AA
		dd rva word_1002F492
		dd rva word_1002F480
		dd rva word_1002F468
		dd rva word_1002F45C
		dd rva word_1002F444
		dd rva word_1002F430
		dd rva word_1002F41C
		dd rva word_1002F40A
		dd rva word_1002F3F0
		dd rva word_1002F3DC
		dd rva word_1002F3CA
		dd rva word_1002F3B8
		dd rva word_1002F3A2
		dd rva word_1002F38C
		dd 0
;
; Import names for KERNEL32.dll
;
off_1002E9A0	dd rva word_1002EE1E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1002EE38
		dd rva word_1002EE52
		dd rva word_1002EE6E
		dd rva word_1002EE82
		dd rva word_1002EE98
		dd rva word_1002EEA8
		dd rva word_1002EEBA
		dd rva word_1002EEC6
		dd rva word_1002EEDA
		dd rva word_1002EEF0
		dd rva word_1002EF06
		dd rva word_1002EF18
		dd rva word_1002EF26
		dd rva word_1002EF36
		dd rva word_1002EF4C
		dd rva word_1002EF5C
		dd rva word_1002EF68
		dd rva word_1002EF82
		dd rva word_1002EF9E
		dd rva word_1002EFBA
		dd rva word_1002EFCA
		dd rva word_1002EFE8
		dd rva word_1002F006
		dd rva word_1002F020
		dd rva word_1002F036
		dd rva word_1002F04A
		dd rva word_1002F05A
		dd rva word_1002F072
		dd rva word_1002F080
		dd rva word_1002F098
		dd rva word_1002F0A6
		dd rva word_1002F0BC
		dd rva word_1002F0CA
		dd rva word_1002F0EE
		dd rva word_1002F102
		dd rva word_1002F11E
		dd rva word_1002F132
		dd rva word_1002F13E
		dd rva word_1002F14C
		dd rva word_1002F15E
		dd rva word_1002F172
		dd rva word_1002F188
		dd rva word_1002F196
		dd rva word_1002F1AE
		dd rva word_1002F1C2
		dd rva word_1002F1D2
		dd rva word_1002F1E0
		dd rva word_1002F1F6
		dd rva word_1002F206
		dd rva word_1002F218
		dd rva word_1002F230
		dd rva word_1002F244
		dd rva word_1002F254
		dd rva word_1002F26A
		dd rva word_1002F280
		dd rva word_1002F294
		dd rva word_1002ECA8
		dd rva word_10030682
		dd rva word_10030666
		dd rva word_10030656
		dd rva word_10030646
		dd rva word_1002ECB8
		dd rva word_1002ECC6
		dd rva word_1002ECD6
		dd rva word_1002ECE6
		dd rva word_1002ECF6
		dd rva word_1002ED0C
		dd rva word_1002ED1E
		dd rva word_1002ED46
		dd rva word_1002ED5E
		dd rva word_1002EE0E
		dd rva word_1002EDFC
		dd rva word_1002EDE6
		dd rva word_1002EDD2
		dd rva word_1002EDC0
		dd rva word_1002EDB8
		dd rva word_1002EDA2
		dd rva word_1002ED8E
		dd rva word_1002ED76
		dd rva word_1002F0DA
		dd 0
;
; Import names for MSVCP120.dll
;
off_1002EAE8	dd rva word_10030316	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCP120o
		dd rva word_10030358
		dd rva word_10030396
		dd rva word_1002F80A
		dd rva word_100303C0
		dd rva word_100303FC
		dd rva word_1003041E
		dd rva word_100302D2
		dd rva word_1002F598
		dd rva word_1002F5B8
		dd rva word_1002F5D8
		dd rva word_1002F5F2
		dd rva word_1002F612
		dd rva word_1002F632
		dd rva word_1002F648
		dd rva word_1002F688
		dd rva word_1002F6C8
		dd rva word_1002F70E
		dd rva word_1002F74C
		dd rva word_1002F78C
		dd rva word_1002F7CE
		dd rva word_1003028C
		dd rva word_1002F840
		dd rva word_1002F882
		dd rva word_1002F8BC
		dd rva word_1002F926
		dd rva word_1002F966
		dd rva word_1002F99C
		dd rva word_1002F9E8
		dd rva word_1002FA26
		dd rva word_1002FA70
		dd rva word_1002FAB6
		dd rva word_1002FAFC
		dd rva word_1002FB3C
		dd rva word_1002FB80
		dd rva word_1002FBC2
		dd rva word_1002FC02
		dd rva word_1002FC3E
		dd rva word_1002FC62
		dd rva word_1002FC7C
		dd rva word_1002FC96
		dd rva word_1002FCCA
		dd rva word_1002FD12
		dd rva word_1002FD56
		dd rva word_1002FD9A
		dd rva word_1002FDDA
		dd rva word_1002FE18
		dd rva word_1002FE86
		dd rva word_1002FEBE
		dd rva word_1002FF04
		dd rva word_1002FF46
		dd rva word_1002FF88
		dd rva word_1002FFC4
		dd rva word_10030006
		dd rva word_10030060
		dd rva word_100300A2
		dd rva word_100300DA
		dd rva word_10030128
		dd rva word_10030168
		dd rva word_100301B6
		dd rva word_10030200
		dd rva word_1003024A
		dd 0
;
; Import names for MSVCR120.dll
;
off_1002EBE4	dd rva word_1003058A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCR120o
		dd rva word_10030598
		dd rva word_100305A6
		dd rva word_100305B2
		dd rva word_100305C0
		dd rva word_100305D6
		dd rva word_100305F0
		dd rva word_10030608
		dd rva word_10030622
		dd rva word_1003069E
		dd rva word_100306A8
		dd rva word_100306B2
		dd rva word_10030448
		dd rva word_10030452
		dd rva word_1003045E
		dd rva word_1003046E
		dd rva word_1003047E
		dd rva word_1003048A
		dd rva word_1003049A
		dd rva word_100304AA
		dd rva word_100304B2
		dd rva word_100304BC
		dd rva word_100304CC
		dd rva word_100304D4
		dd rva word_100304DE
		dd rva word_100304E8
		dd rva word_100304F4
		dd rva word_10030500
		dd rva word_1003050A
		dd rva word_10030516
		dd rva word_10030522
		dd rva word_10030540
		dd rva word_10030548
		dd rva word_10030552
		dd rva word_10030560
		dd rva word_1003056E
		dd rva word_10030578
		dd 0
;
; Import names for USER32.dll
;
off_1002EC7C	dd rva word_1002F310	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_1002F2B4
		dd rva word_1002F2C4
		dd rva word_1002F356
		dd rva word_1002F33C
		dd rva word_1002F328
		dd rva word_1002F2DA
		dd rva word_1002F2F6
		dd 0
;
; Import names for WINMM.dll
;
off_1002ECA0	dd rva word_1002F374	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WINMMo
		dd 0
word_1002ECA8	dw 2C0h			; DATA XREF: .rdata:1002EA84o
		db 'GetStdHandle',0
		align 4
word_1002ECB8	dw 7Fh			; DATA XREF: .rdata:1002EA98o
		db 'CloseHandle',0
word_1002ECC6	dw 4A7h			; DATA XREF: .rdata:1002EA9Co
		db 'ResumeThread',0
		align 2
word_1002ECD6	dw 250h			; DATA XREF: .rdata:1002EAA0o
		db 'GetLastError',0
		align 2
word_1002ECE6	dw 50Ah			; DATA XREF: .rdata:1002EAA4o
		db 'SetLastError',0
		align 2
word_1002ECF6	dw 266h			; DATA XREF: .rdata:1002EAA8o
		db 'GetModuleHandleExW',0
		align 4
word_1002ED0C	dw 29Dh			; DATA XREF: .rdata:1002EAACo
		db 'GetProcAddress',0
		align 2
word_1002ED1E	dw 348h			; DATA XREF: .rdata:1002EAB0o
		db 'InitializeCriticalSectionAndSpinCount',0
word_1002ED46	dw 3A2h			; DATA XREF: .rdata:1002EAB4o
		db 'LeaveCriticalSection',0
		align 2
word_1002ED5E	dw 125h			; DATA XREF: .rdata:1002EAB8o
		db 'EnterCriticalSection',0
		align 2
word_1002ED76	dw 105h			; DATA XREF: .rdata:1002EADCo
		db 'DeleteCriticalSection',0
word_1002ED8E	dw 209h			; DATA XREF: .rdata:1002EAD8o
		db 'GetCurrentProcess',0
word_1002EDA2	dw 5A9h			; DATA XREF: .rdata:1002EAD4o
		db 'WaitForSingleObject',0
word_1002EDB8	dw 550h			; DATA XREF: .rdata:1002EAD0o
		db 'Sleep',0
word_1002EDC0	dw 43Fh			; DATA XREF: .rdata:1002EACCo
		db 'RaiseException',0
		align 2
word_1002EDD2	dw 367h			; DATA XREF: .rdata:1002EAC8o
		db 'IsDebuggerPresent',0
word_1002EDE6	dw 20Eh			; DATA XREF: .rdata:1002EAC4o
		db 'GetCurrentThreadId',0
		align 4
word_1002EDFC	dw 11Fh			; DATA XREF: .rdata:1002EAC0o
		db 'DuplicateHandle',0
word_1002EE0E	dw 0E8h			; DATA XREF: .rdata:1002EABCo
		db 'CreateThread',0
		align 2
word_1002EE1E	dw 42Dh			; DATA XREF: .rdata:off_1002E9A0o
		db 'QueryPerformanceCounter',0
word_1002EE38	dw 2D6h			; DATA XREF: .rdata:1002E9A4o
		db 'GetSystemTimeAsFileTime',0
word_1002EE52	dw 42Eh			; DATA XREF: .rdata:1002E9A8o
		db 'QueryPerformanceFrequency',0
word_1002EE6E	dw 267h			; DATA XREF: .rdata:1002E9ACo
		db 'GetModuleHandleW',0
		align 2
word_1002EE82	dw 274h			; DATA XREF: .rdata:1002E9B0o
		db 'GetNativeSystemInfo',0
word_1002EE98	dw 305h			; DATA XREF: .rdata:1002E9B4o
		db 'GetVersionExW',0
word_1002EEA8	dw 0DBh			; DATA XREF: .rdata:1002E9B8o
		db 'CreateProcessW',0
		align 2
word_1002EEBA	dw 4EFh			; DATA XREF: .rdata:1002E9BCo
		db 'SetEvent',0
		align 2
word_1002EEC6	dw 452h			; DATA XREF: .rdata:1002E9C0o
		db 'ReadProcessMemory',0
word_1002EEDA	dw 22Ch			; DATA XREF: .rdata:1002E9C4o
		db 'GetExitCodeProcess',0
		align 10h
word_1002EEF0	dw 263h			; DATA XREF: .rdata:1002E9C8o
		db 'GetModuleFileNameW',0
		align 2
word_1002EF06	dw 59Ah			; DATA XREF: .rdata:1002E9CCo
		db 'VirtualAllocEx',0
		align 4
word_1002EF18	dw 4A1h			; DATA XREF: .rdata:1002E9D0o
		db 'ResetEvent',0
		align 2
word_1002EF26	dw 0B6h			; DATA XREF: .rdata:1002E9D4o
		db 'CreateEventW',0
		align 2
word_1002EF36	dw 5E8h			; DATA XREF: .rdata:1002E9D8o
		db 'WriteProcessMemory',0
		align 4
word_1002EF4C	dw 558h			; DATA XREF: .rdata:1002E9DCo
		db 'SuspendThread',0
word_1002EF5C	dw 3B2h			; DATA XREF: .rdata:1002E9E0o
		db 'LocalFree',0
word_1002EF68	dw 508h			; DATA XREF: .rdata:1002E9E4o
		db 'SetInformationJobObject',0
word_1002EF82	dw 2B8h			; DATA XREF: .rdata:1002E9E8o
		db 'GetQueuedCompletionStatus',0
word_1002EF9E	dw 347h			; DATA XREF: .rdata:1002E9ECo
		db 'InitializeCriticalSection',0
word_1002EFBA	dw 2A4h			; DATA XREF: .rdata:1002E9F0o
		db 'GetProcessId',0
		align 2
word_1002EFCA	dw 484h			; DATA XREF: .rdata:1002E9F4o
		db 'RegisterWaitForSingleObject',0
word_1002EFE8	dw 404h			; DATA XREF: .rdata:1002E9F8o
		db 'PostQueuedCompletionStatus',0
		align 2
word_1002F006	dw 0C7h			; DATA XREF: .rdata:1002E9FCo
		db 'CreateIoCompletionPort',0
		align 10h
word_1002F020	dw 55Eh			; DATA XREF: .rdata:1002EA00o
		db 'TerminateJobObject',0
		align 2
word_1002F036	dw 58Ah			; DATA XREF: .rdata:1002EA04o
		db 'UnregisterWaitEx',0
		align 2
word_1002F04A	dw 59Dh			; DATA XREF: .rdata:1002EA08o
		db 'VirtualFreeEx',0
word_1002F05A	dw 507h			; DATA XREF: .rdata:1002EA0Co
		db 'SetHandleInformation',0
		align 2
word_1002F072	dw 59Ch			; DATA XREF: .rdata:1002EA10o
		db 'VirtualFree',0
word_1002F080	dw 2A1h			; DATA XREF: .rdata:1002EA14o
		db 'GetProcessHandleCount',0
word_1002F098	dw 3EEh			; DATA XREF: .rdata:1002EA18o
		db 'OpenProcess',0
word_1002F0A6	dw 20Ah			; DATA XREF: .rdata:1002EA1Co
		db 'GetCurrentProcessId',0
word_1002F0BC	dw 19Eh			; DATA XREF: .rdata:1002EA20o
		db 'FreeLibrary',0
word_1002F0CA	dw 3A8h			; DATA XREF: .rdata:1002EA24o
		db 'LoadLibraryW',0
		align 2
word_1002F0DA	dw 5A0h			; DATA XREF: .rdata:1002EAE0o
		db 'VirtualProtectEx',0
		align 2
word_1002F0EE	dw 0C9h			; DATA XREF: .rdata:1002EA28o
		db 'CreateJobObjectW',0
		align 2
word_1002F102	dw 1Ch			; DATA XREF: .rdata:1002EA2Co
		db 'AssignProcessToJobObject',0
		align 2
word_1002F11E	dw 0D3h			; DATA XREF: .rdata:1002EA30o
		db 'CreateNamedPipeW',0
		align 2
word_1002F132	dw 609h			; DATA XREF: .rdata:1002EA34o
		db 'lstrlenW',0
		align 2
word_1002F13E	dw 0FBh			; DATA XREF: .rdata:1002EA38o
		db 'DebugBreak',0
		align 4
word_1002F14C	dw 5A2h			; DATA XREF: .rdata:1002EA3Co
		db 'VirtualQueryEx',0
		align 2
word_1002F15E	dw 264h			; DATA XREF: .rdata:1002EA40o
		db 'GetModuleHandleA',0
		align 2
word_1002F172	dw 337h			; DATA XREF: .rdata:1002EA44o
		db 'HeapSetInformation',0
		align 4
word_1002F188	dw 4B1h			; DATA XREF: .rdata:1002EA48o
		db 'SearchPathW',0
word_1002F196	dw 203h			; DATA XREF: .rdata:1002EA4Co
		db 'GetCurrentDirectoryW',0
		align 2
word_1002F1AE	dw 55Fh			; DATA XREF: .rdata:1002EA50o
		db 'TerminateProcess',0
		align 2
word_1002F1C2	dw 2F2h			; DATA XREF: .rdata:1002EA54o
		db 'GetTickCount',0
		align 2
word_1002F1D2	dw 23Eh			; DATA XREF: .rdata:1002EA58o
		db 'GetFileType',0
word_1002F1E0	dw 54Eh			; DATA XREF: .rdata:1002EA5Co
		db 'SignalObjectAndWait',0
word_1002F1F6	dw 0D1h			; DATA XREF: .rdata:1002EA60o
		db 'CreateMutexW',0
		align 2
word_1002F206	dw 583h			; DATA XREF: .rdata:1002EA64o
		db 'UnmapViewOfFile',0
word_1002F218	dw 410h			; DATA XREF: .rdata:1002EA68o
		db 'ProcessIdToSessionId',0
		align 10h
word_1002F230	dw 2E4h			; DATA XREF: .rdata:1002EA6Co
		db 'GetThreadContext',0
		align 4
word_1002F244	dw 3C0h			; DATA XREF: .rdata:1002EA70o
		db 'MapViewOfFile',0
word_1002F254	dw 0BFh			; DATA XREF: .rdata:1002EA74o
		db 'CreateFileMappingW',0
		align 2
word_1002F26A	dw 235h			; DATA XREF: .rdata:1002EA78o
		db 'GetFileAttributesW',0
		align 10h
word_1002F280	dw 25Dh			; DATA XREF: .rdata:1002EA7Co
		db 'GetLongPathNameW',0
		align 4
word_1002F294	dw 426h			; DATA XREF: .rdata:1002EA80o
		db 'QueryDosDeviceW',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:1002E8BCo
		align 4
word_1002F2B4	dw 4Ch			; DATA XREF: .rdata:1002EC80o
		db 'CloseDesktop',0
		align 4
word_1002F2C4	dw 50h			; DATA XREF: .rdata:1002EC84o
		db 'CloseWindowStation',0
		align 2
word_1002F2DA	dw 1B8h			; DATA XREF: .rdata:1002EC94o
		db 'GetUserObjectInformationW',0
word_1002F2F6	dw 193h			; DATA XREF: .rdata:1002EC98o
		db 'GetProcessWindowStation',0
word_1002F310	dw 75h			; DATA XREF: .rdata:off_1002EC7Co
		db 'CreateWindowStationW',0
		align 4
word_1002F328	dw 1AEh			; DATA XREF: .rdata:1002EC90o
		db 'GetThreadDesktop',0
		align 4
word_1002F33C	dw 2EFh			; DATA XREF: .rdata:1002EC8Co
		db 'SetProcessWindowStation',0
word_1002F356	dw 61h			; DATA XREF: .rdata:1002EC88o
		db 'CreateDesktopW',0
		align 4
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:1002E8D0o
		align 4
word_1002F374	dw 94h			; DATA XREF: .rdata:off_1002ECA0o
		db 'timeGetTime',0
aWinmm_dll	db 'WINMM.dll',0        ; DATA XREF: .rdata:1002E8E4o
word_1002F38C	dw 16Fh			; DATA XREF: .rdata:1002E998o
		db 'GetTokenInformation',0
word_1002F3A2	dw 2EBh			; DATA XREF: .rdata:1002E994o
		db 'SetTokenInformation',0
word_1002F3B8	dw 162h			; DATA XREF: .rdata:1002E990o
		db 'GetSecurityInfo',0
word_1002F3CA	dw 2E4h			; DATA XREF: .rdata:1002E98Co
		db 'SetSecurityInfo',0
word_1002F3DC	dw 2CFh			; DATA XREF: .rdata:1002E988o
		db 'SetEntriesInAclW',0
		align 10h
word_1002F3F0	dw 83h			; DATA XREF: .rdata:1002E984o
		db 'ConvertStringSidToSidW',0
		align 2
word_1002F40A	dw 0EEh			; DATA XREF: .rdata:1002E980o
		db 'DuplicateToken',0
		align 4
word_1002F41C	dw 0EFh			; DATA XREF: .rdata:1002E97Co
		db 'DuplicateTokenEx',0
		align 10h
word_1002F430	dw 212h			; DATA XREF: .rdata:1002E978o
		db 'OpenProcessToken',0
		align 4
word_1002F444	dw 8Eh			; DATA XREF: .rdata:1002E974o
		db 'CreateRestrictedToken',0
word_1002F45C	dw 118h			; DATA XREF: .rdata:1002E970o
		db 'EqualSid',0
		align 4
word_1002F468	dw 1ADh			; DATA XREF: .rdata:1002E96Co
		db 'LookupPrivilegeValueW',0
word_1002F480	dw 2EAh			; DATA XREF: .rdata:1002E968o
		db 'SetThreadToken',0
		align 2
word_1002F492	dw 8Bh			; DATA XREF: .rdata:1002E964o
		db 'CreateProcessAsUserW',0
		align 2
word_1002F4AA	dw 81h			; DATA XREF: .rdata:1002E960o
		db 'ConvertStringSecurityDescriptorToSecurityDescriptorW',0
		align 2
word_1002F4E2	dw 161h			; DATA XREF: .rdata:1002E95Co
		db 'GetSecurityDescriptorSacl',0
word_1002F4FE	dw 14Ah			; DATA XREF: .rdata:1002E958o
		db 'GetLengthSid',0
		align 2
word_1002F50E	dw 85h			; DATA XREF: .rdata:off_1002E93Co
		db 'CopySid',0
word_1002F518	dw 92h			; DATA XREF: .rdata:1002E954o
		db 'CreateWellKnownSid',0
		align 2
word_1002F52E	dw 26Dh			; DATA XREF: .rdata:1002E950o
		db 'RegDisablePredefinedCache',0
word_1002F54A	dw 2B8h			; DATA XREF: .rdata:1002E94Co
		db 'RevertToSelf',0
		align 2
word_1002F55A	dw 285h			; DATA XREF: .rdata:1002E948o
		db 'RegOpenKeyExW',0
word_1002F56A	dw 254h			; DATA XREF: .rdata:1002E944o
		db 'RegCloseKey',0
word_1002F578	dw 25Dh			; DATA XREF: .rdata:1002E940o
		db 'RegCreateKeyExW',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:1002E8F8o
		align 4
word_1002F598	dw 2C5h			; DATA XREF: .rdata:1002EB08o
		db '?_Winerror_map@std@@YAPBDH@Z',0
		align 4
word_1002F5B8	dw 2B0h			; DATA XREF: .rdata:1002EB0Co
		db '?_Syserror_map@std@@YAPBDH@Z',0
		align 4
word_1002F5D8	dw 2C9h			; DATA XREF: .rdata:1002EB10o
		db '?_Xbad_alloc@std@@YAXXZ',0
word_1002F5F2	dw 2CDh			; DATA XREF: .rdata:1002EB14o
		db '?_Xout_of_range@std@@YAXPBD@Z',0
word_1002F612	dw 2CCh			; DATA XREF: .rdata:1002EB18o
		db '?_Xlength_error@std@@YAXPBD@Z',0
word_1002F632	dw 1A7h			; DATA XREF: .rdata:1002EB1Co
		db '?_BADOFF@std@@3_JB',0
		align 4
word_1002F648	dw 0FFh			; DATA XREF: .rdata:1002EB20o
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z',0
		align 4
word_1002F688	dw 0FEh			; DATA XREF: .rdata:1002EB24o
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z',0
		align 4
word_1002F6C8	dw 502h			; DATA XREF: .rdata:1002EB28o
		db '?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@'
		db 'Z',0
		align 2
word_1002F70E	dw 276h			; DATA XREF: .rdata:1002EB2Co
		db '?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ',0
		align 4
word_1002F74C	dw 4FFh			; DATA XREF: .rdata:1002EB30o
		db '?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z',0
word_1002F78C	dw 38Eh			; DATA XREF: .rdata:1002EB34o
		db '?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ',0
word_1002F7CE	dw 2Ah			; DATA XREF: .rdata:1002EB38o
		db '??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ',0
		align 2
word_1002F80A	dw 7			; DATA XREF: .rdata:1002EAF4o
		db '??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ',0
		align 10h
word_1002F840	dw 27Ch			; DATA XREF: .rdata:1002EB40o
		db '?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ',0
word_1002F882	dw 84h			; DATA XREF: .rdata:1002EB44o
		db '??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 4
word_1002F8BC	dw 20h			; DATA XREF: .rdata:1002EB48o
		db '??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_st'
		db 'reambuf@DU?$char_traits@D@std@@@1@_N@Z',0
word_1002F926	dw 4E6h			; DATA XREF: .rdata:1002EB4Co
		db '?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z',0
		align 2
word_1002F966	dw 7Bh			; DATA XREF: .rdata:1002EB50o
		db '??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 4
word_1002F99C	dw 41Ch			; DATA XREF: .rdata:1002EB54o
		db '?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVloca'
		db 'le@2@@Z',0
		align 4
word_1002F9E8	dw 521h			; DATA XREF: .rdata:1002EB58o
		db '?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
word_1002FA26	dw 4D6h			; DATA XREF: .rdata:1002EB5Co
		db '?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@P'
		db 'AD_J@Z',0
word_1002FA70	dw 56Eh			; DATA XREF: .rdata:1002EB60o
		db '?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J'
		db '@Z',0
word_1002FAB6	dw 56Bh			; DATA XREF: .rdata:1002EB64o
		db '?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J'
		db '@Z',0
word_1002FAFC	dw 540h			; DATA XREF: .rdata:1002EB68o
		db '?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
		align 4
word_1002FB3C	dw 4F6h			; DATA XREF: .rdata:1002EB6Co
		db '?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ'
		db 0
word_1002FB80	dw 2BFh			; DATA XREF: .rdata:1002EB70o
		db '?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 2
word_1002FBC2	dw 258h			; DATA XREF: .rdata:1002EB74o
		db '?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 2
word_1002FC02	dw 87h			; DATA XREF: .rdata:1002EB78o
		db '??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 2
word_1002FC3E	dw 3F7h			; DATA XREF: .rdata:1002EB7Co
		db '?id@?$ctype@_W@std@@2V0locale@2@A',0
word_1002FC62	dw 0A5h			; DATA XREF: .rdata:1002EB80o
		db '??1_Lockit@std@@QAE@XZ',0
		align 4
word_1002FC7C	dw 66h			; DATA XREF: .rdata:1002EB84o
		db '??0_Lockit@std@@QAE@H@Z',0
word_1002FC96	dw 1EDh			; DATA XREF: .rdata:1002EB88o
		db '?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ',0
		align 2
word_1002FCCA	dw 504h			; DATA XREF: .rdata:1002EB8Co
		db '?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W'
		db '_J@Z',0
word_1002FD12	dw 501h			; DATA XREF: .rdata:1002EB90o
		db '?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z',0
		align 2
word_1002FD56	dw 390h			; DATA XREF: .rdata:1002EB94o
		db '?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ'
		db 0
word_1002FD9A	dw 278h			; DATA XREF: .rdata:1002EB98o
		db '?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ',0
		align 2
word_1002FDDA	dw 30h			; DATA XREF: .rdata:1002EB9Co
		db '??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ',0
		align 4
word_1002FE18	dw 12h			; DATA XREF: .rdata:1002EBA0o
		db '??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic'
		db '_streambuf@_WU?$char_traits@_W@std@@@1@@Z',0
		align 2
word_1002FE86	dw 0Bh			; DATA XREF: .rdata:1002EBA4o
		db '??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ',0
		align 2
word_1002FEBE	dw 27Eh			; DATA XREF: .rdata:1002EBA8o
		db '?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WX'
		db 'Z',0
		align 4
word_1002FF04	dw 464h			; DATA XREF: .rdata:1002EBACo
		db '?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_1002FF46	dw 393h			; DATA XREF: .rdata:1002EBB0o
		db '?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_1002FF88	dw 80h			; DATA XREF: .rdata:1002EBB4o
		db '??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
word_1002FFC4	dw 123h			; DATA XREF: .rdata:1002EBB8o
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z',0
		align 2
word_10030006	dw 129h			; DATA XREF: .rdata:1002EBBCo
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAV'
		db 'ios_base@1@AAV21@@Z@Z',0
		align 10h
word_10030060	dw 4EAh			; DATA XREF: .rdata:1002EBC0o
		db '?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z',0
		align 2
word_100300A2	dw 7Dh			; DATA XREF: .rdata:1002EBC4o
		db '??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
		align 2
word_100300DA	dw 41Eh			; DATA XREF: .rdata:1002EBC8o
		db '?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlo'
		db 'cale@2@@Z',0
		align 4
word_10030128	dw 523h			; DATA XREF: .rdata:1002EBCCo
		db '?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ',0
word_10030168	dw 4D8h			; DATA XREF: .rdata:1002EBD0o
		db '?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12'
		db '@PA_W_J@Z',0
		align 2
word_100301B6	dw 570h			; DATA XREF: .rdata:1002EBD4o
		db '?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_'
		db 'W_J@Z',0
		align 10h
word_10030200	dw 56Dh			; DATA XREF: .rdata:1002EBD8o
		db '?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_'
		db 'W_J@Z',0
		align 2
word_1003024A	dw 542h			; DATA XREF: .rdata:1002EBDCo
		db '?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ',0
		align 4
word_1003028C	dw 4F8h			; DATA XREF: .rdata:1002EB3Co
		db '?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_J'
		db 'XZ',0
word_100302D2	dw 2C1h			; DATA XREF: .rdata:1002EB04o
		db '?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 2
word_10030316	dw 25Ah			; DATA XREF: .rdata:off_1002EAE8o
		db '?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 4
word_10030358	dw 89h			; DATA XREF: .rdata:1002EAECo
		db '??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
		align 2
word_10030396	dw 3E9h			; DATA XREF: .rdata:1002EAF0o
		db '?getloc@ios_base@std@@QBE?AVlocale@2@XZ',0
word_100303C0	dw 1D0h			; DATA XREF: .rdata:1002EAF8o
		db '?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z',0
		align 4
word_100303FC	dw 561h			; DATA XREF: .rdata:1002EAFCo
		db '?widen@?$ctype@_W@std@@QBE_WD@Z',0
word_1003041E	dw 130h			; DATA XREF: .rdata:1002EB00o
		db '??Bid@locale@std@@QAEIXZ',0
		align 2
aMsvcp120_dll	db 'MSVCP120.dll',0     ; DATA XREF: .rdata:1002E90Co
		align 4
word_10030448	dw 6E8h			; DATA XREF: .rdata:1002EC14o
		db 'memmove',0
word_10030452	dw 449h			; DATA XREF: .rdata:1002EC18o
		db '_purecall',0
word_1003045E	dw 72h			; DATA XREF: .rdata:1002EC1Co
		db '??3@YAXPAX@Z',0
		align 2
word_1003046E	dw 70h			; DATA XREF: .rdata:1002EC20o
		db '??2@YAPAXI@Z',0
		align 2
word_1003047E	dw 4BCh			; DATA XREF: .rdata:1002EC24o
		db '_strnicmp',0
word_1003048A	dw 527h			; DATA XREF: .rdata:1002EC28o
		db '_vscwprintf_p',0
word_1003049A	dw 53Bh			; DATA XREF: .rdata:1002EC2Co
		db '_vswprintf_p',0
		align 2
word_100304AA	dw 683h			; DATA XREF: .rdata:1002EC30o
		db 'free',0
		align 2
word_100304B2	dw 6DBh			; DATA XREF: .rdata:1002EC34o
		db 'malloc',0
		align 4
word_100304BC	dw 89h			; DATA XREF: .rdata:1002EC38o
		db '??_V@YAXPAX@Z',0
word_100304CC	dw 5DCh			; DATA XREF: .rdata:1002EC3Co
		db 'abort',0
word_100304D4	dw 54Dh			; DATA XREF: .rdata:1002EC40o
		db '_wcsdup',0
word_100304DE	dw 693h			; DATA XREF: .rdata:1002EC44o
		db 'getenv',0
		align 4
word_100304E8	dw 55Bh			; DATA XREF: .rdata:1002EC48o
		db '_wcsnicmp',0
word_100304F4	dw 7A8h			; DATA XREF: .rdata:1002EC4Co
		db 'wmemcpy_s',0
word_10030500	dw 708h			; DATA XREF: .rdata:1002EC50o
		db 'rand_s',0
		align 2
word_1003050A	dw 6E7h			; DATA XREF: .rdata:1002EC54o
		db 'memcpy_s',0
		align 2
word_10030516	dw 551h			; DATA XREF: .rdata:1002EC58o
		db '_wcsicmp',0
		align 2
word_10030522	dw 531h			; DATA XREF: .rdata:1002EC5Co
		db '_vsnwprintf_s',0
aMsvcr120_dll	db 'MSVCR120.dll',0     ; DATA XREF: .rdata:1002E920o
		align 10h
word_10030540	dw 394h			; DATA XREF: .rdata:1002EC60o
		db '_lock',0
word_10030548	dw 504h			; DATA XREF: .rdata:1002EC64o
		db '_unlock',0
word_10030552	dw 22Eh			; DATA XREF: .rdata:1002EC68o
		db '_calloc_crt',0
word_10030560	dw 1AEh			; DATA XREF: .rdata:1002EC6Co
		db '__dllonexit',0
word_1003056E	dw 43Ah			; DATA XREF: .rdata:1002EC70o
		db '_onexit',0
word_10030578	dw 16Fh			; DATA XREF: .rdata:1002EC74o
		db '__CppXcptFilter',0
word_1003058A	dw 217h			; DATA XREF: .rdata:off_1002EBE4o
		db '_amsg_exit',0
		align 4
word_10030598	dw 3A5h			; DATA XREF: .rdata:1002EBE8o
		db '_malloc_crt',0
word_100305A6	dw 30Ch			; DATA XREF: .rdata:1002EBECo
		db '_initterm',0
word_100305B2	dw 30Dh			; DATA XREF: .rdata:1002EBF0o
		db '_initterm_e',0
word_100305C0	dw 250h			; DATA XREF: .rdata:1002EBF4o
		db '_crt_debugger_hook',0
		align 2
word_100305D6	dw 1ACh			; DATA XREF: .rdata:1002EBF8o
		db '__crtUnhandledException',0
word_100305F0	dw 1ABh			; DATA XREF: .rdata:1002EBFCo
		db '__crtTerminateProcess',0
word_10030608	dw 27Ah			; DATA XREF: .rdata:1002EC00o
		db '_except_handler4_common',0
word_10030622	dw 18Ch			; DATA XREF: .rdata:1002EC04o
		db '__clean_type_info_names_internal',0
		align 2
word_10030646	dw 121h			; DATA XREF: .rdata:1002EA94o
		db 'EncodePointer',0
word_10030656	dw 0FEh			; DATA XREF: .rdata:1002EA90o
		db 'DecodePointer',0
word_10030666	dw 36Dh			; DATA XREF: .rdata:1002EA8Co
		db 'IsProcessorFeaturePresent',0
word_10030682	dw 113h			; DATA XREF: .rdata:1002EA88o
		db 'DisableThreadLibraryCalls',0
word_1003069E	dw 6E5h			; DATA XREF: .rdata:1002EC08o
		db 'memcmp',0
		align 4
word_100306A8	dw 6E6h			; DATA XREF: .rdata:1002EC0Co
		db 'memcpy',0
		align 2
word_100306B2	dw 6EAh			; DATA XREF: .rdata:1002EC10o
		db 'memset',0
		align 1000h
_rdata		ends

; Section 3. (virtual address 00031000)
; Virtual size			: 00000FB8 (   4024.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0002F400
; Flags	C0300040: Data Readable	Writable
; Alignment	: 4 bytes
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	dword public 'DATA' use32
		assume cs:_data
		;org 10031000h
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10001BEE+6r
					; sub_10002784+6r ...
dword_10031004	dd 44BF19B1h		; DATA XREF: ___report_gsfailure+E3r
					; sub_10019521+29w ...
		align 10h
dword_10031010	dd 0FFFFFFFFh		; DATA XREF: ___DllMainCRTStartup+1Cw
					; ___DllMainCRTStartup:$LN20w
off_10031014	dd offset sub_1000562F	; DATA XREF: sub_1000562F+Bo
; Exported entry  47. g_shared_delayed_integrity_level
		public g_shared_delayed_integrity_level
g_shared_delayed_integrity_level dd 7	; DATA XREF: sub_10014EB0+70o
					; sub_10014EB0+7Aw ...
off_1003101C	dd offset off_1001A8FC	; DATA XREF: sub_10001211:loc_10001231o
					; sub_100197C0w
off_10031020	dd offset off_1001A8E4	; DATA XREF: sub_10001211+17o
					; sub_100197D6w
off_10031024	dd offset off_1001A914	; DATA XREF: sub_100197CBw
		align 10h
; void *dword_10031030
dword_10031030	dd 0			; DATA XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+7w
					; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void):loc_10018CD8r ...
dword_10031034	dd 0			; DATA XREF: sub_100197EDo
dword_10031038	dd 0			; DATA XREF: sub_10018EAA+12r
					; sub_10018EAA+25w ...
		align 10h
dword_10031040	dd 0			; DATA XREF: ___report_gsfailure+9Fw
					; .rdata:off_1001A3F8o
dword_10031044	dd 0			; DATA XREF: ___report_gsfailure+A9w
		dd 0
dword_1003104C	dd 0			; DATA XREF: ___report_gsfailure+9Aw
dword_10031050	dd 0			; DATA XREF: ___report_gsfailure+B3w
dword_10031054	dd 0			; DATA XREF: ___report_gsfailure+C3w
		dd 0Eh dup(0)
dword_10031090	dd 0			; DATA XREF: ___report_gsfailure+8Bw
					; .rdata:1001A3FCo
		dd 22h dup(0)
word_1003111C	dw 0			; DATA XREF: ___report_gsfailure+5Fw
		align 10h
word_10031120	dw 0			; DATA XREF: ___report_gsfailure+58w
		align 4
word_10031124	dw 0			; DATA XREF: ___report_gsfailure+51w
		align 4
word_10031128	dw 0			; DATA XREF: ___report_gsfailure+4Aw
		align 4
dword_1003112C	dd 0			; DATA XREF: ___report_gsfailure+36w
dword_10031130	dd 0			; DATA XREF: ___report_gsfailure+30w
dword_10031134	dd 0			; DATA XREF: ___report_gsfailure+2Aw
dword_10031138	dd 0			; DATA XREF: ___report_gsfailure+24w
dword_1003113C	dd 0			; DATA XREF: ___report_gsfailure+1Ew
dword_10031140	dd 0			; DATA XREF: ___report_gsfailure:loc_1001924Dw
dword_10031144	dd 0			; DATA XREF: ___report_gsfailure+70w
dword_10031148	dd 0			; DATA XREF: ___report_gsfailure+78w
					; ___report_gsfailure+95r
word_1003114C	dw 0			; DATA XREF: ___report_gsfailure+43w
		align 10h
dword_10031150	dd 0			; DATA XREF: ___report_gsfailure+67w
dword_10031154	dd 0			; DATA XREF: ___report_gsfailure+80w
word_10031158	dw 0			; DATA XREF: ___report_gsfailure+3Cw
		align 4
		dd 29h dup(0)
		dd 57h dup(?)
dword_1003135C	dd ?			; DATA XREF: ___raise_securityfailure+Bw
					; ___raise_securityfailure+1Dr
dword_10031360	dd 4 dup(?)		; DATA XREF: sub_1001962Co
; Exported entry  15. ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		public ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
; private: static class	sandbox::BrokerServices	* mozilla::SandboxBroker::sBrokerService
?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A dd	?
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+9r
					; mozilla::SandboxBroker::SandboxBroker(void)+29w ...
dword_10031374	dd ?			; DATA XREF: sub_10014BB5+25r
dword_10031378	dd ?			; DATA XREF: mozilla::sandboxing::ProvideLogFunction(void (*)(char const *,char	const *,char const *,bool,uint))+4w
					; sub_100029CBr ...
		align 10h
dword_10031380	dd 24Bh	dup(?)		; DATA XREF: .rdata:1001AAB0o
dword_10031CAC	dd ?			; DATA XREF: sub_10005320+22r
					; sub_10005320+3Ew
dword_10031CB0	dd ?			; DATA XREF: sub_10005320+14r
					; sub_10005320+2Dw
dword_10031CB4	dd ?			; DATA XREF: sub_10005320+1Cr
					; sub_10005320+36w
byte_10031CB8	db ?			; DATA XREF: sub_10004633+34w
					; sub_10004633+41w
byte_10031CB9	db ?			; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+1Bw
					; sub_10013CB8+11w
		align 10h
dword_10031CC0	dd ?			; DATA XREF: sub_10005533+1r
					; sub_10005533+Do ...
		align 8
dword_10031CC8	dd 4 dup(?)		; DATA XREF: sub_10005533+1Bo
; Exported entry  42. g_handles_to_close
		public g_handles_to_close
; LPVOID g_handles_to_close
g_handles_to_close dd ?			; DATA XREF: sub_1000BE9E+7Eo
					; sub_1000BE9E+88w ...
		align 10h
dword_10031CE0	dd ?			; DATA XREF: sub_10005BF2+1r
					; sub_10005BF2+Fo ...
dword_10031CE4	dd ?			; DATA XREF: sub_10005BF2+25w
					; sub_10005BF2+38o ...
dword_10031CE8	dd ?			; DATA XREF: sub_10005BF2+2Bw
dword_10031CEC	dd ?			; DATA XREF: sub_10005BF2+4Cw
dword_10031CF0	dd ?			; DATA XREF: sub_10005BF2+52w
dword_10031CF4	dd ?			; DATA XREF: sub_10005BF2+58w
		align 10h
flt_10031D00	dd ?			; DATA XREF: sub_10005BF2+46w
; Exported entry  43. g_interceptions
		public g_interceptions
g_interceptions	dd ?			; DATA XREF: sub_1000D966+5Ao
					; sub_1000D966+5Fw ...
; Exported entry  44. g_nt
		public g_nt
g_nt		dd ?			; DATA XREF: sub_1000EE41+4Cw
					; sub_1000EE41+269o ...
dword_10031D0C	dd ?			; DATA XREF: sub_1000EE41+66w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+E4r
dword_10031D10	dd ?			; DATA XREF: sub_1000EE41+80w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+B9r
dword_10031D14	dd ?			; DATA XREF: sub_1000EE41+9Aw
					; sub_1001430B+34r
dword_10031D18	dd ?			; DATA XREF: sub_1000EE41+B4w
					; sub_10013D60+2Dr
dword_10031D1C	dd ?			; DATA XREF: sub_10009A18+24r
					; sub_1000E517+F0r ...
dword_10031D20	dd ?			; DATA XREF: sub_1000EE41+E8w
					; sub_10014015+29r ...
dword_10031D24	dd ?			; DATA XREF: sub_1000EE41+102w
dword_10031D28	dd ?			; DATA XREF: sub_1000EE41+11Cw
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+D8r
dword_10031D2C	dd ?			; DATA XREF: sub_1000EE41+136w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+158r
dword_10031D30	dd ?			; DATA XREF: sub_1000EE41+150w
					; sub_10013D60+52r ...
dword_10031D34	dd ?			; DATA XREF: sub_1000E4B6+33r
					; sub_1000E72B+1Dr ...
dword_10031D38	dd ?			; DATA XREF: sub_1000EE41+184w
					; sub_1001408D+62r
dword_10031D3C	dd ?			; DATA XREF: sub_1000E517+41r
					; sub_1000E517+5Dr ...
dword_10031D40	dd ?			; DATA XREF: sub_1000EE41+1B8w
					; sub_10013DE4+12r
dword_10031D44	dd ?			; DATA XREF: sub_1000EE41+1D2w
dword_10031D48	dd ?			; DATA XREF: sub_1000EE41+1ECw
					; sub_10013DE4+35r
dword_10031D4C	dd ?			; DATA XREF: sub_1000EE41+206w
					; sub_1001430B+11r
dword_10031D50	dd ?			; DATA XREF: sub_1000EE41+21Cw
dword_10031D54	dd ?			; DATA XREF: sub_1000E65B+50r
					; sub_1000EE41+232w ...
dword_10031D58	dd ?			; DATA XREF: sub_1000E517+18r
					; sub_1000EE41+248w ...
dword_10031D5C	dd ?			; DATA XREF: sub_1000EE41+25Ew
					; sub_10013EA4+16r
dword_10031D60	dd ?			; DATA XREF: sub_10005AF6r
					; sub_10005AF6+Do ...
; struct _RTL_CRITICAL_SECTION stru_10031D64
stru_10031D64	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10005AF6+20o
		align 10h
; Exported entry  45. g_originals
		public g_originals
g_originals	dd ?			; DATA XREF: sub_1000DE70+111o
					; sub_1000DE70+17Ao ...
		dd 18h dup(?)
; Exported entry  50. g_shared_section
		public g_shared_section
g_shared_section dd ?			; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+13r
					; sub_10013CB8r ...
; Exported entry  49. g_shared_policy_size
		public g_shared_policy_size
g_shared_policy_size dd	?		; DATA XREF: sub_10010153+31r
					; sub_10017B3A+106o ...
dword_10031DEC	dd ?			; DATA XREF: sub_10010153+10r
					; sub_10010153+1Fr ...
dword_10031DF0	dd ?			; DATA XREF: sub_10013D60+7r
					; sub_10013D60+3Eo ...
; Exported entry  46. g_shared_IPC_size
		public g_shared_IPC_size
g_shared_IPC_size dd ?			; DATA XREF: sub_10013D60+5Dr
					; sub_10017B3A+DDo ...
dword_10031DF8	dd ?			; DATA XREF: sub_1000E4B6+2Dr
					; sub_1000E72B+17r ...
; HWINSTA hObj
hObj		dd ?			; DATA XREF: sub_100147FF+3Br
					; sub_10014854+24r ...
; HANDLE handle
handle		dd ?			; DATA XREF: sub_10013A70+19r
					; sub_100147FF:loc_10014825r ...
dword_10031E04	dd ?			; DATA XREF: sub_10014DF3+3Ar
					; sub_10014DF3+64w
; HANDLE hSourceHandle
hSourceHandle	dd ?			; DATA XREF: sub_10015AD5+39r
					; sub_10015AD5+4Do ...
dword_10031E0C	dd ?			; DATA XREF: sub_10013CB8+22o
					; sub_10013CB8+27w
dword_10031E10	dd ?			; DATA XREF: sub_10013CB8+1Cw
dword_10031E14	dd ?			; DATA XREF: sub_10013CB8:loc_10013CC4r
					; sub_10013CB8+31w
; Exported entry  48. g_shared_delayed_mitigations
		public g_shared_delayed_mitigations
g_shared_delayed_mitigations dd	?	; DATA XREF: sub_1001027A+Cr
					; sub_10014EB0+CFw ...
dword_10031E1C	dd ?			; DATA XREF: sub_1001027A+4r
					; sub_10014EB0+C8w ...
		align 80h
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10001024+5o
					; sub_10005320+2o ...
		dd 24h dup(?)
		db 2 dup(?)
byte_10031F2A	db ?			; DATA XREF: sub_100083D0+53Cr
byte_10031F2B	db ?			; DATA XREF: sub_1000BC30+134r
					; sub_1000BC30+179r ...
dword_10031F2C	dd ?			; DATA XREF: sub_1000468B+CFw
					; sub_1000468B:loc_10004761w ...
dword_10031F30	dd ?			; DATA XREF: sub_100062AA+31r
					; sub_100062AA+71w ...
dword_10031F34	dd ?			; DATA XREF: sub_100062AA:loc_100062D0r
					; sub_100062AA+64w ...
dword_10031F38	dd ?			; DATA XREF: sub_100062AA+3Ar
					; sub_100062AA+78w ...
byte_10031F3C	db ?			; DATA XREF: sub_1000C850+14Er
		align 10h
dword_10031F40	dd ?			; DATA XREF: sub_10002E78+9r
					; sub_10002E78:loc_10002EC3w
dword_10031F44	dd ?			; DATA XREF: sub_100047B4r
					; sub_100047B4+10o ...
dword_10031F48	dd ?			; DATA XREF: sub_10007371+16r
					; sub_10007371+83w
dword_10031F4C	dd ?			; DATA XREF: sub_10007C0E:loc_10007C34r
					; sub_10007C0E:loc_10007C6Aw
dword_10031F50	dd ?			; DATA XREF: sub_10007C92+40r
					; sub_10007C92+A4w ...
dword_10031F54	dd ?			; DATA XREF: sub_10007C92+36r
					; sub_10007C92+7Cw ...
dword_10031F58	dd ?			; DATA XREF: sub_10007B72:loc_10007B99r
					; sub_10007B72:loc_10007BCFw
dword_10031F5C	dd ?			; DATA XREF: sub_1000C07B+Br
					; sub_1000C07B+20o ...
dword_10031F60	dd ?			; DATA XREF: sub_1000C7E4+10r
					; sub_1000C7E4+1Ao ...
dword_10031F64	dd ?			; DATA XREF: sub_1000D2CC+14r
					; sub_1000D2CC+33o ...
dword_10031F68	dd ?			; DATA XREF: sub_1000D76Ar
					; sub_1000D76A+1Dw ...
dword_10031F6C	dd ?			; DATA XREF: sub_1000E72B:loc_1000E79Fr
					; sub_1000E72B:loc_1000E7CEw
dword_10031F70	dd ?			; DATA XREF: sub_1000E72B+3r
					; sub_1000E72B+30w ...
dword_10031F74	dd ?			; DATA XREF: sub_1000E4B6+1r
					; sub_1000E4B6+44w
dword_10031F78	dd ?			; DATA XREF: sub_1000E72B:loc_1000E768r
					; sub_1000E72B+67w ...
dword_10031F7C	dd ?			; DATA XREF: sub_10014015:loc_10014027r
					; sub_10014015+3Cw ...
dword_10031F80	dd ?			; DATA XREF: sub_1001719D+19r
					; sub_1001719D+DAo ...
dword_10031F84	dd ?			; DATA XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+39r
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x):loc_1001756Dw ...
; HMODULE hModule
hModule		dd ?			; DATA XREF: sub_1001881C+6r
					; sub_1001881C:loc_10018856o ...
		dd 2 dup(?)
dword_10031F94	dd ?			; DATA XREF: sub_100063BFr
					; sub_100063BF+26o ...
dword_10031F98	dd ?			; DATA XREF: sub_100083D0+6Bw
dword_10031F9C	dd ?			; DATA XREF: sub_100083D0+54r
					; sub_100083D0+60w
dword_10031FA0	dd ?			; DATA XREF: sub_1001541F+8r
					; sub_1001541F+2Ew
dword_10031FA4	dd ?			; DATA XREF: sub_10018EAA+20o
					; sub_10018EAA+112o ...
dword_10031FA8	dd ?			; DATA XREF: sub_10018EAA:loc_10018EFDr
					; sub_10018EAA:loc_10018FC6w ...
dword_10031FAC	dd ?			; DATA XREF: sub_10018EAA:loc_1001906Ar
					; sub_10018EAA+1C9o ...
; PVOID	dword_10031FB0
dword_10031FB0	dd ?			; DATA XREF: ___atonexitinit+27w
					; sub_10018D8D+49r ...
; PVOID	Ptr
Ptr		dd ?			; DATA XREF: ___atonexitinitr
					; ___atonexitinit+22w ...
		align 80h
_data		ends


		end DllEntryPoint
