;
; +-------------------------------------------------------------------------+
; |   This file	has been generated by The Interactive Disassembler (IDA)    |
; |	      Copyright	(c) 2015 Hex-Rays, <support@hex-rays.com>	    |
; |			 License info: 48-3677-7074-51			    |
; |		Michalis Polychronakis,	Stony Brook University		    |
; +-------------------------------------------------------------------------+
;
; Input	MD5   :	5386D1C545186E62A53704110B71CE39
; Input	CRC32 :	72476FDE

; File Name   :	C:\compspace\compare\firefox\dlls\original\sandboxbroker.dll
; Format      :	Portable executable for	80386 (PE)
; Imagebase   :	10000000
; Section 1. (virtual address 00001000)
; Virtual size			: 00018807 ( 100359.)
; Section size in file		: 00018A00 ( 100864.)
; Offset to raw	data for section: 00000400
; Flags	60000020: Text Executable Readable
; Alignment	: default
; PDB File Name	: c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\obj-firefox\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb
; OS type	  :  MS	Windows
; Application type:  DLL 32bit

		include	uni.inc	; see unicode subdir of	ida for	info on	unicode

		.686p
		.mmx
		.model flat

; ===========================================================================

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 10001000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; =============== S U B	R O U T	I N E =======================================


sub_10001000	proc near		; DATA XREF: .rdata:1001A374o
		push	offset sub_100197E6 ; _onexit_t
		call	sub_10018E4E
		pop	ecx
		retn
sub_10001000	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000100C	proc near		; DATA XREF: .rdata:1001A378o
		push	offset sub_100197DB ; _onexit_t
		call	sub_10018E4E
		pop	ecx
		retn
sub_1000100C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001018	proc near		; DATA XREF: .rdata:1001A37Co
		push	offset sub_100197D0 ; _onexit_t
		call	sub_10018E4E
		pop	ecx
		retn
sub_10001018	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001024	proc near		; DATA XREF: .rdata:1001A380o
		push	7D0h		; dwSpinCount
		push	offset CriticalSection ; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		push	offset sub_100197F1 ; _onexit_t
		call	sub_10018E4E
		pop	ecx
		retn
sub_10001024	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001040	proc near		; DATA XREF: .rdata:1001A370o
		push	offset sub_100197FD ; _onexit_t
		call	sub_10018E4E
		pop	ecx
		retn
sub_10001040	endp

; ---------------------------------------------------------------------------
		align 10h
; Exported entry   1. ??0SandboxBroker@mozilla@@QAE@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *this,	const struct mozilla::SandboxBroker *)
		public ??0SandboxBroker@mozilla@@QAE@ABV01@@Z
??0SandboxBroker@mozilla@@QAE@ABV01@@Z proc near ; DATA	XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	dword ptr [ecx], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??0SandboxBroker@mozilla@@QAE@ABV01@@Z endp

; Exported entry   4. ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z

; =============== S U B	R O U T	I N E =======================================


; public: class	mozilla::SandboxBroker & __thiscall mozilla::SandboxBroker::operator=(class mozilla::SandboxBroker const &)
		public ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z proc near ;	DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	eax, [eax+4]
		mov	[ecx+4], eax
		mov	eax, ecx
		retn	4
??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z endp


; =============== S U B	R O U T	I N E =======================================


sub_10001074	proc near		; DATA XREF: .rdata:const mozilla::SandboxBroker::`vftable'o

arg_0		= byte ptr  4

		test	[esp+arg_0], 2
		push	esi
		mov	esi, ecx
		jz	short loc_100010AC
		push	ebx
		lea	ebx, [esi-4]
		push	edi
		mov	edi, [ebx]
		lea	esi, [esi+edi*8]
		jmp	short loc_10001094
; ---------------------------------------------------------------------------

loc_1000108A:				; CODE XREF: sub_10001074+21j
		sub	esi, 8
		mov	ecx, esi	; this
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)

loc_10001094:				; CODE XREF: sub_10001074+14j
		dec	edi
		jns	short loc_1000108A
		test	[esp+0Ch+arg_0], 1
		jz	short loc_100010A6
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100010A6:				; CODE XREF: sub_10001074+28j
		pop	edi
		mov	eax, ebx
		pop	ebx
		jmp	short loc_100010C2
; ---------------------------------------------------------------------------

loc_100010AC:				; CODE XREF: sub_10001074+8j
		call	??1SandboxBroker@mozilla@@UAE@XZ ; mozilla::SandboxBroker::~SandboxBroker(void)
		test	[esp+4+arg_0], 1
		jz	short loc_100010C0
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100010C0:				; CODE XREF: sub_10001074+42j
		mov	eax, esi

loc_100010C2:				; CODE XREF: sub_10001074+36j
		pop	esi
		retn	4
sub_10001074	endp


; =============== S U B	R O U T	I N E =======================================


sub_100010C6	proc near		; CODE XREF: sub_100017D6+15p
					; sub_10002847+19p ...
		cmp	byte ptr [ecx],	0
		jnz	short loc_100010CF
		xor	ecx, ecx
		jmp	short loc_100010DB
; ---------------------------------------------------------------------------

loc_100010CF:				; CODE XREF: sub_100010C6+3j
		lea	edx, [ecx+1]

loc_100010D2:				; CODE XREF: sub_100010C6+11j
		mov	al, [ecx]
		inc	ecx
		test	al, al
		jnz	short loc_100010D2
		sub	ecx, edx

loc_100010DB:				; CODE XREF: sub_100010C6+7j
		mov	eax, ecx
		retn
sub_100010C6	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100010DE@<eax>(void *@<ecx>, void *@<edx>,	size_t)
sub_100010DE	proc near		; CODE XREF: sub_10001802+76p
					; sub_1000189A+1Fp ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short loc_100010F5
		push	[esp+arg_0]	; size_t
		push	edx		; void *
		push	ecx		; void *
		call	memcpy
		add	esp, 0Ch
		mov	ecx, eax

loc_100010F5:				; CODE XREF: sub_100010DE+5j
		mov	eax, ecx
		retn
sub_100010DE	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100010F8@<eax>(void *@<ecx>, void *@<edx>,	size_t)
sub_100010F8	proc near		; CODE XREF: sub_1000194D+36p
					; sub_100022CA+15p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jz	short loc_10001110
		push	[esp+arg_0]	; size_t
		push	edx		; void *
		push	ecx		; void *
		call	ds:memmove
		add	esp, 0Ch
		mov	ecx, eax

loc_10001110:				; CODE XREF: sub_100010F8+5j
		mov	eax, ecx
		retn
sub_100010F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001113	proc near		; DATA XREF: .rdata:off_1001A8E4o
					; .rdata:off_1001A8FCo	...

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001A92C
		jz	short loc_1000112B
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000112B:				; CODE XREF: sub_10001113+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10001113	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001131	proc near		; DATA XREF: .rdata:1001A8F0o
					; .rdata:1001A920o ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		mov	[eax], edx
		mov	[eax+4], ecx
		retn	8
sub_10001131	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001141	proc near		; DATA XREF: .rdata:1001A8F8o
					; .rdata:1001A910o ...

var_8		= byte ptr -8
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	[ebp+arg_0]
		mov	eax, [ecx]
		lea	edx, [ebp+var_8]
		push	edx
		call	dword ptr [eax+0Ch]
		mov	edx, [ebp+arg_4]
		mov	ecx, [eax+4]
		cmp	ecx, [edx+4]
		jnz	short loc_10001168
		mov	eax, [eax]
		cmp	eax, [edx]
		jnz	short loc_10001168
		xor	eax, eax
		inc	eax
		jmp	short loc_1000116A
; ---------------------------------------------------------------------------

loc_10001168:				; CODE XREF: sub_10001141+1Aj
					; sub_10001141+20j
		xor	eax, eax

loc_1000116A:				; CODE XREF: sub_10001141+25j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10001141	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001170	proc near		; DATA XREF: .rdata:1001A8F4o
					; .rdata:1001A90Co ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		cmp	ecx, [eax+4]
		jnz	short loc_10001186
		mov	eax, [eax]
		cmp	eax, [esp+arg_4]
		jnz	short loc_10001186
		xor	eax, eax
		inc	eax
		jmp	short locret_10001188
; ---------------------------------------------------------------------------

loc_10001186:				; CODE XREF: sub_10001170+7j
					; sub_10001170+Fj
		xor	eax, eax

locret_10001188:			; CODE XREF: sub_10001170+14j
		retn	8
sub_10001170	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000118B	proc near		; DATA XREF: .rdata:1001A8E8o
		mov	eax, offset aGeneric ; "generic"
		retn
sub_1000118B	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001191(void *, int)
sub_10001191	proc near		; CODE XREF: sub_100011BC+1Ep
					; DATA XREF: .rdata:1001A8ECo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_100011A5
		mov	eax, offset aUnknownError ; "unknown error"

loc_100011A5:				; CODE XREF: sub_10001191+Dj
		mov	ecx, [esp+arg_0] ; void	*
		push	eax		; void *
		call	sub_100017D6
		mov	eax, [esp+arg_0]
		retn	8
sub_10001191	endp


; =============== S U B	R O U T	I N E =======================================


sub_100011B6	proc near		; DATA XREF: .rdata:1001A918o
		mov	eax, offset aIostream ;	"iostream"
		retn
sub_100011B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100011BC(void *, int)
sub_100011BC	proc near		; DATA XREF: .rdata:1001A91Co

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		jnz	short loc_100011D4
		mov	ecx, [ebp+arg_0] ; void	*
		push	offset aIostreamStream ; "iostream stream error"
		call	sub_100017D6
		jmp	short loc_100011DF
; ---------------------------------------------------------------------------

loc_100011D4:				; CODE XREF: sub_100011BC+7j
		push	[ebp+arg_4]	; int
		push	[ebp+arg_0]	; void *
		call	sub_10001191

loc_100011DF:				; CODE XREF: sub_100011BC+16j
		mov	eax, [ebp+arg_0]
		pop	ebp
		retn	8
sub_100011BC	endp


; =============== S U B	R O U T	I N E =======================================


sub_100011E6	proc near		; DATA XREF: .rdata:1001A900o
		mov	eax, offset aSystem ; "system"
		retn
sub_100011E6	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100011EC(void *, int)
sub_100011EC	proc near		; DATA XREF: .rdata:1001A904o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	[esp+arg_4]
		call	ds:?_Winerror_map@std@@YAPBDH@Z	; std::_Winerror_map(int)
		pop	ecx
		test	eax, eax
		jnz	short loc_10001200
		mov	eax, offset aUnknownError ; "unknown error"

loc_10001200:				; CODE XREF: sub_100011EC+Dj
		mov	ecx, [esp+arg_0] ; void	*
		push	eax		; void *
		call	sub_100017D6
		mov	eax, [esp+arg_0]
		retn	8
sub_100011EC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001211	proc near		; DATA XREF: .rdata:1001A908o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_4]
		push	esi
		call	ds:?_Syserror_map@std@@YAPBDH@Z	; std::_Syserror_map(int)
		test	eax, eax
		mov	eax, [esp+8+arg_0]
		pop	ecx
		mov	[eax], esi
		jz	short loc_10001231
		mov	dword ptr [eax+4], offset off_10031020
		jmp	short loc_10001238
; ---------------------------------------------------------------------------

loc_10001231:				; CODE XREF: sub_10001211+15j
		mov	dword ptr [eax+4], offset off_1003101C

loc_10001238:				; CODE XREF: sub_10001211+1Ej
		pop	esi
		retn	8
sub_10001211	endp

; Exported entry   2. ??0SandboxBroker@mozilla@@QAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??0SandboxBroker@mozilla@@QAE@XZ
??0SandboxBroker@mozilla@@QAE@XZ proc near ; DATA XREF:	.rdata:off_1002E058o
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jnz	short loc_10001287
		cmp	g_shared_section, ecx
		jnz	short loc_10001281
		mov	byte_10031CB9, 1
		call	sub_1000D77D
		mov	ecx, eax
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		test	ecx, ecx
		jz	short loc_10001287
		mov	eax, [ecx]
		call	dword ptr [eax]
		mov	ecx, eax
		neg	ecx
		sbb	ecx, ecx
		not	ecx
		and	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService

loc_10001281:				; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+19j
		mov	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, ecx ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService

loc_10001287:				; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+11j
					; mozilla::SandboxBroker::SandboxBroker(void)+31j
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn
??0SandboxBroker@mozilla@@QAE@XZ endp

; Exported entry  10. ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; bool __thiscall mozilla::SandboxBroker::LaunchApp(mozilla::SandboxBroker *this, const	wchar_t	*, const wchar_t *, bool, void **)
		public ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z proc near
					; DATA XREF: .rdata:off_1002E058o

var_10		= dword	ptr -10h
hThread		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= byte ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		cmp	?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A, 0	; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		push	ebx
		push	esi
		mov	ebx, ecx
		jz	loc_1000132A
		mov	esi, [ebx+4]
		test	esi, esi
		jz	short loc_1000132A
		mov	esi, [esi]
		push	edi
		mov	edi, ds:GetStdHandle
		push	0FFFFFFF5h	; nStdHandle
		call	edi ; GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+54h]
		mov	eax, [ebx+4]
		push	0FFFFFFF4h	; nStdHandle
		mov	esi, [eax]
		call	edi ; GetStdHandle
		mov	ecx, [ebx+4]
		push	eax
		call	dword ptr [esi+58h]
		cmp	[ebp+arg_8], 0
		jz	short loc_100012E3
		mov	ecx, [ebx+4]
		call	sub_1000298E

loc_100012E3:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+46j
		and	[ebp+var_10], 0
		lea	edi, [ebp+hThread]
		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		lea	edx, [ebp+var_10]
		xor	eax, eax
		stosd
		push	edx
		push	dword ptr [ebx+4]
		push	[ebp+arg_4]
		stosd
		push	[ebp+arg_0]
		stosd
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		pop	edi
		test	eax, eax
		jnz	short loc_1000132A
		push	[ebp+hThread]	; hThread
		call	ds:ResumeThread
		push	[ebp+hThread]	; hObject
		call	ds:CloseHandle
		mov	ecx, [ebp+arg_C]
		mov	eax, [ebp+var_10]
		mov	[ecx], eax
		mov	al, 1
		jmp	short loc_1000132C
; ---------------------------------------------------------------------------

loc_1000132A:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+11j
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+1Cj	...
		xor	al, al

loc_1000132C:				; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+95j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z endp

; Exported entry  14. ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(mozilla::SandboxBroker *this, int)
		public ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z proc near
					; DATA XREF: .rdata:off_1002E058o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= byte ptr  10h

		push	ecx
		push	edi
		mov	edi, ecx
		mov	edx, [edi+4]
		test	edx, edx
		jnz	short loc_10001346
		xor	al, al
		jmp	loc_100014B8
; ---------------------------------------------------------------------------

loc_10001346:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+9j
		push	ebx
		push	ebp
		push	esi
		push	2
		pop	esi
		cmp	[esp+14h+arg_0], esi
		jle	short loc_10001359
		push	4
		pop	ecx
		mov	ebp, esi
		jmp	short loc_10001361
; ---------------------------------------------------------------------------

loc_10001359:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+1Cj
		jnz	short loc_1000136A
		push	4
		pop	ecx
		push	3
		pop	ebp

loc_10001361:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+23j
		push	4
		pop	esi
		mov	[esp+14h+var_4], esi
		jmp	short loc_10001374
; ---------------------------------------------------------------------------

loc_1000136A:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int):loc_10001359j
		push	5
		pop	ecx
		push	4
		pop	ebp
		mov	[esp+14h+var_4], esi

loc_10001374:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+34j
		mov	eax, [edx]
		push	0
		push	ecx
		mov	ecx, edx
		call	dword ptr [eax+14h]
		mov	ecx, [edi+4]
		mov	ebx, eax
		push	ebp
		push	5
		pop	ebp
		mov	edx, [ecx]
		neg	ebx
		push	ebp
		sbb	bl, bl
		call	dword ptr [edx+8]
		inc	bl
		jz	short loc_100013A2
		test	eax, eax
		jnz	short loc_100013A2
		xor	ebx, ebx
		inc	ebx
		mov	[esp+8+arg_C], bl
		jmp	short loc_100013AA
; ---------------------------------------------------------------------------

loc_100013A2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+5Fj
					; mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+63j
		xor	ebx, ebx
		mov	[esp+8+arg_C], 0
		inc	ebx

loc_100013AA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+6Cj
		mov	ecx, [edi+4]
		push	esi
		mov	eax, [ecx]
		call	dword ptr [eax+2Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_100013C2
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_100013C7

loc_100013C2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+84j
		mov	[esp+8+arg_C], 0

loc_100013C7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+8Cj
		mov	ecx, [edi+4]
		push	[esp+8+arg_4]
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	[esp+8+arg_C], 0
		jz	short loc_100013E2
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_100013E7

loc_100013E2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+A4j
		mov	[esp+8+arg_C], 0

loc_100013E7:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+ACj
		mov	ecx, [edi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001402
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001407

loc_10001402:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+C4j
		mov	[esp+8+arg_C], 0

loc_10001407:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+CCj
		mov	ecx, [edi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001427
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_1000142C

loc_10001427:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+E9j
		mov	[esp+8+arg_C], 0

loc_1000142C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+F1j
		mov	ecx, [edi+4]
		push	offset a??PipeGeckoCra ; "\\??\\pipe\\gecko-crash-server-pipe.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_1000144C
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001451

loc_1000144C:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+10Ej
		mov	[esp+8+arg_C], 0

loc_10001451:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+116j
		mov	ecx, [edi+4]
		mov	esi, offset aSection ; "Section"
		push	esi
		push	4
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001471
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001476

loc_10001471:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+133j
		mov	[esp+8+arg_C], 0

loc_10001476:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+13Bj
		mov	ecx, [edi+4]
		push	esi
		push	ebp
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+8+arg_C], 0
		jz	short loc_10001490
		mov	[esp+8+arg_C], bl
		test	eax, eax
		jz	short loc_10001495

loc_10001490:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+152j
		mov	[esp+8+arg_C], 0

loc_10001495:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+15Aj
		mov	ecx, [edi+4]
		push	offset a??PipeJpi2_pid ; "\\??\\pipe\\jpi2_pid*_pipe*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	byte ptr [esp+14h+arg_0], 0
		jz	short loc_100014B1
		test	eax, eax
		jz	short loc_100014B3

loc_100014B1:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+177j
		xor	bl, bl

loc_100014B3:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+17Bj
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_100014B8:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+Dj
		pop	edi
		pop	ecx
		retn	4
?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z endp

; Exported entry  13. ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(mozilla::SandboxBroker	*__hidden this)
		public ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_1002E058o
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_100014CB
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100014CB:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+8j
		mov	eax, [ecx]
		push	ebx
		push	0
		push	5
		call	dword ptr [eax+14h]
		mov	ecx, [esi+4]
		mov	ebx, eax
		push	5
		neg	ebx
		push	5
		mov	eax, [ecx]
		sbb	bl, bl
		call	dword ptr [eax+8]
		inc	bl
		pop	ebx
		jz	short loc_100014F4
		test	eax, eax
		jnz	short loc_100014F4
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100014F4:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+2Dj
					; mozilla::SandboxBroker::SetSecurityLevelForIPDLUnitTestProcess(void)+31j
		xor	eax, eax
		pop	esi
		retn
?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry  12. ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(mozilla::SandboxBroker *__hidden this)
		public ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ proc near
					; DATA XREF: .rdata:off_1002E058o

var_5		= byte ptr -5
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		mov	ecx, [esi+4]
		test	ecx, ecx
		jnz	short loc_10001514
		xor	al, al
		jmp	loc_10001754
; ---------------------------------------------------------------------------

loc_10001514:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+13j
		mov	eax, [ecx]
		push	0
		push	0
		call	dword ptr [eax+14h]
		neg	eax
		sbb	al, al
		inc	al
		mov	[esp+18h+var_4], eax
		call	sub_100063D2
		mov	ecx, [esi+4]
		xor	ebx, ebx
		push	3
		pop	ebp
		inc	ebx
		cmp	[eax], ebp
		mov	eax, [ecx]
		jge	short loc_1000153F
		push	0
		jmp	short loc_10001540
; ---------------------------------------------------------------------------

loc_1000153F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+41j
		push	ebx

loc_10001540:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+45j
		push	5
		call	dword ptr [eax+8]
		cmp	byte ptr [esp+18h+var_4], 0
		jz	short loc_10001554
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001559

loc_10001554:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+52j
		mov	[esp+18h+var_5], 0

loc_10001559:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+5Aj
		mov	ecx, [esi+4]
		push	ebx
		mov	eax, [ecx]
		call	dword ptr [eax+1Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001571
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001576

loc_10001571:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+6Fj
		mov	[esp+18h+var_5], 0

loc_10001576:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+77j
		mov	ecx, [esi+4]
		push	4
		mov	eax, [ecx]
		call	dword ptr [eax+2Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_1000158F
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001594

loc_1000158F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+8Dj
		mov	[esp+18h+var_5], 0

loc_10001594:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+95j
		mov	ecx, [esi+4]
		push	6
		mov	eax, [ecx]
		call	dword ptr [eax+34h]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100015AD
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100015B2

loc_100015AD:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+ABj
		mov	[esp+18h+var_5], 0

loc_100015B2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+B3j
		mov	ecx, [esi+4]
		push	0
		push	67h
		mov	eax, [ecx]
		call	dword ptr [eax+40h]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100015CD
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100015D2

loc_100015CD:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+CBj
		mov	[esp+18h+var_5], 0

loc_100015D2:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+D3j
		mov	ecx, [esi+4]
		push	ebx
		push	100h
		mov	eax, [ecx]
		call	dword ptr [eax+48h]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100015EF
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100015F4

loc_100015EF:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+EDj
		mov	[esp+18h+var_5], 0

loc_100015F4:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+F5j
		mov	ecx, [esi+4]
		push	offset a??PipeChrome_ ;	"\\??\\pipe\\chrome.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001614
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001619

loc_10001614:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+112j
		mov	[esp+18h+var_5], 0

loc_10001619:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+11Aj
		mov	ecx, [esi+4]
		push	offset a??PipeGeckoCra ; "\\??\\pipe\\gecko-crash-server-pipe.*"
		push	0
		push	0
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001639
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_1000163E

loc_10001639:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+137j
		mov	[esp+18h+var_5], 0

loc_1000163E:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+13Fj
		mov	ecx, [esi+4]
		push	offset aHkey_current_u ; "HKEY_CURRENT_USER"
		push	0Bh
		pop	edi
		mov	eax, [ecx]
		push	edi
		push	ebp
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_1000165F
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001664

loc_1000165F:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+15Dj
		mov	[esp+18h+var_5], 0

loc_10001664:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+165j
		mov	ecx, [esi+4]
		push	offset aHkey_current_0 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001682
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001687

loc_10001682:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+180j
		mov	[esp+18h+var_5], 0

loc_10001687:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+188j
		mov	ecx, [esi+4]
		push	offset aHkey_current_1 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100016A5
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100016AA

loc_100016A5:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1A3j
		mov	[esp+18h+var_5], 0

loc_100016AA:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1ABj
		mov	ecx, [esi+4]
		push	offset aHkey_local_mac ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100016C8
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100016CD

loc_100016C8:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1C6j
		mov	[esp+18h+var_5], 0

loc_100016CD:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1CEj
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_0 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_100016EB
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_100016F0

loc_100016EB:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1E9j
		mov	[esp+18h+var_5], 0

loc_100016F0:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1F1j
		mov	ecx, [esi+4]
		push	offset aHkey_current_2 ; "HKEY_CURRENT_USER\\Software\\Policies\\"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_1000170E
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001713

loc_1000170E:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+20Cj
		mov	[esp+18h+var_5], 0

loc_10001713:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+214j
		mov	ecx, [esi+4]
		push	offset aHkey_current_3 ; "HKEY_CURRENT_USER\\Control Panel\\Deskt"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001731
		mov	[esp+18h+var_5], bl
		test	eax, eax
		jz	short loc_10001736

loc_10001731:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+22Fj
		mov	[esp+18h+var_5], 0

loc_10001736:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+237j
		mov	ecx, [esi+4]
		push	offset aHkey_local_m_1 ; "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft"...
		push	edi
		push	ebp
		mov	eax, [ecx]
		call	dword ptr [eax+5Ch]
		cmp	[esp+18h+var_5], 0
		jz	short loc_10001750
		test	eax, eax
		jz	short loc_10001752

loc_10001750:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+252j
		xor	bl, bl

loc_10001752:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+256j
		mov	al, bl

loc_10001754:				; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+17j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ endp

; Exported entry   8. ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	1
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   9. ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowReadWriteFile(mozilla::SandboxBroker *this, const wchar_t *)
		public ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z proc near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	0
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   7. ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AllowDirectory(mozilla::SandboxBroker	*this, const wchar_t *)
		public ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z proc	near
					; DATA XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, [ecx+4]
		push	[esp+arg_0]
		push	3
		mov	eax, [ecx]
		push	0
		call	dword ptr [eax+5Ch]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z endp

; Exported entry   6. ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z

; =============== S U B	R O U T	I N E =======================================


; bool __thiscall mozilla::SandboxBroker::AddTargetPeer(mozilla::SandboxBroker *this, void *)
		public ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z
?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z proc near ; DATA XREF:	.rdata:off_1002E058o

arg_0		= dword	ptr  4

		mov	ecx, ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A ; sandbox::BrokerServices * mozilla::SandboxBroker::sBrokerService
		push	[esp+arg_0]
		mov	eax, [ecx]
		call	dword ptr [eax+10h]
		neg	eax
		sbb	eax, eax
		inc	eax
		retn	4
?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z endp

; Exported entry   3. ??1SandboxBroker@mozilla@@UAE@XZ

; =============== S U B	R O U T	I N E =======================================


; _DWORD __thiscall mozilla::SandboxBroker::~SandboxBroker(mozilla::SandboxBroker *__hidden this)
		public ??1SandboxBroker@mozilla@@UAE@XZ
??1SandboxBroker@mozilla@@UAE@XZ proc near ; CODE XREF:	sub_10001074+1Bp
					; sub_10001074:loc_100010ACp
					; DATA XREF: ...
		push	esi
		mov	esi, ecx
		mov	ecx, [esi+4]
		mov	dword ptr [esi], offset	??_7SandboxBroker@mozilla@@6B@ ; const mozilla::SandboxBroker::`vftable'
		test	ecx, ecx
		jz	short loc_100017D4
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		and	dword ptr [esi+4], 0

loc_100017D4:				; CODE XREF: mozilla::SandboxBroker::~SandboxBroker(void)+Ej
		pop	esi
		retn
??1SandboxBroker@mozilla@@UAE@XZ endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100017D6(void *, void *)
sub_100017D6	proc near		; CODE XREF: sub_10001191+19p
					; sub_100011BC+11p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_100010C6
		push	eax		; size_t
		push	[esp+8+arg_0]	; void *
		mov	ecx, esi	; void *
		call	sub_100018DB
		mov	eax, esi
		pop	esi
		retn	4
sub_100017D6	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001802(void *, int, int,	int)
sub_10001802	proc near		; CODE XREF: sub_100018DB+28p
					; sub_1000345E+18p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_10001822

loc_10001817:				; CODE XREF: sub_10001802+36j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10001822:				; CODE XREF: sub_10001802+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_1000182E
		mov	edi, [esp+10h+arg_8]

loc_1000182E:				; CODE XREF: sub_10001802+26j
		cmp	esi, ebx
		jnz	short loc_10001854
		lea	eax, [edi+ebp]
		cmp	[esi+10h], eax
		jb	short loc_10001817
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], eax
		jb	short loc_10001845
		mov	ecx, [esi]

loc_10001845:				; CODE XREF: sub_10001802+3Fj
		push	ebp
		mov	byte ptr [ecx+eax], 0
		push	ecx
		mov	ecx, esi
		call	sub_1000194D
		jmp	short loc_10001891
; ---------------------------------------------------------------------------

loc_10001854:				; CODE XREF: sub_10001802+2Ej
		push	0
		push	edi
		call	sub_100019A3
		test	al, al
		jz	short loc_10001891
		cmp	dword ptr [ebx+14h], 10h
		jb	short loc_10001868
		mov	ebx, [ebx]

loc_10001868:				; CODE XREF: sub_10001802+62j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001872
		mov	ecx, [esi]
		jmp	short loc_10001874
; ---------------------------------------------------------------------------

loc_10001872:				; CODE XREF: sub_10001802+6Aj
		mov	ecx, esi	; void *

loc_10001874:				; CODE XREF: sub_10001802+6Ej
		push	edi		; size_t
		lea	edx, [ebx+ebp]	; void *
		call	sub_100010DE
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], edi
		jb	short loc_1000188B
		mov	eax, [esi]
		jmp	short loc_1000188D
; ---------------------------------------------------------------------------

loc_1000188B:				; CODE XREF: sub_10001802+83j
		mov	eax, esi

loc_1000188D:				; CODE XREF: sub_10001802+87j
		mov	byte ptr [eax+edi], 0

loc_10001891:				; CODE XREF: sub_10001802+50j
					; sub_10001802+5Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_10001802	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000189A(char, size_t)
sub_1000189A	proc near		; CODE XREF: sub_100019A3+3Dp
					; sub_10001A3D+6Bp ...

arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, ecx
		jz	short loc_100018C8
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100018C8
		push	ebx
		mov	ebx, [esi]
		test	edi, edi
		jz	short loc_100018BF
		push	edi		; size_t
		mov	edx, ebx	; void *
		call	sub_100010DE
		pop	ecx

loc_100018BF:				; CODE XREF: sub_1000189A+1Aj
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ebx

loc_100018C8:				; CODE XREF: sub_1000189A+Dj
					; sub_1000189A+13j
		mov	[esi+10h], edi
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [edi+esi], 0
		pop	edi
		pop	esi
		retn	8
sub_1000189A	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100018DB(void *, void *, size_t)
sub_100018DB	proc near		; CODE XREF: sub_100017D6+21p
					; sub_1000279B+49p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		push	edi
		call	sub_10001A05
		test	al, al
		jz	short loc_1000190A
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100018F7
		mov	eax, [esi]
		jmp	short loc_100018F9
; ---------------------------------------------------------------------------

loc_100018F7:				; CODE XREF: sub_100018DB+16j
		mov	eax, esi

loc_100018F9:				; CODE XREF: sub_100018DB+1Aj
		push	[esp+8+arg_4]	; int
		sub	edi, eax
		mov	ecx, esi	; void *
		push	edi		; int
		push	esi		; int
		call	sub_10001802
		jmp	short loc_10001948
; ---------------------------------------------------------------------------

loc_1000190A:				; CODE XREF: sub_100018DB+10j
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_100019A3
		test	al, al
		jz	short loc_10001945
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001927
		mov	ecx, [esi]
		jmp	short loc_10001929
; ---------------------------------------------------------------------------

loc_10001927:				; CODE XREF: sub_100018DB+46j
		mov	ecx, esi	; void *

loc_10001929:				; CODE XREF: sub_100018DB+4Aj
		push	ebx		; size_t
		mov	edx, edi	; void *
		call	sub_100010DE
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], ebx
		jb	short loc_1000193F
		mov	eax, [esi]
		jmp	short loc_10001941
; ---------------------------------------------------------------------------

loc_1000193F:				; CODE XREF: sub_100018DB+5Ej
		mov	eax, esi

loc_10001941:				; CODE XREF: sub_100018DB+62j
		mov	byte ptr [eax+ebx], 0

loc_10001945:				; CODE XREF: sub_100018DB+40j
		mov	eax, esi
		pop	ebx

loc_10001948:				; CODE XREF: sub_100018DB+2Dj
		pop	edi
		pop	esi
		retn	8
sub_100018DB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000194D	proc near		; CODE XREF: sub_10001802+4Bp

arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10001971
		and	dword ptr [esi+10h], 0
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000196A
		mov	eax, [esi]
		jmp	short loc_1000196C
; ---------------------------------------------------------------------------

loc_1000196A:				; CODE XREF: sub_1000194D+17j
		mov	eax, esi

loc_1000196C:				; CODE XREF: sub_1000194D+1Bj
		mov	byte ptr [eax],	0
		jmp	short loc_1000199C
; ---------------------------------------------------------------------------

loc_10001971:				; CODE XREF: sub_1000194D+Dj
		test	eax, eax
		jz	short loc_1000199C
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000197D
		mov	ecx, [esi]	; void *

loc_1000197D:				; CODE XREF: sub_1000194D+2Cj
		sub	edi, eax
		lea	edx, [ecx+eax]	; void *
		push	edi		; size_t
		call	sub_100010F8
		cmp	dword ptr [esi+14h], 10h
		pop	ecx
		mov	[esi+10h], edi
		jb	short loc_10001996
		mov	eax, [esi]
		jmp	short loc_10001998
; ---------------------------------------------------------------------------

loc_10001996:				; CODE XREF: sub_1000194D+43j
		mov	eax, esi

loc_10001998:				; CODE XREF: sub_1000194D+47j
		mov	byte ptr [eax+edi], 0

loc_1000199C:				; CODE XREF: sub_1000194D+22j
					; sub_1000194D+26j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_1000194D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100019A3	proc near		; CODE XREF: sub_10001802+55p
					; sub_100018DB+39p ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 0FFFFFFFEh
		jbe	short loc_100019B8
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100019B8:				; CODE XREF: sub_100019A3+8j
		cmp	[ecx+14h], esi
		jnb	short loc_100019C8
		push	dword ptr [ecx+10h] ; size_t
		push	esi		; int
		call	sub_10001A3D
		jmp	short loc_100019F9
; ---------------------------------------------------------------------------

loc_100019C8:				; CODE XREF: sub_100019A3+18j
		cmp	[esp+4+arg_4], 0
		jz	short loc_100019E7
		cmp	esi, 10h
		jnb	short loc_100019E7
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_100019DD
		mov	eax, esi

loc_100019DD:				; CODE XREF: sub_100019A3+36j
		push	eax		; size_t
		push	1		; char
		call	sub_1000189A
		jmp	short loc_100019F9
; ---------------------------------------------------------------------------

loc_100019E7:				; CODE XREF: sub_100019A3+2Aj
					; sub_100019A3+2Fj
		test	esi, esi
		jnz	short loc_100019F9
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_100019F6
		mov	ecx, [ecx]

loc_100019F6:				; CODE XREF: sub_100019A3+4Fj
		mov	byte ptr [ecx],	0

loc_100019F9:				; CODE XREF: sub_100019A3+23j
					; sub_100019A3+42j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_100019A3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001A05	proc near		; CODE XREF: sub_100018DB+9p

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_10001A38
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10001A17
		mov	eax, [ecx]
		jmp	short loc_10001A19
; ---------------------------------------------------------------------------

loc_10001A17:				; CODE XREF: sub_10001A05+Cj
		mov	eax, ecx

loc_10001A19:				; CODE XREF: sub_10001A05+10j
		cmp	edx, eax
		jb	short loc_10001A38
		cmp	dword ptr [ecx+14h], 10h
		push	esi
		jb	short loc_10001A28
		mov	esi, [ecx]
		jmp	short loc_10001A2A
; ---------------------------------------------------------------------------

loc_10001A28:				; CODE XREF: sub_10001A05+1Dj
		mov	esi, ecx

loc_10001A2A:				; CODE XREF: sub_10001A05+21j
		mov	eax, [ecx+10h]
		add	eax, esi
		pop	esi
		cmp	eax, edx
		jbe	short loc_10001A38
		mov	al, 1
		jmp	short locret_10001A3A
; ---------------------------------------------------------------------------

loc_10001A38:				; CODE XREF: sub_10001A05+6j
					; sub_10001A05+16j ...
		xor	al, al

locret_10001A3A:			; CODE XREF: sub_10001A05+31j
		retn	4
sub_10001A05	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001A3D(void *, int, size_t)
sub_10001A3D	proc near		; CODE XREF: sub_100019A3+1Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	esi, ecx
		or	edi, 0Fh
		cmp	edi, 0FFFFFFFEh
		jbe	short loc_10001A55
		mov	edi, [esp+10h+arg_0]
		jmp	short loc_10001A7A
; ---------------------------------------------------------------------------

loc_10001A55:				; CODE XREF: sub_10001A3D+10j
		push	3
		xor	edx, edx
		mov	ebx, [esi+14h]
		mov	eax, edi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_10001A7A
		push	0FFFFFFFEh
		pop	eax
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_10001A77
		lea	edi, [ecx+ebx]
		jmp	short loc_10001A7A
; ---------------------------------------------------------------------------

loc_10001A77:				; CODE XREF: sub_10001A3D+33j
		push	0FFFFFFFEh
		pop	edi

loc_10001A7A:				; CODE XREF: sub_10001A3D+16j
					; sub_10001A3D+2Aj ...
		lea	eax, [edi+1]
		push	eax
		call	sub_10001ACB
		mov	ebx, [esp+10h+arg_4]
		mov	ebp, eax
		test	ebx, ebx
		jz	short loc_10001AA2
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10001A97
		mov	edx, [esi]
		jmp	short loc_10001A99
; ---------------------------------------------------------------------------

loc_10001A97:				; CODE XREF: sub_10001A3D+54j
		mov	edx, esi	; void *

loc_10001A99:				; CODE XREF: sub_10001A3D+58j
		push	ebx		; size_t
		mov	ecx, ebp	; void *
		call	sub_100010DE
		pop	ecx

loc_10001AA2:				; CODE XREF: sub_10001A3D+4Ej
		push	0		; size_t
		push	1		; char
		mov	ecx, esi
		call	sub_1000189A
		test	esi, esi
		jz	short loc_10001AB3
		mov	[esi], ebp

loc_10001AB3:				; CODE XREF: sub_10001A3D+72j
		mov	[esi+14h], edi
		mov	[esi+10h], ebx
		cmp	edi, 10h
		jb	short loc_10001AC0
		mov	esi, [esi]

loc_10001AC0:				; CODE XREF: sub_10001A3D+7Fj
		pop	edi
		mov	byte ptr [esi+ebx], 0
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10001A3D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001ACB	proc near		; CODE XREF: sub_10001A3D+41p
					; sub_10001D8A+B7p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_10001AEE
		cmp	eax, 0FFFFFFFFh
		ja	short loc_10001AE8
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_10001AEE

loc_10001AE8:				; CODE XREF: sub_10001ACB+Dj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10001AEE:				; CODE XREF: sub_10001ACB+8j
					; sub_10001ACB+1Bj
		mov	eax, ecx
		retn	4
sub_10001ACB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001AF3	proc near		; CODE XREF: sub_10001C7F+17p
					; sub_10006844+54p ...
		xor	edx, edx
		cmp	[ecx], dx
		jz	short loc_10001B10
		push	esi
		lea	esi, [ecx+2]

loc_10001AFE:				; CODE XREF: sub_10001AF3+14j
		mov	ax, [ecx]
		add	ecx, 2
		cmp	ax, dx
		jnz	short loc_10001AFE
		mov	edx, ecx
		sub	edx, esi
		sar	edx, 1
		pop	esi

loc_10001B10:				; CODE XREF: sub_10001AF3+5j
		mov	eax, edx
		retn
sub_10001AF3	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10001B13@<eax>(void *@<ecx>, void *@<edx>,	int)
sub_10001B13	proc near		; CODE XREF: sub_10002311+20p
					; sub_10002356+53p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001B2A
		add	eax, eax
		push	eax		; size_t
		push	edx		; void *
		push	ecx		; void *
		call	memcpy
		add	esp, 0Ch
		mov	ecx, eax

loc_10001B2A:				; CODE XREF: sub_10001B13+6j
		mov	eax, ecx
		retn
sub_10001B13	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10001B2D@<eax>(void *@<ecx>, void *@<edx>,	int)
sub_10001B2D	proc near		; CODE XREF: sub_10002570+47p
					; sub_100034A3+15p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_10001B45
		add	eax, eax
		push	eax		; size_t
		push	edx		; void *
		push	ecx		; void *
		call	ds:memmove
		add	esp, 0Ch
		mov	ecx, eax

loc_10001B45:				; CODE XREF: sub_10001B2D+6j
		mov	eax, ecx
		retn
sub_10001B2D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B48	proc near		; CODE XREF: sub_1000591B+27p
					; sub_10005965+9Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_8]
		push	esi
		mov	esi, ecx
		push	ecx
		push	ecx
		lea	ecx, [esi+8]
		mov	[esi], eax
		call	sub_10001CAD
		mov	eax, [esp+4+arg_0]
		mov	[esi+0A4h], eax
		mov	eax, [esp+4+arg_4]
		mov	[esi+0A8h], eax
		call	ds:GetLastError
		mov	[esi+0ACh], eax
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10001B48	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B81	proc near		; CODE XREF: sub_10001BED+13j
					; sub_10002986-6F3p
		push	esi
		lea	esi, [ecx+50h]
		mov	ecx, esi
		call	sub_10001D0F
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::~basic_ios<char,std::char_traits<char>>(void)
sub_10001B81	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001B95	proc near		; CODE XREF: sub_1000D7F6+39p

arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, ecx
		push	ecx
		push	ecx
		lea	ecx, [esi+8]
		mov	dword ptr [esi], 3
		call	sub_10001CAD
		mov	dword ptr [esi+0A4h], offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		mov	dword ptr [esi+0A8h], 24h
		call	ds:GetLastError
		cmp	[esp+4+arg_8], 0
		mov	[esi+0ACh], eax
		jz	short loc_10001BE7
		mov	ecx, [esp+4+arg_8]
		push	0		; size_t
		push	1		; char
		call	sub_1000189A
		push	[esp+4+arg_8]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001BE7:				; CODE XREF: sub_10001B95+38j
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10001B95	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001BED	proc near		; CODE XREF: sub_1000591B+3Fp
					; sub_10005965+B0p ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi+0ACh] ; dwErrCode
		call	ds:SetLastError
		lea	ecx, [esi+8]
		pop	esi
		jmp	sub_10001B81
sub_10001BED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10001C05	proc near		; CODE XREF: sub_10014BCE+B3p

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_34] ; void *
		push	edx		; void *
		call	sub_10001C7F
		mov	edx, eax
		lea	ecx, [ebp+var_1C]
		call	sub_1000437B
		mov	edx, eax
		mov	ecx, esi
		call	sub_10002683
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C]
		mov	esi, eax
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_10002311
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10001C05	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10001C5F(void *)
sub_10001C5F	proc near		; CODE XREF: sub_10004918+4Ap

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]	; void *
		mov	esi, ecx
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		mov	byte ptr [esi],	0
		call	sub_100022CA
		mov	eax, esi
		pop	esi
		retn	4
sub_10001C5F	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10001C7F(void *, void *)
sub_10001C7F	proc near		; CODE XREF: sub_10001C05+17p
					; sub_100029FE+20p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		mov	ecx, [esp+4+arg_0]
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10001AF3
		push	eax		; int
		push	[esp+8+arg_0]	; void *
		mov	ecx, esi	; void *
		call	sub_10002356
		mov	eax, esi
		pop	esi
		retn	4
sub_10001C7F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001CAD	proc near		; CODE XREF: sub_10001B48+Ep
					; sub_10001B95+Ep ...

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		mov	[esp+10h+var_4], ebx
		lea	ecx, [edi+50h]
		mov	dword ptr [edi], offset	dword_1001A994
		call	ds:??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::basic_ios<char,std::char_traits<char>>(void)
		push	ebx
		push	ebx
		lea	esi, [edi+4]
		mov	ecx, edi
		push	esi
		call	ds:??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z ; std::basic_ostream<char,std::char_traits<char>>::basic_ostream<char,std::char_traits<char>>(std::basic_streambuf<char,std::char_traits<char>> *,bool)
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1001A954
		mov	eax, [edi]
		mov	ecx, [eax+4]
		lea	eax, [ecx-50h]
		mov	[ecx+edi-4], eax
		mov	ecx, esi
		call	ds:??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::basic_streambuf<char,std::char_traits<char>>(void)
		mov	eax, edi
		mov	[esi+38h], ebx
		pop	edi
		mov	dword ptr [esi], offset	off_1001A958
		mov	dword ptr [esi+3Ch], 4
		pop	esi
		pop	ebx
		pop	ecx
		retn	8
sub_10001CAD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001D0F	proc near		; CODE XREF: sub_10001B81+6p
					; sub_1000325B+82p
		push	esi
		mov	esi, ecx
		mov	eax, [esi-50h]
		lea	ecx, [esi-4Ch]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-50h], offset	off_1001A954
		mov	eax, [esi-50h]
		mov	edx, [eax+4]
		lea	eax, [edx-50h]
		mov	[edx+esi-54h], eax
		call	sub_10001D3F
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_ostream<char,std::char_traits<char>>::~basic_ostream<char,std::char_traits<char>>(void)
sub_10001D0F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001D3F	proc near		; CODE XREF: sub_10001D0F+21p
					; sub_100022AD+3p
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 1
		mov	dword ptr [esi], offset	off_1001A958
		jz	short loc_10001D5A
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001D5A:				; CODE XREF: sub_10001D3F+Dj
		mov	eax, [esi+0Ch]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], ecx
		mov	eax, [esi+10h]
		mov	[eax], ecx
		mov	eax, [esi+20h]
		mov	[eax], ecx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		and	dword ptr [esi+3Ch], 0FFFFFFFEh
		mov	[esi+38h], ecx
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ ; std::basic_streambuf<char,std::char_traits<char>>::~basic_streambuf<char,std::char_traits<char>>(void)
sub_10001D3F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001D8A	proc near		; DATA XREF: .rdata:1001A964o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10001D9C
		or	eax, 0FFFFFFFFh
		jmp	loc_10001F19
; ---------------------------------------------------------------------------

loc_10001D9C:				; CODE XREF: sub_10001D8A+8j
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		cmp	ebx, 0FFFFFFFFh
		jnz	short loc_10001DAD
		xor	eax, eax
		jmp	loc_10001F18
; ---------------------------------------------------------------------------

loc_10001DAD:				; CODE XREF: sub_10001D8A+1Aj
		test	byte ptr [esi+3Ch], 8
		push	edi
		jz	short loc_10001DD3
		mov	edi, [esi+20h]
		cmp	dword ptr [edi], 0
		jz	short loc_10001DD3
		mov	edx, [esi+38h]
		cmp	[edi], edx
		jnb	short loc_10001DD3
		mov	eax, [esi+30h]
		mov	ecx, [eax]
		add	ecx, [edi]
		mov	[edi], edx
		sub	ecx, edx
		mov	eax, [esi+30h]
		mov	[eax], ecx

loc_10001DD3:				; CODE XREF: sub_10001D8A+28j
					; sub_10001D8A+30j ...
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10001DFC
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		add	ecx, edx
		cmp	edx, ecx
		jnb	short loc_10001DF8
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	[eax], bl
		mov	eax, ebx
		jmp	loc_10001F17
; ---------------------------------------------------------------------------

loc_10001DF8:				; CODE XREF: sub_10001D8A+5Bj
		test	edx, edx
		jnz	short loc_10001E00

loc_10001DFC:				; CODE XREF: sub_10001D8A+50j
		xor	ebx, ebx
		jmp	short loc_10001E0C
; ---------------------------------------------------------------------------

loc_10001E00:				; CODE XREF: sub_10001D8A+70j
		mov	eax, [esi+30h]
		mov	ecx, [esi+0Ch]
		mov	ebx, [eax]
		sub	ebx, [ecx]
		add	ebx, edx

loc_10001E0C:				; CODE XREF: sub_10001D8A+74j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_10001E1D
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10001E30

loc_10001E1D:				; CODE XREF: sub_10001D8A+8Bj
					; sub_10001D8A+A0j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_10001E2C
		shr	ecx, 1
		jnz	short loc_10001E1D

loc_10001E2C:				; CODE XREF: sub_10001D8A+9Cj
		test	ecx, ecx
		jnz	short loc_10001E38

loc_10001E30:				; CODE XREF: sub_10001D8A+91j
		or	eax, 0FFFFFFFFh
		jmp	loc_10001F17
; ---------------------------------------------------------------------------

loc_10001E38:				; CODE XREF: sub_10001D8A+A4j
		lea	eax, [ecx+ebx]
		push	ebp
		push	eax
		mov	[esp+18h+var_4], eax
		call	sub_10001ACB
		mov	ecx, [esi+0Ch]
		mov	edi, eax
		mov	ebp, [ecx]
		test	ebx, ebx
		jz	short loc_10001E60
		push	ebx		; size_t
		mov	edx, ebp	; void *
		mov	ecx, edi	; void *
		call	sub_100010DE
		pop	ecx
		test	ebx, ebx
		jnz	short loc_10001E91

loc_10001E60:				; CODE XREF: sub_10001D8A+C5j
		mov	eax, [esi+10h]
		mov	edx, [esp+14h+var_4]
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], edx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_10001ECA
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	short loc_10001EF4
; ---------------------------------------------------------------------------

loc_10001E91:				; CODE XREF: sub_10001D8A+D4j
		mov	ecx, [esi+10h]
		mov	eax, edi
		sub	eax, ebp
		add	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, edi
		sub	eax, ebp
		sub	edx, ebp
		add	[ecx], eax
		add	edx, edi
		mov	eax, [esi+20h]
		mov	ecx, edi
		sub	ecx, edx
		add	ecx, [esp+14h+var_4]
		mov	[eax], edx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10001ED4
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_10001ECA:				; CODE XREF: sub_10001D8A+F8j
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		mov	[eax], edi
		jmp	short loc_10001EF4
; ---------------------------------------------------------------------------

loc_10001ED4:				; CODE XREF: sub_10001D8A+136j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		mov	eax, [esi+0Ch]
		sub	ecx, ebp
		add	ecx, edi
		sub	edx, ecx
		inc	edx
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10001EF4:				; CODE XREF: sub_10001D8A+105j
					; sub_10001D8A+148j
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10001F02
		push	ebp
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10001F02:				; CODE XREF: sub_10001D8A+16Ej
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Pninc(void)
		mov	ecx, [esp+14h+arg_0]
		pop	ebp
		mov	[eax], cl
		mov	eax, ecx

loc_10001F17:				; CODE XREF: sub_10001D8A+69j
					; sub_10001D8A+A9j
		pop	edi

loc_10001F18:				; CODE XREF: sub_10001D8A+1Ej
		pop	ebx

loc_10001F19:				; CODE XREF: sub_10001D8A+Dj
		pop	esi
		pop	ecx
		retn	4
sub_10001D8A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F1E	proc near		; DATA XREF: .rdata:1001A968o

arg_0		= dword	ptr  4

		mov	edx, ecx
		push	esi
		mov	eax, [edx+1Ch]
		mov	esi, [eax]
		test	esi, esi
		jz	short loc_10001F63
		mov	eax, [edx+0Ch]
		cmp	esi, [eax]
		jbe	short loc_10001F63
		mov	ecx, [esp+4+arg_0]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10001F45
		cmp	cl, [esi-1]
		jz	short loc_10001F45
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_10001F63

loc_10001F45:				; CODE XREF: sub_10001F1E+1Aj
					; sub_10001F1E+1Fj
		mov	eax, [edx+2Ch]
		inc	dword ptr [eax]
		mov	eax, [edx+1Ch]
		dec	dword ptr [eax]
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10001F5D
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	[eax], cl
		jmp	short loc_10001F5F
; ---------------------------------------------------------------------------

loc_10001F5D:				; CODE XREF: sub_10001F1E+34j
		xor	ecx, ecx

loc_10001F5F:				; CODE XREF: sub_10001F1E+3Dj
		mov	eax, ecx
		jmp	short loc_10001F66
; ---------------------------------------------------------------------------

loc_10001F63:				; CODE XREF: sub_10001F1E+Aj
					; sub_10001F1E+11j ...
		or	eax, 0FFFFFFFFh

loc_10001F66:				; CODE XREF: sub_10001F1E+43j
		pop	esi
		retn	4
sub_10001F1E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001F6A	proc near		; DATA XREF: .rdata:1001A970o
		push	esi
		mov	esi, [ecx+1Ch]
		mov	edx, [esi]
		test	edx, edx
		jnz	short loc_10001F79
		or	eax, 0FFFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10001F79:				; CODE XREF: sub_10001F6A+8j
		push	edi
		mov	edi, [ecx+2Ch]
		mov	eax, [edi]
		add	eax, edx
		cmp	edx, eax
		jnb	short loc_10001F8A
		movzx	eax, byte ptr [edx]
		jmp	short loc_10001FBE
; ---------------------------------------------------------------------------

loc_10001F8A:				; CODE XREF: sub_10001F6A+19j
		test	byte ptr [ecx+3Ch], 4
		jnz	short loc_10001FBB
		mov	eax, [ecx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10001FBB
		cmp	eax, edx
		ja	short loc_10001FA2
		cmp	[ecx+38h], edx
		jbe	short loc_10001FBB

loc_10001FA2:				; CODE XREF: sub_10001F6A+31j
		cmp	[ecx+38h], eax
		jnb	short loc_10001FAA
		mov	[ecx+38h], eax

loc_10001FAA:				; CODE XREF: sub_10001F6A+3Bj
		mov	eax, [ecx+38h]
		sub	eax, [esi]
		mov	[edi], eax
		mov	eax, [ecx+1Ch]
		mov	eax, [eax]
		movzx	eax, byte ptr [eax]
		jmp	short loc_10001FBE
; ---------------------------------------------------------------------------

loc_10001FBB:				; CODE XREF: sub_10001F6A+24j
					; sub_10001F6A+2Dj ...
		or	eax, 0FFFFFFFFh

loc_10001FBE:				; CODE XREF: sub_10001F6A+1Ej
					; sub_10001F6A+4Fj
		pop	edi
		pop	esi
		retn
sub_10001F6A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10001FC1	proc near		; DATA XREF: .rdata:1001A980o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	ecx, [ebx+20h]
		mov	eax, [ecx]
		test	eax, eax
		jz	short loc_10001FD9
		cmp	[ebx+38h], eax
		jnb	short loc_10001FD9
		mov	[ebx+38h], eax

loc_10001FD9:				; CODE XREF: sub_10001FC1+Ej
					; sub_10001FC1+13j
		test	byte ptr [esp+14h+arg_10], 1
		jz	loc_100020AF
		mov	eax, [ebx+1Ch]
		mov	edx, [eax]
		mov	[esp+14h+var_4], edx
		test	edx, edx
		jz	loc_100020AF
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10002009
		mov	eax, [ebx+38h]
		jmp	short loc_10002017
; ---------------------------------------------------------------------------

loc_10002009:				; CODE XREF: sub_10001FC1+41j
		cmp	eax, 1
		jnz	short loc_1000202B
		test	byte ptr [esp+14h+arg_10], 2
		jnz	short loc_1000202F
		mov	eax, edx

loc_10002017:				; CODE XREF: sub_10001FC1+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_1000203F
; ---------------------------------------------------------------------------

loc_1000202B:				; CODE XREF: sub_10001FC1+4Bj
		test	eax, eax
		jz	short loc_10002037

loc_1000202F:				; CODE XREF: sub_10001FC1+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_1000203F
; ---------------------------------------------------------------------------

loc_10002037:				; CODE XREF: sub_10001FC1+6Cj
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_1000203F:				; CODE XREF: sub_10001FC1+68j
					; sub_10001FC1+74j
		test	edi, edi
		jl	loc_10002138
		jg	short loc_10002051
		test	esi, esi
		jb	loc_10002138

loc_10002051:				; CODE XREF: sub_10001FC1+86j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	loc_10002138
		jl	short loc_1000206E
		cmp	esi, eax
		ja	loc_10002138

loc_1000206E:				; CODE XREF: sub_10001FC1+A3j
		mov	eax, [ebx+2Ch]
		sub	ecx, [esp+14h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002158
		mov	edx, [ebx+20h]
		cmp	dword ptr [edx], 0
		jz	loc_10002158
		mov	eax, [ebx+30h]
		mov	ecx, [eax]
		mov	eax, [ebx+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		mov	[eax], ecx
		jmp	loc_10002158
; ---------------------------------------------------------------------------

loc_100020AF:				; CODE XREF: sub_10001FC1+1Dj
					; sub_10001FC1+2Ej
		test	byte ptr [esp+14h+arg_10], 2
		jz	loc_10002140
		mov	edx, [ecx]
		mov	[esp+14h+arg_10], edx
		test	edx, edx
		jz	short loc_10002140
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_100020D8
		mov	eax, [ebx+38h]
		jmp	short loc_100020DF
; ---------------------------------------------------------------------------

loc_100020D8:				; CODE XREF: sub_10001FC1+110j
		cmp	eax, 1
		jnz	short loc_100020F3
		mov	eax, edx

loc_100020DF:				; CODE XREF: sub_10001FC1+115j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10002107
; ---------------------------------------------------------------------------

loc_100020F3:				; CODE XREF: sub_10001FC1+11Aj
		test	eax, eax
		jz	short loc_100020FF
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002107
; ---------------------------------------------------------------------------

loc_100020FF:				; CODE XREF: sub_10001FC1+134j
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10002107:				; CODE XREF: sub_10001FC1+130j
					; sub_10001FC1+13Cj
		test	edi, edi
		jl	short loc_10002138
		jg	short loc_10002111
		test	esi, esi
		jb	short loc_10002138

loc_10002111:				; CODE XREF: sub_10001FC1+14Aj
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		cdq
		cmp	edi, edx
		jg	short loc_10002138
		jl	short loc_10002126
		cmp	esi, eax
		ja	short loc_10002138

loc_10002126:				; CODE XREF: sub_10001FC1+15Fj
		mov	eax, [ebx+30h]
		sub	ecx, [esp+14h+arg_10]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [ebx+20h]
		add	[eax], ecx
		jmp	short loc_10002158
; ---------------------------------------------------------------------------

loc_10002138:				; CODE XREF: sub_10001FC1+80j
					; sub_10001FC1+8Aj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10002158
; ---------------------------------------------------------------------------

loc_10002140:				; CODE XREF: sub_10001FC1+F3j
					; sub_10001FC1+101j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_10002158
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_10002158:				; CODE XREF: sub_10001FC1+C2j
					; sub_10001FC1+CEj ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_10001FC1	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002174	proc near		; DATA XREF: .rdata:1001A984o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= dword	ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_10]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_C]
		add	esi, [esp+14h+arg_4]
		push	edi
		adc	ebx, [esp+18h+arg_8]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_1000219D
		cmp	[edi+38h], eax
		jnb	short loc_1000219D
		mov	[edi+38h], eax

loc_1000219D:				; CODE XREF: sub_10002174+1Fj
					; sub_10002174+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_100021B9
		cmp	ebx, ebp
		jz	loc_10002270

loc_100021B9:				; CODE XREF: sub_10002174+3Bj
		test	byte ptr [esp+18h+arg_1C], 1
		jz	short loc_1000222A
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_10002228
		test	ebx, ebx
		jl	short loc_10002222
		jg	short loc_100021D7
		test	esi, esi
		jb	short loc_10002222

loc_100021D7:				; CODE XREF: sub_10002174+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_10002222
		jl	short loc_100021EC
		cmp	esi, eax
		ja	short loc_10002222

loc_100021EC:				; CODE XREF: sub_10002174+72j
		mov	eax, [edi+2Ch]
		sub	ecx, [esp+18h+var_4]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+1Ch]
		add	[eax], ecx
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_10002270
		mov	edx, [edi+20h]
		cmp	dword ptr [edx], 0
		jz	short loc_10002270
		mov	eax, [edi+30h]
		mov	ecx, [eax]
		mov	eax, [edi+1Ch]
		add	ecx, [edx]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		mov	[eax], ecx
		jmp	short loc_10002270
; ---------------------------------------------------------------------------

loc_10002222:				; CODE XREF: sub_10002174+5Bj
					; sub_10002174+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_1000226E
; ---------------------------------------------------------------------------

loc_10002228:				; CODE XREF: sub_10002174+57j
		mov	eax, ecx

loc_1000222A:				; CODE XREF: sub_10002174+4Aj
		test	byte ptr [esp+18h+arg_1C], 2
		jz	short loc_1000226C
		mov	ecx, [edx]
		mov	[esp+18h+arg_1C], ecx
		test	ecx, ecx
		jz	short loc_1000226C
		test	ebx, ebx
		jl	short loc_10002222
		jg	short loc_10002245
		test	esi, esi
		jb	short loc_10002222

loc_10002245:				; CODE XREF: sub_10002174+CBj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		cdq
		cmp	ebx, edx
		jg	short loc_10002222
		jl	short loc_1000225A
		cmp	esi, eax
		ja	short loc_10002222

loc_1000225A:				; CODE XREF: sub_10002174+E0j
		mov	eax, [edi+30h]
		sub	ecx, [esp+18h+arg_1C]
		add	ecx, esi
		sub	[eax], ecx
		mov	eax, [edi+20h]
		add	[eax], ecx
		jmp	short loc_10002270
; ---------------------------------------------------------------------------

loc_1000226C:				; CODE XREF: sub_10002174+BBj
					; sub_10002174+C5j
		mov	esi, eax

loc_1000226E:				; CODE XREF: sub_10002174+B2j
		mov	ebx, ebp

loc_10002270:				; CODE XREF: sub_10002174+3Fj
					; sub_10002174+8Dj ...
		mov	eax, [esp+18h+arg_0]
		xor	ecx, ecx
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_10002174	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_10002986

loc_1000228D:				; CODE XREF: sub_10002986+3j
		push	esi
		lea	esi, [ecx-50h]
		mov	ecx, esi
		call	sub_10001B81
		test	[esp+4+arg_0], 1
		jz	short loc_100022A7
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100022A7:				; CODE XREF: sub_10002986-6E9j
		mov	eax, esi
		pop	esi
		retn	4
; END OF FUNCTION CHUNK	FOR sub_10002986

; =============== S U B	R O U T	I N E =======================================


sub_100022AD	proc near		; DATA XREF: .rdata:off_1001A958o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10001D3F
		test	[esp+4+arg_0], 1
		jz	short loc_100022C4
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100022C4:				; CODE XREF: sub_100022AD+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100022AD	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100022CA(void *)
sub_100022CA	proc near		; CODE XREF: sub_10001C5F+15p
					; sub_1000279B+87p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 10h
		jnb	short loc_100022E7
		mov	eax, [esi+10h]
		mov	edx, esi	; void *
		inc	eax
		push	eax		; size_t
		call	sub_100010F8
		pop	ecx
		jmp	short loc_100022F2
; ---------------------------------------------------------------------------

loc_100022E7:				; CODE XREF: sub_100022CA+Cj
		test	edi, edi
		jz	short loc_100022EF
		mov	eax, [esi]
		mov	[edi], eax

loc_100022EF:				; CODE XREF: sub_100022CA+1Fj
		and	dword ptr [esi], 0

loc_100022F2:				; CODE XREF: sub_100022CA+1Bj
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 0Fh
		pop	edi
		mov	byte ptr [esi],	0
		pop	esi
		retn	4
sub_100022CA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002311	proc near		; CODE XREF: sub_10001C05+44p
					; sub_1000245E+40p ...

arg_0		= byte ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0
		push	esi
		mov	esi, ecx
		jz	short loc_10002340
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002340
		cmp	[esp+4+arg_4], 0
		push	ebx
		mov	ebx, [esi]
		jbe	short loc_10002337
		push	[esp+8+arg_4]	; int
		mov	edx, ebx	; void *
		call	sub_10001B13
		pop	ecx

loc_10002337:				; CODE XREF: sub_10002311+18j
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ebx

loc_10002340:				; CODE XREF: sub_10002311+8j
					; sub_10002311+Ej
		push	[esp+4+arg_4]
		mov	ecx, esi
		mov	dword ptr [esi+14h], 7
		call	sub_100023C1
		pop	esi
		retn	8
sub_10002311	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10002356(void *, void *, int)
sub_10002356	proc near		; CODE XREF: sub_10001C7F+23p
					; sub_10002BDC+1Bp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	esi, ecx
		push	edi
		call	sub_100024C5
		test	al, al
		jz	short loc_10002388
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002374
		mov	eax, [esi]
		jmp	short loc_10002376
; ---------------------------------------------------------------------------

loc_10002374:				; CODE XREF: sub_10002356+18j
		mov	eax, esi

loc_10002376:				; CODE XREF: sub_10002356+1Cj
		push	[ebp+arg_4]	; int
		sub	edi, eax
		mov	ecx, esi	; void *
		sar	edi, 1
		push	edi		; int
		push	esi		; int
		call	sub_100023D9
		jmp	short loc_100023BB
; ---------------------------------------------------------------------------

loc_10002388:				; CODE XREF: sub_10002356+12j
		push	0
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_1000245E
		test	al, al
		jz	short loc_100023B9
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100023A2
		mov	ecx, [esi]
		jmp	short loc_100023A4
; ---------------------------------------------------------------------------

loc_100023A2:				; CODE XREF: sub_10002356+46j
		mov	ecx, esi	; void *

loc_100023A4:				; CODE XREF: sub_10002356+4Aj
		push	[ebp+arg_4]	; int
		mov	edx, edi	; void *
		call	sub_10001B13
		pop	ecx
		push	[ebp+arg_4]
		mov	ecx, esi
		call	sub_100023C1

loc_100023B9:				; CODE XREF: sub_10002356+40j
		mov	eax, esi

loc_100023BB:				; CODE XREF: sub_10002356+30j
		pop	edi
		pop	esi
		pop	ebp
		retn	8
sub_10002356	endp


; =============== S U B	R O U T	I N E =======================================


sub_100023C1	proc near		; CODE XREF: sub_10002311+3Cp
					; sub_10002356+5Ep ...

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		mov	eax, [esp+arg_0]
		mov	[ecx+10h], eax
		jb	short loc_100023D0
		mov	ecx, [ecx]

loc_100023D0:				; CODE XREF: sub_100023C1+Bj
		xor	edx, edx
		mov	[ecx+eax*2], dx
		retn	4
sub_100023C1	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100023D9(void *, int, int,	int)
sub_100023D9	proc near		; CODE XREF: sub_10002356+2Bp
					; sub_100034EC+65p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		push	edi
		mov	edi, [ebx+10h]
		mov	esi, ecx
		cmp	edi, ebp
		jnb	short loc_100023F9

loc_100023EE:				; CODE XREF: sub_100023D9+36j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_100023F9:				; CODE XREF: sub_100023D9+13j
		sub	edi, ebp
		cmp	[esp+10h+arg_8], edi
		jnb	short loc_10002405
		mov	edi, [esp+10h+arg_8]

loc_10002405:				; CODE XREF: sub_100023D9+26j
		cmp	esi, ebx
		jnz	short loc_10002423
		lea	eax, [edi+ebp]
		cmp	[esi+10h], eax
		jb	short loc_100023EE
		push	eax
		call	sub_100023C1
		push	ebp
		push	0
		mov	ecx, esi
		call	sub_10002570
		jmp	short loc_10002455
; ---------------------------------------------------------------------------

loc_10002423:				; CODE XREF: sub_100023D9+2Ej
		push	0
		push	edi
		call	sub_1000245E
		test	al, al
		jz	short loc_10002455
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_10002437
		mov	ebx, [ebx]

loc_10002437:				; CODE XREF: sub_100023D9+5Aj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002441
		mov	ecx, [esi]
		jmp	short loc_10002443
; ---------------------------------------------------------------------------

loc_10002441:				; CODE XREF: sub_100023D9+62j
		mov	ecx, esi	; void *

loc_10002443:				; CODE XREF: sub_100023D9+66j
		push	edi		; int
		lea	edx, [ebx+ebp*2] ; void	*
		call	sub_10001B13
		pop	ecx
		push	edi
		mov	ecx, esi
		call	sub_100023C1

loc_10002455:				; CODE XREF: sub_100023D9+48j
					; sub_100023D9+54j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100023D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000245E	proc near		; CODE XREF: sub_10002356+39p
					; sub_100023D9+4Dp ...

arg_0		= dword	ptr  4
arg_4		= byte ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		cmp	esi, 7FFFFFFEh
		jbe	short loc_10002476
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10002476:				; CODE XREF: sub_1000245E+Bj
		cmp	[ecx+14h], esi
		jnb	short loc_10002486
		push	dword ptr [ecx+10h] ; int
		push	esi		; int
		call	sub_100025CD
		jmp	short loc_100024B9
; ---------------------------------------------------------------------------

loc_10002486:				; CODE XREF: sub_1000245E+1Bj
		cmp	[esp+4+arg_4], 0
		jz	short loc_100024A5
		cmp	esi, 8
		jnb	short loc_100024A5
		mov	eax, [ecx+10h]
		cmp	esi, eax
		jnb	short loc_1000249B
		mov	eax, esi

loc_1000249B:				; CODE XREF: sub_1000245E+39j
		push	eax
		push	1
		call	sub_10002311
		jmp	short loc_100024B9
; ---------------------------------------------------------------------------

loc_100024A5:				; CODE XREF: sub_1000245E+2Dj
					; sub_1000245E+32j
		test	esi, esi
		jnz	short loc_100024B9
		and	[ecx+10h], esi
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100024B4
		mov	ecx, [ecx]

loc_100024B4:				; CODE XREF: sub_1000245E+52j
		xor	eax, eax
		mov	[ecx], ax

loc_100024B9:				; CODE XREF: sub_1000245E+26j
					; sub_1000245E+45j ...
		xor	eax, eax
		cmp	eax, esi
		pop	esi
		sbb	eax, eax
		neg	eax
		retn	8
sub_1000245E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100024C5	proc near		; CODE XREF: sub_10002356+Bp
					; sub_10003388+9p ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		test	edx, edx
		jz	short loc_100024F9
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_100024D7
		mov	eax, [ecx]
		jmp	short loc_100024D9
; ---------------------------------------------------------------------------

loc_100024D7:				; CODE XREF: sub_100024C5+Cj
		mov	eax, ecx

loc_100024D9:				; CODE XREF: sub_100024C5+10j
		cmp	edx, eax
		jb	short loc_100024F9
		cmp	dword ptr [ecx+14h], 8
		push	esi
		jb	short loc_100024E8
		mov	esi, [ecx]
		jmp	short loc_100024EA
; ---------------------------------------------------------------------------

loc_100024E8:				; CODE XREF: sub_100024C5+1Dj
		mov	esi, ecx

loc_100024EA:				; CODE XREF: sub_100024C5+21j
		mov	eax, [ecx+10h]
		lea	eax, [esi+eax*2]
		pop	esi
		cmp	eax, edx
		jbe	short loc_100024F9
		mov	al, 1
		jmp	short locret_100024FB
; ---------------------------------------------------------------------------

loc_100024F9:				; CODE XREF: sub_100024C5+6j
					; sub_100024C5+16j ...
		xor	al, al

locret_100024FB:			; CODE XREF: sub_100024C5+32j
		retn	4
sub_100024C5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100024FE	proc near		; CODE XREF: sub_10002683+3Ap
					; sub_10002847+52p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		mov	[edi], esi
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	ecx, [eax+esi+38h]
		test	ecx, ecx
		jz	short loc_1000251A
		mov	eax, [ecx]
		call	dword ptr [eax+4]

loc_1000251A:				; CODE XREF: sub_100024FE+15j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_10002538
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_10002538
		cmp	ecx, esi
		jz	short loc_10002538
		call	ds:?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<char,std::char_traits<char>>::flush(void)

loc_10002538:				; CODE XREF: sub_100024FE+26j
					; sub_100024FE+2Ej ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100024FE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000254F	proc near		; CODE XREF: sub_10002683+109p
					; sub_10002847+130p
		push	esi
		mov	esi, ecx
		mov	ecx, [esi]
		call	ds:?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ ;	std::basic_ostream<char,std::char_traits<char>>::_Osfx(void)
		mov	ecx, [esi]
		pop	esi
		mov	eax, [ecx]
		mov	eax, [eax+4]
		mov	ecx, [eax+ecx+38h]
		test	ecx, ecx
		jz	short locret_1000256F
		mov	eax, [ecx]
		jmp	dword ptr [eax+8]
; ---------------------------------------------------------------------------

locret_1000256F:			; CODE XREF: sub_1000254F+19j
		retn
sub_1000254F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002570	proc near		; CODE XREF: sub_100023D9+43p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, edx
		jnb	short loc_1000258A
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_1000258A:				; CODE XREF: sub_10002570+Dj
		mov	eax, edi
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		sub	eax, edx
		cmp	eax, ebx
		ja	short loc_1000259A
		push	edx
		jmp	short loc_100025C0
; ---------------------------------------------------------------------------

loc_1000259A:				; CODE XREF: sub_10002570+25j
		test	ebx, ebx
		jz	short loc_100025C5
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100025A8
		mov	eax, [esi]
		jmp	short loc_100025AA
; ---------------------------------------------------------------------------

loc_100025A8:				; CODE XREF: sub_10002570+32j
		mov	eax, esi

loc_100025AA:				; CODE XREF: sub_10002570+36j
		lea	ecx, [eax+edx*2] ; void	*
		sub	edi, ebx
		mov	eax, edi
		sub	eax, edx
		lea	edx, [ecx+ebx*2] ; void	*
		push	eax		; int
		call	sub_10001B2D
		pop	ecx
		push	edi
		mov	ecx, esi

loc_100025C0:				; CODE XREF: sub_10002570+28j
		call	sub_100023C1

loc_100025C5:				; CODE XREF: sub_10002570+2Cj
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10002570	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100025CD(void *, int, int)
sub_100025CD	proc near		; CODE XREF: sub_1000245E+21p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	esi, ecx
		or	edi, 7
		cmp	edi, 7FFFFFFEh
		jbe	short loc_100025E8
		mov	edi, [esp+10h+arg_0]
		jmp	short loc_1000260C
; ---------------------------------------------------------------------------

loc_100025E8:				; CODE XREF: sub_100025CD+13j
		push	3
		xor	edx, edx
		mov	ebx, [esi+14h]
		mov	eax, edi
		mov	ecx, ebx
		pop	ebp
		div	ebp
		shr	ecx, 1
		cmp	ecx, eax
		jbe	short loc_1000260C
		mov	edi, 7FFFFFFEh
		mov	eax, edi
		sub	eax, ecx
		cmp	ebx, eax
		ja	short loc_1000260C
		lea	edi, [ecx+ebx]

loc_1000260C:				; CODE XREF: sub_100025CD+19j
					; sub_100025CD+2Dj ...
		lea	eax, [edi+1]
		push	eax
		call	sub_10002657
		mov	ebx, [esp+10h+arg_4]
		mov	ebp, eax
		test	ebx, ebx
		jz	short loc_10002634
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10002629
		mov	edx, [esi]
		jmp	short loc_1000262B
; ---------------------------------------------------------------------------

loc_10002629:				; CODE XREF: sub_100025CD+56j
		mov	edx, esi	; void *

loc_1000262B:				; CODE XREF: sub_100025CD+5Aj
		push	ebx		; int
		mov	ecx, ebp	; void *
		call	sub_10001B13
		pop	ecx

loc_10002634:				; CODE XREF: sub_100025CD+50j
		push	0
		push	1
		mov	ecx, esi
		call	sub_10002311
		test	esi, esi
		jz	short loc_10002645
		mov	[esi], ebp

loc_10002645:				; CODE XREF: sub_100025CD+74j
		push	ebx
		mov	ecx, esi
		mov	[esi+14h], edi
		call	sub_100023C1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_100025CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002657	proc near		; CODE XREF: sub_100025CD+43p
					; sub_10004143+A4p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		xor	ecx, ecx
		test	eax, eax
		jz	short loc_1000267E
		cmp	eax, 7FFFFFFFh
		ja	short loc_10002678
		add	eax, eax
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000267E

loc_10002678:				; CODE XREF: sub_10002657+Fj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000267E:				; CODE XREF: sub_10002657+8j
					; sub_10002657+1Fj
		mov	eax, ecx
		retn	4
sub_10002657	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002683	proc near		; CODE XREF: sub_10001C05+2Ap

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		push	edi
		xor	ebx, ebx
		mov	eax, [esi]
		mov	ecx, [ebp+10h]
		mov	[esp+24h+var_14], ecx
		mov	edi, [eax+4]
		cmp	[edi+esi+24h], ebx
		jl	short loc_100026B6
		jg	short loc_100026AA
		cmp	[edi+esi+20h], ebx
		jbe	short loc_100026B6

loc_100026AA:				; CODE XREF: sub_10002683+1Fj
		mov	edi, [edi+esi+20h]
		cmp	edi, ecx
		jbe	short loc_100026B6
		sub	edi, ecx
		jmp	short loc_100026B8
; ---------------------------------------------------------------------------

loc_100026B6:				; CODE XREF: sub_10002683+1Dj
					; sub_10002683+25j ...
		xor	edi, edi

loc_100026B8:				; CODE XREF: sub_10002683+31j
		push	esi
		lea	ecx, [esp+28h+var_C]
		call	sub_100024FE
		cmp	[esp+24h+var_8], bl
		jnz	short loc_100026D0
		push	4
		pop	ebx
		jmp	loc_10002778
; ---------------------------------------------------------------------------

loc_100026D0:				; CODE XREF: sub_10002683+43j
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	eax, [eax+esi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_1000270A
		test	edi, edi
		jz	short loc_1000270A

loc_100026E7:				; CODE XREF: sub_10002683+85j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	al, [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		mov	byte ptr [esp+24h+var_10], al
		push	[esp+24h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_1000275C
		dec	edi
		jnz	short loc_100026E7

loc_1000270A:				; CODE XREF: sub_10002683+5Ej
					; sub_10002683+62j
		cmp	dword ptr [ebp+14h], 10h
		jb	short loc_10002713
		mov	ebp, [ebp+0]

loc_10002713:				; CODE XREF: sub_10002683+8Bj
		mov	eax, [esi]
		push	0
		push	[esp+28h+var_14]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+esi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+24h+var_14]
		jnz	short loc_10002766
		test	edx, edx
		jnz	short loc_10002766

loc_10002733:				; CODE XREF: sub_10002683+DCj
		test	edi, edi
		jz	short loc_10002769

loc_10002737:				; CODE XREF: sub_10002683+D5j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		mov	al, [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		mov	byte ptr [esp+24h+var_10], al
		push	[esp+24h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10002761
		dec	edi
		jnz	short loc_10002737
		jmp	short loc_10002769
; ---------------------------------------------------------------------------

loc_1000275C:				; CODE XREF: sub_10002683+82j
		push	4
		pop	ebx
		jmp	short loc_10002733
; ---------------------------------------------------------------------------

loc_10002761:				; CODE XREF: sub_10002683+D2j
		or	ebx, 4
		jmp	short loc_10002769
; ---------------------------------------------------------------------------

loc_10002766:				; CODE XREF: sub_10002683+AAj
					; sub_10002683+AEj
		push	4
		pop	ebx

loc_10002769:				; CODE XREF: sub_10002683+B2j
					; sub_10002683+D7j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		and	dword ptr [eax+esi+20h], 0
		and	dword ptr [eax+esi+24h], 0

loc_10002778:				; CODE XREF: sub_10002683+48j
		mov	eax, [esi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, esi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_1000254F
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10002683	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000279B	proc near		; CODE XREF: sub_1000325B+75p

var_20		= byte ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	edx, ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		test	byte ptr [edx+3Ch], 2
		push	edi
		jnz	short loc_100027EB
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_100027EB
		cmp	[edx+38h], ecx
		jb	short loc_100027CA
		mov	ecx, [edx+38h]

loc_100027CA:				; CODE XREF: sub_1000279B+2Aj
		mov	eax, [edx+10h]

loc_100027CD:				; CODE XREF: sub_1000279B+69j
		mov	eax, [eax]
		xor	ebx, ebx
		push	0Fh
		pop	edi
		sub	ecx, eax
		mov	[ebp+var_C], edi
		push	ecx		; size_t
		push	eax		; void *
		lea	ecx, [ebp+var_20] ; void *
		mov	[ebp+var_10], ebx
		mov	[ebp+var_20], bl
		call	sub_100018DB
		jmp	short loc_10002814
; ---------------------------------------------------------------------------

loc_100027EB:				; CODE XREF: sub_1000279B+1Cj
					; sub_1000279B+25j
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_10002806
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_10002806
		mov	eax, [edx+2Ch]
		mov	ecx, [eax]
		mov	eax, [edx+0Ch]
		add	ecx, edi
		jmp	short loc_100027CD
; ---------------------------------------------------------------------------

loc_10002806:				; CODE XREF: sub_1000279B+54j
					; sub_1000279B+5Dj
		push	0Fh
		xor	ebx, ebx
		pop	edi
		mov	[ebp+var_C], edi
		mov	[ebp+var_10], ebx
		mov	[ebp+var_20], bl

loc_10002814:				; CODE XREF: sub_1000279B+4Ej
		lea	eax, [ebp+var_20]
		mov	[esi+14h], edi
		mov	[esi+10h], ebx
		mov	ecx, esi
		push	eax		; void *
		mov	[esi], bl
		call	sub_100022CA
		push	ebx		; size_t
		push	1		; char
		lea	ecx, [ebp+var_20]
		call	sub_1000189A
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000279B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002847	proc near		; CODE XREF: sub_1000325B+28p
					; sub_1000325B+34p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
var_4		= byte ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		mov	eax, edx
		xor	ebp, ebp
		push	edi
		mov	edi, ecx
		mov	[esp+28h+var_C], eax
		mov	ecx, eax
		call	sub_100010C6
		mov	esi, [edi]
		mov	[esp+28h+var_14], eax
		mov	edx, [esi+4]
		mov	ebx, [edx+edi+24h]
		mov	esi, [edx+edi+20h]
		test	ebx, ebx
		jl	short loc_10002890
		jg	short loc_1000288A
		test	esi, esi
		jz	short loc_10002890
		test	ebx, ebx
		jl	short loc_10002890
		jg	short loc_1000288A
		cmp	esi, eax
		jbe	short loc_10002890

loc_1000288A:				; CODE XREF: sub_10002847+33j
					; sub_10002847+3Dj
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_10002894
; ---------------------------------------------------------------------------

loc_10002890:				; CODE XREF: sub_10002847+31j
					; sub_10002847+37j ...
		xor	esi, esi
		xor	ebx, ebx

loc_10002894:				; CODE XREF: sub_10002847+47j
		push	edi
		lea	ecx, [esp+2Ch+var_8]
		call	sub_100024FE
		cmp	[esp+28h+var_4], 0
		jnz	short loc_100028AD
		push	4
		pop	ebp
		jmp	loc_10002963
; ---------------------------------------------------------------------------

loc_100028AD:				; CODE XREF: sub_10002847+5Cj
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100028F6
		test	ebx, ebx
		jl	short loc_100028F6
		jle	short loc_100028F2

loc_100028C6:				; CODE XREF: sub_10002847+A7j
					; sub_10002847+ADj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+28h+var_10], al
		push	[esp+28h+var_10]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10002951
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100028C6
		jl	short loc_100028F6

loc_100028F2:				; CODE XREF: sub_10002847+7Dj
		test	esi, esi
		jnz	short loc_100028C6

loc_100028F6:				; CODE XREF: sub_10002847+77j
					; sub_10002847+7Bj ...
		mov	eax, [edi]
		push	0
		push	[esp+2Ch+var_14]
		mov	eax, [eax+4]
		push	[esp+30h+var_C]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::sputn(char const *,__int64)
		cmp	eax, [esp+28h+var_14]
		jnz	short loc_10002951
		test	edx, edx
		jnz	short loc_10002951
		test	ebx, ebx
		jl	short loc_10002954
		jle	short loc_1000294B

loc_1000291F:				; CODE XREF: sub_10002847+100j
					; sub_10002847+106j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		mov	al, [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		mov	byte ptr [esp+28h+var_C], al
		push	[esp+28h+var_C]
		call	ds:?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z ; std::basic_streambuf<char,std::char_traits<char>>::sputc(char)
		cmp	eax, 0FFFFFFFFh
		jz	short loc_10002951
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_1000291F
		jl	short loc_10002954

loc_1000294B:				; CODE XREF: sub_10002847+D6j
		test	esi, esi
		jnz	short loc_1000291F
		jmp	short loc_10002954
; ---------------------------------------------------------------------------

loc_10002951:				; CODE XREF: sub_10002847+9Dj
					; sub_10002847+CCj ...
		push	4
		pop	ebp

loc_10002954:				; CODE XREF: sub_10002847+D4j
					; sub_10002847+102j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10002963:				; CODE XREF: sub_10002847+61j
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z	; std::basic_ios<char,std::char_traits<char>>::setstate(int,bool)
		lea	ecx, [esp+28h+var_8]
		call	sub_1000254F
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10002847	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002986	proc near		; DATA XREF: .rdata:off_1001A954o

arg_0		= byte ptr  4

; FUNCTION CHUNK AT 1000228D SIZE 00000020 BYTES

		sub	ecx, [ecx-4]
		jmp	loc_1000228D
sub_10002986	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000298E	proc near		; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+4Bp
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, offset aDummy ; "dummy"
		push	edi
		push	6
		push	1
		mov	eax, [esi]
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	7
		push	2
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	offset aHkey_current_4 ; "HKEY_CURRENT_USER\\dummy"
		push	0Bh
		push	3
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	0Ah
		push	4
		call	dword ptr [eax+5Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	edi
		push	5
		push	5
		call	dword ptr [eax+5Ch]
		pop	edi
		pop	esi
		retn
sub_1000298E	endp

; Exported entry  11. ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z

; =============== S U B	R O U T	I N E =======================================


; void __cdecl mozilla::sandboxing::ProvideLogFunction(mozilla::sandboxing *this, void (__cdecl	*)(const char *, const char *, const char *, bool, unsigned int))
		public ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z proc near
					; DATA XREF: .rdata:off_1002E058o

this		= dword	ptr  4

		mov	eax, [esp+this]
		mov	dword_10031378,	eax
		retn
?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z endp


; =============== S U B	R O U T	I N E =======================================


sub_100029E2	proc near		; CODE XREF: sub_100029FE+3Ep
					; sub_10002A69+4Ap ...

arg_0		= dword	ptr  4

		mov	eax, dword_10031378
		test	eax, eax
		jz	short locret_100029FD
		push	[esp+arg_0]
		push	1
		push	edx
		push	ecx
		push	offset aBlocked	; "BLOCKED"
		call	eax ; dword_10031378
		add	esp, 14h

locret_100029FD:			; CODE XREF: sub_100029E2+7j
		retn
sub_100029E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100029FE	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+8Ap
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+82p

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10031378,	0
		push	esi
		mov	esi, ecx
		jz	short loc_10002A5A
		push	edx		; void *
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001C7F
		lea	edx, [ebp+var_1C]
		lea	ecx, [ebp+var_34]
		call	sub_1000437B
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002A36
		mov	eax, [eax]

loc_10002A36:				; CODE XREF: sub_100029FE+34j
		push	3
		mov	edx, eax
		mov	ecx, esi
		call	sub_100029E2
		pop	ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_34]
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311

loc_10002A5A:				; CODE XREF: sub_100029FE+1Aj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100029FE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002A69	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+5Ap
					; TargetNtOpenFile(x,x,x,x,x,x,x)+49p ...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		cmp	dword_10031378,	0
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		movzx	eax, ax
		jz	short loc_10002AD3
		push	eax		; int
		push	edx		; void *
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002BDC
		mov	edx, eax
		lea	ecx, [esp+38h+var_34]
		call	sub_1000437B
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002AAD
		mov	eax, [eax]

loc_10002AAD:				; CODE XREF: sub_10002A69+40j
		push	3
		mov	edx, eax
		mov	ecx, esi
		call	sub_100029E2
		pop	ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [esp+40h+var_34]
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002311

loc_10002AD3:				; CODE XREF: sub_10002A69+24j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002A69	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002AE3	proc near		; CODE XREF: sub_10002AFD+3Cp
					; sub_10002B65+48p ...
		mov	eax, dword_10031378
		test	eax, eax
		jz	short locret_10002AFC
		push	0
		push	0
		push	edx
		push	ecx
		push	offset aBrokerAllowed ;	"Broker	ALLOWED"
		call	eax ; dword_10031378
		add	esp, 14h

locret_10002AFC:			; CODE XREF: sub_10002AE3+7j
		retn
sub_10002AE3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002AFD	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+15Cp
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+160p

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		cmp	dword_10031378,	0
		push	esi
		mov	esi, ecx
		jz	short loc_10002B56
		push	edx		; void *
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001C7F
		lea	edx, [ebp+var_1C]
		lea	ecx, [ebp+var_34]
		call	sub_1000437B
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002B35
		mov	eax, [eax]

loc_10002B35:				; CODE XREF: sub_10002AFD+34j
		mov	edx, eax
		mov	ecx, esi
		call	sub_10002AE3
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_34]
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311

loc_10002B56:				; CODE XREF: sub_10002AFD+1Aj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002AFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002B65	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1ADp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+190p	...

var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		cmp	dword_10031378,	0
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		movzx	eax, ax
		jz	short loc_10002BCC
		push	eax		; int
		push	edx		; void *
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002BDC
		mov	edx, eax
		lea	ecx, [esp+38h+var_34]
		call	sub_1000437B
		cmp	dword ptr [eax+14h], 10h
		jb	short loc_10002BA9
		mov	eax, [eax]

loc_10002BA9:				; CODE XREF: sub_10002B65+40j
		mov	edx, eax
		mov	ecx, esi
		call	sub_10002AE3
		push	0		; size_t
		push	1		; char
		lea	ecx, [esp+40h+var_34]
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002311

loc_10002BCC:				; CODE XREF: sub_10002B65+24j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10002B65	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10002BDC(void *, int)
sub_10002BDC	proc near		; CODE XREF: sub_10002A69+2Cp
					; sub_10002B65+2Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	[esp+4+arg_4]	; int
		mov	esi, ecx
		xor	eax, eax
		push	[esp+8+arg_0]	; void *
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_10002356
		mov	eax, esi
		pop	esi
		retn	8
sub_10002BDC	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002C02	proc near		; CODE XREF: sub_100053BD+2Ap
					; sub_100055DC+14p
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, ecx
		push	offset aUnknown	; "unknown"
		lea	ecx, [esi+28h]	; void *
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+10h], ebx
		mov	[esi+14h], ebx
		mov	[esi+18h], ebx
		mov	[esi+1Ch], ebx
		mov	[esi+20h], ebx
		mov	[esi+24h], ebx
		call	sub_100017D6
		mov	dword ptr [esi+54h], 0Fh
		mov	ecx, esi
		mov	[esi+50h], ebx
		mov	[esi+40h], bl
		call	sub_10002C4B
		mov	eax, esi
		pop	esi
		pop	ebx
		retn
sub_10002C02	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002C4B	proc near		; CODE XREF: sub_10002C02+3Fp

var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= byte ptr -34h
var_4		= dword	ptr -4

		sub	esp, 50h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+50h+var_4], eax
		or	[esp+50h+var_50], 0FFFFFFFFh
		xor	eax, eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		lea	edi, [esp+60h+var_4C]
		mov	ebp, ecx
		stosd
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	[esp+60h+var_38], ebp
		push	0Ch		; size_t
		stosd
		stosd
		xor	eax, eax
		cpuid
		mov	[esi], eax
		lea	edi, [esp+64h+var_34]
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		lea	esi, [esp+64h+var_4C]
		mov	ecx, [esp+64h+var_48]
		mov	eax, [esp+64h+var_44]
		mov	[esp+64h+var_48], eax
		lea	eax, [esp+64h+var_34]
		mov	[esp+64h+var_44], ecx
		lea	ecx, [ebp+28h]	; void *
		movsd
		push	eax		; void *
		movsd
		movsd
		call	sub_100018DB
		cmp	[esp+60h+var_50], 0
		jle	loc_10002DAC
		xor	eax, eax
		lea	esi, [esp+60h+var_50]
		inc	eax
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	esi, [esp+60h+var_50]
		mov	eax, esi
		push	0Fh
		pop	edi
		and	eax, edi
		mov	ebx, [esp+60h+var_48]
		mov	[ebp+10h], eax
		mov	edx, esi
		sar	edx, 0Ch
		mov	ecx, esi
		sar	ecx, 4
		mov	eax, edx
		and	eax, 0F0h
		mov	[ebp+0], esi
		and	ecx, edi
		and	edx, 3
		add	ecx, eax
		mov	[ebp+4], edx
		mov	eax, esi
		mov	[ebp+0Ch], ecx
		sar	eax, 8
		mov	ecx, [esp+60h+var_44]
		and	eax, edi
		mov	[ebp+8], eax
		mov	eax, esi
		sar	eax, 10h
		and	eax, edi
		sar	esi, 14h
		mov	[ebp+14h], eax
		and	esi, 0FFh
		mov	eax, ecx
		mov	[ebp+18h], esi
		shr	eax, 17h
		and	al, 1
		mov	[ebp+1Ch], al
		mov	eax, ecx
		shr	eax, 19h
		and	al, 1
		shr	ecx, 1Ah
		mov	[ebp+1Dh], al
		and	cl, 1
		mov	al, bl
		mov	[ebp+1Eh], cl
		and	al, 1
		mov	[ebp+1Fh], al
		mov	eax, ebx
		shr	eax, 9
		and	al, 1
		mov	[ebp+20h], al
		mov	eax, ebx
		shr	eax, 13h
		and	al, 1
		mov	[ebp+21h], al
		mov	eax, ebx
		shr	eax, 14h
		and	al, 1
		mov	[ebp+22h], al
		mov	eax, ebx
		shr	eax, 1Ch
		and	al, 1
		push	0
		mov	[ebp+24h], al
		pop	eax
		jz	short loc_10002DA0
		test	ebx, 4000000h
		jz	short loc_10002DA0
		test	ebx, 8000000h
		jz	short loc_10002DA0
		xor	ecx, ecx
		xgetbv
		and	eax, 6
		cmp	eax, 6
		jnz	short loc_10002D9E
		xor	eax, eax
		cmp	eax, eax
		jnz	short loc_10002DA0
		inc	eax
		jmp	short loc_10002DA0
; ---------------------------------------------------------------------------

loc_10002D9E:				; CODE XREF: sub_10002C4B+148j
		xor	eax, eax

loc_10002DA0:				; CODE XREF: sub_10002C4B+12Bj
					; sub_10002C4B+133j ...
		shr	ebx, 19h
		and	bl, 1
		mov	[ebp+23h], al
		mov	[ebp+25h], bl

loc_10002DAC:				; CODE XREF: sub_10002C4B+69j
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		mov	eax, 80000000h
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	ebx, [esp+60h+var_50]
		mov	[esp+60h+var_3C], ebx
		cmp	ebx, 80000004h
		jl	short loc_10002E2D
		mov	eax, 80000002h
		lea	ebp, [esp+60h+var_34]
		mov	[esp+60h+var_40], eax

loc_10002DE1:				; CODE XREF: sub_10002C4B+1C8j
		lea	ecx, [esp+60h+var_4]
		cmp	ebp, ecx
		jnb	short loc_10002E15
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	edi, ebp
		mov	eax, [esp+60h+var_40]
		add	ebp, 10h
		mov	[esi+4], ebx
		inc	eax
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		movsd
		mov	[esp+60h+var_40], eax
		movsd
		movsd
		movsd
		cmp	eax, 80000004h
		jle	short loc_10002DE1

loc_10002E15:				; CODE XREF: sub_10002C4B+19Cj
		lea	eax, [esp+60h+var_34]
		sub	ebp, eax
		push	ebp		; size_t
		mov	ebp, [esp+64h+var_38]
		push	eax		; void *
		lea	ecx, [ebp+40h]	; void *
		call	sub_100018DB
		mov	ebx, [esp+60h+var_3C]

loc_10002E2D:				; CODE XREF: sub_10002C4B+187j
		mov	eax, 80000007h
		cmp	ebx, eax
		jl	short loc_10002E55
		lea	esi, [esp+60h+var_50]
		xor	ecx, ecx
		cpuid
		mov	[esi], eax
		mov	[esi+4], ebx
		mov	[esi+8], ecx
		mov	[esi+0Ch], edx
		mov	eax, [esp+60h+var_44]
		shr	eax, 8
		and	al, 1
		mov	[ebp+26h], al

loc_10002E55:				; CODE XREF: sub_10002C4B+1E9j
		mov	ecx, [esp+60h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 50h
		retn
sub_10002C4B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002E68	proc near		; CODE XREF: sub_10005965+87p
					; sub_10005A2B+8Dp
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_10002E68	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002E6D	proc near		; DATA XREF: .rdata:off_1001AA20o

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1001AA20
		jz	short loc_10002E85
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10002E85:				; CODE XREF: sub_10002E6D+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10002E6D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10002E8B	proc near		; CODE XREF: sub_10004592+59p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		mov	ecx, dword_10031F38
		test	ecx, ecx
		jnz	short loc_10002EDC
		push	offset a_thunks	; ".thunks"
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], 10000000h
		call	sub_100056F9
		test	eax, eax
		jz	short loc_10002ED3
		push	offset a_syzygy	; ".syzygy"
		lea	ecx, [ebp+var_8]
		call	sub_100056F9
		test	eax, eax
		jz	short loc_10002ED3
		xor	ecx, ecx
		inc	ecx
		jmp	short loc_10002ED6
; ---------------------------------------------------------------------------

loc_10002ED3:				; CODE XREF: sub_10002E8B+30j
					; sub_10002E8B+41j
		push	2
		pop	ecx

loc_10002ED6:				; CODE XREF: sub_10002E8B+46j
		mov	dword_10031F38,	ecx

loc_10002EDC:				; CODE XREF: sub_10002E8B+11j
		xor	eax, eax
		cmp	ecx, 1
		setz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_10002E8B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002EE8	proc near		; CODE XREF: sub_10005C77+1Ap
		test	ecx, ecx
		jz	short loc_10002F34
		movzx	edx, word ptr [ecx]
		movzx	ecx, word ptr [ecx+2]
		add	edx, 4
		mov	eax, edx
		shl	eax, 5
		xor	ecx, eax
		shl	ecx, 0Bh
		xor	edx, ecx
		mov	eax, edx
		shr	eax, 0Bh
		add	edx, eax
		mov	eax, edx
		shl	eax, 3
		xor	edx, eax
		mov	eax, edx
		shr	eax, 5
		add	edx, eax
		mov	eax, edx
		shl	eax, 4
		xor	edx, eax
		mov	eax, edx
		shr	eax, 11h
		add	edx, eax
		mov	eax, edx
		shl	eax, 19h
		xor	edx, eax
		mov	eax, edx
		shr	eax, 6
		add	eax, edx
		retn
; ---------------------------------------------------------------------------

loc_10002F34:				; CODE XREF: sub_10002EE8+2j
		xor	eax, eax
		retn
sub_10002EE8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F37	proc near		; CODE XREF: sub_10005546+12p
					; sub_10005B09+12p ...
		xor	edx, edx
		xor	eax, eax
		push	esi
		mov	esi, ecx
		inc	edx
		lock cmpxchg [esi], edx
		test	eax, eax
		jnz	short loc_10002F53
		mov	al, 1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10002F4B:				; CODE XREF: sub_10002F37+21j
		push	0		; dwMilliseconds
		call	ds:Sleep

loc_10002F53:				; CODE XREF: sub_10002F37+Ej
		mov	eax, [esi]
		cmp	eax, 1
		jz	short loc_10002F4B
		xor	al, al
		pop	esi
		retn
sub_10002F37	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F5E	proc near		; CODE XREF: sub_10004610+1Cp
		mov	eax, [esp+0]
		retn
sub_10002F5E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F62	proc near		; CODE XREF: sub_1000426A+Ep

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10002F6C
		mov	edx, [ecx]
		jmp	short loc_10002F6E
; ---------------------------------------------------------------------------

loc_10002F6C:				; CODE XREF: sub_10002F62+4j
		mov	edx, ecx

loc_10002F6E:				; CODE XREF: sub_10002F62+8j
		mov	eax, [ecx+10h]
		add	eax, edx
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_10002F7D
		mov	edx, [ecx]
		jmp	short loc_10002F7F
; ---------------------------------------------------------------------------

loc_10002F7D:				; CODE XREF: sub_10002F62+15j
		mov	edx, ecx

loc_10002F7F:				; CODE XREF: sub_10002F62+19j
		test	eax, eax
		jz	short loc_10002F85
		sub	eax, edx

loc_10002F85:				; CODE XREF: sub_10002F62+1Fj
		push	[esp+arg_0]
		push	ecx
		push	eax
		call	sub_10002F93
		retn	4
sub_10002F62	endp


; =============== S U B	R O U T	I N E =======================================


sub_10002F93	proc near		; CODE XREF: sub_10002F62+29p

arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		cmp	ecx, edi
		jnb	short loc_10002FAD
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10002FAD:				; CODE XREF: sub_10002F93+Dj
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, 1
		ja	short loc_10002FC2
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10002FC2:				; CODE XREF: sub_10002F93+22j
		push	ebx
		lea	ebx, [ecx+1]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_100019A3
		test	al, al
		jz	short loc_1000301E
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10002FDE
		mov	edx, [esi]
		jmp	short loc_10002FE0
; ---------------------------------------------------------------------------

loc_10002FDE:				; CODE XREF: sub_10002F93+45j
		mov	edx, esi

loc_10002FE0:				; CODE XREF: sub_10002F93+49j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10002FEA
		mov	ecx, [esi]
		jmp	short loc_10002FEC
; ---------------------------------------------------------------------------

loc_10002FEA:				; CODE XREF: sub_10002F93+51j
		mov	ecx, esi

loc_10002FEC:				; CODE XREF: sub_10002F93+55j
		mov	eax, [esi+10h]
		inc	ecx
		sub	eax, edi
		add	edx, edi	; void *
		push	eax		; size_t
		add	ecx, edi	; void *
		call	sub_100010F8
		pop	ecx
		push	[esp+0Ch+arg_8]	; int
		mov	ecx, esi
		push	1		; size_t
		push	edi		; int
		call	sub_10003026
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebx
		jb	short loc_10003018
		mov	eax, [esi]
		jmp	short loc_1000301A
; ---------------------------------------------------------------------------

loc_10003018:				; CODE XREF: sub_10002F93+7Fj
		mov	eax, esi

loc_1000301A:				; CODE XREF: sub_10002F93+83j
		mov	byte ptr [eax+ebx], 0

loc_1000301E:				; CODE XREF: sub_10002F93+3Fj
		pop	ebx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_10002F93	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10003026(int, size_t, int)
sub_10003026	proc near		; CODE XREF: sub_10002F93+73p
					; sub_10003068+3Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 1
		mov	edx, ecx
		jnz	short loc_10003044
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_10003039
		mov	edx, [edx]

loc_10003039:				; CODE XREF: sub_10003026+Fj
		mov	eax, [ebp+arg_0]
		mov	cl, byte ptr [ebp+arg_8]
		mov	[edx+eax], cl
		jmp	short loc_10003064
; ---------------------------------------------------------------------------

loc_10003044:				; CODE XREF: sub_10003026+9j
		cmp	dword ptr [edx+14h], 10h
		jb	short loc_1000304C
		mov	edx, [edx]

loc_1000304C:				; CODE XREF: sub_10003026+22j
		push	[ebp+arg_4]	; size_t
		mov	eax, [ebp+arg_8]
		movsx	eax, al
		push	eax		; int
		mov	eax, [ebp+arg_0]
		add	eax, edx
		push	eax		; void *
		call	memset
		add	esp, 0Ch

loc_10003064:				; CODE XREF: sub_10003026+1Cj
		pop	ebp
		retn	0Ch
sub_10003026	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003068(size_t, int)
sub_10003068	proc near		; CODE XREF: sub_10003B0E+20p
					; sub_100044EC+43p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_10003087
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003087:				; CODE XREF: sub_10003068+12j
		test	edi, edi
		jz	short loc_100030C0
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_100019A3
		test	al, al
		jz	short loc_100030BF
		push	[esp+0Ch+arg_4]	; int
		mov	ecx, esi
		push	edi		; size_t
		push	dword ptr [esi+10h] ; int
		call	sub_10003026
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], ebx
		jb	short loc_100030B9
		mov	eax, [esi]
		jmp	short loc_100030BB
; ---------------------------------------------------------------------------

loc_100030B9:				; CODE XREF: sub_10003068+4Bj
		mov	eax, esi

loc_100030BB:				; CODE XREF: sub_10003068+4Fj
		mov	byte ptr [eax+ebx], 0

loc_100030BF:				; CODE XREF: sub_10003068+33j
		pop	ebx

loc_100030C0:				; CODE XREF: sub_10003068+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_10003068	endp


; =============== S U B	R O U T	I N E =======================================


sub_100030C7	proc near		; CODE XREF: sub_10003B59+17p
					; sub_1000FB42+AAp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, ecx
		or	eax, 0FFFFFFFFh
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+10h]
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_100030E6
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100030E6:				; CODE XREF: sub_100030C7+12j
		test	edi, edi
		jz	short loc_10003114
		push	ebx
		lea	ebx, [ecx+edi]
		mov	ecx, esi
		push	0
		push	ebx
		call	sub_1000245E
		test	al, al
		jz	short loc_10003113
		push	[esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		push	dword ptr [esi+10h]
		call	sub_1000311B
		push	ebx
		mov	ecx, esi
		call	sub_100023C1

loc_10003113:				; CODE XREF: sub_100030C7+33j
		pop	ebx

loc_10003114:				; CODE XREF: sub_100030C7+21j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_100030C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000311B	proc near		; CODE XREF: sub_100030C7+3Fp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	edx, ecx
		mov	ecx, [ebp+arg_4]
		cmp	ecx, 1
		jnz	short loc_1000313D
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10003130
		mov	edx, [edx]

loc_10003130:				; CODE XREF: sub_1000311B+11j
		mov	ecx, [ebp+arg_0]
		mov	ax, word ptr [ebp+arg_8]
		mov	[edx+ecx*2], ax
		jmp	short loc_10003167
; ---------------------------------------------------------------------------

loc_1000313D:				; CODE XREF: sub_1000311B+Bj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10003145
		mov	edx, [edx]

loc_10003145:				; CODE XREF: sub_1000311B+26j
		mov	eax, [ebp+arg_0]
		push	edi
		lea	edi, [edx+eax*2]
		test	ecx, ecx
		jz	short loc_10003166
		mov	eax, [ebp+arg_8]
		movzx	edx, ax
		mov	eax, edx
		shl	edx, 10h
		or	eax, edx
		shr	ecx, 1
		rep stosd
		adc	ecx, ecx
		rep stosw

loc_10003166:				; CODE XREF: sub_1000311B+33j
		pop	edi

loc_10003167:				; CODE XREF: sub_1000311B+20j
		pop	ebp
		retn	0Ch
sub_1000311B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000316B	proc near		; CODE XREF: sub_1000CCBD+1Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi+8]
		mov	eax, esi
		mov	ecx, [edi+4]
		sub	eax, ecx
		cmp	eax, [esp+8+arg_0]
		jnb	short loc_100031F5
		mov	eax, [edi]
		sub	eax, ecx
		dec	eax
		cmp	eax, [esp+8+arg_0]
		jnb	short loc_10003195
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003195:				; CODE XREF: sub_1000316B+1Dj
		sub	esi, [edi]
		or	eax, 0FFFFFFFFh
		sub	ecx, [edi]
		mov	edx, esi
		add	ecx, [esp+8+arg_0]
		shr	edx, 1
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_100031AE
		xor	esi, esi
		jmp	short loc_100031B0
; ---------------------------------------------------------------------------

loc_100031AE:				; CODE XREF: sub_1000316B+3Dj
		add	esi, edx

loc_100031B0:				; CODE XREF: sub_1000316B+41j
		cmp	esi, ecx
		jnb	short loc_100031B6
		mov	esi, ecx

loc_100031B6:				; CODE XREF: sub_1000316B+47j
		push	ebx
		push	ebp
		push	esi
		call	sub_10001ACB
		mov	ecx, [edi+4]
		mov	ebx, eax
		sub	ecx, [edi]
		push	ecx		; size_t
		push	dword ptr [edi]	; void *
		push	ebx		; void *
		call	ds:memmove
		mov	ebp, [edi+4]
		add	esp, 0Ch
		sub	ebp, [edi]
		cmp	dword ptr [edi], 0
		jz	short loc_100031E5
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100031E5:				; CODE XREF: sub_1000316B+6Fj
		lea	eax, [ebx+esi]
		mov	[edi], ebx
		mov	[edi+8], eax
		lea	eax, [ebx+ebp]
		pop	ebp
		mov	[edi+4], eax
		pop	ebx

loc_100031F5:				; CODE XREF: sub_1000316B+12j
		pop	edi
		pop	esi
		retn	4
sub_1000316B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100031FA	proc near		; CODE XREF: sub_10004345:loc_10004374p
					; sub_100044EC+23p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10003229
		cmp	[esi+14h], eax
		jz	short loc_10003229
		push	1
		push	eax
		call	sub_100019A3
		test	al, al
		jz	short loc_10003229
		cmp	dword ptr [esi+14h], 10h
		mov	[esi+10h], edi
		jb	short loc_10003225
		mov	esi, [esi]

loc_10003225:				; CODE XREF: sub_100031FA+27j
		mov	byte ptr [esi+edi], 0

loc_10003229:				; CODE XREF: sub_100031FA+Dj
					; sub_100031FA+12j ...
		pop	edi
		pop	esi
		retn	4
sub_100031FA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000322E	proc near		; CODE XREF: sub_100184BD+1A1p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi+10h]
		cmp	edi, eax
		ja	short loc_10003256
		cmp	[esi+14h], eax
		jz	short loc_10003256
		push	1
		push	eax
		call	sub_1000245E
		test	al, al
		jz	short loc_10003256
		push	edi
		mov	ecx, esi
		call	sub_100023C1

loc_10003256:				; CODE XREF: sub_1000322E+Dj
					; sub_1000322E+12j ...
		pop	edi
		pop	esi
		retn	4
sub_1000322E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000325B	proc near		; CODE XREF: sub_1000D7F6+26p

var_98		= byte ptr -98h
var_94		= byte ptr -94h
var_48		= byte ptr -48h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 98h
		push	esi
		push	edi
		push	ecx
		mov	edi, ecx
		mov	esi, edx
		push	ecx
		lea	ecx, [esp+0A8h+var_98]
		call	sub_10001CAD
		push	dword ptr [esi]
		mov	edx, [ebp+arg_0]
		lea	ecx, [esp+0A4h+var_98]
		push	dword ptr [edi]
		call	sub_10002847
		mov	edx, offset asc_1001A950 ; " ("
		mov	ecx, eax
		call	sub_10002847
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		mov	edx, offset aVs_ ; " vs. "
		mov	ecx, eax
		call	sub_10002847
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(uint)
		mov	edx, offset dword_1001A944
		mov	ecx, eax
		call	sub_10002847
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100032D7
		push	esi
		lea	ecx, [esp+0A4h+var_94]
		call	sub_1000279B
		jmp	short loc_100032D9
; ---------------------------------------------------------------------------

loc_100032D7:				; CODE XREF: sub_1000325B+6Ej
		xor	esi, esi

loc_100032D9:				; CODE XREF: sub_1000325B+7Aj
		lea	ecx, [esp+0A0h+var_48]
		call	sub_10001D0F
		lea	ecx, [esp+0A0h+var_48]
		call	ds:??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ ;	std::basic_ios<char,std::char_traits<char>>::~basic_ios<char,std::char_traits<char>>(void)
		pop	edi
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000325B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100032F4	proc near		; CODE XREF: sub_10003388+2Ap
					; sub_10011C65+37p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	eax, [ebx+10h]
		mov	esi, ecx
		cmp	eax, ebp
		jnb	short loc_10003313
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003313:				; CODE XREF: sub_100032F4+12j
		push	edi
		mov	edi, [esp+10h+arg_8]
		sub	eax, ebp
		cmp	eax, edi
		jnb	short loc_10003320
		mov	edi, eax

loc_10003320:				; CODE XREF: sub_100032F4+28j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_10003337
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003337:				; CODE XREF: sub_100032F4+36j
		test	edi, edi
		jz	short loc_1000337F
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_0], eax
		call	sub_1000245E
		test	al, al
		jz	short loc_1000337F
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_10003358
		mov	ebx, [ebx]

loc_10003358:				; CODE XREF: sub_100032F4+60j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003362
		mov	ecx, [esi]
		jmp	short loc_10003364
; ---------------------------------------------------------------------------

loc_10003362:				; CODE XREF: sub_100032F4+68j
		mov	ecx, esi

loc_10003364:				; CODE XREF: sub_100032F4+6Cj
		mov	eax, [esi+10h]
		lea	edx, [ebx+ebp*2] ; void	*
		push	edi		; int
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B13
		pop	ecx
		push	[esp+10h+arg_0]
		mov	ecx, esi
		call	sub_100023C1

loc_1000337F:				; CODE XREF: sub_100032F4+45j
					; sub_100032F4+5Aj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_100032F4	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003388(void *, int)
sub_10003388	proc near		; CODE XREF: sub_10004143+7Ep
					; sub_10004143+101p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		push	edi
		call	sub_100024C5
		test	al, al
		jz	short loc_100033B9
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100033A4
		mov	eax, [esi]
		jmp	short loc_100033A6
; ---------------------------------------------------------------------------

loc_100033A4:				; CODE XREF: sub_10003388+16j
		mov	eax, esi

loc_100033A6:				; CODE XREF: sub_10003388+1Aj
		push	[esp+8+arg_4]
		sub	edi, eax
		mov	ecx, esi
		sar	edi, 1
		push	edi
		push	esi
		call	sub_100032F4
		jmp	short loc_10003412
; ---------------------------------------------------------------------------

loc_100033B9:				; CODE XREF: sub_10003388+10j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+0Ch+arg_4]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_100033D5
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100033D5:				; CODE XREF: sub_10003388+40j
		test	ebx, ebx
		jz	short loc_1000340F
		push	ebp
		lea	ebp, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_1000245E
		test	al, al
		jz	short loc_1000340E
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100033F5
		mov	ecx, [esi]
		jmp	short loc_100033F7
; ---------------------------------------------------------------------------

loc_100033F5:				; CODE XREF: sub_10003388+67j
		mov	ecx, esi

loc_100033F7:				; CODE XREF: sub_10003388+6Bj
		mov	eax, [esi+10h]
		mov	edx, edi	; void *
		push	ebx		; int
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B13
		pop	ecx
		push	ebp
		mov	ecx, esi
		call	sub_100023C1

loc_1000340E:				; CODE XREF: sub_10003388+61j
		pop	ebp

loc_1000340F:				; CODE XREF: sub_10003388+4Fj
		mov	eax, esi
		pop	ebx

loc_10003412:				; CODE XREF: sub_10003388+2Fj
		pop	edi
		pop	esi
		retn	8
sub_10003388	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003417	proc near		; CODE XREF: sub_100036D7+47p
					; sub_10003F14+3Dp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		test	esi, esi
		jmp	short loc_1000342F
; ---------------------------------------------------------------------------

loc_10003420:				; CODE XREF: sub_10003417:loc_1000342Fj
		mov	ax, [ecx]
		cmp	ax, [edx]
		jnz	short loc_10003435
		add	ecx, 2
		add	edx, 2
		dec	esi

loc_1000342F:				; CODE XREF: sub_10003417+7j
		jnz	short loc_10003420
		xor	eax, eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10003435:				; CODE XREF: sub_10003417+Fj
		movzx	eax, word ptr [ecx]
		cmp	ax, [edx]
		pop	esi
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax
		retn
sub_10003417	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003443	proc near		; CODE XREF: sub_100036D7+6Fp
					; sub_10003B78+3Cp ...

arg_0		= dword	ptr  4

		test	edx, edx
		jz	short loc_10003459
		mov	eax, [esp+arg_0]
		movzx	eax, word ptr [eax]

loc_1000344E:				; CODE XREF: sub_10003443+14j
		cmp	[ecx], ax
		jz	short loc_1000345B
		add	ecx, 2
		dec	edx
		jnz	short loc_1000344E

loc_10003459:				; CODE XREF: sub_10003443+2j
		xor	ecx, ecx

loc_1000345B:				; CODE XREF: sub_10003443+Ej
		mov	eax, ecx
		retn
sub_10003443	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000345E	proc near		; CODE XREF: sub_10004818+89p
					; sub_10004989+4Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh	; int
		push	eax		; int
		push	[esp+0Ch+arg_0]	; int
		mov	dword ptr [esi+14h], 0Fh
		mov	[esi+10h], eax
		mov	[esi], al
		call	sub_10001802
		mov	eax, esi
		pop	esi
		retn	4
sub_1000345E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003481(void *)
sub_10003481	proc near		; CODE XREF: sub_100035E0+3Ap
					; sub_100035E0+5Ap ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]	; void *
		mov	esi, ecx
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100034A3
		mov	eax, esi
		pop	esi
		retn	4
sub_10003481	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100034A3(void *)
sub_100034A3	proc near		; CODE XREF: sub_10003481+17p
					; sub_10003B36+18p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	dword ptr [esi+14h], 8
		jnb	short loc_100034C0
		mov	eax, [esi+10h]
		mov	edx, esi	; void *
		inc	eax
		push	eax		; int
		call	sub_10001B2D
		pop	ecx
		jmp	short loc_100034CB
; ---------------------------------------------------------------------------

loc_100034C0:				; CODE XREF: sub_100034A3+Cj
		test	edi, edi
		jz	short loc_100034C8
		mov	eax, [esi]
		mov	[edi], eax

loc_100034C8:				; CODE XREF: sub_100034A3+1Fj
		and	dword ptr [esi], 0

loc_100034CB:				; CODE XREF: sub_100034A3+1Bj
		mov	eax, [esi+10h]
		mov	[edi+10h], eax
		mov	eax, [esi+14h]
		mov	[edi+14h], eax
		xor	eax, eax
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		pop	edi
		mov	[esi], ax
		pop	esi
		retn	4
sub_100034A3	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100034EC@<eax>(int@<ecx>, int, int)
sub_100034EC	proc near		; CODE XREF: sub_1000E968+5Ep
					; sub_1000E968+92p

var_26		= word ptr -26h
var_24		= dword	ptr -24h
var_20		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		mov	ebx, [esp+30h+arg_4]
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+3Ch+var_26], dx
		mov	ecx, ebx
		call	sub_100036B0
		mov	ebp, [edi+10h]
		xor	esi, esi
		xor	ecx, ecx
		cmp	esi, ebp

loc_10003519:				; CODE XREF: sub_100034EC+B0j
		jz	short loc_10003532
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003525
		mov	eax, [edi]
		jmp	short loc_10003527
; ---------------------------------------------------------------------------

loc_10003525:				; CODE XREF: sub_100034EC+33j
		mov	eax, edi

loc_10003527:				; CODE XREF: sub_100034EC+37j
		mov	dx, [esp+3Ch+var_26]
		cmp	[eax+esi*2], dx
		jnz	short loc_10003599

loc_10003532:				; CODE XREF: sub_100034EC:loc_10003519j
		and	[esp+3Ch+var_10], 0
		xor	eax, eax
		mov	[esp+3Ch+var_20], ax
		mov	eax, esi
		sub	eax, ecx
		mov	[esp+3Ch+var_C], 7
		push	eax		; int
		push	ecx		; int
		push	edi		; int
		lea	ecx, [esp+48h+var_20] ;	void *
		call	sub_100023D9
		lea	eax, [esp+3Ch+var_20]
		push	eax
		mov	ecx, eax
		call	sub_100038E4
		pop	ecx
		cmp	esi, ebp
		jnz	short loc_10003575
		mov	eax, [ebx]
		cmp	eax, [ebx+4]
		jnz	short loc_10003575
		cmp	[esp+3Ch+var_10], 0
		jz	short loc_10003581

loc_10003575:				; CODE XREF: sub_100034EC+79j
					; sub_100034EC+80j
		lea	eax, [esp+3Ch+var_20]
		mov	ecx, ebx
		push	eax
		call	sub_10003648

loc_10003581:				; CODE XREF: sub_100034EC+87j
		push	0
		lea	eax, [esi+1]
		push	1
		lea	ecx, [esp+44h+var_20]
		mov	[esp+44h+var_24], eax
		call	sub_10002311
		mov	ecx, [esp+3Ch+var_24]

loc_10003599:				; CODE XREF: sub_100034EC+44j
		inc	esi
		cmp	esi, ebp
		jbe	loc_10003519
		mov	ecx, [esp+3Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_100034EC	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100035B5(int, void	*, int,	int)
sub_100035B5	proc near		; CODE XREF: sub_100039D5+5Cp
					; sub_100107DD+9Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	[esp+4+arg_8]	; int
		mov	esi, [esp+8+arg_0]
		xor	eax, eax
		push	[esp+8+arg_4]	; int
		push	ecx		; int
		and	dword ptr [esi+10h], 0
		mov	ecx, esi	; void *
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100023D9
		mov	eax, esi
		pop	esi
		retn	0Ch
sub_100035B5	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100035E0(void *)
sub_100035E0	proc near		; CODE XREF: sub_10013578+1C6p
					; sub_10013578+26Ep ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_10003625
		cmp	[esi], edi
		ja	short loc_10003625
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_1000360D
		push	ecx
		mov	ecx, esi
		call	sub_1000376C

loc_1000360D:				; CODE XREF: sub_100035E0+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_1000361F
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax		; void *
		call	sub_10003481

loc_1000361F:				; CODE XREF: sub_100035E0+32j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_10003643
; ---------------------------------------------------------------------------

loc_10003625:				; CODE XREF: sub_100035E0+Dj
					; sub_100035E0+11j
		cmp	ecx, [esi+8]
		jnz	short loc_10003632
		push	ecx
		mov	ecx, esi
		call	sub_1000376C

loc_10003632:				; CODE XREF: sub_100035E0+48j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_1000363F
		push	edi		; void *
		call	sub_10003481

loc_1000363F:				; CODE XREF: sub_100035E0+57j
		add	dword ptr [esi+4], 18h

loc_10003643:				; CODE XREF: sub_100035E0+43j
		pop	edi
		pop	esi
		retn	4
sub_100035E0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003648	proc near		; CODE XREF: sub_100034EC+90p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		cmp	edi, ecx
		jnb	short loc_1000368D
		cmp	[esi], edi
		ja	short loc_1000368D
		sub	edi, [esi]
		push	ebx
		mov	eax, edi
		push	18h
		cdq
		pop	ebx
		idiv	ebx
		mov	edi, eax
		cmp	ecx, [esi+8]
		jnz	short loc_10003675
		push	ecx
		mov	ecx, esi
		call	sub_1000376C

loc_10003675:				; CODE XREF: sub_10003648+23j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_10003687
		imul	eax, edi, 18h
		add	eax, [esi]
		push	eax
		call	sub_100038A0

loc_10003687:				; CODE XREF: sub_10003648+32j
		add	[esi+4], ebx
		pop	ebx
		jmp	short loc_100036AB
; ---------------------------------------------------------------------------

loc_1000368D:				; CODE XREF: sub_10003648+Dj
					; sub_10003648+11j
		cmp	ecx, [esi+8]
		jnz	short loc_1000369A
		push	ecx
		mov	ecx, esi
		call	sub_1000376C

loc_1000369A:				; CODE XREF: sub_10003648+48j
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_100036A7
		push	edi
		call	sub_100038A0

loc_100036A7:				; CODE XREF: sub_10003648+57j
		add	dword ptr [esi+4], 18h

loc_100036AB:				; CODE XREF: sub_10003648+43j
		pop	edi
		pop	esi
		retn	4
sub_10003648	endp


; =============== S U B	R O U T	I N E =======================================


sub_100036B0	proc near		; CODE XREF: sub_100034EC+1Fp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, [edi+4]
		mov	esi, [edi]
		jmp	short loc_100036CA
; ---------------------------------------------------------------------------

loc_100036BC:				; CODE XREF: sub_100036B0+1Cj
		push	0
		push	1
		mov	ecx, esi
		call	sub_10002311
		add	esi, 18h

loc_100036CA:				; CODE XREF: sub_100036B0+Aj
		cmp	esi, ebx
		jnz	short loc_100036BC
		mov	eax, [edi]
		mov	[edi+4], eax
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100036B0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100036D7	proc near		; CODE XREF: sub_100107DD+4Fp
					; sub_100107DD+74p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebp
		mov	ebp, [esp+4+arg_8]
		push	esi
		mov	esi, ecx
		mov	ecx, [esp+8+arg_4]
		test	ebp, ebp
		jnz	short loc_100036F0
		cmp	ecx, [esi+10h]
		ja	short loc_100036F0
		mov	eax, ecx
		jmp	short loc_10003757
; ---------------------------------------------------------------------------

loc_100036F0:				; CODE XREF: sub_100036D7+Ej
					; sub_100036D7+13j
		push	ebx
		mov	ebx, [esi+10h]
		push	edi
		cmp	ecx, ebx
		jnb	short loc_10003752
		sub	ebx, ecx
		cmp	ebp, ebx
		ja	short loc_10003752
		xor	eax, eax
		inc	eax
		sub	eax, ebp
		add	ebx, eax
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003710
		mov	eax, [esi]
		jmp	short loc_10003712
; ---------------------------------------------------------------------------

loc_10003710:				; CODE XREF: sub_100036D7+33j
		mov	eax, esi

loc_10003712:				; CODE XREF: sub_100036D7+37j
		lea	eax, [eax+ecx*2]
		jmp	short loc_1000373A
; ---------------------------------------------------------------------------

loc_10003717:				; CODE XREF: sub_100036D7+79j
		mov	edx, [esp+10h+arg_0]
		mov	ecx, edi
		push	ebp
		call	sub_10003417
		pop	ecx
		test	eax, eax
		jz	short loc_1000375C
		mov	ecx, edi
		or	eax, 0FFFFFFFFh
		sub	ecx, [esp+10h+arg_8]
		sar	ecx, 1
		sub	eax, ecx
		add	ebx, eax
		lea	eax, [edi+2]

loc_1000373A:				; CODE XREF: sub_100036D7+3Ej
		push	[esp+10h+arg_0]
		mov	edx, ebx
		mov	[esp+14h+arg_8], eax
		mov	ecx, eax
		call	sub_10003443
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_10003717

loc_10003752:				; CODE XREF: sub_100036D7+20j
					; sub_100036D7+26j
		or	eax, 0FFFFFFFFh

loc_10003755:				; CODE XREF: sub_100036D7+93j
		pop	edi
		pop	ebx

loc_10003757:				; CODE XREF: sub_100036D7+17j
		pop	esi
		pop	ebp
		retn	0Ch
; ---------------------------------------------------------------------------

loc_1000375C:				; CODE XREF: sub_100036D7+4Fj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003764
		mov	esi, [esi]

loc_10003764:				; CODE XREF: sub_100036D7+89j
		sub	edi, esi
		sar	edi, 1
		mov	eax, edi
		jmp	short loc_10003755
sub_100036D7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000376C	proc near		; CODE XREF: sub_100035E0+28p
					; sub_100035E0+4Dp ...
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	18h
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_100037D0
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 0AAAAAAAh
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_100037A7
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100037A7:				; CODE XREF: sub_1000376C+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_100037BF
		xor	eax, eax
		jmp	short loc_100037C1
; ---------------------------------------------------------------------------

loc_100037BF:				; CODE XREF: sub_1000376C+4Dj
		add	eax, edx

loc_100037C1:				; CODE XREF: sub_1000376C+51j
		cmp	eax, ecx
		jnb	short loc_100037C7
		mov	eax, ecx

loc_100037C7:				; CODE XREF: sub_1000376C+57j
		push	eax
		mov	ecx, esi
		call	sub_100037D6
		pop	ebx

loc_100037D0:				; CODE XREF: sub_1000376C+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_1000376C	endp


; =============== S U B	R O U T	I N E =======================================


sub_100037D6	proc near		; CODE XREF: sub_1000376C+5Ep

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0Ch
		push	ebp
		mov	ebp, [esp+10h+arg_0]
		push	esi
		push	edi
		mov	esi, ecx
		xor	edi, edi
		mov	[esp+18h+var_4], esi
		test	ebp, ebp
		jz	short loc_1000380B
		cmp	ebp, 0AAAAAAAh
		ja	short loc_10003805
		imul	eax, ebp, 18h
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_1000380B

loc_10003805:				; CODE XREF: sub_100037D6+1Cj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000380B:				; CODE XREF: sub_100037D6+14j
					; sub_100037D6+2Dj
		mov	ecx, [esi+4]
		push	ebx
		mov	ebx, [esi]
		mov	[esp+1Ch+var_C], ecx
		push	18h
		pop	eax
		mov	[esp+1Ch+var_8], eax
		cmp	ebx, ecx
		jz	short loc_10003841
		mov	ebp, edi

loc_10003822:				; CODE XREF: sub_100037D6+65j
		test	ebp, ebp
		jz	short loc_10003835
		push	ebx		; void *
		mov	ecx, ebp
		call	sub_10003481
		mov	ecx, [esp+1Ch+var_C]
		push	18h
		pop	eax

loc_10003835:				; CODE XREF: sub_100037D6+4Ej
		add	ebx, eax
		add	ebp, eax
		cmp	ebx, ecx
		jnz	short loc_10003822
		mov	ebp, [esp+1Ch+arg_0]

loc_10003841:				; CODE XREF: sub_100037D6+48j
		mov	ecx, [esi+4]
		mov	eax, ecx
		mov	ebx, [esi]
		sub	eax, ebx
		cdq
		idiv	[esp+1Ch+var_8]
		mov	[esp+1Ch+var_8], eax
		test	ebx, ebx
		jz	short loc_10003882
		cmp	ebx, ecx
		jz	short loc_10003879
		push	18h
		mov	ebp, ecx
		pop	esi

loc_10003860:				; CODE XREF: sub_100037D6+99j
		push	0
		push	1
		mov	ecx, ebx
		call	sub_10002311
		add	ebx, esi
		cmp	ebx, ebp
		jnz	short loc_10003860
		mov	esi, [esp+1Ch+var_4]
		mov	ebp, [esp+1Ch+arg_0]

loc_10003879:				; CODE XREF: sub_100037D6+83j
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10003882:				; CODE XREF: sub_100037D6+7Fj
		imul	eax, ebp, 18h
		pop	ebx
		mov	[esi], edi
		add	eax, edi
		mov	[esi+8], eax
		imul	eax, [esp+18h+var_8], 18h
		add	eax, edi
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		add	esp, 0Ch
		retn	4
sub_100037D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100038A0	proc near		; CODE XREF: sub_10003648+3Ap
					; sub_10003648+5Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		xor	eax, eax
		push	0FFFFFFFFh	; int
		push	eax		; int
		push	[esp+0Ch+arg_0]	; int
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		call	sub_100023D9
		mov	eax, esi
		pop	esi
		retn	4
sub_100038A0	endp


; =============== S U B	R O U T	I N E =======================================


sub_100038C5	proc near		; CODE XREF: sub_1000444A+63p
		cmp	ecx, 0D800h
		jb	short loc_100038E0
		cmp	ecx, 0E000h
		jb	short loc_100038DD
		cmp	ecx, 10FFFFh
		jbe	short loc_100038E0

loc_100038DD:				; CODE XREF: sub_100038C5+Ej
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_100038E0:				; CODE XREF: sub_100038C5+6j
					; sub_100038C5+16j
		xor	eax, eax
		inc	eax
		retn
sub_100038C5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100038E4	proc near		; CODE XREF: sub_100034EC+71p

var_20		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	eax, [ebp+arg_0]
		push	esi
		push	eax
		push	ecx
		mov	esi, ecx
		lea	ecx, [ebp+var_20] ; void *
		push	offset asc_1001AA7C ; "\t\n\v"
		call	sub_10001C7F
		mov	edx, eax
		mov	ecx, esi
		call	sub_100039D5
		pop	ecx
		pop	ecx
		push	0
		push	1
		lea	ecx, [ebp+var_20]
		mov	esi, eax
		call	sub_10002311
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100038E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003933	proc near		; CODE XREF: sub_1000BF75+A1p

arg_0		= dword	ptr  4

		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000393D
		mov	edx, [ecx]
		jmp	short loc_1000393F
; ---------------------------------------------------------------------------

loc_1000393D:				; CODE XREF: sub_10003933+4j
		mov	edx, ecx

loc_1000393F:				; CODE XREF: sub_10003933+8j
		mov	eax, [ecx+10h]
		lea	ecx, [edx+eax*2]
		mov	eax, [esp+arg_0]
		mov	[eax], ecx
		retn	4
sub_10003933	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000394E	proc near		; CODE XREF: sub_1000E968+1D6p
					; sub_1000E968+1DFp ...
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi]
		test	edi, edi
		jz	short loc_10003985
		push	ebx
		mov	ebx, [esi+4]
		push	ebp
		xor	ebp, ebp
		jmp	short loc_1000396E
; ---------------------------------------------------------------------------

loc_10003961:				; CODE XREF: sub_1000394E+22j
		push	ebp
		push	1
		mov	ecx, edi
		call	sub_10002311
		add	edi, 18h

loc_1000396E:				; CODE XREF: sub_1000394E+11j
		cmp	edi, ebx
		jnz	short loc_10003961
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	[esi], ebp
		mov	[esi+4], ebp
		mov	[esi+8], ebp
		pop	ebp
		pop	ebx

loc_10003985:				; CODE XREF: sub_1000394E+8j
		pop	edi
		pop	esi
		retn
sub_1000394E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10003988(void *, int, size_t, void	*, int)
sub_10003988	proc near		; CODE XREF: sub_10004AAD+19p
					; sub_10005396+11p ...

arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, [ebp+arg_4]
		cmp	[ecx+10h], esi
		jnb	short loc_10003997
		mov	esi, [ecx+10h]

loc_10003997:				; CODE XREF: sub_10003988+Aj
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_100039A1
		mov	eax, [ebp+arg_C]

loc_100039A1:				; CODE XREF: sub_10003988+14j
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_100039A9
		mov	ecx, [ecx]

loc_100039A9:				; CODE XREF: sub_10003988+1Dj
		test	eax, eax
		jz	short loc_100039BE
		push	eax		; size_t
		push	[ebp+arg_8]	; void *
		push	ecx		; void *
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_100039D0

loc_100039BE:				; CODE XREF: sub_10003988+23j
		cmp	esi, [ebp+arg_C]
		jnb	short loc_100039C8
		or	eax, 0FFFFFFFFh
		jmp	short loc_100039D0
; ---------------------------------------------------------------------------

loc_100039C8:				; CODE XREF: sub_10003988+39j
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_100039D0:				; CODE XREF: sub_10003988+34j
					; sub_10003988+3Ej
		pop	esi
		pop	ebp
		retn	10h
sub_10003988	endp


; =============== S U B	R O U T	I N E =======================================


sub_100039D5	proc near		; CODE XREF: sub_100038E4+29p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
arg_4		= dword	ptr  8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		mov	eax, ecx
		push	ebx
		push	ebp
		push	esi
		mov	ebp, [eax+10h]
		mov	esi, edx
		push	edi
		mov	edi, [esp+3Ch+arg_4]
		mov	[esp+3Ch+var_28], eax
		lea	ecx, [ebp-1]
		push	ecx
		mov	[esp+40h+var_24], ecx
		mov	ecx, eax
		push	esi
		call	sub_10003B78
		push	ecx
		mov	ecx, [esp+40h+var_28]
		mov	ebx, eax
		push	esi
		call	sub_10003BE3
		mov	esi, eax
		test	ebp, ebp
		jz	short loc_10003A63
		cmp	ebx, 0FFFFFFFFh
		jz	short loc_10003A61
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10003A61
		mov	ecx, [esp+3Ch+var_28] ;	int
		sub	eax, ebx
		inc	eax
		push	eax		; int
		push	ebx		; int
		lea	eax, [esp+44h+var_20]
		push	eax		; void *
		call	sub_100035B5
		push	eax		; void *
		mov	ecx, edi
		call	sub_10003B36
		push	0
		push	1
		lea	ecx, [esp+44h+var_20]
		call	sub_10002311
		sub	esi, [esp+3Ch+var_24]
		neg	esi
		sbb	esi, esi
		xor	eax, eax
		and	esi, 2
		test	ebx, ebx
		setnz	al
		or	eax, esi
		jmp	short loc_10003A80
; ---------------------------------------------------------------------------

loc_10003A61:				; CODE XREF: sub_100039D5+47j
					; sub_100039D5+4Cj
		test	ebp, ebp

loc_10003A63:				; CODE XREF: sub_100039D5+42j
		setz	cl
		and	dword ptr [edi+10h], 0
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003A72
		mov	edi, [edi]

loc_10003A72:				; CODE XREF: sub_100039D5+99j
		xor	eax, eax
		test	cl, cl
		mov	[edi], ax
		setnz	al
		dec	eax
		and	eax, 3

loc_10003A80:				; CODE XREF: sub_100039D5+8Aj
		mov	ecx, [esp+3Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_100039D5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003A93	proc near		; CODE XREF: sub_1000437B+29p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		mov	[esp+10h+var_4], ecx
		lea	edi, [ecx+edx*2]
		mov	ebx, esi
		mov	edx, ecx
		jmp	short loc_10003AB2
; ---------------------------------------------------------------------------

loc_10003AA6:				; CODE XREF: sub_10003A93+22j
		cmp	edx, edi
		jz	short loc_10003AB7
		movzx	eax, word ptr [edx]
		or	ebx, eax
		add	edx, 2

loc_10003AB2:				; CODE XREF: sub_10003A93+11j
		test	dl, 3
		jnz	short loc_10003AA6

loc_10003AB7:				; CODE XREF: sub_10003A93+15j
		mov	ecx, edi
		and	ecx, 0FFFFFFFCh
		mov	eax, ecx
		sub	eax, edx
		add	eax, 3
		shr	eax, 2
		cmp	ecx, edx
		push	ebp
		sbb	ecx, ecx
		mov	ebp, esi
		not	ecx
		and	ecx, eax
		jbe	short loc_10003ADD

loc_10003AD3:				; CODE XREF: sub_10003A93+48j
		or	ebx, [edx]
		add	edx, 4
		inc	ebp
		cmp	ebp, ecx
		jb	short loc_10003AD3

loc_10003ADD:				; CODE XREF: sub_10003A93+3Ej
		mov	eax, edi
		sub	eax, edx
		inc	eax
		shr	eax, 1
		cmp	edi, edx
		pop	ebp
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		jz	short loc_10003AFC

loc_10003AEF:				; CODE XREF: sub_10003A93+67j
		movzx	eax, word ptr [edx]
		lea	edx, [edx+2]
		or	ebx, eax
		inc	esi
		cmp	esi, ecx
		jnz	short loc_10003AEF

loc_10003AFC:				; CODE XREF: sub_10003A93+5Aj
		and	ebx, 0FF80FF80h
		neg	ebx
		pop	edi
		sbb	ebx, ebx
		pop	esi
		lea	eax, [ebx+1]
		pop	ebx
		pop	ecx
		retn
sub_10003A93	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B0E	proc near		; CODE XREF: sub_1000426A+26p
					; sub_1000426A+CDp

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_10003B28
		cmp	dword ptr [ecx+14h], 10h
		mov	[ecx+10h], eax
		jb	short loc_10003B22
		mov	ecx, [ecx]

loc_10003B22:				; CODE XREF: sub_10003B0E+10j
		mov	byte ptr [ecx+eax], 0
		jmp	short locret_10003B33
; ---------------------------------------------------------------------------

loc_10003B28:				; CODE XREF: sub_10003B0E+7j
		sub	eax, [ecx+10h]
		push	0		; int
		push	eax		; size_t
		call	sub_10003068

locret_10003B33:			; CODE XREF: sub_10003B0E+18j
		retn	4
sub_10003B0E	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003B36(void *)
sub_10003B36	proc near		; CODE XREF: sub_100039D5+64p
					; sub_1000B3A3+80p ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		cmp	esi, [esp+4+arg_0]
		jz	short loc_10003B53
		push	0
		push	1
		call	sub_10002311
		push	[esp+4+arg_0]	; void *
		mov	ecx, esi
		call	sub_100034A3

loc_10003B53:				; CODE XREF: sub_10003B36+7j
		mov	eax, esi
		pop	esi
		retn	4
sub_10003B36	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B59	proc near		; CODE XREF: sub_10006844+107p

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		cmp	eax, [ecx+10h]
		ja	short loc_10003B6A
		push	eax
		call	sub_100023C1
		jmp	short locret_10003B75
; ---------------------------------------------------------------------------

loc_10003B6A:				; CODE XREF: sub_10003B59+7j
		sub	eax, [ecx+10h]
		push	0
		push	eax
		call	sub_100030C7

locret_10003B75:			; CODE XREF: sub_10003B59+Fj
		retn	4
sub_10003B59	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003B78	proc near		; CODE XREF: sub_100039D5+2Cp

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+14h], 8
		mov	edi, ecx
		mov	edx, [ebx+10h]
		mov	[esp+10h+arg_0], edx
		jb	short loc_10003B91
		mov	ebx, [ebx]

loc_10003B91:				; CODE XREF: sub_10003B78+15j
		mov	eax, [edi+10h]
		test	eax, eax
		jz	short loc_10003BC9
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003BA0
		mov	ecx, [edi]

loc_10003BA0:				; CODE XREF: sub_10003B78+24j
		cmp	dword ptr [edi+14h], 8
		lea	ebp, [ecx+eax*2]
		jb	short loc_10003BAD
		mov	esi, [edi]
		jmp	short loc_10003BC5
; ---------------------------------------------------------------------------

loc_10003BAD:				; CODE XREF: sub_10003B78+2Fj
		mov	esi, edi
		jmp	short loc_10003BC5
; ---------------------------------------------------------------------------

loc_10003BB1:				; CODE XREF: sub_10003B78+4Fj
		push	esi
		mov	ecx, ebx
		call	sub_10003443
		pop	ecx
		test	eax, eax
		jz	short loc_10003BD5
		mov	edx, [esp+10h+arg_0]
		add	esi, 2

loc_10003BC5:				; CODE XREF: sub_10003B78+33j
					; sub_10003B78+37j
		cmp	esi, ebp
		jb	short loc_10003BB1

loc_10003BC9:				; CODE XREF: sub_10003B78+1Ej
		or	esi, 0FFFFFFFFh

loc_10003BCC:				; CODE XREF: sub_10003B78+69j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
; ---------------------------------------------------------------------------

loc_10003BD5:				; CODE XREF: sub_10003B78+44j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003BDD
		mov	edi, [edi]

loc_10003BDD:				; CODE XREF: sub_10003B78+61j
		sub	esi, edi
		sar	esi, 1
		jmp	short loc_10003BCC
sub_10003B78	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003BE3	proc near		; CODE XREF: sub_100039D5+39p

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, [esp+4+arg_0]
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+14h], 8
		mov	edi, ecx
		mov	ebp, [ebx+10h]
		jb	short loc_10003BF8
		mov	ebx, [ebx]

loc_10003BF8:				; CODE XREF: sub_10003BE3+11j
		mov	eax, [edi+10h]
		test	eax, eax
		jz	short loc_10003C4D
		cmp	eax, 0FFFFFFFFh
		jbe	short loc_10003C09
		or	ecx, 0FFFFFFFFh
		jmp	short loc_10003C0C
; ---------------------------------------------------------------------------

loc_10003C09:				; CODE XREF: sub_10003BE3+1Fj
		lea	ecx, [eax-1]

loc_10003C0C:				; CODE XREF: sub_10003BE3+24j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C16
		mov	eax, [edi]
		jmp	short loc_10003C18
; ---------------------------------------------------------------------------

loc_10003C16:				; CODE XREF: sub_10003BE3+2Dj
		mov	eax, edi

loc_10003C18:				; CODE XREF: sub_10003BE3+31j
		lea	esi, [eax+ecx*2]
		jmp	short loc_10003C30
; ---------------------------------------------------------------------------

loc_10003C1D:				; CODE XREF: sub_10003BE3+5Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C27
		mov	eax, [edi]
		jmp	short loc_10003C29
; ---------------------------------------------------------------------------

loc_10003C27:				; CODE XREF: sub_10003BE3+3Ej
		mov	eax, edi

loc_10003C29:				; CODE XREF: sub_10003BE3+42j
		cmp	esi, eax
		jz	short loc_10003C4D
		sub	esi, 2

loc_10003C30:				; CODE XREF: sub_10003BE3+38j
		push	esi
		mov	edx, ebp
		mov	ecx, ebx
		call	sub_10003443
		pop	ecx
		test	eax, eax
		jnz	short loc_10003C1D
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10003C47
		mov	edi, [edi]

loc_10003C47:				; CODE XREF: sub_10003BE3+60j
		sub	esi, edi
		sar	esi, 1
		jmp	short loc_10003C50
; ---------------------------------------------------------------------------

loc_10003C4D:				; CODE XREF: sub_10003BE3+1Aj
					; sub_10003BE3+48j
		or	esi, 0FFFFFFFFh

loc_10003C50:				; CODE XREF: sub_10003BE3+68j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10003BE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10003C59	proc near		; CODE XREF: sub_10003F72+32p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_0]
		push	esi
		mov	esi, ecx
		push	edi
		cmp	[esi+10h], ebx
		jb	loc_10003F08
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [esp+10h+arg_C]
		mov	eax, [edi+10h]
		cmp	eax, ecx
		jb	loc_10003F08
		mov	edx, [esp+10h+arg_4]
		push	ebp
		mov	ebp, [esi+10h]
		sub	ebp, ebx
		mov	[esp+14h+arg_0], ebp
		cmp	ebp, edx
		jnb	short loc_10003C97
		mov	edx, ebp
		mov	[esp+14h+arg_4], edx

loc_10003C97:				; CODE XREF: sub_10003C59+36j
		mov	ebp, [esp+14h+arg_10]
		sub	eax, ecx
		cmp	eax, ebp
		jnb	short loc_10003CA3
		mov	ebp, eax

loc_10003CA3:				; CODE XREF: sub_10003C59+46j
		mov	eax, [esi+10h]
		sub	eax, edx
		mov	[esp+14h+arg_10], eax
		or	eax, 0FFFFFFFFh
		sub	eax, ebp
		cmp	eax, [esp+14h+arg_10]
		ja	short loc_10003CC2
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003CC2:				; CODE XREF: sub_10003C59+5Cj
		mov	eax, [esp+14h+arg_10]
		sub	[esp+14h+arg_0], edx
		add	eax, ebp
		mov	[esp+14h+var_4], eax
		cmp	[esi+10h], eax
		jnb	short loc_10003CE7
		push	0
		push	eax
		mov	ecx, esi
		call	sub_1000245E
		mov	ecx, [esp+14h+arg_C]
		mov	edx, [esp+14h+arg_4]

loc_10003CE7:				; CODE XREF: sub_10003C59+7Aj
		push	8
		cmp	esi, edi
		pop	edi
		jz	short loc_10003D4F
		cmp	[esi+14h], edi
		jb	short loc_10003CFB
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_10003CFF
; ---------------------------------------------------------------------------

loc_10003CFB:				; CODE XREF: sub_10003C59+98j
		mov	[esp+14h+arg_4], esi

loc_10003CFF:				; CODE XREF: sub_10003C59+A0j
		cmp	[esi+14h], edi
		jb	short loc_10003D08
		mov	ecx, [esi]
		jmp	short loc_10003D0A
; ---------------------------------------------------------------------------

loc_10003D08:				; CODE XREF: sub_10003C59+A9j
		mov	ecx, esi

loc_10003D0A:				; CODE XREF: sub_10003C59+ADj
		push	[esp+14h+arg_0]	; int
		lea	eax, [ebx+edx]
		mov	edx, [esp+18h+arg_4]
		lea	edx, [edx+eax*2] ; void	*
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		mov	ecx, [esp+14h+arg_8]
		cmp	[ecx+14h], edi
		jb	short loc_10003D2F
		mov	ecx, [ecx]

loc_10003D2F:				; CODE XREF: sub_10003C59+D2j
		cmp	[esi+14h], edi
		jb	short loc_10003D38
		mov	edi, [esi]
		jmp	short loc_10003D3A
; ---------------------------------------------------------------------------

loc_10003D38:				; CODE XREF: sub_10003C59+D9j
		mov	edi, esi

loc_10003D3A:				; CODE XREF: sub_10003C59+DDj
		mov	eax, [esp+14h+arg_C]
		push	ebp		; int
		lea	edx, [ecx+eax*2] ; void	*
		lea	ecx, [edi+ebx*2] ; void	*
		call	sub_10001B13
		jmp	loc_10003EF2
; ---------------------------------------------------------------------------

loc_10003D4F:				; CODE XREF: sub_10003C59+93j
		cmp	ebp, edx
		ja	short loc_10003DA1
		cmp	[esi+14h], edi
		jb	short loc_10003D5C
		mov	edx, [esi]
		jmp	short loc_10003D5E
; ---------------------------------------------------------------------------

loc_10003D5C:				; CODE XREF: sub_10003C59+FDj
		mov	edx, esi

loc_10003D5E:				; CODE XREF: sub_10003C59+101j
		cmp	[esi+14h], edi
		jb	short loc_10003D67
		mov	eax, [esi]
		jmp	short loc_10003D69
; ---------------------------------------------------------------------------

loc_10003D67:				; CODE XREF: sub_10003C59+108j
		mov	eax, esi

loc_10003D69:				; CODE XREF: sub_10003C59+10Cj
		lea	edx, [edx+ecx*2] ; void	*
		push	ebp		; int
		lea	ecx, [eax+ebx*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003D7F
		mov	edx, [esi]
		jmp	short loc_10003D81
; ---------------------------------------------------------------------------

loc_10003D7F:				; CODE XREF: sub_10003C59+120j
		mov	edx, esi

loc_10003D81:				; CODE XREF: sub_10003C59+124j
		cmp	[esi+14h], edi
		jb	short loc_10003D8A
		mov	edi, [esi]
		jmp	short loc_10003D8C
; ---------------------------------------------------------------------------

loc_10003D8A:				; CODE XREF: sub_10003C59+12Bj
		mov	edi, esi

loc_10003D8C:				; CODE XREF: sub_10003C59+12Fj
		mov	eax, [esp+14h+arg_4]
		push	[esp+14h+arg_0]
		add	eax, ebx
		lea	edx, [edx+eax*2]
		lea	eax, [ebx+ebp]
		jmp	loc_10003EEA
; ---------------------------------------------------------------------------

loc_10003DA1:				; CODE XREF: sub_10003C59+F8j
		cmp	ecx, ebx
		ja	short loc_10003E01
		cmp	[esi+14h], edi
		jb	short loc_10003DB2
		mov	eax, [esi]
		mov	[esp+14h+arg_4], eax
		jmp	short loc_10003DB6
; ---------------------------------------------------------------------------

loc_10003DB2:				; CODE XREF: sub_10003C59+14Fj
		mov	[esp+14h+arg_4], esi

loc_10003DB6:				; CODE XREF: sub_10003C59+157j
		cmp	[esi+14h], edi
		jb	short loc_10003DBF
		mov	ecx, [esi]
		jmp	short loc_10003DC1
; ---------------------------------------------------------------------------

loc_10003DBF:				; CODE XREF: sub_10003C59+160j
		mov	ecx, esi

loc_10003DC1:				; CODE XREF: sub_10003C59+164j
		push	[esp+14h+arg_0]	; int
		lea	eax, [ebx+edx]
		mov	edx, [esp+18h+arg_4]
		lea	edx, [edx+eax*2] ; void	*
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003DE4
		mov	edx, [esi]
		jmp	short loc_10003DE6
; ---------------------------------------------------------------------------

loc_10003DE4:				; CODE XREF: sub_10003C59+185j
		mov	edx, esi

loc_10003DE6:				; CODE XREF: sub_10003C59+189j
		cmp	[esi+14h], edi
		jb	short loc_10003DEF
		mov	ecx, [esi]
		jmp	short loc_10003DF1
; ---------------------------------------------------------------------------

loc_10003DEF:				; CODE XREF: sub_10003C59+190j
		mov	ecx, esi

loc_10003DF1:				; CODE XREF: sub_10003C59+194j
		mov	eax, [esp+14h+arg_C]
		lea	ecx, [ecx+ebx*2]
		push	ebp
		lea	edx, [edx+eax*2]
		jmp	loc_10003EED
; ---------------------------------------------------------------------------

loc_10003E01:				; CODE XREF: sub_10003C59+14Aj
		lea	eax, [ebx+edx]
		mov	[esp+14h+arg_10], eax
		cmp	eax, ecx
		ja	short loc_10003E65
		cmp	[esi+14h], edi
		jb	short loc_10003E15
		mov	eax, [esi]
		jmp	short loc_10003E17
; ---------------------------------------------------------------------------

loc_10003E15:				; CODE XREF: sub_10003C59+1B6j
		mov	eax, esi

loc_10003E17:				; CODE XREF: sub_10003C59+1BAj
		cmp	[esi+14h], edi
		jb	short loc_10003E20
		mov	ecx, [esi]
		jmp	short loc_10003E22
; ---------------------------------------------------------------------------

loc_10003E20:				; CODE XREF: sub_10003C59+1C1j
		mov	ecx, esi

loc_10003E22:				; CODE XREF: sub_10003C59+1C5j
		mov	edx, [esp+14h+arg_10]
		push	[esp+14h+arg_0]	; int
		lea	edx, [eax+edx*2] ; void	*
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003E42
		mov	edx, [esi]
		jmp	short loc_10003E44
; ---------------------------------------------------------------------------

loc_10003E42:				; CODE XREF: sub_10003C59+1E3j
		mov	edx, esi

loc_10003E44:				; CODE XREF: sub_10003C59+1E7j
		cmp	[esi+14h], edi
		jb	short loc_10003E4D
		mov	edi, [esi]
		jmp	short loc_10003E4F
; ---------------------------------------------------------------------------

loc_10003E4D:				; CODE XREF: sub_10003C59+1EEj
		mov	edi, esi

loc_10003E4F:				; CODE XREF: sub_10003C59+1F2j
		mov	eax, [esp+14h+arg_C]
		lea	ecx, [edi+ebx*2]
		sub	eax, [esp+14h+arg_4]
		add	eax, ebp
		push	ebp
		lea	edx, [edx+eax*2]
		jmp	loc_10003EED
; ---------------------------------------------------------------------------

loc_10003E65:				; CODE XREF: sub_10003C59+1B1j
		cmp	[esi+14h], edi
		jb	short loc_10003E72
		mov	eax, [esi]
		mov	[esp+14h+arg_8], eax
		jmp	short loc_10003E76
; ---------------------------------------------------------------------------

loc_10003E72:				; CODE XREF: sub_10003C59+20Fj
		mov	[esp+14h+arg_8], esi

loc_10003E76:				; CODE XREF: sub_10003C59+217j
		cmp	[esi+14h], edi
		jb	short loc_10003E7F
		mov	eax, [esi]
		jmp	short loc_10003E81
; ---------------------------------------------------------------------------

loc_10003E7F:				; CODE XREF: sub_10003C59+220j
		mov	eax, esi

loc_10003E81:				; CODE XREF: sub_10003C59+224j
		push	edx		; int
		mov	edx, [esp+18h+arg_8]
		lea	edx, [edx+ecx*2] ; void	*
		lea	ecx, [eax+ebx*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003E9B
		mov	eax, [esi]
		jmp	short loc_10003E9D
; ---------------------------------------------------------------------------

loc_10003E9B:				; CODE XREF: sub_10003C59+23Cj
		mov	eax, esi

loc_10003E9D:				; CODE XREF: sub_10003C59+240j
		cmp	[esi+14h], edi
		jb	short loc_10003EA6
		mov	ecx, [esi]
		jmp	short loc_10003EA8
; ---------------------------------------------------------------------------

loc_10003EA6:				; CODE XREF: sub_10003C59+247j
		mov	ecx, esi

loc_10003EA8:				; CODE XREF: sub_10003C59+24Bj
		mov	edx, [esp+14h+arg_10]
		push	[esp+14h+arg_0]	; int
		lea	edx, [eax+edx*2] ; void	*
		lea	eax, [ebx+ebp]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	[esi+14h], edi
		jb	short loc_10003EC8
		mov	edx, [esi]
		jmp	short loc_10003ECA
; ---------------------------------------------------------------------------

loc_10003EC8:				; CODE XREF: sub_10003C59+269j
		mov	edx, esi

loc_10003ECA:				; CODE XREF: sub_10003C59+26Dj
		cmp	[esi+14h], edi
		jb	short loc_10003ED3
		mov	edi, [esi]
		jmp	short loc_10003ED5
; ---------------------------------------------------------------------------

loc_10003ED3:				; CODE XREF: sub_10003C59+274j
		mov	edi, esi

loc_10003ED5:				; CODE XREF: sub_10003C59+278j
		mov	ecx, [esp+14h+arg_4]
		mov	eax, ebp
		sub	eax, ecx
		push	eax		; int
		mov	eax, [esp+18h+arg_C]
		add	eax, ebp
		lea	edx, [edx+eax*2] ; void	*
		lea	eax, [ebx+ecx]

loc_10003EEA:				; CODE XREF: sub_10003C59+143j
		lea	ecx, [edi+eax*2] ; void	*

loc_10003EED:				; CODE XREF: sub_10003C59+1A3j
					; sub_10003C59+207j
		call	sub_10001B2D

loc_10003EF2:				; CODE XREF: sub_10003C59+F1j
		pop	ecx
		push	[esp+14h+var_4]
		mov	ecx, esi
		call	sub_100023C1
		pop	ebp
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		pop	ecx
		retn	14h
; ---------------------------------------------------------------------------

loc_10003F08:				; CODE XREF: sub_10003C59+Dj
					; sub_10003C59+20j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_10003C59	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10003F14	proc near		; CODE XREF: sub_10008B8B+A9p
					; sub_1000BA03+3Dp ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		mov	eax, [ecx+10h]
		mov	edx, [ebp+arg_0]
		cmp	eax, edx
		jnb	short loc_10003F2C
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003F2C:				; CODE XREF: sub_10003F14+Bj
		push	esi
		mov	esi, [ebp+arg_4]
		sub	eax, edx
		cmp	eax, esi
		jnb	short loc_10003F38
		mov	esi, eax

loc_10003F38:				; CODE XREF: sub_10003F14+20j
		mov	eax, esi
		cmp	esi, [ebp+arg_C]
		jb	short loc_10003F42
		mov	eax, [ebp+arg_C]

loc_10003F42:				; CODE XREF: sub_10003F14+29j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10003F4A
		mov	ecx, [ecx]

loc_10003F4A:				; CODE XREF: sub_10003F14+32j
		lea	ecx, [ecx+edx*2]
		mov	edx, [ebp+arg_8]
		push	eax
		call	sub_10003417
		pop	ecx
		test	eax, eax
		jnz	short loc_10003F6D
		cmp	esi, [ebp+arg_C]
		jnb	short loc_10003F65
		or	eax, 0FFFFFFFFh
		jmp	short loc_10003F6D
; ---------------------------------------------------------------------------

loc_10003F65:				; CODE XREF: sub_10003F14+4Aj
		xor	eax, eax
		cmp	esi, [ebp+arg_C]
		setnz	al

loc_10003F6D:				; CODE XREF: sub_10003F14+45j
					; sub_10003F14+4Fj
		pop	esi
		pop	ebp
		retn	10h
sub_10003F14	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10003F72(int, int, void *, int)
sub_10003F72	proc near		; CODE XREF: sub_1000BA03+87p
					; sub_1000E968+154p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	esi
		push	ebx
		mov	esi, ecx
		call	sub_100024C5
		test	al, al
		jz	short loc_10003FAE
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10003F8E
		mov	eax, [esi]
		jmp	short loc_10003F90
; ---------------------------------------------------------------------------

loc_10003F8E:				; CODE XREF: sub_10003F72+16j
		mov	eax, esi

loc_10003F90:				; CODE XREF: sub_10003F72+1Aj
		push	[esp+8+arg_C]
		sub	ebx, eax
		mov	ecx, esi
		sar	ebx, 1
		push	ebx
		push	esi
		push	[esp+14h+arg_4]
		push	[esp+18h+arg_0]
		call	sub_10003C59
		jmp	loc_100040D3
; ---------------------------------------------------------------------------

loc_10003FAE:				; CODE XREF: sub_10003F72+10j
		mov	ecx, [esi+10h]
		mov	edx, [esp+8+arg_0]
		cmp	ecx, edx
		jnb	short loc_10003FC4
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)

loc_10003FC4:				; CODE XREF: sub_10003F72+45j
		push	ebp
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+10h+arg_4]
		sub	ebp, edx
		cmp	ebp, edi
		jnb	short loc_10003FD4
		mov	edi, ebp

loc_10003FD4:				; CODE XREF: sub_10003F72+5Ej
		or	eax, 0FFFFFFFFh
		sub	ecx, edi
		sub	eax, [esp+10h+arg_C]
		cmp	eax, ecx
		ja	short loc_10003FEC
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10003FEC:				; CODE XREF: sub_10003F72+6Dj
		mov	ecx, [esp+10h+arg_C]
		sub	ebp, edi
		cmp	ecx, edi
		jnb	short loc_1000403C
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004004
		mov	eax, [esi]
		mov	[esp+10h+arg_4], eax
		jmp	short loc_10004008
; ---------------------------------------------------------------------------

loc_10004004:				; CODE XREF: sub_10003F72+88j
		mov	[esp+10h+arg_4], esi

loc_10004008:				; CODE XREF: sub_10003F72+90j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004016
		mov	eax, [esi]
		mov	[esp+10h+arg_8], eax
		jmp	short loc_1000401A
; ---------------------------------------------------------------------------

loc_10004016:				; CODE XREF: sub_10003F72+9Aj
		mov	[esp+10h+arg_8], esi

loc_1000401A:				; CODE XREF: sub_10003F72+A2j
		lea	eax, [edx+edi]
		mov	edx, [esp+10h+arg_4]
		push	ebp		; int
		lea	edx, [edx+eax*2] ; void	*
		mov	eax, [esp+14h+arg_0]
		add	eax, ecx
		mov	ecx, [esp+14h+arg_8]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		mov	ecx, [esp+10h+arg_C]

loc_1000403C:				; CODE XREF: sub_10003F72+82j
		test	ecx, ecx
		jnz	short loc_10004048
		test	edi, edi
		jz	loc_100040CF

loc_10004048:				; CODE XREF: sub_10003F72+CCj
		mov	eax, [esi+10h]
		sub	eax, edi
		add	eax, ecx
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_8], eax
		call	sub_1000245E
		test	al, al
		jz	short loc_100040CF
		mov	ecx, [esp+10h+arg_C]
		cmp	edi, ecx
		jnb	short loc_100040A8
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004073
		mov	edx, [esi]
		jmp	short loc_10004075
; ---------------------------------------------------------------------------

loc_10004073:				; CODE XREF: sub_10003F72+FBj
		mov	edx, esi

loc_10004075:				; CODE XREF: sub_10003F72+FFj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10004083
		mov	eax, [esi]
		mov	[esp+10h+arg_4], eax
		jmp	short loc_10004087
; ---------------------------------------------------------------------------

loc_10004083:				; CODE XREF: sub_10003F72+107j
		mov	[esp+10h+arg_4], esi

loc_10004087:				; CODE XREF: sub_10003F72+10Fj
		push	ebp		; int
		mov	ebp, [esp+14h+arg_0]
		lea	eax, [edi+ebp]
		lea	edx, [edx+eax*2] ; void	*
		lea	eax, [ecx+ebp]
		mov	ecx, [esp+14h+arg_4]
		lea	ecx, [ecx+eax*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		mov	ecx, [esp+10h+arg_C]
		jmp	short loc_100040AC
; ---------------------------------------------------------------------------

loc_100040A8:				; CODE XREF: sub_10003F72+F5j
		mov	ebp, [esp+10h+arg_0]

loc_100040AC:				; CODE XREF: sub_10003F72+134j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100040B6
		mov	eax, [esi]
		jmp	short loc_100040B8
; ---------------------------------------------------------------------------

loc_100040B6:				; CODE XREF: sub_10003F72+13Ej
		mov	eax, esi

loc_100040B8:				; CODE XREF: sub_10003F72+142j
		push	ecx		; int
		lea	ecx, [eax+ebp*2] ; void	*
		mov	edx, ebx	; void *
		call	sub_10001B13
		pop	ecx
		push	[esp+10h+arg_8]
		mov	ecx, esi
		call	sub_100023C1

loc_100040CF:				; CODE XREF: sub_10003F72+D0j
					; sub_10003F72+EDj
		pop	edi
		mov	eax, esi
		pop	ebp

loc_100040D3:				; CODE XREF: sub_10003F72+37j
		pop	esi
		pop	ebx
		retn	10h
sub_10003F72	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100040D8@<eax>(wchar_t *DstBuf@<ecx>, size_t MaxCount@<edx>, wchar_t *Format, va_list ArgList)
sub_100040D8	proc near		; CODE XREF: sub_10004143+CBp

var_4		= dword	ptr -4
Format		= dword	ptr  8
ArgList		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		push	esi
		push	edi
		push	[ebp+ArgList]	; ArgList
		mov	esi, edx
		mov	edi, ecx
		push	[ebp+Format]	; Format
		push	esi		; MaxCount
		push	edi		; DstBuf
		call	ds:_vswprintf_p
		add	esp, 10h
		test	eax, eax
		jns	short loc_10004113
		test	esi, esi
		jz	short loc_10004105
		xor	eax, eax
		mov	[edi], ax

loc_10004105:				; CODE XREF: sub_100040D8+26j
		push	[ebp+ArgList]	; ArgList
		push	[ebp+Format]	; Format
		call	ds:_vscwprintf_p
		pop	ecx
		pop	ecx

loc_10004113:				; CODE XREF: sub_100040D8+22j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100040D8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004119	proc near		; CODE XREF: sub_100171B6+7Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= byte ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_0]
		xor	eax, eax
		mov	ecx, esi
		and	dword ptr [esi+10h], 0
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		lea	eax, [esp+4+arg_8]
		mov	edx, [esp+4+arg_4]
		push	eax
		call	sub_10004143
		pop	ecx
		mov	eax, esi
		pop	esi
		retn
sub_10004119	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004143	proc near		; CODE XREF: sub_10004119+20p

var_818		= dword	ptr -818h
var_814		= dword	ptr -814h
var_810		= dword	ptr -810h
var_80C		= dword	ptr -80Ch
DstBuf		= word ptr -808h
var_4		= dword	ptr -4
ArgList		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 81Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+81Ch+var_4], eax
		mov	eax, [ebp+ArgList]
		and	[esp+81Ch+var_818], 0
		push	ebx
		push	esi
		push	edi
		push	eax		; ArgList
		mov	edi, edx
		mov	[esp+82Ch+var_814], eax
		push	edi		; Format
		lea	eax, [esp+830h+DstBuf]
		mov	[esp+830h+var_80C], edi
		mov	ebx, ecx
		push	400h		; MaxCount
		push	eax		; DstBuf
		mov	[esp+838h+var_810], ebx
		call	ds:_vswprintf_p
		mov	esi, eax
		add	esp, 10h
		test	esi, esi
		jns	short loc_100041B1
		push	[esp+828h+var_814] ; ArgList
		xor	eax, eax
		push	edi		; Format
		mov	[esp+830h+DstBuf], ax
		call	ds:_vscwprintf_p
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		js	loc_10004255

loc_100041B1:				; CODE XREF: sub_10004143+4Ej
		cmp	esi, 400h
		jge	short loc_100041CB
		push	esi		; int
		lea	eax, [esp+82Ch+DstBuf]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10003388
		jmp	loc_10004255
; ---------------------------------------------------------------------------

loc_100041CB:				; CODE XREF: sub_10004143+74j
					; sub_10004143+ECj
		inc	esi
		mov	[esp+828h+var_818], esi
		cmp	esi, 2000000h
		jg	short loc_10004255
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_10004205
		cmp	esi, 7FFFFFFFh
		ja	short loc_10004233
		push	esi
		call	sub_10002657
		mov	ebx, eax
		test	esi, esi
		jz	short loc_10004205
		xor	eax, eax
		mov	ecx, esi
		shr	ecx, 1
		mov	edi, ebx
		rep stosd
		adc	ecx, ecx
		rep stosw
		mov	edi, [esp+828h+var_80C]

loc_10004205:				; CODE XREF: sub_10004143+99j
					; sub_10004143+ADj
		push	[esp+828h+var_814] ; ArgList
		mov	edx, esi	; MaxCount
		mov	ecx, ebx	; DstBuf
		push	edi		; Format
		call	sub_100040D8
		mov	esi, eax
		pop	ecx
		pop	ecx
		test	esi, esi
		js	short loc_10004221
		cmp	esi, [esp+828h+var_818]
		jl	short loc_1000423E

loc_10004221:				; CODE XREF: sub_10004143+D6j
		test	ebx, ebx
		jz	short loc_1000422D
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000422D:				; CODE XREF: sub_10004143+E0j
		test	esi, esi
		jns	short loc_100041CB
		jmp	short loc_10004255
; ---------------------------------------------------------------------------

loc_10004233:				; CODE XREF: sub_10004143+A1j
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000423E:				; CODE XREF: sub_10004143+DCj
		mov	ecx, [esp+828h+var_810]
		push	esi		; int
		push	ebx		; void *
		call	sub_10003388
		test	ebx, ebx
		jz	short loc_10004255
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10004255:				; CODE XREF: sub_10004143+68j
					; sub_10004143+83j ...
		mov	ecx, [esp+828h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10004143	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000426A	proc near		; CODE XREF: sub_1000444A+72p
					; sub_1000444A+86p
		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, edx
		mov	ecx, esi
		cmp	ebx, 7Fh
		ja	short loc_10004285
		push	ebx
		call	sub_10002F62
		xor	eax, eax
		inc	eax
		jmp	loc_10004342
; ---------------------------------------------------------------------------

loc_10004285:				; CODE XREF: sub_1000426A+Bj
		push	ebp
		push	edi
		mov	edi, [esi+10h]
		mov	ebp, edi
		lea	eax, [edi+4]
		push	eax
		call	sub_10003B0E
		cmp	ebx, 7FFh
		ja	short loc_100042B2
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042A7
		mov	ecx, [esi]
		jmp	short loc_100042A9
; ---------------------------------------------------------------------------

loc_100042A7:				; CODE XREF: sub_1000426A+37j
		mov	ecx, esi

loc_100042A9:				; CODE XREF: sub_1000426A+3Bj
		mov	eax, ebx
		shr	eax, 6
		or	al, 0C0h
		jmp	short loc_1000431A
; ---------------------------------------------------------------------------

loc_100042B2:				; CODE XREF: sub_1000426A+31j
		cmp	ebx, 0FFFFh
		ja	short loc_100042D3
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042C4
		mov	ecx, [esi]
		jmp	short loc_100042C6
; ---------------------------------------------------------------------------

loc_100042C4:				; CODE XREF: sub_1000426A+54j
		mov	ecx, esi

loc_100042C6:				; CODE XREF: sub_1000426A+58j
		mov	eax, ebx
		shr	eax, 0Ch
		or	al, 0E0h
		mov	[ecx+edi], al
		inc	edi
		jmp	short loc_10004305
; ---------------------------------------------------------------------------

loc_100042D3:				; CODE XREF: sub_1000426A+4Ej
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042DD
		mov	ecx, [esi]
		jmp	short loc_100042DF
; ---------------------------------------------------------------------------

loc_100042DD:				; CODE XREF: sub_1000426A+6Dj
		mov	ecx, esi

loc_100042DF:				; CODE XREF: sub_1000426A+71j
		mov	eax, ebx
		shr	eax, 12h
		or	al, 0F0h
		mov	[ecx+edi], al
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_100042F3
		mov	ecx, [esi]
		jmp	short loc_100042F5
; ---------------------------------------------------------------------------

loc_100042F3:				; CODE XREF: sub_1000426A+83j
		mov	ecx, esi

loc_100042F5:				; CODE XREF: sub_1000426A+87j
		mov	eax, ebx
		shr	eax, 0Ch
		and	al, 3Fh
		or	al, 80h
		mov	[ecx+edi+1], al
		add	edi, 2

loc_10004305:				; CODE XREF: sub_1000426A+67j
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_1000430F
		mov	ecx, [esi]
		jmp	short loc_10004311
; ---------------------------------------------------------------------------

loc_1000430F:				; CODE XREF: sub_1000426A+9Fj
		mov	ecx, esi

loc_10004311:				; CODE XREF: sub_1000426A+A3j
		mov	eax, ebx
		shr	eax, 6
		and	al, 3Fh
		or	al, 80h

loc_1000431A:				; CODE XREF: sub_1000426A+46j
		mov	[ecx+edi], al
		inc	edi
		cmp	dword ptr [esi+14h], 10h
		jb	short loc_10004328
		mov	eax, [esi]
		jmp	short loc_1000432A
; ---------------------------------------------------------------------------

loc_10004328:				; CODE XREF: sub_1000426A+B8j
		mov	eax, esi

loc_1000432A:				; CODE XREF: sub_1000426A+BCj
		and	bl, 3Fh
		mov	ecx, esi
		or	bl, 80h
		mov	[eax+edi], bl
		inc	edi
		push	edi
		call	sub_10003B0E
		sub	edi, ebp
		mov	eax, edi
		pop	edi
		pop	ebp

loc_10004342:				; CODE XREF: sub_1000426A+16j
		pop	esi
		pop	ebx
		retn
sub_1000426A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004345	proc near		; CODE XREF: sub_1000437B+76p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		mov	ecx, [esp+4+arg_0]
		and	dword ptr [ecx+10h], 0
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000435A
		mov	eax, [ecx]
		jmp	short loc_1000435C
; ---------------------------------------------------------------------------

loc_1000435A:				; CODE XREF: sub_10004345+Fj
		mov	eax, ecx

loc_1000435C:				; CODE XREF: sub_10004345+13j
		mov	byte ptr [eax],	0
		test	edx, edx
		jz	short loc_10004379
		mov	eax, 80h
		cmp	[esi], ax
		jnb	short loc_10004370
		push	edx
		jmp	short loc_10004374
; ---------------------------------------------------------------------------

loc_10004370:				; CODE XREF: sub_10004345+26j
		imul	eax, edx, 3
		push	eax

loc_10004374:				; CODE XREF: sub_10004345+29j
		call	sub_100031FA

loc_10004379:				; CODE XREF: sub_10004345+1Cj
		pop	esi
		retn
sub_10004345	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000437B	proc near		; CODE XREF: sub_10001C05+21p
					; sub_100029FE+2Bp ...

var_20		= byte ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		push	edi
		mov	edi, ecx
		mov	ebx, [esi+14h]
		mov	ebp, [esi+10h]
		cmp	ebx, 8
		jb	short loc_100043A0
		mov	ecx, [esi]
		jmp	short loc_100043A2
; ---------------------------------------------------------------------------

loc_100043A0:				; CODE XREF: sub_1000437B+1Fj
		mov	ecx, esi

loc_100043A2:				; CODE XREF: sub_1000437B+23j
		mov	edx, ebp
		call	sub_10003A93
		test	al, al
		jz	short loc_100043CD
		cmp	ebx, 8
		jb	short loc_100043B6
		mov	eax, [esi]
		jmp	short loc_100043B8
; ---------------------------------------------------------------------------

loc_100043B6:				; CODE XREF: sub_1000437B+35j
		mov	eax, esi

loc_100043B8:				; CODE XREF: sub_1000437B+39j
		cmp	ebx, 8
		jb	short loc_100043BF
		mov	esi, [esi]

loc_100043BF:				; CODE XREF: sub_1000437B+40j
		lea	ecx, [eax+ebp*2]
		push	ecx
		push	esi
		mov	ecx, edi
		call	sub_100044EC
		jmp	short loc_10004435
; ---------------------------------------------------------------------------

loc_100043CD:				; CODE XREF: sub_1000437B+30j
		and	[esp+34h+var_10], 0
		mov	[esp+34h+var_C], 0Fh
		mov	[esp+34h+var_20], 0
		cmp	ebx, 8
		jb	short loc_100043E8
		mov	ecx, [esi]
		jmp	short loc_100043EA
; ---------------------------------------------------------------------------

loc_100043E8:				; CODE XREF: sub_1000437B+67j
		mov	ecx, esi

loc_100043EA:				; CODE XREF: sub_1000437B+6Bj
		lea	eax, [esp+34h+var_20]
		mov	edx, ebp
		push	eax
		call	sub_10004345
		cmp	dword ptr [esi+14h], 8
		mov	edx, [esi+10h]
		pop	ecx
		jb	short loc_10004402
		mov	esi, [esi]

loc_10004402:				; CODE XREF: sub_1000437B+83j
		lea	eax, [esp+34h+var_20]
		mov	ecx, esi
		push	eax
		call	sub_1000444A
		pop	ecx
		xor	ebx, ebx
		mov	dword ptr [edi+14h], 0Fh
		lea	eax, [esp+34h+var_20]
		mov	[edi+10h], ebx
		push	eax		; void *
		mov	ecx, edi
		mov	[edi], bl
		call	sub_100022CA
		push	ebx		; size_t
		push	1		; char
		lea	ecx, [esp+3Ch+var_20]
		call	sub_1000189A

loc_10004435:				; CODE XREF: sub_1000437B+50j
		mov	ecx, [esp+34h+var_8]
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn
sub_1000437B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000444A	proc near		; CODE XREF: sub_1000437B+8Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebp
		xor	eax, eax
		mov	ebp, edx
		push	esi
		inc	eax
		mov	edx, ecx
		xor	esi, esi
		mov	[esp+10h+var_4], edx
		mov	[esp+10h+var_8], eax
		test	ebp, ebp
		jle	loc_100044E7
		push	ebx
		push	edi
		mov	edi, eax

loc_1000446B:				; CODE XREF: sub_1000444A+99j
		movzx	ecx, word ptr [edx+esi*2]
		mov	ebx, ecx
		mov	eax, ebx
		and	eax, 0FFFFF800h
		cmp	eax, 0D800h
		jnz	short loc_100044AB
		test	ecx, 400h
		jnz	short loc_100044C7
		cmp	edi, ebp
		jge	short loc_100044C7
		movzx	ecx, word ptr [edx+esi*2+2]
		mov	eax, ecx
		and	eax, 0FFFFFC00h
		cmp	eax, 0DC00h
		jnz	short loc_100044C7
		shl	ebx, 0Ah
		add	ebx, 0FCA02400h
		add	ebx, ecx
		inc	esi
		inc	edi

loc_100044AB:				; CODE XREF: sub_1000444A+33j
		mov	ecx, ebx
		call	sub_100038C5
		test	al, al
		jz	short loc_100044C7
		mov	edx, [esp+18h+arg_0]
		mov	ecx, ebx
		call	sub_1000426A
		mov	eax, [esp+18h+var_8]
		jmp	short loc_100044DB
; ---------------------------------------------------------------------------

loc_100044C7:				; CODE XREF: sub_1000444A+3Bj
					; sub_1000444A+3Fj ...
		mov	edx, [esp+18h+arg_0]
		mov	ecx, 0FFFDh
		call	sub_1000426A
		xor	al, al
		mov	[esp+18h+var_8], eax

loc_100044DB:				; CODE XREF: sub_1000444A+7Bj
		mov	edx, [esp+18h+var_4]
		inc	esi
		inc	edi
		cmp	esi, ebp
		jl	short loc_1000446B
		pop	edi
		pop	ebx

loc_100044E7:				; CODE XREF: sub_1000444A+17j
		pop	esi
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_1000444A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100044EC	proc near		; CODE XREF: sub_1000437B+4Bp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_0]
		xor	eax, eax
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+arg_4]
		push	edi
		mov	edi, ecx
		sub	esi, ebx
		mov	[edi+10h], eax
		mov	dword ptr [edi+14h], 0Fh
		mov	[edi], al
		mov	eax, esi
		sar	eax, 1
		push	eax
		call	sub_100031FA
		lea	eax, [esi+1]
		shr	eax, 1
		cmp	[esp+10h+arg_4], ebx
		sbb	ebp, ebp
		not	ebp
		and	ebp, eax
		jz	short loc_1000453C
		xor	esi, esi

loc_10004527:				; CODE XREF: sub_100044EC+4Ej
		movzx	eax, byte ptr [ebx]
		mov	ecx, edi
		push	eax		; int
		push	1		; size_t
		call	sub_10003068
		inc	esi
		lea	ebx, [ebx+2]
		cmp	esi, ebp
		jnz	short loc_10004527

loc_1000453C:				; CODE XREF: sub_100044EC+37j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_100044EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004545	proc near		; CODE XREF: sub_10004592+6Ap

Arguments	= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	18h
		push	offset stru_1002DC78
		call	__SEH_prolog4
		mov	[ebp+Arguments], 1000h
		mov	[ebp+var_24], offset aBrokerevent ; "BrokerEvent"
		mov	[ebp+var_20], ecx
		xor	ecx, ecx
		mov	[ebp+var_1C], ecx
		mov	[ebp+ms_exc.registration.TryLevel], ecx
		lea	eax, [ebp+Arguments]
		push	eax		; lpArguments
		push	4		; nNumberOfArguments
		push	ecx		; dwExceptionFlags
		push	406D1388h	; dwExceptionCode
		call	ds:RaiseException
		jmp	short loc_10004585
; ---------------------------------------------------------------------------

loc_1000457E:				; DATA XREF: .rdata:stru_1002DC78o
		or	eax, 0FFFFFFFFh	; Exception filter 0 for function 10004545
		retn
; ---------------------------------------------------------------------------

loc_10004582:				; DATA XREF: .rdata:stru_1002DC78o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10004545

loc_10004585:				; CODE XREF: sub_10004545+37j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_10004545	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004592	proc near		; CODE XREF: StartAddress+20p

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		call	ds:GetCurrentThreadId
		push	ecx		; int
		push	eax		; int
		call	sub_100047C7
		mov	ecx, eax	; lpCriticalSection
		call	sub_10004818
		push	0Ch		; size_t
		mov	edi, offset aBrokerevent ; "BrokerEvent"
		push	edi		; void *
		push	edi		; void *
		call	memcmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_100045E1
		push	edi		; void *
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_100017D6
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_1C]
		call	sub_1000189A

loc_100045E1:				; CODE XREF: sub_10004592+38j
		call	ds:IsDebuggerPresent
		test	eax, eax
		jnz	short loc_100045F4
		call	sub_10002E8B
		test	al, al
		jz	short loc_10004601

loc_100045F4:				; CODE XREF: sub_10004592+57j
		call	ds:GetCurrentThreadId
		mov	ecx, eax
		call	sub_10004545

loc_10004601:				; CODE XREF: sub_10004592+60j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10004592	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004610	proc near		; CODE XREF: sub_1000617D+41p
					; sub_10006211+2Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		cmp	[edi], esi
		jz	short loc_10004641
		call	sub_10004646
		test	esi, esi
		jz	short loc_10004641
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10004641
		mov	[edi], esi
		call	sub_10002F5E
		push	eax
		push	dword ptr [esp+0Ch]
		mov	edx, edi
		mov	ecx, esi
		call	sub_10005965
		pop	ecx
		pop	ecx

loc_10004641:				; CODE XREF: sub_10004610+Aj
					; sub_10004610+13j ...
		pop	edi
		pop	esi
		retn	4
sub_10004610	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004646	proc near		; CODE XREF: sub_10004610+Cp
					; sub_100061CB+5p ...
		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	ecx, [ebx]
		test	ecx, ecx
		jz	short loc_10004697
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10004697
		push	ecx
		push	ecx
		mov	edx, ebx
		call	sub_10005A2B
		mov	edi, [ebx]
		pop	ecx
		pop	ecx
		call	sub_10005B09
		mov	esi, eax
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	ecx, edi	; hObject
		mov	byte_10031CB8, 1
		call	sub_1000591B
		push	esi		; lpCriticalSection
		mov	byte_10031CB8, 0
		call	ds:LeaveCriticalSection
		and	dword ptr [ebx], 0

loc_10004697:				; CODE XREF: sub_10004646+10j
					; sub_10004646+15j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10004646	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000469E(LPCRITICAL_SECTION lpCriticalSection)
sub_1000469E	proc near		; CODE XREF: sub_100047C7+2Fp

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, ecx
		push	7D0h		; dwSpinCount
		push	esi		; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		lea	ebx, [esi+18h]
		xor	ebp, ebp
		push	2Ch
		mov	[ebx], ebp
		mov	[ebx+4], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_100046DD

loc_100046D7:				; CODE XREF: sub_1000469E+68j
					; sub_1000469E+94j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100046DD:				; CODE XREF: sub_1000469E+37j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_100046E8
		mov	[ecx], eax

loc_100046E8:				; CODE XREF: sub_1000469E+46j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_100046F1
		mov	[ecx], eax

loc_100046F1:				; CODE XREF: sub_1000469E+4Fj
		mov	word ptr [eax+0Ch], 101h
		mov	[ebx], eax
		push	18h
		mov	[esi+20h], ebp
		mov	[esi+24h], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100046D7
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10004713
		mov	[ecx], eax

loc_10004713:				; CODE XREF: sub_1000469E+71j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000471C
		mov	[ecx], eax

loc_1000471C:				; CODE XREF: sub_1000469E+7Aj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+20h], eax
		push	18h
		mov	[esi+28h], ebp
		mov	[esi+2Ch], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100046D7
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000473F
		mov	[ecx], eax

loc_1000473F:				; CODE XREF: sub_1000469E+9Dj
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10004748
		mov	[ecx], eax

loc_10004748:				; CODE XREF: sub_1000469E+A6j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+28h], eax
		push	18h
		mov	[esi+30h], ebp
		mov	[esi+34h], ebp
		call	edi ; operator new(uint) ; operator new(uint)
		mov	edi, offset byte_1001AA47
		pop	ecx
		test	eax, eax
		jz	short loc_10004774
		push	edi		; void *
		mov	ecx, eax	; void *
		call	sub_100017D6
		mov	dword_10031F24,	eax
		jmp	short loc_1000477A
; ---------------------------------------------------------------------------

loc_10004774:				; CODE XREF: sub_1000469E+C5j
		mov	dword_10031F24,	ebp

loc_1000477A:				; CODE XREF: sub_1000469E+D4j
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		push	edi		; void *
		lea	ecx, [esp+30h+var_1C] ;	void *
		call	sub_100017D6
		lea	eax, [esp+2Ch+var_1C]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10004918
		mov	ecx, dword_10031F24
		push	ebp		; size_t
		push	1		; char
		mov	[eax], ecx
		lea	ecx, [esp+34h+var_1C]
		call	sub_1000189A
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ecx, [esp+2Ch+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn
sub_1000469E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100047C7	proc near		; CODE XREF: sub_10004592+19p
		mov	eax, dword_10031F3C
		test	eax, eax
		jz	short loc_100047D5
		cmp	eax, 1
		jnz	short locret_10004817

loc_100047D5:				; CODE XREF: sub_100047C7+7j
		xor	ecx, ecx
		mov	edx, offset dword_10031F3C
		inc	ecx
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jnz	short loc_1000480D
		push	38h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100047FD
		mov	ecx, eax	; lpCriticalSection
		call	sub_1000469E
		jmp	short loc_100047FF
; ---------------------------------------------------------------------------

loc_100047FD:				; CODE XREF: sub_100047C7+2Bj
		xor	eax, eax

loc_100047FF:				; CODE XREF: sub_100047C7+34j
		mov	dword_10031F3C,	eax
		retn
; ---------------------------------------------------------------------------

loc_10004805:				; CODE XREF: sub_100047C7+4Ej
		push	0		; dwMilliseconds
		call	ds:Sleep

loc_1000480D:				; CODE XREF: sub_100047C7+1Ej
		mov	eax, dword_10031F3C
		cmp	eax, 1
		jz	short loc_10004805

locret_10004817:			; CODE XREF: sub_100047C7+Cj
		retn
sub_100047C7	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10004818(LPCRITICAL_SECTION lpCriticalSection, int, int)
sub_10004818	proc near		; CODE XREF: sub_10004592+20p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ecx, [esp+34h+var_20] ;	void *
		push	offset aBrokerevent ; "BrokerEvent"
		call	sub_100017D6
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	eax, [esp+34h+var_20]
		push	eax		; void *
		lea	eax, [esp+38h+var_24]
		lea	ebp, [edi+18h]
		push	eax		; int
		mov	ecx, ebp
		call	sub_10004A79
		mov	esi, [esp+34h+var_24]
		cmp	esi, [ebp+0]
		jz	short loc_10004876
		lea	eax, [esi+10h]
		push	eax		; void *
		lea	eax, [esp+38h+var_20]
		push	eax		; void *
		call	sub_10004AAD
		test	al, al
		jnz	short loc_10004876
		mov	[esp+34h+var_24], esi
		jmp	short loc_1000487D
; ---------------------------------------------------------------------------

loc_10004876:				; CODE XREF: sub_10004818+44j
					; sub_10004818+56j
		mov	eax, [ebp+0]
		mov	[esp+34h+var_24], eax

loc_1000487D:				; CODE XREF: sub_10004818+5Cj
		lea	eax, [esp+34h+var_24]
		mov	eax, [eax]
		cmp	eax, [ebp+0]
		jz	short loc_1000488D
		mov	ebx, [eax+28h]
		jmp	short loc_100048BA
; ---------------------------------------------------------------------------

loc_1000488D:				; CODE XREF: sub_10004818+6Ej
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100048AA
		lea	ecx, [esp+34h+var_20]
		push	ecx
		mov	ecx, eax
		call	sub_1000345E
		mov	ebx, eax
		jmp	short loc_100048AC
; ---------------------------------------------------------------------------

loc_100048AA:				; CODE XREF: sub_10004818+80j
		xor	ebx, ebx

loc_100048AC:				; CODE XREF: sub_10004818+90j
		lea	eax, [esp+34h+var_20]
		mov	ecx, ebp
		push	eax		; void *
		call	sub_10004989
		mov	[eax], ebx

loc_100048BA:				; CODE XREF: sub_10004818+73j
		lea	eax, [esp+34h+arg_0]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		lea	ecx, [edi+20h]
		call	sub_100049FA
		mov	eax, [esp+34h+var_24]
		cmp	eax, [edi+20h]
		jnz	short loc_100048E1
		mov	eax, [esp+34h+arg_0]
		mov	[edi+30h], ebx
		mov	[edi+34h], eax
		jmp	short loc_100048EF
; ---------------------------------------------------------------------------

loc_100048E1:				; CODE XREF: sub_10004818+BBj
		add	eax, 14h
		lea	ecx, [edi+28h]
		push	eax
		call	sub_10004A34
		mov	[eax], ebx

loc_100048EF:				; CODE XREF: sub_10004818+C7j
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		push	0		; size_t
		push	1		; char
		lea	ecx, [esp+3Ch+var_20]
		call	sub_1000189A
		mov	ecx, [esp+34h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	8
sub_10004818	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004918(void *)
sub_10004918	proc near		; CODE XREF: sub_1000469E+F4p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+14h+arg_0]	; void *
		lea	eax, [esp+18h+var_4]
		mov	edi, ecx
		push	eax		; int
		call	sub_10004A79
		mov	esi, [esp+14h+var_4]
		cmp	esi, [edi]
		jz	short loc_10004946
		lea	eax, [esi+10h]
		push	eax		; void *
		push	[esp+18h+arg_0]	; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_1000497E

loc_10004946:				; CODE XREF: sub_10004918+1Bj
		mov	ecx, edi
		call	sub_10004EB9
		mov	ebp, eax
		lea	ebx, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	ebx, ebx
		jz	short loc_1000496B
		push	[esp+14h+arg_0]	; void *
		mov	ecx, ebx
		call	sub_10001C5F
		and	dword ptr [ebx+18h], 0

loc_1000496B:				; CODE XREF: sub_10004918+42j
		push	ebp		; int
		push	ebx		; void *
		push	esi		; int
		lea	eax, [esp+20h+arg_0]
		mov	ecx, edi
		push	eax		; int
		call	sub_10004C27
		mov	esi, [esp+14h+arg_0]

loc_1000497E:				; CODE XREF: sub_10004918+2Cj
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_10004918	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004989(void *)
sub_10004989	proc near		; CODE XREF: sub_10004818+9Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+14h+arg_0]	; void *
		lea	eax, [esp+18h+var_4]
		mov	edi, ecx
		push	eax		; int
		call	sub_10004A79
		mov	esi, [esp+14h+var_4]
		cmp	esi, [edi]
		jz	short loc_100049B7
		lea	eax, [esi+10h]
		push	eax		; void *
		push	[esp+18h+arg_0]	; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_100049EF

loc_100049B7:				; CODE XREF: sub_10004989+1Bj
		mov	ecx, edi
		call	sub_10004EB9
		mov	ebp, eax
		lea	ebx, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	ebx, ebx
		jz	short loc_100049DC
		push	[esp+14h+arg_0]
		mov	ecx, ebx
		call	sub_1000345E
		and	dword ptr [ebx+18h], 0

loc_100049DC:				; CODE XREF: sub_10004989+42j
		push	ebp		; int
		push	ebx		; void *
		push	esi		; int
		lea	eax, [esp+20h+arg_0]
		mov	ecx, edi
		push	eax		; int
		call	sub_10004C27
		mov	esi, [esp+14h+arg_0]

loc_100049EF:				; CODE XREF: sub_10004989+2Cj
		pop	edi
		lea	eax, [esi+28h]
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_10004989	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100049FA	proc near		; CODE XREF: sub_10004818+AFp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		lea	eax, [ebp+arg_4]
		push	edi
		push	eax
		mov	esi, ecx
		call	sub_10004AD5
		mov	edx, [esi]
		mov	eax, [ebp+arg_4]
		cmp	eax, edx
		jz	short loc_10004A21
		mov	ecx, [edi]
		mov	[ebp+arg_4], eax
		cmp	ecx, [eax+10h]
		jnb	short loc_10004A24

loc_10004A21:				; CODE XREF: sub_100049FA+1Bj
		mov	[ebp+arg_4], edx

loc_10004A24:				; CODE XREF: sub_100049FA+25j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_100049FA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004A34	proc near		; CODE XREF: sub_10004818+D0p

var_4		= byte ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	eax, [ebp+arg_0]
		push	edi
		push	esi
		push	eax
		mov	edi, ecx
		call	sub_10004AD5
		mov	eax, [ebp+arg_0]
		cmp	eax, [edi]
		jz	short loc_10004A57
		mov	ecx, [esi]
		cmp	ecx, [eax+10h]
		jnb	short loc_10004A6E

loc_10004A57:				; CODE XREF: sub_10004A34+1Aj
		push	ecx
		lea	ecx, [ebp+arg_0]
		mov	[ebp+arg_0], esi
		push	ecx
		push	ecx
		push	eax
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		call	sub_10004BC1
		mov	eax, [eax]

loc_10004A6E:				; CODE XREF: sub_10004A34+21j
		pop	edi
		add	eax, 14h
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10004A34	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004A79(int, void *)
sub_10004A79	proc near		; CODE XREF: sub_10004818+38p
					; sub_10004918+10p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_10004A9C
; ---------------------------------------------------------------------------

loc_10004A82:				; CODE XREF: sub_10004A79+27j
		push	[esp+8+arg_4]	; void *
		lea	eax, [esi+10h]
		push	eax		; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_10004A98
		mov	esi, [esi+8]
		jmp	short loc_10004A9C
; ---------------------------------------------------------------------------

loc_10004A98:				; CODE XREF: sub_10004A79+18j
		mov	edi, esi
		mov	esi, [esi]

loc_10004A9C:				; CODE XREF: sub_10004A79+7j
					; sub_10004A79+1Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10004A82
		mov	eax, [esp+8+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		retn	8
sub_10004A79	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004AAD(void *, void *)
sub_10004AAD	proc near		; CODE XREF: sub_10004818+4Fp
					; sub_10004918+25p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax+14h], 10h
		mov	ecx, [eax+10h]
		jb	short loc_10004ABC
		mov	eax, [eax]

loc_10004ABC:				; CODE XREF: sub_10004AAD+Bj
		push	ecx		; int
		mov	ecx, [esp+4+arg_0] ; void *
		push	eax		; void *
		push	dword ptr [ecx+10h] ; size_t
		push	ecx		; int
		call	sub_10003988
		xor	ecx, ecx
		test	eax, eax
		sets	al
		retn	8
sub_10004AAD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004AD5	proc near		; CODE XREF: sub_100049FA+Fp
					; sub_10004A34+10p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [ecx]
		mov	ecx, [edx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10004AFA
		mov	eax, [esp+arg_4]
		mov	eax, [eax]

loc_10004AE6:				; CODE XREF: sub_10004AD5+23j
		cmp	[ecx+10h], eax
		jnb	short loc_10004AF0
		mov	ecx, [ecx+8]
		jmp	short loc_10004AF4
; ---------------------------------------------------------------------------

loc_10004AF0:				; CODE XREF: sub_10004AD5+14j
		mov	edx, ecx
		mov	ecx, [ecx]

loc_10004AF4:				; CODE XREF: sub_10004AD5+19j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004AE6

loc_10004AFA:				; CODE XREF: sub_10004AD5+9j
		mov	eax, [esp+arg_0]
		mov	[eax], edx
		retn	8
sub_10004AD5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B03	proc near		; CODE XREF: sub_10004F33+8Ep
					; sub_10004F33+FAp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx+8]
		mov	eax, [esi]
		mov	[edx+8], eax
		mov	eax, [esi]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004B1B
		mov	[eax+4], edx

loc_10004B1B:				; CODE XREF: sub_10004B03+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_10004B2D
		mov	[eax+4], esi
		jmp	short loc_10004B3B
; ---------------------------------------------------------------------------

loc_10004B2D:				; CODE XREF: sub_10004B03+23j
		mov	eax, [edx+4]
		cmp	edx, [eax]
		jnz	short loc_10004B38
		mov	[eax], esi
		jmp	short loc_10004B3B
; ---------------------------------------------------------------------------

loc_10004B38:				; CODE XREF: sub_10004B03+2Fj
		mov	[eax+8], esi

loc_10004B3B:				; CODE XREF: sub_10004B03+28j
					; sub_10004B03+33j
		mov	[esi], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_10004B03	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B44	proc near		; CODE XREF: sub_10004F33+ACp
					; sub_10004F33+DCp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, [edx]
		mov	eax, [esi+8]
		mov	[edx], eax
		mov	eax, [esi+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004B5C
		mov	[eax+4], edx

loc_10004B5C:				; CODE XREF: sub_10004B44+13j
		mov	eax, [edx+4]
		mov	[esi+4], eax
		mov	eax, [ecx]
		cmp	edx, [eax+4]
		jnz	short loc_10004B6E
		mov	[eax+4], esi
		jmp	short loc_10004B7D
; ---------------------------------------------------------------------------

loc_10004B6E:				; CODE XREF: sub_10004B44+23j
		mov	eax, [edx+4]
		cmp	edx, [eax+8]
		jnz	short loc_10004B7B
		mov	[eax+8], esi
		jmp	short loc_10004B7D
; ---------------------------------------------------------------------------

loc_10004B7B:				; CODE XREF: sub_10004B44+30j
		mov	[eax], esi

loc_10004B7D:				; CODE XREF: sub_10004B44+28j
					; sub_10004B44+35j
		mov	[esi+8], edx
		mov	[edx+4], esi
		pop	esi
		retn	4
sub_10004B44	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004B87	proc near		; CODE XREF: sub_10004C27+F4p
					; sub_10004D89+B4p ...
		mov	edx, ecx
		mov	ecx, [edx]
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10004BBE
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004BB3
		jmp	short loc_10004B9E
; ---------------------------------------------------------------------------

loc_10004B9C:				; CODE XREF: sub_10004B87+1Dj
		mov	eax, ecx

loc_10004B9E:				; CODE XREF: sub_10004B87+13j
		mov	ecx, [eax]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004B9C
		mov	[edx], eax
		jmp	short loc_10004BBE
; ---------------------------------------------------------------------------

loc_10004BAA:				; CODE XREF: sub_10004B87+33j
		mov	eax, [edx]
		cmp	eax, [ecx+8]
		jnz	short loc_10004BBC
		mov	[edx], ecx

loc_10004BB3:				; CODE XREF: sub_10004B87+11j
		mov	ecx, [ecx+4]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10004BAA

loc_10004BBC:				; CODE XREF: sub_10004B87+28j
		mov	[edx], ecx

loc_10004BBE:				; CODE XREF: sub_10004B87+8j
					; sub_10004B87+21j
		mov	eax, edx
		retn
sub_10004B87	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004BC1	proc near		; CODE XREF: sub_10004A34+33p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		push	esi
		push	18h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10004BD9
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10004BD9:				; CODE XREF: sub_10004BC1+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10004BE8
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004BE8:				; CODE XREF: sub_10004BC1+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10004BF3
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004BF3:				; CODE XREF: sub_10004BC1+2Cj
		lea	ecx, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	ecx, ecx
		jz	short loc_10004C0E
		mov	eax, [esp+4+arg_C]
		mov	eax, [eax]
		mov	eax, [eax]
		and	dword ptr [ecx+4], 0
		mov	[ecx], eax

loc_10004C0E:				; CODE XREF: sub_10004BC1+3Dj
		push	edx
		push	ecx
		push	[esp+0Ch+arg_4]
		mov	ecx, esi
		push	[esp+10h+arg_0]
		call	sub_10004D89
		mov	eax, [esp+4+arg_0]
		pop	esi
		retn	14h
sub_10004BC1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10004C27(int, int, void *, int)
sub_10004C27	proc near		; CODE XREF: sub_10004918+5Dp
					; sub_10004989+5Dp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+14h+var_C], ebp
		cmp	[edi+4], ebp
		jnz	short loc_10004C54
		push	[esp+14h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+24h+arg_0]
		call	sub_10004F33
		mov	eax, [esp+14h+arg_0]
		jmp	loc_10004D81
; ---------------------------------------------------------------------------

loc_10004C54:				; CODE XREF: sub_10004C27+10j
		mov	ecx, [edi]
		mov	eax, [esp+14h+arg_4]
		push	ebx
		mov	ebx, [esp+18h+arg_8]
		push	esi
		cmp	eax, [ecx]
		jnz	short loc_10004C86
		add	eax, 10h
		push	eax		; void *
		push	ebx		; void *
		call	sub_10004AAD
		test	al, al
		jz	loc_10004D65
		push	[esp+1Ch+arg_C]
		push	ecx
		push	[esp+24h+arg_4]
		mov	ecx, edi
		jmp	loc_10004D54
; ---------------------------------------------------------------------------

loc_10004C86:				; CODE XREF: sub_10004C27+3Bj
		cmp	eax, ecx
		jnz	short loc_10004CB1
		mov	eax, [ecx+8]
		add	eax, 10h
		push	ebx		; void *
		push	eax		; void *
		call	sub_10004AAD
		test	al, al
		jz	loc_10004D65
		push	[esp+1Ch+arg_C]
		mov	eax, [edi]
		push	ecx
		mov	ecx, edi
		push	dword ptr [eax+8]
		push	ebp
		jmp	loc_10004D56
; ---------------------------------------------------------------------------

loc_10004CB1:				; CODE XREF: sub_10004C27+61j
		add	eax, 10h
		push	eax		; void *
		push	ebx		; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_10004CFD
		mov	eax, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], eax
		call	sub_10004EEF
		push	ebx		; void *
		mov	eax, [eax]
		add	eax, 10h
		push	eax		; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_10004CFD
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004CF7
		push	eax
		jmp	short loc_10004D4D
; ---------------------------------------------------------------------------

loc_10004CF7:				; CODE XREF: sub_10004C27+CBj
		push	[esp+24h+arg_4]
		jmp	short loc_10004D54
; ---------------------------------------------------------------------------

loc_10004CFD:				; CODE XREF: sub_10004C27+96j
					; sub_10004C27+B7j
		mov	eax, [esp+1Ch+arg_4]
		push	ebx		; void *
		add	eax, 10h
		push	eax		; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_10004D65
		mov	esi, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B87
		mov	eax, [eax]
		cmp	eax, [edi]
		jz	short loc_10004D3C
		mov	eax, [esp+1Ch+var_C]
		add	eax, 10h
		push	eax		; void *
		push	ebx		; void *
		call	sub_10004AAD
		test	al, al
		jz	short loc_10004D65
		mov	esi, [esp+1Ch+arg_4]

loc_10004D3C:				; CODE XREF: sub_10004C27+FDj
		mov	eax, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [eax+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004D50
		push	esi

loc_10004D4D:				; CODE XREF: sub_10004C27+CEj
		push	ebp
		jmp	short loc_10004D56
; ---------------------------------------------------------------------------

loc_10004D50:				; CODE XREF: sub_10004C27+123j
		push	[esp+24h+var_C]

loc_10004D54:				; CODE XREF: sub_10004C27+5Aj
					; sub_10004C27+D4j
		push	1

loc_10004D56:				; CODE XREF: sub_10004C27+85j
					; sub_10004C27+127j
		push	[esp+2Ch+arg_0]
		call	sub_10004F33
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_10004D7F
; ---------------------------------------------------------------------------

loc_10004D65:				; CODE XREF: sub_10004C27+49j
					; sub_10004C27+72j ...
		push	[esp+1Ch+arg_C]	; int
		lea	eax, [esp+20h+var_8]
		push	ebx		; void *
		push	ecx		; int
		push	eax		; int
		mov	ecx, edi
		call	sub_10005054
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_10004D7F:				; CODE XREF: sub_10004C27+13Cj
		pop	esi
		pop	ebx

loc_10004D81:				; CODE XREF: sub_10004C27+28j
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn	10h
sub_10004C27	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004D89	proc near		; CODE XREF: sub_10004BC1+59p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_10004DB5
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_100050F6
		mov	eax, [esp+10h+arg_0]
		jmp	loc_10004E95
; ---------------------------------------------------------------------------

loc_10004DB5:				; CODE XREF: sub_10004D89+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10004DDD
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_10004E78
		push	[esp+1Ch+arg_C]
		push	ecx

loc_10004DD7:				; CODE XREF: sub_10004D89+A0j
		push	esi
		jmp	loc_10004E67
; ---------------------------------------------------------------------------

loc_10004DDD:				; CODE XREF: sub_10004D89+3Cj
		cmp	esi, ebp
		jnz	short loc_10004DFA
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_10004E78
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_10004E69
; ---------------------------------------------------------------------------

loc_10004DFA:				; CODE XREF: sub_10004D89+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_10004E33
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EEF
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_10004E2E
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004DD7
		push	eax
		jmp	short loc_10004E62
; ---------------------------------------------------------------------------

loc_10004E2E:				; CODE XREF: sub_10004D89+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_10004E33:				; CODE XREF: sub_10004D89+76j
		jnb	short loc_10004E78
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B87
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_10004E51
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_10004E78

loc_10004E51:				; CODE XREF: sub_10004D89+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10004E66
		push	esi

loc_10004E62:				; CODE XREF: sub_10004D89+A3j
		push	0
		jmp	short loc_10004E69
; ---------------------------------------------------------------------------

loc_10004E66:				; CODE XREF: sub_10004D89+D6j
		push	eax

loc_10004E67:				; CODE XREF: sub_10004D89+4Fj
		push	1

loc_10004E69:				; CODE XREF: sub_10004D89+6Fj
					; sub_10004D89+DBj
		push	[esp+2Ch+arg_0]
		call	sub_100050F6
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_10004E92
; ---------------------------------------------------------------------------

loc_10004E78:				; CODE XREF: sub_10004D89+43j
					; sub_10004D89+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_1000521A
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_10004E92:				; CODE XREF: sub_10004D89+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_10004E95:				; CODE XREF: sub_10004D89+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_10004D89	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004E9C	proc near		; CODE XREF: sub_10004F33+15p
					; sub_10005054:loc_100050DFp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+10h]
		call	sub_1000189A
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn	4
sub_10004E9C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004EB9	proc near		; CODE XREF: sub_10004918+30p
					; sub_10004989+30p
		push	esi
		push	2Ch
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10004ED1
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10004ED1:				; CODE XREF: sub_10004EB9+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10004EE0
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004EE0:				; CODE XREF: sub_10004EB9+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10004EEB
		mov	eax, [esi]
		mov	[ecx], eax

loc_10004EEB:				; CODE XREF: sub_10004EB9+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_10004EB9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10004EEF	proc near		; CODE XREF: sub_10004C27+A4p
					; sub_10004D89+80p ...
		mov	edx, [ecx]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004EFC
		mov	eax, [edx+8]
		jmp	short loc_10004F11
; ---------------------------------------------------------------------------

loc_10004EFC:				; CODE XREF: sub_10004EEF+6j
		mov	eax, [edx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004F1D
		jmp	short loc_10004F08
; ---------------------------------------------------------------------------

loc_10004F06:				; CODE XREF: sub_10004EEF+20j
		mov	eax, edx

loc_10004F08:				; CODE XREF: sub_10004EEF+15j
		mov	edx, [eax+8]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004F06

loc_10004F11:				; CODE XREF: sub_10004EEF+Bj
		mov	[ecx], eax
		jmp	short loc_10004F30
; ---------------------------------------------------------------------------

loc_10004F15:				; CODE XREF: sub_10004EEF+35j
		mov	eax, [ecx]
		cmp	eax, [edx]
		jnz	short loc_10004F26
		mov	[ecx], edx

loc_10004F1D:				; CODE XREF: sub_10004EEF+13j
		mov	edx, [edx+4]
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10004F15

loc_10004F26:				; CODE XREF: sub_10004EEF+2Aj
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10004F30
		mov	[ecx], edx

loc_10004F30:				; CODE XREF: sub_10004EEF+24j
					; sub_10004EEF+3Dj
		mov	eax, ecx
		retn
sub_10004EEF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10004F33	proc near		; CODE XREF: sub_10004C27+1Fp
					; sub_10004C27+133p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 5D1745Ch
		jb	short loc_10004F58
		push	[ebp+arg_10]
		call	sub_10004E9C
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10004F58:				; CODE XREF: sub_10004F33+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_10004F79
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_10004F98
; ---------------------------------------------------------------------------

loc_10004F79:				; CODE XREF: sub_10004F33+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_10004F8B
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_10004F98
		mov	[ecx], edi
		jmp	short loc_10004F98
; ---------------------------------------------------------------------------

loc_10004F8B:				; CODE XREF: sub_10004F33+4Aj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_10004F98
		mov	[ecx+8], edi

loc_10004F98:				; CODE XREF: sub_10004F33+44j
					; sub_10004F33+52j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10005035
; ---------------------------------------------------------------------------

loc_10004FA2:				; CODE XREF: sub_10004F33+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10004FE6
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10004FEC
		cmp	esi, [eax+8]
		jnz	short loc_10004FC6
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_10004FC6:				; CODE XREF: sub_10004F33+87j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_10005032
; ---------------------------------------------------------------------------

loc_10004FE6:				; CODE XREF: sub_10004F33+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10005006

loc_10004FEC:				; CODE XREF: sub_10004F33+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10005032
; ---------------------------------------------------------------------------

loc_10005006:				; CODE XREF: sub_10004F33+B7j
		cmp	esi, [eax]
		jnz	short loc_10005014
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_10005014:				; CODE XREF: sub_10004F33+D5j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_10005032:				; CODE XREF: sub_10004F33+B1j
					; sub_10004F33+D1j
		mov	eax, [esi+4]

loc_10005035:				; CODE XREF: sub_10004F33+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10004FA2
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10004F33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10005054(int, int, void *, int)
sub_10005054	proc near		; CODE XREF: sub_10004C27+14Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_10005086
; ---------------------------------------------------------------------------

loc_1000506A:				; CODE XREF: sub_10005054+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax		; void *
		push	[ebp+arg_8]	; void *
		call	sub_10004AAD
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_10005083
		mov	esi, [esi]
		jmp	short loc_10005086
; ---------------------------------------------------------------------------

loc_10005083:				; CODE XREF: sub_10005054+29j
		mov	esi, [esi+8]

loc_10005086:				; CODE XREF: sub_10005054+14j
					; sub_10005054+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000506A
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_100050C5
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_100050BA
		push	[ebp+arg_C]
		push	ecx
		push	edi
		push	1

loc_100050A2:				; CODE XREF: sub_10005054+89j
		lea	eax, [ebp+arg_C]
		mov	ecx, ebx
		push	eax
		call	sub_10004F33
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_100050ED
; ---------------------------------------------------------------------------

loc_100050BA:				; CODE XREF: sub_10005054+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EEF
		mov	esi, [ebp+var_4]

loc_100050C5:				; CODE XREF: sub_10005054+3Fj
		push	[ebp+arg_8]	; void *
		lea	eax, [esi+10h]
		push	eax		; void *
		call	sub_10004AAD
		push	[ebp+arg_C]
		test	al, al
		jz	short loc_100050DF
		push	ecx
		push	edi
		push	[ebp+var_8]
		jmp	short loc_100050A2
; ---------------------------------------------------------------------------

loc_100050DF:				; CODE XREF: sub_10005054+82j
		call	sub_10004E9C
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_100050ED:				; CODE XREF: sub_10005054+64j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10005054	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100050F6	proc near		; CODE XREF: sub_10004D89+1Ep
					; sub_10004D89+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 0AAAAAA9h
		jb	short loc_1000511E
		push	[ebp+arg_10]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000511E:				; CODE XREF: sub_100050F6+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000513F
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000515E
; ---------------------------------------------------------------------------

loc_1000513F:				; CODE XREF: sub_100050F6+39j
		cmp	[ebp+arg_4], 0
		jz	short loc_10005151
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000515E
		mov	[ecx], edi
		jmp	short loc_1000515E
; ---------------------------------------------------------------------------

loc_10005151:				; CODE XREF: sub_100050F6+4Dj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000515E
		mov	[ecx+8], edi

loc_1000515E:				; CODE XREF: sub_100050F6+47j
					; sub_100050F6+55j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_100051FB
; ---------------------------------------------------------------------------

loc_10005168:				; CODE XREF: sub_100050F6+109j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_100051AC
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_100051B2
		cmp	esi, [eax+8]
		jnz	short loc_1000518C
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_1000518C:				; CODE XREF: sub_100050F6+8Aj
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_100051F8
; ---------------------------------------------------------------------------

loc_100051AC:				; CODE XREF: sub_100050F6+7Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_100051CC

loc_100051B2:				; CODE XREF: sub_100050F6+85j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_100051F8
; ---------------------------------------------------------------------------

loc_100051CC:				; CODE XREF: sub_100050F6+BAj
		cmp	esi, [eax]
		jnz	short loc_100051DA
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_100051DA:				; CODE XREF: sub_100050F6+D8j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_100051F8:				; CODE XREF: sub_100050F6+B4j
					; sub_100050F6+D4j
		mov	eax, [esi+4]

loc_100051FB:				; CODE XREF: sub_100050F6+6Dj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10005168
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_100050F6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000521A	proc near		; CODE XREF: sub_10004D89+FCp
					; sub_100091B2+57p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_10005258
		mov	esi, [ebx]

loc_1000523B:				; CODE XREF: sub_1000521A+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_1000524F
		mov	eax, [eax]
		jmp	short loc_10005252
; ---------------------------------------------------------------------------

loc_1000524F:				; CODE XREF: sub_1000521A+2Fj
		mov	eax, [eax+8]

loc_10005252:				; CODE XREF: sub_1000521A+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000523B

loc_10005258:				; CODE XREF: sub_1000521A+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_10005295
		cmp	edi, [ecx]
		jnz	short loc_10005288
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_1000526E:				; CODE XREF: sub_1000521A+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_100050F6
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_100052B9
; ---------------------------------------------------------------------------

loc_10005288:				; CODE XREF: sub_1000521A+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EEF
		mov	esi, [esp+14h+arg_8]

loc_10005295:				; CODE XREF: sub_1000521A+46j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]
		cmp	eax, [ebx]
		jnb	short loc_100052A8
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_1000526E
; ---------------------------------------------------------------------------

loc_100052A8:				; CODE XREF: sub_1000521A+84j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_100052B9:				; CODE XREF: sub_1000521A+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000521A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052C1	proc near		; CODE XREF: sub_100052D6+3p
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jnz	short loc_100052D3
		cmp	dword ptr [ecx+4], 7FFFFFFFh
		jnz	short loc_100052D3
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100052D3:				; CODE XREF: sub_100052C1+3j
					; sub_100052C1+Cj
		xor	eax, eax
		retn
sub_100052C1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052D6	proc near		; CODE XREF: sub_100053BD+9Ap
		push	esi
		mov	esi, ecx
		call	sub_100052C1
		test	al, al
		jz	short loc_100052EC
		or	eax, 0FFFFFFFFh
		mov	edx, 7FFFFFFFh
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100052EC:				; CODE XREF: sub_100052D6+Aj
		mov	eax, [esi]
		mov	edx, [esi+4]
		pop	esi
		retn
sub_100052D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100052F3	proc near		; CODE XREF: sub_10005333+4Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_0], 0FFFFFFFFh
		push	esi
		mov	esi, ecx
		jnz	short loc_10005310
		mov	eax, 7FFFFFFFh
		cmp	[esp+4+arg_4], eax
		jnz	short loc_10005310
		or	dword ptr [esi], 0FFFFFFFFh
		mov	[esi+4], eax
		jmp	short loc_10005329
; ---------------------------------------------------------------------------

loc_10005310:				; CODE XREF: sub_100052F3+8j
					; sub_100052F3+13j
		push	0
		push	3E8h
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	__allmul
		mov	[esi], eax
		mov	[esi+4], edx

loc_10005329:				; CODE XREF: sub_100052F3+1Bj
		mov	eax, esi
		pop	esi
		retn
sub_100052F3	endp

; [00000006 BYTES: COLLAPSED FUNCTION timeGetTime]

; =============== S U B	R O U T	I N E =======================================


sub_10005333	proc near		; CODE XREF: sub_100053BD+92p
					; sub_10005577+58p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, offset CriticalSection
		push	edi		; lpCriticalSection
		call	ds:EnterCriticalSection
		call	ds:off_1001AAB4
		mov	ecx, dword_10031CB0
		mov	esi, eax
		mov	edx, dword_10031CB4
		cmp	esi, dword_10031CAC
		jnb	short loc_1000536F
		add	ecx, 0
		mov	dword_10031CB0,	ecx
		adc	edx, 1
		mov	dword_10031CB4,	edx

loc_1000536F:				; CODE XREF: sub_10005333+28j
		xor	eax, eax
		mov	dword_10031CAC,	esi
		add	esi, ecx
		mov	ecx, [esp+8+arg_0]
		adc	eax, edx
		push	eax
		push	esi
		call	sub_100052F3
		pop	ecx
		pop	ecx
		push	edi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		retn
sub_10005333	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005396	proc near		; CODE XREF: sub_100053BD+33p
					; sub_100055DC+2Ep
		push	esi
		mov	esi, ecx
		push	0Ch		; int
		push	offset aAuthenticamd ; "AuthenticAMD"
		lea	ecx, [esi+28h]	; void *
		push	dword ptr [ecx+10h] ; size_t
		push	ecx		; int
		call	sub_10003988
		test	eax, eax
		jnz	short loc_100053B9
		cmp	dword ptr [esi+8], 0Fh
		jnz	short loc_100053B9
		inc	eax
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_100053B9:				; CODE XREF: sub_10005396+18j
					; sub_10005396+1Ej
		xor	eax, eax
		pop	esi
		retn
sub_10005396	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100053BD	proc near		; CODE XREF: sub_10005546+20p

Frequency	= LARGE_INTEGER	ptr -78h
PerformanceCount= LARGE_INTEGER	ptr -70h
var_68		= byte ptr -68h
var_60		= byte ptr -60h
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+7Ch+var_4], eax
		push	ebx
		mov	ebx, ecx
		lea	ecx, [esp+80h+var_60]
		push	esi
		xor	esi, esi
		push	edi
		mov	[ebx], esi
		mov	[ebx+4], esi
		mov	[ebx+8], esi
		mov	[ebx+0Ch], esi
		call	sub_10002C02
		lea	ecx, [esp+88h+var_60]
		call	sub_10005396
		test	al, al
		jz	short loc_10005408

loc_100053F9:				; CODE XREF: sub_100053BD+60j
		push	esi		; size_t
		push	1		; char
		lea	ecx, [esp+90h+var_20]
		call	sub_1000189A
		push	esi
		jmp	short loc_10005475
; ---------------------------------------------------------------------------

loc_10005408:				; CODE XREF: sub_100053BD+3Aj
		lea	eax, [esp+88h+Frequency]
		mov	dword ptr [esp+88h+Frequency], esi
		push	eax		; lpFrequency
		mov	dword ptr [esp+8Ch+Frequency+4], esi
		call	ds:QueryPerformanceFrequency
		test	eax, eax
		jz	short loc_100053F9
		mov	eax, dword ptr [esp+88h+Frequency]
		mov	[ebx], eax
		mov	eax, dword ptr [esp+88h+Frequency+4]
		mov	[ebx+4], eax
		lea	eax, [esp+88h+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		push	dword ptr [esp+88h+PerformanceCount+4]
		mov	ecx, ebx
		push	dword ptr [esp+8Ch+PerformanceCount]
		call	sub_10005497
		mov	esi, eax
		mov	edi, edx
		lea	eax, [esp+88h+var_68]
		push	eax
		call	sub_10005333
		pop	ecx
		mov	ecx, eax
		call	sub_100052D6
		sub	esi, eax
		lea	ecx, [esp+88h+var_20]
		push	0		; size_t
		sbb	edi, edx
		mov	[ebx+8], esi
		push	1		; char
		mov	[ebx+0Ch], edi
		call	sub_1000189A
		push	0		; size_t

loc_10005475:				; CODE XREF: sub_100053BD+49j
		push	1		; char
		lea	ecx, [esp+90h+var_38]
		call	sub_1000189A
		mov	ecx, [esp+88h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100053BD	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005497	proc near		; CODE XREF: sub_100053BD+84p
					; sub_10005577+2Dp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [ecx]
		mov	eax, ebx
		push	ebp
		mov	ebp, [ecx+4]
		or	eax, ebp
		push	esi
		push	edi
		mov	[esp+18h+var_4], ebx
		mov	[esp+18h+var_8], ebp
		jnz	short loc_100054B7
		xor	edx, edx
		jmp	loc_1000553D
; ---------------------------------------------------------------------------

loc_100054B7:				; CODE XREF: sub_10005497+17j
		mov	edi, [esp+18h+arg_4]
		mov	esi, [esp+18h+arg_0]
		cmp	edi, 863h
		jg	short loc_100054EA
		jl	short loc_100054D1
		cmp	esi, 7BD05AF7h
		jnb	short loc_100054EA

loc_100054D1:				; CODE XREF: sub_10005497+30j
		push	0
		push	0F4240h
		push	edi
		push	esi
		call	__allmul
		push	ebp
		push	ebx
		push	edx
		push	eax
		call	__alldiv
		jmp	short loc_1000553D
; ---------------------------------------------------------------------------

loc_100054EA:				; CODE XREF: sub_10005497+2Ej
					; sub_10005497+38j
		push	ebp
		push	ebx
		push	edi
		push	esi
		call	__alldiv
		mov	ebx, edx
		mov	ebp, eax
		push	ebx
		push	ebp
		push	[esp+20h+var_8]
		push	[esp+24h+var_4]
		call	__allmul
		sub	esi, eax
		push	0
		push	0F4240h
		sbb	edi, edx
		push	edi
		push	esi
		call	__allmul
		push	[esp+18h+var_8]
		push	[esp+1Ch+var_4]
		push	edx
		push	eax
		call	__alldiv
		push	0
		push	0F4240h
		push	ebx
		push	ebp
		mov	esi, eax
		mov	edi, edx
		call	__allmul
		add	eax, esi
		adc	edx, edi

loc_1000553D:				; CODE XREF: sub_10005497+1Bj
					; sub_10005497+51j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
sub_10005497	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005546	proc near		; CODE XREF: sub_10005577+Ap
					; sub_100055DC+1Fp
		push	ecx
		mov	eax, dword_10031CC0
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005570
		mov	ecx, offset dword_10031CC0
		call	sub_10002F37
		test	al, al
		jz	short loc_10005570
		mov	ecx, offset dword_10031CC8
		call	sub_100053BD
		mov	dword_10031CC0,	eax

loc_10005570:				; CODE XREF: sub_10005546+Bj
					; sub_10005546+19j
		mov	eax, dword_10031CC0
		pop	ecx
		retn
sub_10005546	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005577	proc near		; CODE XREF: sub_10005642+2Fp
					; DATA XREF: sub_10005642:loc_10005667o

PerformanceCount= LARGE_INTEGER	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0Ch
		push	esi
		call	sub_10005546
		mov	esi, eax
		mov	ecx, [esi]
		or	ecx, [esi+4]
		jz	short loc_100055CB
		lea	eax, [esp+10h+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		push	dword ptr [esp+10h+PerformanceCount+4]
		mov	ecx, esi
		push	dword ptr [esp+14h+PerformanceCount]
		call	sub_10005497
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_100055C1
		mov	ecx, 7FFFFFFFh
		cmp	edx, ecx
		jnz	short loc_100055C1
		mov	esi, [ebp+arg_0]
		or	[esi], eax
		mov	[esi+4], ecx
		jmp	short loc_100055D5
; ---------------------------------------------------------------------------

loc_100055C1:				; CODE XREF: sub_10005577+35j
					; sub_10005577+3Ej
		mov	esi, [ebp+arg_0]
		mov	[esi], eax
		mov	[esi+4], edx
		jmp	short loc_100055D5
; ---------------------------------------------------------------------------

loc_100055CB:				; CODE XREF: sub_10005577+16j
		mov	esi, [ebp+arg_0]
		push	esi
		call	sub_10005333
		pop	ecx

loc_100055D5:				; CODE XREF: sub_10005577+48j
					; sub_10005577+52j
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10005577	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100055DC	proc near		; CODE XREF: sub_10005642+6p

var_60		= byte ptr -60h
var_3A		= byte ptr -3Ah
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 64h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		lea	ecx, [ebp+var_60]
		call	sub_10002C02
		cmp	[ebp+var_3A], 0
		jz	short loc_10005617
		call	sub_10005546
		mov	ecx, [eax]
		or	ecx, [eax+4]
		jz	short loc_10005617
		lea	ecx, [ebp+var_60]
		call	sub_10005396
		test	al, al
		jnz	short loc_10005617
		mov	bl, 1
		jmp	short loc_10005619
; ---------------------------------------------------------------------------

loc_10005617:				; CODE XREF: sub_100055DC+1Dj
					; sub_100055DC+29j ...
		xor	bl, bl

loc_10005619:				; CODE XREF: sub_100055DC+39j
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_20]
		call	sub_1000189A
		push	0		; size_t
		push	1		; char
		lea	ecx, [ebp+var_38]
		call	sub_1000189A
		mov	ecx, [ebp+var_4]
		mov	al, bl
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100055DC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005642	proc near		; DATA XREF: .data:off_10031014o

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		call	sub_100055DC
		mov	ecx, offset off_10031014
		test	al, al
		jnz	short loc_10005667
		mov	eax, offset sub_10005333
		xchg	eax, [ecx]
		push	[ebp+arg_0]
		call	sub_10005333
		jmp	short loc_10005676
; ---------------------------------------------------------------------------

loc_10005667:				; CODE XREF: sub_10005642+12j
		mov	eax, offset sub_10005577
		xchg	eax, [ecx]
		push	[ebp+arg_0]
		call	sub_10005577

loc_10005676:				; CODE XREF: sub_10005642+23j
		mov	eax, [ebp+arg_0]
		pop	ecx
		mov	esp, ebp
		pop	ebp
		retn
sub_10005642	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000567E	proc near		; CODE XREF: sub_100056BC+28p
					; sub_100056F9+2Cp

arg_0		= dword	ptr  4

		mov	eax, [ecx+4]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, [eax+3Ch]
		add	edx, eax
		movzx	eax, word ptr [edx+6]
		cmp	esi, eax
		jnb	short loc_100056A3
		movzx	ecx, word ptr [edx+14h]
		imul	eax, esi, 28h
		add	ecx, edx
		add	eax, 18h
		add	eax, ecx
		jmp	short loc_100056A5
; ---------------------------------------------------------------------------

loc_100056A3:				; CODE XREF: sub_1000567E+13j
		xor	eax, eax

loc_100056A5:				; CODE XREF: sub_1000567E+23j
		pop	esi
		retn	4
sub_1000567E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100056A9	proc near		; CODE XREF: sub_10005755+9p
					; sub_1000579F+21p ...
		mov	eax, [ecx+4]
		mov	edx, [eax+3Ch]
		add	edx, eax
		mov	eax, [ecx]
		push	dword ptr [edx+78h]
		call	dword ptr [eax+4]
		retn	4
sub_100056A9	endp


; =============== S U B	R O U T	I N E =======================================


sub_100056BC	proc near		; CODE XREF: sub_10016909+18p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		xor	edi, edi
		jmp	short loc_100056E3
; ---------------------------------------------------------------------------

loc_100056C5:				; CODE XREF: sub_100056BC+31j
		push	dword ptr [esi+0Ch]
		mov	ecx, ebx
		call	sub_10005906
		cmp	eax, [esp+0Ch+arg_0]
		ja	short loc_100056E0
		mov	ecx, [esi+8]
		add	ecx, eax
		cmp	ecx, [esp+0Ch+arg_0]
		ja	short loc_100056F5

loc_100056E0:				; CODE XREF: sub_100056BC+17j
		inc	edi
		mov	ecx, ebx

loc_100056E3:				; CODE XREF: sub_100056BC+7j
		push	edi
		call	sub_1000567E
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100056C5

loc_100056EF:				; CODE XREF: sub_100056BC+3Bj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
; ---------------------------------------------------------------------------

loc_100056F5:				; CODE XREF: sub_100056BC+22j
		mov	eax, esi
		jmp	short loc_100056EF
sub_100056BC	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100056F9(char *)
sub_100056F9	proc near		; CODE XREF: sub_10002E8B+29p
					; sub_10002E8B+3Ap

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		cmp	[esp+4+arg_0], 0
		push	ebp
		mov	ebp, ecx
		jnz	short loc_10005708
		xor	eax, eax
		jmp	short loc_10005750
; ---------------------------------------------------------------------------

loc_10005708:				; CODE XREF: sub_100056F9+9j
		mov	ecx, [ebp+4]
		push	esi
		push	edi
		xor	edi, edi
		mov	eax, [ecx+3Ch]
		mov	esi, edi
		movzx	eax, word ptr [eax+ecx+6]
		mov	[esp+10h+var_4], eax
		test	eax, eax
		jle	short loc_1000574C
		push	ebx

loc_10005722:				; CODE XREF: sub_100056F9+4Cj
		push	esi
		mov	ecx, ebp
		call	sub_1000567E
		push	8		; size_t
		push	[esp+18h+arg_0]	; char *
		mov	ebx, eax
		push	ebx		; char *
		call	ds:_strnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_10005749
		inc	esi
		cmp	esi, [esp+14h+var_4]
		jl	short loc_10005722
		jmp	short loc_1000574B
; ---------------------------------------------------------------------------

loc_10005749:				; CODE XREF: sub_100056F9+45j
		mov	edi, ebx

loc_1000574B:				; CODE XREF: sub_100056F9+4Ej
		pop	ebx

loc_1000574C:				; CODE XREF: sub_100056F9+26j
		mov	eax, edi
		pop	edi
		pop	esi

loc_10005750:				; CODE XREF: sub_100056F9+Dj
		pop	ebp
		pop	ecx
		retn	4
sub_100056F9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005755	proc near		; CODE XREF: sub_1000579F+7p
					; sub_10009B04+39p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	ecx
		mov	esi, ecx
		call	sub_100056A9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000576D

loc_10005769:				; CODE XREF: sub_10005755+2Cj
		xor	eax, eax
		jmp	short loc_10005797
; ---------------------------------------------------------------------------

loc_1000576D:				; CODE XREF: sub_10005755+12j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		mov	ecx, esi
		call	sub_100057E5
		test	al, al
		jz	short loc_10005769
		mov	eax, [esi]
		mov	ecx, esi
		push	dword ptr [edi+1Ch]
		call	dword ptr [eax+4]
		movzx	ecx, word ptr [ebp+var_4]
		sub	ecx, [edi+10h]
		lea	eax, [eax+ecx*4]

loc_10005797:				; CODE XREF: sub_10005755+16j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005755	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000579F	proc near		; CODE XREF: sub_1000E032+69p
					; sub_1000EE56+29p ...

arg_0		= dword	ptr  4

		push	esi
		push	[esp+4+arg_0]
		mov	esi, ecx
		call	sub_10005755
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_100057E1
		mov	eax, [esi]
		push	edi
		push	dword ptr [ecx]
		mov	ecx, esi
		call	dword ptr [eax+4]
		push	ecx
		mov	ecx, esi
		mov	edi, eax
		call	sub_100056A9
		mov	edx, [esi+4]
		cmp	eax, edi
		ja	short loc_100057DE
		mov	ecx, [edx+3Ch]
		mov	ecx, [ecx+edx+7Ch]
		add	ecx, eax
		cmp	ecx, edi
		jbe	short loc_100057DE
		or	eax, 0FFFFFFFFh
		jmp	short loc_100057E0
; ---------------------------------------------------------------------------

loc_100057DE:				; CODE XREF: sub_1000579F+2Bj
					; sub_1000579F+38j
		mov	eax, edi

loc_100057E0:				; CODE XREF: sub_1000579F+3Dj
		pop	edi

loc_100057E1:				; CODE XREF: sub_1000579F+10j
		pop	esi
		retn	4
sub_1000579F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100057E5	proc near		; CODE XREF: sub_10005755+25p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebp
		mov	ebp, [esp+0Ch+arg_4]
		push	edi
		mov	edi, ecx
		test	ebp, ebp
		jnz	short loc_100057FA
		xor	al, al
		jmp	loc_100058CC
; ---------------------------------------------------------------------------

loc_100057FA:				; CODE XREF: sub_100057E5+Cj
		push	ebx
		push	ecx
		call	sub_100056A9
		mov	ebx, eax
		test	ebx, ebx
		jnz	short loc_1000580E
		xor	al, al
		jmp	loc_100058CB
; ---------------------------------------------------------------------------

loc_1000580E:				; CODE XREF: sub_100057E5+20j
		mov	eax, [esp+14h+arg_0]
		push	esi
		cmp	eax, 0FFFFh
		jbe	loc_100058C0
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+20h]
		call	dword ptr [eax+4]
		mov	ecx, [ebx+18h]
		mov	edx, eax
		mov	[esp+18h+var_4], edx
		mov	esi, edx
		lea	eax, [edx+ecx*4]
		mov	[esp+18h+var_8], eax
		cmp	edx, eax
		jz	loc_100058C8

loc_10005842:				; CODE XREF: sub_100057E5+B4j
		sub	eax, esi
		sar	eax, 2
		cdq
		sub	eax, edx
		sar	eax, 1
		lea	ecx, [esi+eax*4]
		mov	eax, [edi]
		push	dword ptr [ecx]
		mov	[esp+1Ch+arg_4], ecx
		mov	ecx, edi
		call	dword ptr [eax+4]
		mov	ecx, eax
		mov	eax, [esp+18h+arg_0]
		mov	edx, eax
		mov	al, [eax]
		jmp	short loc_10005870
; ---------------------------------------------------------------------------

loc_10005868:				; CODE XREF: sub_100057E5+8Dj
		cmp	al, [ecx]
		jnz	short loc_10005874
		inc	edx
		inc	ecx
		mov	al, [edx]

loc_10005870:				; CODE XREF: sub_100057E5+81j
		test	al, al
		jnz	short loc_10005868

loc_10005874:				; CODE XREF: sub_100057E5+85j
		movzx	eax, byte ptr [ecx]
		movzx	ecx, byte ptr [edx]
		sub	ecx, eax
		jz	short loc_1000589D
		test	ecx, ecx
		jle	short loc_1000588F
		mov	esi, [esp+18h+arg_4]
		mov	eax, [esp+18h+var_8]
		add	esi, 4
		jmp	short loc_10005897
; ---------------------------------------------------------------------------

loc_1000588F:				; CODE XREF: sub_100057E5+9Bj
		mov	eax, [esp+18h+arg_4]
		mov	[esp+18h+var_8], eax

loc_10005897:				; CODE XREF: sub_100057E5+A8j
		cmp	esi, eax
		jnz	short loc_10005842
		jmp	short loc_100058A3
; ---------------------------------------------------------------------------

loc_1000589D:				; CODE XREF: sub_100057E5+97j
		mov	eax, [esp+18h+arg_4]
		mov	esi, eax

loc_100058A3:				; CODE XREF: sub_100057E5+B6j
		test	ecx, ecx
		jnz	short loc_100058C8
		mov	eax, [edi]
		mov	ecx, edi
		push	dword ptr [ebx+24h]
		call	dword ptr [eax+4]
		sub	esi, [esp+18h+var_4]
		sar	esi, 2
		mov	ax, [eax+esi*2]
		add	ax, [ebx+10h]

loc_100058C0:				; CODE XREF: sub_100057E5+33j
		mov	[ebp+0], ax
		mov	al, 1
		jmp	short loc_100058CA
; ---------------------------------------------------------------------------

loc_100058C8:				; CODE XREF: sub_100057E5+57j
					; sub_100057E5+C0j
		xor	al, al

loc_100058CA:				; CODE XREF: sub_100057E5+E1j
		pop	esi

loc_100058CB:				; CODE XREF: sub_100057E5+24j
		pop	ebx

loc_100058CC:				; CODE XREF: sub_100057E5+10j
		pop	edi
		pop	ebp
		pop	ecx
		pop	ecx
		retn	8
sub_100057E5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100058D3	proc near		; CODE XREF: sub_10009B04+23p
					; sub_10012A2B+20p ...
		mov	ecx, [ecx+4]
		mov	eax, 5A4Dh
		cmp	[ecx], ax
		jz	short loc_100058E3

loc_100058E0:				; CODE XREF: sub_100058D3+1Bj
					; sub_100058D3+26j
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_100058E3:				; CODE XREF: sub_100058D3+Bj
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		cmp	dword ptr [eax], 4550h
		jnz	short loc_100058E0
		mov	ecx, 0E0h
		cmp	[eax+14h], cx
		jnz	short loc_100058E0
		add	ecx, 2Bh
		cmp	[eax+18h], cx
		setz	al
		retn
sub_100058D3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005906	proc near		; CODE XREF: sub_100056BC+Ep
					; sub_10009B04+51p ...

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0
		jnz	short loc_10005911
		xor	eax, eax
		jmp	short locret_10005918
; ---------------------------------------------------------------------------

loc_10005911:				; CODE XREF: sub_10005906+5j
		mov	eax, [ecx+4]
		add	eax, [esp+arg_0]

locret_10005918:			; CODE XREF: sub_10005906+9j
		retn	4
sub_10005906	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000591B(HANDLE hObject)
sub_1000591B	proc near		; CODE XREF: sub_10004646+3Bp

var_B8		= byte ptr -0B8h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		and	[ebp+var_4], 0
		push	ecx		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jnz	short loc_1000595F
		push	3
		push	32h
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [ebp+var_B8]
		call	sub_10001B48
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002847
		lea	ecx, [ebp+var_B8]
		call	sub_10001BED

loc_1000595F:				; CODE XREF: sub_1000591B+16j
		mov	al, 1
		mov	esp, ebp
		pop	ebp
		retn
sub_1000591B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005965	proc near		; CODE XREF: sub_10004610+2Ap

lpCriticalSection= dword ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= byte ptr -0C0h
var_B0		= byte ptr -0B0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0DCh
		and	[esp+0DCh+lpCriticalSection], 0
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, ecx
		call	ds:GetCurrentThreadId
		mov	edi, eax
		call	sub_10005B09
		push	eax		; lpCriticalSection
		mov	[esp+0ECh+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		mov	ecx, [ebp+arg_0]
		lea	eax, [esp+0E8h+var_C4]
		mov	[esp+0E8h+var_D0], ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+0E8h+var_D4], esi
		lea	esi, [esp+0E8h+var_D4]
		mov	[esp+0E8h+var_C8], edi
		lea	edi, [esp+0E8h+var_C0]
		mov	[esp+0E8h+var_CC], ecx
		mov	[esp+0E8h+var_C4], ebx
		movsd
		push	eax
		lea	eax, [esp+0ECh+var_D4]
		push	eax
		movsd
		movsd
		movsd
		call	sub_10005C05
		mov	ecx, eax
		call	sub_10005F5C
		cmp	byte ptr [esp+0E8h+var_D0], 0
		jnz	short loc_10005A1A
		mov	esi, [esp+0E8h+var_D4]
		lea	edi, [esp+0E8h+var_D4]
		lea	eax, [esp+0E8h+var_D4]
		push	eax
		lea	esi, [esi+0Ch]
		movsd
		movsd
		movsd
		movsd
		call	sub_10002E68
		pop	ecx
		push	3
		push	6Ah
		push	offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+0F4h+var_B0]
		call	sub_10001B48
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002847
		lea	ecx, [esp+0E8h+var_B0]
		call	sub_10001BED

loc_10005A1A:				; CODE XREF: sub_10005965+71j
		push	[esp+0E8h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10005965	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005A2B	proc near		; CODE XREF: sub_10004646+1Bp
					; sub_1000629D+15p

var_CC		= dword	ptr -0CCh
lpCriticalSection= dword ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_B0		= byte ptr -0B0h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0D0h
		and	[esp+0D0h+lpCriticalSection], 0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebx, edx
		mov	[esp+0E0h+var_C4], ecx
		call	sub_10005B09
		push	eax		; lpCriticalSection
		mov	[esp+0E4h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	eax, [esp+0E0h+var_C4]
		push	eax
		lea	eax, [esp+0E4h+var_CC]
		push	eax
		call	sub_10005C05
		mov	ecx, eax
		call	sub_10005BA2
		call	sub_10005C05
		mov	esi, [esp+0E0h+var_CC]
		mov	ebp, offset aCBuildsMoz2_sl ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		cmp	esi, [eax]
		jnz	short loc_10005AA2
		push	3
		push	77h
		push	ebp
		lea	ecx, [esp+0ECh+var_B0]
		call	sub_10001B48
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002847
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001BED

loc_10005AA2:				; CODE XREF: sub_10005A2B+51j
		add	esi, 0Ch
		lea	edi, [esp+0E0h+var_C0]
		movsd
		movsd
		movsd
		movsd
		cmp	[esp+0E0h+var_C0], ebx
		jz	short loc_10005AE2
		lea	eax, [esp+0E0h+var_C0]
		push	eax
		call	sub_10002E68
		pop	ecx
		push	3
		push	7Ch
		push	ebp
		lea	ecx, [esp+0ECh+var_B0]
		call	sub_10001B48
		mov	edx, offset aCheckFailedFal ; "Check failed: false. "
		lea	ecx, [eax+8]
		call	sub_10002847
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10001BED

loc_10005AE2:				; CODE XREF: sub_10005A2B+86j
		push	[esp+0E0h+var_CC]
		lea	eax, [esp+0E4h+var_CC]
		push	eax
		call	sub_10005C05
		mov	ecx, eax
		call	sub_10005B42
		push	[esp+0E0h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10005A2B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005B09	proc near		; CODE XREF: sub_10004646+24p
					; sub_10005965+20p ...
		mov	eax, dword_10031D60
		push	esi
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005B3B
		mov	ecx, offset dword_10031D60
		call	sub_10002F37
		test	al, al
		jz	short loc_10005B3B
		push	7D0h		; dwSpinCount
		mov	esi, offset stru_10031D64
		push	esi		; lpCriticalSection
		call	ds:InitializeCriticalSectionAndSpinCount
		mov	dword_10031D60,	esi

loc_10005B3B:				; CODE XREF: sub_10005B09+Bj
					; sub_10005B09+19j
		mov	eax, dword_10031D60
		pop	esi
		retn
sub_10005B09	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005B42	proc near		; CODE XREF: sub_10005A2B+C7p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		push	edi
		add	eax, 8
		mov	edi, ecx
		push	eax
		call	sub_10005C77
		mov	esi, [edi+8]
		mov	edx, eax
		mov	ecx, [ebp+arg_4]
		cmp	[esi+edx*8+4], ecx
		jnz	short loc_10005B81
		cmp	[esi+edx*8], ecx
		jnz	short loc_10005B78
		mov	eax, [edi]
		mov	[esi+edx*8], eax
		mov	ecx, [edi+8]
		mov	eax, [edi]
		mov	[ecx+edx*8+4], eax
		jmp	short loc_10005B8B
; ---------------------------------------------------------------------------

loc_10005B78:				; CODE XREF: sub_10005B42+24j
		mov	eax, [ecx+4]
		mov	[esi+edx*8+4], eax
		jmp	short loc_10005B8B
; ---------------------------------------------------------------------------

loc_10005B81:				; CODE XREF: sub_10005B42+1Fj
		cmp	[esi+edx*8], ecx
		jnz	short loc_10005B8E
		mov	eax, [ecx]
		mov	[esi+edx*8], eax

loc_10005B8B:				; CODE XREF: sub_10005B42+34j
					; sub_10005B42+3Dj
		mov	ecx, [ebp+arg_4]

loc_10005B8E:				; CODE XREF: sub_10005B42+42j
		push	ecx
		push	[ebp+arg_0]
		mov	ecx, edi
		call	sub_10005CAE
		mov	eax, [ebp+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		retn	8
sub_10005B42	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005BA2	proc near		; CODE XREF: sub_10005A2B+3Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		mov	esi, ecx
		push	edi
		call	sub_10005C77
		mov	ecx, [esi+8]
		mov	esi, [esi]
		lea	ebx, [eax+eax]
		mov	edx, [ecx+eax*8]

loc_10005BBF:				; CODE XREF: sub_10005BA2+39j
		cmp	[ecx+ebx*4], esi
		jnz	short loc_10005BC8
		mov	eax, esi
		jmp	short loc_10005BCE
; ---------------------------------------------------------------------------

loc_10005BC8:				; CODE XREF: sub_10005BA2+20j
		mov	eax, [ecx+ebx*4+4]
		mov	eax, [eax]

loc_10005BCE:				; CODE XREF: sub_10005BA2+24j
		cmp	edx, eax
		jz	short loc_10005BF6
		mov	eax, [edx+8]
		cmp	eax, [edi]
		jz	short loc_10005BDD
		mov	edx, [edx]
		jmp	short loc_10005BBF
; ---------------------------------------------------------------------------

loc_10005BDD:				; CODE XREF: sub_10005BA2+35j
		mov	eax, [edi]
		cmp	eax, [edx+8]
		lea	eax, [ebp+arg_4]
		mov	[ebp+arg_4], esi
		jnz	short loc_10005BED
		mov	[ebp+arg_4], edx

loc_10005BED:				; CODE XREF: sub_10005BA2+46j
		mov	ecx, [ebp+arg_0]
		mov	eax, [eax]
		mov	[ecx], eax
		jmp	short loc_10005BFB
; ---------------------------------------------------------------------------

loc_10005BF6:				; CODE XREF: sub_10005BA2+2Ej
		mov	ecx, [ebp+arg_0]
		mov	[ecx], esi

loc_10005BFB:				; CODE XREF: sub_10005BA2+52j
		pop	edi
		pop	esi
		mov	eax, ecx
		pop	ebx
		pop	ecx
		pop	ebp
		retn	8
sub_10005BA2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005C05	proc near		; CODE XREF: sub_10005965+60p
					; sub_10005A2B+35p ...

var_1		= byte ptr -1

		push	ecx
		mov	eax, dword_10031CE0
		push	ebx
		push	esi
		test	eax, 0FFFFFFFEh
		jnz	short loc_10005C6E
		mov	ecx, offset dword_10031CE0
		call	sub_10002F37
		test	al, al
		jz	short loc_10005C6E
		xor	ebx, ebx
		push	ebx
		push	ebx
		mov	[esp+14h+var_1], bl
		mov	dword_10031CE4,	ebx
		mov	dword_10031CE8,	ebx
		call	sub_10005F29
		fld1
		mov	esi, offset dword_10031CE4
		push	8
		mov	ecx, esi
		mov	dword_10031CE4,	eax
		fstp	flt_10031D00
		mov	dword_10031CEC,	ebx
		mov	dword_10031CF0,	ebx
		mov	dword_10031CF4,	ebx
		call	sub_10005CE5
		mov	dword_10031CE0,	esi

loc_10005C6E:				; CODE XREF: sub_10005C05+Dj
					; sub_10005C05+1Bj
		mov	eax, dword_10031CE0
		pop	esi
		pop	ebx
		pop	ecx
		retn
sub_10005C05	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005C77	proc near		; CODE XREF: sub_10005B42+Ep
					; sub_10005BA2+Dp ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	eax, [ebp+arg_0]
		and	[ebp+var_4], 0
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+arg_0]
		mov	eax, [eax]
		push	edi
		mov	[ebp+arg_0], eax
		mov	edi, [esi+14h]
		call	sub_10002EE8
		and	eax, edi
		cmp	[esi+18h], eax
		ja	short loc_10005CA6
		shr	edi, 1
		or	ecx, 0FFFFFFFFh
		sub	ecx, edi
		add	eax, ecx

loc_10005CA6:				; CODE XREF: sub_10005C77+24j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005C77	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005CAE	proc near		; CODE XREF: sub_10005B42+52p
					; sub_1000600F+8Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		push	esi
		push	edi
		mov	edi, ecx
		mov	edx, [eax]
		mov	[esp+8+arg_4], edx
		mov	esi, [eax+4]
		mov	edx, [eax]
		push	eax
		mov	[esi], edx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		dec	dword ptr [edi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+0Ch+arg_0]
		pop	ecx
		mov	ecx, [esp+8+arg_4]
		pop	edi
		mov	[eax], ecx
		pop	esi
		retn	8
sub_10005CAE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10005CE5	proc near		; CODE XREF: sub_10005C05+5Ep
					; sub_100060EC+62p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		push	edi
		mov	edi, ecx
		push	edx
		lea	edx, [esi+esi]
		push	edx
		mov	eax, [edi]
		lea	ecx, [edi+8]
		mov	[ebp+var_4], eax
		mov	eax, [ecx]
		push	eax
		mov	[ecx+4], eax
		lea	eax, [ebp+arg_0]
		push	eax
		call	sub_10005D20
		lea	eax, [esi-1]
		mov	[edi+18h], esi
		mov	[edi+14h], eax
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10005CE5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005D20	proc near		; CODE XREF: sub_10005CE5+25p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		mov	eax, [esp+8+arg_4]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	edi, eax
		sub	edi, [ebp+0]
		sar	edi, 2
		mov	[esp+18h+var_4], edi
		mov	edi, [esp+18h+arg_8]
		test	edi, edi
		jz	loc_10005F10
		mov	esi, [ebp+8]
		mov	ecx, esi
		mov	ebx, [ebp+4]
		sub	ecx, ebx
		sar	ecx, 2
		cmp	ecx, edi
		jnb	loc_10005E52
		sub	ebx, [ebp+0]
		mov	ecx, 3FFFFFFFh
		sar	ebx, 2
		sub	ecx, ebx
		cmp	ecx, edi
		jnb	short loc_10005D75
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10005D75:				; CODE XREF: sub_10005D20+48j
		sub	esi, [ebp+0]
		lea	ecx, [ebx+edi]
		sar	esi, 2
		xor	ebx, ebx
		mov	[esp+18h+var_8], ecx
		mov	edx, esi
		shr	edx, 1
		mov	ecx, 3FFFFFFFh
		sub	ecx, edx
		cmp	ecx, esi
		jnb	short loc_10005D97
		mov	esi, ebx
		jmp	short loc_10005D99
; ---------------------------------------------------------------------------

loc_10005D97:				; CODE XREF: sub_10005D20+71j
		add	esi, edx

loc_10005D99:				; CODE XREF: sub_10005D20+75j
		mov	ecx, [esp+18h+var_8]
		cmp	esi, ecx
		jnb	short loc_10005DA3
		mov	esi, ecx

loc_10005DA3:				; CODE XREF: sub_10005D20+7Fj
		test	esi, esi
		jz	short loc_10005DCE
		cmp	esi, 3FFFFFFFh
		ja	loc_10005E4C
		mov	eax, esi
		shl	eax, 2
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	loc_10005E4C
		mov	eax, [esp+18h+arg_4]

loc_10005DCE:				; CODE XREF: sub_10005D20+85j
		mov	ecx, eax
		mov	edx, edi
		sub	ecx, [ebp+0]
		sar	ecx, 2
		mov	[esp+18h+var_8], ecx
		lea	ecx, [ebx+ecx*4]
		test	edi, edi
		jz	short loc_10005DFD
		mov	edi, [esp+18h+arg_C]

loc_10005DE7:				; CODE XREF: sub_10005D20+D3j
		test	ecx, ecx
		jz	short loc_10005DEF
		mov	eax, [edi]
		mov	[ecx], eax

loc_10005DEF:				; CODE XREF: sub_10005D20+C9j
		add	ecx, 4
		dec	edx
		jnz	short loc_10005DE7
		mov	eax, [esp+18h+arg_4]
		mov	edi, [esp+18h+arg_8]

loc_10005DFD:				; CODE XREF: sub_10005D20+C1j
		push	ebx
		push	eax
		push	dword ptr [ebp+0]
		call	sub_10005FD1
		mov	eax, [esp+18h+var_8]
		add	eax, edi
		lea	eax, [ebx+eax*4]
		push	eax
		push	dword ptr [ebp+4]
		push	[esp+20h+arg_4]
		call	sub_10005FD1
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		sar	eax, 2
		add	edi, eax
		cmp	dword ptr [ebp+0], 0
		jz	short loc_10005E38
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10005E38:				; CODE XREF: sub_10005D20+10Cj
		lea	eax, [ebx+esi*4]
		mov	[ebp+0], ebx
		mov	[ebp+8], eax
		lea	eax, [ebx+edi*4]
		mov	[ebp+4], eax
		jmp	loc_10005F10
; ---------------------------------------------------------------------------

loc_10005E4C:				; CODE XREF: sub_10005D20+8Dj
					; sub_10005D20+A4j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10005E52:				; CODE XREF: sub_10005D20+33j
		mov	esi, [esp+18h+arg_C]
		mov	ecx, ebx
		sub	ecx, eax
		sar	ecx, 2
		mov	esi, [esi]
		cmp	ecx, edi
		jnb	short loc_10005EC6
		mov	ecx, edi
		shl	ecx, 2
		mov	[esp+18h+arg_C], ecx
		add	ecx, eax
		push	ecx
		push	ebx
		push	eax
		call	sub_10005FD1
		mov	ecx, [ebp+4]
		mov	eax, ecx
		mov	edx, [esp+18h+arg_4]
		sub	eax, edx
		sar	eax, 2
		sub	edi, eax
		jz	short loc_10005E98

loc_10005E88:				; CODE XREF: sub_10005D20+172j
		test	ecx, ecx
		jz	short loc_10005E8E
		mov	[ecx], esi

loc_10005E8E:				; CODE XREF: sub_10005D20+16Aj
		add	ecx, 4
		dec	edi
		jnz	short loc_10005E88
		mov	edx, [esp+18h+arg_4]

loc_10005E98:				; CODE XREF: sub_10005D20+166j
		mov	eax, [esp+18h+arg_C]
		xor	edi, edi
		add	[ebp+4], eax
		mov	ecx, [ebp+4]
		sub	ecx, eax
		mov	eax, ecx
		sub	eax, edx
		add	eax, 3
		shr	eax, 2
		cmp	ecx, edx
		sbb	ecx, ecx
		not	ecx
		and	ecx, eax
		jz	short loc_10005F10

loc_10005EBA:				; CODE XREF: sub_10005D20+1A2j
		inc	edi
		mov	[edx], esi
		lea	edx, [edx+4]
		cmp	edi, ecx
		jnz	short loc_10005EBA
		jmp	short loc_10005F10
; ---------------------------------------------------------------------------

loc_10005EC6:				; CODE XREF: sub_10005D20+141j
		mov	eax, edi
		mov	edi, ebx
		shl	eax, 2
		push	ebx
		sub	edi, eax
		mov	[esp+1Ch+arg_C], eax
		push	ebx
		push	edi
		call	sub_10005FD1
		mov	ecx, [esp+18h+arg_4]
		mov	[ebp+4], eax
		cmp	ecx, edi
		jz	short loc_10005EF8
		sub	ebx, edi

loc_10005EE8:				; CODE XREF: sub_10005D20+1D6j
		sub	edi, 4
		mov	eax, [edi]
		mov	[edi+ebx], eax
		mov	ecx, [esp+18h+arg_4]
		cmp	ecx, edi
		jnz	short loc_10005EE8

loc_10005EF8:				; CODE XREF: sub_10005D20+1C4j
		mov	edx, [esp+18h+arg_C]
		lea	eax, [edx+ecx]
		jmp	short loc_10005F0C
; ---------------------------------------------------------------------------

loc_10005F01:				; CODE XREF: sub_10005D20+1EEj
		mov	[ecx], esi
		add	ecx, 4
		mov	eax, [esp+18h+arg_4]
		add	eax, edx

loc_10005F0C:				; CODE XREF: sub_10005D20+1DFj
		cmp	ecx, eax
		jnz	short loc_10005F01

loc_10005F10:				; CODE XREF: sub_10005D20+1Ej
					; sub_10005D20+127j ...
		mov	eax, [ebp+0]
		mov	ecx, [esp+18h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		lea	ecx, [eax+ecx*4]
		mov	eax, [esp+0Ch+arg_0]
		pop	ebx
		mov	[eax], ecx
		pop	ecx
		pop	ecx
		retn	10h
sub_10005D20	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F29	proc near		; CODE XREF: sub_10005C05+31p
					; sub_10005F5C+Ep

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	1Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_10005F3C
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10005F3C:				; CODE XREF: sub_10005F29+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_10005F4A
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_10005F4E
; ---------------------------------------------------------------------------

loc_10005F4A:				; CODE XREF: sub_10005F29+19j
		mov	edx, [esp+arg_4]

loc_10005F4E:				; CODE XREF: sub_10005F29+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_10005F59
		mov	[ecx], edx

locret_10005F59:			; CODE XREF: sub_10005F29+2Cj
		retn	8
sub_10005F29	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005F5C	proc near		; CODE XREF: sub_10005965+67p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	eax, [ebx]
		mov	ebp, [eax]
		push	dword ptr [ebp+4]
		push	ebp
		call	sub_10005F29
		mov	edx, eax
		lea	edi, [edx+8]
		test	edi, edi
		jz	short loc_10005F8A
		mov	esi, [esp+10h+arg_4]
		mov	ecx, [esi]
		add	esi, 4
		mov	[edi], ecx
		add	edi, 4
		movsd
		movsd
		movsd
		movsd

loc_10005F8A:				; CODE XREF: sub_10005F5C+1Aj
		mov	ecx, [ebx+4]
		mov	eax, 9249248h
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_10005FA4
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10005FA4:				; CODE XREF: sub_10005F5C+3Bj
		lea	eax, [ecx+1]
		mov	ecx, ebx
		mov	[ebx+4], eax
		mov	[ebp+4], edx
		mov	eax, [edx+4]
		mov	[eax], edx
		mov	eax, [ebx]
		mov	eax, [eax]
		push	eax
		add	eax, 8
		push	eax
		push	[esp+18h+arg_0]
		call	sub_1000600F
		mov	eax, [esp+10h+arg_0]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	8
sub_10005F5C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10005FD1	proc near		; CODE XREF: sub_10005D20+E2p
					; sub_10005D20+F8p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_4]
		mov	edx, [esp+arg_0]
		sub	eax, edx
		mov	ecx, [esp+arg_8]
		add	eax, 3
		push	esi
		xor	esi, esi
		shr	eax, 2
		cmp	[esp+4+arg_4], edx
		push	edi
		sbb	edi, edi
		not	edi
		and	edi, eax
		jz	short loc_10006008
		sub	edx, ecx

loc_10005FF7:				; CODE XREF: sub_10005FD1+35j
		test	ecx, ecx
		jz	short loc_10006000
		mov	eax, [edx+ecx]
		mov	[ecx], eax

loc_10006000:				; CODE XREF: sub_10005FD1+28j
		add	ecx, 4
		inc	esi
		cmp	esi, edi
		jnz	short loc_10005FF7

loc_10006008:				; CODE XREF: sub_10005FD1+22j
		pop	edi
		mov	eax, ecx
		pop	esi
		retn	0Ch
sub_10005FD1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000600F	proc near		; CODE XREF: sub_10005F5C+65p
					; sub_100060EC+81p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_4]
		push	edi
		mov	[esp+14h+var_4], ecx
		call	sub_10005C77
		mov	edx, [esp+10h+var_4]
		mov	ebx, eax
		mov	ecx, [edx+8]
		mov	esi, [edx]
		cmp	esi, [ecx+ebx*8]
		jz	short loc_10006050
		mov	esi, [ecx+ebx*8+4]
		mov	esi, [esi]
		cmp	esi, [ecx+ebx*8]
		jz	short loc_10006050
		mov	eax, [edi]

loc_10006043:				; CODE XREF: sub_1000600F+3Fj
		mov	esi, [esi+4]
		cmp	[esi+8], eax
		jz	short loc_10006094
		cmp	esi, [ecx+ebx*8]
		jnz	short loc_10006043

loc_10006050:				; CODE XREF: sub_1000600F+25j
					; sub_1000600F+30j
		mov	edi, [ebp+arg_8]
		mov	eax, [edi]
		cmp	esi, eax
		jz	short loc_1000607E
		mov	ecx, [edi+4]
		mov	[ecx], eax
		mov	ecx, [eax+4]
		mov	[ecx], esi
		mov	ecx, [esi+4]
		mov	[ecx], edi
		mov	edx, [esi+4]
		mov	ecx, [eax+4]
		mov	[esi+4], ecx
		mov	ecx, [edi+4]
		mov	[eax+4], ecx
		mov	[edi+4], edx
		mov	edx, [esp+10h+var_4]

loc_1000607E:				; CODE XREF: sub_1000600F+48j
		mov	ecx, [edx+8]
		mov	eax, [ecx+ebx*8]
		cmp	eax, [edx]
		jnz	short loc_100060AE
		mov	[ecx+ebx*8], edi
		mov	eax, [edx+8]
		mov	[eax+ebx*8+4], edi
		jmp	short loc_100060D3
; ---------------------------------------------------------------------------

loc_10006094:				; CODE XREF: sub_1000600F+3Aj
		push	[ebp+arg_8]
		lea	eax, [esp+14h+var_4]
		mov	ecx, edx
		push	eax
		call	sub_10005CAE
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0
		jmp	short loc_100060E3
; ---------------------------------------------------------------------------

loc_100060AE:				; CODE XREF: sub_1000600F+77j
		cmp	eax, esi
		jnz	short loc_100060B7
		mov	[ecx+ebx*8], edi
		jmp	short loc_100060D3
; ---------------------------------------------------------------------------

loc_100060B7:				; CODE XREF: sub_1000600F+A1j
		mov	eax, [ecx+ebx*8+4]
		mov	eax, [eax]
		mov	[ecx+ebx*8+4], eax
		cmp	eax, edi
		jz	short loc_100060D3
		mov	ecx, [edx+8]
		mov	eax, [ecx+ebx*8+4]
		mov	eax, [eax+4]
		mov	[ecx+ebx*8+4], eax

loc_100060D3:				; CODE XREF: sub_1000600F+83j
					; sub_1000600F+A6j ...
		mov	ecx, edx
		call	sub_100060EC
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		mov	byte ptr [eax+4], 1

loc_100060E3:				; CODE XREF: sub_1000600F+9Dj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000600F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100060EC	proc near		; CODE XREF: sub_1000600F+C6p

var_C		= byte ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		mov	ebx, ecx
		fld	dword ptr [ebx+1Ch]
		mov	eax, [ebx+4]
		mov	edx, [ebx+18h]
		fild	dword ptr [ebx+4]
		test	eax, eax
		jns	short loc_1000610B
		fadd	ds:flt_1002DB58

loc_1000610B:				; CODE XREF: sub_100060EC+17j
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		mov	[ebp+var_4], edx
		fild	[ebp+var_4]
		test	edx, edx
		jns	short loc_10006121
		fadd	ds:flt_1002DB58

loc_10006121:				; CODE XREF: sub_100060EC+2Dj
		fstp	[ebp+var_4]
		fdiv	[ebp+var_4]
		fstp	[ebp+var_4]
		fld	[ebp+var_4]
		fcompp
		fnstsw	ax
		test	ah, 41h
		jnz	short loc_10006178
		cmp	edx, 200h
		jnb	short loc_10006143
		shl	edx, 3
		jmp	short loc_1000614D
; ---------------------------------------------------------------------------

loc_10006143:				; CODE XREF: sub_100060EC+50j
		cmp	edx, 1FFFFFFFh
		jnb	short loc_1000614D
		add	edx, edx

loc_1000614D:				; CODE XREF: sub_100060EC+55j
					; sub_100060EC+5Dj
		push	edx
		call	sub_10005CE5
		mov	eax, [ebx]
		cmp	[eax], eax
		jz	short loc_10006178
		push	esi
		push	edi
		mov	edi, [eax+4]

loc_1000615E:				; CODE XREF: sub_100060EC+88j
		mov	esi, [ebx]
		mov	ecx, ebx
		mov	esi, [esi]
		push	esi
		lea	eax, [esi+8]
		push	eax
		lea	eax, [ebp+var_C]
		push	eax
		call	sub_1000600F
		cmp	esi, edi
		jnz	short loc_1000615E
		pop	edi
		pop	esi

loc_10006178:				; CODE XREF: sub_100060EC+48j
					; sub_100060EC+6Bj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_100060EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000617D(HANDLE hSourceHandle)
sub_1000617D	proc near		; CODE XREF: sub_100178B5+18Ep
					; sub_100178B5+19Ep

TargetHandle	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	edi
		mov	edi, ecx
		xor	eax, eax
		mov	[ebp+TargetHandle], eax
		mov	ebx, edx
		test	edi, edi
		jz	short loc_100061C3
		push	2		; dwOptions
		push	eax		; bInheritHandle
		push	eax		; dwDesiredAccess
		mov	[ebp+TargetHandle], eax
		lea	eax, [ebp+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	edi		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_100061B9
		xor	al, al
		jmp	short loc_100061C5
; ---------------------------------------------------------------------------

loc_100061B9:				; CODE XREF: sub_1000617D+36j
		push	[ebp+TargetHandle]
		mov	ecx, ebx
		call	sub_10004610

loc_100061C3:				; CODE XREF: sub_1000617D+12j
		mov	al, 1

loc_100061C5:				; CODE XREF: sub_1000617D+3Aj
		pop	edi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000617D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100061CB	proc near		; CODE XREF: sub_10006844+260p
					; sub_100083E3+586p ...
		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_10004646
		lea	ecx, [edi+4]
		call	sub_10004646
		and	dword ptr [edi+8], 0
		lea	ecx, [edi+4]
		and	dword ptr [edi+0Ch], 0
		call	sub_10004646
		mov	ecx, edi
		call	sub_10004646
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100061CB	endp


; =============== S U B	R O U T	I N E =======================================


sub_100061F8	proc near		; CODE XREF: sub_10006211+4p
					; sub_10007ECF+15p ...
		xor	eax, eax
		cmp	[ecx+8], eax
		jnz	short loc_1000620D
		cmp	[ecx], eax
		jnz	short loc_1000620D
		cmp	[ecx+0Ch], eax
		jnz	short loc_1000620D
		cmp	[ecx+4], eax
		jz	short locret_10006210

loc_1000620D:				; CODE XREF: sub_100061F8+5j
					; sub_100061F8+9j ...
		xor	eax, eax
		inc	eax

locret_10006210:			; CODE XREF: sub_100061F8+13j
		retn
sub_100061F8	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006211	proc near		; CODE XREF: sub_10006844+220p
					; sub_100178B5+107p ...

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100061F8
		test	al, al
		jz	short loc_10006233
		call	sub_10004646
		lea	ecx, [edi+4]
		call	sub_10004646
		and	dword ptr [edi+8], 0
		and	dword ptr [edi+0Ch], 0

loc_10006233:				; CODE XREF: sub_10006211+Bj
		mov	esi, [esp+8+arg_0]
		mov	ecx, edi
		push	dword ptr [esi]
		call	sub_10004610
		push	dword ptr [esi+4]
		lea	ecx, [edi+4]
		call	sub_10004610
		mov	eax, [esi+8]
		mov	[edi+8], eax
		mov	eax, [esi+0Ch]
		mov	[edi+0Ch], eax
		pop	edi
		pop	esi
		retn	4
sub_10006211	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000625C	proc near		; CODE XREF: sub_100083E3+571p
					; sub_100178B5+1CEp

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	esi
		mov	esi, [esp+0Ch+arg_0]
		xor	eax, eax
		push	edi
		mov	edi, esi
		mov	ebx, ecx
		stosd
		stosd
		stosd
		stosd
		call	sub_1000629D
		lea	ecx, [ebx+4]
		mov	[esi], eax
		call	sub_1000629D
		mov	ecx, [ebx+8]
		and	dword ptr [ebx+8], 0
		mov	[esi+8], ecx
		mov	ecx, [ebx+0Ch]
		and	dword ptr [ebx+0Ch], 0
		mov	[esi+4], eax
		mov	eax, esi
		pop	edi
		mov	[esi+0Ch], ecx
		pop	esi
		pop	ebx
		pop	ecx
		retn	4
sub_1000625C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000629D	proc near		; CODE XREF: sub_1000625C+12p
					; sub_1000625C+1Cp ...
		push	esi
		mov	esi, [ecx]
		and	dword ptr [ecx], 0
		test	esi, esi
		jz	short loc_100062B9
		cmp	esi, 0FFFFFFFFh
		jz	short loc_100062B9
		push	ecx
		push	ecx
		mov	edx, ecx
		mov	ecx, esi
		call	sub_10005A2B
		pop	ecx
		pop	ecx

loc_100062B9:				; CODE XREF: sub_1000629D+8j
					; sub_1000629D+Dj
		mov	eax, esi
		pop	esi
		retn
sub_1000629D	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100062BD(void *)
sub_100062BD	proc near		; CODE XREF: sub_100083E3+22Ep
		push	ebx
		push	esi
		push	edi
		push	48h
		pop	esi
		push	esi		; size_t
		mov	ebx, ecx
		push	0		; int
		push	ebx		; void *
		call	memset
		add	esp, 0Ch
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jge	short loc_100062E3
		mov	dword ptr [ebx], 44h
		jmp	short loc_1000633A
; ---------------------------------------------------------------------------

loc_100062E3:				; CODE XREF: sub_100062BD+1Cj
		cmp	dword_10031F2C,	0
		mov	[ebx], esi
		jz	short loc_10006300
		cmp	dword_10031F28,	0
		jz	short loc_10006300
		cmp	dword_10031F30,	0
		jnz	short loc_1000633A

loc_10006300:				; CODE XREF: sub_100062BD+2Fj
					; sub_100062BD+38j
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		mov	esi, ds:GetProcAddress
		mov	edi, eax
		push	offset ProcName	; "InitializeProcThreadAttributeList"
		push	edi		; hModule
		call	esi ; GetProcAddress
		push	offset aUpdateprocthre ; "UpdateProcThreadAttribute"
		push	edi		; hModule
		mov	dword_10031F2C,	eax
		call	esi ; GetProcAddress
		push	offset aDeleteprocthre ; "DeleteProcThreadAttributeList"
		push	edi		; hModule
		mov	dword_10031F28,	eax
		call	esi ; GetProcAddress
		mov	dword_10031F30,	eax

loc_1000633A:				; CODE XREF: sub_100062BD+24j
					; sub_100062BD+41j
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn
sub_100062BD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006340	proc near		; CODE XREF: sub_100083E3+306p

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		cmp	dword ptr [esi], 48h
		jnz	short loc_10006397
		xor	edi, edi
		cmp	[esi+44h], edi
		jnz	short loc_10006397
		lea	eax, [ebp+var_4]
		mov	[ebp+var_4], edi
		push	eax
		push	edi
		push	[ebp+arg_0]
		push	edi
		call	dword_10031F2C
		cmp	[ebp+var_4], edi
		jz	short loc_10006397
		push	[ebp+var_4]
		call	sub_10018CBA
		pop	ecx
		lea	ecx, [ebp+var_4]
		mov	[esi+44h], eax
		push	ecx
		push	edi
		push	[ebp+arg_0]
		push	eax
		call	dword_10031F2C
		test	eax, eax
		jnz	short loc_100063A1
		push	dword ptr [esi+44h]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		mov	[esi+44h], edi

loc_10006397:				; CODE XREF: sub_10006340+Bj
					; sub_10006340+12j ...
		xor	al, al

loc_10006399:				; CODE XREF: sub_10006340+63j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_100063A1:				; CODE XREF: sub_10006340+48j
		mov	al, 1
		jmp	short loc_10006399
sub_10006340	endp


; =============== S U B	R O U T	I N E =======================================


sub_100063A5	proc near		; CODE XREF: sub_100083E3+32Dp
					; sub_100083E3+35Dp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		cmp	dword ptr [ecx+44h], 0
		jnz	short loc_100063AF
		xor	al, al
		jmp	short locret_100063CF
; ---------------------------------------------------------------------------

loc_100063AF:				; CODE XREF: sub_100063A5+4j
		xor	eax, eax
		push	eax
		push	eax
		push	[esp+8+arg_8]
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		push	eax
		push	dword ptr [ecx+44h]
		call	dword_10031F28
		neg	eax
		sbb	eax, eax
		neg	eax

locret_100063CF:			; CODE XREF: sub_100063A5+8j
		retn	0Ch
sub_100063A5	endp


; =============== S U B	R O U T	I N E =======================================


sub_100063D2	proc near		; CODE XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+2Fp
					; sub_100062BD+14p ...
		cmp	dword_10031F8C,	0
		push	esi
		jnz	short loc_1000641F
		push	44h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100063F4
		mov	ecx, eax
		call	sub_10006426
		mov	esi, eax
		jmp	short loc_100063F6
; ---------------------------------------------------------------------------

loc_100063F4:				; CODE XREF: sub_100063D2+15j
		xor	esi, esi

loc_100063F6:				; CODE XREF: sub_100063D2+20j
		mov	ecx, esi
		mov	edx, offset dword_10031F8C
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_1000641F
		test	esi, esi
		jz	short loc_1000641F
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+2Ch]
		call	sub_1000189A
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000641F:				; CODE XREF: sub_100063D2+8j
					; sub_100063D2+33j ...
		mov	eax, dword_10031F8C
		pop	esi
		retn
sub_100063D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10006426	proc near		; CODE XREF: sub_100063D2+19p

var_154		= dword	ptr -154h
var_150		= dword	ptr -150h
SystemInfo	= _SYSTEM_INFO ptr -14Ch
VersionInformation= _OSVERSIONINFOW ptr	-128h
var_14		= word ptr -14h
var_12		= word ptr -12h
var_10		= word ptr -10h
var_E		= byte ptr -0Eh
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 158h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+158h+var_4], eax
		and	[esp+158h+var_154], 0
		push	esi
		mov	esi, ecx
		push	edi
		and	dword ptr [esi], 0
		mov	dword ptr [esi+1Ch], 3
		call	ds:GetCurrentProcess
		push	offset aIswow64process ; "IsWow64Process"
		push	offset ModuleName ; "kernel32.dll"
		mov	edi, eax
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10006495
		and	[esp+160h+var_150], 0
		lea	ecx, [esp+160h+var_150]
		push	ecx
		push	edi
		call	eax
		test	eax, eax
		jnz	short loc_1000648C
		push	2
		pop	eax
		jmp	short loc_10006495
; ---------------------------------------------------------------------------

loc_1000648C:				; CODE XREF: sub_10006426+5Fj
		xor	eax, eax
		cmp	[esp+160h+var_150], eax
		setnz	al

loc_10006495:				; CODE XREF: sub_10006426+4Ej
					; sub_10006426+64j
		mov	[esi+28h], eax
		xor	eax, eax
		mov	[esi+3Ch], eax
		push	118h		; size_t
		push	eax		; int
		mov	dword ptr [esi+40h], 0Fh
		mov	[esi+2Ch], al
		lea	eax, [esp+168h+VersionInformation.dwMajorVersion]
		push	eax		; void *
		mov	[esp+16Ch+VersionInformation.dwOSVersionInfoSize], 11Ch
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+160h+VersionInformation]
		push	eax		; lpVersionInformation
		call	ds:GetVersionExW
		mov	eax, [esp+160h+VersionInformation.dwBuildNumber]
		mov	edx, [esp+160h+VersionInformation.dwMajorVersion]
		mov	ecx, [esp+160h+VersionInformation.dwMinorVersion]
		push	6
		mov	[esi+0Ch], eax
		pop	eax
		push	5
		pop	edi
		mov	[esi+4], edx
		mov	[esi+8], ecx
		cmp	edx, edi
		jnz	short loc_100064FD
		test	ecx, ecx
		jle	short loc_10006528
		xor	eax, eax
		cmp	ecx, 1
		setnz	al
		inc	eax

loc_100064F9:				; CODE XREF: sub_10006426+E4j
		mov	[esi], eax
		jmp	short loc_10006528
; ---------------------------------------------------------------------------

loc_100064FD:				; CODE XREF: sub_10006426+C4j
		cmp	edx, eax
		jnz	short loc_10006520
		sub	ecx, 0
		jz	short loc_10006518
		dec	ecx
		jz	short loc_10006510
		dec	ecx
		jnz	short loc_100064F9
		mov	[esi], edi
		jmp	short loc_10006528
; ---------------------------------------------------------------------------

loc_10006510:				; CODE XREF: sub_10006426+E1j
		mov	dword ptr [esi], 4
		jmp	short loc_10006528
; ---------------------------------------------------------------------------

loc_10006518:				; CODE XREF: sub_10006426+DEj
		mov	dword ptr [esi], 3
		jmp	short loc_10006528
; ---------------------------------------------------------------------------

loc_10006520:				; CODE XREF: sub_10006426+D9j
		jle	short loc_10006528
		mov	dword ptr [esi], 7

loc_10006528:				; CODE XREF: sub_10006426+C8j
					; sub_10006426+D5j ...
		movzx	eax, [esp+160h+var_14]
		lea	edi, [esp+160h+SystemInfo.dwPageSize]
		and	dword ptr [esp+160h+SystemInfo.u], 0
		mov	[esi+14h], eax
		movzx	eax, [esp+160h+var_12]
		push	8
		mov	[esi+18h], eax
		xor	eax, eax
		pop	ecx
		rep stosd
		lea	eax, [esp+160h+SystemInfo]
		push	eax		; lpSystemInfo
		call	ds:GetNativeSystemInfo
		mov	ecx, dword ptr [esp+160h+SystemInfo.u]
		movzx	eax, cx
		push	9
		pop	edx
		test	eax, eax
		jz	short loc_10006582
		cmp	eax, 6
		jz	short loc_10006579
		cmp	eax, edx
		jnz	short loc_10006586
		mov	dword ptr [esi+1Ch], 1
		jmp	short loc_10006586
; ---------------------------------------------------------------------------

loc_10006579:				; CODE XREF: sub_10006426+144j
		mov	dword ptr [esi+1Ch], 2
		jmp	short loc_10006586
; ---------------------------------------------------------------------------

loc_10006582:				; CODE XREF: sub_10006426+13Fj
		and	dword ptr [esi+1Ch], 0

loc_10006586:				; CODE XREF: sub_10006426+148j
					; sub_10006426+151j ...
		cmp	[esp+160h+VersionInformation.dwMajorVersion], 6
		mov	eax, [esp+160h+SystemInfo.dwNumberOfProcessors]
		mov	[esi+20h], eax
		mov	eax, [esp+160h+SystemInfo.dwAllocationGranularity]
		mov	[esi+24h], eax
		jnz	loc_1000662D
		push	offset aGetproductinfo ; "GetProductInfo"
		push	offset ModuleName ; "kernel32.dll"
		call	ds:GetModuleHandleW
		push	eax		; hModule
		call	ds:GetProcAddress
		lea	ecx, [esp+160h+var_154]
		push	ecx
		push	0
		push	0
		push	[esp+16Ch+VersionInformation.dwMinorVersion]
		push	[esp+170h+VersionInformation.dwMajorVersion]
		call	eax
		mov	eax, [esp+160h+var_154]
		cmp	eax, 0Fh
		ja	short loc_10006607
		cmp	eax, 0Ch
		jnb	short loc_10006624
		cmp	eax, 1
		jz	short loc_1000661B
		cmp	eax, 4
		jz	short loc_1000661B
		cmp	eax, 6
		jz	short loc_1000661B
		jbe	short loc_100065ED
		cmp	eax, 0Ah
		jbe	short loc_10006624

loc_100065ED:				; CODE XREF: sub_10006426+1C0j
					; sub_10006426+1E4j ...
		and	dword ptr [esi+10h], 0

loc_100065F1:				; CODE XREF: sub_10006426+1FCj
					; sub_10006426+205j ...
		mov	ecx, [esp+160h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10006607:				; CODE XREF: sub_10006426+1AAj
		cmp	eax, 11h
		jb	short loc_100065ED
		cmp	eax, 12h
		jbe	short loc_10006624
		cmp	eax, 19h
		jz	short loc_10006624
		cmp	eax, 30h
		jnz	short loc_100065ED

loc_1000661B:				; CODE XREF: sub_10006426+1B4j
					; sub_10006426+1B9j ...
		mov	dword ptr [esi+10h], 1
		jmp	short loc_100065F1
; ---------------------------------------------------------------------------

loc_10006624:				; CODE XREF: sub_10006426+1AFj
					; sub_10006426+1C5j ...
		mov	dword ptr [esi+10h], 2
		jmp	short loc_100065F1
; ---------------------------------------------------------------------------

loc_1000662D:				; CODE XREF: sub_10006426+173j
		cmp	[esp+160h+VersionInformation.dwMajorVersion], 5
		jnz	short loc_100065ED
		cmp	[esp+160h+VersionInformation.dwMinorVersion], 2
		jnz	short loc_10006660
		cmp	[esp+160h+var_E], 1
		jnz	short loc_1000664A
		cmp	cx, dx
		jz	short loc_1000661B

loc_1000664A:				; CODE XREF: sub_10006426+21Dj
		mov	ax, [esp+160h+var_10]
		not	ax
		movzx	eax, ax
		shr	eax, 0Eh
		and	eax, 2
		jmp	short loc_1000667B
; ---------------------------------------------------------------------------

loc_10006660:				; CODE XREF: sub_10006426+213j
		cmp	[esp+160h+VersionInformation.dwMinorVersion], 1
		jnz	short loc_100065ED
		mov	ax, [esp+160h+var_10]
		not	ax
		movzx	eax, ax
		shr	eax, 9
		and	eax, 1

loc_1000667B:				; CODE XREF: sub_10006426+238j
		mov	[esi+10h], eax
		jmp	loc_100065F1
sub_10006426	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006683	proc near		; DATA XREF: sub_10006844+12Bo

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	ecx, [eax+14h]
		and	ecx, 0FFFFF9FFh
		or	ecx, 800h
		mov	[eax+14h], ecx
		retn
sub_10006683	endp

; ---------------------------------------------------------------------------

loc_1000669A:				; DATA XREF: sub_10006844+126o
		mov	eax, [esp+4]
		or	dword ptr [eax+14h], 8
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_100066A3(HANDLE hProcess, LPCVOID lpBaseAddress)
sub_100066A3	proc near		; CODE XREF: sub_1000672E+10Ap

Buffer		= byte ptr -48h
lpBaseAddress	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
var_14		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		lea	eax, [ebp+NumberOfBytesRead]
		mov	esi, ecx
		push	eax		; lpNumberOfBytesRead
		push	30h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	edx		; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100066D0

loc_100066CC:				; CODE XREF: sub_100066A3+31j
					; sub_100066A3+37j ...
		xor	al, al
		jmp	short loc_1000671F
; ---------------------------------------------------------------------------

loc_100066D0:				; CODE XREF: sub_100066A3+27j
		cmp	[ebp+NumberOfBytesRead], 30h
		jnz	short loc_100066CC
		cmp	[ebp+var_2C], 0
		jnz	short loc_100066CC
		cmp	[ebp+var_1C], 0
		jnz	short loc_100066CC
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+lpBaseAddress] ; lpBaseAddress
		push	esi		; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100066CC
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100066CC
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	eax, [ebp+var_14]
		push	eax		; lpBuffer
		push	[ebp+var_20]	; lpBaseAddress
		push	esi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_100066CC
		cmp	[ebp+NumberOfBytesRead], 10h
		setz	al

loc_1000671F:				; CODE XREF: sub_100066A3+2Bj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100066A3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000672E	proc near		; CODE XREF: sub_1000E032+C0p

TargetHandle	= dword	ptr -40h
var_3C		= dword	ptr -3Ch
NumberOfBytesWritten= dword ptr	-38h
Buffer		= dword	ptr -34h
var_30		= byte ptr -30h
var_2C		= dword	ptr -2Ch

		sub	esp, 40h
		push	ebp
		push	esi
		push	edi
		xor	ebp, ebp
		mov	edi, ecx
		mov	[esp+4Ch+NumberOfBytesWritten],	ebp
		call	sub_100063D2
		cmp	dword ptr [eax+28h], 1
		jz	short loc_1000674E
		mov	al, 1
		jmp	loc_1000683D
; ---------------------------------------------------------------------------

loc_1000674E:				; CODE XREF: sub_1000672E+17j
		mov	esi, ds:CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		call	esi ; CreateEventW
		push	ebp		; lpName
		push	ebp		; bInitialState
		push	1		; bManualReset
		push	ebp		; lpEventAttributes
		mov	[edi+8], eax
		call	esi ; CreateEventW
		mov	[edi+0Ch], eax
		call	ds:GetCurrentProcess
		mov	ecx, [edi]
		mov	esi, eax
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		lea	eax, [esp+58h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ecx]	; hTargetProcessHandle
		push	dword ptr [edi+8] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10006795

loc_1000678E:				; CODE XREF: sub_1000672E+83j
					; sub_1000672E+9Dj ...
		xor	al, al
		jmp	loc_1000683D
; ---------------------------------------------------------------------------

loc_10006795:				; CODE XREF: sub_1000672E+5Ej
		mov	eax, [edi]
		lea	ecx, [esp+4Ch+var_3C]
		push	ebp		; dwOptions
		push	ebp		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	ecx		; lpTargetHandle
		push	dword ptr [eax]	; hTargetProcessHandle
		push	dword ptr [edi+0Ch] ; hSourceHandle
		push	esi		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000678E
		mov	eax, [edi]
		mov	ecx, 1000h
		push	40h		; flProtect
		push	ecx		; flAllocationType
		push	ecx		; dwSize
		push	ebp		; lpAddress
		push	dword ptr [eax]	; hProcess
		call	ds:VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000678E
		push	2Ch		; size_t
		lea	eax, [esp+50h+var_30]
		push	ebp		; int
		push	eax		; void *
		call	memset
		mov	eax, [esp+58h+TargetHandle]
		lea	ecx, [esp+58h+NumberOfBytesWritten]
		add	esp, 0Ch
		mov	[esp+4Ch+Buffer], eax
		mov	eax, [esp+4Ch+var_3C]
		mov	[esp+4Ch+var_2C], eax
		mov	eax, [edi]
		push	ecx		; lpNumberOfBytesWritten
		push	10h		; nSize
		lea	ecx, [esp+54h+Buffer]
		push	ecx		; lpBuffer
		push	esi		; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000678E
		cmp	[esp+4Ch+NumberOfBytesWritten],	10h
		jnz	loc_1000678E
		push	esi
		mov	ecx, edi
		call	sub_10006844
		test	al, al
		jz	loc_1000678E
		mov	ecx, edi
		call	sub_10006AFB
		test	al, al
		jz	loc_1000678E
		mov	eax, [edi]
		mov	edx, esi	; lpBaseAddress
		mov	ecx, [eax]	; hProcess
		call	sub_100066A3

loc_1000683D:				; CODE XREF: sub_1000672E+1Bj
					; sub_1000672E+62j
		pop	edi
		pop	esi
		pop	ebp
		add	esp, 40h
		retn
sub_1000672E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006844	proc near		; CODE XREF: sub_1000672E+E8p

hHandle		= dword	ptr -360h
var_35C		= dword	ptr -35Ch
var_358		= byte ptr -358h
var_354		= dword	ptr -354h
var_350		= dword	ptr -350h
ExitCode	= dword	ptr -34Ch
ProcessInformation= _PROCESS_INFORMATION ptr -348h
StartupInfo	= _STARTUPINFOW	ptr -338h
var_2F0		= byte ptr -2F0h
var_2E0		= byte ptr -2E0h
var_2D8		= byte ptr -2D8h
var_288		= byte ptr -288h
var_240		= dword	ptr -240h
var_238		= byte ptr -238h
var_230		= dword	ptr -230h
var_22C		= dword	ptr -22Ch
var_228		= dword	ptr -228h
var_214		= dword	ptr -214h
Filename	= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 360h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+360h+var_4], eax
		mov	eax, [esp+360h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+370h+var_350], eax
		xor	ebx, ebx
		push	104h		; nSize
		lea	eax, [esp+374h+Filename]
		mov	ebp, ecx
		push	eax		; lpFilename
		push	ebx		; hModule
		call	ds:GetModuleFileNameW
		lea	eax, [esp+370h+Filename]
		push	eax		; void *
		lea	ecx, [esp+374h+var_240]	; void *
		call	sub_10001C7F
		mov	ecx, offset asc_1002BB98 ; "\\"
		call	sub_10001AF3
		mov	esi, eax
		test	esi, esi
		jz	loc_10006936
		mov	ecx, [esp+370h+var_230]
		test	ecx, ecx
		jz	loc_10006936
		cmp	ecx, 0FFFFFFFFh
		jbe	short loc_100068C0
		or	ecx, 0FFFFFFFFh
		jmp	short loc_100068C1
; ---------------------------------------------------------------------------

loc_100068C0:				; CODE XREF: sub_10006844+75j
		dec	ecx

loc_100068C1:				; CODE XREF: sub_10006844+7Aj
		cmp	[esp+370h+var_22C], 8
		mov	edx, [esp+370h+var_240]
		mov	eax, edx
		jnb	short loc_100068DB
		lea	eax, [esp+370h+var_240]

loc_100068DB:				; CODE XREF: sub_10006844+8Ej
		lea	eax, [eax+ecx*2]

loc_100068DE:				; CODE XREF: sub_10006844+D9j
		test	esi, esi
		jz	short loc_10006903
		movzx	ebx, word ptr [eax]
		mov	edi, esi
		mov	ecx, offset asc_1002BB98 ; "\\"

loc_100068EC:				; CODE XREF: sub_10006844+B1j
		cmp	[ecx], bx
		jz	short loc_100068FD
		add	ecx, 2
		dec	edi
		jnz	short loc_100068EC
		xor	ebx, ebx
		mov	ecx, ebx
		jmp	short loc_100068FF
; ---------------------------------------------------------------------------

loc_100068FD:				; CODE XREF: sub_10006844+ABj
		xor	ebx, ebx

loc_100068FF:				; CODE XREF: sub_10006844+B7j
		test	ecx, ecx
		jnz	short loc_1000691F

loc_10006903:				; CODE XREF: sub_10006844+9Cj
		cmp	[esp+370h+var_22C], 8
		mov	ecx, edx
		jnb	short loc_10006916
		lea	ecx, [esp+370h+var_240]

loc_10006916:				; CODE XREF: sub_10006844+C9j
		cmp	eax, ecx
		jz	short loc_10006936
		sub	eax, 2
		jmp	short loc_100068DE
; ---------------------------------------------------------------------------

loc_1000691F:				; CODE XREF: sub_10006844+BDj
		cmp	[esp+370h+var_22C], 8
		jnb	short loc_10006930
		lea	edx, [esp+370h+var_240]

loc_10006930:				; CODE XREF: sub_10006844+E3j
		sub	eax, edx
		sar	eax, 1
		jmp	short loc_10006939
; ---------------------------------------------------------------------------

loc_10006936:				; CODE XREF: sub_10006844+5Dj
					; sub_10006844+6Cj ...
		or	eax, 0FFFFFFFFh

loc_10006939:				; CODE XREF: sub_10006844+F0j
		cmp	eax, 0FFFFFFFFh
		jz	loc_10006ACE
		inc	eax
		lea	ecx, [esp+370h+var_240]
		push	eax
		call	sub_10003B59
		push	ecx
		push	ecx
		lea	ecx, [esp+378h+var_2F0]
		call	sub_10006BCF
		push	[esp+370h+var_350]
		mov	eax, [ebp+0]
		push	ecx
		push	dword ptr [eax+8]
		push	ecx
		push	offset loc_1000669A
		push	offset sub_10006683
		lea	ecx, [esp+388h+var_2E0]
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(std::ios_base & (*)(std::ios_base	&))
		mov	edx, offset asc_1002BBC4 ; "\""
		mov	ecx, eax
		call	sub_1000742B
		lea	edx, [esp+378h+var_238]
		mov	ecx, eax
		call	sub_10007562
		mov	edx, offset aWow_helper_exe ; "wow_helper.exe\"	"
		mov	ecx, eax
		call	sub_1000742B
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		mov	ecx, eax
		call	sub_10007678
		pop	ecx
		mov	ecx, eax
		call	ds:??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::operator<<(ulong)
		lea	eax, [esp+370h+var_228]
		push	eax
		lea	ecx, [esp+374h+var_2D8]
		call	sub_1000726F
		cmp	[esp+370h+var_214], 8
		mov	eax, [esp+370h+var_228]
		jnb	short loc_100069F4
		lea	eax, [esp+370h+var_228]

loc_100069F4:				; CODE XREF: sub_10006844+1A7j
		push	eax		; wchar_t *
		call	ds:_wcsdup
		pop	ecx
		push	ebx
		push	1
		lea	ecx, [esp+378h+var_228]
		mov	esi, eax
		call	sub_10002311
		push	40h		; size_t
		lea	eax, [esp+374h+StartupInfo.lpReserved]
		push	ebx		; int
		push	eax		; void *
		call	memset
		xor	eax, eax
		mov	[esp+37Ch+StartupInfo.cb], 44h
		lea	edi, [esp+37Ch+ProcessInformation]
		add	esp, 0Ch
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+370h+ProcessInformation]
		push	eax		; lpProcessInformation
		lea	eax, [esp+374h+StartupInfo]
		push	eax		; lpStartupInfo
		push	ebx		; lpCurrentDirectory
		push	ebx		; lpEnvironment
		push	ebx		; dwCreationFlags
		push	ebx		; bInheritHandles
		push	ebx		; lpThreadAttributes
		push	ebx		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	ebx		; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_10006AA9
		lea	eax, [esp+370h+ProcessInformation]
		mov	[esp+370h+hHandle], ebx
		push	eax
		lea	ecx, [esp+374h+hHandle]
		mov	[esp+374h+var_35C], ebx
		mov	dword ptr [esp+374h+var_358], ebx
		mov	[esp+374h+var_354], ebx
		call	sub_10006211
		push	0FFFFFFFFh	; dwMilliseconds
		push	[esp+374h+hHandle] ; hHandle
		call	ds:WaitForSingleObject
		mov	edi, eax
		lea	eax, [esp+370h+ExitCode]
		push	eax		; lpExitCode
		push	[esp+374h+hHandle] ; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		setnz	al
		cmp	edi, 102h
		jz	short loc_10006AA0
		test	al, al
		jz	short loc_10006AA0
		cmp	[esp+370h+ExitCode], 0
		jnz	short loc_10006AA0
		mov	bl, 1

loc_10006AA0:				; CODE XREF: sub_10006844+24Dj
					; sub_10006844+251j ...
		lea	ecx, [esp+370h+hHandle]
		call	sub_100061CB

loc_10006AA9:				; CODE XREF: sub_10006844+205j
		test	esi, esi
		jz	short loc_10006AB5
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10006AB5:				; CODE XREF: sub_10006844+267j
		lea	ecx, [esp+370h+var_288]
		call	sub_10006C33
		lea	ecx, [esp+370h+var_288]
		call	ds:??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::~basic_ios<wchar_t,std::char_traits<wchar_t>>(void)

loc_10006ACE:				; CODE XREF: sub_10006844+F8j
		push	0
		push	1
		lea	ecx, [esp+378h+var_240]
		call	sub_10002311
		mov	ecx, [esp+370h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 360h
		retn	4
sub_10006844	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006AFB	proc near		; CODE XREF: sub_1000672E+F7p

NumberOfBytesRead= dword ptr -210h
Buffer		= byte ptr -20Ch
var_8		= dword	ptr -8

		sub	esp, 210h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+210h+var_8], eax
		and	[esp+210h+NumberOfBytesRead], 0
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4] ; hThread
		call	ds:ResumeThread
		cmp	eax, 1
		jnz	loc_10006BB1
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject
		mov	ebp, 102h
		jmp	short loc_10006BAD
; ---------------------------------------------------------------------------

loc_10006B3E:				; CODE XREF: sub_10006AFB+B4j
		cmp	eax, 80h
		jz	short loc_10006BB1
		push	dword ptr [esi+8] ; hEvent
		call	ds:ResetEvent
		test	eax, eax
		jz	short loc_10006BB1
		mov	eax, [esi]
		lea	ecx, [esp+21Ch+NumberOfBytesRead]
		push	ecx		; lpNumberOfBytesRead
		push	200h		; nSize
		lea	ecx, [esp+224h+Buffer]
		push	ecx		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [eax]	; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_10006B76

loc_10006B72:				; CODE XREF: sub_10006AFB+83j
		xor	bl, bl
		jmp	short loc_10006B91
; ---------------------------------------------------------------------------

loc_10006B76:				; CODE XREF: sub_10006AFB+75j
		cmp	[esp+21Ch+NumberOfBytesRead], 200h
		jnz	short loc_10006B72
		mov	eax, [esi]
		mov	bl, 1
		push	dword ptr [eax+4] ; hThread
		call	ds:SuspendThread
		test	eax, eax
		jnz	short loc_10006BB1

loc_10006B91:				; CODE XREF: sub_10006AFB+79j
		push	dword ptr [esi+0Ch] ; hEvent
		call	ds:SetEvent
		test	eax, eax
		jz	short loc_10006BB1
		test	bl, bl
		jnz	short loc_10006BCB
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [esi+8] ; hHandle
		call	ds:WaitForSingleObject

loc_10006BAD:				; CODE XREF: sub_10006AFB+41j
		cmp	eax, ebp
		jnz	short loc_10006B3E

loc_10006BB1:				; CODE XREF: sub_10006AFB+2Bj
					; sub_10006AFB+48j ...
		xor	al, al

loc_10006BB3:				; CODE XREF: sub_10006AFB+D2j
		mov	ecx, [esp+21Ch+var_8]
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 210h
		retn
; ---------------------------------------------------------------------------

loc_10006BCB:				; CODE XREF: sub_10006AFB+A5j
		mov	al, 1
		jmp	short loc_10006BB3
sub_10006AFB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006BCF	proc near		; CODE XREF: sub_10006844+115p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		mov	[esp+10h+var_4], ebx
		lea	ecx, [edi+68h]
		mov	dword ptr [edi], offset	dword_1002BBC8
		mov	dword ptr [edi+10h], offset dword_1002BC10
		call	ds:??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::basic_ios<wchar_t,std::char_traits<wchar_t>>(void)
		push	ebx
		lea	esi, [edi+18h]
		mov	ecx, edi
		push	esi
		call	ds:??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z ;	std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::basic_iostream<wchar_t,std::char_traits<wchar_t>>(std::basic_streambuf<wchar_t,std::char_traits<wchar_t>> *)
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	dword ptr [edi+eax], offset off_1002BC0C
		mov	eax, [edi]
		mov	ecx, [eax+4]
		lea	eax, [ecx-68h]
		mov	[ecx+edi-4], eax
		mov	ecx, esi
		call	ds:??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
		mov	eax, edi
		mov	[esi+38h], ebx
		pop	edi
		mov	[esi+3Ch], ebx
		mov	dword ptr [esi], offset	off_1002BBD0
		pop	esi
		pop	ebx
		pop	ecx
		retn	8
sub_10006BCF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C33	proc near		; CODE XREF: sub_10006844+278p
					; sub_1000784B-61Dp
		push	esi
		mov	esi, ecx
		mov	eax, [esi-68h]
		lea	ecx, [esi-50h]
		mov	eax, [eax+4]
		mov	dword ptr [eax+esi-68h], offset	off_1002BC0C
		mov	eax, [esi-68h]
		mov	edx, [eax+4]
		lea	eax, [edx-68h]
		mov	[edx+esi-6Ch], eax
		call	sub_10006C63
		lea	ecx, [esi-48h]
		pop	esi
		jmp	ds:??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ ; std::basic_iostream<wchar_t,std::char_traits<wchar_t>>::~basic_iostream<wchar_t,std::char_traits<wchar_t>>(void)
sub_10006C33	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006C63	proc near		; CODE XREF: sub_10006C33+21p
					; sub_10007252+3p
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 1
		mov	dword ptr [esi], offset	off_1002BBD0
		jz	short loc_10006C7E
		mov	eax, [esi+0Ch]
		push	dword ptr [eax]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10006C7E:				; CODE XREF: sub_10006C63+Dj
		mov	eax, [esi+0Ch]
		xor	ecx, ecx
		mov	[eax], ecx
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], ecx
		mov	eax, [esi+10h]
		mov	[eax], ecx
		mov	eax, [esi+20h]
		mov	[eax], ecx
		mov	eax, [esi+30h]
		mov	[eax], ecx
		and	dword ptr [esi+3Ch], 0FFFFFFFEh
		mov	[esi+38h], ecx
		mov	ecx, esi
		pop	esi
		jmp	ds:??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,std::char_traits<wchar_t>>(void)
sub_10006C63	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006CAE	proc near		; DATA XREF: .rdata:1002BBDCo

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	esi
		mov	esi, ecx
		test	byte ptr [esi+3Ch], 2
		jz	short loc_10006CC2
		mov	eax, 0FFFFh
		jmp	loc_10006E85
; ---------------------------------------------------------------------------

loc_10006CC2:				; CODE XREF: sub_10006CAE+8j
		push	ebp
		mov	bp, word ptr [esp+0Ch+arg_0]
		push	edi
		mov	edi, 0FFFFh
		cmp	di, bp
		jnz	short loc_10006CDA
		xor	eax, eax
		jmp	loc_10006E83
; ---------------------------------------------------------------------------

loc_10006CDA:				; CODE XREF: sub_10006CAE+23j
		test	byte ptr [esi+3Ch], 8
		jz	short loc_10006D08
		mov	edi, [esi+20h]
		mov	ecx, [edi]
		test	ecx, ecx
		jz	short loc_10006D03
		mov	edx, [esi+38h]
		cmp	ecx, edx
		jnb	short loc_10006D03
		mov	eax, [esi+30h]
		mov	eax, [eax]
		mov	[edi], edx
		lea	ecx, [ecx+eax*2]
		mov	eax, [esi+30h]
		sub	ecx, edx
		sar	ecx, 1
		mov	[eax], ecx

loc_10006D03:				; CODE XREF: sub_10006CAE+39j
					; sub_10006CAE+40j
		mov	edi, 0FFFFh

loc_10006D08:				; CODE XREF: sub_10006CAE+30j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		test	edx, edx
		jz	short loc_10006D30
		mov	ecx, [esi+30h]
		mov	ecx, [ecx]
		lea	ecx, [edx+ecx*2]
		cmp	edx, ecx
		jnb	short loc_10006D30
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp
		jmp	loc_10006E83
; ---------------------------------------------------------------------------

loc_10006D30:				; CODE XREF: sub_10006CAE+61j
					; sub_10006CAE+6Dj
		push	ebx
		test	edx, edx
		jnz	short loc_10006D39
		xor	ebx, ebx
		jmp	short loc_10006D49
; ---------------------------------------------------------------------------

loc_10006D39:				; CODE XREF: sub_10006CAE+85j
		mov	eax, [esi+30h]
		mov	ebx, [eax]
		mov	eax, [esi+0Ch]
		add	ebx, ebx
		sub	ebx, [eax]
		add	ebx, edx
		sar	ebx, 1

loc_10006D49:				; CODE XREF: sub_10006CAE+89j
		mov	eax, ebx
		push	20h
		shr	eax, 1
		pop	ecx
		cmp	eax, ecx
		jb	short loc_10006D5A
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_10006D6D

loc_10006D5A:				; CODE XREF: sub_10006CAE+A4j
					; sub_10006CAE+B9j
		mov	eax, 7FFFFFFFh
		sub	eax, ecx
		cmp	eax, ebx
		jnb	short loc_10006D69
		shr	ecx, 1
		jnz	short loc_10006D5A

loc_10006D69:				; CODE XREF: sub_10006CAE+B5j
		test	ecx, ecx
		jnz	short loc_10006D75

loc_10006D6D:				; CODE XREF: sub_10006CAE+AAj
		mov	ax, di
		jmp	loc_10006E82
; ---------------------------------------------------------------------------

loc_10006D75:				; CODE XREF: sub_10006CAE+BDj
		lea	eax, [ecx+ebx]
		push	eax
		mov	[esp+18h+var_4], eax
		call	sub_10002657
		mov	ecx, [esi+0Ch]
		mov	edi, eax
		mov	ecx, [ecx]
		mov	[esp+14h+arg_0], ecx
		test	ebx, ebx
		jz	short loc_10006DA4
		mov	edx, ecx	; void *
		mov	ecx, edi	; void *
		push	ebx		; int
		call	sub_10001B13
		pop	ecx
		mov	ecx, [esp+14h+arg_0]
		test	ebx, ebx
		jnz	short loc_10006DE0

loc_10006DA4:				; CODE XREF: sub_10006CAE+E1j
		mov	eax, [esi+10h]
		mov	ecx, [esp+14h+var_4]
		mov	ebx, [esp+14h+arg_0]
		add	ecx, ecx
		mov	[esi+38h], edi
		mov	[eax], edi
		mov	eax, [esi+20h]
		sar	ecx, 1
		mov	[eax], edi
		mov	eax, [esi+30h]
		mov	[eax], ecx
		mov	eax, [esi+0Ch]
		test	byte ptr [esi+3Ch], 4
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		jnz	short loc_10006E2F
		mov	[eax], edi
		mov	eax, [esi+2Ch]
		mov	dword ptr [eax], 1
		jmp	loc_10006E62
; ---------------------------------------------------------------------------

loc_10006DE0:				; CODE XREF: sub_10006CAE+F4j
		mov	eax, [esi+38h]
		sub	eax, ecx
		mov	ebx, [esp+14h+arg_0]
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[esi+38h], eax
		mov	eax, [esi+20h]
		mov	eax, [eax]
		sub	eax, ecx
		mov	ecx, [esi+10h]
		sar	eax, 1
		lea	edx, [edi+eax*2]
		mov	eax, [ecx]
		sub	eax, ebx
		sar	eax, 1
		lea	eax, [edi+eax*2]
		mov	[ecx], eax
		mov	eax, [esi+20h]
		mov	ecx, [esp+14h+var_4]
		add	ecx, ecx
		sub	ecx, edx
		mov	[eax], edx
		add	ecx, edi
		mov	eax, [esi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		test	byte ptr [esi+3Ch], 4
		jz	short loc_10006E3B
		mov	eax, [esi+0Ch]
		mov	[eax], edi
		mov	eax, [esi+1Ch]

loc_10006E2F:				; CODE XREF: sub_10006CAE+120j
		and	dword ptr [eax], 0
		mov	eax, [esi+2Ch]
		sar	edi, 1
		mov	[eax], edi
		jmp	short loc_10006E62
; ---------------------------------------------------------------------------

loc_10006E3B:				; CODE XREF: sub_10006CAE+177j
		mov	eax, [esi+20h]
		mov	edx, [eax]
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		sub	eax, ebx
		sar	eax, 1
		lea	ecx, [edi+eax*2]
		mov	eax, [esi+0Ch]
		sub	edx, ecx
		add	edx, 2
		sar	edx, 1
		mov	[eax], edi
		mov	eax, [esi+1Ch]
		mov	[eax], ecx
		mov	eax, [esi+2Ch]
		mov	[eax], edx

loc_10006E62:				; CODE XREF: sub_10006CAE+12Dj
					; sub_10006CAE+18Bj
		test	byte ptr [esi+3Ch], 1
		jz	short loc_10006E70
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10006E70:				; CODE XREF: sub_10006CAE+1B8j
		or	dword ptr [esi+3Ch], 1
		mov	ecx, esi
		call	ds:?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Pninc(void)
		mov	[eax], bp
		mov	ax, bp

loc_10006E82:				; CODE XREF: sub_10006CAE+C2j
		pop	ebx

loc_10006E83:				; CODE XREF: sub_10006CAE+27j
					; sub_10006CAE+7Dj
		pop	edi
		pop	ebp

loc_10006E85:				; CODE XREF: sub_10006CAE+Fj
		pop	esi
		pop	ecx
		retn	4
sub_10006CAE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006E8A	proc near		; DATA XREF: .rdata:1002BBE0o

arg_0		= word ptr  4

		push	ebx
		push	esi
		mov	esi, ecx
		mov	ebx, 0FFFFh
		push	edi
		mov	eax, [esi+1Ch]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_10006EDA
		mov	eax, [esi+0Ch]
		cmp	ecx, [eax]
		jbe	short loc_10006EDA
		mov	di, [esp+0Ch+arg_0]
		cmp	bx, di
		jz	short loc_10006EBA
		cmp	di, [ecx-2]
		jz	short loc_10006EBA
		test	byte ptr [esi+3Ch], 2
		jnz	short loc_10006EDA

loc_10006EBA:				; CODE XREF: sub_10006E8A+22j
					; sub_10006E8A+28j
		push	0FFFFFFFFh
		mov	ecx, esi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		cmp	bx, di
		jz	short loc_10006ED6
		mov	eax, [esi+1Ch]
		mov	eax, [eax]
		mov	[eax], di
		movzx	eax, di
		jmp	short loc_10006EDD
; ---------------------------------------------------------------------------

loc_10006ED6:				; CODE XREF: sub_10006E8A+3Dj
		xor	eax, eax
		jmp	short loc_10006EDD
; ---------------------------------------------------------------------------

loc_10006EDA:				; CODE XREF: sub_10006E8A+11j
					; sub_10006E8A+18j ...
		mov	ax, bx

loc_10006EDD:				; CODE XREF: sub_10006E8A+4Aj
					; sub_10006E8A+4Ej
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10006E8A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006EE3	proc near		; DATA XREF: .rdata:1002BBE8o
		mov	edx, ecx
		push	esi
		push	edi
		mov	edi, [edx+1Ch]
		mov	esi, [edi]
		test	esi, esi
		jnz	short loc_10006EF7
		mov	eax, 0FFFFh
		jmp	short loc_10006F42
; ---------------------------------------------------------------------------

loc_10006EF7:				; CODE XREF: sub_10006EE3+Bj
		push	ebx
		mov	ebx, [edx+2Ch]
		mov	ecx, [ebx]
		lea	ecx, [esi+ecx*2]
		cmp	esi, ecx
		jnb	short loc_10006F09
		mov	ax, [esi]
		jmp	short loc_10006F41
; ---------------------------------------------------------------------------

loc_10006F09:				; CODE XREF: sub_10006EE3+1Fj
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_10006F3C
		mov	eax, [edx+20h]
		mov	eax, [eax]
		test	eax, eax
		jz	short loc_10006F3C
		cmp	eax, esi
		ja	short loc_10006F21
		cmp	[edx+38h], esi
		jbe	short loc_10006F3C

loc_10006F21:				; CODE XREF: sub_10006EE3+37j
		cmp	[edx+38h], eax
		jnb	short loc_10006F29
		mov	[edx+38h], eax

loc_10006F29:				; CODE XREF: sub_10006EE3+41j
		mov	eax, [edx+38h]
		sub	eax, [edi]
		sar	eax, 1
		mov	[ebx], eax
		mov	eax, [edx+1Ch]
		mov	eax, [eax]
		mov	ax, [eax]
		jmp	short loc_10006F41
; ---------------------------------------------------------------------------

loc_10006F3C:				; CODE XREF: sub_10006EE3+2Aj
					; sub_10006EE3+33j ...
		mov	eax, 0FFFFh

loc_10006F41:				; CODE XREF: sub_10006EE3+24j
					; sub_10006EE3+57j
		pop	ebx

loc_10006F42:				; CODE XREF: sub_10006EE3+12j
		pop	edi
		pop	esi
		retn
sub_10006EE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_10006F45	proc near		; DATA XREF: .rdata:1002BBF8o

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h

		push	ecx
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	edx, [ebx+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_10006F5D
		cmp	[ebx+38h], eax
		jnb	short loc_10006F5D
		mov	[ebx+38h], eax

loc_10006F5D:				; CODE XREF: sub_10006F45+Ej
					; sub_10006F45+13j
		test	[esp+14h+arg_10], 1
		jz	loc_1000703C
		mov	eax, [ebx+1Ch]
		mov	esi, [eax]
		mov	[esp+14h+var_4], esi
		test	esi, esi
		jz	loc_1000703C
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10006F8D
		mov	eax, [ebx+38h]
		jmp	short loc_10006F9B
; ---------------------------------------------------------------------------

loc_10006F8D:				; CODE XREF: sub_10006F45+41j
		cmp	eax, 1
		jnz	short loc_10006FB1
		test	[esp+14h+arg_10], 2
		jnz	short loc_10006FB5
		mov	eax, esi

loc_10006F9B:				; CODE XREF: sub_10006F45+46j
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10006FC5
; ---------------------------------------------------------------------------

loc_10006FB1:				; CODE XREF: sub_10006F45+4Bj
		test	eax, eax
		jz	short loc_10006FBD

loc_10006FB5:				; CODE XREF: sub_10006F45+52j
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10006FC5
; ---------------------------------------------------------------------------

loc_10006FBD:				; CODE XREF: sub_10006F45+6Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10006FC5:				; CODE XREF: sub_10006F45+6Aj
					; sub_10006F45+76j
		test	edi, edi
		jl	loc_100070CA
		jg	short loc_10006FD7
		test	esi, esi
		jb	loc_100070CA

loc_10006FD7:				; CODE XREF: sub_10006F45+88j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	loc_100070CA
		jl	short loc_10006FF6
		cmp	esi, eax
		ja	loc_100070CA

loc_10006FF6:				; CODE XREF: sub_10006F45+A7j
		sub	ecx, [esp+14h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+14h+arg_10], 2
		jz	loc_100070EA
		mov	edx, [ebx+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_100070EA
		mov	eax, [ebx+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [ebx+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [ebx+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	loc_100070EA
; ---------------------------------------------------------------------------

loc_1000703C:				; CODE XREF: sub_10006F45+1Dj
					; sub_10006F45+2Ej
		test	[esp+14h+arg_10], 2
		jz	loc_100070D2
		cmp	dword ptr [edx], 0
		jz	loc_100070D2
		mov	eax, [esp+14h+arg_C]
		mov	ebp, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		cmp	eax, 2
		jnz	short loc_10007064
		mov	eax, [ebx+38h]
		jmp	short loc_1000706B
; ---------------------------------------------------------------------------

loc_10007064:				; CODE XREF: sub_10006F45+118j
		cmp	eax, 1
		jnz	short loc_10007081
		mov	eax, [edx]

loc_1000706B:				; CODE XREF: sub_10006F45+11Dj
		mov	ecx, [ebx+0Ch]
		mov	esi, [esp+14h+arg_4]
		mov	edi, [esp+14h+arg_8]
		sub	eax, [ecx]
		sar	eax, 1
		cdq
		add	esi, eax
		adc	edi, edx
		jmp	short loc_10007095
; ---------------------------------------------------------------------------

loc_10007081:				; CODE XREF: sub_10006F45+122j
		test	eax, eax
		jz	short loc_1000708D
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_10007095
; ---------------------------------------------------------------------------

loc_1000708D:				; CODE XREF: sub_10006F45+13Ej
		mov	edi, [esp+14h+arg_8]
		mov	esi, [esp+14h+arg_4]

loc_10007095:				; CODE XREF: sub_10006F45+13Aj
					; sub_10006F45+146j
		test	edi, edi
		jl	short loc_100070CA
		jg	short loc_1000709F
		test	esi, esi
		jb	short loc_100070CA

loc_1000709F:				; CODE XREF: sub_10006F45+154j
		mov	eax, [ebx+0Ch]
		mov	ecx, [eax]
		mov	eax, [ebx+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	edi, edx
		jg	short loc_100070CA
		jl	short loc_100070B6
		cmp	esi, eax
		ja	short loc_100070CA

loc_100070B6:				; CODE XREF: sub_10006F45+16Bj
		mov	eax, [ebx+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, ebx
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_100070EA
; ---------------------------------------------------------------------------

loc_100070CA:				; CODE XREF: sub_10006F45+82j
					; sub_10006F45+8Cj ...
		mov	esi, [ebp+0]
		mov	edi, [ebp+4]
		jmp	short loc_100070EA
; ---------------------------------------------------------------------------

loc_100070D2:				; CODE XREF: sub_10006F45+FCj
					; sub_10006F45+105j
		mov	esi, [esp+14h+arg_4]
		mov	eax, esi
		mov	edi, [esp+14h+arg_8]
		or	eax, edi
		jz	short loc_100070EA
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	esi, [eax]
		mov	edi, [eax+4]

loc_100070EA:				; CODE XREF: sub_10006F45+C7j
					; sub_10006F45+D4j ...
		mov	eax, [esp+14h+arg_0]
		xor	ecx, ecx
		mov	[eax+4], edi
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+8], ecx
		mov	[eax+0Ch], ecx
		mov	[eax+10h], ecx
		pop	ebx
		pop	ecx
		retn	14h
sub_10006F45	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007106	proc near		; DATA XREF: .rdata:1002BBFCo

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_1C		= byte ptr  20h

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_4]
		add	esi, [esp+14h+arg_C]
		push	edi
		adc	ebx, [esp+18h+arg_10]
		mov	edi, ecx
		mov	edx, [edi+20h]
		mov	eax, [edx]
		test	eax, eax
		jz	short loc_1000712F
		cmp	[edi+38h], eax
		jnb	short loc_1000712F
		mov	[edi+38h], eax

loc_1000712F:				; CODE XREF: sub_10007106+1Fj
					; sub_10007106+24j
		mov	eax, ds:?_BADOFF@std@@3_JB ; __int64 const std::_BADOFF
		mov	ecx, [eax]
		mov	ebp, [eax+4]
		mov	eax, ecx
		mov	[esp+18h+var_8], ecx
		cmp	esi, eax
		jnz	short loc_1000714B
		cmp	ebx, ebp
		jz	loc_10007208

loc_1000714B:				; CODE XREF: sub_10007106+3Bj
		test	[esp+18h+arg_1C], 1
		jz	short loc_100071C3
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		mov	[esp+18h+var_4], eax
		test	eax, eax
		jz	short loc_100071C1
		test	ebx, ebx
		jl	short loc_100071BB
		jg	short loc_10007169
		test	esi, esi
		jb	short loc_100071BB

loc_10007169:				; CODE XREF: sub_10007106+5Dj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_100071BB
		jl	short loc_10007180
		cmp	esi, eax
		ja	short loc_100071BB

loc_10007180:				; CODE XREF: sub_10007106+74j
		sub	ecx, [esp+18h+var_4]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::gbump(int)
		test	[esp+18h+arg_1C], 2
		jz	short loc_10007208
		mov	edx, [edi+20h]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	short loc_10007208
		mov	eax, [edi+30h]
		mov	eax, [eax]
		lea	ecx, [ecx+eax*2]
		mov	eax, [edi+1Ch]
		mov	eax, [eax]
		sub	ecx, eax
		mov	[edx], eax
		mov	eax, [edi+30h]
		sar	ecx, 1
		mov	[eax], ecx
		jmp	short loc_10007208
; ---------------------------------------------------------------------------

loc_100071BB:				; CODE XREF: sub_10007106+5Bj
					; sub_10007106+61j ...
		mov	esi, [esp+18h+var_8]
		jmp	short loc_10007206
; ---------------------------------------------------------------------------

loc_100071C1:				; CODE XREF: sub_10007106+57j
		mov	eax, ecx

loc_100071C3:				; CODE XREF: sub_10007106+4Aj
		test	[esp+18h+arg_1C], 2
		jz	short loc_10007204
		cmp	dword ptr [edx], 0
		jz	short loc_10007204
		test	ebx, ebx
		jl	short loc_100071BB
		jg	short loc_100071D9
		test	esi, esi
		jb	short loc_100071BB

loc_100071D9:				; CODE XREF: sub_10007106+CDj
		mov	eax, [edi+0Ch]
		mov	ecx, [eax]
		mov	eax, [edi+38h]
		sub	eax, ecx
		sar	eax, 1
		cdq
		cmp	ebx, edx
		jg	short loc_100071BB
		jl	short loc_100071F0
		cmp	esi, eax
		ja	short loc_100071BB

loc_100071F0:				; CODE XREF: sub_10007106+E4j
		mov	eax, [edi+20h]
		sub	ecx, [eax]
		sar	ecx, 1
		add	ecx, esi
		push	ecx
		mov	ecx, edi
		call	ds:?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::pbump(int)
		jmp	short loc_10007208
; ---------------------------------------------------------------------------

loc_10007204:				; CODE XREF: sub_10007106+C2j
					; sub_10007106+C7j
		mov	esi, eax

loc_10007206:				; CODE XREF: sub_10007106+B9j
		mov	ebx, ebp

loc_10007208:				; CODE XREF: sub_10007106+3Fj
					; sub_10007106+90j ...
		mov	eax, [esp+18h+arg_0]
		pop	edi
		and	dword ptr [eax+8], 0
		and	dword ptr [eax+0Ch], 0
		and	dword ptr [eax+10h], 0
		mov	[eax], esi
		pop	esi
		pop	ebp
		mov	[eax+4], ebx
		pop	ebx
		pop	ecx
		pop	ecx
		retn	20h
sub_10007106	endp

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR sub_1000784B

loc_10007226:				; CODE XREF: sub_1000784B+3j
		push	esi
		push	edi
		lea	edi, [ecx-68h]
		lea	ecx, [edi+68h]
		call	sub_10006C33
		lea	ecx, [edi+68h]
		call	ds:??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ	; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::~basic_ios<wchar_t,std::char_traits<wchar_t>>(void)
		test	[esp+8+arg_0], 1
		jz	short loc_1000724B
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000724B:				; CODE XREF: sub_1000784B-60Aj
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
; END OF FUNCTION CHUNK	FOR sub_1000784B

; =============== S U B	R O U T	I N E =======================================


sub_10007252	proc near		; DATA XREF: .rdata:off_1002BBD0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10006C63
		test	[esp+4+arg_0], 1
		jz	short loc_10007269
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007269:				; CODE XREF: sub_10007252+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10007252	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000726F	proc near		; CODE XREF: sub_10006844+193p

var_20		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		mov	edx, ecx
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		test	byte ptr [edx+3Ch], 2
		jnz	short loc_100072B1
		mov	eax, [edx+20h]
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_100072B1
		cmp	[edx+38h], ecx
		jb	short loc_1000729D
		mov	ecx, [edx+38h]

loc_1000729D:				; CODE XREF: sub_1000726F+29j
		mov	eax, [edx+10h]
		sub	ecx, [eax]
		sar	ecx, 1
		push	ecx		; int
		push	dword ptr [eax]	; void *

loc_100072A7:				; CODE XREF: sub_1000726F+65j
		lea	ecx, [ebp+var_20]
		call	sub_10002BDC
		jmp	short loc_100072E7
; ---------------------------------------------------------------------------

loc_100072B1:				; CODE XREF: sub_1000726F+1Bj
					; sub_1000726F+24j
		test	byte ptr [edx+3Ch], 4
		jnz	short loc_100072D6
		mov	eax, [edx+1Ch]
		mov	edi, [eax]
		test	edi, edi
		jz	short loc_100072D6
		mov	eax, [edx+0Ch]
		mov	ecx, [eax]
		mov	eax, [edx+2Ch]
		mov	eax, [eax]
		add	eax, eax
		sub	eax, ecx
		add	eax, edi
		sar	eax, 1
		push	eax
		push	ecx
		jmp	short loc_100072A7
; ---------------------------------------------------------------------------

loc_100072D6:				; CODE XREF: sub_1000726F+46j
					; sub_1000726F+4Fj
		and	[ebp+var_10], 0
		xor	eax, eax
		mov	[ebp+var_C], 7
		mov	[ebp+var_20], ax

loc_100072E7:				; CODE XREF: sub_1000726F+40j
		lea	eax, [ebp+var_20]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003481
		push	0
		push	1
		lea	ecx, [ebp+var_20]
		call	sub_10002311
		mov	ecx, [ebp+var_8]
		mov	eax, esi
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000726F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007312	proc near		; CODE XREF: sub_1000742B+4Cp
					; sub_10007562+3Ap ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		mov	edi, ecx
		mov	[edi], esi
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	ecx, [eax+esi+38h]
		test	ecx, ecx
		jz	short loc_1000732E
		mov	eax, [ecx]
		call	dword ptr [eax+4]

loc_1000732E:				; CODE XREF: sub_10007312+15j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		cmp	dword ptr [ecx+esi+0Ch], 0
		jnz	short loc_1000734C
		mov	ecx, [ecx+esi+3Ch]
		test	ecx, ecx
		jz	short loc_1000734C
		cmp	ecx, esi
		jz	short loc_1000734C
		call	ds:?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ ; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::flush(void)

loc_1000734C:				; CODE XREF: sub_10007312+26j
					; sub_10007312+2Ej ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		cmp	dword ptr [eax+esi+0Ch], 0
		setz	al
		mov	[edi+4], al
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10007312	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007363	proc near		; CODE XREF: sub_1000742B+128p
					; sub_10007562+107p ...
		push	esi
		mov	esi, ecx
		mov	ecx, [esi]
		call	ds:?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ	; std::basic_ostream<wchar_t,std::char_traits<wchar_t>>::_Osfx(void)
		mov	ecx, [esi]
		pop	esi
		mov	eax, [ecx]
		mov	eax, [eax+4]
		mov	ecx, [eax+ecx+38h]
		test	ecx, ecx
		jz	short locret_10007383
		mov	eax, [ecx]
		jmp	dword ptr [eax+8]
; ---------------------------------------------------------------------------

locret_10007383:			; CODE XREF: sub_10007363+19j
		retn
sub_10007363	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10007384	proc near		; CODE XREF: sub_10007678+7Ap

var_8		= byte ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		xor	esi, esi
		push	esi
		lea	ecx, [ebp+var_8]
		call	ds:??0_Lockit@std@@QAE@H@Z ; std::_Lockit::_Lockit(int)
		mov	eax, dword_10031F40
		mov	ecx, ds:?id@?$ctype@_W@std@@2V0locale@2@A ; std::locale::id std::ctype<wchar_t>::id
		mov	[ebp+var_4], eax
		call	ds:??Bid@locale@std@@QAEIXZ ; std::locale::id::operator	uint(void)
		mov	edi, eax
		mov	eax, [ebx]
		cmp	edi, [eax+0Ch]
		jnb	short loc_100073BF
		mov	ecx, [eax+8]
		mov	ecx, [ecx+edi*4]
		jmp	short loc_100073C1
; ---------------------------------------------------------------------------

loc_100073BF:				; CODE XREF: sub_10007384+31j
		mov	ecx, esi

loc_100073C1:				; CODE XREF: sub_10007384+39j
		test	ecx, ecx
		jnz	short loc_100073DD
		cmp	[eax+14h], cl
		jz	short loc_100073DD
		call	ds:?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ ; std::locale::_Getgloballocale(void)
		cmp	edi, [eax+0Ch]
		jnb	short loc_100073DF
		mov	eax, [eax+8]
		mov	esi, [eax+edi*4]
		jmp	short loc_100073DF
; ---------------------------------------------------------------------------

loc_100073DD:				; CODE XREF: sub_10007384+3Fj
					; sub_10007384+44j
		mov	esi, ecx

loc_100073DF:				; CODE XREF: sub_10007384+4Fj
					; sub_10007384+57j
		test	esi, esi
		jnz	short loc_10007419
		mov	esi, [ebp+var_4]
		test	esi, esi
		jnz	short loc_10007419
		lea	eax, [ebp+var_4]
		push	ebx
		push	eax
		call	ds:?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z ; std::ctype<wchar_t>::_Getcat(std::locale::facet const * *,std::locale const *)
		pop	ecx
		pop	ecx
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10007402
		call	ds:abort
; ---------------------------------------------------------------------------

loc_10007402:				; CODE XREF: sub_10007384+76j
		mov	esi, [ebp+var_4]
		mov	ecx, esi
		mov	dword_10031F40,	esi
		mov	edx, [esi]
		call	dword ptr [edx+4]
		push	esi		; struct std::_Facet_base *
		call	?_Facet_Register@std@@YAXPAV_Facet_base@1@@Z ; std::_Facet_Register(std::_Facet_base *)
		pop	ecx

loc_10007419:				; CODE XREF: sub_10007384+5Dj
					; sub_10007384+64j
		lea	ecx, [ebp+var_8]
		call	ds:??1_Lockit@std@@QAE@XZ ; std::_Lockit::~_Lockit(void)
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007384	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000742B	proc near		; CODE XREF: sub_10006844+14Cp
					; sub_10006844+166p

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	eax, edx
		xor	ebp, ebp
		push	edi
		mov	edi, ecx
		mov	[esp+24h+var_10], eax
		mov	ecx, eax
		call	sub_10001AF3
		mov	esi, [edi]
		mov	[esp+24h+var_14], eax
		mov	edx, [esi+4]
		mov	ebx, [edx+edi+24h]
		mov	esi, [edx+edi+20h]
		test	ebx, ebx
		jl	short loc_1000746E
		jg	short loc_10007468
		test	esi, esi
		jz	short loc_1000746E
		test	ebx, ebx
		jl	short loc_1000746E
		jg	short loc_10007468
		cmp	esi, eax
		jbe	short loc_1000746E

loc_10007468:				; CODE XREF: sub_1000742B+2Dj
					; sub_1000742B+37j
		sub	esi, eax
		sbb	ebx, ebp
		jmp	short loc_10007472
; ---------------------------------------------------------------------------

loc_1000746E:				; CODE XREF: sub_1000742B+2Bj
					; sub_1000742B+31j ...
		xor	esi, esi
		xor	ebx, ebx

loc_10007472:				; CODE XREF: sub_1000742B+41j
		push	edi
		lea	ecx, [esp+28h+var_C]
		call	sub_10007312
		cmp	[esp+24h+var_8], 0
		jnz	short loc_1000748B
		push	4
		pop	ebp
		jmp	loc_1000753F
; ---------------------------------------------------------------------------

loc_1000748B:				; CODE XREF: sub_1000742B+56j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100074D3
		test	ebx, ebx
		jl	short loc_100074D3
		jle	short loc_100074CF

loc_100074A4:				; CODE XREF: sub_1000742B+A0j
					; sub_1000742B+A6j
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000752D
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100074A4
		jl	short loc_100074D3

loc_100074CF:				; CODE XREF: sub_1000742B+77j
		test	esi, esi
		jnz	short loc_100074A4

loc_100074D3:				; CODE XREF: sub_1000742B+71j
					; sub_1000742B+75j ...
		mov	eax, [edi]
		push	0
		push	[esp+28h+var_14]
		mov	eax, [eax+4]
		push	[esp+2Ch+var_10]
		mov	ecx, [eax+edi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+24h+var_14]
		jnz	short loc_1000752D
		test	edx, edx
		jnz	short loc_1000752D
		test	ebx, ebx
		jl	short loc_10007530
		jle	short loc_10007527

loc_100074FC:				; CODE XREF: sub_1000742B+F8j
					; sub_1000742B+FEj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000752D
		add	esi, 0FFFFFFFFh
		adc	ebx, 0FFFFFFFFh
		test	ebx, ebx
		jg	short loc_100074FC
		jl	short loc_10007530

loc_10007527:				; CODE XREF: sub_1000742B+CFj
		test	esi, esi
		jnz	short loc_100074FC
		jmp	short loc_10007530
; ---------------------------------------------------------------------------

loc_1000752D:				; CODE XREF: sub_1000742B+96j
					; sub_1000742B+C5j ...
		push	4
		pop	ebp

loc_10007530:				; CODE XREF: sub_1000742B+CDj
					; sub_1000742B+FAj ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_1000753F:				; CODE XREF: sub_1000742B+5Bj
		mov	eax, [edi]
		push	0
		push	ebp
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_10007363
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1000742B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007562	proc near		; CODE XREF: sub_10006844+15Ap

var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		push	edi
		xor	ebx, ebx
		mov	eax, [esi]
		mov	ecx, [ebp+10h]
		mov	[esp+24h+var_10], ecx
		mov	edi, [eax+4]
		cmp	[edi+esi+24h], ebx
		jl	short loc_10007595
		jg	short loc_10007589
		cmp	[edi+esi+20h], ebx
		jbe	short loc_10007595

loc_10007589:				; CODE XREF: sub_10007562+1Fj
		mov	edi, [edi+esi+20h]
		cmp	edi, ecx
		jbe	short loc_10007595
		sub	edi, ecx
		jmp	short loc_10007597
; ---------------------------------------------------------------------------

loc_10007595:				; CODE XREF: sub_10007562+1Dj
					; sub_10007562+25j ...
		xor	edi, edi

loc_10007597:				; CODE XREF: sub_10007562+31j
		push	esi
		lea	ecx, [esp+28h+var_C]
		call	sub_10007312
		cmp	[esp+24h+var_8], bl
		jnz	short loc_100075AF
		push	4
		pop	ebx
		jmp	loc_10007655
; ---------------------------------------------------------------------------

loc_100075AF:				; CODE XREF: sub_10007562+43j
		mov	eax, [esi]
		mov	eax, [eax+4]
		mov	eax, [eax+esi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_100075E8
		test	edi, edi
		jz	short loc_100075E8

loc_100075C6:				; CODE XREF: sub_10007562+84j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007639
		dec	edi
		jnz	short loc_100075C6

loc_100075E8:				; CODE XREF: sub_10007562+5Ej
					; sub_10007562+62j
		cmp	dword ptr [ebp+14h], 8
		jb	short loc_100075F1
		mov	ebp, [ebp+0]

loc_100075F1:				; CODE XREF: sub_10007562+8Aj
		mov	eax, [esi]
		push	0
		push	[esp+28h+var_10]
		mov	eax, [eax+4]
		push	ebp
		mov	ecx, [eax+esi+38h]
		call	ds:?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputn(wchar_t const	*,__int64)
		cmp	eax, [esp+24h+var_10]
		jnz	short loc_10007643
		test	edx, edx
		jnz	short loc_10007643

loc_10007611:				; CODE XREF: sub_10007562+DAj
		test	edi, edi
		jz	short loc_10007646

loc_10007615:				; CODE XREF: sub_10007562+D3j
		mov	eax, [esi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+esi+40h]
		mov	ecx, [ecx+esi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_1000763E
		dec	edi
		jnz	short loc_10007615
		jmp	short loc_10007646
; ---------------------------------------------------------------------------

loc_10007639:				; CODE XREF: sub_10007562+81j
		push	4
		pop	ebx
		jmp	short loc_10007611
; ---------------------------------------------------------------------------

loc_1000763E:				; CODE XREF: sub_10007562+D0j
		or	ebx, 4
		jmp	short loc_10007646
; ---------------------------------------------------------------------------

loc_10007643:				; CODE XREF: sub_10007562+A9j
					; sub_10007562+ADj
		push	4
		pop	ebx

loc_10007646:				; CODE XREF: sub_10007562+B1j
					; sub_10007562+D5j ...
		mov	eax, [esi]
		mov	eax, [eax+4]
		and	dword ptr [eax+esi+20h], 0
		and	dword ptr [eax+esi+24h], 0

loc_10007655:				; CODE XREF: sub_10007562+48j
		mov	eax, [esi]
		push	0
		push	ebx
		mov	ecx, [eax+4]
		add	ecx, esi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+24h+var_C]
		call	sub_10007363
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_10007562	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007678	proc near		; CODE XREF: sub_10006844+176p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 2Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	esi, esi
		and	[esp+3Ch+var_24], esi
		xor	ecx, ecx
		inc	ecx
		mov	[esp+3Ch+var_28], esi
		mov	[esp+3Ch+var_18], ecx
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	ebp, [eax+edi+24h]
		mov	ebx, [eax+edi+20h]
		test	ebp, ebp
		jl	short loc_100076B9
		jg	short loc_100076B3
		test	ebx, ebx
		jz	short loc_100076B9
		test	ebp, ebp
		jl	short loc_100076B9
		jg	short loc_100076B3
		cmp	ebx, ecx
		jbe	short loc_100076B9

loc_100076B3:				; CODE XREF: sub_10007678+2Bj
					; sub_10007678+35j
		sub	ebx, ecx
		sbb	ebp, esi
		jmp	short loc_100076BD
; ---------------------------------------------------------------------------

loc_100076B9:				; CODE XREF: sub_10007678+29j
					; sub_10007678+2Fj ...
		xor	ebx, ebx
		xor	ebp, ebp

loc_100076BD:				; CODE XREF: sub_10007678+3Fj
		push	edi
		lea	ecx, [esp+40h+var_C]
		mov	[esp+40h+var_1C], ebp
		mov	[esp+40h+var_20], ebx
		call	sub_10007312
		cmp	[esp+3Ch+var_8], 0
		jnz	short loc_100076DE
		push	4
		pop	esi
		jmp	loc_10007828
; ---------------------------------------------------------------------------

loc_100076DE:				; CODE XREF: sub_10007678+5Cj
		lea	eax, [esp+3Ch+var_14]
		push	eax
		mov	eax, [edi]
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?getloc@ios_base@std@@QBE?AVlocale@2@XZ ; std::ios_base::getloc(void)
		mov	ecx, eax
		call	sub_10007384
		mov	ecx, [esp+3Ch+var_14]
		mov	[esp+3Ch+var_10], eax
		test	ecx, ecx
		jz	short loc_10007714
		mov	edx, [ecx]
		call	dword ptr [edx+8]
		test	eax, eax
		jz	short loc_10007714
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

loc_10007714:				; CODE XREF: sub_10007678+89j
					; sub_10007678+92j
		mov	eax, [edi]
		mov	eax, [eax+4]
		mov	eax, [eax+edi+14h]
		and	eax, 1C0h
		cmp	eax, 40h
		jz	short loc_10007768
		test	ebp, ebp
		jl	short loc_10007768
		jle	short loc_10007764

loc_1000772D:				; CODE XREF: sub_10007678+E8j
					; sub_10007678+EEj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	loc_10007816
		add	ebx, 0FFFFFFFFh
		mov	[esp+3Ch+var_20], ebx
		adc	ebp, 0FFFFFFFFh
		mov	[esp+3Ch+var_1C], ebp
		test	ebp, ebp
		jg	short loc_1000772D
		jl	short loc_10007768

loc_10007764:				; CODE XREF: sub_10007678+B3j
		test	ebx, ebx
		jnz	short loc_1000772D

loc_10007768:				; CODE XREF: sub_10007678+ADj
					; sub_10007678+B1j ...
		mov	ecx, [esp+3Ch+var_24]
		xor	eax, eax
		mov	ebp, [esp+3Ch+var_10]
		inc	eax
		mov	ebx, offset asc_1002BB9C ; " "

loc_10007778:				; CODE XREF: sub_10007678+159j
		test	ecx, ecx
		jl	short loc_100077D3
		jg	short loc_10007782
		test	eax, eax
		jz	short loc_100077D3

loc_10007782:				; CODE XREF: sub_10007678+104j
		mov	eax, [edi]
		mov	ecx, ebp
		mov	eax, [eax+4]
		mov	esi, [eax+edi+38h]
		movzx	eax, byte ptr [ebx]
		push	eax
		call	ds:?widen@?$ctype@_W@std@@QBE_WD@Z ; std::ctype<wchar_t>::widen(char)
		movzx	eax, ax
		mov	ecx, esi
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	esi, [esp+3Ch+var_28]
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jnz	short loc_100077B8
		or	esi, 4
		mov	[esp+3Ch+var_28], esi

loc_100077B8:				; CODE XREF: sub_10007678+137j
		mov	eax, [esp+3Ch+var_18]
		mov	ecx, [esp+3Ch+var_24]
		add	eax, 0FFFFFFFFh
		mov	[esp+3Ch+var_18], eax
		adc	ecx, 0FFFFFFFFh
		inc	ebx
		mov	[esp+3Ch+var_24], ecx
		test	esi, esi
		jz	short loc_10007778

loc_100077D3:				; CODE XREF: sub_10007678+102j
					; sub_10007678+108j
		mov	ebx, [esp+3Ch+var_20]
		mov	ebp, [esp+3Ch+var_1C]
		test	esi, esi
		jnz	short loc_10007819
		test	ebp, ebp
		jl	short loc_10007819
		jle	short loc_10007810

loc_100077E5:				; CODE XREF: sub_10007678+194j
					; sub_10007678+19Aj
		mov	eax, [edi]
		mov	ecx, [eax+4]
		movzx	eax, word ptr [ecx+edi+40h]
		mov	ecx, [ecx+edi+38h]
		push	eax
		call	ds:?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sputc(wchar_t)
		mov	ecx, 0FFFFh
		cmp	cx, ax
		jz	short loc_10007816
		add	ebx, 0FFFFFFFFh
		adc	ebp, 0FFFFFFFFh
		test	ebp, ebp
		jg	short loc_100077E5
		jl	short loc_10007819

loc_10007810:				; CODE XREF: sub_10007678+16Bj
		test	ebx, ebx
		jnz	short loc_100077E5
		jmp	short loc_10007819
; ---------------------------------------------------------------------------

loc_10007816:				; CODE XREF: sub_10007678+D2j
					; sub_10007678+18Aj
		push	4
		pop	esi

loc_10007819:				; CODE XREF: sub_10007678+165j
					; sub_10007678+169j ...
		mov	eax, [edi]
		mov	eax, [eax+4]
		and	dword ptr [eax+edi+20h], 0
		and	dword ptr [eax+edi+24h], 0

loc_10007828:				; CODE XREF: sub_10007678+61j
		mov	eax, [edi]
		push	0
		push	esi
		mov	ecx, [eax+4]
		add	ecx, edi
		call	ds:?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z ; std::basic_ios<wchar_t,std::char_traits<wchar_t>>::setstate(int,bool)
		lea	ecx, [esp+3Ch+var_C]
		call	sub_10007363
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 2Ch
		retn
sub_10007678	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000784B	proc near		; DATA XREF: .rdata:off_1002BC0Co

arg_0		= byte ptr  4

; FUNCTION CHUNK AT 10007226 SIZE 0000002C BYTES

		sub	ecx, [ecx-4]
		jmp	loc_10007226
sub_1000784B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007853(HANDLE TokenHandle)
sub_10007853	proc near		; CODE XREF: sub_10007911+1Dp

var_8		= dword	ptr -8
ReturnLength	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, edx
		xor	ecx, ecx
		mov	[ebp+var_8], ecx
		test	edi, edi
		jnz	short loc_1000786C

loc_10007868:				; CODE XREF: sub_10007853+30j
		xor	al, al
		jmp	short loc_100078BD
; ---------------------------------------------------------------------------

loc_1000786C:				; CODE XREF: sub_10007853+13j
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], ecx
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:GetTokenInformation
		mov	esi, [ebp+ReturnLength]
		test	esi, esi
		jz	short loc_10007868
		push	esi		; size_t
		call	ds:malloc
		pop	ecx
		mov	ecx, [ebx]
		and	dword ptr [ebx], 0
		mov	[ebp+var_8], eax
		test	ecx, ecx
		jz	short loc_100078A7
		push	ecx		; void *
		call	ds:free
		mov	esi, [ebp+ReturnLength]
		mov	eax, [ebp+var_8]
		pop	ecx

loc_100078A7:				; CODE XREF: sub_10007853+44j
		lea	ecx, [ebp+ReturnLength]
		mov	[ebx], eax
		push	ecx		; ReturnLength
		push	esi		; TokenInformationLength
		push	eax		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		setnz	al

loc_100078BD:				; CODE XREF: sub_10007853+17j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007853	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100078C4	proc near		; CODE XREF: sub_10007911+3Ep
					; sub_1000799B+5Fp

pListOfExplicitEntries=	_EXPLICIT_ACCESS_W ptr -24h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
NewAcl		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		push	esi
		push	edi
		push	7
		xor	eax, eax
		lea	edi, [ebp+pListOfExplicitEntries.grfAccessMode]
		mov	esi, ecx
		pop	ecx
		push	[ebp+NewAcl]	; NewAcl
		rep stosd
		mov	eax, [ebp+arg_0]
		mov	[ebp+pListOfExplicitEntries.grfAccessMode], eax
		mov	eax, [ebp+arg_4]
		mov	[ebp+pListOfExplicitEntries.grfAccessPermissions], eax
		xor	eax, eax
		mov	[ebp+pListOfExplicitEntries.grfInheritance], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.pMultipleTrustee], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.MultipleTrusteeOperation], eax
		mov	[ebp+pListOfExplicitEntries.Trustee.TrusteeForm], eax
		lea	eax, [ebp+pListOfExplicitEntries]
		push	edx		; OldAcl
		push	eax		; pListOfExplicitEntries
		push	1		; cCountOfExplicitEntries
		mov	[ebp+pListOfExplicitEntries.Trustee.ptstrName],	esi
		call	ds:SetEntriesInAclW
		neg	eax
		pop	edi
		sbb	al, al
		inc	al
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_100078C4	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10007911(HANDLE TokenHandle)
sub_10007911	proc near		; CODE XREF: sub_10012AE0+1F4p
					; sub_10012AE0+24Dp

hMem		= dword	ptr -0Ch
var_8		= dword	ptr -8
TokenInformation= dword	ptr -4

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebp, edx
		test	edi, edi
		jnz	short loc_10007924
		xor	al, al
		jmp	short loc_10007993
; ---------------------------------------------------------------------------

loc_10007924:				; CODE XREF: sub_10007911+Dj
		xor	ebx, ebx
		lea	edx, [esp+20h+var_8]
		mov	[esp+20h+var_8], ebx
		call	sub_10007853
		mov	esi, [esp+20h+var_8]
		test	al, al
		jz	short loc_10007985
		lea	eax, [esp+20h+hMem]
		mov	[esp+20h+hMem],	ebx
		mov	edx, [esi]
		mov	ecx, ebp
		push	eax
		push	10000000h
		push	1
		call	sub_100078C4
		add	esp, 0Ch
		test	al, al
		jz	short loc_10007985
		mov	eax, [esp+20h+hMem]
		push	4		; TokenInformationLength
		mov	[esp+24h+TokenInformation], eax
		lea	eax, [esp+24h+TokenInformation]
		push	eax		; TokenInformation
		push	6		; TokenInformationClass
		push	edi		; TokenHandle
		call	ds:SetTokenInformation
		push	[esp+20h+hMem]	; hMem
		mov	edi, eax
		call	ds:LocalFree
		cmp	edi, 1
		setz	bl

loc_10007985:				; CODE XREF: sub_10007911+28j
					; sub_10007911+48j
		test	esi, esi
		jz	short loc_10007991
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10007991:				; CODE XREF: sub_10007911+76j
		mov	al, bl

loc_10007993:				; CODE XREF: sub_10007911+11j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn
sub_10007911	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_1000799B@<eax>(HANDLE handle@<ecx>, PSID pSourceSid)
sub_1000799B	proc near		; CODE XREF: sub_100189BE+135p

ppDacl		= dword	ptr -5Ch
pDacl		= dword	ptr -58h
ppSecurityDescriptor= dword ptr	-54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
pSourceSid	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 60h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+pSourceSid]
		lea	eax, [ebp+ppSecurityDescriptor]
		push	eax		; ppSecurityDescriptor
		xor	ebx, ebx
		lea	eax, [ebp+ppDacl]
		push	ebx		; ppSacl
		push	eax		; ppDacl
		push	ebx		; ppsidGroup
		push	ebx		; ppsidOowner
		push	4		; SecurityInfo
		mov	esi, ecx
		mov	[ebp+ppSecurityDescriptor], ebx
		push	7		; ObjectType
		push	esi		; handle
		mov	[ebp+ppDacl], ebx
		mov	[ebp+pDacl], ebx
		call	ds:GetSecurityInfo
		test	eax, eax
		jz	short loc_100079DC

loc_100079D8:				; CODE XREF: sub_1000799B+74j
		xor	al, al
		jmp	short loc_10007A39
; ---------------------------------------------------------------------------

loc_100079DC:				; CODE XREF: sub_1000799B+3Bj
		push	edi		; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		mov	edx, [ebp+ppDacl]
		lea	eax, [ebp+pDacl]
		push	eax
		push	0D013Eh
		push	3
		lea	ecx, [ebp+pDestinationSid]
		call	sub_100078C4
		add	esp, 0Ch
		test	al, al
		jnz	short loc_10007A11
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	ds:LocalFree
		jmp	short loc_100079D8
; ---------------------------------------------------------------------------

loc_10007A11:				; CODE XREF: sub_1000799B+69j
		push	ebx		; pSacl
		push	[ebp+pDacl]	; pDacl
		push	ebx		; psidGroup
		push	ebx		; psidOowner
		push	4		; SecurityInfo
		push	7		; ObjectType
		push	esi		; handle
		call	ds:SetSecurityInfo
		push	[ebp+pDacl]	; hMem
		mov	esi, ds:LocalFree
		mov	edi, eax
		call	esi ; LocalFree
		push	[ebp+ppSecurityDescriptor] ; hMem
		call	esi ; LocalFree
		test	edi, edi
		setz	al

loc_10007A39:				; CODE XREF: sub_1000799B+3Fj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000799B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007A4A(LPCWSTR StringSid)
sub_10007A4A	proc near		; CODE XREF: sub_10007A6C+13p
					; sub_10007A6C+4Bp

Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_10007A56
		mov	ecx, [ecx]

loc_10007A56:				; CODE XREF: sub_10007A4A+8j
		lea	eax, [ebp+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		neg	eax
		sbb	eax, eax
		and	eax, [ebp+Sid]
		mov	esp, ebp
		pop	ebp
		retn
sub_10007A4A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10007A6C(LPCWSTR StringSid,	int)
sub_10007A6C	proc near		; CODE XREF: sub_100149FF+A4p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
StringSid	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	ecx, [esp+24h+StringSid] ; StringSid
		mov	[esp+24h+var_10], ebp
		call	sub_10007A4A
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10007A92
		push	0Eh

loc_10007A8C:				; CODE XREF: sub_10007A6C+114j
		pop	eax
		jmp	loc_10007B74
; ---------------------------------------------------------------------------

loc_10007A92:				; CODE XREF: sub_10007A6C+1Cj
		mov	ebx, [esp+24h+arg_4]
		push	18h
		pop	esi
		mov	[esp+24h+var_10], esi
		mov	eax, [ebx+4]
		mov	ecx, [ebx]
		sub	eax, ecx
		cdq
		idiv	esi
		test	eax, eax
		jz	loc_10007B5D
		mov	esi, ebp
		mov	[esp+24h+StringSid], ebp

loc_10007AB5:				; CODE XREF: sub_10007A6C+E8j
		add	ecx, esi	; StringSid
		call	sub_10007A4A
		mov	ecx, eax
		mov	[esp+24h+var_C], ecx
		test	ecx, ecx
		jz	loc_10007B7E
		lea	esi, [edi+10h]
		mov	[esp+24h+var_8], 4
		mov	eax, [esi+4]
		lea	edx, [esp+24h+var_C]
		cmp	edx, eax
		jnb	short loc_10007B13
		cmp	[esi], edx
		ja	short loc_10007B13
		mov	ebx, edx
		sub	ebx, [esi]
		sar	ebx, 3
		cmp	eax, [esi+8]
		jnz	short loc_10007AF8
		push	ecx
		mov	ecx, esi
		call	sub_10007DBE

loc_10007AF8:				; CODE XREF: sub_10007A6C+82j
		mov	edx, [esi+4]
		test	edx, edx
		jz	short loc_10007B0D
		mov	ecx, [esi]
		mov	eax, [ecx+ebx*8]
		mov	[edx], eax
		mov	eax, [ecx+ebx*8+4]
		mov	[edx+4], eax

loc_10007B0D:				; CODE XREF: sub_10007A6C+91j
		mov	ebx, [esp+24h+arg_4]
		jmp	short loc_10007B34
; ---------------------------------------------------------------------------

loc_10007B13:				; CODE XREF: sub_10007A6C+72j
					; sub_10007A6C+76j
		cmp	eax, [esi+8]
		jnz	short loc_10007B24
		push	ecx
		mov	ecx, esi
		call	sub_10007DBE
		mov	ecx, [esp+24h+var_C]

loc_10007B24:				; CODE XREF: sub_10007A6C+AAj
		mov	eax, [esi+4]
		test	eax, eax
		jz	short loc_10007B34
		mov	[eax], ecx
		mov	dword ptr [eax+4], 4

loc_10007B34:				; CODE XREF: sub_10007A6C+A5j
					; sub_10007A6C+BDj
		add	dword ptr [esi+4], 8
		inc	ebp
		mov	esi, [esp+24h+StringSid]
		mov	ecx, [ebx]
		push	18h
		pop	eax
		add	esi, eax
		mov	eax, [ebx+4]
		sub	eax, ecx
		mov	[esp+24h+StringSid], esi
		cdq
		idiv	[esp+24h+var_10]
		cmp	ebp, eax
		jb	loc_10007AB5
		push	18h
		pop	esi

loc_10007B5D:				; CODE XREF: sub_10007A6C+3Dj
		mov	eax, [ebx+4]
		sub	eax, [ebx]
		cdq
		idiv	esi
		test	eax, eax
		jz	short loc_10007B72
		mov	[edi+8], eax
		mov	eax, [edi+10h]
		mov	[edi+4], eax

loc_10007B72:				; CODE XREF: sub_10007A6C+FBj
		xor	eax, eax

loc_10007B74:				; CODE XREF: sub_10007A6C+21j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn	8
; ---------------------------------------------------------------------------

loc_10007B7E:				; CODE XREF: sub_10007A6C+58j
		push	0Fh
		jmp	loc_10007A8C
sub_10007A6C	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10007B85(LPCWSTR StringSid)
sub_10007B85	proc near		; CODE XREF: sub_10008B8B+76p

Sid		= dword	ptr -4

		push	ecx
		and	[esp+4+Sid], 0
		cmp	dword ptr [ecx+14h], 8
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		jb	short loc_10007B97
		mov	ecx, [ecx]

loc_10007B97:				; CODE XREF: sub_10007B85+Ej
		lea	eax, [esp+10h+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10007BAC
		push	0Eh
		pop	eax
		jmp	short loc_10007C1C
; ---------------------------------------------------------------------------

loc_10007BAC:				; CODE XREF: sub_10007B85+20j
		mov	eax, dword_10031F50
		test	eax, eax
		jnz	short loc_10007BE7
		mov	edi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	edi ; GetModuleHandleW
		mov	ebp, offset aAppcontainerre ; "AppContainerRegisterSid"
		push	ebp		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short loc_10007BE2
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	ebp		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress

loc_10007BE2:				; CODE XREF: sub_10007B85+4Cj
		mov	dword_10031F50,	eax

loc_10007BE7:				; CODE XREF: sub_10007B85+2Ej
		xor	edi, edi
		inc	edi
		test	eax, eax
		jz	short loc_10007C10
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007BF8
		mov	ecx, [esi]
		jmp	short loc_10007BFA
; ---------------------------------------------------------------------------

loc_10007BF8:				; CODE XREF: sub_10007B85+6Dj
		mov	ecx, esi

loc_10007BFA:				; CODE XREF: sub_10007B85+71j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10007C02
		mov	esi, [esi]

loc_10007C02:				; CODE XREF: sub_10007B85+79j
		push	ecx
		push	esi
		push	[esp+18h+Sid]
		call	eax ; dword_10031F50
		test	eax, eax
		js	short loc_10007C10
		xor	edi, edi

loc_10007C10:				; CODE XREF: sub_10007B85+67j
					; sub_10007B85+87j
		push	[esp+10h+Sid]	; hMem
		call	ds:LocalFree
		mov	eax, edi

loc_10007C1C:				; CODE XREF: sub_10007B85+25j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		retn
sub_10007B85	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10007C21(LPCWSTR StringSid)
sub_10007C21	proc near		; CODE XREF: sub_10008C66+65p

Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+Sid], 0
		cmp	dword ptr [ecx+14h], 8
		push	ebx
		push	esi
		jb	short loc_10007C33
		mov	ecx, [ecx]

loc_10007C33:				; CODE XREF: sub_10007C21+Ej
		lea	eax, [ebp+Sid]
		push	eax		; Sid
		push	ecx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10007C47
		push	0Eh
		pop	eax
		jmp	short loc_10007C9F
; ---------------------------------------------------------------------------

loc_10007C47:				; CODE XREF: sub_10007C21+1Fj
		mov	eax, dword_10031F44
		test	eax, eax
		jnz	short loc_10007C82
		mov	esi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	esi ; GetModuleHandleW
		mov	ebx, offset aAppcontainerun ; "AppContainerUnregisterSid"
		push	ebx		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jnz	short loc_10007C7D
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	esi ; GetModuleHandleW
		push	ebx		; lpProcName
		push	eax		; hModule
		call	ds:GetProcAddress

loc_10007C7D:				; CODE XREF: sub_10007C21+4Bj
		mov	dword_10031F44,	eax

loc_10007C82:				; CODE XREF: sub_10007C21+2Dj
		xor	esi, esi
		inc	esi
		test	eax, eax
		jz	short loc_10007C94
		push	[ebp+Sid]
		call	eax ; dword_10031F44
		test	eax, eax
		js	short loc_10007C94
		xor	esi, esi

loc_10007C94:				; CODE XREF: sub_10007C21+66j
					; sub_10007C21+6Fj
		push	[ebp+Sid]	; hMem
		call	ds:LocalFree
		mov	eax, esi

loc_10007C9F:				; CODE XREF: sub_10007C21+24j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10007C21	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007CA5	proc near		; CODE XREF: sub_10008B8B+41p
					; sub_10008C66+39p

var_28		= dword	ptr -28h
Sid		= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		push	ebp
		xor	ebp, ebp
		push	esi
		mov	[esp+38h+Sid], ebp
		mov	esi, ecx
		cmp	dword ptr [edx+14h], 8
		push	edi
		jb	short loc_10007CC7
		mov	edx, [edx]

loc_10007CC7:				; CODE XREF: sub_10007CA5+1Ej
		lea	eax, [esp+3Ch+Sid]
		push	eax		; Sid
		push	edx		; StringSid
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jz	loc_10007D9A
		mov	ecx, dword_10031F4C
		test	ecx, ecx
		jz	short loc_10007CEE
		mov	eax, dword_10031F48
		test	eax, eax
		jnz	short loc_10007D4E

loc_10007CEE:				; CODE XREF: sub_10007CA5+3Ej
		mov	edi, ds:GetModuleHandleW
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		call	edi ; GetModuleHandleW
		mov	ebx, ds:GetProcAddress
		push	offset aAppcontainerlo ; "AppContainerLookupMoniker"
		push	eax		; hModule
		call	ebx ; GetProcAddress
		test	eax, eax
		jnz	short loc_10007D1C
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerlo ; "AppContainerLookupMoniker"
		push	eax		; hModule
		call	ebx ; GetProcAddress

loc_10007D1C:				; CODE XREF: sub_10007CA5+66j
		push	offset aKernel32_dll_1 ; "kernel32.dll"
		mov	dword_10031F4C,	eax
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerfr ; "AppContainerFreeMemory"
		push	eax		; hModule
		call	ebx ; GetProcAddress
		test	eax, eax
		jnz	short loc_10007D43
		push	offset aKernelbase_dll ; "kernelbase.dll"
		call	edi ; GetModuleHandleW
		push	offset aAppcontainerfr ; "AppContainerFreeMemory"
		push	eax		; hModule
		call	ebx ; GetProcAddress

loc_10007D43:				; CODE XREF: sub_10007CA5+8Dj
		mov	ecx, dword_10031F4C
		mov	dword_10031F48,	eax

loc_10007D4E:				; CODE XREF: sub_10007CA5+47j
		test	ecx, ecx
		jz	short loc_10007D9A
		test	eax, eax
		jz	short loc_10007D9A
		lea	eax, [esp+3Ch+var_28]
		mov	[esp+3Ch+var_28], ebp
		push	eax
		push	[esp+40h+Sid]
		call	ecx ; dword_10031F4C
		test	eax, eax
		js	short loc_10007D9A
		push	[esp+3Ch+var_28] ; void	*
		lea	ecx, [esp+40h+var_20] ;	void *
		call	sub_10001C7F
		push	[esp+3Ch+var_28]
		call	dword_10031F48
		lea	eax, [esp+3Ch+var_20]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003481
		push	ebp
		push	1
		lea	ecx, [esp+44h+var_20]
		call	sub_10002311
		jmp	short loc_10007DA9
; ---------------------------------------------------------------------------

loc_10007D9A:				; CODE XREF: sub_10007CA5+30j
					; sub_10007CA5+ABj ...
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], ebp
		mov	[esi], ax

loc_10007DA9:				; CODE XREF: sub_10007CA5+F3j
		mov	ecx, [esp+3Ch+var_8]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10007CA5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007DBE	proc near		; CODE XREF: sub_10007A6C+87p
					; sub_10007A6C+AFp ...
		mov	edx, [ecx+8]
		mov	eax, edx
		push	esi
		mov	esi, [ecx+4]
		sub	eax, esi
		sar	eax, 3
		cmp	eax, 1
		jnb	short loc_10007E13
		sub	esi, [ecx]
		push	edi
		mov	edi, 1FFFFFFFh
		sar	esi, 3
		mov	eax, edi
		sub	eax, esi
		cmp	eax, 1
		jnb	short loc_10007DF0
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10007DF0:				; CODE XREF: sub_10007DBE+25j
		sub	edx, [ecx]
		inc	esi
		sar	edx, 3
		mov	eax, edx
		shr	eax, 1
		sub	edi, eax
		cmp	edi, edx
		jnb	short loc_10007E04
		xor	edx, edx
		jmp	short loc_10007E06
; ---------------------------------------------------------------------------

loc_10007E04:				; CODE XREF: sub_10007DBE+40j
		add	edx, eax

loc_10007E06:				; CODE XREF: sub_10007DBE+44j
		cmp	edx, esi
		jnb	short loc_10007E0C
		mov	edx, esi

loc_10007E0C:				; CODE XREF: sub_10007DBE+4Aj
		push	edx
		call	sub_10007E17
		pop	edi

loc_10007E13:				; CODE XREF: sub_10007DBE+11j
		pop	esi
		retn	4
sub_10007DBE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E17	proc near		; CODE XREF: sub_10007DBE+4Fp

arg_0		= dword	ptr  4

		push	ebp
		mov	ebp, [esp+4+arg_0]
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, ecx
		test	ebp, ebp
		jz	short loc_10007E47
		cmp	ebp, 1FFFFFFFh
		ja	short loc_10007E41
		mov	eax, ebp
		shl	eax, 3
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jnz	short loc_10007E47

loc_10007E41:				; CODE XREF: sub_10007E17+15j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10007E47:				; CODE XREF: sub_10007E17+Dj
					; sub_10007E17+28j
		mov	ecx, [esi]
		mov	edx, edi
		push	ebx
		mov	ebx, [esi+4]
		jmp	short loc_10007E65
; ---------------------------------------------------------------------------

loc_10007E51:				; CODE XREF: sub_10007E17+50j
		test	edx, edx
		jz	short loc_10007E5F
		mov	eax, [ecx]
		mov	[edx], eax
		mov	eax, [ecx+4]
		mov	[edx+4], eax

loc_10007E5F:				; CODE XREF: sub_10007E17+3Cj
		add	edx, 8
		add	ecx, 8

loc_10007E65:				; CODE XREF: sub_10007E17+38j
		cmp	ecx, ebx
		jnz	short loc_10007E51
		mov	ebx, [esi+4]
		sub	ebx, [esi]
		sar	ebx, 3
		cmp	dword ptr [esi], 0
		jz	short loc_10007E7F
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007E7F:				; CODE XREF: sub_10007E17+5Dj
		lea	eax, [edi+ebp*8]
		mov	[esi], edi
		mov	[esi+8], eax
		lea	eax, [edi+ebx*8]
		pop	ebx
		pop	edi
		mov	[esi+4], eax
		pop	esi
		pop	ebp
		retn	4
sub_10007E17	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007E94	proc near		; DATA XREF: .rdata:1002BC94o

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BC8C
		jz	short loc_10007EAC
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007EAC:				; CODE XREF: sub_10007E94+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_10007E94	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007EB2	proc near		; DATA XREF: .rdata:1002BC88o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10017FFC
		test	[esp+4+arg_0], 1
		jz	short loc_10007EC9
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007EC9:				; CODE XREF: sub_10007EB2+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10007EB2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007ECF	proc near		; CODE XREF: sub_100083E3+4A0p
					; sub_100083E3+512p
		push	ecx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, ecx
		test	edi, edi
		jnz	short loc_10007EE2
		call	ds:GetLastError
		mov	edi, eax

loc_10007EE2:				; CODE XREF: sub_10007ECF+9j
		mov	ecx, esi
		call	sub_100061F8
		test	al, al
		jz	short loc_10007EF7
		push	0		; uExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:TerminateProcess

loc_10007EF7:				; CODE XREF: sub_10007ECF+1Cj
		test	esi, esi
		jz	short loc_10007F0A
		mov	ecx, esi
		call	sub_10017807
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007F0A:				; CODE XREF: sub_10007ECF+2Aj
		push	edi		; dwErrCode
		call	ds:SetLastError
		xor	eax, eax
		pop	edi
		inc	eax
		pop	esi
		pop	ecx
		retn
sub_10007ECF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007F18	proc near		; CODE XREF: sub_10008064+A0p
					; StartAddress+155p

var_4		= dword	ptr -4

		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	esi
		mov	esi, ecx
		push	0FFFFFFFFh	; CompletionEvent
		push	dword ptr [esi]	; WaitHandle
		call	ds:UnregisterWaitEx
		test	eax, eax
		jz	short loc_10007F40
		lea	ecx, [esi+4]
		call	sub_10004646
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10007F40:				; CODE XREF: sub_10007F18+16j
		pop	esi
		pop	ecx
		pop	ecx
		retn
sub_10007F18	endp


; =============== S U B	R O U T	I N E =======================================


sub_10007F44	proc near		; CODE XREF: sub_1000D77D+18p
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	esi, ecx
		push	edi
		push	ebx
		push	ebx
		mov	dword ptr [esi], offset	off_1002BC98
		mov	[esi+4], ebx
		mov	[esi+8], ebx
		mov	[esi+0Ch], ebx
		mov	[esi+28h], ebx
		mov	[esi+2Ch], ebx
		mov	[esi+30h], ebx
		call	sub_1000917F
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		mov	[esi+2Ch], eax
		push	18h
		mov	[esi+34h], ebx
		mov	[esi+38h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_10007F88

loc_10007F82:				; CODE XREF: sub_10007F44+6Ej
					; sub_10007F44+9Aj
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10007F88:				; CODE XREF: sub_10007F44+3Cj
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007F93
		mov	[ecx], eax

loc_10007F93:				; CODE XREF: sub_10007F44+4Bj
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007F9C
		mov	[ecx], eax

loc_10007F9C:				; CODE XREF: sub_10007F44+54j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+34h], eax
		push	14h
		mov	[esi+3Ch], ebx
		mov	[esi+40h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10007F82
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007FBF
		mov	[ecx], eax

loc_10007FBF:				; CODE XREF: sub_10007F44+77j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007FC8
		mov	[ecx], eax

loc_10007FC8:				; CODE XREF: sub_10007F44+80j
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+3Ch], eax
		push	1Ch
		mov	[esi+44h], ebx
		mov	[esi+48h], ebx
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10007F82
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_10007FEB
		mov	[ecx], eax

loc_10007FEB:				; CODE XREF: sub_10007F44+A3j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_10007FF4
		mov	[ecx], eax

loc_10007FF4:				; CODE XREF: sub_10007F44+ACj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi+44h], eax
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_10007F44	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10008003(LPVOID lpParameter)
sub_10008003	proc near		; DATA XREF: .rdata:off_1002BC98o
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		cmp	[esi+4], edi
		jnz	short loc_1000805E
		cmp	[esi+28h], edi
		jnz	short loc_1000805E
		lea	eax, [esi+10h]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		push	edi		; NumberOfConcurrentThreads
		push	edi		; CompletionKey
		push	edi		; ExistingCompletionPort
		push	0FFFFFFFFh	; FileHandle
		call	ds:CreateIoCompletionPort
		mov	[esi+4], eax
		test	eax, eax
		jnz	short loc_10008032
		inc	eax
		jmp	short loc_10008061
; ---------------------------------------------------------------------------

loc_10008032:				; CODE XREF: sub_10008003+2Aj
		push	edi		; lpName
		push	edi		; bInitialState
		push	1		; bManualReset
		push	edi		; lpEventAttributes
		call	ds:CreateEventW
		push	edi		; lpThreadId
		push	edi		; dwCreationFlags
		push	esi		; lpParameter
		push	offset StartAddress ; lpStartAddress
		push	edi		; dwStackSize
		push	edi		; lpThreadAttributes
		mov	[esi+8], eax
		call	ds:CreateThread
		xor	ecx, ecx
		mov	[esi+0Ch], eax
		test	eax, eax
		setz	cl
		mov	eax, ecx
		jmp	short loc_10008061
; ---------------------------------------------------------------------------

loc_1000805E:				; CODE XREF: sub_10008003+9j
					; sub_10008003+Ej
		push	8
		pop	eax

loc_10008061:				; CODE XREF: sub_10008003+2Dj
					; sub_10008003+59j
		pop	edi
		pop	esi
		retn
sub_10008003	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008064	proc near		; CODE XREF: sub_1000D77D+4Ap

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		cmp	dword ptr [ebx+4], 0
		mov	dword ptr [ebx], offset	off_1002BC98
		jz	loc_10008154
		push	0		; lpOverlapped
		push	2		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [ebx+4] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		push	dword ptr [ebx+4] ; hObject
		mov	ebp, ds:CloseHandle
		call	ebp ; CloseHandle
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+0Ch] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	loc_10008154
		mov	eax, [ebx+2Ch]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100080DC

loc_100080C3:				; CODE XREF: sub_10008064+76j
		mov	edi, [esi+8]
		mov	ecx, edi
		call	sub_100081CF
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		cmp	esi, [ebx+2Ch]
		jnz	short loc_100080C3

loc_100080DC:				; CODE XREF: sub_10008064+5Dj
		push	dword ptr [ebx+0Ch] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+28h]
		test	ecx, ecx
		jz	short loc_100080EF
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

loc_100080EF:				; CODE XREF: sub_10008064+82j
		push	dword ptr [ebx+8] ; hObject
		call	ebp ; CloseHandle
		mov	ecx, [ebx+34h]
		mov	eax, [ecx]
		mov	[esp+18h+var_4], eax
		cmp	eax, ecx
		jz	short loc_1000811B

loc_10008101:				; CODE XREF: sub_10008064+B5j
		mov	ecx, [eax+14h]
		call	sub_10007F18
		lea	ecx, [esp+18h+var_4]
		call	sub_10004B87
		mov	eax, [esp+18h+var_4]
		cmp	eax, [ebx+34h]
		jnz	short loc_10008101

loc_1000811B:				; CODE XREF: sub_10008064+9Bj
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000812B
		lea	eax, [ebx+10h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection

loc_1000812B:				; CODE XREF: sub_10008064+BBj
		mov	eax, [ebx+44h]
		mov	esi, [eax]
		mov	[esp+18h+var_4], esi
		cmp	esi, eax
		jz	short loc_10008154

loc_10008138:				; CODE XREF: sub_10008064+EEj
		push	dword ptr [esi+14h] ; hObject
		call	ebp ; CloseHandle
		push	dword ptr [esi+18h] ; hObject
		call	ebp ; CloseHandle
		lea	ecx, [esp+18h+var_4]
		call	sub_10004B87
		mov	esi, [esp+18h+var_4]
		cmp	esi, [ebx+44h]
		jnz	short loc_10008138

loc_10008154:				; CODE XREF: sub_10008064+1Dj
					; sub_10008064+50j ...
		lea	ecx, [ebx+44h]
		call	sub_1000908B
		lea	esi, [ebx+3Ch]
		mov	eax, [esi]
		mov	ecx, esi
		push	eax
		push	dword ptr [eax]
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_100090B5
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		lea	esi, [ebx+34h]
		mov	eax, [esi]
		mov	ecx, esi
		push	eax
		push	dword ptr [eax]
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_100090B5
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		lea	ecx, [ebx+2Ch]
		call	sub_10008D00
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10008064	endp


; =============== S U B	R O U T	I N E =======================================


sub_100081A6	proc near		; DATA XREF: .rdata:1002BC9Co
		push	esi
		push	0F8h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		xor	esi, esi
		pop	ecx
		test	eax, eax
		jz	short loc_100081C2
		mov	ecx, eax
		call	sub_10014386
		jmp	short loc_100081C4
; ---------------------------------------------------------------------------

loc_100081C2:				; CODE XREF: sub_100081A6+11j
		mov	eax, esi

loc_100081C4:				; CODE XREF: sub_100081A6+1Aj
		test	eax, eax
		jz	short loc_100081CB
		lea	esi, [eax+10h]

loc_100081CB:				; CODE XREF: sub_100081A6+20j
		mov	eax, esi
		pop	esi
		retn
sub_100081A6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100081CF	proc near		; CODE XREF: sub_10008064+64p
					; StartAddress:loc_1000832Ap

var_4		= dword	ptr -4

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	[esp+0Ch+var_4], edi
		cmp	[esi+4], edi
		jz	short loc_10008208
		push	edi		; uExitCode
		push	dword ptr [esi]	; hJob
		call	ds:TerminateJobObject
		push	dword ptr [esi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [esi]
		mov	ecx, [esi+4]
		call	sub_10014FFD
		mov	ecx, [esi+4]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		mov	[esi+4], edi

loc_10008208:				; CODE XREF: sub_100081CF+Ej
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100081CF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; DWORD	__stdcall StartAddress(LPVOID lpThreadParameter)
StartAddress	proc near		; DATA XREF: sub_10008003+3Do

var_238		= dword	ptr -238h
Overlapped	= dword	ptr -234h
var_230		= dword	ptr -230h
NumberOfBytesTransferred= dword	ptr -22Ch
CompletionKey	= dword	ptr -228h
var_224		= dword	ptr -224h
CompletionPort	= dword	ptr -220h
hEvent		= dword	ptr -21Ch
var_218		= dword	ptr -218h
var_214		= byte ptr -214h
var_210		= byte ptr -210h
var_160		= byte ptr -160h
var_B0		= byte ptr -0B0h
lpThreadParameter= dword ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 23Ch
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+lpThreadParameter]
		xor	ebx, ebx
		mov	[esp+248h+var_238], ebx
		test	edi, edi
		jz	loc_100083D3
		call	sub_10004592
		mov	eax, [edi+4]
		xor	esi, esi
		mov	[esp+248h+CompletionPort], eax
		mov	eax, [edi+8]
		mov	[esp+248h+hEvent], eax
		mov	[esp+248h+var_230], esi
		push	eax
		jmp	loc_10008322
; ---------------------------------------------------------------------------

loc_1000824B:				; CODE XREF: StartAddress+1C1j
		mov	ecx, [esp+248h+CompletionKey]
		cmp	ecx, 3
		jbe	loc_10008331
		mov	eax, [esp+248h+NumberOfBytesTransferred]
		cmp	eax, 3
		jz	loc_100083A2
		cmp	eax, 4
		jz	loc_1000832A
		cmp	eax, 6
		jz	loc_10008310
		jbe	loc_100082FF
		cmp	eax, 8
		jbe	short loc_100082AC
		cmp	eax, 9
		jnz	short loc_100082FF
		push	1B64h		; uExitCode
		push	dword ptr [ecx]	; hJob
		call	ds:TerminateJobObject
		test	bl, 2
		jz	loc_100083A2
		and	ebx, 0FFFFFFFDh
		lea	ecx, [esp+248h+var_B0]
		jmp	loc_10008399
; ---------------------------------------------------------------------------

loc_100082AC:				; CODE XREF: StartAddress+74j
		lea	esi, [edi+10h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [edi+3Ch]
		mov	[esp+248h+var_224], eax
		lea	eax, [esp+248h+var_224]
		push	eax
		call	sub_10008FAD
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	esi, [esp+248h+var_230]
		dec	esi
		mov	[esp+248h+var_230], esi
		jnz	short loc_100082E7
		push	[esp+248h+hEvent] ; hEvent
		call	ds:SetEvent

loc_100082E7:				; CODE XREF: StartAddress+CFj
		test	bl, 1
		jz	loc_100083A2
		and	ebx, 0FFFFFFFEh
		lea	ecx, [esp+248h+var_160]
		jmp	loc_10008399
; ---------------------------------------------------------------------------

loc_100082FF:				; CODE XREF: StartAddress+6Bj
					; StartAddress+79j
		test	bl, 4
		jz	loc_100083A2
		and	ebx, 0FFFFFFFBh
		jmp	loc_10008395
; ---------------------------------------------------------------------------

loc_10008310:				; CODE XREF: StartAddress+65j
		inc	esi
		mov	[esp+248h+var_230], esi
		cmp	esi, 1
		jnz	loc_100083A2
		push	[esp+248h+hEvent] ; hEvent

loc_10008322:				; CODE XREF: StartAddress+3Aj
		call	ds:ResetEvent
		jmp	short loc_100083A2
; ---------------------------------------------------------------------------

loc_1000832A:				; CODE XREF: StartAddress+5Cj
		call	sub_100081CF
		jmp	short loc_100083A2
; ---------------------------------------------------------------------------

loc_10008331:				; CODE XREF: StartAddress+46j
		cmp	ecx, 1
		jnz	short loc_10008388
		lea	ebx, [edi+10h]
		push	ebx		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [esp+248h+Overlapped]
		lea	ecx, [edi+34h]
		mov	[esp+248h+var_224], eax
		lea	eax, [esp+248h+var_224]
		push	eax
		lea	eax, [esp+24Ch+var_218]
		push	eax
		call	sub_1000903F
		mov	esi, [esp+248h+var_218]
		mov	ecx, [esi+14h]
		call	sub_10007F18
		push	esi
		lea	eax, [esp+24Ch+var_214]
		push	eax
		lea	ecx, [edi+34h]
		call	sub_10008D80
		push	ebx		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	ebx, [esp+248h+var_238]
		mov	edi, [ebp+lpThreadParameter]
		mov	esi, [esp+248h+var_230]
		jmp	short loc_100083A2
; ---------------------------------------------------------------------------

loc_10008388:				; CODE XREF: StartAddress+128j
		cmp	ecx, 2
		jz	short loc_100083DF
		test	bl, 8
		jz	short loc_100083A2
		and	ebx, 0FFFFFFF7h

loc_10008395:				; CODE XREF: StartAddress+FFj
		lea	ecx, [esp+248h+var_210]

loc_10008399:				; CODE XREF: StartAddress+9Bj
					; StartAddress+EEj
		mov	[esp+248h+var_238], ebx
		call	sub_10001BED

loc_100083A2:				; CODE XREF: StartAddress+53j
					; StartAddress+8Bj ...
		xor	eax, eax
		mov	[esp+248h+NumberOfBytesTransferred], eax
		mov	[esp+248h+CompletionKey], eax
		mov	[esp+248h+Overlapped], eax
		lea	eax, [esp+248h+Overlapped]
		push	0FFFFFFFFh	; dwMilliseconds
		push	eax		; lpOverlapped
		lea	eax, [esp+250h+CompletionKey]
		push	eax		; lpCompletionKey
		lea	eax, [esp+254h+NumberOfBytesTransferred]
		push	eax		; lpNumberOfBytesTransferred
		push	[esp+258h+CompletionPort] ; CompletionPort
		call	ds:GetQueuedCompletionStatus
		test	eax, eax
		jnz	loc_1000824B

loc_100083D3:				; CODE XREF: StartAddress+1Aj
		xor	eax, eax
		inc	eax

loc_100083D6:				; CODE XREF: StartAddress+1D5j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_100083DF:				; CODE XREF: StartAddress+17Fj
		xor	eax, eax
		jmp	short loc_100083D6
StartAddress	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100083E3	proc near		; DATA XREF: .rdata:1002BCA0o

var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
hExistingToken	= dword	ptr -0C0h
DuplicateTokenHandle= dword ptr	-0BCh
var_B8		= dword	ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= dword	ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
lpCriticalSection= dword ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= dword	ptr -84h
var_80		= dword	ptr -80h
var_7C		= dword	ptr -7Ch
JobObjectInformation= dword ptr	-78h
var_74		= dword	ptr -74h
var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_3C		= dword	ptr -3Ch
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_1C		= dword	ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0D4h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0D4h+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+0D4h+lpCriticalSection], 0
		mov	[esp+0D4h+var_B8], eax
		push	ebx
		mov	ebx, ecx
		mov	ecx, [ebp+arg_4]
		mov	[esp+0D8h+var_7C], ecx
		mov	ecx, [ebp+arg_C]
		mov	[esp+0D8h+var_AC], ebx
		mov	[esp+0D8h+var_90], ecx
		push	esi
		mov	esi, [ebp+arg_8]
		mov	[esp+0DCh+var_B4], esi
		push	edi
		test	eax, eax
		jnz	short loc_10008433

loc_1000842B:				; CODE XREF: sub_100083E3+52j
		push	2
		pop	eax
		jmp	loc_100089CA
; ---------------------------------------------------------------------------

loc_10008433:				; CODE XREF: sub_100083E3+46j
		test	esi, esi
		jz	short loc_1000842B
		mov	eax, dword_10031F94
		test	al, 1
		jnz	short loc_10008453
		or	eax, 1
		mov	dword_10031F94,	eax
		call	ds:GetCurrentThreadId
		mov	dword_10031F90,	eax

loc_10008453:				; CODE XREF: sub_100083E3+5Bj
		lea	eax, [ebx+10h]
		push	eax		; lpCriticalSection
		mov	[esp+0E4h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		lea	ebx, [esi-10h]
		mov	eax, [ebx+0F0h]
		mov	[esp+0E0h+var_C8], ebx
		test	eax, eax
		jz	short loc_10008477
		cmp	dword ptr [eax], 0
		jnz	short loc_10008479

loc_10008477:				; CODE XREF: sub_100083E3+8Dj
		xor	eax, eax

loc_10008479:				; CODE XREF: sub_100083E3+92j
		test	eax, eax
		jnz	loc_100085A7
		add	ebx, 10h
		mov	ecx, ebx
		mov	eax, [ebx]
		call	dword ptr [eax+0Ch]
		mov	edx, [ebx]
		mov	esi, eax
		mov	ecx, ebx
		shl	esi, 3
		call	dword ptr [edx+10h]
		mov	edx, [ebx]
		mov	edi, eax
		or	edi, esi
		mov	ecx, ebx
		shl	edi, 3
		call	dword ptr [edx+30h]
		mov	esi, eax
		lea	eax, [esp+0E0h+var_CC]
		or	esi, edi
		mov	edi, [esp+0E0h+var_AC]
		push	eax
		lea	eax, [esp+0E4h+var_D0]
		mov	[esp+0E4h+var_CC], esi
		add	edi, 44h
		push	eax
		mov	ecx, edi
		call	sub_10004AD5
		mov	ecx, [edi]
		mov	eax, [esp+0E0h+var_D0]
		cmp	eax, ecx
		jz	short loc_100084D8
		mov	[esp+0E0h+var_D0], eax
		cmp	esi, [eax+10h]
		jnb	short loc_100084DC

loc_100084D8:				; CODE XREF: sub_100083E3+EAj
		mov	[esp+0E0h+var_D0], ecx

loc_100084DC:				; CODE XREF: sub_100083E3+F3j
		mov	ebx, [esp+0E0h+var_C8]
		lea	eax, [esp+0E0h+var_D0]
		mov	eax, [eax]
		cmp	eax, ecx
		jz	short loc_100084FA
		mov	ecx, [eax+14h]
		mov	[esp+0E0h+DuplicateTokenHandle], ecx
		mov	eax, [eax+18h]
		mov	[esp+0E0h+hExistingToken], eax
		jmp	short loc_1000856F
; ---------------------------------------------------------------------------

loc_100084FA:				; CODE XREF: sub_100083E3+105j
		lea	eax, [esp+0E0h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0E4h+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10014E0C
		mov	esi, eax
		test	esi, esi
		jnz	loc_100089BE
		mov	eax, [esp+0E0h+hExistingToken]
		mov	ecx, edi
		mov	esi, [esp+0E0h+DuplicateTokenHandle]
		mov	[esp+0E0h+var_C8], eax
		lea	eax, [esp+0E0h+var_CC]
		push	eax
		lea	eax, [esp+0E4h+var_D0]
		push	eax
		call	sub_10004AD5
		mov	eax, [esp+0E0h+var_D0]
		cmp	eax, [edi]
		jz	short loc_10008543
		mov	ecx, [esp+0E0h+var_CC]
		cmp	ecx, [eax+10h]
		jnb	short loc_10008561

loc_10008543:				; CODE XREF: sub_100083E3+155j
		lea	ecx, [esp+0E0h+var_CC]
		push	ecx
		mov	[esp+0E4h+var_D0], ecx
		lea	ecx, [esp+0E4h+var_D0]
		push	ecx
		push	ecx
		push	eax
		lea	eax, [esp+0F0h+var_A4]
		mov	ecx, edi
		push	eax
		call	sub_10009217
		mov	eax, [eax]

loc_10008561:				; CODE XREF: sub_100083E3+15Ej
		mov	ecx, [esp+0E0h+var_C8]
		mov	[eax+14h], esi
		mov	[eax+18h], ecx
		mov	ecx, [esp+0E0h+DuplicateTokenHandle]

loc_1000856F:				; CODE XREF: sub_100083E3+115j
		lea	eax, [esp+0E0h+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	ecx		; ExistingTokenHandle
		call	ds:DuplicateToken
		test	eax, eax
		jz	short loc_1000859F
		lea	eax, [esp+0E0h+hExistingToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	0		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	[esp+0F4h+hExistingToken] ; hExistingToken
		call	ds:DuplicateTokenEx
		test	eax, eax
		jnz	short loc_100085C2

loc_1000859F:				; CODE XREF: sub_100083E3+19Cj
		xor	esi, esi
		inc	esi
		jmp	loc_100089BE
; ---------------------------------------------------------------------------

loc_100085A7:				; CODE XREF: sub_100083E3+98j
		lea	eax, [esp+0E0h+hExistingToken]
		mov	ecx, ebx
		push	eax		; lpTargetHandle
		lea	eax, [esp+0E4h+DuplicateTokenHandle]
		push	eax		; LPHANDLE
		call	sub_10014E0C
		mov	esi, eax
		test	esi, esi
		jnz	loc_100089BE

loc_100085C2:				; CODE XREF: sub_100083E3+1BAj
		push	[esp+0E0h+DuplicateTokenHandle]
		and	[esp+0E4h+var_A8], 0
		lea	ecx, [esp+0E4h+var_A8]
		call	sub_10004610
		push	[esp+0E0h+hExistingToken]
		and	[esp+0E4h+var_B0], 0
		lea	ecx, [esp+0E4h+var_B0]
		call	sub_10004610
		lea	eax, [esp+0E0h+var_D0]
		mov	ecx, ebx
		push	eax
		call	sub_10014DBC
		mov	esi, eax
		test	esi, esi
		jnz	loc_100089AC
		push	[esp+0E0h+var_D0]
		and	[esp+0E4h+var_C4], eax
		lea	ecx, [esp+0E4h+var_C4]
		call	sub_10004610
		lea	ecx, [esp+0E0h+var_68] ; void *
		call	sub_100062BD
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		lea	edx, [esp+0E0h+var_1C]
		push	edx
		call	dword ptr [eax+20h]
		cmp	[esp+0E0h+var_C], esi
		jz	short loc_1000864E
		cmp	[esp+0E0h+var_8], 8
		mov	eax, [esp+0E0h+var_1C]
		jnb	short loc_10008647
		lea	eax, [esp+0E0h+var_1C]

loc_10008647:				; CODE XREF: sub_100083E3+25Bj
		mov	[esp+0E0h+var_60], eax

loc_1000864E:				; CODE XREF: sub_100083E3+24Aj
		mov	byte ptr [esp+0E0h+var_C8], 0
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jl	loc_10008783
		mov	edi, [ebx+0F0h]
		xor	eax, eax
		mov	[esp+0E0h+var_CC], eax
		test	edi, edi
		jz	short loc_10008675
		cmp	[edi], eax
		jnz	short loc_10008677

loc_10008675:				; CODE XREF: sub_100083E3+28Cj
		xor	edi, edi

loc_10008677:				; CODE XREF: sub_100083E3+290j
		test	edi, edi
		jz	short loc_10008682
		xor	eax, eax
		inc	eax
		mov	[esp+0E0h+var_CC], eax

loc_10008682:				; CODE XREF: sub_100083E3+296j
		mov	ecx, [esp+0E0h+var_B4]
		mov	eax, [ecx]
		call	dword ptr [eax+44h]
		push	edx
		push	eax
		lea	edx, [esp+0E8h+var_B4]
		lea	ecx, [esp+0E8h+var_A0]
		call	sub_100104B5
		mov	eax, [esp+0E8h+var_A0]
		or	eax, [esp+0E8h+var_9C]
		mov	eax, [esp+0E8h+var_CC]
		pop	ecx
		pop	ecx
		jz	short loc_100086AB
		inc	eax

loc_100086AB:				; CODE XREF: sub_100083E3+2C5j
		mov	edx, [ebx+50h]
		xor	esi, esi
		mov	ecx, [ebx+54h]
		mov	[esp+0E0h+var_D0], edx
		mov	[esp+0E0h+var_A4], ecx
		mov	[esp+0E0h+var_CC], esi
		cmp	edx, 0FFFFFFFFh
		jz	short loc_100086CD
		inc	esi
		mov	[esp+0E0h+JobObjectInformation], edx
		mov	[esp+0E0h+var_CC], esi

loc_100086CD:				; CODE XREF: sub_100083E3+2DFj
		cmp	ecx, edx
		jz	short loc_100086DF
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_100086DF
		mov	[esp+esi*4+0E0h+JobObjectInformation], ecx
		inc	esi
		mov	[esp+0E0h+var_CC], esi

loc_100086DF:				; CODE XREF: sub_100083E3+2ECj
					; sub_100083E3+2F1j
		test	esi, esi
		jz	short loc_100086E4
		inc	eax

loc_100086E4:				; CODE XREF: sub_100083E3+2FEj
		push	eax
		lea	ecx, [esp+0E4h+var_68]
		call	sub_10006340
		test	al, al
		jz	short loc_1000876A
		test	edi, edi
		jz	short loc_10008721
		cmp	dword ptr [edi], 0
		jnz	short loc_100086FF
		push	0Eh
		jmp	short loc_1000876C
; ---------------------------------------------------------------------------

loc_100086FF:				; CODE XREF: sub_100083E3+316j
		push	10h
		pop	esi
		push	esi
		push	edi
		push	20009h
		lea	ecx, [esp+0ECh+var_68]
		call	sub_100063A5
		test	al, al
		jz	loc_1000896E
		mov	esi, [esp+0E0h+var_CC]

loc_10008721:				; CODE XREF: sub_100083E3+311j
		mov	eax, [esp+0E0h+var_A0]
		or	eax, [esp+0E0h+var_9C]
		jz	short loc_10008749
		push	[esp+0E0h+var_B4]
		lea	eax, [esp+0E4h+var_A0]
		push	eax
		push	20007h
		lea	ecx, [esp+0ECh+var_68]
		call	sub_100063A5
		test	al, al
		jz	short loc_1000876A

loc_10008749:				; CODE XREF: sub_100083E3+346j
		test	esi, esi
		jz	short loc_100087BF
		mov	eax, esi
		lea	ecx, [esp+0E0h+var_68]
		shl	eax, 2
		push	eax
		lea	eax, [esp+0E4h+JobObjectInformation]
		push	eax
		push	20002h
		call	sub_100063A5
		test	al, al
		jnz	short loc_10008772

loc_1000876A:				; CODE XREF: sub_100083E3+30Dj
					; sub_100083E3+364j
		push	11h

loc_1000876C:				; CODE XREF: sub_100083E3+31Aj
		pop	esi
		jmp	loc_1000896E
; ---------------------------------------------------------------------------

loc_10008772:				; CODE XREF: sub_100083E3+385j
		mov	eax, [esp+0E0h+var_D0]
		mov	[esp+0E0h+var_2C], eax
		mov	eax, [esp+0E0h+var_A4]
		jmp	short loc_100087A0
; ---------------------------------------------------------------------------

loc_10008783:				; CODE XREF: sub_100083E3+278j
		push	offset aMoz_win_inheri ; "MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA"
		call	ds:getenv
		pop	ecx
		test	eax, eax
		jz	short loc_100087BF
		mov	eax, [ebx+50h]
		mov	[esp+0E0h+var_2C], eax
		mov	eax, [ebx+54h]

loc_100087A0:				; CODE XREF: sub_100083E3+39Ej
		or	[esp+0E0h+var_3C], 100h
		or	[esp+0E0h+var_30], 0FFFFFFFFh
		mov	byte ptr [esp+0E0h+var_C8], 1
		mov	[esp+0E0h+var_28], eax

loc_100087BF:				; CODE XREF: sub_100083E3+368j
					; sub_100083E3+3AEj
		mov	edi, [esp+0E0h+var_AC]
		cmp	dword ptr [edi+28h], 0
		jnz	short loc_10008801
		push	24h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100087FC
		xor	eax, eax
		mov	dword ptr [esi], offset	off_1002BC80
		push	eax
		push	eax
		mov	[esi+4], eax
		mov	[esi+8], eax
		call	sub_1000914C
		mov	[esi+4], eax
		lea	eax, [esi+0Ch]
		push	eax		; lpCriticalSection
		call	ds:InitializeCriticalSection
		jmp	short loc_100087FE
; ---------------------------------------------------------------------------

loc_100087FC:				; CODE XREF: sub_100083E3+3F3j
		xor	esi, esi

loc_100087FE:				; CODE XREF: sub_100083E3+417j
		mov	[edi+28h], esi

loc_10008801:				; CODE XREF: sub_100083E3+3E4j
		and	[esp+0E0h+var_8C], 0
		and	[esp+0E0h+var_88], 0
		and	[esp+0E0h+var_84], 0
		and	[esp+0E0h+var_80], 0
		push	30h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_1000884C
		push	dword ptr [edi+28h]
		lea	ecx, [esp+0E4h+var_B0]
		push	[esp+0E4h+var_C4]
		call	sub_1000629D
		push	eax
		push	ecx
		lea	ecx, [esp+0F0h+var_A8]
		call	sub_1000629D
		pop	ecx
		push	eax
		mov	ecx, esi
		call	sub_100177B7
		mov	esi, eax
		jmp	short loc_1000884E
; ---------------------------------------------------------------------------

loc_1000884C:				; CODE XREF: sub_100083E3+43Fj
		xor	esi, esi

loc_1000884E:				; CODE XREF: sub_100083E3+467j
		lea	eax, [esp+0E0h+var_8C]
		mov	ecx, esi
		push	eax		; int
		lea	eax, [esp+0E4h+var_68]
		push	eax		; int
		push	[esp+0E8h+var_C8] ; int
		push	[esp+0ECh+var_7C] ; wchar_t *
		push	[esp+0F0h+var_B8] ; wchar_t *
		call	sub_100178B5
		test	eax, eax
		jz	short loc_10008873
		mov	edx, eax
		jmp	short loc_10008881
; ---------------------------------------------------------------------------

loc_10008873:				; CODE XREF: sub_100083E3+48Aj
		push	esi
		mov	ecx, ebx
		call	sub_10014EC9
		test	al, al
		jnz	short loc_1000888F
		xor	edx, edx

loc_10008881:				; CODE XREF: sub_100083E3+48Ej
		mov	ecx, esi
		call	sub_10007ECF
		mov	esi, eax
		jmp	loc_10008965
; ---------------------------------------------------------------------------

loc_1000888F:				; CODE XREF: sub_100083E3+49Aj
		lea	ecx, [ebx+10h]
		mov	eax, [ecx]
		call	dword ptr [eax]
		cmp	[esp+0E0h+var_C4], 0
		jz	loc_1000893C
		cmp	[esp+0E0h+var_C4], 0FFFFFFFFh
		jz	loc_1000893C
		push	8
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_100088CB
		lea	ecx, [esp+0E0h+var_C4]
		call	sub_1000629D
		mov	[edi], eax
		mov	[edi+4], ebx
		jmp	short loc_100088CD
; ---------------------------------------------------------------------------

loc_100088CB:				; CODE XREF: sub_100083E3+4D6j
		xor	edi, edi

loc_100088CD:				; CODE XREF: sub_100083E3+4E6j
		mov	ebx, [esp+0E0h+var_AC]
		push	8		; cbJobObjectInformationLength
		mov	[esp+0E4h+JobObjectInformation], edi
		mov	eax, [ebx+4]
		mov	[esp+0E4h+var_74], eax
		lea	eax, [esp+0E4h+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	7		; JobObjectInformationClass
		push	dword ptr [edi]	; hJob
		call	ds:SetInformationJobObject
		test	eax, eax
		jnz	short loc_10008906
		xor	edx, edx
		mov	ecx, esi
		call	sub_10007ECF
		push	edi
		mov	esi, eax
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		jmp	short loc_10008965
; ---------------------------------------------------------------------------

loc_10008906:				; CODE XREF: sub_100083E3+50Cj
		lea	eax, [esp+0E0h+var_B8]
		mov	[esp+0E0h+var_B8], edi
		push	eax
		lea	ecx, [ebx+2Ch]
		call	sub_10008D33
		mov	eax, [esp+0E0h+var_84]
		mov	[esp+0E0h+var_B8], eax
		movzx	eax, byte_10031F22
		push	eax
		lea	eax, [esp+0E4h+var_B8]
		push	eax
		push	ecx
		lea	eax, [esp+0ECh+JobObjectInformation]
		push	eax
		lea	ecx, [ebx+3Ch]
		call	sub_10009281
		jmp	short loc_1000894B
; ---------------------------------------------------------------------------

loc_1000893C:				; CODE XREF: sub_100083E3+4B8j
					; sub_100083E3+4C3j
		cmp	dword ptr [edi+40h], 0
		jnz	short loc_1000894B
		push	dword ptr [edi+8] ; hEvent
		call	ds:SetEvent

loc_1000894B:				; CODE XREF: sub_100083E3+557j
					; sub_100083E3+55Dj
		lea	eax, [esp+0E0h+JobObjectInformation]
		push	eax
		lea	ecx, [esp+0E4h+var_8C]
		call	sub_1000625C
		mov	edi, [esp+0E0h+var_90]
		mov	esi, eax
		movsd
		movsd
		movsd
		movsd
		xor	esi, esi

loc_10008965:				; CODE XREF: sub_100083E3+4A7j
					; sub_100083E3+521j
		lea	ecx, [esp+0E0h+var_8C]
		call	sub_100061CB

loc_1000896E:				; CODE XREF: sub_100083E3+334j
					; sub_100083E3+38Aj
		push	0
		push	1
		lea	ecx, [esp+0E8h+var_1C]
		call	sub_10002311
		cmp	[esp+0E0h+var_24], 0
		jz	short loc_100089A3
		push	[esp+0E0h+var_24]
		call	dword_10031F30
		push	[esp+0E0h+var_24]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_100089A3:				; CODE XREF: sub_100083E3+5A3j
		lea	ecx, [esp+0E0h+var_C4]
		call	sub_10004646

loc_100089AC:				; CODE XREF: sub_100083E3+213j
		lea	ecx, [esp+0E0h+var_B0]
		call	sub_10004646
		lea	ecx, [esp+0E0h+var_A8]
		call	sub_10004646

loc_100089BE:				; CODE XREF: sub_100083E3+12Cj
					; sub_100083E3+1BFj ...
		push	[esp+0E0h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	eax, esi

loc_100089CA:				; CODE XREF: sub_100083E3+4Bj
		mov	ecx, [esp+0E0h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_100083E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_100089E1	proc near		; DATA XREF: .rdata:1002BCA4o
		push	0FFFFFFFFh	; dwMilliseconds
		push	dword ptr [ecx+8] ; hHandle
		call	ds:WaitForSingleObject
		xor	eax, eax
		retn
sub_100089E1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100089EF	proc near		; CODE XREF: sub_1000D6D6+2Fp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ecx
		push	esi
		push	edi
		lea	ebp, [ebx+10h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebx+3Ch]
		mov	esi, eax
		mov	edi, [esp+14h+arg_0]
		mov	edx, esi
		mov	ecx, [esi+4]
		jmp	short loc_10008A1E
; ---------------------------------------------------------------------------

loc_10008A10:				; CODE XREF: sub_100089EF+33j
		cmp	[ecx+10h], edi
		jnb	short loc_10008A1A
		mov	ecx, [ecx+8]
		jmp	short loc_10008A1E
; ---------------------------------------------------------------------------

loc_10008A1A:				; CODE XREF: sub_100089EF+24j
		mov	edx, ecx
		mov	ecx, [ecx]

loc_10008A1E:				; CODE XREF: sub_100089EF+1Fj
					; sub_100089EF+29j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008A10
		cmp	edx, esi
		jz	short loc_10008A31
		cmp	edi, [edx+10h]
		mov	[esp+14h+var_4], edx
		jnb	short loc_10008A35

loc_10008A31:				; CODE XREF: sub_100089EF+37j
		mov	[esp+14h+var_4], esi

loc_10008A35:				; CODE XREF: sub_100089EF+40j
		lea	ecx, [esp+14h+var_4]
		cmp	[ecx], eax
		jnz	short loc_10008A5A
		lea	eax, [esp+14h+arg_0]
		push	eax
		lea	eax, [esp+18h+var_4]
		push	eax
		lea	ecx, [ebx+34h]
		call	sub_1000903F
		mov	eax, [eax]
		cmp	eax, [ebx+34h]
		jnz	short loc_10008A5A
		xor	bl, bl
		jmp	short loc_10008A5C
; ---------------------------------------------------------------------------

loc_10008A5A:				; CODE XREF: sub_100089EF+4Cj
					; sub_100089EF+65j
		mov	bl, 1

loc_10008A5C:				; CODE XREF: sub_100089EF+69j
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		pop	ecx
		retn	4
sub_100089EF	endp


; =============== S U B	R O U T	I N E =======================================


; void __stdcall Callback(PVOID, BOOLEAN)
Callback	proc near		; DATA XREF: sub_10008A84+B5o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	dword ptr [eax+8] ; lpOverlapped
		push	1		; dwCompletionKey
		push	0		; dwNumberOfBytesTransferred
		push	dword ptr [eax+0Ch] ; CompletionPort
		call	ds:PostQueuedCompletionStatus
		retn	8
Callback	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10008A84(HANDLE Process)
sub_10008A84	proc near		; DATA XREF: .rdata:1002BCA8o

TargetHandle	= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
Process		= dword	ptr  4

		sub	esp, 14h
		push	ebx
		push	esi
		push	edi
		mov	ebx, ecx
		push	10h
		mov	[esp+24h+var_10], ebx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10008ABB
		push	[esp+20h+Process] ; Process
		mov	edi, [ebx+4]
		call	ds:GetProcessId
		xor	ebx, ebx
		mov	[esi], ebx
		mov	[esi+4], ebx
		mov	[esi+8], eax
		mov	[esi+0Ch], edi
		jmp	short loc_10008ABF
; ---------------------------------------------------------------------------

loc_10008ABB:				; CODE XREF: sub_10008A84+19j
		xor	ebx, ebx
		mov	esi, ebx

loc_10008ABF:				; CODE XREF: sub_10008A84+35j
		push	ebp
		lea	ebp, [esi+8]
		cmp	[ebp+0], ebx
		jz	loc_10008B68
		mov	edi, ds:GetCurrentProcess
		lea	eax, [esp+24h+TargetHandle]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		push	100000h		; dwDesiredAccess
		push	eax		; lpTargetHandle
		call	edi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+38h+Process] ; hSourceHandle
		call	edi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10008B68
		push	[esp+24h+TargetHandle]
		lea	ecx, [esi+4]
		call	sub_10004610
		mov	edi, [esp+24h+var_10]
		lea	eax, [edi+10h]
		push	eax		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	eax, [ebp+0]
		lea	ecx, [esp+24h+var_10]
		push	ecx
		lea	ecx, [esp+28h+var_8]
		mov	[esp+28h+var_10], eax
		push	ecx
		lea	ecx, [edi+34h]
		mov	[esp+2Ch+var_C], esi
		call	sub_100091B2
		cmp	byte ptr [eax+4], 0
		jnz	short loc_10008B34
		push	2
		pop	ebx
		jmp	short loc_10008B5C
; ---------------------------------------------------------------------------

loc_10008B34:				; CODE XREF: sub_10008A84+A9j
		push	0Ch		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	esi		; Context
		push	offset Callback	; Callback
		push	dword ptr [esi+4] ; hObject
		push	esi		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jnz	short loc_10008B5A
		push	ebp
		lea	ecx, [edi+34h]
		call	sub_10008FAD
		xor	ebx, ebx
		inc	ebx
		jmp	short loc_10008B5C
; ---------------------------------------------------------------------------

loc_10008B5A:				; CODE XREF: sub_10008A84+C6j
		mov	esi, ebx

loc_10008B5C:				; CODE XREF: sub_10008A84+AEj
					; sub_10008A84+D4j
		lea	eax, [edi+10h]
		push	eax		; lpCriticalSection
		call	ds:LeaveCriticalSection
		jmp	short loc_10008B6B
; ---------------------------------------------------------------------------

loc_10008B68:				; CODE XREF: sub_10008A84+42j
					; sub_10008A84+6Cj
		xor	ebx, ebx
		inc	ebx

loc_10008B6B:				; CODE XREF: sub_10008A84+E2j
		pop	ebp
		test	esi, esi
		jz	short loc_10008B80
		lea	ecx, [esi+4]
		call	sub_10004646
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10008B80:				; CODE XREF: sub_10008A84+EAj
		pop	edi
		pop	esi
		mov	eax, ebx
		pop	ebx
		add	esp, 14h
		retn	4
sub_10008A84	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10008B8B(void *, void *)
sub_10008B8B	proc near		; DATA XREF: .rdata:1002BCACo

StringSid	= word ptr -4Ch
var_34		= byte ptr -34h
var_24		= dword	ptr -24h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		call	sub_100063D2
		cmp	dword ptr [eax], 5
		jge	short loc_10008BBA
		push	3
		pop	eax
		jmp	loc_10008C52
; ---------------------------------------------------------------------------

loc_10008BBA:				; CODE XREF: sub_10008B8B+25j
		push	edi		; void *
		lea	ecx, [esp+5Ch+StringSid] ; void	*
		call	sub_10001C7F
		lea	edx, [esp+58h+StringSid]
		lea	ecx, [esp+58h+var_34]
		call	sub_10007CA5
		xor	ebx, ebx
		lea	ecx, [esp+58h+StringSid]
		push	ebx
		push	1
		call	sub_10002311
		cmp	[esp+58h+var_24], ebx
		jnz	short loc_10008C22
		push	esi		; void *
		lea	ecx, [esp+5Ch+var_1C] ;	void *
		call	sub_10001C7F
		push	edi		; void *
		lea	ecx, [esp+5Ch+StringSid] ; void	*
		call	sub_10001C7F
		lea	edx, [esp+58h+var_1C]
		lea	ecx, [esp+58h+StringSid] ; StringSid
		call	sub_10007B85
		push	ebx
		push	1
		lea	ecx, [esp+60h+StringSid]
		mov	esi, eax
		call	sub_10002311
		push	ebx
		push	1
		lea	ecx, [esp+60h+var_1C]
		call	sub_10002311
		jmp	short loc_10008C44
; ---------------------------------------------------------------------------

loc_10008C22:				; CODE XREF: sub_10008B8B+58j
		mov	ecx, esi
		call	sub_10001AF3
		push	eax
		push	esi
		push	[esp+60h+var_24]
		lea	ecx, [esp+64h+var_34]
		push	ebx
		call	sub_10003F14
		test	eax, eax
		jz	short loc_10008C42
		push	0Eh
		pop	esi
		jmp	short loc_10008C44
; ---------------------------------------------------------------------------

loc_10008C42:				; CODE XREF: sub_10008B8B+B0j
		mov	esi, ebx

loc_10008C44:				; CODE XREF: sub_10008B8B+95j
					; sub_10008B8B+B5j
		push	ebx
		push	1
		lea	ecx, [esp+60h+var_34]
		call	sub_10002311
		mov	eax, esi

loc_10008C52:				; CODE XREF: sub_10008B8B+2Aj
		mov	ecx, [esp+58h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10008B8B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10008C66(void *)
sub_10008C66	proc near		; DATA XREF: .rdata:1002BCB0o

StringSid	= word ptr -34h
var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+34h+var_4], eax
		push	esi
		mov	esi, [ebp+arg_0]
		call	sub_100063D2
		cmp	dword ptr [eax], 5
		jge	short loc_10008C8D
		push	3
		pop	eax
		jmp	short loc_10008CEE
; ---------------------------------------------------------------------------

loc_10008C8D:				; CODE XREF: sub_10008C66+20j
		push	esi		; void *
		lea	ecx, [esp+3Ch+StringSid] ; void	*
		call	sub_10001C7F
		lea	edx, [esp+38h+StringSid]
		lea	ecx, [esp+38h+var_1C]
		call	sub_10007CA5
		push	0
		push	1
		lea	ecx, [esp+40h+StringSid]
		call	sub_10002311
		cmp	[esp+38h+var_C], 0
		jnz	short loc_10008CBD
		push	0Eh
		pop	esi
		jmp	short loc_10008CDF
; ---------------------------------------------------------------------------

loc_10008CBD:				; CODE XREF: sub_10008C66+50j
		push	esi		; void *
		lea	ecx, [esp+3Ch+StringSid] ; void	*
		call	sub_10001C7F
		lea	ecx, [esp+38h+StringSid] ; StringSid
		call	sub_10007C21
		push	0
		push	1
		lea	ecx, [esp+40h+StringSid]
		mov	esi, eax
		call	sub_10002311

loc_10008CDF:				; CODE XREF: sub_10008C66+55j
		push	0
		push	1
		lea	ecx, [esp+40h+var_1C]
		call	sub_10002311
		mov	eax, esi

loc_10008CEE:				; CODE XREF: sub_10008C66+25j
		mov	ecx, [esp+38h+var_4]
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10008C66	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008D00	proc near		; CODE XREF: sub_10008064+135p
					; sub_1000FE39+20p ...
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ecx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ecx, [edi]
		jz	short loc_10008D28
		push	esi

loc_10008D17:				; CODE XREF: sub_10008D00+25j
		mov	esi, [ecx]
		push	ecx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	ecx, esi
		cmp	esi, [edi]
		jnz	short loc_10008D17
		pop	esi

loc_10008D28:				; CODE XREF: sub_10008D00+14j
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		retn
sub_10008D00	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008D33	proc near		; CODE XREF: sub_100083E3+52Fp
					; sub_10014EC9+11Fp ...

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esi]
		push	dword ptr [edi+4]
		push	edi
		call	sub_1000917F
		mov	edx, eax
		lea	eax, [edx+8]
		test	eax, eax
		jz	short loc_10008D53
		mov	ecx, [esp+8+arg_0]
		mov	ecx, [ecx]
		mov	[eax], ecx

loc_10008D53:				; CODE XREF: sub_10008D33+16j
		mov	ecx, [esi+4]
		mov	eax, 15555554h
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_10008D6D
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10008D6D:				; CODE XREF: sub_10008D33+2Dj
		lea	eax, [ecx+1]
		mov	[esi+4], eax
		mov	[edi+4], edx
		mov	eax, [edx+4]
		pop	edi
		pop	esi
		mov	[eax], edx
		retn	4
sub_10008D33	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008D80	proc near		; CODE XREF: StartAddress+163p
					; sub_100090B5+4Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		push	esi
		mov	ebp, ecx
		lea	ecx, [esp+0Ch+arg_4]
		push	edi
		call	sub_10004B87
		mov	ecx, [ebx]
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008DA0
		mov	edi, [ebx+8]
		jmp	short loc_10008DB8
; ---------------------------------------------------------------------------

loc_10008DA0:				; CODE XREF: sub_10008D80+19j
		mov	eax, [ebx+8]
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008DAD
		mov	edi, ecx
		jmp	short loc_10008DB8
; ---------------------------------------------------------------------------

loc_10008DAD:				; CODE XREF: sub_10008D80+27j
		mov	edx, [esp+10h+arg_4]
		mov	edi, [edx+8]
		cmp	edx, ebx
		jnz	short loc_10008E28

loc_10008DB8:				; CODE XREF: sub_10008D80+1Ej
					; sub_10008D80+2Bj
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [ebx+4]
		jnz	short loc_10008DC4
		mov	[edi+4], esi

loc_10008DC4:				; CODE XREF: sub_10008D80+3Fj
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10008DD1
		mov	[eax+4], edi
		jmp	short loc_10008DDC
; ---------------------------------------------------------------------------

loc_10008DD1:				; CODE XREF: sub_10008D80+4Aj
		cmp	[esi], ebx
		jnz	short loc_10008DD9
		mov	[esi], edi
		jmp	short loc_10008DDC
; ---------------------------------------------------------------------------

loc_10008DD9:				; CODE XREF: sub_10008D80+53j
		mov	[esi+8], edi

loc_10008DDC:				; CODE XREF: sub_10008D80+4Fj
					; sub_10008D80+57j
		mov	edx, [ebp+0]
		cmp	[edx], ebx
		jnz	short loc_10008DFF
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10008DED
		mov	eax, esi
		jmp	short loc_10008DFD
; ---------------------------------------------------------------------------

loc_10008DED:				; CODE XREF: sub_10008D80+67j
		mov	ecx, [edi]
		mov	eax, edi
		jmp	short loc_10008DF7
; ---------------------------------------------------------------------------

loc_10008DF3:				; CODE XREF: sub_10008D80+7Bj
		mov	eax, ecx
		mov	ecx, [eax]

loc_10008DF7:				; CODE XREF: sub_10008D80+71j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008DF3

loc_10008DFD:				; CODE XREF: sub_10008D80+6Bj
		mov	[edx], eax

loc_10008DFF:				; CODE XREF: sub_10008D80+61j
		mov	edx, [ebp+0]
		cmp	[edx+8], ebx
		jnz	short loc_10008E7F
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_10008E11
		mov	eax, esi
		jmp	short loc_10008E23
; ---------------------------------------------------------------------------

loc_10008E11:				; CODE XREF: sub_10008D80+8Bj
		mov	ecx, [edi+8]
		mov	eax, edi
		jmp	short loc_10008E1D
; ---------------------------------------------------------------------------

loc_10008E18:				; CODE XREF: sub_10008D80+A1j
		mov	eax, ecx
		mov	ecx, [eax+8]

loc_10008E1D:				; CODE XREF: sub_10008D80+96j
		cmp	byte ptr [ecx+0Dh], 0
		jz	short loc_10008E18

loc_10008E23:				; CODE XREF: sub_10008D80+8Fj
		mov	[edx+8], eax
		jmp	short loc_10008E7F
; ---------------------------------------------------------------------------

loc_10008E28:				; CODE XREF: sub_10008D80+36j
		mov	[ecx+4], edx
		mov	eax, [ebx]
		mov	[edx], eax
		cmp	edx, [ebx+8]
		jnz	short loc_10008E38
		mov	esi, edx
		jmp	short loc_10008E52
; ---------------------------------------------------------------------------

loc_10008E38:				; CODE XREF: sub_10008D80+B2j
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, [edx+4]
		jnz	short loc_10008E44
		mov	[edi+4], esi

loc_10008E44:				; CODE XREF: sub_10008D80+BFj
		mov	[esi], edi
		mov	eax, [ebx+8]
		mov	[edx+8], eax
		mov	eax, [ebx+8]
		mov	[eax+4], edx

loc_10008E52:				; CODE XREF: sub_10008D80+B6j
		mov	eax, [ebp+0]
		cmp	[eax+4], ebx
		jnz	short loc_10008E5F
		mov	[eax+4], edx
		jmp	short loc_10008E6D
; ---------------------------------------------------------------------------

loc_10008E5F:				; CODE XREF: sub_10008D80+D8j
		mov	eax, [ebx+4]
		cmp	[eax], ebx
		jnz	short loc_10008E6A
		mov	[eax], edx
		jmp	short loc_10008E6D
; ---------------------------------------------------------------------------

loc_10008E6A:				; CODE XREF: sub_10008D80+E4j
		mov	[eax+8], edx

loc_10008E6D:				; CODE XREF: sub_10008D80+DDj
					; sub_10008D80+E8j
		mov	eax, [ebx+4]
		mov	[edx+4], eax
		mov	al, [ebx+0Ch]
		mov	cl, [edx+0Ch]
		mov	[edx+0Ch], al
		mov	[ebx+0Ch], cl

loc_10008E7F:				; CODE XREF: sub_10008D80+85j
					; sub_10008D80+A6j
		cmp	byte ptr [ebx+0Ch], 1
		jnz	loc_10008F89
		jmp	loc_10008F42
; ---------------------------------------------------------------------------

loc_10008E8E:				; CODE XREF: sub_10008D80+1C8j
		cmp	byte ptr [edi+0Ch], 1
		jnz	loc_10008F85
		mov	ecx, [esi]
		cmp	edi, ecx
		jnz	short loc_10008F0A
		mov	ecx, [esi+8]
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008EBA
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10004B03
		mov	ecx, [esi+8]

loc_10008EBA:				; CODE XREF: sub_10008D80+125j
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10008F3D
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008ED1
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jz	short loc_10008F39

loc_10008ED1:				; CODE XREF: sub_10008D80+146j
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008EEF
		mov	eax, [ecx]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10004B44
		mov	ecx, [esi+8]

loc_10008EEF:				; CODE XREF: sub_10008D80+158j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx+8]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10004B03
		jmp	short loc_10008F85
; ---------------------------------------------------------------------------

loc_10008F0A:				; CODE XREF: sub_10008D80+11Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10008F22
		mov	byte ptr [ecx+0Ch], 1
		mov	ecx, ebp
		push	esi
		mov	byte ptr [esi+0Ch], 0
		call	sub_10004B44
		mov	ecx, [esi]

loc_10008F22:				; CODE XREF: sub_10008D80+18Ej
		cmp	byte ptr [ecx+0Dh], 0
		jnz	short loc_10008F3D
		mov	eax, [ecx+8]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F50
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F50

loc_10008F39:				; CODE XREF: sub_10008D80+14Fj
		mov	byte ptr [ecx+0Ch], 0

loc_10008F3D:				; CODE XREF: sub_10008D80+13Ej
					; sub_10008D80+1A6j
		mov	edi, esi
		mov	esi, [esi+4]

loc_10008F42:				; CODE XREF: sub_10008D80+109j
		mov	eax, [ebp+0]
		cmp	edi, [eax+4]
		jnz	loc_10008E8E
		jmp	short loc_10008F85
; ---------------------------------------------------------------------------

loc_10008F50:				; CODE XREF: sub_10008D80+1AFj
					; sub_10008D80+1B7j
		mov	eax, [ecx]
		cmp	byte ptr [eax+0Ch], 1
		jnz	short loc_10008F6D
		mov	eax, [ecx+8]
		push	ecx
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 0
		mov	ecx, ebp
		call	sub_10004B03
		mov	ecx, [esi]

loc_10008F6D:				; CODE XREF: sub_10008D80+1D6j
		mov	al, [esi+0Ch]
		mov	[ecx+0Ch], al
		mov	byte ptr [esi+0Ch], 1
		mov	eax, [ecx]
		mov	ecx, ebp
		push	esi
		mov	byte ptr [eax+0Ch], 1
		call	sub_10004B44

loc_10008F85:				; CODE XREF: sub_10008D80+112j
					; sub_10008D80+188j ...
		mov	byte ptr [edi+0Ch], 1

loc_10008F89:				; CODE XREF: sub_10008D80+103j
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [ebp+4]
		pop	ecx
		test	eax, eax
		jz	short loc_10008F9C
		dec	eax
		mov	[ebp+4], eax

loc_10008F9C:				; CODE XREF: sub_10008D80+216j
		mov	eax, [esp+10h+arg_0]
		mov	ecx, [esp+10h+arg_4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ecx
		pop	ebx
		retn	8
sub_10008D80	endp


; =============== S U B	R O U T	I N E =======================================


sub_10008FAD	proc near		; CODE XREF: StartAddress+BAp
					; sub_10008A84+CCp

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		mov	ebp, ecx
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_0]
		mov	ebx, [ebp+0]
		mov	esi, ebx
		mov	eax, [ebx+4]
		mov	edx, eax
		cmp	byte ptr [edx+0Dh], 0
		jnz	short loc_10008FEA
		mov	ecx, [edi]

loc_10008FC9:				; CODE XREF: sub_10008FAD+3Bj
		cmp	[edx+10h], ecx
		jnb	short loc_10008FD3
		mov	edx, [edx+8]
		jmp	short loc_10008FE4
; ---------------------------------------------------------------------------

loc_10008FD3:				; CODE XREF: sub_10008FAD+1Fj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_10008FE0
		cmp	ecx, [edx+10h]
		jnb	short loc_10008FE0
		mov	esi, edx

loc_10008FE0:				; CODE XREF: sub_10008FAD+2Aj
					; sub_10008FAD+2Fj
		mov	ebx, edx
		mov	edx, [edx]

loc_10008FE4:				; CODE XREF: sub_10008FAD+24j
		cmp	byte ptr [edx+0Dh], 0
		jz	short loc_10008FC9

loc_10008FEA:				; CODE XREF: sub_10008FAD+18j
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_10008FF2
		mov	eax, [esi]

loc_10008FF2:				; CODE XREF: sub_10008FAD+41j
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000900E
		mov	ecx, [edi]

loc_10008FFA:				; CODE XREF: sub_10008FAD+5Fj
		cmp	ecx, [eax+10h]
		jnb	short loc_10009005
		mov	esi, eax
		mov	eax, [eax]
		jmp	short loc_10009008
; ---------------------------------------------------------------------------

loc_10009005:				; CODE XREF: sub_10008FAD+50j
		mov	eax, [eax+8]

loc_10009008:				; CODE XREF: sub_10008FAD+56j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10008FFA

loc_1000900E:				; CODE XREF: sub_10008FAD+49j
		xor	edi, edi
		mov	[esp+10h+arg_0], ebx
		cmp	ebx, esi
		jz	short loc_10009028

loc_10009018:				; CODE XREF: sub_10008FAD+79j
		lea	ecx, [esp+10h+arg_0]
		inc	edi
		call	sub_10004B87
		cmp	[esp+10h+arg_0], esi
		jnz	short loc_10009018

loc_10009028:				; CODE XREF: sub_10008FAD+69j
		push	esi
		push	ebx
		lea	eax, [esp+18h+arg_0]
		mov	ecx, ebp
		push	eax
		call	sub_100090B5
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10008FAD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000903F	proc near		; CODE XREF: StartAddress+149p
					; sub_100089EF+5Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	edx, [ecx]
		mov	ecx, edx
		push	esi
		mov	esi, [ebp+arg_4]
		mov	eax, [edx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_1000906B
		push	edi
		mov	edi, [esi]

loc_10009056:				; CODE XREF: sub_1000903F+29j
		cmp	[eax+10h], edi
		jnb	short loc_10009060
		mov	eax, [eax+8]
		jmp	short loc_10009064
; ---------------------------------------------------------------------------

loc_10009060:				; CODE XREF: sub_1000903F+1Aj
		mov	ecx, eax
		mov	eax, [eax]

loc_10009064:				; CODE XREF: sub_1000903F+1Fj
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_10009056
		pop	edi

loc_1000906B:				; CODE XREF: sub_1000903F+12j
		cmp	ecx, edx
		jz	short loc_10009079
		mov	eax, [esi]
		mov	[ebp+arg_4], ecx
		cmp	eax, [ecx+10h]
		jnb	short loc_1000907C

loc_10009079:				; CODE XREF: sub_1000903F+2Ej
		mov	[ebp+arg_4], edx

loc_1000907C:				; CODE XREF: sub_1000903F+38j
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	esi
		mov	[eax], ecx
		pop	ebp
		retn	8
sub_1000903F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000908B	proc near		; CODE XREF: sub_10008064+F3p
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_10009119
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000908B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100090B5	proc near		; CODE XREF: sub_10008064+107p
					; sub_10008064+124p ...

var_4		= byte ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		cmp	esi, [eax]
		jnz	short loc_10009107
		cmp	[ebp+arg_8], eax
		jnz	short loc_10009107
		push	dword ptr [eax+4]
		call	sub_10009119
		mov	eax, [edi]
		mov	[eax+4], eax
		mov	eax, [edi]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+8], eax
		mov	eax, [edi]
		and	dword ptr [edi+4], 0
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		jmp	short loc_10009111
; ---------------------------------------------------------------------------

loc_100090F0:				; CODE XREF: sub_100090B5+55j
		lea	ecx, [ebp+arg_4]
		call	sub_10004B87
		push	esi
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax
		call	sub_10008D80
		mov	esi, [ebp+arg_4]

loc_10009107:				; CODE XREF: sub_100090B5+Fj
					; sub_100090B5+14j
		cmp	esi, [ebp+arg_8]
		jnz	short loc_100090F0
		mov	eax, [ebp+arg_0]
		mov	[eax], esi

loc_10009111:				; CODE XREF: sub_100090B5+39j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100090B5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009119	proc near		; CODE XREF: sub_1000908B+8p
					; sub_100090B5+19p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ebx, ecx
		mov	esi, edi
		cmp	byte ptr [edi+0Dh], 0
		jnz	short loc_10009146

loc_1000912A:				; CODE XREF: sub_10009119+2Bj
		push	dword ptr [esi+8]
		mov	ecx, ebx
		call	sub_10009119
		mov	esi, [esi]
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [esi+0Dh], 0
		mov	edi, esi
		pop	ecx
		jz	short loc_1000912A

loc_10009146:				; CODE XREF: sub_10009119+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_10009119	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000914C	proc near		; CODE XREF: sub_100083E3+405p
					; sub_1000FDBA+Bp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000915F
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000915F:				; CODE XREF: sub_1000914C+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000916D
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_10009171
; ---------------------------------------------------------------------------

loc_1000916D:				; CODE XREF: sub_1000914C+19j
		mov	edx, [esp+arg_4]

loc_10009171:				; CODE XREF: sub_1000914C+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_1000917C
		mov	[ecx], edx

locret_1000917C:			; CODE XREF: sub_1000914C+2Cj
		retn	8
sub_1000914C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000917F	proc near		; CODE XREF: sub_10007F44+21p
					; sub_10008D33+Ap ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	0Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_10009192
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10009192:				; CODE XREF: sub_1000917F+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_100091A0
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_100091A4
; ---------------------------------------------------------------------------

loc_100091A0:				; CODE XREF: sub_1000917F+19j
		mov	edx, [esp+arg_4]

loc_100091A4:				; CODE XREF: sub_1000917F+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_100091AF
		mov	[ecx], edx

locret_100091AF:			; CODE XREF: sub_1000917F+2Cj
		retn	8
sub_1000917F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100091B2	proc near		; CODE XREF: sub_10008A84+A0p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	18h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_100091CA
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_100091CA:				; CODE XREF: sub_100091B2+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_100091D9
		mov	eax, [esi]
		mov	[ecx], eax

loc_100091D9:				; CODE XREF: sub_100091B2+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_100091E4
		mov	eax, [esi]
		mov	[ecx], eax

loc_100091E4:				; CODE XREF: sub_100091B2+2Cj
		push	edi
		lea	edi, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	edi, edi
		jz	short loc_10009200
		mov	ecx, [esp+8+arg_4]
		mov	eax, [ecx]
		mov	[edi], eax
		mov	eax, [ecx+4]
		mov	[edi+4], eax

loc_10009200:				; CODE XREF: sub_100091B2+3Ej
		push	edx
		push	edi
		push	ecx
		push	[esp+14h+arg_0]
		mov	ecx, esi
		call	sub_1000521A
		mov	eax, [esp+8+arg_0]
		pop	edi
		pop	esi
		retn	8
sub_100091B2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009217	proc near		; CODE XREF: sub_100083E3+177p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		push	1Ch
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10009230
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10009230:				; CODE XREF: sub_10009217+11j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000923F
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000923F:				; CODE XREF: sub_10009217+22j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000924A
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000924A:				; CODE XREF: sub_10009217+2Dj
		xor	ebx, ebx
		lea	ecx, [edx+10h]
		mov	[edx+0Ch], bx
		test	ecx, ecx
		jz	short loc_10009267
		mov	eax, [esp+8+arg_C]
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ecx], eax
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx

loc_10009267:				; CODE XREF: sub_10009217+3Ej
		push	edx
		push	ecx
		push	[esp+10h+arg_4]
		mov	ecx, esi
		push	[esp+14h+arg_0]
		call	sub_10009322
		mov	eax, [esp+8+arg_0]
		pop	esi
		pop	ebx
		retn	14h
sub_10009217	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009281	proc near		; CODE XREF: sub_100083E3+552p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	dl, 1
		push	esi
		push	edi
		mov	edi, [esp+10h+arg_8]
		mov	ecx, [ebx]
		mov	esi, ecx
		mov	byte ptr [esp+10h+var_4], dl
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100092BF
		push	ebp
		mov	ebp, [edi]

loc_100092A1:				; CODE XREF: sub_10009281+3Bj
		cmp	ebp, [eax+10h]
		mov	esi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_100092B5
		mov	eax, [eax]
		jmp	short loc_100092B8
; ---------------------------------------------------------------------------

loc_100092B5:				; CODE XREF: sub_10009281+2Ej
		mov	eax, [eax+8]

loc_100092B8:				; CODE XREF: sub_10009281+32j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_100092A1
		pop	ebp

loc_100092BF:				; CODE XREF: sub_10009281+1Bj
		mov	eax, esi
		mov	[esp+10h+arg_8], eax
		test	dl, dl
		jz	short loc_100092FC
		cmp	esi, [ecx]
		jnz	short loc_100092EF
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	1

loc_100092D5:				; CODE XREF: sub_10009281+8Cj
		lea	eax, [esp+20h+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_10009435
		mov	ecx, [eax]
		mov	eax, [esp+10h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000931B
; ---------------------------------------------------------------------------

loc_100092EF:				; CODE XREF: sub_10009281+4Aj
		lea	ecx, [esp+10h+arg_8]
		call	sub_10004EEF
		mov	eax, [esp+10h+arg_8]

loc_100092FC:				; CODE XREF: sub_10009281+46j
		mov	ecx, [eax+10h]
		cmp	ecx, [edi]
		jnb	short loc_1000930F
		push	[esp+10h+arg_C]
		push	edi
		push	esi
		push	[esp+1Ch+var_4]
		jmp	short loc_100092D5
; ---------------------------------------------------------------------------

loc_1000930F:				; CODE XREF: sub_10009281+80j
		mov	ecx, [esp+10h+arg_0]
		mov	[ecx], eax
		mov	eax, ecx
		mov	byte ptr [ecx+4], 0

loc_1000931B:				; CODE XREF: sub_10009281+6Cj
		pop	edi
		pop	esi
		pop	ebx
		pop	ecx
		retn	10h
sub_10009281	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009322	proc near		; CODE XREF: sub_10009217+5Cp

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_1000934E
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_10009556
		mov	eax, [esp+10h+arg_0]
		jmp	loc_1000942E
; ---------------------------------------------------------------------------

loc_1000934E:				; CODE XREF: sub_10009322+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_10009376
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_10009411
		push	[esp+1Ch+arg_C]
		push	ecx

loc_10009370:				; CODE XREF: sub_10009322+A0j
		push	esi
		jmp	loc_10009400
; ---------------------------------------------------------------------------

loc_10009376:				; CODE XREF: sub_10009322+3Cj
		cmp	esi, ebp
		jnz	short loc_10009393
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_10009411
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_10009402
; ---------------------------------------------------------------------------

loc_10009393:				; CODE XREF: sub_10009322+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_100093CC
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EEF
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_100093C7
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_10009370
		push	eax
		jmp	short loc_100093FB
; ---------------------------------------------------------------------------

loc_100093C7:				; CODE XREF: sub_10009322+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_100093CC:				; CODE XREF: sub_10009322+76j
		jnb	short loc_10009411
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B87
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_100093EA
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_10009411

loc_100093EA:				; CODE XREF: sub_10009322+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_100093FF
		push	esi

loc_100093FB:				; CODE XREF: sub_10009322+A3j
		push	0
		jmp	short loc_10009402
; ---------------------------------------------------------------------------

loc_100093FF:				; CODE XREF: sub_10009322+D6j
		push	eax

loc_10009400:				; CODE XREF: sub_10009322+4Fj
		push	1

loc_10009402:				; CODE XREF: sub_10009322+6Fj
					; sub_10009322+DBj
		push	[esp+2Ch+arg_0]
		call	sub_10009556
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_1000942B
; ---------------------------------------------------------------------------

loc_10009411:				; CODE XREF: sub_10009322+43j
					; sub_10009322+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_1000967A
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_1000942B:				; CODE XREF: sub_10009322+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_1000942E:				; CODE XREF: sub_10009322+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_10009322	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009435	proc near		; CODE XREF: sub_10009281+5Bp

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0CCCCCCBh
		jb	short loc_10009451
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_10009451:				; CODE XREF: sub_10009435+Fj
		push	[ebp+arg_C]
		push	[ebp+arg_10]
		call	sub_10009721
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [ebp+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000947B
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000949A
; ---------------------------------------------------------------------------

loc_1000947B:				; CODE XREF: sub_10009435+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000948D
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000949A
		mov	[ecx], ebx
		jmp	short loc_1000949A
; ---------------------------------------------------------------------------

loc_1000948D:				; CODE XREF: sub_10009435+4Aj
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000949A
		mov	[ecx+8], ebx

loc_1000949A:				; CODE XREF: sub_10009435+44j
					; sub_10009435+52j ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_10009537
; ---------------------------------------------------------------------------

loc_100094A4:				; CODE XREF: sub_10009435+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_100094E8
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_100094EE
		cmp	esi, [eax+8]
		jnz	short loc_100094C8
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B03

loc_100094C8:				; CODE XREF: sub_10009435+87j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_10009534
; ---------------------------------------------------------------------------

loc_100094E8:				; CODE XREF: sub_10009435+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10009508

loc_100094EE:				; CODE XREF: sub_10009435+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10009534
; ---------------------------------------------------------------------------

loc_10009508:				; CODE XREF: sub_10009435+B7j
		cmp	esi, [eax]
		jnz	short loc_10009516
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B44

loc_10009516:				; CODE XREF: sub_10009435+D5j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_10009534:				; CODE XREF: sub_10009435+B1j
					; sub_10009435+D1j
		mov	eax, [esi+4]

loc_10009537:				; CODE XREF: sub_10009435+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_100094A4
		mov	eax, [edi]
		pop	edi
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	ebp
		retn	14h
sub_10009435	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009556	proc near		; CODE XREF: sub_10009322+1Ep
					; sub_10009322+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_1000957E
		push	[ebp+arg_10]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000957E:				; CODE XREF: sub_10009556+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000959F
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_100095BE
; ---------------------------------------------------------------------------

loc_1000959F:				; CODE XREF: sub_10009556+39j
		cmp	[ebp+arg_4], 0
		jz	short loc_100095B1
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_100095BE
		mov	[ecx], edi
		jmp	short loc_100095BE
; ---------------------------------------------------------------------------

loc_100095B1:				; CODE XREF: sub_10009556+4Dj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_100095BE
		mov	[ecx+8], edi

loc_100095BE:				; CODE XREF: sub_10009556+47j
					; sub_10009556+55j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000965B
; ---------------------------------------------------------------------------

loc_100095C8:				; CODE XREF: sub_10009556+109j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000960C
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_10009612
		cmp	esi, [eax+8]
		jnz	short loc_100095EC
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_100095EC:				; CODE XREF: sub_10009556+8Aj
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_10009658
; ---------------------------------------------------------------------------

loc_1000960C:				; CODE XREF: sub_10009556+7Cj
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000962C

loc_10009612:				; CODE XREF: sub_10009556+85j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10009658
; ---------------------------------------------------------------------------

loc_1000962C:				; CODE XREF: sub_10009556+BAj
		cmp	esi, [eax]
		jnz	short loc_1000963A
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_1000963A:				; CODE XREF: sub_10009556+D8j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_10009658:				; CODE XREF: sub_10009556+B4j
					; sub_10009556+D4j
		mov	eax, [esi+4]

loc_1000965B:				; CODE XREF: sub_10009556+6Dj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_100095C8
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_10009556	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000967A	proc near		; CODE XREF: sub_10009322+FCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100096B8
		mov	esi, [ebx]

loc_1000969B:				; CODE XREF: sub_1000967A+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_100096AF
		mov	eax, [eax]
		jmp	short loc_100096B2
; ---------------------------------------------------------------------------

loc_100096AF:				; CODE XREF: sub_1000967A+2Fj
		mov	eax, [eax+8]

loc_100096B2:				; CODE XREF: sub_1000967A+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_1000969B

loc_100096B8:				; CODE XREF: sub_1000967A+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_100096F5
		cmp	edi, [ecx]
		jnz	short loc_100096E8
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_100096CE:				; CODE XREF: sub_1000967A+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_10009556
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10009719
; ---------------------------------------------------------------------------

loc_100096E8:				; CODE XREF: sub_1000967A+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EEF
		mov	esi, [esp+14h+arg_8]

loc_100096F5:				; CODE XREF: sub_1000967A+46j
		mov	eax, [esi+10h]
		push	[esp+14h+arg_C]
		cmp	eax, [ebx]
		jnb	short loc_10009708
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_100096CE
; ---------------------------------------------------------------------------

loc_10009708:				; CODE XREF: sub_1000967A+84j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10009719:				; CODE XREF: sub_1000967A+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000967A	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009721	proc near		; CODE XREF: sub_10009435+22p

arg_4		= dword	ptr  8

		push	esi
		push	14h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_10009739
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_10009739:				; CODE XREF: sub_10009721+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_10009748
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009748:				; CODE XREF: sub_10009721+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_10009753
		mov	eax, [esi]
		mov	[ecx], eax

loc_10009753:				; CODE XREF: sub_10009721+2Cj
		lea	ecx, [edx+10h]
		mov	word ptr [edx+0Ch], 0
		test	ecx, ecx
		jz	short loc_10009768
		mov	eax, [esp+4+arg_4]
		mov	eax, [eax]
		mov	[ecx], eax

loc_10009768:				; CODE XREF: sub_10009721+3Dj
		mov	eax, edx
		pop	esi
		retn	8
sub_10009721	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000976E	proc near		; CODE XREF: sub_100097F5+4Cp
					; sub_100097F5+A2p
		cmp	ecx, 9		; switch 10 cases
		ja	short loc_100097AD ; jumptable 10009773	default	case
		jmp	ds:off_100097B2[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_1000977A:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+50h]	; jumptable 10009773 case 1
		retn
; ---------------------------------------------------------------------------

loc_1000977E:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+5Ch]	; jumptable 10009773 case 2
		retn
; ---------------------------------------------------------------------------

loc_10009782:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+68h]	; jumptable 10009773 case 3
		retn
; ---------------------------------------------------------------------------

loc_10009786:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+74h]	; jumptable 10009773 case 4
		retn
; ---------------------------------------------------------------------------

loc_1000978A:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+80h]	; jumptable 10009773 case 5
		retn
; ---------------------------------------------------------------------------

loc_10009791:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+8Ch]	; jumptable 10009773 case 6
		retn
; ---------------------------------------------------------------------------

loc_10009798:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+98h]	; jumptable 10009773 case 7
		retn
; ---------------------------------------------------------------------------

loc_1000979F:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+0A4h]	; jumptable 10009773 case 8
		retn
; ---------------------------------------------------------------------------

loc_100097A6:				; CODE XREF: sub_1000976E+5j
					; DATA XREF: .text:off_100097B2o
		mov	eax, [edx+0B0h]	; jumptable 10009773 case 9
		retn
; ---------------------------------------------------------------------------

loc_100097AD:				; CODE XREF: sub_1000976E+3j
					; sub_1000976E+5j
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10009773 default case
		retn
sub_1000976E	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_100097B2	dd offset loc_100097AD	; DATA XREF: sub_1000976E+5r
		dd offset loc_1000977A	; jump table for switch	statement
		dd offset loc_1000977E
		dd offset loc_10009782
		dd offset loc_10009786
		dd offset loc_1000978A
		dd offset loc_10009791
		dd offset loc_10009798
		dd offset loc_1000979F
		dd offset loc_100097A6

; =============== S U B	R O U T	I N E =======================================


sub_100097DA	proc near		; CODE XREF: sub_100097F5+5Cp
					; sub_100097F5+B5p

arg_0		= dword	ptr  4

		cmp	ecx, edx
		jb	short loc_100097F2
		cmp	edx, 4Ch
		jb	short loc_100097F2
		cmp	[esp+arg_0], ecx
		ja	short loc_100097F2
		cmp	[esp+arg_0], edx
		jb	short loc_100097F2
		mov	al, 1
		retn
; ---------------------------------------------------------------------------

loc_100097F2:				; CODE XREF: sub_100097DA+2j
					; sub_100097DA+7j ...
		xor	al, al
		retn
sub_100097DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100097F5	proc near		; CODE XREF: sub_10015E1F+49p

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	2Ch
		push	offset stru_1002DC98
		call	__SEH_prolog4
		mov	ebx, edx
		mov	[ebp+var_28], ecx
		test	ecx, ecx
		jz	loc_10009940
		cmp	ebx, 40h
		jb	loc_10009940
		cmp	ebx, 400h
		ja	loc_10009940
		and	[ebp+var_24], 0
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	esi, [ecx+3Ch]
		mov	[ebp+var_20], esi
		mov	[ebp+var_34], esi
		imul	eax, esi, 0Ch
		add	eax, 4Ch
		mov	[ebp+var_1C], eax
		mov	edx, ecx
		mov	ecx, esi
		call	sub_1000976E
		mov	edi, eax
		mov	[ebp+var_38], edi
		push	edi
		mov	edx, [ebp+var_1C]
		mov	ecx, ebx
		call	sub_100097DA
		add	esp, 4
		test	al, al
		jz	loc_10009939
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		push	edi
		call	sub_10018CBA
		mov	esi, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_3C], esi
		push	edi		; size_t
		push	[ebp+var_28]	; void *
		push	esi		; void *
		call	memcpy
		add	esp, 10h
		mov	eax, [ebp+var_1C]
		mov	[ebp+var_1C], eax
		mov	eax, [ebp+var_20]
		cmp	[esi+3Ch], eax
		jnz	loc_10009925
		mov	edx, esi
		mov	ecx, eax
		call	sub_1000976E
		cmp	eax, edi
		jnz	loc_10009925
		push	edi
		mov	edx, [ebp+var_1C]
		mov	ecx, ebx
		call	sub_100097DA
		add	esp, 4
		test	al, al
		jz	short loc_10009925
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		lea	eax, [esi+edi]
		mov	[ebp+var_30], eax
		lea	eax, [esi+edx]
		mov	[ebp+var_2C], eax
		xor	edi, edi
		mov	ebx, [ebp+var_20]
		test	ebx, ebx
		jz	short loc_10009917

loc_100098D2:				; CODE XREF: sub_100097F5+120j
		and	[ebp+var_20], 0
		lea	eax, [ebp+var_28]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	edi
		mov	ecx, esi
		call	sub_10009948
		mov	edx, eax
		test	edx, edx
		jz	short loc_1000991B
		mov	ecx, [ebp+var_28]
		dec	ecx
		cmp	ecx, 5
		ja	short loc_1000991B
		cmp	edx, esi
		jb	short loc_1000991B
		cmp	edx, [ebp+var_2C]
		jb	short loc_1000991B
		mov	ecx, [ebp+var_30]
		cmp	edx, ecx
		ja	short loc_1000991B
		mov	eax, [ebp+var_20]
		add	eax, edx
		cmp	eax, edx
		jb	short loc_1000991B
		cmp	eax, ecx
		ja	short loc_1000991B
		inc	edi
		cmp	edi, ebx
		jnz	short loc_100098D2

loc_10009917:				; CODE XREF: sub_100097F5+DBj
		mov	eax, esi
		jmp	short loc_10009942
; ---------------------------------------------------------------------------

loc_1000991B:				; CODE XREF: sub_100097F5+F5j
					; sub_100097F5+FEj ...
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_10009940
; ---------------------------------------------------------------------------

loc_10009925:				; CODE XREF: sub_100097F5+98j
					; sub_100097F5+A9j ...
		push	esi
		jmp	short loc_10009932
; ---------------------------------------------------------------------------

loc_10009928:				; DATA XREF: .rdata:stru_1002DC98o
		xor	eax, eax	; Exception filter 0 for function 100097F5
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000992C:				; DATA XREF: .rdata:stru_1002DC98o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100097F5
		push	[ebp+var_24]

loc_10009932:				; CODE XREF: sub_100097F5+131j
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10009939:				; CODE XREF: sub_100097F5+66j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10009940:				; CODE XREF: sub_100097F5+13j
					; sub_100097F5+1Cj ...
		xor	eax, eax

loc_10009942:				; CODE XREF: sub_100097F5+124j
		call	__SEH_epilog4
		retn
sub_100097F5	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009948	proc near		; CODE XREF: sub_100097F5+ECp
					; sub_1000997E+14p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	edx, [esp+arg_0]
		push	esi
		mov	esi, ecx
		cmp	edx, [esi+3Ch]
		jb	short loc_10009958
		xor	eax, eax
		jmp	short loc_1000997A
; ---------------------------------------------------------------------------

loc_10009958:				; CODE XREF: sub_10009948+Aj
		lea	eax, [edx+6]
		imul	edx, 0Ch
		imul	eax, 0Ch
		mov	ecx, [eax+esi]
		mov	eax, [esp+4+arg_4]
		mov	[eax], ecx
		mov	eax, [esp+4+arg_8]
		mov	ecx, [edx+esi+40h]
		mov	[eax], ecx
		mov	eax, [edx+esi+44h]
		add	eax, esi

loc_1000997A:				; CODE XREF: sub_10009948+Ej
		pop	esi
		retn	0Ch
sub_10009948	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000997E(int, void *)
sub_1000997E	proc near		; CODE XREF: sub_10015CAB+118p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_4]
		push	eax
		push	[ebp+arg_0]
		call	sub_10009948
		cmp	[ebp+var_8], 1
		jnz	short loc_100099D9
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jnz	short loc_100099C0
		push	esi
		mov	esi, offset SubKey
		mov	ecx, esi
		call	sub_10001AF3
		mov	ecx, [ebp+arg_4] ; void	*
		push	eax		; int
		push	esi		; void *
		call	sub_10002356
		mov	al, 1
		pop	esi
		jmp	short loc_100099DB
; ---------------------------------------------------------------------------

loc_100099C0:				; CODE XREF: sub_1000997E+24j
		test	eax, eax
		jz	short loc_100099D9
		test	cl, 1
		jnz	short loc_100099D9
		shr	ecx, 1
		push	ecx		; int
		mov	ecx, [ebp+arg_4]
		push	eax		; void *
		call	sub_10003388
		mov	al, 1
		jmp	short loc_100099DB
; ---------------------------------------------------------------------------

loc_100099D9:				; CODE XREF: sub_1000997E+1Dj
					; sub_1000997E+44j ...
		xor	al, al

loc_100099DB:				; CODE XREF: sub_1000997E+40j
					; sub_1000997E+59j
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000997E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100099E1	proc near		; DATA XREF: .rdata:off_1002BDDCo
					; .rdata:off_1002BE98o	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		and	[esp+8+var_4], 0
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+4]
		cmp	eax, [esi+8]
		jz	short loc_10009A21
		mov	edi, [ebp+arg_0]

loc_100099FD:				; CODE XREF: sub_100099E1+3Ej
		xor	edx, edx

loc_100099FF:				; CODE XREF: sub_100099E1+2Aj
		mov	ecx, [eax+edx*4]
		cmp	ecx, [edi+edx*4]
		jnz	short loc_10009A19
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_100099FF
		mov	ecx, [eax+28h]
		mov	eax, [ebp+arg_4]
		mov	[eax], ecx
		mov	eax, esi
		jmp	short loc_10009A23
; ---------------------------------------------------------------------------

loc_10009A19:				; CODE XREF: sub_100099E1+24j
		add	eax, 2Ch
		cmp	eax, [esi+8]
		jnz	short loc_100099FD

loc_10009A21:				; CODE XREF: sub_100099E1+17j
		xor	eax, eax

loc_10009A23:				; CODE XREF: sub_100099E1+36j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100099E1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009A2B	proc near		; CODE XREF: sub_10009A67+8Dp
					; sub_10016763+B3p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, ecx
		cmp	byte ptr [ebx],	0
		jz	short loc_10009A62
		mov	eax, [ebx+8]
		push	esi
		push	edi
		lea	edi, [ebx+0Ch]
		mov	[ebp+var_4], eax
		push	edi
		push	dword ptr [edi]
		lea	eax, [ebp+var_4]
		push	eax
		lea	esi, [ebx+4]
		push	esi
		push	0FFFFFFFFh
		call	dword_10031D1C
		xor	eax, eax
		mov	[edi], eax
		pop	edi
		mov	[esi], eax
		mov	[ebx], al
		mov	[ebx+8], eax
		pop	esi

loc_10009A62:				; CODE XREF: sub_10009A2B+Aj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10009A2B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009A67	proc near		; DATA XREF: .rdata:1002C25Co

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		push	edi
		push	[ebp+arg_18]
		mov	edi, [ebp+arg_14]
		mov	esi, ecx
		push	edi
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		mov	eax, [esi]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_10009AFC
		xor	edx, edx
		cmp	[esi+0Ch], edx
		jnz	short loc_10009A9E
		mov	eax, 0C000000Dh
		jmp	short loc_10009AFC
; ---------------------------------------------------------------------------

loc_10009A9E:				; CODE XREF: sub_10009A67+2Ej
		push	dword ptr [esi+8]
		push	dword ptr [esi+4]
		push	[ebp+arg_18]
		push	edi
		call	sub_10012A7E
		test	al, al
		jnz	short loc_10009AB8
		mov	eax, 0C0000023h
		jmp	short loc_10009AFC
; ---------------------------------------------------------------------------

loc_10009AB8:				; CODE XREF: sub_10009A67+48j
		push	ebx
		push	ecx
		push	4
		push	dword ptr [esi+0Ch]
		lea	ecx, [ebp+var_10]
		mov	[ebp+var_10], dl
		mov	[ebp+var_C], edx
		mov	[ebp+var_8], edx
		mov	[ebp+var_4], edx
		call	sub_10014267
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_10009AF1
		mov	ecx, [esi+0Ch]
		sub	edi, [ebp+arg_0]
		mov	[ecx], edi
		mov	edi, [ebp+arg_1C]
		test	edi, edi
		jz	short loc_10009AF1
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_10009AF1:				; CODE XREF: sub_10009A67+70j
					; sub_10009A67+7Fj
		lea	ecx, [ebp+var_10]
		call	sub_10009A2B
		mov	eax, ebx
		pop	ebx

loc_10009AFC:				; CODE XREF: sub_10009A67+27j
					; sub_10009A67+35j ...
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_10009A67	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009B04	proc near		; DATA XREF: .rdata:1002C264o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		test	eax, eax
		jnz	short loc_10009B1A
		mov	eax, 0C000000Dh
		jmp	short loc_10009B61
; ---------------------------------------------------------------------------

loc_10009B1A:				; CODE XREF: sub_10009B04+Dj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100058D3
		test	al, al
		jnz	short loc_10009B37
		mov	eax, 0C000007Bh
		jmp	short loc_10009B61
; ---------------------------------------------------------------------------

loc_10009B37:				; CODE XREF: sub_10009B04+2Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_10005755
		mov	[esi+0Ch], eax
		test	eax, eax
		jnz	short loc_10009B50
		mov	eax, 0C000007Ah
		jmp	short loc_10009B61
; ---------------------------------------------------------------------------

loc_10009B50:				; CODE XREF: sub_10009B04+43j
		push	dword ptr [eax]
		lea	ecx, [ebp+var_8]
		call	sub_10005906
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		xor	eax, eax

loc_10009B61:				; CODE XREF: sub_10009B04+14j
					; sub_10009B04+31j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10009B04	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B68	proc near		; DATA XREF: .rdata:1002C268o
		push	1Eh
		pop	eax
		retn
sub_10009B68	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B6C	proc near		; CODE XREF: sub_10009B92+3p
					; sub_10009BAF+9p ...
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BE98
		cmp	dword ptr [esi+4], 0
		jz	short loc_10009B90
		push	dword ptr [esi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	[esi+0Ch], eax

loc_10009B90:				; CODE XREF: sub_10009B6C+Dj
		pop	esi
		retn
sub_10009B6C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009B92	proc near		; DATA XREF: .rdata:1002BEA0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_10009BA9
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10009BA9:				; CODE XREF: sub_10009B92+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_10009B92	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009BAF	proc near		; DATA XREF: .rdata:1002BDE4o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002BDDC
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_10009BCC
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10009BCC:				; CODE XREF: sub_10009BAF+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10009BAF	endp


; =============== S U B	R O U T	I N E =======================================


sub_10009BD2	proc near		; CODE XREF: sub_10014386+D9p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1002BDE8
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1002BDDC
		mov	[edi+10h], eax
		call	sub_1000A1C3
		push	offset dword_1002BE6C
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002BE40
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002BEA4
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002BE14
		mov	ecx, esi
		call	sub_1000A1C3
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_10009BD2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009C33	proc near		; DATA XREF: .rdata:1002BDE0o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		sub	eax, 3
		jz	short loc_10009CB6
		dec	eax
		jz	short loc_10009C9D
		dec	eax
		jz	short loc_10009C84
		dec	eax
		jz	short loc_10009C6B
		dec	eax
		jnz	loc_10009CDC
		mov	eax, offset _TargetNtSetInformationFile@24 ; TargetNtSetInformationFile(x,x,x,x,x,x)
		test	eax, eax
		jz	loc_10009CDC
		push	0Dh
		push	offset a_targetntset_1 ; "_TargetNtSetInformationFile@24"
		push	1
		push	offset aNtsetinformati ; "NtSetInformationFile"
		jmp	short loc_10009CCD
; ---------------------------------------------------------------------------

loc_10009C6B:				; CODE XREF: sub_10009C33+12j
		mov	eax, offset _TargetNtQueryFullAttributesFile@12	; TargetNtQueryFullAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_10009CDC
		push	0Ch
		push	offset a_targetntque_1 ; "_TargetNtQueryFullAttributesFile@12"
		push	1
		push	offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		jmp	short loc_10009CCD
; ---------------------------------------------------------------------------

loc_10009C84:				; CODE XREF: sub_10009C33+Fj
		mov	eax, offset _TargetNtQueryAttributesFile@12 ; TargetNtQueryAttributesFile(x,x,x)
		test	eax, eax
		jz	short loc_10009CDC
		push	0Bh
		push	offset a_targetntque_2 ; "_TargetNtQueryAttributesFile@12"
		push	1
		push	offset aNtqueryattribu ; "NtQueryAttributesFile"
		jmp	short loc_10009CCD
; ---------------------------------------------------------------------------

loc_10009C9D:				; CODE XREF: sub_10009C33+Cj
		mov	eax, offset _TargetNtOpenFile@28 ; TargetNtOpenFile(x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10009CDC
		push	0Ah
		push	offset a_targetntope_5 ; "_TargetNtOpenFile@28"
		push	1
		push	offset aNtopenfile ; "NtOpenFile"
		jmp	short loc_10009CCD
; ---------------------------------------------------------------------------

loc_10009CB6:				; CODE XREF: sub_10009C33+9j
		mov	eax, offset _TargetNtCreateFile@48 ; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10009CDC
		push	9		; int
		push	offset a_targetntcre_2 ; "_TargetNtCreateFile@48"
		push	1		; int
		push	offset aNtcreatefile ; "NtCreateFile"

loc_10009CCD:				; CODE XREF: sub_10009C33+36j
					; sub_10009C33+4Fj ...
		mov	ecx, [ebp+arg_0]
		push	offset aNtdll_dll ; "ntdll.dll"
		call	sub_1000D8D2
		jmp	short loc_10009CDE
; ---------------------------------------------------------------------------

loc_10009CDC:				; CODE XREF: sub_10009C33+15j
					; sub_10009C33+22j ...
		xor	al, al

loc_10009CDE:				; CODE XREF: sub_10009C33+A7j
		pop	ebp
		retn	8
sub_10009C33	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009CE2	proc near		; DATA XREF: .rdata:1002BE10o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
TargetHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		mov	edx, edi
		mov	ecx, edi
		call	sub_1000B9D4
		test	al, al
		jnz	short loc_10009D1A

loc_10009D0E:				; CODE XREF: sub_10009CE2+D3j
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	loc_10009DD0
; ---------------------------------------------------------------------------

loc_10009D1A:				; CODE XREF: sub_10009CE2+2Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10009D24
		mov	eax, [edi]
		jmp	short loc_10009D26
; ---------------------------------------------------------------------------

loc_10009D24:				; CODE XREF: sub_10009CE2+3Cj
		mov	eax, edi

loc_10009D26:				; CODE XREF: sub_10009CE2+40j
		lea	ecx, [esp+48h+var_28]
		mov	[esp+48h+var_2C], eax
		mov	[esp+48h+var_38], 1
		call	sub_1000A22B
		lea	eax, [esp+48h+var_2C]
		mov	[esp+48h+var_24], 1
		mov	[esp+48h+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[esp+48h+var_10], eax
		lea	eax, [ebp+arg_1C]
		mov	[esp+48h+var_8], eax
		lea	eax, [esp+48h+var_38]
		push	2
		pop	ecx
		mov	[esp+48h+var_18], eax
		lea	eax, [esp+48h+var_28]
		push	eax
		mov	[esp+4Ch+var_14], ecx
		mov	[esp+4Ch+var_C], ecx
		mov	[esp+4Ch+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	3
		call	sub_10015070
		mov	edx, [esi+4]
		lea	ecx, [esp+48h+var_3C]
		push	ecx		; int
		and	[esp+4Ch+var_3C], 0
		lea	ecx, [esp+4Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+50h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_1C]	; int
		mov	ecx, eax
		push	[ebp+arg_18]	; int
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_1000B759
		add	esp, 28h
		test	al, al
		jz	loc_10009D0E
		mov	eax, [esp+48h+var_3C]
		mov	[esi+1Ch], eax
		mov	eax, [esp+48h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+48h+TargetHandle]
		mov	[esi+18h], eax

loc_10009DD0:				; CODE XREF: sub_10009CE2+33j
		mov	ecx, [esp+48h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_10009CE2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009DE6	proc near		; DATA XREF: .rdata:1002BE94o

var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
TargetHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		mov	edx, edi
		mov	ecx, edi
		call	sub_1000B9D4
		test	al, al
		jnz	short loc_10009E1E

loc_10009E12:				; CODE XREF: sub_10009DE6+CDj
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	loc_10009ECE
; ---------------------------------------------------------------------------

loc_10009E1E:				; CODE XREF: sub_10009DE6+2Aj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_10009E28
		mov	eax, [edi]
		jmp	short loc_10009E2A
; ---------------------------------------------------------------------------

loc_10009E28:				; CODE XREF: sub_10009DE6+3Cj
		mov	eax, edi

loc_10009E2A:				; CODE XREF: sub_10009DE6+40j
		lea	ecx, [esp+48h+var_28]
		mov	[esp+48h+var_2C], eax
		mov	[esp+48h+var_38], 1
		call	sub_1000A22B
		lea	eax, [esp+48h+var_2C]
		mov	[esp+48h+var_24], 1
		mov	[esp+48h+var_20], eax
		lea	eax, [ebp+arg_C]
		mov	[esp+48h+var_10], eax
		lea	eax, [ebp+arg_14]
		mov	[esp+48h+var_8], eax
		lea	eax, [esp+48h+var_38]
		push	2
		pop	ecx
		mov	[esp+48h+var_18], eax
		lea	eax, [esp+48h+var_28]
		push	eax
		mov	[esp+4Ch+var_14], ecx
		mov	[esp+4Ch+var_C], ecx
		mov	[esp+4Ch+var_1C], ecx
		mov	ecx, [ebx+10h]
		push	4
		call	sub_10015070
		mov	edx, [esi+4]
		lea	ecx, [esp+48h+var_3C]
		and	[esp+48h+var_3C], 0
		push	ecx		; int
		lea	ecx, [esp+4Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+50h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_14]	; int
		mov	ecx, eax
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_1000B7E7
		add	esp, 20h
		test	al, al
		jz	loc_10009E12
		mov	eax, [esp+48h+var_3C]
		mov	[esi+1Ch], eax
		mov	eax, [esp+48h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+48h+TargetHandle]
		mov	[esi+18h], eax

loc_10009ECE:				; CODE XREF: sub_10009DE6+33j
		mov	ecx, [esp+48h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	18h
sub_10009DE6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009EE4	proc near		; DATA XREF: .rdata:1002BE68o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_C]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		cmp	dword ptr [ebx], 28h
		mov	edi, [ebp+arg_0]
		mov	[esp+30h+var_24], ecx
		jz	short loc_10009F14
		xor	al, al
		jmp	loc_10009FA1
; ---------------------------------------------------------------------------

loc_10009F14:				; CODE XREF: sub_10009EE4+27j
		mov	edx, esi
		mov	ecx, esi
		call	sub_1000B9D4
		test	al, al
		jnz	short loc_10009F2A

loc_10009F21:				; CODE XREF: sub_10009EE4+B2j
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_10009F9F
; ---------------------------------------------------------------------------

loc_10009F2A:				; CODE XREF: sub_10009EE4+3Bj
		cmp	dword ptr [esi+14h], 8
		mov	[esp+30h+var_20], 1
		jb	short loc_10009F3C
		mov	eax, [esi]
		jmp	short loc_10009F3E
; ---------------------------------------------------------------------------

loc_10009F3C:				; CODE XREF: sub_10009EE4+52j
		mov	eax, esi

loc_10009F3E:				; CODE XREF: sub_10009EE4+56j
		lea	ecx, [esp+30h+var_18]
		mov	[esp+30h+var_1C], eax
		call	sub_1000A247
		mov	ecx, [esp+30h+var_24]
		lea	eax, [esp+30h+var_1C]
		mov	[esp+30h+var_10], eax
		lea	eax, [esp+30h+var_20]
		mov	[esp+30h+var_8], eax
		lea	eax, [esp+30h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	5
		mov	[esp+38h+var_14], 1
		mov	[esp+38h+var_C], 2
		call	sub_10015070
		lea	ecx, [esp+30h+var_24]
		push	ecx
		push	dword ptr [ebx+4]
		mov	ecx, eax
		push	[ebp+arg_8]
		push	esi
		call	sub_1000B872
		add	esp, 10h
		test	al, al
		jz	short loc_10009F21
		mov	eax, [esp+30h+var_24]
		mov	[edi+10h], eax

loc_10009F9F:				; CODE XREF: sub_10009EE4+44j
		mov	al, 1

loc_10009FA1:				; CODE XREF: sub_10009EE4+2Bj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10009EE4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10009FB5	proc near		; DATA XREF: .rdata:1002BECCo

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_C]
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		cmp	dword ptr [ebx], 38h
		mov	edi, [ebp+arg_0]
		mov	[esp+30h+var_24], ecx
		jz	short loc_10009FE5
		xor	al, al
		jmp	loc_1000A072
; ---------------------------------------------------------------------------

loc_10009FE5:				; CODE XREF: sub_10009FB5+27j
		mov	edx, esi
		mov	ecx, esi
		call	sub_1000B9D4
		test	al, al
		jnz	short loc_10009FFB

loc_10009FF2:				; CODE XREF: sub_10009FB5+B2j
		mov	dword ptr [edi+10h], 0C0000022h
		jmp	short loc_1000A070
; ---------------------------------------------------------------------------

loc_10009FFB:				; CODE XREF: sub_10009FB5+3Bj
		cmp	dword ptr [esi+14h], 8
		mov	[esp+30h+var_20], 1
		jb	short loc_1000A00D
		mov	eax, [esi]
		jmp	short loc_1000A00F
; ---------------------------------------------------------------------------

loc_1000A00D:				; CODE XREF: sub_10009FB5+52j
		mov	eax, esi

loc_1000A00F:				; CODE XREF: sub_10009FB5+56j
		lea	ecx, [esp+30h+var_18]
		mov	[esp+30h+var_1C], eax
		call	sub_1000A247
		mov	ecx, [esp+30h+var_24]
		lea	eax, [esp+30h+var_1C]
		mov	[esp+30h+var_10], eax
		lea	eax, [esp+30h+var_20]
		mov	[esp+30h+var_8], eax
		lea	eax, [esp+30h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	6
		mov	[esp+38h+var_14], 1
		mov	[esp+38h+var_C], 2
		call	sub_10015070
		lea	ecx, [esp+30h+var_24]
		push	ecx
		push	dword ptr [ebx+4]
		mov	ecx, eax
		push	[ebp+arg_8]
		push	esi
		call	sub_1000B8E2
		add	esp, 10h
		test	al, al
		jz	short loc_10009FF2
		mov	eax, [esp+30h+var_24]
		mov	[edi+10h], eax

loc_1000A070:				; CODE XREF: sub_10009FB5+44j
		mov	al, 1

loc_1000A072:				; CODE XREF: sub_10009FB5+2Bj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10009FB5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A086	proc near		; DATA XREF: .rdata:1002BE3Co

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
hSourceHandle	= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+44h+var_44], ecx
		mov	ecx, [ebp+arg_8]
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [ecx], 8
		mov	[esp+4Ch+hSourceHandle], eax
		mov	eax, [ebp+arg_C]
		push	edi
		mov	[esp+50h+var_40], ecx
		jz	short loc_1000A0C0

loc_1000A0B9:				; CODE XREF: sub_1000A086+3Fj
					; sub_1000A086+55j
		xor	al, al
		jmp	loc_1000A1AF
; ---------------------------------------------------------------------------

loc_1000A0C0:				; CODE XREF: sub_1000A086+31j
		mov	ebx, [ebp+arg_10]
		cmp	ebx, [eax]
		jnz	short loc_1000A0B9
		mov	edi, [eax+4]
		mov	edx, ebx
		push	[ebp+arg_14]
		mov	ecx, edi
		call	sub_100142A1
		add	esp, 4
		test	al, al
		jz	short loc_1000A0B9
		and	[esp+50h+var_20], 0
		lea	ecx, [esp+50h+var_30] ;	void *
		xor	eax, eax
		mov	[esp+50h+var_1C], 7
		mov	word ptr [esp+50h+var_30], ax
		mov	eax, [edi+8]
		shr	eax, 1
		push	eax		; int
		lea	eax, [edi+0Ch]
		push	eax		; void *
		call	sub_10002356
		lea	edx, [esp+50h+var_30]
		mov	ecx, edx
		call	sub_1000B9D4
		test	al, al
		jz	short loc_1000A190
		cmp	[esp+50h+var_1C], 8
		mov	eax, [esp+50h+var_30]
		mov	[esp+50h+var_38], 1
		jnb	short loc_1000A12A
		lea	eax, [esp+50h+var_30]

loc_1000A12A:				; CODE XREF: sub_1000A086+9Ej
		lea	ecx, [esp+50h+var_18]
		mov	[esp+50h+var_34], eax
		call	sub_1000A247
		mov	ecx, [esp+50h+var_44]
		lea	eax, [esp+50h+var_34]
		mov	[esp+50h+var_10], eax
		lea	eax, [esp+50h+var_38]
		mov	[esp+50h+var_8], eax
		lea	eax, [esp+50h+var_18]
		push	eax
		mov	ecx, [ecx+10h]
		push	7
		mov	[esp+58h+var_14], 1
		mov	[esp+58h+var_C], 2
		call	sub_10015070
		mov	edx, [esi+4]
		lea	ecx, [esp+50h+var_44]
		push	ecx		; int
		mov	ecx, [esp+54h+var_40]
		push	dword ptr [ecx+4] ; int
		mov	ecx, eax
		push	[ebp+arg_14]	; int
		push	ebx		; int
		push	edi		; int
		push	[esp+64h+hSourceHandle]	; hSourceHandle
		call	sub_1000B952
		add	esp, 18h
		test	al, al
		jnz	short loc_1000A199

loc_1000A190:				; CODE XREF: sub_1000A086+8Bj
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_1000A1A0
; ---------------------------------------------------------------------------

loc_1000A199:				; CODE XREF: sub_1000A086+108j
		mov	ecx, [esp+50h+var_44]
		mov	[esi+10h], ecx

loc_1000A1A0:				; CODE XREF: sub_1000A086+111j
		push	0
		push	1
		lea	ecx, [esp+58h+var_30]
		call	sub_10002311
		mov	al, 1

loc_1000A1AF:				; CODE XREF: sub_1000A086+35j
		mov	ecx, [esp+50h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	18h
sub_1000A086	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A1C3	proc near		; CODE XREF: sub_10009BD2+25p
					; sub_10009BD2+31p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_1000A208
		cmp	[ebx], esi
		ja	short loc_1000A208
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	2Ch
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_1000A1F1
		push	ecx
		mov	ecx, ebx
		call	sub_1000A263

loc_1000A1F1:				; CODE XREF: sub_1000A1C3+24j
		mov	edi, [ebx+4]
		imul	esi, 2Ch
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_1000A202
		push	0Bh
		pop	ecx
		rep movsd

loc_1000A202:				; CODE XREF: sub_1000A1C3+38j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_1000A225
; ---------------------------------------------------------------------------

loc_1000A208:				; CODE XREF: sub_1000A1C3+Ej
					; sub_1000A1C3+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_1000A215
		push	ecx
		mov	ecx, ebx
		call	sub_1000A263

loc_1000A215:				; CODE XREF: sub_1000A1C3+48j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_1000A221
		push	0Bh
		pop	ecx
		rep movsd

loc_1000A221:				; CODE XREF: sub_1000A1C3+57j
		add	dword ptr [ebx+4], 2Ch

loc_1000A225:				; CODE XREF: sub_1000A1C3+43j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000A1C3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A22B	proc near		; CODE XREF: sub_10009CE2+54p
					; sub_10009DE6+54p ...
		push	3
		mov	dword ptr [ecx], 4
		lea	eax, [ecx+4]
		pop	edx

loc_1000A237:				; CODE XREF: sub_1000A22B+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_1000A237
		mov	eax, ecx
		retn
sub_1000A22B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A247	proc near		; CODE XREF: sub_10009EE4+62p
					; sub_10009FB5+62p ...
		xor	edx, edx
		mov	dword ptr [ecx], 2
		lea	eax, [ecx+4]
		inc	edx

loc_1000A253:				; CODE XREF: sub_1000A247+17j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	edx
		jns	short loc_1000A253
		mov	eax, ecx
		retn
sub_1000A247	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A263	proc near		; CODE XREF: sub_1000A1C3+29p
					; sub_1000A1C3+4Dp
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	2Ch
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_1000A2C7
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 5D1745Dh
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_1000A29E
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000A29E:				; CODE XREF: sub_1000A263+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_1000A2B6
		xor	eax, eax
		jmp	short loc_1000A2B8
; ---------------------------------------------------------------------------

loc_1000A2B6:				; CODE XREF: sub_1000A263+4Dj
		add	eax, edx

loc_1000A2B8:				; CODE XREF: sub_1000A263+51j
		cmp	eax, ecx
		jnb	short loc_1000A2BE
		mov	eax, ecx

loc_1000A2BE:				; CODE XREF: sub_1000A263+57j
		push	eax
		mov	ecx, esi
		call	sub_1000A2CD
		pop	ebx

loc_1000A2C7:				; CODE XREF: sub_1000A263+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_1000A263	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000A2CD	proc near		; CODE XREF: sub_1000A263+5Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		mov	ebp, ecx
		test	esi, esi
		jz	short loc_1000A2FC
		cmp	esi, 5D1745Dh
		ja	short loc_1000A2F6
		imul	eax, esi, 2Ch
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_1000A2FC

loc_1000A2F6:				; CODE XREF: sub_1000A2CD+16j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000A2FC:				; CODE XREF: sub_1000A2CD+Ej
					; sub_1000A2CD+27j
		mov	ecx, [ebp+4]
		mov	edx, ebx
		mov	eax, [ebp+0]
		mov	[esp+10h+var_4], ecx
		push	edi
		push	2Ch
		pop	edi
		cmp	eax, ecx
		jz	short loc_1000A330

loc_1000A310:				; CODE XREF: sub_1000A2CD+5Dj
		test	edx, edx
		jz	short loc_1000A324
		push	0Bh
		pop	ecx
		mov	esi, eax
		mov	edi, edx
		rep movsd
		mov	ecx, [esp+14h+var_4]
		push	2Ch
		pop	edi

loc_1000A324:				; CODE XREF: sub_1000A2CD+45j
		add	eax, edi
		add	edx, edi
		cmp	eax, ecx
		jnz	short loc_1000A310
		mov	esi, [esp+14h+arg_0]

loc_1000A330:				; CODE XREF: sub_1000A2CD+41j
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		cdq
		idiv	edi
		cmp	dword ptr [ebp+0], 0
		mov	edi, eax
		jz	short loc_1000A34B
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000A34B:				; CODE XREF: sub_1000A2CD+72j
		imul	ecx, esi, 2Ch
		imul	eax, edi, 2Ch
		pop	edi
		pop	esi
		mov	[ebp+0], ebx
		add	ecx, ebx
		add	eax, ebx
		mov	[ebp+8], ecx
		mov	[ebp+4], eax
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_1000A2CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000A366	proc near		; CODE XREF: sub_1000ACB8+40p
					; sub_1000ADD0+40p ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	0Ch
		push	offset stru_1002DCB8
		call	__SEH_prolog4
		mov	edx, ecx
		xor	eax, eax
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[edx], eax
		jz	short loc_1000A39B
		mov	ecx, [edx]
		mov	[ebp+var_1C], ecx

loc_1000A382:				; CODE XREF: sub_1000A366+28j
		mov	ax, [ecx]
		add	ecx, 2
		mov	[ebp+var_1C], ecx
		test	ax, ax
		jnz	short loc_1000A382
		sub	ecx, [edx]
		sar	ecx, 1
		lea	eax, ds:0FFFFFFFEh[ecx*2]

loc_1000A39B:				; CODE XREF: sub_1000A366+15j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_1000A3B5
; ---------------------------------------------------------------------------

loc_1000A3A4:				; DATA XREF: .rdata:stru_1002DCB8o
		xor	eax, eax	; Exception filter 0 for function 1000A366
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A3A8:				; DATA XREF: .rdata:stru_1002DCB8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A366
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		or	eax, 0FFFFFFFFh

loc_1000A3B5:				; CODE XREF: sub_1000A366+3Cj
		call	__SEH_epilog4
		retn
sub_1000A366	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000A3BB(void *)
sub_1000A3BB	proc near		; CODE XREF: sub_1000AEB8+B0p
					; sub_1000AFA2+F9p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	8
		push	offset stru_1002DCD8
		call	__SEH_prolog4
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	dword ptr [ecx]	; size_t
		push	[ebp+arg_0]	; void *
		push	dword ptr [ecx+4] ; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_1000A3F6
; ---------------------------------------------------------------------------

loc_1000A3E6:				; DATA XREF: .rdata:stru_1002DCD8o
		xor	eax, eax	; Exception filter 0 for function 1000A3BB
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A3EA:				; DATA XREF: .rdata:stru_1002DCD8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A3BB
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_1000A3F6:				; CODE XREF: sub_1000A3BB+29j
		call	__SEH_epilog4
		retn	4
sub_1000A3BB	endp

; Exported entry  23. _TargetNtCreateFile@48

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateFile(x, x, x,	x, x, x, x, x, x, x, x,	x)
		public _TargetNtCreateFile@48
_TargetNtCreateFile@48 proc near	; DATA XREF: sub_10009C33:loc_10009CB6o
					; .rdata:off_1002E058o

var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h
arg_2C		= dword	ptr  34h

		push	64h
		push	offset stru_1002DCF8
		call	__SEH_prolog4_GS
		mov	edx, [ebp+arg_0]
		mov	esi, [ebp+arg_4]
		mov	[ebp+var_58], esi
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_10]
		mov	ecx, [ebp+arg_14]
		mov	eax, [ebp+arg_28]
		push	[ebp+arg_2C]
		push	eax
		push	[ebp+arg_24]
		push	[ebp+arg_20]
		push	[ebp+arg_1C]
		push	[ebp+arg_18]
		push	ecx
		push	edi
		push	ebx
		push	[ebp+arg_8]
		push	esi
		call	edx
		mov	esi, eax
		mov	[ebp+var_5C], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000A5D4
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A470
		mov	eax, esi
		jmp	loc_1000A5D4
; ---------------------------------------------------------------------------

loc_1000A470:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+69j
		and	[ebp+var_54], 0
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+var_58]
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000A5C4
		push	1
		push	8
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000A5C4
		call	sub_10013DEB
		mov	[ebp+var_70], eax
		test	eax, eax
		jz	loc_1000A5C4
		and	[ebp+var_60], 0
		push	0
		lea	eax, [ebp+var_60]
		push	eax
		lea	edx, [ebp+var_54]
		mov	ecx, ebx
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A5C4
		cmp	[ebp+var_54], 0
		jz	loc_1000A5C4
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_64], eax
		mov	eax, [ebp+arg_24]
		mov	[ebp+var_68], eax
		and	[ebp+var_6C], 0
		lea	ecx, [ebp+var_40]
		call	sub_1000A22B
		lea	eax, [ebp+var_54]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_64]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_68]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_6C]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	edx, [ebp+var_40]
		push	3
		pop	ecx
		call	sub_10010168
		test	al, al
		jz	loc_1000A5C4
		push	[ebp+var_70]
		lea	ecx, [ebp+var_74]
		call	sub_10015A20
		and	[ebp+var_50], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_68]
		push	eax		; void *
		lea	eax, [ebp+arg_20]
		push	eax		; void *
		lea	eax, [ebp+arg_1C]
		push	eax		; void *
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+var_64]
		push	eax		; void *
		lea	eax, [ebp+var_60]
		push	eax		; void *
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	ecx, [ebp+var_74]
		call	sub_1000ACB8
		add	esp, 2Ch
		test	eax, eax
		jnz	short loc_1000A5C4
		mov	esi, [ebp+var_48]
		test	esi, esi
		js	short loc_1000A5D2
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_58]
		mov	[ecx], eax
		mov	[edi], esi
		mov	eax, [ebp+var_3C]
		mov	[edi+4], eax
		mov	[ebp+var_5C], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_1000A5C4
; ---------------------------------------------------------------------------

loc_1000A5B3:				; DATA XREF: .rdata:stru_1002DCF8o
		xor	eax, eax	; Exception filter 0 for function 1000A3FE
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A5B7:				; DATA XREF: .rdata:stru_1002DCF8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A3FE
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_5C]

loc_1000A5C4:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+86j
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+9Bj ...
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jz	short loc_1000A5D2
		xor	edx, edx
		call	sub_10014324

loc_1000A5D2:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+17Fj
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1CBj
		mov	eax, esi

loc_1000A5D4:				; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+45j
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+6Dj
		call	__SEH_epilog4_GS
		retn	30h
_TargetNtCreateFile@48 endp

; Exported entry  27. _TargetNtOpenFile@28

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenFile(x,	x, x, x, x, x, x)
		public _TargetNtOpenFile@28
_TargetNtOpenFile@28 proc near		; DATA XREF: sub_10009C33:loc_10009C9Do
					; .rdata:off_1002E058o

var_74		= byte ptr -74h
var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_48		= dword	ptr -48h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	64h
		push	offset stru_1002DD18
		call	__SEH_prolog4_GS
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_4]
		mov	[ebp+var_64], ecx
		mov	ebx, [ebp+arg_C]
		mov	edi, [ebp+arg_10]
		push	[ebp+arg_18]
		push	[ebp+arg_14]
		push	edi
		push	ebx
		push	[ebp+arg_8]
		push	ecx
		call	eax
		mov	esi, eax
		mov	[ebp+var_58], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000A795
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenfile	; "NtOpenFile"
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A63D
		mov	eax, esi
		jmp	loc_1000A795
; ---------------------------------------------------------------------------

loc_1000A63D:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+58j
		and	[ebp+var_54], 0
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+var_64]
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000A785
		push	1
		push	8
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000A785
		call	sub_10013DEB
		mov	[ebp+var_70], eax
		test	eax, eax
		jz	loc_1000A785
		push	0
		lea	eax, [ebp+var_6C]
		push	eax
		lea	edx, [ebp+var_54]
		mov	ecx, ebx
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A785
		cmp	[ebp+var_54], 0
		jz	loc_1000A785
		mov	eax, [ebp+arg_8]
		mov	[ebp+var_60], eax
		mov	eax, [ebp+arg_18]
		mov	[ebp+var_5C], eax
		and	[ebp+var_68], 0
		lea	ecx, [ebp+var_40]
		call	sub_1000A22B
		lea	eax, [ebp+var_54]
		mov	[ebp+var_3C], 1
		mov	[ebp+var_38], eax
		push	2
		pop	ecx
		lea	eax, [ebp+var_60]
		mov	[ebp+var_2C], ecx
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_5C]
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_68]
		mov	[ebp+var_34], ecx
		mov	[ebp+var_30], eax
		lea	edx, [ebp+var_40]
		push	4
		pop	ecx
		call	sub_10010168
		test	al, al
		jz	loc_1000A785
		push	[ebp+var_70]
		lea	ecx, [ebp+var_74]
		call	sub_10015A20
		and	[ebp+var_50], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_50]
		push	eax		; int
		lea	eax, [ebp+var_5C]
		push	eax		; void *
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+var_60]
		push	eax		; void *
		lea	eax, [ebp+var_6C]
		push	eax		; void *
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	ecx, [ebp+var_74]
		call	sub_1000ADD0
		add	esp, 24h
		test	eax, eax
		jnz	short loc_1000A785
		mov	esi, [ebp+var_48]
		test	esi, esi
		js	short loc_1000A793
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_40]
		mov	ecx, [ebp+var_64]
		mov	[ecx], eax
		mov	[edi], esi
		mov	eax, [ebp+var_3C]
		mov	[edi+4], eax
		mov	[ebp+var_58], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenfile	; "NtOpenFile"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_1000A785
; ---------------------------------------------------------------------------

loc_1000A774:				; DATA XREF: .rdata:stru_1002DD18o
		xor	eax, eax	; Exception filter 0 for function 1000A5DC
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000A778:				; DATA XREF: .rdata:stru_1002DD18o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000A5DC
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_58]

loc_1000A785:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+75j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+8Aj ...
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jz	short loc_1000A793
		xor	edx, edx
		call	sub_10014324

loc_1000A793:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+162j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+1AEj
		mov	eax, esi

loc_1000A795:				; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+34j
					; TargetNtOpenFile(x,x,x,x,x,x,x)+5Cj
		call	__SEH_epilog4_GS
		retn	1Ch
_TargetNtOpenFile@28 endp

; Exported entry  36. _TargetNtQueryAttributesFile@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtQueryAttributesFile(x, x, x)
		public _TargetNtQueryAttributesFile@12
_TargetNtQueryAttributesFile@12	proc near ; DATA XREF: sub_10009C33:loc_10009C84o
					; .rdata:off_1002E058o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+6Ch+var_60], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000A91E
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A7FA
		mov	eax, ebx
		jmp	loc_1000A91E
; ---------------------------------------------------------------------------

loc_1000A7FA:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+54j
		and	[esp+78h+var_68], 0
		mov	ecx, esi
		push	1
		push	28h
		pop	edx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000A90A
		call	sub_10013DEB
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000A90A
		and	[esp+78h+var_64], 0
		lea	eax, [esp+78h+var_64]
		push	0
		push	eax
		lea	edx, [esp+80h+var_68]
		mov	ecx, edi
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000A90A
		cmp	[esp+78h+var_68], 0
		jz	loc_1000A919
		mov	[esp+78h+var_58], esi
		lea	ecx, [esp+78h+var_18]
		xor	esi, esi
		mov	[esp+78h+var_5C], 28h
		mov	[esp+78h+var_60], esi
		call	sub_1000A247
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_14], 1
		mov	[esp+78h+var_10], eax
		lea	edx, [esp+78h+var_18]
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_C], 2
		push	5
		pop	ecx
		mov	[esp+78h+var_8], eax
		call	sub_10010168
		test	al, al
		jz	short loc_1000A90A
		mov	eax, [ebx+8]
		add	eax, ebx
		mov	[esp+78h+var_54], ebx
		push	30h		; size_t
		mov	dword ptr [esp+7Ch+var_50], eax
		lea	eax, [esp+7Ch+var_48]
		push	esi		; int
		push	eax		; void *
		mov	[esp+84h+var_4C], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+78h+var_4C]
		lea	ecx, [esp+78h+var_54]
		push	eax		; int
		lea	eax, [esp+7Ch+var_5C]
		push	eax		; int
		lea	eax, [esp+80h+var_64]
		push	eax		; void *
		lea	eax, [esp+84h+var_68]
		push	eax		; int
		push	5
		pop	edx
		call	sub_1000AEB8
		mov	ecx, [esp+88h+var_68]
		add	esp, 10h
		xor	edx, edx
		mov	esi, eax
		call	sub_10014324
		test	esi, esi
		jnz	short loc_1000A90A
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002B65
		mov	eax, [esp+7Ch+var_44]
		pop	ecx
		jmp	short loc_1000A91E
; ---------------------------------------------------------------------------

loc_1000A90A:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+71j
					; TargetNtQueryAttributesFile(x,x,x)+80j ...
		mov	ecx, [esp+78h+var_68]
		test	ecx, ecx
		jz	short loc_1000A919
		xor	edx, edx
		call	sub_10014324

loc_1000A919:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+ACj
					; TargetNtQueryAttributesFile(x,x,x)+173j
		mov	eax, 0C0000022h

loc_1000A91E:				; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+30j
					; TargetNtQueryAttributesFile(x,x,x)+58j ...
		mov	ecx, [esp+78h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
_TargetNtQueryAttributesFile@12	endp

; Exported entry  37. _TargetNtQueryFullAttributesFile@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtQueryFullAttributesFile(x, x, x)
		public _TargetNtQueryFullAttributesFile@12
_TargetNtQueryFullAttributesFile@12 proc near ;	DATA XREF: sub_10009C33:loc_10009C6Bo
					; .rdata:off_1002E058o

var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= byte ptr -48h
var_44		= dword	ptr -44h
var_18		= byte ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		and	[esp+6Ch+var_60], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	edi, [ebp+arg_4]
		push	esi
		push	edi
		call	eax
		mov	ebx, 0C0000022h
		cmp	eax, ebx
		jnz	loc_1000AAB3
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000A98F
		mov	eax, ebx
		jmp	loc_1000AAB3
; ---------------------------------------------------------------------------

loc_1000A98F:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+54j
		and	[esp+78h+var_68], 0
		mov	ecx, esi
		push	1
		push	38h
		pop	edx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000AA9F
		call	sub_10013DEB
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_1000AA9F
		and	[esp+78h+var_64], 0
		lea	eax, [esp+78h+var_64]
		push	0
		push	eax
		lea	edx, [esp+80h+var_68]
		mov	ecx, edi
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000AA9F
		cmp	[esp+78h+var_68], 0
		jz	loc_1000AAAE
		mov	[esp+78h+var_58], esi
		lea	ecx, [esp+78h+var_18]
		xor	esi, esi
		mov	[esp+78h+var_5C], 38h
		mov	[esp+78h+var_60], esi
		call	sub_1000A247
		lea	eax, [esp+78h+var_68]
		mov	[esp+78h+var_14], 1
		mov	[esp+78h+var_10], eax
		lea	edx, [esp+78h+var_18]
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_C], 2
		push	6
		pop	ecx
		mov	[esp+78h+var_8], eax
		call	sub_10010168
		test	al, al
		jz	short loc_1000AA9F
		mov	eax, [ebx+8]
		add	eax, ebx
		mov	[esp+78h+var_54], ebx
		push	30h		; size_t
		mov	dword ptr [esp+7Ch+var_50], eax
		lea	eax, [esp+7Ch+var_48]
		push	esi		; int
		push	eax		; void *
		mov	[esp+84h+var_4C], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+78h+var_4C]
		lea	ecx, [esp+78h+var_54]
		push	eax		; int
		lea	eax, [esp+7Ch+var_5C]
		push	eax		; int
		lea	eax, [esp+80h+var_64]
		push	eax		; void *
		lea	eax, [esp+84h+var_68]
		push	eax		; int
		push	6
		pop	edx
		call	sub_1000AEB8
		mov	ecx, [esp+88h+var_68]
		add	esp, 10h
		xor	edx, edx
		mov	esi, eax
		call	sub_10014324
		test	esi, esi
		jnz	short loc_1000AA9F
		mov	edx, [edi+8]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002B65
		mov	eax, [esp+7Ch+var_44]
		pop	ecx
		jmp	short loc_1000AAB3
; ---------------------------------------------------------------------------

loc_1000AA9F:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+71j
					; TargetNtQueryFullAttributesFile(x,x,x)+80j ...
		mov	ecx, [esp+78h+var_68]
		test	ecx, ecx
		jz	short loc_1000AAAE
		xor	edx, edx
		call	sub_10014324

loc_1000AAAE:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+ACj
					; TargetNtQueryFullAttributesFile(x,x,x)+173j
		mov	eax, 0C0000022h

loc_1000AAB3:				; CODE XREF: TargetNtQueryFullAttributesFile(x,x,x)+30j
					; TargetNtQueryFullAttributesFile(x,x,x)+58j ...
		mov	ecx, [esp+78h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
_TargetNtQueryFullAttributesFile@12 endp

; Exported entry  38. _TargetNtSetInformationFile@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationFile(x, x, x,	x, x, x)
		public _TargetNtSetInformationFile@24
_TargetNtSetInformationFile@24 proc near ; DATA	XREF: sub_10009C33+1Bo
					; .rdata:off_1002E058o

var_98		= dword	ptr -98h
var_94		= byte ptr -94h
var_90		= dword	ptr -90h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= byte ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= word ptr -50h
var_4E		= word ptr -4Eh
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	88h
		push	offset stru_1002DD38
		call	__SEH_prolog4_GS
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+arg_4]
		mov	[ebp+var_48], eax
		mov	edx, [ebp+arg_8]
		mov	[ebp+var_3C], edx
		mov	edi, [ebp+arg_C]
		push	[ebp+arg_14]
		mov	ebx, [ebp+arg_10]
		push	ebx
		push	edi
		push	edx
		push	eax
		call	ecx
		mov	esi, eax
		mov	[ebp+var_40], esi
		cmp	esi, 0C0000022h
		jnz	loc_1000ACB0
		push	2
		xor	edx, edx
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_100029E2
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_1000AB26
		mov	eax, esi
		jmp	loc_1000ACB0
; ---------------------------------------------------------------------------

loc_1000AB26:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+56j
		and	[ebp+var_38], 0
		call	sub_10013DEB
		mov	[ebp+var_58], eax
		test	eax, eax
		jz	loc_1000ACA0
		push	1
		push	8
		pop	edx
		mov	ecx, [ebp+var_3C]
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000ACA0
		push	0
		mov	edx, ebx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1000ACA0
		mov	[ebp+var_34], 18h
		xor	ecx, ecx
		mov	[ebp+var_30], ecx
		mov	[ebp+var_28], ecx
		lea	eax, [ebp+var_50]
		mov	[ebp+var_2C], eax
		mov	[ebp+var_24], ecx
		mov	[ebp+var_20], ecx
		mov	[ebp+ms_exc.registration.TryLevel], ecx
		push	[ebp+arg_14]
		mov	edx, ebx
		mov	ecx, edi
		call	sub_100142A1
		add	esp, 4
		test	al, al
		jnz	short loc_1000ABA1
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	loc_1000ACA0
; ---------------------------------------------------------------------------

loc_1000ABA1:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+CCj
		mov	eax, [edi+4]
		mov	[ebp+var_30], eax
		lea	eax, [edi+0Ch]
		mov	[ebp+var_4C], eax
		mov	ax, [edi+8]
		mov	[ebp+var_4E], ax
		mov	[ebp+var_50], ax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		push	0
		push	0
		lea	edx, [ebp+var_38]
		lea	ecx, [ebp+var_34]
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_1000ACA0
		cmp	[ebp+var_38], 0
		jz	loc_1000ACA0
		and	[ebp+var_54], 0
		lea	ecx, [ebp+var_30]
		call	sub_1000A247
		lea	eax, [ebp+var_38]
		mov	[ebp+var_2C], 1
		mov	[ebp+var_28], eax
		lea	eax, [ebp+var_54]
		mov	[ebp+var_24], 2
		mov	[ebp+var_20], eax
		lea	edx, [ebp+var_30]
		push	7
		pop	ecx
		call	sub_10010168
		test	al, al
		jz	loc_1000ACA0
		mov	[ebp+var_64], 8
		mov	eax, [ebp+var_3C]
		mov	[ebp+var_60], eax
		mov	[ebp+var_44], ebx
		mov	[ebp+var_40], edi
		push	[ebp+var_58]
		lea	ecx, [ebp+var_5C]
		call	sub_10015A20
		and	[ebp+var_98], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_94]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_98]
		push	eax		; int
		lea	eax, [ebp+arg_14]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+var_44]
		push	eax		; int
		lea	eax, [ebp+var_64]
		push	eax		; int
		lea	eax, [ebp+var_48]
		push	eax		; int
		lea	ecx, [ebp+var_5C]
		call	sub_1000AFA2
		add	esp, 24h
		test	eax, eax
		jnz	short loc_1000ACA0
		mov	esi, [ebp+var_90]
		xor	edx, edx
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		call	sub_10002AE3
		jmp	short loc_1000ACA0
; ---------------------------------------------------------------------------

loc_1000AC8F:				; DATA XREF: .rdata:stru_1002DD38o
		xor	eax, eax	; Exception filter 0 for function 1000AAC7
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000AC93:				; DATA XREF: .rdata:stru_1002DD38o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000AAC7
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+var_40]

loc_1000ACA0:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+6Dj
					; TargetNtSetInformationFile(x,x,x,x,x,x)+83j ...
		mov	ecx, [ebp+var_38]
		test	ecx, ecx
		jz	short loc_1000ACAE
		xor	edx, edx
		call	sub_10014324

loc_1000ACAE:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+1DEj
		mov	eax, esi

loc_1000ACB0:				; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+38j
					; TargetNtSetInformationFile(x,x,x,x,x,x)+5Aj
		call	__SEH_epilog4_GS
		retn	18h
_TargetNtSetInformationFile@24 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ACB8(int,	void *,	void *,	void *,	void *,	void *,	void *,	int)
sub_1000ACB8	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+16Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ACD0
		push	4
		pop	eax
		jmp	loc_1000ADCC
; ---------------------------------------------------------------------------

loc_1000ACD0:				; CODE XREF: sub_1000ACB8+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 3
		mov	dword ptr [edi+3Ch], 7
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A366
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		call	sub_1000B1A3
		test	al, al
		jnz	short loc_1000AD1A
		push	4
		pop	eax
		jmp	loc_1000ADCA
; ---------------------------------------------------------------------------

loc_1000AD1A:				; CODE XREF: sub_1000ACB8+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B1A3
		test	al, al
		jz	loc_1000ADC8
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, edi
		push	2		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000ADC8
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	3		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000ADC8
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000ADC8
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000ADC8
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	6		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000ADC8
		push	[esp+14h+arg_1C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000ADC8
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000ADC8:				; CODE XREF: sub_1000ACB8+78j
					; sub_1000ACB8+92j ...
		mov	eax, esi

loc_1000ADCA:				; CODE XREF: sub_1000ACB8+5Dj
		pop	esi
		pop	ebp

loc_1000ADCC:				; CODE XREF: sub_1000ACB8+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ACB8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ADD0(int,	void *,	void *,	void *,	void *,	int)
sub_1000ADD0	proc near		; CODE XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+151p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ADE8
		push	4
		pop	eax
		jmp	loc_1000AEB4
; ---------------------------------------------------------------------------

loc_1000ADE8:				; CODE XREF: sub_1000ADD0+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 4
		mov	dword ptr [edi+3Ch], 5
		mov	dword ptr [edi+44h], 88h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A366
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		call	sub_1000B253
		test	al, al
		jnz	short loc_1000AE32
		push	4
		pop	eax
		jmp	loc_1000AEB2
; ---------------------------------------------------------------------------

loc_1000AE32:				; CODE XREF: sub_1000ADD0+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B253
		test	al, al
		jz	short loc_1000AEB0
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, edi
		push	2		; int
		call	sub_1000B253
		test	al, al
		jz	short loc_1000AEB0
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	3		; int
		call	sub_1000B253
		test	al, al
		jz	short loc_1000AEB0
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B253
		test	al, al
		jz	short loc_1000AEB0
		push	[esp+14h+arg_14]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000AEB0
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000AEB0:				; CODE XREF: sub_1000ADD0+78j
					; sub_1000ADD0+8Ej ...
		mov	eax, esi

loc_1000AEB2:				; CODE XREF: sub_1000ADD0+5Dj
		pop	esi
		pop	ebp

loc_1000AEB4:				; CODE XREF: sub_1000ADD0+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ADD0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AEB8(int,	void *,	int, int)
sub_1000AEB8	proc near		; CODE XREF: TargetNtQueryAttributesFile(x,x,x)+139p
					; TargetNtQueryFullAttributesFile(x,x,x)+139p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		mov	ebp, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000AED6

loc_1000AECE:				; CODE XREF: sub_1000AEB8+58j
					; sub_1000AEB8+6Ej ...
		push	4

loc_1000AED0:				; CODE XREF: sub_1000AEB8+CEj
		pop	eax
		jmp	loc_1000AF9A
; ---------------------------------------------------------------------------

loc_1000AED6:				; CODE XREF: sub_1000AEB8+14j
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+1Ch+var_C]
		mov	[edi], esi
		mov	esi, [esp+1Ch+arg_0]
		mov	dword ptr [edi+3Ch], 3
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		mov	[esp+1Ch+var_C], esi
		call	sub_1000A366
		xor	ebx, ebx
		mov	ecx, edi
		inc	ebx
		push	ebx		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1000AECE
		push	2		; int
		push	0		; char
		push	4		; size_t
		push	[esp+28h+arg_4]	; void *
		mov	ecx, edi
		push	ebx		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1000AECE
		mov	eax, [esp+1Ch+arg_8]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+2Ch+var_C], ecx
		mov	ecx, edi
		push	2		; int
		mov	[esp+30h+var_8], eax
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1000AECE
		push	[esp+1Ch+arg_C]
		mov	ecx, ebp
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000AF98
		mov	ecx, [edi+5Ch]
		add	ecx, edi
		push	ecx		; void *
		lea	ecx, [esp+20h+var_C]
		call	sub_1000A3BB
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_1000AF8B
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_1000AED0
; ---------------------------------------------------------------------------

loc_1000AF8B:				; CODE XREF: sub_1000AEB8+BDj
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_1000AF98:				; CODE XREF: sub_1000AEB8+A4j
		mov	eax, esi

loc_1000AF9A:				; CODE XREF: sub_1000AEB8+19j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn
sub_1000AEB8	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000AFA2(int,	int, int, void *, void *, int)
sub_1000AFA2	proc near		; CODE XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+1A8p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h

		sub	esp, 10h
		push	ebx
		push	esi
		mov	ebx, ecx
		call	sub_100159C9
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000AFBC
		push	4
		pop	eax
		jmp	loc_1000B0ED
; ---------------------------------------------------------------------------

loc_1000AFBC:				; CODE XREF: sub_1000AFA2+10j
		mov	eax, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_10]
		push	ebp
		push	4
		pop	ebp
		push	ebp		; int
		xor	edx, edx
		mov	dword ptr [esi], 7
		push	edx		; char
		push	ebp		; size_t
		mov	[esi+4], edx
		mov	dword ptr [esi+3Ch], 5
		push	ecx		; void *
		mov	dword ptr [esi+44h], 88h
		mov	ecx, esi
		mov	eax, [eax]
		push	edx		; int
		mov	[esp+30h+var_10], eax
		call	sub_1000B253
		test	al, al
		jnz	short loc_1000AFFE
		mov	eax, ebp
		jmp	loc_1000B0EC
; ---------------------------------------------------------------------------

loc_1000AFFE:				; CODE XREF: sub_1000AFA2+53j
		mov	eax, [esp+1Ch+arg_4]
		push	edi
		push	6		; int
		xor	edi, edi
		mov	ecx, [eax]
		inc	edi
		mov	eax, [eax+4]
		push	edi		; char
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+30h+var_10], ecx
		mov	ecx, esi
		push	edi		; int
		mov	[esp+34h+var_C], eax
		call	sub_1000B253
		test	al, al
		jz	loc_1000B0E9
		mov	eax, [esp+20h+arg_8]
		push	6		; int
		push	edi		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+30h+var_8], ecx
		mov	ecx, esi
		push	2		; int
		mov	[esp+34h+var_4], eax
		call	sub_1000B253
		test	al, al
		jz	loc_1000B0E9
		push	2		; int
		push	0		; char
		push	ebp		; size_t
		push	[esp+2Ch+arg_C]	; void *
		mov	ecx, esi
		push	3		; int
		call	sub_1000B253
		test	al, al
		jz	loc_1000B0E9
		push	2		; int
		push	0		; char
		push	ebp		; size_t
		push	[esp+2Ch+arg_10] ; void	*
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000B253
		test	al, al
		jz	short loc_1000B0E9
		push	[esp+20h+arg_14]
		mov	ecx, ebx
		push	esi
		call	sub_10015A42
		mov	ebp, eax
		cmp	ebp, 0Ah
		jz	short loc_1000B0E9
		mov	ecx, [esi+50h]
		add	ecx, esi
		push	ecx		; void *
		lea	ecx, [esp+24h+var_10]
		call	sub_1000A3BB
		test	al, al
		jnz	short loc_1000B0B8
		sub	esi, [ebx+4]
		mov	ecx, [ebx]
		shr	esi, 0Ah
		add	ecx, 0Ch
		imul	edx, esi, 14h
		add	ecx, edx
		xchg	edi, [ecx]
		jmp	short loc_1000B0DD
; ---------------------------------------------------------------------------

loc_1000B0B8:				; CODE XREF: sub_1000AFA2+100j
		mov	eax, [esi+5Ch]
		lea	ecx, [esp+20h+var_8]
		add	eax, esi
		push	eax		; void *
		call	sub_1000A3BB
		sub	esi, [ebx+4]
		shr	esi, 0Ah
		imul	ecx, esi, 14h
		test	al, al
		mov	eax, [ebx]
		jnz	short loc_1000B0E2
		add	eax, 0Ch
		add	eax, ecx
		xchg	edi, [eax]

loc_1000B0DD:				; CODE XREF: sub_1000AFA2+114j
		push	2
		pop	eax
		jmp	short loc_1000B0EB
; ---------------------------------------------------------------------------

loc_1000B0E2:				; CODE XREF: sub_1000AFA2+132j
		add	eax, 0Ch
		add	eax, ecx
		xchg	edi, [eax]

loc_1000B0E9:				; CODE XREF: sub_1000AFA2+80j
					; sub_1000AFA2+A7j ...
		mov	eax, ebp

loc_1000B0EB:				; CODE XREF: sub_1000AFA2+13Ej
		pop	edi

loc_1000B0EC:				; CODE XREF: sub_1000AFA2+57j
		pop	ebp

loc_1000B0ED:				; CODE XREF: sub_1000AFA2+15j
		pop	esi
		pop	ebx
		add	esp, 10h
		retn
sub_1000AFA2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B0F3(int, void *, size_t, char,	int)
sub_1000B0F3	proc near		; CODE XREF: sub_1000AEB8+51p
					; sub_1000AEB8+67p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD58
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 3
		jnb	loc_1000B199
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B199
		test	esi, esi
		jz	short loc_1000B123
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B199

loc_1000B123:				; CODE XREF: sub_1000B0F3+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B199
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B199
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B164
		mov	dword ptr [edi+4], 1

loc_1000B164:				; CODE XREF: sub_1000B0F3+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B19B
; ---------------------------------------------------------------------------

loc_1000B18B:				; DATA XREF: .rdata:stru_1002DD58o
		xor	eax, eax	; Exception filter 0 for function 1000B0F3
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B18F:				; DATA XREF: .rdata:stru_1002DD58o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B0F3
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B199:				; CODE XREF: sub_1000B0F3+14j
					; sub_1000B0F3+20j ...
		xor	al, al

loc_1000B19B:				; CODE XREF: sub_1000B0F3+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B0F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B1A3(int, void *, size_t, char,	int)
sub_1000B1A3	proc near		; CODE XREF: sub_1000ACB8+51p
					; sub_1000ACB8+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD78
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 7
		jnb	loc_1000B249
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B249
		test	esi, esi
		jz	short loc_1000B1D3
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B249

loc_1000B1D3:				; CODE XREF: sub_1000B1A3+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B249
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B249
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B214
		mov	dword ptr [edi+4], 1

loc_1000B214:				; CODE XREF: sub_1000B1A3+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B24B
; ---------------------------------------------------------------------------

loc_1000B23B:				; DATA XREF: .rdata:stru_1002DD78o
		xor	eax, eax	; Exception filter 0 for function 1000B1A3
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B23F:				; DATA XREF: .rdata:stru_1002DD78o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B1A3
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B249:				; CODE XREF: sub_1000B1A3+14j
					; sub_1000B1A3+20j ...
		xor	al, al

loc_1000B24B:				; CODE XREF: sub_1000B1A3+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B1A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000B253(int, void *, size_t, char,	int)
sub_1000B253	proc near		; CODE XREF: sub_1000ADD0+51p
					; sub_1000ADD0+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DD98
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 5
		jnb	loc_1000B2F9
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000B2F9
		test	esi, esi
		jz	short loc_1000B283
		cmp	[ebp+arg_4], 0
		jz	short loc_1000B2F9

loc_1000B283:				; CODE XREF: sub_1000B253+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000B2F9
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000B2F9
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000B2C4
		mov	dword ptr [edi+4], 1

loc_1000B2C4:				; CODE XREF: sub_1000B253+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000B2FB
; ---------------------------------------------------------------------------

loc_1000B2EB:				; DATA XREF: .rdata:stru_1002DD98o
		xor	eax, eax	; Exception filter 0 for function 1000B253
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000B2EF:				; DATA XREF: .rdata:stru_1002DD98o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000B253
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000B2F9:				; CODE XREF: sub_1000B253+14j
					; sub_1000B253+20j ...
		xor	al, al

loc_1000B2FB:				; CODE XREF: sub_1000B253+96j
		call	__SEH_epilog4
		retn	14h
sub_1000B253	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1000B303@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int, int, int, int, int, int, int, HANDLE hTargetProcessHandle)
sub_1000B303	proc near		; CODE XREF: sub_1000B759+71p
					; sub_1000B7E7+6Dp

hObject		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
hTargetProcessHandle= dword ptr	 24h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		mov	ebx, ecx
		xor	ebp, ebp
		lea	edx, [esp+14h+var_4]
		push	edi
		mov	ecx, offset aNtcreatefile ; "NtCreateFile"
		mov	[esp+18h+var_4], ebp
		call	sub_10018835
		mov	edi, [esp+18h+arg_0]
		lea	eax, [esp+18h+hObject]
		push	ebp
		push	ebp
		push	[esp+20h+arg_14]
		or	[esp+24h+hObject], 0FFFFFFFFh
		push	[esp+24h+arg_10]
		push	[esp+28h+arg_C]
		push	[esp+2Ch+arg_8]
		push	ebp
		push	[esp+34h+arg_4]
		push	edi
		push	esi
		push	eax
		call	[esp+44h+var_4]
		test	eax, eax
		js	short loc_1000B39C
		mov	edx, [edi+8]
		mov	ecx, [esp+18h+hObject]
		mov	edx, [edx+4]
		call	sub_10018284
		test	al, al
		jnz	short loc_1000B374
		push	[esp+18h+hObject] ; hObject
		call	ds:CloseHandle
		mov	eax, 0C0000022h
		jmp	short loc_1000B39C
; ---------------------------------------------------------------------------

loc_1000B374:				; CODE XREF: sub_1000B303+5Ej
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	ebx		; lpTargetHandle
		push	[esp+28h+hTargetProcessHandle] ; hTargetProcessHandle
		push	[esp+2Ch+hObject] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_1000B39C:				; CODE XREF: sub_1000B303+4Bj
					; sub_1000B303+6Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_1000B303	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1000B3A3@<eax>(void *@<ecx>, int)
sub_1000B3A3	proc near		; CODE XREF: sub_10015277+14Ep

var_78		= byte ptr -78h
var_68		= byte ptr -68h
var_58		= byte ptr -58h
var_48		= byte ptr -48h
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		and	[esp+78h+var_38], 0
		push	ebx
		push	ebp
		mov	ebp, [esp+80h+arg_0]
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, edx
		push	esi		; void *
		lea	ecx, [esp+8Ch+var_34] ;	void *
		call	sub_10001C7F
		cmp	[esp+88h+var_24], 0
		jz	loc_1000B5F0
		cmp	[esp+88h+var_20], 8
		mov	eax, [esp+88h+var_34]
		jnb	short loc_1000B3E9
		lea	eax, [esp+88h+var_34]

loc_1000B3E9:				; CODE XREF: sub_1000B3A3+40j
		push	8		; size_t
		push	offset aDevice	; "\\Device\\"
		push	eax		; wchar_t *
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jz	short loc_1000B444
		lea	edx, [esp+88h+var_34]
		mov	ecx, edx
		call	sub_1000B9D4
		test	al, al
		jz	loc_1000B5F0
		lea	edx, [esp+88h+var_34]
		lea	ecx, [esp+88h+var_1C] ;	int
		call	sub_1000BA03
		push	eax		; void *
		lea	ecx, [esp+8Ch+var_34]
		call	sub_10003B36
		push	0
		push	1
		lea	ecx, [esp+90h+var_1C]
		call	sub_10002311
		cmp	[esp+88h+var_20], 8
		mov	esi, [esp+88h+var_34]
		jnb	short loc_1000B444
		lea	esi, [esp+88h+var_34]

loc_1000B444:				; CODE XREF: sub_1000B3A3+59j
					; sub_1000B3A3+9Bj
		push	1Fh
		pop	ebx
		push	3
		lea	ecx, [esp+8Ch+var_78]
		call	sub_1000F98B
		push	3
		lea	ecx, [esp+8Ch+var_68]
		call	sub_1000F98B
		push	3
		lea	ecx, [esp+8Ch+var_1C]
		call	sub_1000F98B
		push	3
		lea	ecx, [esp+8Ch+var_48]
		call	sub_1000F98B
		push	3
		lea	ecx, [esp+8Ch+var_58]
		call	sub_1000F98B
		sub	edi, 0
		jz	short loc_1000B4DD
		dec	edi
		jz	short loc_1000B4B6
		dec	edi
		jz	short loc_1000B4B2
		dec	edi
		jnz	loc_1000B5BB
		push	1
		push	1
		push	3
		push	edi
		lea	ecx, [esp+98h+var_68]
		call	sub_1000FC7A
		push	1
		push	1
		push	3
		push	edi
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FC7A
		jmp	short loc_1000B4DD
; ---------------------------------------------------------------------------

loc_1000B4B2:				; CODE XREF: sub_1000B3A3+E4j
		push	0Ch
		jmp	short loc_1000B4DC
; ---------------------------------------------------------------------------

loc_1000B4B6:				; CODE XREF: sub_1000B3A3+E1j
		xor	ebx, ebx
		lea	ecx, [esp+88h+var_68]
		inc	ebx
		mov	edi, 5FEDFF56h
		push	ebx
		push	edi
		push	2
		push	ebx
		call	sub_1000FC7A
		push	ebx
		push	edi
		push	2
		push	ebx
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FC7A
		push	0Fh

loc_1000B4DC:				; CODE XREF: sub_1000B3A3+111j
		pop	ebx

loc_1000B4DD:				; CODE XREF: sub_1000B3A3+DEj
					; sub_1000B3A3+10Dj
		test	bl, 1
		jz	short loc_1000B50F
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_78]
		call	sub_1000FB42
		test	al, al
		jz	loc_1000B5BB
		lea	eax, [esp+88h+var_78]
		mov	ecx, ebp
		push	eax
		push	3
		call	sub_1000F6EE
		test	al, al
		jz	loc_1000B5BB

loc_1000B50F:				; CODE XREF: sub_1000B3A3+13Dj
		test	bl, 2
		jz	short loc_1000B53D
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_68]
		call	sub_1000FB42
		test	al, al
		jz	loc_1000B5BB
		lea	eax, [esp+88h+var_68]
		mov	ecx, ebp
		push	eax
		push	4
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B5BB

loc_1000B53D:				; CODE XREF: sub_1000B3A3+16Fj
		test	bl, 4
		jz	short loc_1000B567
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_1C]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1000B5BB
		lea	eax, [esp+88h+var_1C]
		mov	ecx, ebp
		push	eax
		push	5
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B5BB

loc_1000B567:				; CODE XREF: sub_1000B3A3+19Dj
		test	bl, 8
		jz	short loc_1000B591
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_48]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1000B5BB
		lea	eax, [esp+88h+var_48]
		mov	ecx, ebp
		push	eax
		push	6
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B5BB

loc_1000B591:				; CODE XREF: sub_1000B3A3+1C7j
		test	bl, 10h
		jz	short loc_1000B5BF
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [esp+98h+var_58]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1000B5BB
		lea	eax, [esp+88h+var_58]
		mov	ecx, ebp
		push	eax
		push	7
		call	sub_1000F6EE
		test	al, al
		jnz	short loc_1000B5BF

loc_1000B5BB:				; CODE XREF: sub_1000B3A3+E7j
					; sub_1000B3A3+150j ...
		xor	bl, bl
		jmp	short loc_1000B5C1
; ---------------------------------------------------------------------------

loc_1000B5BF:				; CODE XREF: sub_1000B3A3+1F1j
					; sub_1000B3A3+216j
		mov	bl, 1

loc_1000B5C1:				; CODE XREF: sub_1000B3A3+21Aj
		lea	ecx, [esp+88h+var_58]
		call	sub_1000FDA2
		lea	ecx, [esp+88h+var_48]
		call	sub_1000FDA2
		lea	ecx, [esp+88h+var_1C]
		call	sub_1000FDA2
		lea	ecx, [esp+88h+var_68]
		call	sub_1000FDA2
		lea	ecx, [esp+88h+var_78]
		call	sub_1000FDA2
		jmp	short loc_1000B5F2
; ---------------------------------------------------------------------------

loc_1000B5F0:				; CODE XREF: sub_1000B3A3+31j
					; sub_1000B3A3+68j
		xor	bl, bl

loc_1000B5F2:				; CODE XREF: sub_1000B3A3+24Bj
		push	0
		push	1
		lea	ecx, [esp+90h+var_34]
		call	sub_10002311
		mov	ecx, [esp+88h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn
sub_1000B3A3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B617	proc near		; CODE XREF: sub_10015277+12Ep

var_24		= byte ptr -24h
var_14		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_24]
		push	3
		call	sub_1000F98B
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F98B
		xor	eax, eax
		lea	ecx, [ebp+var_24]
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		mov	[ebp+var_4], eax
		call	sub_1000FC7A
		push	0
		mov	bl, al
		xor	eax, eax
		push	offset a??	; "\\/?/?\\*"
		push	ecx
		inc	eax
		lea	ecx, [ebp+var_24]
		push	eax
		call	sub_1000FB42
		and	bl, al
		lea	ecx, [ebp+var_14]
		xor	eax, eax
		inc	eax
		push	eax
		push	eax
		push	eax
		push	eax
		call	sub_1000FC7A
		push	0
		push	offset asc_1002BEE0 ; "*~*"
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		and	bl, al
		call	sub_1000FB42
		test	bl, al
		jz	loc_1000B73C
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	3
		call	sub_1000F6EE
		test	al, al
		jz	loc_1000B73C
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	3
		call	sub_1000F6EE
		test	al, al
		jz	loc_1000B73C
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	4
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	5
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	6
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_24]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1000B73C
		lea	eax, [ebp+var_14]
		mov	ecx, esi
		push	eax
		push	7
		call	sub_1000F6EE
		test	al, al
		jnz	short loc_1000B740

loc_1000B73C:				; CODE XREF: sub_1000B617+6Dj
					; sub_1000B617+82j ...
		mov	byte ptr [ebp+var_4], 0

loc_1000B740:				; CODE XREF: sub_1000B617+123j
		lea	ecx, [ebp+var_14]
		call	sub_1000FDA2
		lea	ecx, [ebp+var_24]
		call	sub_1000FDA2
		mov	eax, [ebp+var_4]
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B617	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B759(int,	int, int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_1000B759	proc near		; CODE XREF: sub_10009CE2+C9p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
lpTargetHandle	= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B775
		mov	eax, [ebp+arg_20]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_1000B7E1
; ---------------------------------------------------------------------------

loc_1000B775:				; CODE XREF: sub_1000B759+Dj
		xor	ecx, ecx
		mov	edx, [ebp+arg_4]
		xor	eax, eax
		mov	[ebp+var_28], ecx
		mov	[ebp+var_8], ax
		lea	edi, [ebp+var_24]
		stosd
		mov	[ebp+var_10], ecx
		mov	[ebp+var_C], ecx
		mov	[ebp+var_6], ecx
		stosd
		mov	[ebp+var_2], cx
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	ecx
		mov	ecx, [ebp+arg_0]
		call	sub_10015438
		add	esp, 0Ch
		mov	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	dword ptr [esi]	; hTargetProcessHandle
		push	ecx		; int
		push	ecx		; int
		push	[ebp+arg_18]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[ebp+arg_C]	; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		call	sub_1000B303
		mov	ecx, [ebp+arg_20]
		add	esp, 24h
		mov	[ecx], eax
		mov	ecx, [ebp+arg_24]
		mov	eax, [ebp+var_C]
		mov	[ecx], eax
		mov	al, 1

loc_1000B7E1:				; CODE XREF: sub_1000B759+1Aj
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B759	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B7E7(int,	int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_1000B7E7	proc near		; CODE XREF: sub_10009DE6+C3p

var_28		= dword	ptr -28h
var_24		= byte ptr -24h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
lpTargetHandle	= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B802
		mov	eax, [ebp+arg_18]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B869
; ---------------------------------------------------------------------------

loc_1000B802:				; CODE XREF: sub_1000B7E7+Ej
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		xor	ebx, ebx
		mov	[ebp+var_8], ax
		mov	[ebp+var_28], ebx
		lea	edi, [ebp+var_24]
		stosd
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_10], ebx
		mov	[ebp+var_C], ebx
		stosd
		mov	[ebp+var_6], ebx
		mov	[ebp+var_2], bx
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		push	ebx
		call	sub_10015438
		add	esp, 0Ch
		mov	edx, [ebp+arg_8]
		lea	eax, [ebp+var_10]
		push	dword ptr [esi]	; hTargetProcessHandle
		push	ecx		; int
		push	ecx		; int
		push	[ebp+arg_10]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	1		; int
		push	[ebp+arg_C]	; int
		push	ebx		; int
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; int
		call	sub_1000B303
		mov	ecx, [ebp+arg_18]
		add	esp, 24h
		mov	edx, [ebp+arg_1C]
		mov	[ecx], eax
		mov	ecx, [ebp+var_C]
		mov	[edx], ecx

loc_1000B869:				; CODE XREF: sub_1000B7E7+19j
		pop	edi
		pop	esi
		mov	al, 1
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B7E7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B872	proc near		; CODE XREF: sub_10009EE4+A8p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B88A
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B8DA
; ---------------------------------------------------------------------------

loc_1000B88A:				; CODE XREF: sub_1000B872+Bj
		xor	esi, esi
		lea	edx, [ebp+var_4]
		mov	ecx, offset aNtqueryattribu ; "NtQueryAttributesFile"
		mov	[ebp+var_4], esi
		call	sub_10018835
		xor	eax, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		stosd
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_A], esi
		stosd
		mov	[ebp+var_6], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	esi
		call	sub_10015438
		add	esp, 0Ch
		lea	eax, [ebp+var_24]
		push	[ebp+arg_8]
		push	eax
		call	[ebp+var_4]
		mov	ecx, [ebp+arg_C]
		mov	[ecx], eax

loc_1000B8DA:				; CODE XREF: sub_1000B872+16j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B872	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B8E2	proc near		; CODE XREF: sub_10009FB5+A8p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	esi
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B8FA
		mov	eax, [ebp+arg_C]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B94A
; ---------------------------------------------------------------------------

loc_1000B8FA:				; CODE XREF: sub_1000B8E2+Bj
		xor	esi, esi
		lea	edx, [ebp+var_4]
		mov	ecx, offset aNtqueryfullatt ; "NtQueryFullAttributesFile"
		mov	[ebp+var_4], esi
		call	sub_10018835
		xor	eax, eax
		mov	[ebp+var_24], esi
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		stosd
		mov	edx, [ebp+arg_4]
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_A], esi
		stosd
		mov	[ebp+var_6], si
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	esi
		call	sub_10015438
		add	esp, 0Ch
		lea	eax, [ebp+var_24]
		push	[ebp+arg_8]
		push	eax
		call	[ebp+var_4]
		mov	ecx, [ebp+arg_C]
		mov	[ecx], eax

loc_1000B94A:				; CODE XREF: sub_1000B8E2+16j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B8E2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_1000B952(HANDLE hSourceHandle, int, int, int,	int, int)
sub_1000B952	proc near		; CODE XREF: sub_1000A086+FEp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
TargetHandle	= dword	ptr -4
hSourceHandle	= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_1000B96C

loc_1000B961:				; CODE XREF: sub_1000B952+4Bj
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_1000B9CC
; ---------------------------------------------------------------------------

loc_1000B96C:				; CODE XREF: sub_1000B952+Dj
		xor	edi, edi
		lea	edx, [ebp+var_8]
		mov	ecx, offset aNtsetinformati ; "NtSetInformationFile"
		mov	[ebp+var_8], edi
		call	sub_10018835
		push	2		; dwOptions
		push	edi		; bInheritHandle
		push	edi		; dwDesiredAccess
		lea	eax, [ebp+TargetHandle]
		mov	[ebp+TargetHandle], edi
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		push	dword ptr [esi]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000B961
		push	[ebp+TargetHandle]
		lea	ecx, [ebp+var_C]
		mov	[ebp+var_C], edi
		call	sub_10004610
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_10]
		push	[ebp+TargetHandle]
		call	[ebp+var_8]
		mov	ecx, [ebp+arg_14]
		mov	[ecx], eax
		lea	ecx, [ebp+var_C]
		call	sub_10004646

loc_1000B9CC:				; CODE XREF: sub_1000B952+18j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000B9D4	proc near		; CODE XREF: sub_10009CE2+23p
					; sub_10009DE6+23p ...

var_1		= byte ptr -1

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, edx
		call	sub_100184BD
		lea	edx, [ebp+var_1]
		mov	[ebp+var_1], 0
		mov	ecx, esi
		call	sub_10018182
		test	eax, eax
		jz	short loc_1000B9F6
		xor	al, al
		jmp	short loc_1000B9FE
; ---------------------------------------------------------------------------

loc_1000B9F6:				; CODE XREF: sub_1000B9D4+1Cj
		xor	eax, eax
		cmp	[ebp+var_1], al
		setz	al

loc_1000B9FE:				; CODE XREF: sub_1000B9D4+20j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000B9D4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1000BA03(int)
sub_1000BA03	proc near		; CODE XREF: sub_1000B3A3+76p

var_14		= byte ptr -14h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		push	edx
		mov	ebx, ecx
		call	sub_100038A0
		mov	esi, offset a??_0 ; "\\/?/?\\"
		lea	edi, [ebp+var_14]
		movsd
		movsd
		movsd
		movsw
		mov	esi, offset a??_1 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001AF3
		push	eax
		push	esi
		push	4
		xor	esi, esi
		mov	ecx, ebx
		push	esi
		call	sub_10003F14
		lea	ecx, [ebp+var_14]
		test	eax, eax
		jz	short loc_1000BA7B
		call	sub_10001AF3
		push	eax
		lea	eax, [ebp+var_14]
		mov	ecx, ebx
		push	eax
		push	6
		push	esi
		call	sub_10003F14
		test	eax, eax
		jz	short loc_1000BA8F
		lea	ecx, [ebp+var_14]
		call	sub_10001AF3
		push	eax		; int
		lea	eax, [ebp+var_14]
		push	eax		; void *
		push	ecx		; int
		mov	ecx, ebx	; int
		call	sub_1000BAA2
		jmp	short loc_1000BA8F
; ---------------------------------------------------------------------------

loc_1000BA7B:				; CODE XREF: sub_1000BA03+47j
		call	sub_10001AF3
		push	eax		; int
		lea	eax, [ebp+var_14]
		mov	ecx, ebx
		push	eax		; void *
		push	4		; int
		push	esi		; int
		call	sub_10003F72

loc_1000BA8F:				; CODE XREF: sub_1000BA03+5Fj
					; sub_1000BA03+76j
		mov	ecx, [ebp+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1000BA03	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000BAA2(int, int,	void *,	int)
sub_1000BAA2	proc near		; CODE XREF: sub_1000BA03+71p

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		push	edi
		mov	edi, [esp+8+arg_4]
		mov	esi, ecx
		push	edi
		call	sub_100024C5
		test	al, al
		jz	short loc_1000BAD4
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BABE
		mov	eax, [esi]
		jmp	short loc_1000BAC0
; ---------------------------------------------------------------------------

loc_1000BABE:				; CODE XREF: sub_1000BAA2+16j
		mov	eax, esi

loc_1000BAC0:				; CODE XREF: sub_1000BAA2+1Aj
		push	[esp+8+arg_8]	; int
		sub	edi, eax
		sar	edi, 1
		push	edi		; int
		push	esi		; int
		push	ecx		; int
		mov	ecx, esi	; void *
		call	sub_1000BB50
		jmp	short loc_1000BB4B
; ---------------------------------------------------------------------------

loc_1000BAD4:				; CODE XREF: sub_1000BAA2+10j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		push	ebx
		mov	ebx, [esp+0Ch+arg_8]
		sub	eax, ecx
		cmp	eax, ebx
		ja	short loc_1000BAF0
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000BAF0:				; CODE XREF: sub_1000BAA2+41j
		test	ebx, ebx
		jz	short loc_1000BB48
		push	ebp
		lea	ebp, [ecx+ebx]
		mov	ecx, esi
		push	0
		push	ebp
		call	sub_1000245E
		test	al, al
		jz	short loc_1000BB47
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BB10
		mov	edx, [esi]
		jmp	short loc_1000BB12
; ---------------------------------------------------------------------------

loc_1000BB10:				; CODE XREF: sub_1000BAA2+68j
		mov	edx, esi	; void *

loc_1000BB12:				; CODE XREF: sub_1000BAA2+6Cj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BB1C
		mov	eax, [esi]
		jmp	short loc_1000BB1E
; ---------------------------------------------------------------------------

loc_1000BB1C:				; CODE XREF: sub_1000BAA2+74j
		mov	eax, esi

loc_1000BB1E:				; CODE XREF: sub_1000BAA2+78j
		push	dword ptr [esi+10h] ; int
		lea	ecx, [eax+ebx*2] ; void	*
		call	sub_10001B2D
		cmp	dword ptr [esi+14h], 8
		pop	ecx
		jb	short loc_1000BB34
		mov	ecx, [esi]
		jmp	short loc_1000BB36
; ---------------------------------------------------------------------------

loc_1000BB34:				; CODE XREF: sub_1000BAA2+8Cj
		mov	ecx, esi	; void *

loc_1000BB36:				; CODE XREF: sub_1000BAA2+90j
		push	ebx		; int
		mov	edx, edi	; void *
		call	sub_10001B13
		pop	ecx
		push	ebp
		mov	ecx, esi
		call	sub_100023C1

loc_1000BB47:				; CODE XREF: sub_1000BAA2+62j
		pop	ebp

loc_1000BB48:				; CODE XREF: sub_1000BAA2+50j
		mov	eax, esi
		pop	ebx

loc_1000BB4B:				; CODE XREF: sub_1000BAA2+30j
		pop	edi
		pop	esi
		retn	0Ch
sub_1000BAA2	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000BB50(void *, int, int,	int, int)
sub_1000BB50	proc near		; CODE XREF: sub_1000BAA2+2Bp

arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, [esp+4+arg_8]
		push	ebp
		mov	ebp, [esp+8+arg_4]
		push	esi
		mov	esi, ecx
		mov	eax, [ebp+10h]
		cmp	eax, ebx
		jb	loc_1000BC37
		push	edi
		mov	edi, [esp+10h+arg_C]
		sub	eax, ebx
		cmp	eax, edi
		jnb	short loc_1000BB75
		mov	edi, eax

loc_1000BB75:				; CODE XREF: sub_1000BB50+21j
		mov	ecx, [esi+10h]
		or	eax, 0FFFFFFFFh
		sub	eax, ecx
		cmp	eax, edi
		ja	short loc_1000BB8C
		push	offset aStringTooLong ;	"string	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000BB8C:				; CODE XREF: sub_1000BB50+2Fj
		test	edi, edi
		jz	loc_1000BC2E
		lea	eax, [ecx+edi]
		mov	ecx, esi
		push	0
		push	eax
		mov	[esp+18h+arg_4], eax
		call	sub_1000245E
		test	al, al
		jz	loc_1000BC2E
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBB7
		mov	edx, [esi]
		jmp	short loc_1000BBB9
; ---------------------------------------------------------------------------

loc_1000BBB7:				; CODE XREF: sub_1000BB50+61j
		mov	edx, esi	; void *

loc_1000BBB9:				; CODE XREF: sub_1000BB50+65j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBC3
		mov	eax, [esi]
		jmp	short loc_1000BBC5
; ---------------------------------------------------------------------------

loc_1000BBC3:				; CODE XREF: sub_1000BB50+6Dj
		mov	eax, esi

loc_1000BBC5:				; CODE XREF: sub_1000BB50+71j
		push	dword ptr [esi+10h] ; int
		lea	ecx, [eax+edi*2] ; void	*
		call	sub_10001B2D
		pop	ecx
		cmp	esi, ebp
		jnz	short loc_1000BBFE
		test	ebx, ebx
		jz	short loc_1000BBDB
		add	ebx, edi

loc_1000BBDB:				; CODE XREF: sub_1000BB50+87j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBE5
		mov	eax, [esi]
		jmp	short loc_1000BBE7
; ---------------------------------------------------------------------------

loc_1000BBE5:				; CODE XREF: sub_1000BB50+8Fj
		mov	eax, esi

loc_1000BBE7:				; CODE XREF: sub_1000BB50+93j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BBF1
		mov	ecx, [esi]
		jmp	short loc_1000BBF3
; ---------------------------------------------------------------------------

loc_1000BBF1:				; CODE XREF: sub_1000BB50+9Bj
		mov	ecx, esi	; void *

loc_1000BBF3:				; CODE XREF: sub_1000BB50+9Fj
		push	edi		; int
		lea	edx, [eax+ebx*2] ; void	*
		call	sub_10001B2D
		jmp	short loc_1000BC22
; ---------------------------------------------------------------------------

loc_1000BBFE:				; CODE XREF: sub_1000BB50+83j
		cmp	dword ptr [ebp+14h], 8
		jb	short loc_1000BC07
		mov	ebp, [ebp+0]

loc_1000BC07:				; CODE XREF: sub_1000BB50+B2j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1000BC11
		mov	ecx, [esi]
		jmp	short loc_1000BC13
; ---------------------------------------------------------------------------

loc_1000BC11:				; CODE XREF: sub_1000BB50+BBj
		mov	ecx, esi	; void *

loc_1000BC13:				; CODE XREF: sub_1000BB50+BFj
		lea	edx, ds:0[ebx*2]
		push	edi		; int
		add	edx, ebp	; void *
		call	sub_10001B13

loc_1000BC22:				; CODE XREF: sub_1000BB50+ACj
		pop	ecx
		push	[esp+10h+arg_4]
		mov	ecx, esi
		call	sub_100023C1

loc_1000BC2E:				; CODE XREF: sub_1000BB50+3Ej
					; sub_1000BB50+57j
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		retn	10h
; ---------------------------------------------------------------------------

loc_1000BC37:				; CODE XREF: sub_1000BB50+12j
		push	offset aInvalidStringP ; "invalid string position"
		call	ds:?_Xout_of_range@std@@YAXPBD@Z ; std::_Xout_of_range(char const *)
		int	3		; Trap to Debugger
sub_1000BB50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000BC43(void *, void *)
sub_1000BC43	proc near		; CODE XREF: sub_10014CF7+6j

var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_3C		= byte ptr -3Ch
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		mov	[esp+50h+var_44], ebx
		push	esi
		mov	esi, ecx
		mov	[esp+54h+var_4C], esi
		push	edi
		mov	edi, [ebp+arg_4]
		test	ebx, ebx
		jnz	short loc_1000BC76
		push	2
		pop	eax
		jmp	loc_1000BE30
; ---------------------------------------------------------------------------

loc_1000BC76:				; CODE XREF: sub_1000BC43+29j
		and	[esp+58h+var_C], 0
		xor	eax, eax
		mov	[esp+58h+var_8], 7
		mov	[esp+58h+var_1C], ax
		test	edi, edi
		jz	short loc_1000BD0B
		mov	ecx, edi
		call	sub_10001AF3
		push	eax		; int
		push	edi		; void *
		lea	ecx, [esp+60h+var_1C] ;	void *
		call	sub_10002356
		push	offset aKey	; "Key"
		lea	ecx, [esp+5Ch+var_3C] ;	void *
		call	sub_10001C7F
		mov	ecx, ebx
		mov	esi, eax
		call	sub_10001AF3
		push	eax
		push	ebx
		push	dword ptr [esi+10h]
		mov	ecx, esi
		push	0
		call	sub_10003F14
		mov	ebx, eax
		lea	ecx, [esp+58h+var_3C]
		push	0
		neg	ebx
		push	1
		sbb	bl, bl
		call	sub_10002311
		inc	bl
		jz	short loc_1000BD03
		sub	esp, 18h
		lea	eax, [esp+70h+var_1C]
		mov	ecx, esp
		push	eax
		call	sub_100038A0
		lea	ecx, [esp+70h+var_1C]
		call	sub_10018091
		add	esp, 18h
		test	al, al
		jnz	short loc_1000BD03
		push	2
		pop	esi
		jmp	loc_1000BE21
; ---------------------------------------------------------------------------

loc_1000BD03:				; CODE XREF: sub_1000BC43+97j
					; sub_1000BC43+B6j
		mov	esi, [esp+58h+var_4C]
		mov	ebx, [esp+58h+var_44]

loc_1000BD0B:				; CODE XREF: sub_1000BC43+49j
		push	ebx		; void *
		lea	ecx, [esp+5Ch+var_3C] ;	void *
		call	sub_10001C7F
		lea	eax, [esp+58h+var_3C]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+5Ch+var_4C]
		push	eax
		call	sub_1000C216
		push	0
		push	1
		lea	ecx, [esp+60h+var_3C]
		call	sub_10002311
		mov	eax, [esp+58h+var_4C]
		cmp	eax, [esi]
		jnz	loc_1000BDD8
		push	ecx
		push	ecx
		lea	ecx, [esp+60h+var_4C]
		call	sub_1000C323
		push	ebx		; void *
		lea	ecx, [esp+5Ch+var_3C] ;	void *
		call	sub_10001C7F
		push	ecx
		push	ecx
		lea	ecx, [esp+60h+var_24]
		call	sub_1000C323
		mov	ecx, [esp+58h+var_24]
		mov	eax, [esp+58h+var_4C]
		mov	edx, [esp+58h+var_20]
		mov	[esp+58h+var_24], eax
		mov	eax, [esp+58h+var_48]
		mov	[esp+58h+var_20], eax
		movzx	eax, byte_10031F23
		push	eax
		lea	eax, [esp+5Ch+var_3C]
		mov	[esp+5Ch+var_4C], ecx
		push	eax
		push	ecx
		lea	eax, [esp+64h+var_44]
		mov	[esp+64h+var_48], edx
		push	eax
		mov	ecx, esi
		call	sub_1000C3AB
		lea	ecx, [esp+58h+var_24]
		call	sub_1000C25D
		push	0
		push	1
		lea	ecx, [esp+60h+var_3C]
		call	sub_10002311
		lea	ecx, [esp+58h+var_4C]
		call	sub_1000C25D
		test	edi, edi
		jz	short loc_1000BE1F
		movzx	eax, byte_10031F23
		push	eax
		lea	eax, [esp+5Ch+var_1C]
		push	eax
		push	ecx
		mov	ecx, [esp+64h+var_44]
		lea	eax, [esp+64h+var_4C]
		push	eax
		lea	ecx, [ecx+28h]
		jmp	short loc_1000BE1A
; ---------------------------------------------------------------------------

loc_1000BDD8:				; CODE XREF: sub_1000BC43+F6j
		test	edi, edi
		jnz	short loc_1000BDFE
		lea	esi, [eax+28h]
		mov	eax, [esi]
		mov	ecx, esi
		push	dword ptr [eax+4]
		call	sub_1000C2E4
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		and	[esi+4], edi
		jmp	short loc_1000BE1F
; ---------------------------------------------------------------------------

loc_1000BDFE:				; CODE XREF: sub_1000BC43+197j
		cmp	dword ptr [eax+2Ch], 0
		jz	short loc_1000BE1F
		movzx	ecx, byte_10031F23
		push	ecx
		lea	ecx, [esp+5Ch+var_1C]
		push	ecx
		push	ecx
		lea	ecx, [esp+64h+var_4C]
		push	ecx
		lea	ecx, [eax+28h]

loc_1000BE1A:				; CODE XREF: sub_1000BC43+193j
		call	sub_1000C44C

loc_1000BE1F:				; CODE XREF: sub_1000BC43+177j
					; sub_1000BC43+1B9j ...
		xor	esi, esi

loc_1000BE21:				; CODE XREF: sub_1000BC43+BBj
		push	0
		push	1
		lea	ecx, [esp+60h+var_1C]
		call	sub_10002311
		mov	eax, esi

loc_1000BE30:				; CODE XREF: sub_1000BC43+2Ej
		mov	ecx, [esp+58h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000BC43	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BE44	proc near		; CODE XREF: sub_1000BEB1+14p

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [ecx]
		push	edi
		push	8
		pop	edi
		mov	eax, [ebx]
		mov	[esp+10h+var_4], eax
		cmp	eax, ebx
		jz	short loc_1000BEAA
		push	ebp
		push	esi

loc_1000BE59:				; CODE XREF: sub_1000BE44+62j
		mov	ecx, [eax+20h]
		mov	ebp, [eax+28h]
		lea	esi, ds:0Eh[ecx*2]
		mov	eax, [ebp+0]
		mov	[esp+18h+var_8], eax
		jmp	short loc_1000BE85
; ---------------------------------------------------------------------------

loc_1000BE6F:				; CODE XREF: sub_1000BE44+43j
		mov	eax, [eax+20h]
		lea	ecx, [esp+18h+var_8]
		lea	esi, [esi+eax*2]
		add	esi, 2
		call	sub_10004B87
		mov	eax, [esp+18h+var_8]

loc_1000BE85:				; CODE XREF: sub_1000BE44+29j
		cmp	eax, ebp
		jnz	short loc_1000BE6F
		mov	eax, esi
		and	eax, 3
		jz	short loc_1000BE95
		sub	esi, eax
		add	esi, 4

loc_1000BE95:				; CODE XREF: sub_1000BE44+4Aj
		lea	ecx, [esp+18h+var_4]
		add	edi, esi
		call	sub_10004B87
		mov	eax, [esp+18h+var_4]
		cmp	eax, ebx
		jnz	short loc_1000BE59
		pop	esi
		pop	ebp

loc_1000BEAA:				; CODE XREF: sub_1000BE44+11j
		mov	eax, edi
		pop	edi
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_1000BE44	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000BEB1	proc near		; CODE XREF: sub_10014EC9+4Cp

NumberOfBytesWritten= dword ptr	-4
arg_0		= dword	ptr  4

		push	ecx
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 0
		jnz	short loc_1000BEC2
		mov	al, 1
		jmp	loc_1000BF70
; ---------------------------------------------------------------------------

loc_1000BEC2:				; CODE XREF: sub_1000BEB1+8j
		push	ebx
		push	ebp
		push	esi
		call	sub_1000BE44
		mov	ebp, eax
		xor	ecx, ecx
		push	4
		shr	eax, 2
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebp		; size_t
		push	esi		; void *
		call	sub_1000BF75
		test	al, al
		jz	short loc_1000BF5D
		mov	ebx, [esp+14h+arg_0]
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	ebp		; dwSize
		mov	ebx, [ebx]
		push	0		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000BF5D
		lea	eax, [esp+14h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	esi		; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000BF4E
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		jnz	short loc_1000BF4E
		mov	ecx, [esp+14h+arg_0]
		push	4		; nSize
		push	offset g_handles_to_close ; lpBuffer
		push	offset aG_handles_to_0 ; "g_handles_to_close"
		mov	g_handles_to_close, edi
		call	sub_10017AD9
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000BF5F
; ---------------------------------------------------------------------------

loc_1000BF4E:				; CODE XREF: sub_1000BEB1+70j
					; sub_1000BEB1+76j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000BF5D:				; CODE XREF: sub_1000BEB1+40j
					; sub_1000BEB1+5Dj
		xor	bl, bl

loc_1000BF5F:				; CODE XREF: sub_1000BEB1+9Bj
		test	esi, esi
		jz	short loc_1000BF6B
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1000BF6B:				; CODE XREF: sub_1000BEB1+B0j
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx

loc_1000BF70:				; CODE XREF: sub_1000BEB1+Cj
		pop	edi
		pop	ecx
		retn	4
sub_1000BEB1	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000BF75(void *, size_t)
sub_1000BF75	proc near		; CODE XREF: sub_1000BEB1+39p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= byte ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+1Ch+arg_0]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+20h+arg_4]
		push	edi		; size_t
		push	0		; int
		push	esi		; void *
		mov	[esp+2Ch+var_8], ebp
		call	memset
		mov	[esi], edi
		lea	ecx, [esi+edi]
		mov	eax, [ebp+4]
		lea	ebx, [esi+8]
		mov	[esi+4], eax
		add	esp, 0Ch
		mov	eax, [ebp+0]
		mov	[esp+20h+var_10], ecx
		mov	esi, [eax]
		mov	[esp+20h+arg_0], esi
		cmp	esi, eax
		jz	loc_1000C07B

loc_1000BFB9:				; CODE XREF: sub_1000BF75+100j
		cmp	ebx, ecx
		jnb	loc_1000C08A
		push	ecx
		push	dword ptr [esi+20h]
		mov	edi, ebx
		lea	ecx, [esi+10h]
		push	dword ptr [esi+20h]
		add	ebx, 0Ch
		mov	[esp+2Ch+var_C], edi
		push	ebx
		call	sub_1000C17D
		mov	eax, [esi+20h]
		lea	ebx, [ebx+eax*2]
		xor	eax, eax
		mov	[ebx], ax
		add	ebx, 2
		mov	eax, ebx
		sub	eax, edi
		mov	[edi+4], eax
		mov	eax, [esi+2Ch]
		mov	[edi+8], eax
		mov	ecx, [esi+28h]
		mov	eax, [ecx]
		mov	[esp+20h+arg_4], eax
		cmp	eax, ecx
		jz	short loc_1000C04F

loc_1000C002:				; CODE XREF: sub_1000BF75+D0j
		lea	ecx, [eax+10h]
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000C00F
		mov	ebp, [ecx]
		jmp	short loc_1000C011
; ---------------------------------------------------------------------------

loc_1000C00F:				; CODE XREF: sub_1000BF75+94j
		mov	ebp, ecx

loc_1000C011:				; CODE XREF: sub_1000BF75+98j
		lea	eax, [esp+20h+var_4]
		push	eax
		call	sub_10003933
		mov	eax, [eax]
		sub	eax, ebp
		sar	eax, 1
		lea	edi, [eax+eax]
		push	edi		; size_t
		push	ebp		; void *
		push	ebx		; void *
		call	ds:memmove
		add	esp, 0Ch
		lea	ecx, [esp+20h+arg_4]
		add	ebx, 2
		add	ebx, edi
		call	sub_10004B87
		mov	eax, [esp+20h+arg_4]
		cmp	eax, [esi+28h]
		jnz	short loc_1000C002
		mov	edi, [esp+20h+var_C]
		mov	ebp, [esp+20h+var_8]

loc_1000C04F:				; CODE XREF: sub_1000BF75+8Bj
		mov	eax, ebx
		and	eax, 3
		jz	short loc_1000C05B
		sub	ebx, eax
		add	ebx, 4

loc_1000C05B:				; CODE XREF: sub_1000BF75+DFj
		mov	eax, ebx
		lea	ecx, [esp+20h+arg_0]
		sub	eax, edi
		mov	[edi], eax
		call	sub_10004B87
		mov	esi, [esp+20h+arg_0]
		mov	ecx, [esp+20h+var_10]
		cmp	esi, [ebp+0]
		jnz	loc_1000BFB9

loc_1000C07B:				; CODE XREF: sub_1000BF75+3Ej
		cmp	ecx, ebx
		sbb	eax, eax
		inc	eax

loc_1000C080:				; CODE XREF: sub_1000BF75+117j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 10h
		retn	8
; ---------------------------------------------------------------------------

loc_1000C08A:				; CODE XREF: sub_1000BF75+46j
		xor	al, al
		jmp	short loc_1000C080
sub_1000BF75	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C08E	proc near		; CODE XREF: sub_1000CA9E+168p

var_C5		= byte ptr -0C5h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_BC		= dword	ptr -0BCh
var_B8		= dword	ptr -0B8h
var_B4		= byte ptr -0B4h

		sub	esp, 0CCh
		and	[esp+0CCh+var_C0], 0
		cmp	dword_10031F54,	0
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	[esp+0DCh+var_BC], edx
		mov	[esp+0DCh+var_B8], ecx
		jnz	short loc_1000C0BD
		mov	edx, offset dword_10031F54
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_10018835

loc_1000C0BD:				; CODE XREF: sub_1000C08E+1Ej
		mov	edi, [esp+0DCh+var_B8]
		xor	esi, esi
		mov	[esp+0DCh+var_C4], 104h

loc_1000C0CB:				; CODE XREF: sub_1000C08E+8Bj
					; sub_1000C08E+93j
		push	[esp+0DCh+var_C4] ; size_t
		call	ds:malloc
		mov	ebx, eax
		pop	ecx
		test	esi, esi
		jz	short loc_1000C0E4
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_1000C0E4:				; CODE XREF: sub_1000C08E+4Cj
		mov	eax, [esp+0DCh+var_C0]
		mov	esi, ebx
		test	al, 1
		jz	short loc_1000C0FE
		and	eax, 0FFFFFFFEh
		lea	ecx, [esp+0DCh+var_B4]
		mov	[esp+0DCh+var_C0], eax
		call	sub_10001BED

loc_1000C0FE:				; CODE XREF: sub_1000C08E+5Ej
		lea	eax, [esp+0DCh+var_C4]
		push	eax
		push	[esp+0E0h+var_C4]
		push	ebx
		push	1
		push	edi
		call	dword_10031F54
		mov	ebp, eax
		cmp	ebp, 0C0000004h
		jz	short loc_1000C0CB
		cmp	ebp, 80000005h
		jz	short loc_1000C0CB
		mov	edi, [esp+0DCh+var_BC]
		test	ebp, ebp
		js	short loc_1000C148
		cmp	dword ptr [ebx+4], 0
		jz	short loc_1000C148
		movzx	eax, word ptr [ebx]
		test	ax, ax
		jz	short loc_1000C148
		shr	eax, 1
		mov	ecx, edi	; void *
		push	eax		; int
		push	dword ptr [ebx+4] ; void *
		call	sub_10002356
		jmp	short loc_1000C159
; ---------------------------------------------------------------------------

loc_1000C148:				; CODE XREF: sub_1000C08E+9Bj
					; sub_1000C08E+A1j ...
		and	dword ptr [edi+10h], 0
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000C154
		mov	edi, [edi]

loc_1000C154:				; CODE XREF: sub_1000C08E+C2j
		xor	eax, eax
		mov	[edi], ax

loc_1000C159:				; CODE XREF: sub_1000C08E+B8j
		test	ebp, ebp
		setns	al
		mov	[esp+0DCh+var_C5], al
		test	ebx, ebx
		jz	short loc_1000C172
		push	ebx		; void *
		call	ds:free
		mov	al, [esp+0E0h+var_C5]
		pop	ecx

loc_1000C172:				; CODE XREF: sub_1000C08E+D6j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0CCh
		retn
sub_1000C08E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C17D	proc near		; CODE XREF: sub_1000BF75+60p
					; sub_1000DA9F+116p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+arg_8]
		cmp	[ecx+10h], esi
		jnb	short loc_1000C18A
		mov	esi, [ecx+10h]

loc_1000C18A:				; CODE XREF: sub_1000C17D+8j
		cmp	dword ptr [ecx+14h], 8
		jb	short loc_1000C192
		mov	ecx, [ecx]

loc_1000C192:				; CODE XREF: sub_1000C17D+11j
		test	esi, esi
		jz	short loc_1000C1A9
		push	esi
		push	ecx
		push	[esp+0Ch+arg_4]
		push	[esp+10h+arg_0]
		call	ds:wmemcpy_s
		add	esp, 10h

loc_1000C1A9:				; CODE XREF: sub_1000C17D+17j
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000C17D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C1AF	proc near		; CODE XREF: sub_10014386+92p
					; sub_10017D8F+FDp
		push	esi
		mov	esi, ecx
		push	30h
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000C1CC
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C1CC:				; CODE XREF: sub_1000C1AF+15j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000C1D7
		mov	[ecx], eax

loc_1000C1D7:				; CODE XREF: sub_1000C1AF+24j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000C1E0
		mov	[ecx], eax

loc_1000C1E0:				; CODE XREF: sub_1000C1AF+2Dj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi], eax
		mov	eax, esi
		pop	esi
		retn
sub_1000C1AF	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C1EC	proc near		; CODE XREF: sub_10014606+152p
					; sub_10017D8F+11Cp ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000C362
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000C1EC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C216	proc near		; CODE XREF: sub_1000BC43+DEp
					; sub_1000CA9E+13Bp

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		push	edi
		push	[ebp+arg_4]
		lea	eax, [ebp+var_4]
		mov	edi, ecx
		push	eax
		call	sub_1000C287
		mov	esi, [ebp+var_4]
		cmp	esi, [edi]
		jz	short loc_1000C246
		lea	eax, [esi+10h]
		push	eax
		push	[ebp+arg_4]
		call	sub_1000C2BB
		test	al, al
		jnz	short loc_1000C246
		mov	[ebp+arg_4], esi
		jmp	short loc_1000C24B
; ---------------------------------------------------------------------------

loc_1000C246:				; CODE XREF: sub_1000C216+19j
					; sub_1000C216+29j
		mov	eax, [edi]
		mov	[ebp+arg_4], eax

loc_1000C24B:				; CODE XREF: sub_1000C216+2Ej
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+arg_4]
		mov	ecx, [ecx]
		pop	edi
		pop	esi
		mov	[eax], ecx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_1000C216	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C25D	proc near		; CODE XREF: sub_1000BC43+15Ap
					; sub_1000BC43+170p ...
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000C2E4
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000C25D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C287	proc near		; CODE XREF: sub_1000C216+Fp
					; sub_1000C863+99p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [ecx]
		mov	esi, [edi+4]
		jmp	short loc_1000C2AA
; ---------------------------------------------------------------------------

loc_1000C290:				; CODE XREF: sub_1000C287+27j
		push	[esp+8+arg_4]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000C2A6
		mov	esi, [esi+8]
		jmp	short loc_1000C2AA
; ---------------------------------------------------------------------------

loc_1000C2A6:				; CODE XREF: sub_1000C287+18j
		mov	edi, esi
		mov	esi, [esi]

loc_1000C2AA:				; CODE XREF: sub_1000C287+7j
					; sub_1000C287+1Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C290
		mov	eax, [esp+8+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		retn	8
sub_1000C287	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C2BB	proc near		; CODE XREF: sub_1000C216+22p
					; sub_1000C287+11p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_4]
		cmp	dword ptr [eax+14h], 8
		mov	ecx, [eax+10h]
		jb	short loc_1000C2CA
		mov	eax, [eax]

loc_1000C2CA:				; CODE XREF: sub_1000C2BB+Bj
		push	ecx
		mov	ecx, [esp+4+arg_0]
		push	eax
		push	dword ptr [ecx+10h]
		push	0
		call	sub_10003F14
		xor	ecx, ecx
		test	eax, eax
		sets	al
		retn	8
sub_1000C2BB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C2E4	proc near		; CODE XREF: sub_1000BC43+1A3p
					; sub_1000C25D+8p ...

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000C31D

loc_1000C2F5:				; CODE XREF: sub_1000C2E4+37j
		push	dword ptr [edi+8]
		mov	ecx, ebx
		call	sub_1000C2E4
		mov	edi, [edi]
		lea	ecx, [esi+10h]
		push	0
		push	1
		call	sub_10002311
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000C2F5

loc_1000C31D:				; CODE XREF: sub_1000C2E4+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000C2E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C323	proc near		; CODE XREF: sub_1000BC43+102p
					; sub_1000BC43+117p ...
		push	esi
		mov	esi, ecx
		push	28h
		and	dword ptr [esi], 0
		and	dword ptr [esi+4], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000C340
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C340:				; CODE XREF: sub_1000C323+15j
		lea	ecx, [eax+4]
		mov	[eax], eax
		test	ecx, ecx
		jz	short loc_1000C34B
		mov	[ecx], eax

loc_1000C34B:				; CODE XREF: sub_1000C323+24j
		lea	ecx, [eax+8]
		test	ecx, ecx
		jz	short loc_1000C354
		mov	[ecx], eax

loc_1000C354:				; CODE XREF: sub_1000C323+2Dj
		mov	word ptr [eax+0Ch], 101h
		mov	[esi], eax
		mov	eax, esi
		pop	esi
		retn	8
sub_1000C323	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C362	proc near		; CODE XREF: sub_1000C1EC+8p
					; sub_1000C362+17p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	edi
		mov	edi, [esp+0Ch+arg_0]
		mov	ebp, ecx
		mov	ebx, edi
		cmp	byte ptr [edi+0Dh], 0
		jnz	short loc_1000C3A5
		push	esi

loc_1000C374:				; CODE XREF: sub_1000C362+40j
		push	dword ptr [ebx+8]
		mov	ecx, ebp
		call	sub_1000C362
		mov	ebx, [ebx]
		lea	ecx, [edi+28h]
		call	sub_1000C25D
		push	0
		push	1
		lea	ecx, [edi+10h]
		call	sub_10002311
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [ebx+0Dh], 0
		mov	edi, ebx
		pop	ecx
		jz	short loc_1000C374
		pop	esi

loc_1000C3A5:				; CODE XREF: sub_1000C362+Fj
		pop	edi
		pop	ebp
		pop	ebx
		retn	4
sub_1000C362	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C3AB	proc near		; CODE XREF: sub_1000BC43+151p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000C3DD
; ---------------------------------------------------------------------------

loc_1000C3C1:				; CODE XREF: sub_1000C3AB+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2BB
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000C3DA
		mov	esi, [esi]
		jmp	short loc_1000C3DD
; ---------------------------------------------------------------------------

loc_1000C3DA:				; CODE XREF: sub_1000C3AB+29j
		mov	esi, [esi+8]

loc_1000C3DD:				; CODE XREF: sub_1000C3AB+14j
					; sub_1000C3AB+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C3C1
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000C41E
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000C413
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	1

loc_1000C3FB:				; CODE XREF: sub_1000C3AB+8Dj
		lea	eax, [ebp+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_1000C4ED
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000C443
; ---------------------------------------------------------------------------

loc_1000C413:				; CODE XREF: sub_1000C3AB+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EEF
		mov	esi, [ebp+var_4]

loc_1000C41E:				; CODE XREF: sub_1000C3AB+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000C43A
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000C3FB
; ---------------------------------------------------------------------------

loc_1000C43A:				; CODE XREF: sub_1000C3AB+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000C443:				; CODE XREF: sub_1000C3AB+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000C3AB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C44C	proc near		; CODE XREF: sub_1000BC43:loc_1000BE1Ap
					; sub_1000DA0A+60p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000C47E
; ---------------------------------------------------------------------------

loc_1000C462:				; CODE XREF: sub_1000C44C+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2BB
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000C47B
		mov	esi, [esi]
		jmp	short loc_1000C47E
; ---------------------------------------------------------------------------

loc_1000C47B:				; CODE XREF: sub_1000C44C+29j
		mov	esi, [esi+8]

loc_1000C47E:				; CODE XREF: sub_1000C44C+14j
					; sub_1000C44C+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000C462
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000C4BF
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000C4B4
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	1

loc_1000C49C:				; CODE XREF: sub_1000C44C+8Dj
		lea	eax, [ebp+arg_8]
		mov	ecx, ebx
		push	eax
		call	sub_1000C60E
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000C4E4
; ---------------------------------------------------------------------------

loc_1000C4B4:				; CODE XREF: sub_1000C44C+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EEF
		mov	esi, [ebp+var_4]

loc_1000C4BF:				; CODE XREF: sub_1000C44C+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000C4DB
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000C49C
; ---------------------------------------------------------------------------

loc_1000C4DB:				; CODE XREF: sub_1000C44C+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000C4E4:				; CODE XREF: sub_1000C44C+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000C44C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C4ED	proc near		; CODE XREF: sub_1000C3AB+56p

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+4], 5555554h
		jb	short loc_1000C509
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C509:				; CODE XREF: sub_1000C4ED+Fj
		push	[ebp+arg_C]
		push	[ebp+arg_10]
		call	sub_1000C73E
		inc	dword ptr [edi+4]
		mov	ebx, eax
		mov	eax, [ebp+arg_8]
		mov	[ebx+4], eax
		mov	ecx, [edi]
		cmp	eax, ecx
		jnz	short loc_1000C533
		mov	[ecx+4], ebx
		mov	eax, [edi]
		mov	[eax], ebx
		mov	eax, [edi]
		mov	[eax+8], ebx
		jmp	short loc_1000C552
; ---------------------------------------------------------------------------

loc_1000C533:				; CODE XREF: sub_1000C4ED+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000C545
		mov	[eax], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx]
		jnz	short loc_1000C552
		mov	[ecx], ebx
		jmp	short loc_1000C552
; ---------------------------------------------------------------------------

loc_1000C545:				; CODE XREF: sub_1000C4ED+4Aj
		mov	[eax+8], ebx
		mov	ecx, [edi]
		cmp	eax, [ecx+8]
		jnz	short loc_1000C552
		mov	[ecx+8], ebx

loc_1000C552:				; CODE XREF: sub_1000C4ED+44j
					; sub_1000C4ED+52j ...
		mov	eax, [ebx+4]
		mov	esi, ebx
		jmp	loc_1000C5EF
; ---------------------------------------------------------------------------

loc_1000C55C:				; CODE XREF: sub_1000C4ED+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000C5A0
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000C5A6
		cmp	esi, [eax+8]
		jnz	short loc_1000C580
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B03

loc_1000C580:				; CODE XREF: sub_1000C4ED+87j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_1000C5EC
; ---------------------------------------------------------------------------

loc_1000C5A0:				; CODE XREF: sub_1000C4ED+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000C5C0

loc_1000C5A6:				; CODE XREF: sub_1000C4ED+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000C5EC
; ---------------------------------------------------------------------------

loc_1000C5C0:				; CODE XREF: sub_1000C4ED+B7j
		cmp	esi, [eax]
		jnz	short loc_1000C5CE
		mov	esi, eax
		mov	ecx, edi
		push	esi
		call	sub_10004B44

loc_1000C5CE:				; CODE XREF: sub_1000C4ED+D5j
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_1000C5EC:				; CODE XREF: sub_1000C4ED+B1j
					; sub_1000C4ED+D1j
		mov	eax, [esi+4]

loc_1000C5EF:				; CODE XREF: sub_1000C4ED+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000C55C
		mov	eax, [edi]
		pop	edi
		pop	esi
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], ebx
		pop	ebx
		pop	ebp
		retn	14h
sub_1000C4ED	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C60E	proc near		; CODE XREF: sub_1000C44C+56p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 6666665h
		jb	short loc_1000C625
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000C625:				; CODE XREF: sub_1000C60E+Aj
		push	esi
		push	edi
		call	sub_1000C7C1
		mov	edi, eax
		lea	ecx, [edi+10h]
		mov	word ptr [edi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000C644
		push	[esp+0Ch+arg_C]
		call	sub_100038A0

loc_1000C644:				; CODE XREF: sub_1000C60E+2Bj
		inc	dword ptr [ebx+4]
		mov	eax, [esp+0Ch+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000C662
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000C682
; ---------------------------------------------------------------------------

loc_1000C662:				; CODE XREF: sub_1000C60E+44j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000C675
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000C682
		mov	[ecx], edi
		jmp	short loc_1000C682
; ---------------------------------------------------------------------------

loc_1000C675:				; CODE XREF: sub_1000C60E+59j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000C682
		mov	[ecx+8], edi

loc_1000C682:				; CODE XREF: sub_1000C60E+52j
					; sub_1000C60E+61j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000C71F
; ---------------------------------------------------------------------------

loc_1000C68C:				; CODE XREF: sub_1000C60E+115j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000C6D0
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000C6D6
		cmp	esi, [eax+8]
		jnz	short loc_1000C6B0
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_1000C6B0:				; CODE XREF: sub_1000C60E+96j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_1000C71C
; ---------------------------------------------------------------------------

loc_1000C6D0:				; CODE XREF: sub_1000C60E+88j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000C6F0

loc_1000C6D6:				; CODE XREF: sub_1000C60E+91j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000C71C
; ---------------------------------------------------------------------------

loc_1000C6F0:				; CODE XREF: sub_1000C60E+C6j
		cmp	esi, [eax]
		jnz	short loc_1000C6FE
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_1000C6FE:				; CODE XREF: sub_1000C60E+E4j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_1000C71C:				; CODE XREF: sub_1000C60E+C0j
					; sub_1000C60E+E0j
		mov	eax, [esi+4]

loc_1000C71F:				; CODE XREF: sub_1000C60E+79j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000C68C
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+0Ch+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	14h
sub_1000C60E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C73E	proc near		; CODE XREF: sub_1000C4ED+22p

arg_4		= dword	ptr  8

		push	ebx
		push	esi
		call	sub_1000C78B
		mov	ebx, eax
		lea	esi, [ebx+10h]
		mov	word ptr [ebx+0Ch], 0
		test	esi, esi
		jz	short loc_1000C784
		push	edi
		mov	edi, [esp+0Ch+arg_4]
		mov	ecx, esi
		push	edi
		call	sub_100038A0
		push	ecx
		push	ecx
		lea	ecx, [esi+18h]
		call	sub_1000C323
		mov	eax, [edi+18h]
		mov	ecx, [esi+18h]
		mov	[esi+18h], eax
		mov	[edi+18h], ecx
		mov	eax, [edi+1Ch]
		mov	ecx, [esi+1Ch]
		mov	[esi+1Ch], eax
		mov	[edi+1Ch], ecx
		pop	edi

loc_1000C784:				; CODE XREF: sub_1000C73E+14j
		pop	esi
		mov	eax, ebx
		pop	ebx
		retn	8
sub_1000C73E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C78B	proc near		; CODE XREF: sub_1000C73E+2p
					; sub_1000C863+C5p
		push	esi
		push	30h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_1000C7A3
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C7A3:				; CODE XREF: sub_1000C78B+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000C7B2
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7B2:				; CODE XREF: sub_1000C78B+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000C7BD
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7BD:				; CODE XREF: sub_1000C78B+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_1000C78B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C7C1	proc near		; CODE XREF: sub_1000C60E+19p
					; sub_1000CF97+19p
		push	esi
		push	28h
		mov	esi, ecx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edx, eax
		pop	ecx
		test	edx, edx
		jnz	short loc_1000C7D9
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000C7D9:				; CODE XREF: sub_1000C7C1+10j
		mov	eax, [esi]
		lea	ecx, [edx+4]
		mov	[edx], eax
		test	ecx, ecx
		jz	short loc_1000C7E8
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7E8:				; CODE XREF: sub_1000C7C1+21j
		lea	ecx, [edx+8]
		test	ecx, ecx
		jz	short loc_1000C7F3
		mov	eax, [esi]
		mov	[ecx], eax

loc_1000C7F3:				; CODE XREF: sub_1000C7C1+2Cj
		mov	eax, edx
		pop	esi
		retn
sub_1000C7C1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000C7F7	proc near		; CODE XREF: sub_1000CA9E+A6p
					; sub_1000CA9E+DCp

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002DDB8
		call	__SEH_prolog4
		mov	edi, edx
		mov	ebx, ecx
		mov	esi, dword_10031F58
		test	esi, esi
		jnz	short loc_1000C826
		mov	edx, offset dword_10031F58
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_10018835
		mov	esi, dword_10031F58

loc_1000C826:				; CODE XREF: sub_1000C7F7+18j
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+arg_0]
		push	eax
		push	dword ptr [eax]
		push	edi
		push	2
		push	ebx
		call	esi ; dword_10031F58
		jmp	short loc_1000C853
; ---------------------------------------------------------------------------

loc_1000C838:				; DATA XREF: .rdata:stru_1002DDB8o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 1000C7F7
		mov	eax, [eax]
		xor	ecx, ecx
		cmp	dword ptr [eax], 0C0000008h
		setz	cl
		mov	eax, ecx
		retn
; ---------------------------------------------------------------------------

loc_1000C84B:				; DATA XREF: .rdata:stru_1002DDB8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000C7F7
		mov	eax, 0C0000008h

loc_1000C853:				; CODE XREF: sub_1000C7F7+3Fj
		mov	[ebp+var_1C], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	__SEH_epilog4
		retn
sub_1000C7F7	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000C863	proc near		; CODE XREF: sub_10017D8F+106p

var_10C		= dword	ptr -10Ch
var_108		= dword	ptr -108h
var_104		= dword	ptr -104h
var_100		= dword	ptr -100h
var_FC		= dword	ptr -0FCh
var_F8		= dword	ptr -0F8h
var_F4		= dword	ptr -0F4h
var_F0		= byte ptr -0F0h
var_EC		= byte ptr -0ECh
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 10Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10Ch+var_8], eax
		mov	eax, g_handles_to_close
		push	ebx
		push	ebp
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		mov	[esp+118h+var_10C], esi
		mov	[esp+118h+var_100], ebx
		push	edi
		test	eax, eax
		jnz	short loc_1000C8B5
		push	3
		push	2Eh
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+128h+var_EC]
		inc	ebx
		call	sub_10001B48
		mov	edx, offset aCheckFailedG_h ; "Check failed: g_handles_to_close	!= NUL"...
		lea	ecx, [eax+8]
		call	sub_10002847
		mov	eax, g_handles_to_close

loc_1000C8B5:				; CODE XREF: sub_1000C863+2Bj
		test	bl, 1
		jz	short loc_1000C8CB
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFEh
		call	sub_10001BED
		mov	eax, g_handles_to_close

loc_1000C8CB:				; CODE XREF: sub_1000C863+55j
		xor	ebp, ebp
		lea	edi, [eax+8]
		mov	[esp+11Ch+var_108], ebp
		cmp	[eax+4], ebp
		jbe	loc_1000CA70

loc_1000C8DD:				; CODE XREF: sub_1000C863+207j
		lea	eax, [edi+0Ch]
		push	eax		; void *
		lea	ecx, [esp+120h+var_38] ; void *
		call	sub_10001C7F
		lea	eax, [esp+11Ch+var_38]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+120h+var_104]
		push	eax
		call	sub_1000C287
		mov	eax, [esp+11Ch+var_10C]
		mov	esi, [esp+11Ch+var_104]
		cmp	esi, [eax]
		jz	short loc_1000C926
		lea	eax, [esi+10h]
		push	eax
		lea	eax, [esp+120h+var_38]
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000C975
		mov	eax, [esp+11Ch+var_10C]

loc_1000C926:				; CODE XREF: sub_1000C863+A8j
		mov	ecx, eax
		call	sub_1000C78B
		mov	ebp, eax
		lea	eax, [ebp+10h]
		mov	word ptr [ebp+0Ch], 0
		test	eax, eax
		jz	short loc_1000C958
		lea	ecx, [esp+11Ch+var_38]
		push	ecx
		mov	ecx, eax
		call	sub_100038A0
		push	ecx
		push	ecx
		lea	ecx, [ebp+28h]
		call	sub_1000C323
		lea	eax, [ebp+10h]

loc_1000C958:				; CODE XREF: sub_1000C863+D7j
		mov	ecx, [esp+11Ch+var_10C]
		push	ebp
		push	eax
		push	esi
		lea	eax, [esp+128h+var_F8]
		push	eax
		call	sub_1000CE35
		mov	esi, [esp+11Ch+var_F8]
		mov	ebp, [esp+11Ch+var_108]
		mov	[esp+11Ch+var_104], esi

loc_1000C975:				; CODE XREF: sub_1000C863+BDj
		push	0
		lea	eax, [esi+28h]
		push	1
		lea	ecx, [esp+124h+var_38]
		mov	[esp+124h+var_100], eax
		call	sub_10002311
		mov	esi, [edi+4]
		and	[esp+11Ch+var_FC], 0
		add	esi, edi
		cmp	dword ptr [edi+8], 0
		jbe	loc_1000CA35
		mov	ebp, [esp+11Ch+var_FC]

loc_1000C9A4:				; CODE XREF: sub_1000C863+1C8j
		push	esi		; void *
		lea	ecx, [esp+120h+var_20] ; void *
		call	sub_10001C7F
		movzx	eax, byte_10031F34
		push	eax		; int
		lea	eax, [esp+120h+var_20]
		push	eax		; void *
		push	ecx		; int
		mov	ecx, [esp+128h+var_100]
		lea	eax, [esp+128h+var_F4]
		push	eax		; int
		call	sub_1000CD94
		push	0
		push	1
		lea	ecx, [esp+124h+var_20]
		call	sub_10002311
		cmp	[esp+11Ch+var_F0], 0
		jnz	short loc_1000CA09
		push	3
		push	3Ch
		push	offset aCBuildsMoz2__3 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+128h+var_EC]
		or	ebx, 2
		call	sub_10001B48
		mov	edx, offset aCheckFailedNam ; "Check failed: name.second. "
		lea	ecx, [eax+8]
		call	sub_10002847

loc_1000CA09:				; CODE XREF: sub_1000C863+182j
		test	bl, 2
		jz	short loc_1000CA1A
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFDh
		call	sub_10001BED

loc_1000CA1A:				; CODE XREF: sub_1000C863+1A9j
		mov	eax, [esp+11Ch+var_F4]
		mov	eax, [eax+20h]
		lea	esi, [esi+eax*2]
		add	esi, 2
		inc	ebp
		cmp	ebp, [edi+8]
		jb	loc_1000C9A4
		mov	ebp, [esp+11Ch+var_108]

loc_1000CA35:				; CODE XREF: sub_1000C863+137j
		add	edi, [edi]
		test	bl, 4
		jz	short loc_1000CA48
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFFBh
		call	sub_10001BED

loc_1000CA48:				; CODE XREF: sub_1000C863+1D7j
		test	bl, 8
		jz	short loc_1000CA59
		lea	ecx, [esp+11Ch+var_EC]
		and	ebx, 0FFFFFFF7h
		call	sub_10001BED

loc_1000CA59:				; CODE XREF: sub_1000C863+1E8j
		mov	eax, g_handles_to_close
		inc	ebp
		mov	esi, [esp+11Ch+var_10C]
		mov	[esp+11Ch+var_108], ebp
		cmp	ebp, [eax+4]
		jb	loc_1000C8DD

loc_1000CA70:				; CODE XREF: sub_1000C863+74j
		push	8000h		; dwFreeType
		push	0		; dwSize
		push	eax		; lpAddress
		call	ds:VirtualFree
		mov	ecx, [esp+11Ch+var_8]
		and	g_handles_to_close, 0
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10Ch
		retn
sub_1000C863	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CA9E	proc near		; CODE XREF: sub_10017D8F+10Fp

pdwHandleCount	= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= word ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 5Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+5Ch+var_8], eax
		or	[esp+5Ch+pdwHandleCount], 0FFFFFFFFh
		lea	eax, [esp+5Ch+pdwHandleCount]
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	eax		; pdwHandleCount
		mov	[esp+70h+var_4C], ecx
		call	ds:GetCurrentProcess
		push	eax		; hProcess
		call	ds:GetProcessHandleCount
		test	eax, eax
		jnz	short loc_1000CAD6
		xor	al, al
		jmp	loc_1000CC65
; ---------------------------------------------------------------------------

loc_1000CAD6:				; CODE XREF: sub_1000CA9E+2Fj
		mov	ebx, 0A0h
		push	ebx
		call	sub_10001ACB
		mov	esi, eax
		push	ebx		; size_t
		push	0		; int
		push	esi		; void *
		lea	edi, [esi+0A0h]
		mov	[esp+78h+var_48], esi
		mov	[esp+78h+var_40], edi
		call	memset
		and	[esp+78h+var_28], 0
		xor	eax, eax
		xor	ebp, ebp
		mov	[esp+78h+var_44], edi
		add	esp, 0Ch
		mov	[esp+6Ch+var_24], 7
		xor	ebx, ebx
		mov	[esp+6Ch+var_38], ax
		mov	[esp+6Ch+var_50], ebp
		cmp	[esp+6Ch+pdwHandleCount], eax
		jz	loc_1000CC48

loc_1000CB27:				; CODE XREF: sub_1000CA9E+1A4j
		cmp	ebp, 64h
		jge	loc_1000CC48
		mov	eax, edi
		add	ebx, 4
		sub	eax, esi
		mov	edx, esi
		mov	[esp+6Ch+var_54], eax
		mov	ecx, ebx
		lea	eax, [esp+6Ch+var_54]
		push	eax
		call	sub_1000C7F7
		pop	ecx
		mov	ecx, eax

loc_1000CB4C:				; CODE XREF: sub_1000CA9E+EAj
					; sub_1000CA9E+F4j ...
		cmp	ecx, 0C0000004h
		jz	short loc_1000CB5C
		cmp	ecx, 80000005h
		jnz	short loc_1000CB9B

loc_1000CB5C:				; CODE XREF: sub_1000CA9E+B4j
		mov	eax, [esp+6Ch+var_54]
		lea	ecx, [esp+6Ch+var_48]
		add	eax, 2
		push	eax
		call	sub_1000CCBD
		mov	esi, [esp+6Ch+var_48]
		lea	eax, [esp+6Ch+var_54]
		push	eax
		mov	edx, esi
		mov	ecx, ebx
		call	sub_1000C7F7
		mov	edi, [esp+70h+var_44]
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		js	short loc_1000CB4C
		mov	eax, edi
		sub	eax, esi
		cmp	[esp+6Ch+var_54], eax
		jnz	short loc_1000CB4C
		mov	ecx, 0C0000004h
		jmp	short loc_1000CB4C
; ---------------------------------------------------------------------------

loc_1000CB9B:				; CODE XREF: sub_1000CA9E+BCj
		test	ecx, ecx
		js	loc_1000CC78
		cmp	dword ptr [esi+4], 0
		jz	loc_1000CC78
		dec	[esp+6Ch+pdwHandleCount]
		xor	edx, edx
		movzx	ecx, word ptr [esi]
		mov	eax, [esi+4]
		shr	ecx, 1
		mov	[eax+ecx*2], dx
		lea	ecx, [esp+6Ch+var_20] ;	void *
		push	dword ptr [esi+4] ; void *
		call	sub_10001C7F
		mov	ecx, [esp+6Ch+var_4C]
		lea	eax, [esp+6Ch+var_20]
		push	eax
		lea	eax, [esp+70h+var_3C]
		push	eax
		call	sub_1000C216
		push	0
		push	1
		lea	ecx, [esp+74h+var_20]
		call	sub_10002311
		mov	ecx, [esp+6Ch+var_4C]
		mov	eax, [esp+6Ch+var_3C]
		cmp	eax, [ecx]
		jz	short loc_1000CC3D
		lea	ebp, [eax+28h]
		cmp	dword ptr [ebp+4], 0
		jz	short loc_1000CC1F
		lea	edx, [esp+6Ch+var_38]
		mov	ecx, ebx
		call	sub_1000C08E
		test	al, al
		jz	short loc_1000CC39
		lea	eax, [esp+6Ch+var_38]
		mov	ecx, ebp
		push	eax
		call	sub_1000CC83
		test	eax, eax
		jz	short loc_1000CC39

loc_1000CC1F:				; CODE XREF: sub_1000CA9E+160j
		push	0		; dwFlags
		push	2		; dwMask
		push	ebx		; hObject
		call	ds:SetHandleInformation
		test	eax, eax
		jz	short loc_1000CC7F
		push	ebx		; hObject
		call	ds:CloseHandle
		test	eax, eax
		jz	short loc_1000CC7F

loc_1000CC39:				; CODE XREF: sub_1000CA9E+16Fj
					; sub_1000CA9E+17Fj
		mov	ebp, [esp+6Ch+var_50]

loc_1000CC3D:				; CODE XREF: sub_1000CA9E+157j
					; sub_1000CA9E+1DFj
		cmp	[esp+6Ch+pdwHandleCount], 0
		jnz	loc_1000CB27

loc_1000CC48:				; CODE XREF: sub_1000CA9E+83j
					; sub_1000CA9E+8Cj
		mov	bl, 1

loc_1000CC4A:				; CODE XREF: sub_1000CA9E+1E3j
		push	0
		push	1
		lea	ecx, [esp+74h+var_38]
		call	sub_10002311
		test	esi, esi
		jz	short loc_1000CC63
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000CC63:				; CODE XREF: sub_1000CA9E+1BBj
		mov	al, bl

loc_1000CC65:				; CODE XREF: sub_1000CA9E+33j
		mov	ecx, [esp+6Ch+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 5Ch
		retn
; ---------------------------------------------------------------------------

loc_1000CC78:				; CODE XREF: sub_1000CA9E+FFj
					; sub_1000CA9E+109j
		inc	ebp
		mov	[esp+6Ch+var_50], ebp
		jmp	short loc_1000CC3D
; ---------------------------------------------------------------------------

loc_1000CC7F:				; CODE XREF: sub_1000CA9E+18Ej
					; sub_1000CA9E+199j
		xor	bl, bl
		jmp	short loc_1000CC4A
sub_1000CA9E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000CC83	proc near		; CODE XREF: sub_1000CA9E+178p
					; sub_1000DA0A+34p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		push	[ebp+arg_0]
		lea	eax, [ebp+var_8]
		push	eax
		call	sub_1000CD00
		mov	eax, [ebp+var_8]
		xor	edi, edi
		mov	esi, [ebp+var_4]
		mov	[ebp+arg_0], eax
		cmp	eax, esi
		jz	short loc_1000CCB3

loc_1000CCA5:				; CODE XREF: sub_1000CC83+2Ej
		lea	ecx, [ebp+arg_0]
		inc	edi
		call	sub_10004B87
		cmp	[ebp+arg_0], esi
		jnz	short loc_1000CCA5

loc_1000CCB3:				; CODE XREF: sub_1000CC83+20j
		mov	eax, edi
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000CC83	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CCBD	proc near		; CODE XREF: sub_1000CA9E+CAp

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	ecx, [esi+4]
		mov	eax, [esi]
		sub	ecx, eax
		cmp	ecx, edi
		ja	short loc_1000CCF6
		jnb	short loc_1000CCFB
		sub	eax, [esi+4]
		mov	ecx, esi
		add	eax, edi
		push	eax
		call	sub_1000316B
		mov	eax, [esi]
		sub	eax, [esi+4]
		add	eax, edi
		push	eax		; size_t
		push	0		; int
		push	dword ptr [esi+4] ; void *
		call	memset
		mov	eax, [esi]
		add	esp, 0Ch

loc_1000CCF6:				; CODE XREF: sub_1000CCBD+11j
		add	eax, edi
		mov	[esi+4], eax

loc_1000CCFB:				; CODE XREF: sub_1000CCBD+13j
		pop	edi
		pop	esi
		retn	4
sub_1000CCBD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CD00	proc near		; CODE XREF: sub_1000CC83+Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		mov	eax, ecx
		push	ebx
		push	esi
		push	edi
		mov	ebx, [eax]
		mov	edi, ebx
		mov	[esp+10h+var_4], eax
		mov	esi, [ebx+4]
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000CD53
		push	ebp

loc_1000CD18:				; CODE XREF: sub_1000CD00+4Cj
		push	[esp+14h+arg_4]
		lea	ebp, [esi+10h]
		push	ebp
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CD2E
		mov	esi, [esi+8]
		jmp	short loc_1000CD48
; ---------------------------------------------------------------------------

loc_1000CD2E:				; CODE XREF: sub_1000CD00+27j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000CD44
		push	ebp
		push	[esp+18h+arg_4]
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CD44
		mov	edi, esi

loc_1000CD44:				; CODE XREF: sub_1000CD00+32j
					; sub_1000CD00+40j
		mov	ebx, esi
		mov	esi, [esi]

loc_1000CD48:				; CODE XREF: sub_1000CD00+2Cj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CD18
		mov	eax, [esp+14h+var_4]
		pop	ebp

loc_1000CD53:				; CODE XREF: sub_1000CD00+15j
		cmp	byte ptr [edi+0Dh], 0
		jz	short loc_1000CD60
		mov	eax, [eax]
		mov	esi, [eax+4]
		jmp	short loc_1000CD7E
; ---------------------------------------------------------------------------

loc_1000CD60:				; CODE XREF: sub_1000CD00+57j
		mov	esi, [edi]
		jmp	short loc_1000CD7E
; ---------------------------------------------------------------------------

loc_1000CD64:				; CODE XREF: sub_1000CD00+82j
		lea	eax, [esi+10h]
		push	eax
		push	[esp+14h+arg_4]
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CD7B
		mov	edi, esi
		mov	esi, [esi]
		jmp	short loc_1000CD7E
; ---------------------------------------------------------------------------

loc_1000CD7B:				; CODE XREF: sub_1000CD00+73j
		mov	esi, [esi+8]

loc_1000CD7E:				; CODE XREF: sub_1000CD00+5Ej
					; sub_1000CD00+62j ...
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CD64
		mov	eax, [esp+10h+arg_0]
		mov	[eax+4], edi
		pop	edi
		pop	esi
		mov	[eax], ebx
		pop	ebx
		pop	ecx
		retn	8
sub_1000CD00	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000CD94(int, int, void *, int)
sub_1000CD94	proc near		; CODE XREF: sub_1000C863+168p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000CDC6
; ---------------------------------------------------------------------------

loc_1000CDAA:				; CODE XREF: sub_1000CD94+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2BB
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000CDC3
		mov	esi, [esi]
		jmp	short loc_1000CDC6
; ---------------------------------------------------------------------------

loc_1000CDC3:				; CODE XREF: sub_1000CD94+29j
		mov	esi, [esi+8]

loc_1000CDC6:				; CODE XREF: sub_1000CD94+14j
					; sub_1000CD94+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000CDAA
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000CE07
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000CDFC
		push	[ebp+arg_C]	; int
		push	[ebp+arg_8]	; void *
		push	edi		; int
		push	1		; int

loc_1000CDE4:				; CODE XREF: sub_1000CD94+8Dj
		lea	eax, [ebp+arg_8]
		mov	ecx, ebx
		push	eax		; int
		call	sub_1000CF97
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000CE2C
; ---------------------------------------------------------------------------

loc_1000CDFC:				; CODE XREF: sub_1000CD94+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EEF
		mov	esi, [ebp+var_4]

loc_1000CE07:				; CODE XREF: sub_1000CD94+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CE23
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000CDE4
; ---------------------------------------------------------------------------

loc_1000CE23:				; CODE XREF: sub_1000CD94+81j
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000CE2C:				; CODE XREF: sub_1000CD94+66j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000CD94	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000CE35	proc near		; CODE XREF: sub_1000C863+101p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+14h+var_C], ebp
		cmp	[edi+4], ebp
		jnz	short loc_1000CE62
		push	[esp+14h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+24h+arg_0]
		call	sub_1000D0EE
		mov	eax, [esp+14h+arg_0]
		jmp	loc_1000CF8F
; ---------------------------------------------------------------------------

loc_1000CE62:				; CODE XREF: sub_1000CE35+10j
		mov	ecx, [edi]
		mov	eax, [esp+14h+arg_4]
		push	ebx
		mov	ebx, [esp+18h+arg_8]
		push	esi
		cmp	eax, [ecx]
		jnz	short loc_1000CE94
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2BB
		test	al, al
		jz	loc_1000CF73
		push	[esp+1Ch+arg_C]
		push	ecx
		push	[esp+24h+arg_4]
		mov	ecx, edi
		jmp	loc_1000CF62
; ---------------------------------------------------------------------------

loc_1000CE94:				; CODE XREF: sub_1000CE35+3Bj
		cmp	eax, ecx
		jnz	short loc_1000CEBF
		mov	eax, [ecx+8]
		add	eax, 10h
		push	ebx
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	loc_1000CF73
		push	[esp+1Ch+arg_C]
		mov	eax, [edi]
		push	ecx
		mov	ecx, edi
		push	dword ptr [eax+8]
		push	ebp
		jmp	loc_1000CF64
; ---------------------------------------------------------------------------

loc_1000CEBF:				; CODE XREF: sub_1000CE35+61j
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CF0B
		mov	eax, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], eax
		call	sub_10004EEF
		push	ebx
		mov	eax, [eax]
		add	eax, 10h
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CF0B
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000CF05
		push	eax
		jmp	short loc_1000CF5B
; ---------------------------------------------------------------------------

loc_1000CF05:				; CODE XREF: sub_1000CE35+CBj
		push	[esp+24h+arg_4]
		jmp	short loc_1000CF62
; ---------------------------------------------------------------------------

loc_1000CF0B:				; CODE XREF: sub_1000CE35+96j
					; sub_1000CE35+B7j
		mov	eax, [esp+1Ch+arg_4]
		push	ebx
		add	eax, 10h
		push	eax
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CF73
		mov	esi, [esp+1Ch+arg_4]
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B87
		mov	eax, [eax]
		cmp	eax, [edi]
		jz	short loc_1000CF4A
		mov	eax, [esp+1Ch+var_C]
		add	eax, 10h
		push	eax
		push	ebx
		call	sub_1000C2BB
		test	al, al
		jz	short loc_1000CF73
		mov	esi, [esp+1Ch+arg_4]

loc_1000CF4A:				; CODE XREF: sub_1000CE35+FDj
		mov	eax, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [eax+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000CF5E
		push	esi

loc_1000CF5B:				; CODE XREF: sub_1000CE35+CEj
		push	ebp
		jmp	short loc_1000CF64
; ---------------------------------------------------------------------------

loc_1000CF5E:				; CODE XREF: sub_1000CE35+123j
		push	[esp+24h+var_C]

loc_1000CF62:				; CODE XREF: sub_1000CE35+5Aj
					; sub_1000CE35+D4j
		push	1

loc_1000CF64:				; CODE XREF: sub_1000CE35+85j
					; sub_1000CE35+127j
		push	[esp+2Ch+arg_0]
		call	sub_1000D0EE
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_1000CF8D
; ---------------------------------------------------------------------------

loc_1000CF73:				; CODE XREF: sub_1000CE35+49j
					; sub_1000CE35+72j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_1000D20F
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_1000CF8D:				; CODE XREF: sub_1000CE35+13Cj
		pop	esi
		pop	ebx

loc_1000CF8F:				; CODE XREF: sub_1000CE35+28j
		pop	edi
		pop	ebp
		add	esp, 0Ch
		retn	10h
sub_1000CE35	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000CF97(int, int, int, void *, int)
sub_1000CF97	proc near		; CODE XREF: sub_1000CD94+56p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		mov	ebx, ecx
		cmp	dword ptr [ebx+4], 6666665h
		jb	short loc_1000CFAE
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000CFAE:				; CODE XREF: sub_1000CF97+Aj
		push	esi
		push	edi
		call	sub_1000C7C1
		mov	edi, eax
		lea	ecx, [edi+10h]
		mov	word ptr [edi+0Ch], 0
		test	ecx, ecx
		jz	short loc_1000CFCD
		push	[esp+0Ch+arg_C]	; void *
		call	sub_10003481

loc_1000CFCD:				; CODE XREF: sub_1000CF97+2Bj
		inc	dword ptr [ebx+4]
		mov	eax, [esp+0Ch+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000CFEB
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000D00B
; ---------------------------------------------------------------------------

loc_1000CFEB:				; CODE XREF: sub_1000CF97+44j
		cmp	byte ptr [esp+0Ch+arg_4], 0
		jz	short loc_1000CFFE
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000D00B
		mov	[ecx], edi
		jmp	short loc_1000D00B
; ---------------------------------------------------------------------------

loc_1000CFFE:				; CODE XREF: sub_1000CF97+59j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000D00B
		mov	[ecx+8], edi

loc_1000D00B:				; CODE XREF: sub_1000CF97+52j
					; sub_1000CF97+61j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000D0A8
; ---------------------------------------------------------------------------

loc_1000D015:				; CODE XREF: sub_1000CF97+115j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000D059
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000D05F
		cmp	esi, [eax+8]
		jnz	short loc_1000D039
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_1000D039:				; CODE XREF: sub_1000CF97+96j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_1000D0A5
; ---------------------------------------------------------------------------

loc_1000D059:				; CODE XREF: sub_1000CF97+88j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D079

loc_1000D05F:				; CODE XREF: sub_1000CF97+91j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000D0A5
; ---------------------------------------------------------------------------

loc_1000D079:				; CODE XREF: sub_1000CF97+C6j
		cmp	esi, [eax]
		jnz	short loc_1000D087
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_1000D087:				; CODE XREF: sub_1000CF97+E4j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_1000D0A5:				; CODE XREF: sub_1000CF97+C0j
					; sub_1000CF97+E0j
		mov	eax, [esi+4]

loc_1000D0A8:				; CODE XREF: sub_1000CF97+79j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000D015
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esp+0Ch+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		retn	14h
sub_1000CF97	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D0C7	proc near		; CODE XREF: sub_1000D0EE+15p
					; sub_1000D20F:loc_1000D29Ap

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		lea	ecx, [edi+28h]
		call	sub_1000C25D
		push	0
		push	1
		lea	ecx, [edi+10h]
		call	sub_10002311
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		pop	esi
		retn	4
sub_1000D0C7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D0EE	proc near		; CODE XREF: sub_1000CE35+1Fp
					; sub_1000CE35+133p ...

arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 5555554h
		jb	short loc_1000D113
		push	[ebp+arg_10]
		call	sub_1000D0C7
		push	offset aMapSetTTooLong ; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000D113:				; CODE XREF: sub_1000D0EE+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000D134
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000D153
; ---------------------------------------------------------------------------

loc_1000D134:				; CODE XREF: sub_1000D0EE+36j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000D146
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000D153
		mov	[ecx], edi
		jmp	short loc_1000D153
; ---------------------------------------------------------------------------

loc_1000D146:				; CODE XREF: sub_1000D0EE+4Aj
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000D153
		mov	[ecx+8], edi

loc_1000D153:				; CODE XREF: sub_1000D0EE+44j
					; sub_1000D0EE+52j ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_1000D1F0
; ---------------------------------------------------------------------------

loc_1000D15D:				; CODE XREF: sub_1000D0EE+106j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_1000D1A1
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1000D1A7
		cmp	esi, [eax+8]
		jnz	short loc_1000D181
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_1000D181:				; CODE XREF: sub_1000D0EE+87j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_1000D1ED
; ---------------------------------------------------------------------------

loc_1000D1A1:				; CODE XREF: sub_1000D0EE+79j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_1000D1C1

loc_1000D1A7:				; CODE XREF: sub_1000D0EE+82j
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_1000D1ED
; ---------------------------------------------------------------------------

loc_1000D1C1:				; CODE XREF: sub_1000D0EE+B7j
		cmp	esi, [eax]
		jnz	short loc_1000D1CF
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_1000D1CF:				; CODE XREF: sub_1000D0EE+D5j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_1000D1ED:				; CODE XREF: sub_1000D0EE+B1j
					; sub_1000D0EE+D1j
		mov	eax, [esi+4]

loc_1000D1F0:				; CODE XREF: sub_1000D0EE+6Aj
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_1000D15D
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000D0EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D20F	proc near		; CODE XREF: sub_1000CE35+14Bp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	ebx
		mov	ebx, ecx
		mov	al, 1
		push	esi
		push	edi
		mov	byte ptr [ebp+var_8], al
		mov	edi, [ebx]
		mov	esi, [edi+4]
		jmp	short loc_1000D241
; ---------------------------------------------------------------------------

loc_1000D225:				; CODE XREF: sub_1000D20F+36j
		lea	eax, [esi+10h]
		mov	edi, esi
		push	eax
		push	[ebp+arg_8]
		call	sub_1000C2BB
		mov	byte ptr [ebp+var_8], al
		test	al, al
		jz	short loc_1000D23E
		mov	esi, [esi]
		jmp	short loc_1000D241
; ---------------------------------------------------------------------------

loc_1000D23E:				; CODE XREF: sub_1000D20F+29j
		mov	esi, [esi+8]

loc_1000D241:				; CODE XREF: sub_1000D20F+14j
					; sub_1000D20F+2Dj
		cmp	byte ptr [esi+0Dh], 0
		jz	short loc_1000D225
		mov	esi, edi
		mov	[ebp+var_4], esi
		test	al, al
		jz	short loc_1000D280
		mov	eax, [ebx]
		cmp	edi, [eax]
		jnz	short loc_1000D275
		push	[ebp+arg_C]
		push	ecx
		push	edi
		push	1

loc_1000D25D:				; CODE XREF: sub_1000D20F+89j
		lea	eax, [ebp+arg_C]
		mov	ecx, ebx
		push	eax
		call	sub_1000D0EE
		mov	ecx, [eax]
		mov	eax, [ebp+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_1000D2A8
; ---------------------------------------------------------------------------

loc_1000D275:				; CODE XREF: sub_1000D20F+45j
		lea	ecx, [ebp+var_4]
		call	sub_10004EEF
		mov	esi, [ebp+var_4]

loc_1000D280:				; CODE XREF: sub_1000D20F+3Fj
		push	[ebp+arg_8]
		lea	eax, [esi+10h]
		push	eax
		call	sub_1000C2BB
		push	[ebp+arg_C]
		test	al, al
		jz	short loc_1000D29A
		push	ecx
		push	edi
		push	[ebp+var_8]
		jmp	short loc_1000D25D
; ---------------------------------------------------------------------------

loc_1000D29A:				; CODE XREF: sub_1000D20F+82j
		call	sub_1000D0C7
		mov	eax, [ebp+arg_0]
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_1000D2A8:				; CODE XREF: sub_1000D20F+64j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000D20F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D2B1	proc near		; DATA XREF: .rdata:1002C01Co

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C014
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_1000D2CE
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D2CE:				; CODE XREF: sub_1000D2B1+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000D2B1	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D2D4	proc near		; DATA XREF: .rdata:1002C018o

arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 12h
		setz	al
		retn	8
sub_1000D2D4	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D2DF(int, HANDLE hSourceHandle,	int, int, int)
sub_1000D2DF	proc near		; DATA XREF: .rdata:1002C010o

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
TargetHandle	= dword	ptr -0BCh
var_B8		= word ptr -0B8h
var_B4		= dword	ptr -0B4h
var_B0		= dword	ptr -0B0h
var_AC		= dword	ptr -0ACh
var_A8		= dword	ptr -0A8h
var_A4		= word ptr -0A4h
var_A0		= dword	ptr -0A0h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
hSourceHandle	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 0C8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0C8h+var_4], eax
		cmp	dword_10031F5C,	0
		push	ebx
		push	ebp
		mov	ebp, [esp+0D0h+hSourceHandle]
		push	esi
		mov	esi, [esp+0D4h+arg_0]
		push	edi
		mov	[esp+0D8h+var_C0], ecx
		jnz	short loc_1000D321
		mov	edx, offset dword_10031F5C
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_10018835

loc_1000D321:				; CODE XREF: sub_1000D2DF+31j
		mov	edi, [esp+0D8h+arg_10]
		xor	ebx, ebx
		mov	eax, edi
		or	eax, 2
		push	eax		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		lea	eax, [esp+0E4h+TargetHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	ebp		; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000D35E
		call	ds:GetLastError
		mov	[esi+10h], eax
		xor	al, al
		jmp	loc_1000D41E
; ---------------------------------------------------------------------------

loc_1000D35E:				; CODE XREF: sub_1000D2DF+6Dj
		push	[esp+0D8h+TargetHandle]
		lea	ecx, [esp+0DCh+var_C8]
		mov	[esp+0DCh+var_C8], ebx
		and	edi, 0FFFFFFFEh
		call	sub_10004610
		lea	eax, [esp+0D8h+var_C4]
		mov	ecx, 9Eh
		push	eax
		push	ecx
		lea	eax, [esp+0E0h+var_A4]
		mov	[esp+0E0h+var_C4], ecx
		push	eax
		push	2
		pop	ebp
		push	ebp
		push	[esp+0E8h+var_C8]
		call	dword_10031F5C
		test	eax, eax
		js	short loc_1000D410
		movzx	ecx, [esp+0D8h+var_A4]
		xor	edx, edx
		mov	eax, [esp+0D8h+var_A0]
		shr	ecx, 1
		mov	dword ptr [esp+0D8h+var_B8], ebp
		mov	[eax+ecx*2], dx
		inc	edx
		lea	eax, [esp+0D8h+var_B4]
		mov	ecx, edx

loc_1000D3B4:				; CODE XREF: sub_1000D2DF+DEj
		dec	ecx
		mov	[eax], ebx
		mov	[eax+4], ebx
		lea	eax, [eax+8]
		jns	short loc_1000D3B4
		mov	ecx, [esp+0D8h+var_C0]
		lea	eax, [esp+0D8h+var_A0]
		mov	[esp+0D8h+var_B0], eax
		lea	eax, [esp+0D8h+arg_8]
		mov	[esp+0D8h+var_A8], eax
		lea	eax, [esp+0D8h+var_B8]
		push	eax
		mov	ecx, [ecx+10h]
		push	12h
		mov	[esp+0E0h+var_B4], edx
		mov	[esp+0E0h+var_AC], ebp
		call	sub_10015070
		mov	edx, [esp+0D8h+var_C8]
		mov	ecx, eax
		push	edi
		push	[esp+0DCh+arg_C]
		lea	eax, [esi+18h]
		push	eax
		push	[esp+0E4h+arg_8]
		call	sub_1000D6D6
		add	esp, 10h
		mov	bl, 1

loc_1000D410:				; CODE XREF: sub_1000D2DF+B7j
		lea	ecx, [esp+0D8h+var_C8]
		mov	[esi+10h], eax
		call	sub_10004646
		mov	al, bl

loc_1000D41E:				; CODE XREF: sub_1000D2DF+7Aj
		mov	ecx, [esp+0D8h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0C8h
		retn	14h
sub_1000D2DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D439	proc near		; CODE XREF: sub_10017EF1+12p

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
dwErrCode	= dword	ptr -2Ch
var_24		= dword	ptr -24h
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= byte ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 48h
		push	esi
		mov	esi, [ebp+arg_0]
		push	edi
		xor	edi, edi
		mov	[esp+50h+var_44], edx
		mov	[esp+50h+var_3C], edi
		mov	[esp+50h+var_40], ecx
		mov	[esi], edi
		call	sub_10013DEB
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000D467
		push	4
		pop	eax
		jmp	short loc_1000D4E4
; ---------------------------------------------------------------------------

loc_1000D467:				; CODE XREF: sub_1000D439+27j
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	[esp+50h+var_3C], ecx
		push	30h		; size_t
		mov	[esp+54h+var_38], eax
		lea	eax, [esp+54h+var_30]
		push	edi		; int
		push	eax		; void *
		mov	[esp+5Ch+var_34], edi
		call	memset
		lea	eax, [esp+5Ch+var_34]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; void *
		lea	eax, [esp+68h+var_44]
		push	eax		; void *
		lea	eax, [esp+6Ch+var_40]
		push	eax		; int
		lea	ecx, [esp+70h+var_3C]
		call	sub_1000D4EA
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1000D4E4
		cmp	[esp+50h+dwErrCode], edi
		jz	short loc_1000D4D0
		push	[esp+50h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		push	2
		xor	edx, edx
		mov	ecx, offset aDuplicatehandl ; "DuplicateHandle"
		call	sub_100029E2
		xor	eax, eax
		pop	ecx
		inc	eax
		jmp	short loc_1000D4E4
; ---------------------------------------------------------------------------

loc_1000D4D0:				; CODE XREF: sub_1000D439+77j
		mov	eax, [esp+50h+var_24]
		xor	edx, edx
		mov	ecx, offset aDuplicatehandl ; "DuplicateHandle"
		mov	[esi], eax
		call	sub_10002AE3
		xor	eax, eax

loc_1000D4E4:				; CODE XREF: sub_1000D439+2Cj
					; sub_1000D439+71j ...
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D439	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000D4EA(int,	void *,	void *,	void *,	int)
sub_1000D4EA	proc near		; CODE XREF: sub_1000D439+67p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159C9
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000D502
		push	4
		pop	eax
		jmp	loc_1000D5A4
; ---------------------------------------------------------------------------

loc_1000D502:				; CODE XREF: sub_1000D4EA+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+var_4]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 12h
		push	ebp		; char
		push	ebx		; size_t
		mov	[esi+4], ebp
		mov	[esi+3Ch], ebx
		push	ecx		; void *
		mov	dword ptr [esi+44h], 7Ch
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+var_4], eax
		call	sub_1000D5A8
		test	al, al
		jz	short loc_1000D5A0
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+20h+arg_4]	; void *
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_1000D5A0
		push	2		; int
		push	0		; char
		push	ebx		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, esi
		push	2		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_1000D5A0
		push	2		; int
		push	0		; char
		push	ebx		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, esi
		push	3		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_1000D5A0
		push	[esp+14h+arg_10]
		mov	ecx, edi
		push	esi
		call	sub_10015A42
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1000D5A0
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000D5A0:				; CODE XREF: sub_1000D4EA+4Ej
					; sub_1000D4EA+63j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_1000D5A4:				; CODE XREF: sub_1000D4EA+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_1000D4EA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000D5A8(int, void *, size_t, char,	int)
sub_1000D5A8	proc near		; CODE XREF: sub_1000D4EA+47p
					; sub_1000D4EA+5Cp ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DDD8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 4
		jnb	loc_1000D64E
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_1000D64E
		test	esi, esi
		jz	short loc_1000D5D8
		cmp	[ebp+arg_4], 0
		jz	short loc_1000D64E

loc_1000D5D8:				; CODE XREF: sub_1000D5A8+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_1000D64E
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_1000D64E
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_1000D619
		mov	dword ptr [edi+4], 1

loc_1000D619:				; CODE XREF: sub_1000D5A8+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_1000D650
; ---------------------------------------------------------------------------

loc_1000D640:				; DATA XREF: .rdata:stru_1002DDD8o
		xor	eax, eax	; Exception filter 0 for function 1000D5A8
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1000D644:				; DATA XREF: .rdata:stru_1002DDD8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1000D5A8
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_1000D64E:				; CODE XREF: sub_1000D5A8+14j
					; sub_1000D5A8+20j ...
		xor	al, al

loc_1000D650:				; CODE XREF: sub_1000D5A8+96j
		call	__SEH_epilog4
		retn	14h
sub_1000D5A8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D658	proc near		; CODE XREF: sub_10015277+B7p

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F98B
		sub	esi, 4
		jz	short loc_1000D686
		dec	esi
		jnz	short loc_1000D6C3
		push	esi
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	esi
		jmp	short loc_1000D694
; ---------------------------------------------------------------------------

loc_1000D686:				; CODE XREF: sub_1000D658+1Aj
		push	0
		call	ds:GetCurrentProcessId
		xor	ebx, ebx
		push	eax
		inc	ebx
		push	ebx
		push	ebx

loc_1000D694:				; CODE XREF: sub_1000D658+2Cj
		lea	ecx, [ebp+var_14]
		call	sub_1000FC7A
		test	al, al
		jz	short loc_1000D6C3
		push	ebx
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1000D6C3
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	12h
		call	sub_1000F6EE
		test	al, al
		jnz	short loc_1000D6C5

loc_1000D6C3:				; CODE XREF: sub_1000D658+1Dj
					; sub_1000D658+46j ...
		xor	bl, bl

loc_1000D6C5:				; CODE XREF: sub_1000D658+69j
		lea	ecx, [ebp+var_14]
		call	sub_1000FDA2
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D658	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D6D6	proc near		; CODE XREF: sub_1000D2DF+127p

hTargetProcessHandle= dword ptr	-4
dwProcessId	= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch
dwDesiredAccess	= dword	ptr  10h
dwOptions	= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		mov	ebx, edx
		cmp	ecx, 3
		jz	short loc_1000D6EA
		push	5
		pop	eax
		jmp	loc_1000D778
; ---------------------------------------------------------------------------

loc_1000D6EA:				; CODE XREF: sub_1000D6D6+Aj
		push	esi
		xor	esi, esi
		mov	[ebp+hTargetProcessHandle], esi
		call	ds:GetCurrentProcessId
		cmp	[ebp+dwProcessId], eax
		jz	short loc_1000D736
		push	[ebp+dwProcessId]
		call	sub_1000D77D
		mov	ecx, eax
		call	sub_100089EF
		test	al, al
		jnz	short loc_1000D713
		push	5
		pop	esi
		jmp	short loc_1000D76D
; ---------------------------------------------------------------------------

loc_1000D713:				; CODE XREF: sub_1000D6D6+36j
		push	[ebp+dwProcessId] ; dwProcessId
		push	esi		; bInheritHandle
		push	40h		; dwDesiredAccess
		call	ds:OpenProcess
		push	eax
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_10004610
		mov	eax, [ebp+hTargetProcessHandle]
		test	eax, eax
		jz	short loc_1000D765
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D739
		jmp	short loc_1000D765
; ---------------------------------------------------------------------------

loc_1000D736:				; CODE XREF: sub_1000D6D6+23j
		mov	eax, [ebp+hTargetProcessHandle]

loc_1000D739:				; CODE XREF: sub_1000D6D6+5Cj
		test	eax, eax
		jz	short loc_1000D742
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_1000D748

loc_1000D742:				; CODE XREF: sub_1000D6D6+65j
		call	ds:GetCurrentProcess

loc_1000D748:				; CODE XREF: sub_1000D6D6+6Aj
		push	[ebp+dwOptions]	; dwOptions
		push	esi		; bInheritHandle
		push	[ebp+dwDesiredAccess] ;	dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		push	eax		; hTargetProcessHandle
		push	ebx		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_1000D76D

loc_1000D765:				; CODE XREF: sub_1000D6D6+57j
					; sub_1000D6D6+5Ej
		call	ds:GetLastError
		mov	esi, eax

loc_1000D76D:				; CODE XREF: sub_1000D6D6+3Bj
					; sub_1000D6D6+8Dj
		lea	ecx, [ebp+hTargetProcessHandle]
		call	sub_10004646
		mov	eax, esi
		pop	esi

loc_1000D778:				; CODE XREF: sub_1000D6D6+Fj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D6D6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D77D	proc near		; CODE XREF: mozilla::SandboxBroker::SandboxBroker(void)+22p
					; sub_1000D6D6+28p ...
		mov	eax, dword_10031F60
		test	eax, eax
		jnz	short locret_1000D7B8
		push	4Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000D7A1
		mov	ecx, eax
		call	sub_10007F44
		mov	dword_10031F60,	eax
		jmp	short loc_1000D7A8
; ---------------------------------------------------------------------------

loc_1000D7A1:				; CODE XREF: sub_1000D77D+14j
		and	dword_10031F60,	0

loc_1000D7A8:				; CODE XREF: sub_1000D77D+22j
		push	offset loc_1000D7B9 ; _onexit_t
		call	sub_10018DA5
		mov	eax, dword_10031F60
		pop	ecx

locret_1000D7B8:			; CODE XREF: sub_1000D77D+7j
		retn
; ---------------------------------------------------------------------------

; int __cdecl loc_1000D7B9()
loc_1000D7B9:				; DATA XREF: sub_1000D77D:loc_1000D7A8o
		push	esi
		call	sub_1000D77D
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000D7D4
		mov	ecx, esi
		call	sub_10008064
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D7D4:				; CODE XREF: sub_1000D77D+46j
		xor	eax, eax
		pop	esi
		retn
sub_1000D77D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D7D8	proc near		; DATA XREF: .rdata:off_1002C030o
					; .rdata:off_1002C048o	...

arg_0		= byte ptr  4

		test	[esp+arg_0], 1
		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C030
		jz	short loc_1000D7F0
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000D7F0:				; CODE XREF: sub_1000D7D8+Ej
		mov	eax, esi
		pop	esi
		retn	4
sub_1000D7D8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D7F6	proc near		; CODE XREF: sub_1000DE85+8Ep

var_B8		= byte ptr -0B8h
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0B8h
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, 10000h
		mov	[ebp+var_8], esi
		cmp	esi, edi
		jbe	short loc_1000D83F
		push	offset aSizeKallocgran ; "size <= kAllocGranularity"
		mov	edx, offset dword_1001AB2C
		lea	ecx, [ebp+var_8]
		call	sub_1000325B
		pop	ecx
		test	eax, eax
		jz	short loc_1000D83F
		push	eax
		push	ecx
		push	ecx
		lea	ecx, [ebp+var_B8]
		call	sub_10001B95
		lea	ecx, [ebp+var_B8]
		call	sub_10001BED

loc_1000D83F:				; CODE XREF: sub_1000D7F6+17j
					; sub_1000D7F6+2Ej
		sub	edi, esi

loc_1000D841:				; CODE XREF: sub_1000D7F6+64j
		lea	eax, [ebp+var_4]
		push	eax
		call	ds:rand_s
		pop	ecx
		mov	ecx, [ebp+var_4]
		and	ecx, 0FFFFh
		mov	[ebp+var_4], ecx
		cmp	ecx, edi
		ja	short loc_1000D841
		mov	eax, 800h
		mov	edx, 1000h
		cmp	esi, eax
		ja	short loc_1000D872

loc_1000D86A:				; CODE XREF: sub_1000D7F6+7Aj
		mov	edx, eax
		shr	eax, 1
		cmp	eax, esi
		jnb	short loc_1000D86A

loc_1000D872:				; CODE XREF: sub_1000D7F6+72j
		lea	eax, [edx-1]
		not	eax
		pop	edi
		and	eax, ecx
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D7F6	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D87F	proc near		; CODE XREF: sub_1000D8D2+24p
					; sub_10015127+ABp
		mov	dword ptr [ecx+1Ch], 7
		xor	edx, edx
		mov	[ecx+18h], edx
		xor	eax, eax
		mov	[ecx+8], ax
		push	0Fh
		pop	eax
		mov	[ecx+34h], eax
		mov	[ecx+30h], edx
		mov	[ecx+20h], dl
		mov	[ecx+4Ch], eax
		mov	eax, ecx
		mov	[ecx+48h], edx
		mov	[ecx+38h], dl
		retn
sub_1000D87F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000D8A9	proc near		; CODE XREF: sub_1000D8D2+8Bp
					; sub_1000DA9F+1AFp ...
		push	esi
		mov	esi, ecx
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+38h]
		call	sub_1000189A
		push	0		; size_t
		push	1		; char
		lea	ecx, [esi+20h]
		call	sub_1000189A
		push	0
		push	1
		lea	ecx, [esi+8]
		call	sub_10002311
		pop	esi
		retn
sub_1000D8A9	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000D8D2(void *, void *, int, void *, int)
sub_1000D8D2	proc near		; CODE XREF: sub_10009C33+A2p
					; sub_1000DE85+4Bp ...

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_38		= byte ptr -38h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 58h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+58h+var_4], eax
		push	ebx
		mov	ebx, [esp+5Ch+arg_C]
		push	ebp
		push	esi
		mov	esi, [esp+64h+arg_0]
		mov	ebp, ecx
		push	edi
		mov	edi, [esp+68h+arg_4]
		lea	ecx, [esp+68h+var_58]
		call	sub_1000D87F
		mov	eax, [esp+68h+arg_8]
		mov	ecx, esi
		mov	[esp+68h+var_58], eax
		mov	eax, [esp+68h+arg_10]
		mov	[esp+68h+var_54], eax
		call	sub_10001AF3
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+70h+var_50] ;	void *
		call	sub_10002356
		mov	ecx, edi
		call	sub_100010C6
		push	eax		; size_t
		push	edi		; void *
		lea	ecx, [esp+70h+var_38] ;	void *
		call	sub_100018DB
		mov	ecx, ebx
		call	sub_100010C6
		push	eax		; size_t
		push	ebx		; void *
		lea	ecx, [esp+70h+var_20] ;	void *
		call	sub_100018DB
		and	[esp+68h+var_8], 0
		lea	eax, [esp+68h+var_58]
		lea	ecx, [ebp+4]
		push	eax
		push	dword ptr [ecx]
		call	sub_1000E43D
		lea	ecx, [esp+68h+var_58]
		mov	byte ptr [ebp+0Ch], 1
		call	sub_1000D8A9
		mov	ecx, [esp+68h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 58h
		retn	14h
sub_1000D8D2	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000D979	proc near		; CODE XREF: sub_10015127+117p

var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+8], 0
		jnz	short loc_1000D98C
		mov	al, 1
		jmp	short loc_1000DA03
; ---------------------------------------------------------------------------

loc_1000D98C:				; CODE XREF: sub_1000D979+Dj
		call	sub_1000DA0A
		mov	ebx, eax
		push	ebx
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		mov	ecx, edi
		push	ebx
		push	esi
		call	sub_1000DA9F
		test	al, al
		jz	short loc_1000D9F3
		lea	eax, [ebp+var_4]
		mov	ecx, edi
		push	eax		; int
		push	ebx		; dwSize
		push	esi		; lpBuffer
		call	sub_1000DD99
		test	al, al
		jz	short loc_1000D9F3
		test	ebx, ebx
		mov	ecx, edi
		setnz	al
		movzx	eax, al
		push	eax
		call	sub_1000DE85
		test	al, al
		jz	short loc_1000D9F3
		mov	eax, [ebp+var_4]
		push	4		; nSize
		push	offset g_interceptions ; lpBuffer
		mov	g_interceptions, eax
		mov	ecx, [edi]
		push	offset aG_intercepti_0 ; "g_interceptions"
		call	sub_10017AD9
		mov	ebx, eax
		neg	ebx
		sbb	bl, bl
		inc	bl
		jmp	short loc_1000D9F5
; ---------------------------------------------------------------------------

loc_1000D9F3:				; CODE XREF: sub_1000D979+2Ej
					; sub_1000D979+3Fj ...
		xor	bl, bl

loc_1000D9F5:				; CODE XREF: sub_1000D979+78j
		test	esi, esi
		jz	short loc_1000DA01
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1000DA01:				; CODE XREF: sub_1000D979+7Ej
		mov	al, bl

loc_1000DA03:				; CODE XREF: sub_1000D979+11j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000D979	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000DA0A	proc near		; CODE XREF: sub_1000D979:loc_1000D98Cp

var_14		= byte ptr -14h
var_C		= byte ptr -0Ch

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	ecx
		mov	ebx, ecx
		push	ecx
		lea	ecx, [esp+2Ch+var_14]
		call	sub_1000C323
		mov	eax, [ebx+4]
		xor	edi, edi
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_1000DA8C

loc_1000DA29:				; CODE XREF: sub_1000DA0A+79j
		lea	eax, [esi+8]
		push	eax
		call	sub_1000DE0C
		test	al, al
		jz	short loc_1000DA7E
		lea	ebp, [esi+10h]
		push	ebp
		lea	ecx, [esp+28h+var_14]
		call	sub_1000CC83
		test	eax, eax
		jnz	short loc_1000DA6F
		mov	eax, [esi+20h]
		lea	eax, ds:13h[eax*2]
		shr	eax, 2
		lea	edi, [edi+eax*4]
		movzx	eax, byte_10031F23
		push	eax
		push	ebp
		push	ecx
		lea	eax, [esp+30h+var_C]
		push	eax
		lea	ecx, [esp+34h+var_14]
		call	sub_1000C44C

loc_1000DA6F:				; CODE XREF: sub_1000DA0A+3Bj
		mov	eax, [esi+38h]
		add	eax, 15h
		add	eax, [esi+50h]
		shr	eax, 2
		lea	edi, [edi+eax*4]

loc_1000DA7E:				; CODE XREF: sub_1000DA0A+2Aj
		mov	esi, [esi]
		cmp	esi, [ebx+4]
		jnz	short loc_1000DA29
		test	edi, edi
		jz	short loc_1000DA8C
		add	edi, 8

loc_1000DA8C:				; CODE XREF: sub_1000DA0A+1Dj
					; sub_1000DA0A+7Dj
		lea	ecx, [esp+24h+var_14]
		call	sub_1000C25D
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1000DA0A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000DA9F	proc near		; CODE XREF: sub_1000D979+27p

var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_240		= dword	ptr -240h
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= byte ptr -234h
var_184		= byte ptr -184h
var_D4		= byte ptr -0D4h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 254h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+254h+var_8], eax
		mov	edx, [esp+254h+arg_0]
		push	ebx
		push	ebp
		xor	ebx, ebx
		mov	[esp+25Ch+var_24C], ecx
		mov	[esp+25Ch+var_244], ebx
		mov	ebp, [esp+25Ch+arg_4]
		mov	[esp+25Ch+var_238], edx
		push	esi
		push	edi
		test	ebp, ebp
		jz	loc_1000DCB3
		and	[esp+264h+var_248], ebx
		lea	esi, [edx+8]
		mov	[esp+264h+var_240], esi
		cmp	[ecx+0Ch], bl
		jz	short loc_1000DAF2
		mov	eax, [ecx]
		mov	eax, [eax+28h]
		jmp	short loc_1000DAF4
; ---------------------------------------------------------------------------

loc_1000DAF2:				; CODE XREF: sub_1000DA9F+4Aj
		xor	eax, eax

loc_1000DAF4:				; CODE XREF: sub_1000DA9F+51j
		mov	[edx+4], eax
		sub	ebp, 8
		mov	eax, [ecx+4]
		mov	edi, [eax]
		cmp	edi, eax
		jz	loc_1000DCAD

loc_1000DB07:				; CODE XREF: sub_1000DA9F+204j
		lea	ecx, [edi+8]
		push	ecx
		call	sub_1000DE0C
		test	al, al
		jnz	short loc_1000DB1B
		mov	edi, [edi]
		jmp	loc_1000DC9C
; ---------------------------------------------------------------------------

loc_1000DB1B:				; CODE XREF: sub_1000DA9F+73j
		lea	eax, [edi+10h]
		push	eax
		lea	ecx, [esp+268h+var_20]
		call	sub_100038A0
		test	bl, 2
		jz	short loc_1000DB3C
		lea	ecx, [esp+264h+var_234]
		and	ebx, 0FFFFFFFDh
		call	sub_10001BED

loc_1000DB3C:				; CODE XREF: sub_1000DA9F+8Fj
		test	bl, 4
		jz	short loc_1000DB50
		lea	ecx, [esp+264h+var_D4]
		and	ebx, 0FFFFFFFBh
		call	sub_10001BED

loc_1000DB50:				; CODE XREF: sub_1000DA9F+A0j
		test	bl, 8
		jz	short loc_1000DB64
		lea	ecx, [esp+264h+var_184]
		and	ebx, 0FFFFFFF7h
		call	sub_10001BED

loc_1000DB64:				; CODE XREF: sub_1000DA9F+B4j
		mov	eax, [edi+20h]
		mov	[esp+264h+var_250], esi
		lea	ecx, ds:13h[eax*2]
		and	ecx, 0FFFFFFFCh
		cmp	ebp, ecx
		jb	loc_1000DCD0
		add	esi, ecx
		sub	ebp, ecx
		cmp	dword ptr [edi+8], 5
		mov	[esp+264h+var_244], esi
		mov	[esp+264h+var_23C], esi
		setz	al
		mov	esi, [esp+264h+var_250]
		push	ecx
		mov	[esp+268h+arg_4], ebp
		and	dword ptr [esi+8], 0
		mov	[esi+0Ch], al
		lea	eax, [esi+0Eh]
		mov	[esi], ecx
		mov	[esi+4], ecx
		lea	ecx, [edi+10h]
		push	dword ptr [edi+20h]
		push	dword ptr [edi+20h]
		push	eax
		call	sub_1000C17D
		mov	eax, [edi+20h]
		xor	ecx, ecx
		mov	[esi+eax*2+0Eh], cx
		mov	esi, edi
		mov	eax, [esp+264h+var_24C]
		mov	[esp+264h+var_250], esi
		cmp	edi, [eax+4]
		jz	loc_1000DC80
		mov	ebp, eax

loc_1000DBD9:				; CODE XREF: sub_1000DA9F+1CEj
		cmp	[esp+264h+var_C], 8
		lea	ecx, [esi+10h]
		mov	eax, [esp+264h+var_20]
		jnb	short loc_1000DBF4
		lea	eax, [esp+264h+var_20]

loc_1000DBF4:				; CODE XREF: sub_1000DA9F+14Cj
		push	[esp+264h+var_10]
		push	eax
		push	dword ptr [ecx+10h]
		push	0
		call	sub_10003F14
		test	eax, eax
		jnz	short loc_1000DC64
		push	[esp+264h+var_240] ; int
		lea	eax, [esp+268h+arg_4]
		push	eax		; int
		lea	eax, [esp+26Ch+var_23C]
		push	eax		; int
		lea	ebp, [esi+8]
		push	ebp		; DstSize
		call	sub_1000DCE4
		test	al, al
		jz	loc_1000DCD0
		cmp	edi, esi
		jnz	short loc_1000DC32
		mov	edi, [edi]

loc_1000DC32:				; CODE XREF: sub_1000DA9F+18Fj
		mov	eax, [esp+264h+var_250]
		mov	ecx, ebp
		mov	esi, [esi]
		mov	edx, [eax+4]
		mov	[edx], esi
		mov	edx, [eax]
		mov	eax, [eax+4]
		mov	[edx+4], eax
		mov	eax, [esp+264h+var_24C]
		dec	dword ptr [eax+8]
		call	sub_1000D8A9
		push	[esp+264h+var_250]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	ebp, [esp+268h+var_24C]
		pop	ecx
		jmp	short loc_1000DC66
; ---------------------------------------------------------------------------

loc_1000DC64:				; CODE XREF: sub_1000DA9F+169j
		mov	esi, [esi]

loc_1000DC66:				; CODE XREF: sub_1000DA9F+1C3j
		mov	[esp+264h+var_250], esi
		cmp	esi, [ebp+4]
		jnz	loc_1000DBD9
		mov	ebp, [esp+264h+arg_4]
		mov	esi, [esp+264h+var_23C]
		jmp	short loc_1000DC84
; ---------------------------------------------------------------------------

loc_1000DC80:				; CODE XREF: sub_1000DA9F+132j
		mov	esi, [esp+264h+var_244]

loc_1000DC84:				; CODE XREF: sub_1000DA9F+1DFj
		inc	[esp+264h+var_248]
		lea	ecx, [esp+264h+var_20]
		push	0
		push	1
		mov	[esp+26Ch+var_240], esi
		call	sub_10002311

loc_1000DC9C:				; CODE XREF: sub_1000DA9F+77j
		mov	eax, [esp+264h+var_24C]
		cmp	edi, [eax+4]
		jnz	loc_1000DB07
		mov	edx, [esp+264h+var_238]

loc_1000DCAD:				; CODE XREF: sub_1000DA9F+62j
		mov	ecx, [esp+264h+var_248]
		mov	[edx], ecx

loc_1000DCB3:				; CODE XREF: sub_1000DA9F+36j
		mov	al, 1

loc_1000DCB5:				; CODE XREF: sub_1000DA9F+243j
		mov	ecx, [esp+264h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 254h
		retn	8
; ---------------------------------------------------------------------------

loc_1000DCD0:				; CODE XREF: sub_1000DA9F+D8j
					; sub_1000DA9F+187j
		push	0
		push	1
		lea	ecx, [esp+26Ch+var_20]
		call	sub_10002311
		xor	al, al
		jmp	short loc_1000DCB5
sub_1000DA9F	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DCE4(rsize_t DstSize, int, int,	int)
sub_1000DCE4	proc near		; CODE XREF: sub_1000DA9F+180p

var_4		= dword	ptr -4
DstSize		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		and	[esp+4+var_4], 0
		push	ebx
		mov	ebx, [esp+8+DstSize]
		push	ebp
		mov	ebp, [esp+0Ch+arg_C]
		push	esi
		push	edi
		cmp	byte ptr [ebp+0Ch], 0
		jz	short loc_1000DD0E
		push	1		; int
		lea	ecx, [ebx+20h]	; void *
		push	offset a@	; "@"
		push	dword ptr [ecx+10h] ; size_t
		push	ecx		; int
		call	sub_10003988

loc_1000DD0E:				; CODE XREF: sub_1000DCE4+15j
		mov	eax, [ebx+48h]
		mov	ecx, [ebx+30h]
		mov	edx, [esp+14h+arg_4]
		mov	[esp+14h+DstSize], eax
		lea	edi, [eax+15h]
		mov	[esp+14h+arg_4], ecx
		mov	eax, [esp+14h+arg_8]
		add	edi, ecx
		mov	esi, [edx]
		and	edi, 0FFFFFFFCh
		mov	eax, [eax]
		cmp	eax, edi
		jnb	short loc_1000DD38
		xor	al, al
		jmp	short loc_1000DD91
; ---------------------------------------------------------------------------

loc_1000DD38:				; CODE XREF: sub_1000DCE4+4Ej
		mov	ebp, [esp+14h+arg_8]
		sub	eax, edi
		push	ecx		; int
		push	ecx		; MaxCount
		push	ecx		; DstSize
		mov	[ebp+0], eax
		lea	ecx, [ebx+20h]	; Src
		add	[edx], edi
		mov	[esi], edi
		mov	eax, [ebx]
		mov	[esi+4], eax
		mov	eax, [ebx+4]
		mov	[esi+8], eax
		mov	eax, [ebx+50h]
		mov	[esi+0Ch], eax
		add	esi, 10h
		push	esi		; Dst
		call	sub_1000E39B
		add	esi, [esp+14h+arg_4]
		mov	eax, [esp+14h+DstSize]
		push	ecx		; int
		push	eax		; MaxCount
		mov	byte ptr [esi],	0
		lea	ecx, [ebx+38h]	; Src
		push	eax		; DstSize
		inc	esi
		push	esi		; Dst
		call	sub_1000E39B
		mov	ecx, [esp+14h+DstSize]
		mov	al, 1
		mov	ebp, [esp+14h+arg_C]
		mov	byte ptr [esi+ecx], 0
		inc	dword ptr [ebp+8]
		add	[ebp+0], edi

loc_1000DD91:				; CODE XREF: sub_1000DCE4+52j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_1000DCE4	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000DD99(LPVOID lpBuffer, DWORD dwSize, int)
sub_1000DD99	proc near		; CODE XREF: sub_1000D979+38p

var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
dwSize		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+dwSize]
		xor	ebp, ebp
		mov	[esp+10h+var_4], ebp
		push	edi
		test	esi, esi
		jnz	short loc_1000DDB6
		mov	eax, [esp+14h+arg_8]
		mov	[eax], ebp

loc_1000DDB2:				; CODE XREF: sub_1000DD99+59j
		mov	al, 1
		jmp	short loc_1000DE04
; ---------------------------------------------------------------------------

loc_1000DDB6:				; CODE XREF: sub_1000DD99+11j
		mov	eax, [ecx]
		push	4		; flProtect
		push	1000h		; flAllocationType
		push	esi		; dwSize
		mov	ebx, [eax]
		push	ebp		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualAllocEx
		mov	edi, eax
		test	edi, edi
		jz	short loc_1000DE02
		lea	eax, [esp+14h+dwSize]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		push	edi		; lpBaseAddress
		push	ebx		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000DDF4
		cmp	[esp+14h+dwSize], esi
		jnz	short loc_1000DDF4
		mov	eax, [esp+14h+arg_8]
		mov	[eax], edi
		jmp	short loc_1000DDB2
; ---------------------------------------------------------------------------

loc_1000DDF4:				; CODE XREF: sub_1000DD99+4Bj
					; sub_1000DD99+51j
		push	8000h		; dwFreeType
		push	ebp		; dwSize
		push	edi		; lpAddress
		push	ebx		; hProcess
		call	ds:VirtualFreeEx

loc_1000DE02:				; CODE XREF: sub_1000DD99+35j
		xor	al, al

loc_1000DE04:				; CODE XREF: sub_1000DD99+1Bj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	0Ch
sub_1000DD99	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000DE0C	proc near		; CODE XREF: sub_1000DA0A+23p
					; sub_1000DA9F+6Cp

var_20		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		cmp	dword ptr [esi], 0
		jnz	short loc_1000DE2A

loc_1000DE26:				; CODE XREF: sub_1000DE0C+21j
					; sub_1000DE0C+26j
		xor	al, al
		jmp	short loc_1000DE71
; ---------------------------------------------------------------------------

loc_1000DE2A:				; CODE XREF: sub_1000DE0C+18j
		cmp	dword ptr [esi], 1
		jz	short loc_1000DE26
		cmp	dword ptr [esi], 6
		jge	short loc_1000DE26
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [ebp+var_20] ; void *
		call	sub_10001C7F
		lea	eax, [esi+8]
		cmp	dword ptr [eax+14h], 8
		mov	ecx, [eax+10h]
		jb	short loc_1000DE4F
		mov	eax, [eax]

loc_1000DE4F:				; CODE XREF: sub_1000DE0C+3Fj
		push	ecx
		push	eax
		push	[ebp+var_10]
		lea	ecx, [ebp+var_20]
		push	0
		call	sub_10003F14
		test	eax, eax
		lea	ecx, [ebp+var_20]
		push	0
		push	1
		setnz	bl
		call	sub_10002311
		mov	al, bl

loc_1000DE71:				; CODE XREF: sub_1000DE0C+1Cj
		mov	ecx, [ebp+var_8]
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000DE0C	endp

; ---------------------------------------------------------------------------
		db 2 dup(0CCh)

; =============== S U B	R O U T	I N E =======================================


sub_1000DE85	proc near		; CODE XREF: sub_1000D979+4Cp

var_11C		= dword	ptr -11Ch
hProcess	= dword	ptr -118h
NumberOfBytesWritten= dword ptr	-114h
var_110		= dword	ptr -110h
flOldProtect	= dword	ptr -10Ch
var_108		= byte ptr -108h
Buffer		= dword	ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  4

		sub	esp, 120h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+120h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		xor	ebp, ebp
		inc	edi
		mov	[esp+130h+var_11C], ebp
		cmp	[esp+130h+arg_0], 0
		mov	ebx, ecx
		jnz	short loc_1000DEBE
		cmp	[ebx+8], ebp
		jnz	short loc_1000DEE9
		mov	al, 1
		jmp	loc_1000E017
; ---------------------------------------------------------------------------

loc_1000DEBE:				; CODE XREF: sub_1000DE85+2Bj
		push	ebp		; int
		push	offset a_targetntmap_0 ; "_TargetNtMapViewOfSection@44"
		push	edi		; int
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		mov	esi, offset aNtdll_dll_0 ; "ntdll.dll"
		push	esi		; void *
		call	sub_1000D8D2
		push	edi		; int
		push	offset a_targetntunm_0 ; "_TargetNtUnmapViewOfSection@12"
		push	edi		; int
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		push	esi		; void *
		mov	ecx, ebx
		call	sub_1000D8D2

loc_1000DEE9:				; CODE XREF: sub_1000DE85+30j
		mov	eax, [ebx]
		push	edi		; flProtect
		mov	edi, ds:VirtualAllocEx
		push	2000h		; flAllocationType
		mov	eax, [eax]
		push	10000h		; dwSize
		push	ebp		; lpAddress
		push	eax		; hProcess
		mov	[esp+144h+hProcess], eax
		call	edi ; VirtualAllocEx
		mov	ebp, [ebx+8]
		mov	esi, eax
		shl	ebp, 6
		add	ebp, 50h
		mov	ecx, ebp
		call	sub_1000D7F6
		mov	ecx, eax
		mov	edx, 0FFFFF000h
		and	ecx, edx
		and	eax, 0FFFh
		add	esi, ecx
		mov	[esp+130h+var_110], eax
		push	40h		; flProtect
		push	1000h		; flAllocationType
		lea	ecx, [ebp+0FFFh]
		and	ecx, edx
		push	ecx		; dwSize
		push	esi		; lpAddress
		push	[esp+140h+hProcess] ; hProcess
		call	edi ; VirtualAllocEx
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1000DF73
		push	3
		push	195h
		push	offset aCBuildsMoz2__0 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+13Ch+var_108]
		mov	[esp+13Ch+var_11C], 1
		call	sub_10001B48
		mov	edx, offset aCheckFailedThu ; "Check failed: thunk_base. "
		lea	ecx, [eax+8]
		call	sub_10002847

loc_1000DF73:				; CODE XREF: sub_1000DE85+C2j
		test	byte ptr [esp+130h+var_11C], 1
		jz	short loc_1000DF83
		lea	ecx, [esp+130h+var_108]
		call	sub_10001BED

loc_1000DF83:				; CODE XREF: sub_1000DE85+F3j
		add	esi, [esp+130h+var_110]
		and	[esp+130h+var_4C], 0
		push	10h
		pop	edi
		push	64h		; size_t
		push	0		; int
		push	offset g_originals ; void *
		mov	[esp+13Ch+Buffer], ebp
		mov	[esp+13Ch+var_54], edi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+130h+Buffer]
		mov	ecx, ebx
		push	eax
		push	ebp
		push	esi
		call	sub_1000E032
		test	al, al
		jz	short loc_1000E015
		lea	eax, [esp+130h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		mov	edi, [esp+138h+hProcess]
		lea	eax, [esp+138h+Buffer]
		push	eax		; lpBuffer
		push	esi		; lpBaseAddress
		push	edi		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_1000E015
		cmp	[esp+130h+NumberOfBytesWritten], 10h
		jnz	short loc_1000E015
		lea	eax, [esp+130h+flOldProtect]
		push	eax		; lpflOldProtect
		push	20h		; flNewProtect
		push	ebp		; dwSize
		push	esi		; lpAddress
		push	edi		; hProcess
		call	ds:VirtualProtectEx
		mov	ecx, [ebx]
		push	64h		; nSize
		push	offset g_originals ; lpBuffer
		push	offset aG_originals_0 ;	"g_originals"
		call	sub_10017AD9
		neg	eax
		sbb	eax, eax
		inc	eax
		jmp	short loc_1000E017
; ---------------------------------------------------------------------------

loc_1000E015:				; CODE XREF: sub_1000DE85+13Fj
					; sub_1000DE85+15Dj ...
		xor	al, al

loc_1000E017:				; CODE XREF: sub_1000DE85+34j
					; sub_1000DE85+18Ej
		mov	ecx, [esp+130h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 120h
		retn	4
sub_1000DE85	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E032	proc near		; CODE XREF: sub_1000DE85+138p

var_FC		= dword	ptr -0FCh
phModule	= dword	ptr -0F8h
hLibModule	= dword	ptr -0F4h
var_F0		= dword	ptr -0F0h
var_EC		= dword	ptr -0ECh
var_E8		= dword	ptr -0E8h
var_E4		= dword	ptr -0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= byte ptr -0D0h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
hObject		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 100h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+100h+var_4], eax
		mov	eax, [esp+100h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	[esp+110h+var_E4], eax
		mov	eax, [esp+110h+arg_8]
		xor	ebx, ebx
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		mov	[esp+114h+var_DC], ebp
		mov	[esp+114h+var_FC], eax
		mov	[esp+114h+var_F0], ebx
		call	ds:GetModuleHandleW
		mov	[esp+110h+phModule], eax
		test	eax, eax
		jnz	short loc_1000E086
		xor	al, al
		jmp	loc_1000E380
; ---------------------------------------------------------------------------

loc_1000E086:				; CODE XREF: sub_1000E032+4Bj
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [esp+114h+var_D8]
		mov	[esp+114h+var_D8], offset off_1001AA20
		mov	[esp+114h+var_D4], eax
		call	sub_1000579F
		test	eax, eax
		jz	short loc_1000E0BA
		lea	ecx, [esp+110h+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW
		test	eax, eax
		jz	loc_1000E37E

loc_1000E0BA:				; CODE XREF: sub_1000E032+70j
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jg	loc_1000E152
		mov	eax, [ebp+0]
		lea	ecx, [esp+110h+var_1C]
		mov	[esp+110h+var_1C], eax
		mov	eax, [esp+110h+phModule]
		mov	[esp+110h+var_18], eax
		mov	[esp+110h+hObject], ebx
		mov	[esp+110h+var_10], ebx
		call	sub_1000672E
		mov	esi, ds:CloseHandle
		test	al, al
		jnz	short loc_1000E12E
		cmp	[esp+110h+hObject], ebx
		jz	short loc_1000E113
		push	[esp+110h+hObject] ; hObject
		call	esi ; CloseHandle

loc_1000E113:				; CODE XREF: sub_1000E032+D6j
		cmp	[esp+110h+var_10], ebx
		jz	loc_1000E37E
		push	[esp+110h+var_10] ; hObject
		call	esi ; CloseHandle
		jmp	loc_1000E37E
; ---------------------------------------------------------------------------

loc_1000E12E:				; CODE XREF: sub_1000E032+CDj
		cmp	[esp+110h+hObject], ebx
		jz	short loc_1000E140
		push	[esp+110h+hObject] ; hObject
		call	esi ; CloseHandle

loc_1000E140:				; CODE XREF: sub_1000E032+103j
		cmp	[esp+110h+var_10], ebx
		jz	short loc_1000E152
		push	[esp+110h+var_10] ; hObject
		call	esi ; CloseHandle

loc_1000E152:				; CODE XREF: sub_1000E032+90j
					; sub_1000E032+115j
		mov	eax, [ebp+0]
		mov	ecx, [eax+28h]
		push	dword ptr [eax+2Ch] ; lpLibFileName
		mov	[esp+114h+var_E8], ecx
		call	ds:LoadLibraryW
		mov	[esp+110h+hLibModule], eax
		call	sub_100063D2
		push	1Ch
		cmp	dword ptr [eax+28h], 1
		jnz	short loc_1000E1B5
		cmp	dword ptr [eax], 5
		jl	short loc_1000E198
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E200
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C070
		jmp	short loc_1000E1F2
; ---------------------------------------------------------------------------

loc_1000E198:				; CODE XREF: sub_1000E032+147j
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E200
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C098
		jmp	short loc_1000E1F2
; ---------------------------------------------------------------------------

loc_1000E1B5:				; CODE XREF: sub_1000E032+142j
		cmp	dword ptr [eax], 5
		jl	short loc_1000E1D7
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E200
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C0C0
		jmp	short loc_1000E1F2
; ---------------------------------------------------------------------------

loc_1000E1D7:				; CODE XREF: sub_1000E032+186j
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_1000E200
		mov	eax, [ebp+0]
		mov	cl, [ebp+0Dh]
		mov	eax, [eax]
		mov	dword ptr [edi], offset	off_1002C048

loc_1000E1F2:				; CODE XREF: sub_1000E032+164j
					; sub_1000E032+181j ...
		mov	[edi+18h], ebx
		mov	[edi+14h], cl
		mov	[edi+10h], eax
		mov	[edi+0Ch], ebx
		jmp	short loc_1000E202
; ---------------------------------------------------------------------------

loc_1000E200:				; CODE XREF: sub_1000E032+154j
					; sub_1000E032+171j ...
		mov	edi, ebx

loc_1000E202:				; CODE XREF: sub_1000E032+1CCj
		mov	eax, [ebp+4]
		mov	esi, [eax]
		cmp	esi, eax
		jz	loc_1000E35C

loc_1000E20F:				; CODE XREF: sub_1000E032+313j
		push	offset aNtdll_dll_0 ; "ntdll.dll"
		lea	ecx, [esp+114h+var_1C] ; void *
		call	sub_10001C7F
		cmp	[esp+110h+var_8], 8
		lea	ecx, [esi+10h]
		mov	eax, [esp+110h+var_1C]
		jnb	short loc_1000E23B
		lea	eax, [esp+110h+var_1C]

loc_1000E23B:				; CODE XREF: sub_1000E032+200j
		push	[esp+110h+var_C]
		push	eax
		push	dword ptr [ecx+10h]
		push	ebx
		call	sub_10003F14
		test	eax, eax
		jnz	loc_1000E34D
		cmp	dword ptr [esi+8], 1
		jnz	loc_1000E34D
		cmp	[esi+58h], ebx
		jnz	short loc_1000E296
		lea	ecx, [esi+40h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E26E
		mov	ecx, [ecx]

loc_1000E26E:				; CODE XREF: sub_1000E032+238j
		mov	eax, [edi]
		lea	edx, [esp+110h+var_E0]
		push	edx
		push	ecx
		push	[esp+118h+hLibModule]
		mov	ecx, edi
		call	dword ptr [eax+8]
		test	eax, eax
		js	loc_1000E34D
		mov	eax, [esp+110h+var_E0]
		sub	eax, [esp+110h+hLibModule]
		add	eax, [esp+110h+var_E8]
		mov	[esi+58h], eax

loc_1000E296:				; CODE XREF: sub_1000E032+22Fj
		lea	eax, [esi+40h]
		cmp	dword ptr [eax+14h], 10h
		mov	[esp+110h+var_EC], eax
		jb	short loc_1000E2A9
		mov	eax, [eax]
		mov	[esp+110h+var_EC], eax

loc_1000E2A9:				; CODE XREF: sub_1000E032+26Fj
		lea	ecx, [esi+28h]
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E2B4
		mov	ecx, [ecx]

loc_1000E2B4:				; CODE XREF: sub_1000E032+27Ej
		mov	ebp, [esp+110h+var_FC]
		mov	eax, [esp+110h+arg_4]
		mov	edx, [edi]
		push	ebx
		sub	eax, [ebp+4]
		push	eax
		mov	eax, ebp
		mov	ebp, [esp+118h+var_E4]
		add	ebp, 10h
		mov	eax, [eax+0Ch]
		shl	eax, 6
		add	eax, ebp
		push	eax
		push	dword ptr [esi+58h]
		push	[esp+120h+var_EC]
		push	ecx
		push	[esp+128h+var_E8]
		mov	ecx, edi
		push	[esp+12Ch+phModule]
		call	dword ptr [edx+4]
		mov	ebp, [esp+110h+var_DC]
		test	eax, eax
		js	short loc_1000E34D
		mov	eax, [esp+110h+var_F0]
		test	al, 4
		jz	short loc_1000E30D
		and	eax, 0FFFFFFFBh
		lea	ecx, [esp+110h+var_D0]
		mov	[esp+110h+var_F0], eax
		call	sub_10001BED

loc_1000E30D:				; CODE XREF: sub_1000E032+2C9j
		mov	edx, [esp+110h+var_FC]
		mov	ecx, [esp+110h+var_E4]
		add	ecx, 10h
		push	ebx
		mov	eax, [edx+0Ch]
		shl	eax, 6
		add	ecx, eax
		mov	eax, [esi+0Ch]
		push	1
		mov	g_originals[eax*4], ecx
		lea	ecx, [esp+118h+var_1C]
		inc	dword ptr [edx+0Ch]
		add	dword ptr [edx+4], 40h
		call	sub_10002311
		mov	esi, [esi]
		cmp	esi, [ebp+4]
		jnz	loc_1000E20F
		jmp	short loc_1000E35C
; ---------------------------------------------------------------------------

loc_1000E34D:				; CODE XREF: sub_1000E032+21Cj
					; sub_1000E032+226j ...
		push	ebx
		push	1
		lea	ecx, [esp+118h+var_1C]
		call	sub_10002311

loc_1000E35C:				; CODE XREF: sub_1000E032+1D7j
					; sub_1000E032+319j
		test	edi, edi
		jz	short loc_1000E368
		mov	eax, [edi]
		mov	ecx, edi
		push	1
		call	dword ptr [eax]

loc_1000E368:				; CODE XREF: sub_1000E032+32Cj
		mov	eax, [esp+110h+hLibModule]
		test	eax, eax
		jz	short loc_1000E377
		push	eax		; hLibModule
		call	ds:FreeLibrary

loc_1000E377:				; CODE XREF: sub_1000E032+33Cj
		cmp	esi, [ebp+4]
		jnz	short loc_1000E37E
		mov	bl, 1

loc_1000E37E:				; CODE XREF: sub_1000E032+82j
					; sub_1000E032+E8j ...
		mov	al, bl

loc_1000E380:				; CODE XREF: sub_1000E032+4Fj
		mov	ecx, [esp+110h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 100h
		retn	0Ch
sub_1000E032	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_1000E39B(void *Src, void *Dst, rsize_t DstSize, rsize_t MaxCount, int)
sub_1000E39B	proc near		; CODE XREF: sub_1000DCE4+7Cp
					; sub_1000DCE4+94p

Dst		= dword	ptr  4
DstSize		= dword	ptr  8
MaxCount	= dword	ptr  0Ch

		push	esi
		mov	esi, [esp+4+MaxCount]
		cmp	[ecx+10h], esi
		jnb	short loc_1000E3A8
		mov	esi, [ecx+10h]

loc_1000E3A8:				; CODE XREF: sub_1000E39B+8j
		cmp	dword ptr [ecx+14h], 10h
		jb	short loc_1000E3B0
		mov	ecx, [ecx]

loc_1000E3B0:				; CODE XREF: sub_1000E39B+11j
		test	esi, esi
		jz	short loc_1000E3C7
		push	esi		; MaxCount
		push	ecx		; Src
		push	[esp+0Ch+DstSize] ; DstSize
		push	[esp+10h+Dst]	; Dst
		call	ds:memcpy_s
		add	esp, 10h

loc_1000E3C7:				; CODE XREF: sub_1000E39B+17j
		mov	eax, esi
		pop	esi
		retn	10h
sub_1000E39B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E3CD	proc near		; CODE XREF: sub_10015127+131p
		push	ebx
		push	edi
		mov	edi, ecx
		mov	eax, [edi]
		mov	ebx, [eax]
		mov	[eax], eax
		mov	eax, [edi]
		mov	[eax+4], eax
		and	dword ptr [edi+4], 0
		cmp	ebx, [edi]
		jz	short loc_1000E3FE
		push	esi

loc_1000E3E5:				; CODE XREF: sub_1000E3CD+2Ej
		mov	esi, [ebx]
		lea	ecx, [ebx+8]
		call	sub_1000D8A9
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	ebx, esi
		pop	ecx
		cmp	esi, [edi]
		jnz	short loc_1000E3E5
		pop	esi

loc_1000E3FE:				; CODE XREF: sub_1000E3CD+15j
		push	dword ptr [edi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	edi
		pop	ebx
		retn
sub_1000E3CD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E40A	proc near		; CODE XREF: sub_1000E43D+13p
					; sub_10015127+32p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	5Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jnz	short loc_1000E41D
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000E41D:				; CODE XREF: sub_1000E40A+Bj
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jnz	short loc_1000E42B
		mov	ecx, eax
		mov	edx, eax
		jmp	short loc_1000E42F
; ---------------------------------------------------------------------------

loc_1000E42B:				; CODE XREF: sub_1000E40A+19j
		mov	edx, [esp+arg_4]

loc_1000E42F:				; CODE XREF: sub_1000E40A+1Fj
		mov	[eax], ecx
		lea	ecx, [eax+4]
		test	ecx, ecx
		jz	short locret_1000E43A
		mov	[ecx], edx

locret_1000E43A:			; CODE XREF: sub_1000E40A+2Cj
		retn	8
sub_1000E40A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E43D	proc near		; CODE XREF: sub_1000D8D2+7Ep
					; sub_10015127+EDp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		push	edi
		mov	edi, ecx
		mov	[esp+14h+var_4], edi
		push	dword ptr [esi+4]
		push	esi
		call	sub_1000E40A
		mov	ebx, eax
		lea	ebp, [ebx+8]
		test	ebp, ebp
		jz	short loc_1000E49B
		mov	edi, [esp+14h+arg_4]
		mov	ecx, [edi]
		lea	eax, [edi+8]
		mov	[ebp+0], ecx
		mov	ecx, [edi+4]
		mov	[ebp+4], ecx
		lea	ecx, [ebp+8]
		push	eax
		call	sub_100038A0
		lea	eax, [edi+20h]
		push	eax
		lea	ecx, [ebp+20h]
		call	sub_1000345E
		lea	eax, [edi+38h]
		push	eax
		lea	ecx, [ebp+38h]
		call	sub_1000345E
		mov	eax, [edi+50h]
		mov	edi, [esp+14h+var_4]
		mov	[ebp+50h], eax

loc_1000E49B:				; CODE XREF: sub_1000E43D+1Fj
		mov	ecx, [edi+4]
		mov	eax, 2C8590Ah
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_1000E4B5
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000E4B5:				; CODE XREF: sub_1000E43D+6Bj
		lea	eax, [ecx+1]
		mov	[edi+4], eax
		mov	[esi+4], ebx
		mov	eax, [ebx+4]
		pop	edi
		pop	esi
		pop	ebp
		mov	[eax], ebx
		pop	ebx
		pop	ecx
		retn	8
sub_1000E43D	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E4CB	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x):loc_100176C8p
					; TargetNtUnmapViewOfSection(x,x,x)+1Fp
		push	esi
		mov	esi, dword_10031F6C
		test	esi, esi
		jnz	short loc_1000E528
		mov	eax, g_interceptions
		test	eax, eax
		jnz	short loc_1000E4E1
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000E4E1:				; CODE XREF: sub_1000E4CB+12j
		mov	eax, [eax]
		xor	esi, esi
		push	edi
		lea	edi, ds:8[eax*4]
		call	sub_10013DFD
		test	al, al
		jz	short loc_1000E506
		push	edi
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax

loc_1000E506:				; CODE XREF: sub_1000E4CB+29j
		mov	eax, g_interceptions
		xor	ecx, ecx
		mov	[esi], eax
		mov	dword_10031F6C,	esi
		pop	edi
		cmp	[eax], ecx
		jle	short loc_1000E528
		lea	edx, [esi+4]

loc_1000E51D:				; CODE XREF: sub_1000E4CB+5Bj
		and	dword ptr [edx], 0
		inc	ecx
		lea	edx, [edx+4]
		cmp	ecx, [eax]
		jl	short loc_1000E51D

loc_1000E528:				; CODE XREF: sub_1000E4CB+9j
					; sub_1000E4CB+4Dj
		mov	eax, esi
		pop	esi
		retn
sub_1000E4CB	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E52C	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1A9p

var_14		= byte ptr -14h
var_10		= dword	ptr -10h
var_C		= byte ptr -0Ch
var_8		= word ptr -8
var_6		= word ptr -6
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		sub	esp, 14h
		push	ebx
		mov	ebx, ecx
		push	ebp
		push	esi
		push	edi
		mov	eax, [ebx]
		xor	edi, edi
		lea	ebp, [eax+8]
		cmp	[eax], edi
		jle	short loc_1000E59D

loc_1000E540:				; CODE XREF: sub_1000E52C+6Fj
		lea	esi, [ebp+0Eh]
		push	esi
		call	dword_10031D58
		add	eax, eax
		mov	[esp+28h+var_4], esi
		cmp	[esp+28h+arg_0], 0
		pop	ecx
		mov	[esp+24h+var_8], ax
		mov	[esp+24h+var_6], ax
		jz	short loc_1000E577
		push	1
		push	[esp+28h+arg_0]
		lea	eax, [esp+2Ch+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000E59D

loc_1000E577:				; CODE XREF: sub_1000E52C+34j
		cmp	[esp+24h+arg_4], 0
		jz	short loc_1000E593
		push	1
		push	[esp+28h+arg_4]
		lea	eax, [esp+2Ch+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000E59D

loc_1000E593:				; CODE XREF: sub_1000E52C+50j
		mov	eax, [ebx]
		add	ebp, [ebp+0]
		inc	edi
		cmp	edi, [eax]
		jl	short loc_1000E540

loc_1000E59D:				; CODE XREF: sub_1000E52C+12j
					; sub_1000E52C+49j ...
		mov	ecx, [ebx]
		cmp	edi, [ecx]
		jz	short loc_1000E622
		cmp	byte ptr [ebp+0Ch], 0
		jz	short loc_1000E5AD
		xor	al, al
		jmp	short loc_1000E624
; ---------------------------------------------------------------------------

loc_1000E5AD:				; CODE XREF: sub_1000E52C+7Bj
		cmp	dword ptr [ebx+edi*4+4], 0
		jnz	short loc_1000E622
		mov	esi, [ebp+8]
		xor	edx, edx
		shl	esi, 6
		inc	edx
		add	esi, 10h
		push	ecx
		mov	ecx, esi
		call	sub_100142EE
		mov	[ebx+edi*4+4], eax
		pop	ecx
		test	eax, eax
		jz	short loc_1000E622
		mov	[eax], esi
		mov	eax, [ebx+edi*4+4]
		and	dword ptr [eax+0Ch], 0
		mov	ecx, [ebx+edi*4+4]
		mov	eax, [esp+24h+arg_8]
		mov	[ecx+8], eax
		mov	ecx, ebx
		mov	eax, [ebx+edi*4+4]
		mov	dword ptr [eax+4], 10h
		push	dword ptr [ebx+edi*4+4]
		push	ebp
		call	sub_1000E670
		mov	eax, [ebx+edi*4+4]
		mov	[esp+24h+var_10], eax
		lea	eax, [esp+24h+var_C]
		push	eax
		push	20h
		lea	eax, [esp+2Ch+var_14]
		mov	dword ptr [esp+2Ch+var_14], esi
		push	eax
		lea	eax, [esp+30h+var_10]
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D1C

loc_1000E622:				; CODE XREF: sub_1000E52C+75j
					; sub_1000E52C+86j ...
		mov	al, 1

loc_1000E624:				; CODE XREF: sub_1000E52C+7Fj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn	0Ch
sub_1000E52C	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E62E	proc near		; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+2Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	esi, esi
		mov	eax, [edi]
		mov	edx, [eax]
		test	edx, edx
		jle	short loc_1000E66B
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		lea	eax, [edi+4]

loc_1000E644:				; CODE XREF: sub_1000E62E+27j
		mov	ecx, [eax]
		test	ecx, ecx
		jz	short loc_1000E64F
		cmp	[ecx+8], ebx
		jz	short loc_1000E659

loc_1000E64F:				; CODE XREF: sub_1000E62E+1Aj
		inc	esi
		add	eax, 4
		cmp	esi, edx
		jl	short loc_1000E644
		jmp	short loc_1000E66A
; ---------------------------------------------------------------------------

loc_1000E659:				; CODE XREF: sub_1000E62E+1Fj
		mov	ecx, [edi+esi*4+4]
		xor	edx, edx
		inc	edx
		call	sub_10014324
		and	dword ptr [edi+esi*4+4], 0

loc_1000E66A:				; CODE XREF: sub_1000E62E+29j
		pop	ebx

loc_1000E66B:				; CODE XREF: sub_1000E62E+Cj
		pop	edi
		pop	esi
		retn	4
sub_1000E62E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E670	proc near		; CODE XREF: sub_1000E52C+CCp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		and	[esp+18h+arg_0], 0
		mov	[esp+18h+var_4], ecx
		mov	esi, [edi+4]
		add	esi, edi
		cmp	dword ptr [edi+8], 0
		jle	loc_1000E731
		mov	ebx, [esp+18h+arg_4]
		lea	ebp, [ebx+10h]

loc_1000E699:				; CODE XREF: sub_1000E670+BBj
		mov	eax, [edi]
		lea	ecx, [esi+10h]
		add	eax, edi
		cmp	ecx, eax
		jnb	loc_1000E73C
		push	dword ptr [esi+4]
		call	sub_1000E740
		mov	[esp+18h+arg_4], eax
		test	eax, eax
		jz	loc_1000E73C
		lea	ecx, [esi+10h]
		push	ecx
		call	dword_10031D54
		pop	ecx
		mov	ecx, [esi]
		lea	edx, [esi+11h]
		add	edx, eax
		add	ecx, esi
		mov	[esp+18h+var_8], edx
		cmp	edx, ecx
		jnb	short loc_1000E73C
		mov	eax, [edi]
		add	eax, edi
		cmp	edx, eax
		jnb	short loc_1000E73C
		mov	ecx, [esp+18h+arg_4]
		lea	eax, [esi+10h]
		push	0
		push	40h
		push	ebp
		push	dword ptr [esi+0Ch]
		mov	edx, [ecx]
		push	[esp+28h+var_8]
		push	eax
		mov	eax, [esp+30h+var_4]
		mov	eax, [eax]
		push	dword ptr [eax+4]
		push	dword ptr [ebx+8]
		call	dword ptr [edx+4]
		test	eax, eax
		js	short loc_1000E73C
		mov	eax, [esi+8]
		mov	ecx, [esp+18h+arg_0]
		mov	g_originals[eax*4], ebp
		add	ebp, 40h
		inc	dword ptr [ebx+0Ch]
		add	dword ptr [ebx+4], 40h
		add	esi, [esi]
		inc	ecx
		mov	[esp+18h+arg_0], ecx
		cmp	ecx, [edi+8]
		jl	loc_1000E699

loc_1000E731:				; CODE XREF: sub_1000E670+1Cj
		mov	al, 1

loc_1000E733:				; CODE XREF: sub_1000E670+CEj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_1000E73C:				; CODE XREF: sub_1000E670+32j
					; sub_1000E670+46j ...
		xor	al, al
		jmp	short loc_1000E733
sub_1000E670	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E740	proc near		; CODE XREF: sub_1000E670+3Bp

arg_0		= dword	ptr  4

		push	esi
		xor	esi, esi
		cmp	dword_10031F68,	esi
		jnz	short loc_1000E77D
		call	sub_10013DFD
		test	al, al
		jz	short loc_1000E777
		push	10h
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E777
		mov	dword ptr [eax], offset	off_1002C258
		mov	[eax+0Ch], esi
		mov	dword_10031F68,	eax
		jmp	short loc_1000E77D
; ---------------------------------------------------------------------------

loc_1000E777:				; CODE XREF: sub_1000E740+12j
					; sub_1000E740+25j
		mov	dword_10031F68,	esi

loc_1000E77D:				; CODE XREF: sub_1000E740+9j
					; sub_1000E740+35j
		cmp	dword_10031F70,	esi
		jnz	short loc_1000E7B4
		call	sub_10013DFD
		test	al, al
		jz	short loc_1000E7AE
		push	0Ch
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E7AE
		mov	dword ptr [eax], offset	off_1002C270
		mov	dword_10031F70,	eax
		jmp	short loc_1000E7B4
; ---------------------------------------------------------------------------

loc_1000E7AE:				; CODE XREF: sub_1000E740+4Cj
					; sub_1000E740+5Fj
		mov	dword_10031F70,	esi

loc_1000E7B4:				; CODE XREF: sub_1000E740+43j
					; sub_1000E740+6Cj
		mov	eax, dword_10031F64
		test	eax, eax
		jnz	short loc_1000E7E8
		call	sub_10013DFD
		test	al, al
		jz	short loc_1000E7E1
		push	0Ch
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		test	eax, eax
		jz	short loc_1000E7E1
		mov	dword ptr [eax], offset	off_1002C240
		jmp	short loc_1000E7E3
; ---------------------------------------------------------------------------

loc_1000E7E1:				; CODE XREF: sub_1000E740+84j
					; sub_1000E740+97j
		mov	eax, esi

loc_1000E7E3:				; CODE XREF: sub_1000E740+9Fj
		mov	dword_10031F64,	eax

loc_1000E7E8:				; CODE XREF: sub_1000E740+7Bj
		mov	ecx, [esp+4+arg_0]
		dec	ecx
		pop	esi
		dec	ecx
		jz	short loc_1000E802
		dec	ecx
		jz	short loc_1000E7FB
		dec	ecx
		jz	short locret_1000E807
		xor	eax, eax
		jmp	short locret_1000E807
; ---------------------------------------------------------------------------

loc_1000E7FB:				; CODE XREF: sub_1000E740+B2j
		mov	eax, dword_10031F70
		jmp	short locret_1000E807
; ---------------------------------------------------------------------------

loc_1000E802:				; CODE XREF: sub_1000E740+AFj
		mov	eax, dword_10031F68

locret_1000E807:			; CODE XREF: sub_1000E740+B5j
					; sub_1000E740+B9j ...
		retn	4
sub_1000E740	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000E80A	proc near		; CODE XREF: sub_10014DBC+1Bp

var_7C		= dword	ptr -7Ch
JobObjectInformation= dword ptr	-78h
var_74		= byte ptr -74h
var_68		= dword	ptr -68h
var_5C		= dword	ptr -5Ch
var_18		= dword	ptr -18h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		sub	esp, 7Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, ecx
		push	esi
		xor	esi, esi
		push	edi
		cmp	[ebx], esi
		jz	short loc_1000E82F
		mov	eax, 4DFh
		jmp	loc_1000E8FF
; ---------------------------------------------------------------------------

loc_1000E82F:				; CODE XREF: sub_1000E80A+19j
		push	esi		; lpName
		push	esi		; lpJobAttributes
		call	ds:CreateJobObjectW
		mov	edi, eax
		mov	[ebx], edi
		test	edi, edi
		jnz	short loc_1000E84A

loc_1000E83F:				; CODE XREF: sub_1000E80A+D1j
					; sub_1000E80A+EDj
		call	ds:GetLastError
		jmp	loc_1000E8FF
; ---------------------------------------------------------------------------

loc_1000E84A:				; CODE XREF: sub_1000E80A+33j
		push	6Ch		; size_t
		lea	eax, [ebp+var_74]
		mov	[ebp+JobObjectInformation], esi
		push	esi		; int
		push	eax		; void *
		call	memset
		mov	eax, [ebp+arg_0]
		add	esp, 0Ch
		mov	[ebp+var_7C], esi
		sub	eax, esi
		jz	short loc_1000E890
		dec	eax
		jz	short loc_1000E88B
		dec	eax
		jz	short loc_1000E886
		dec	eax
		jz	short loc_1000E881
		dec	eax
		jz	short loc_1000E87C
		mov	eax, 0A0h
		jmp	loc_1000E8FF
; ---------------------------------------------------------------------------

loc_1000E87C:				; CODE XREF: sub_1000E80A+66j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E8B1
; ---------------------------------------------------------------------------

loc_1000E881:				; CODE XREF: sub_1000E80A+63j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E8A8
; ---------------------------------------------------------------------------

loc_1000E886:				; CODE XREF: sub_1000E80A+60j
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E89B
; ---------------------------------------------------------------------------

loc_1000E88B:				; CODE XREF: sub_1000E80A+5Dj
		mov	eax, [ebp+var_68]
		jmp	short loc_1000E898
; ---------------------------------------------------------------------------

loc_1000E890:				; CODE XREF: sub_1000E80A+5Aj
		mov	eax, [ebp+var_68]
		or	eax, 400h

loc_1000E898:				; CODE XREF: sub_1000E80A+84j
		push	27h
		pop	esi

loc_1000E89B:				; CODE XREF: sub_1000E80A+7Fj
		or	esi, 10h
		mov	[ebp+var_5C], 1
		or	eax, 8

loc_1000E8A8:				; CODE XREF: sub_1000E80A+7Aj
		or	esi, 0C8h
		mov	[ebp+var_7C], esi

loc_1000E8B1:				; CODE XREF: sub_1000E80A+75j
		mov	ecx, [ebp+arg_C]
		test	ecx, ecx
		jz	short loc_1000E8C0
		or	eax, 100h
		mov	[ebp+var_18], ecx

loc_1000E8C0:				; CODE XREF: sub_1000E80A+ACj
		mov	esi, ds:SetInformationJobObject
		or	eax, 2000h
		push	70h		; cbJobObjectInformationLength
		mov	[ebp+var_68], eax
		lea	eax, [ebp+JobObjectInformation]
		push	eax		; lpJobObjectInformation
		push	9		; JobObjectInformationClass
		push	edi		; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jz	loc_1000E83F
		mov	eax, [ebp+arg_8]
		not	eax
		and	[ebp+var_7C], eax
		lea	eax, [ebp+var_7C]
		push	4		; cbJobObjectInformationLength
		push	eax		; lpJobObjectInformation
		push	4		; JobObjectInformationClass
		push	dword ptr [ebx]	; hJob
		call	esi ; SetInformationJobObject
		test	eax, eax
		jz	loc_1000E83F
		xor	eax, eax

loc_1000E8FF:				; CODE XREF: sub_1000E80A+20j
					; sub_1000E80A+3Bj ...
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_1000E80A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E912	proc near		; DATA XREF: .rdata:1002C2E0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C2D8
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_1000E92F
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1000E92F:				; CODE XREF: sub_1000E912+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1000E912	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000E935	proc near		; DATA XREF: .rdata:1002C2DCo

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 8
		jnz	short loc_1000E963
		mov	eax, offset _TargetCreateNamedPipeW@36 ; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000E963
		mov	ecx, [esp+arg_0]
		push	0Eh		; int
		push	offset a_targetcreat_3 ; "_TargetCreateNamedPipeW@36"
		push	2		; int
		push	offset aCreatenamedpip ; "CreateNamedPipeW"
		push	offset aKernel32_dll_0 ; "kernel32.dll"
		call	sub_1000D8D2
		jmp	short locret_1000E965
; ---------------------------------------------------------------------------

loc_1000E963:				; CODE XREF: sub_1000E935+5j
					; sub_1000E935+Ej
		xor	al, al

locret_1000E965:			; CODE XREF: sub_1000E935+2Cj
		retn	8
sub_1000E935	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1000E968(int, LPCWSTR lpName, DWORD	dwOpenMode, DWORD dwPipeMode, DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize, DWORD nDefaultTimeOut)
sub_1000E968	proc near		; DATA XREF: .rdata:1002C30Co

TargetHandle	= dword	ptr -0E8h
hTargetProcessHandle= dword ptr	-0E4h
var_E0		= dword	ptr -0E0h
var_DC		= dword	ptr -0DCh
var_D8		= dword	ptr -0D8h
var_D4		= dword	ptr -0D4h
var_D0		= dword	ptr -0D0h
var_CC		= dword	ptr -0CCh
var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= byte ptr -0C0h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
lpName		= dword	ptr  0Ch
dwOpenMode	= dword	ptr  10h
dwPipeMode	= dword	ptr  14h
nMaxInstances	= dword	ptr  18h
nOutBufferSize	= dword	ptr  1Ch
nInBufferSize	= dword	ptr  20h
nDefaultTimeOut	= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0ECh
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0ECh+var_4], eax
		mov	eax, [ebp+arg_0]
		push	ebx
		mov	ebx, [ebp+lpName]
		push	esi
		or	dword ptr [eax+18h], 0FFFFFFFFh
		push	edi
		push	5
		pop	esi
		mov	[esp+0F8h+hTargetProcessHandle], eax
		mov	[eax+10h], esi
		lea	eax, [esp+0F8h+var_D0]
		mov	[esp+0F8h+TargetHandle], ecx
		xor	ecx, ecx
		push	eax		; int
		push	ecx		; int
		mov	[esp+100h+var_E0], ecx
		mov	[esp+100h+var_D0], ecx
		mov	[esp+100h+var_CC], ecx
		mov	[esp+100h+var_C8], ecx
		mov	[esp+100h+var_DC], ecx
		mov	[esp+100h+var_D8], ecx
		mov	[esp+100h+var_D4], ecx
		mov	ecx, ebx	; int
		push	2Fh
		pop	edx
		call	sub_100034EC
		mov	edi, [esp+100h+var_D0]
		pop	ecx
		pop	ecx
		cmp	edi, [esp+0F8h+var_CC]
		jz	short loc_1000EA40

loc_1000E9D7:				; CODE XREF: sub_1000E968+D3j
		mov	eax, [esp+0F8h+var_E0]
		test	al, 2
		jz	short loc_1000E9EF
		and	eax, 0FFFFFFFDh
		lea	ecx, [esp+0F8h+var_C0]
		mov	[esp+0F8h+var_E0], eax
		call	sub_10001BED

loc_1000E9EF:				; CODE XREF: sub_1000E968+75j
		lea	eax, [esp+0F8h+var_DC]
		push	eax		; int
		push	ecx		; int
		push	5Ch
		pop	edx
		mov	ecx, edi	; int
		call	sub_100034EC
		mov	esi, [esp+100h+var_DC]
		pop	ecx
		pop	ecx
		jmp	short loc_1000EA2E
; ---------------------------------------------------------------------------

loc_1000EA07:				; CODE XREF: sub_1000E968+CAj
		mov	ecx, offset a__	; ".."
		call	sub_10001AF3
		push	eax
		push	offset a__	; ".."
		push	dword ptr [esi+10h]
		mov	ecx, esi
		push	0
		call	sub_10003F14
		test	eax, eax
		jz	loc_1000EB3A
		add	esi, 18h

loc_1000EA2E:				; CODE XREF: sub_1000E968+9Dj
		cmp	esi, [esp+0F8h+var_D8]
		jnz	short loc_1000EA07
		add	edi, 18h
		cmp	edi, [esp+0F8h+var_CC]
		jnz	short loc_1000E9D7
		push	5
		pop	esi

loc_1000EA40:				; CODE XREF: sub_1000E968+6Dj
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000EA4A
		mov	eax, [ebx]
		jmp	short loc_1000EA4C
; ---------------------------------------------------------------------------

loc_1000EA4A:				; CODE XREF: sub_1000E968+DCj
		mov	eax, ebx

loc_1000EA4C:				; CODE XREF: sub_1000E968+E0j
		mov	ecx, [esp+0F8h+TargetHandle]
		mov	[esp+0F8h+var_C4], eax
		lea	eax, [esp+0F8h+var_C4]
		mov	[esp+0F8h+var_8], eax
		lea	eax, [esp+0F8h+var_10]
		push	eax
		mov	ecx, [ecx+10h]
		push	8
		mov	[esp+100h+var_10], 1
		mov	[esp+100h+var_C], 1
		call	sub_10015070
		mov	edi, offset a_	; "\\\\.\\"
		mov	[esp+0F8h+TargetHandle], eax
		mov	ecx, edi
		call	sub_10001AF3
		push	eax
		push	edi
		push	4
		push	0
		mov	ecx, ebx
		call	sub_10003F14
		test	eax, eax
		jnz	short loc_1000EAC1
		mov	edi, offset a?	; "\\\\?\\"
		mov	ecx, edi
		call	sub_10001AF3
		push	eax		; int
		push	edi		; void *
		push	4		; int
		push	0		; int
		mov	ecx, ebx
		call	sub_10003F72

loc_1000EAC1:				; CODE XREF: sub_1000E968+13Ej
		cmp	[esp+0F8h+TargetHandle], 3
		mov	edi, [esp+0F8h+hTargetProcessHandle]
		mov	eax, [edi+4]
		jz	short loc_1000EAD5
		mov	eax, [esp+0F8h+hTargetProcessHandle]
		jmp	short loc_1000EB34
; ---------------------------------------------------------------------------

loc_1000EAD5:				; CODE XREF: sub_1000E968+165j
		cmp	dword ptr [ebx+14h], 8
		jb	short loc_1000EADD
		mov	ebx, [ebx]

loc_1000EADD:				; CODE XREF: sub_1000E968+171j
		mov	eax, [eax]
		push	0		; lpSecurityAttributes
		push	[ebp+nDefaultTimeOut] ;	nDefaultTimeOut
		mov	[esp+100h+hTargetProcessHandle], eax
		push	[ebp+nInBufferSize] ; nInBufferSize
		push	[ebp+nOutBufferSize] ; nOutBufferSize
		push	[ebp+nMaxInstances] ; nMaxInstances
		push	[ebp+dwPipeMode] ; dwPipeMode
		push	[ebp+dwOpenMode] ; dwOpenMode
		push	ebx		; lpName
		call	ds:CreateNamedPipeW
		or	ebx, 0FFFFFFFFh
		cmp	eax, ebx
		jnz	short loc_1000EB09

loc_1000EB05:				; CODE XREF: sub_1000E968+1C0j
		mov	eax, ebx
		jmp	short loc_1000EB34
; ---------------------------------------------------------------------------

loc_1000EB09:				; CODE XREF: sub_1000E968+19Bj
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	ecx, [esp+104h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[esp+108h+hTargetProcessHandle]	; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_1000EB05
		mov	eax, [esp+0F8h+TargetHandle]
		cmp	eax, ebx
		jz	short loc_1000EB34
		xor	esi, esi

loc_1000EB34:				; CODE XREF: sub_1000E968+16Bj
					; sub_1000E968+19Fj ...
		mov	[edi+10h], esi
		mov	[edi+18h], eax

loc_1000EB3A:				; CODE XREF: sub_1000E968+BDj
		lea	ecx, [esp+0F8h+var_DC]
		call	sub_1000394E
		lea	ecx, [esp+0F8h+var_D0]
		call	sub_1000394E
		mov	ecx, [esp+0F8h+var_4]
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	20h
sub_1000E968	endp

; Exported entry  17. _TargetCreateNamedPipeW@36

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateNamedPipeW(x, x, x, x, x, x, x,	x, x)
		public _TargetCreateNamedPipeW@36
_TargetCreateNamedPipeW@36 proc	near	; DATA XREF: sub_1000E935+7o
					; .rdata:off_1002E058o

var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= byte ptr -40h
dwErrCode	= dword	ptr -3Ch
var_34		= dword	ptr -34h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_18]
		mov	edx, [ebp+arg_14]
		and	[esp+74h+var_10], 0
		push	ebx
		mov	ebx, [ebp+arg_8]
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[esp+80h+var_48], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+80h+var_54], ebx
		mov	[esp+80h+var_50], ebx
		mov	ebx, [ebp+arg_20]
		push	ebx
		mov	[esp+84h+var_64], eax
		mov	[esp+84h+var_70], eax
		mov	eax, [ebp+arg_1C]
		push	eax
		push	ecx
		push	edx
		push	esi
		push	edi
		mov	[esp+98h+var_5C], ebx
		mov	ebx, [esp+98h+var_54]
		push	ebx
		push	[esp+9Ch+var_64]
		mov	[esp+0A0h+var_58], edi
		mov	[esp+0A0h+var_60], esi
		mov	[esp+0A0h+var_68], edx
		mov	[esp+0A0h+var_6C], ecx
		mov	[esp+0A0h+var_4C], eax
		call	[esp+0A0h+var_48]
		or	ebx, 0FFFFFFFFh
		cmp	eax, ebx
		jnz	loc_1000ECD5
		mov	edx, [esp+80h+var_70]
		mov	ecx, offset aCreatenamedpip ; "CreateNamedPipeW"
		call	sub_100029FE
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_1000ECD3
		call	ds:GetLastError
		cmp	[esp+80h+var_5C], 0
		mov	edi, eax
		jnz	loc_1000ECD3
		call	sub_10013DEB
		mov	esi, eax
		test	esi, esi
		jz	loc_1000ECCC
		xor	ecx, ecx
		lea	eax, [esp+80h+var_70]
		inc	ecx
		mov	[esp+80h+var_8], eax
		mov	[esp+80h+var_10], ecx
		lea	edx, [esp+80h+var_10]
		mov	[esp+80h+var_C], ecx
		push	8
		pop	ecx
		call	sub_10010168
		test	al, al
		jz	loc_1000ECCC
		mov	eax, [esi+8]
		and	[esp+80h+var_44], 0
		add	eax, esi
		push	30h		; size_t
		mov	[esp+84h+var_C], eax
		lea	eax, [esp+84h+var_40]
		push	0		; int
		push	eax		; void *
		mov	[esp+8Ch+var_10], esi
		call	memset
		add	esp, 0Ch
		lea	eax, [esp+80h+var_44]
		lea	ecx, [esp+80h+var_10]
		push	eax		; int
		lea	eax, [esp+84h+var_4C]
		push	eax		; void *
		lea	eax, [esp+88h+var_6C]
		push	eax		; void *
		lea	eax, [esp+8Ch+var_68]
		push	eax		; void *
		lea	eax, [esp+90h+var_60]
		push	eax		; void *
		lea	eax, [esp+94h+var_58]
		push	eax		; void *
		lea	eax, [esp+98h+var_50]
		push	eax		; void *
		lea	eax, [esp+9Ch+var_70]
		push	eax		; int
		call	sub_1000ECE9
		add	esp, 20h
		test	eax, eax
		jnz	short loc_1000ECCC
		push	[esp+80h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+80h+dwErrCode], 0
		jnz	short loc_1000ECD3
		mov	edx, [esp+80h+var_70]
		mov	ecx, offset aCreatenamedpip ; "CreateNamedPipeW"
		call	sub_10002AFD
		mov	eax, [esp+80h+var_34]
		jmp	short loc_1000ECD5
; ---------------------------------------------------------------------------

loc_1000ECCC:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+BAj
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+E1j ...
		push	edi		; dwErrCode
		call	ds:SetLastError

loc_1000ECD3:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+98j
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+ABj ...
		mov	eax, ebx

loc_1000ECD5:				; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+7Bj
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+165j
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	24h
_TargetCreateNamedPipeW@36 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1000ECE9(int,	void *,	void *,	void *,	void *,	void *,	void *,	int)
sub_1000ECE9	proc near		; CODE XREF: TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+136p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1000ED01
		push	4
		pop	eax
		jmp	loc_1000EDFD
; ---------------------------------------------------------------------------

loc_1000ED01:				; CODE XREF: sub_1000ECE9+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 8
		inc	ebp
		mov	dword ptr [edi+3Ch], 7
		push	ebp		; int
		mov	dword ptr [edi+44h], 0A0h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000B1A3
		test	al, al
		jnz	short loc_1000ED4B
		push	4
		pop	eax
		jmp	loc_1000EDFB
; ---------------------------------------------------------------------------

loc_1000ED4B:				; CODE XREF: sub_1000ECE9+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B1A3
		test	al, al
		jz	loc_1000EDF9
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, edi
		push	2		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000EDF9
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	3		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000EDF9
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000EDF9
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000EDF9
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_18] ; void	*
		mov	ecx, edi
		push	6		; int
		call	sub_1000B1A3
		test	al, al
		jz	short loc_1000EDF9
		push	[esp+14h+arg_1C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1000EDF9
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1000EDF9:				; CODE XREF: sub_1000ECE9+78j
					; sub_1000ECE9+92j ...
		mov	eax, esi

loc_1000EDFB:				; CODE XREF: sub_1000ECE9+5Dj
		pop	esi
		pop	ebp

loc_1000EDFD:				; CODE XREF: sub_1000ECE9+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_1000ECE9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EE01	proc near		; CODE XREF: sub_10015277+11Bp

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		push	ebx
		push	esi
		mov	esi, ecx
		cmp	edx, 6
		jz	short loc_1000EE14
		xor	al, al
		jmp	short loc_1000EE50
; ---------------------------------------------------------------------------

loc_1000EE14:				; CODE XREF: sub_1000EE01+Dj
		push	3
		lea	ecx, [ebp+var_14]
		call	sub_1000F98B
		xor	ebx, ebx
		inc	ebx
		push	ebx
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_14]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1000EE44
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	8
		call	sub_1000F6EE
		test	al, al
		jnz	short loc_1000EE46

loc_1000EE44:				; CODE XREF: sub_1000EE01+2Fj
		xor	bl, bl

loc_1000EE46:				; CODE XREF: sub_1000EE01+41j
		lea	ecx, [ebp+var_14]
		call	sub_1000FDA2
		mov	al, bl

loc_1000EE50:				; CODE XREF: sub_1000EE01+11j
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EE01	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000EE56	proc near		; CODE XREF: sub_10015127+122p

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
phModule	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		push	offset aNtdll_dll_1 ; "ntdll.dll"
		mov	esi, ecx
		call	ds:GetModuleHandleW
		push	offset aLdrgetdllhandl ; "LdrGetDllHandle"
		lea	ecx, [ebp+var_C]
		mov	[ebp+phModule],	eax
		mov	[ebp+var_C], offset off_1001AA20
		mov	[ebp+var_8], eax
		call	sub_1000579F
		test	eax, eax
		jz	short loc_1000EE95
		lea	ecx, [ebp+phModule]
		push	ecx		; phModule
		push	eax		; lpModuleName
		push	6		; dwFlags
		call	ds:GetModuleHandleExW

loc_1000EE95:				; CODE XREF: sub_1000EE56+30j
		push	offset aNtallocatevirt ; "NtAllocateVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	g_nt, eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtclose	; "NtClose"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D0C,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtduplicateobj ; "NtDuplicateObject"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D10,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtfreevirtualm ; "NtFreeVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D14,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtmapviewofsec ; "NtMapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D18,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtprotectvirtu ; "NtProtectVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D1C,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtqueryinforma ; "NtQueryInformationProcess"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D20,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtqueryobject ;	"NtQueryObject"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D24,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtquerysection ; "NtQuerySection"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D28,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtqueryvirtual ; "NtQueryVirtualMemory"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D2C,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aNtunmapviewofs ; "NtUnmapViewOfSection"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D30,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlallocatehea ; "RtlAllocateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D34,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlansistringt ; "RtlAnsiStringToUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D38,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlcompareunic ; "RtlCompareUnicodeString"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D3C,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlcreateheap ;	"RtlCreateHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D40,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlcreateusert ; "RtlCreateUserThread"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D44,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtldestroyheap ; "RtlDestroyHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D48,	eax
		test	eax, eax
		jz	loc_1000F0D8
		push	offset aRtlfreeheap ; "RtlFreeHeap"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D4C,	eax
		test	eax, eax
		jz	short loc_1000F0D8
		push	offset a_strnicmp ; "_strnicmp"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D50,	eax
		test	eax, eax
		jz	short loc_1000F0D8
		push	offset aStrlen	; "strlen"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D54,	eax
		test	eax, eax
		jz	short loc_1000F0D8
		push	offset aWcslen	; "wcslen"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D58,	eax
		test	eax, eax
		jz	short loc_1000F0D8
		push	offset aMemcpy	; "memcpy"
		lea	ecx, [ebp+var_C]
		call	sub_1000579F
		mov	dword_10031D5C,	eax
		test	eax, eax
		jz	short loc_1000F0D8
		push	58h		; nSize
		push	offset g_nt	; lpBuffer
		push	offset aG_nt_0	; "g_nt"
		mov	ecx, esi
		call	sub_10017AD9
		neg	eax
		sbb	al, al
		inc	al
		jmp	short loc_1000F0DA
; ---------------------------------------------------------------------------

loc_1000F0D8:				; CODE XREF: sub_1000EE56+53j
					; sub_1000EE56+6Dj ...
		xor	al, al

loc_1000F0DA:				; CODE XREF: sub_1000EE56+280j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1000EE56	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F0DF	proc near		; CODE XREF: sub_10015127+10Ap
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	edi, edi
		mov	eax, offset _TargetNtOpenThread@20 ; TargetNtOpenThread(x,x,x,x,x)
		xor	ebx, ebx
		inc	edi
		mov	esi, ecx
		mov	ebp, offset aNtdll_dll_1 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_1000F10E
		push	5		; int
		push	offset a_targetntope_8 ; "_TargetNtOpenThread@20"
		push	edi		; int
		push	offset aNtopenthread ; "NtOpenThread"
		push	ebp		; void *
		call	sub_1000D8D2
		jmp	short loc_1000F110
; ---------------------------------------------------------------------------

loc_1000F10E:				; CODE XREF: sub_1000F0DF+18j
		mov	al, bl

loc_1000F110:				; CODE XREF: sub_1000F0DF+2Dj
		test	al, al
		jz	loc_1000F216
		mov	eax, offset _TargetNtOpenProcess@20 ; TargetNtOpenProcess(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F138
		push	6		; int
		push	offset a_targetntope_9 ; "_TargetNtOpenProcess@20"
		push	edi		; int
		push	offset aNtopenprocess ;	"NtOpenProcess"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		jmp	short loc_1000F13A
; ---------------------------------------------------------------------------

loc_1000F138:				; CODE XREF: sub_1000F0DF+40j
		mov	al, bl

loc_1000F13A:				; CODE XREF: sub_1000F0DF+57j
		test	al, al
		jz	loc_1000F216
		mov	eax, offset _TargetNtOpenProcessToken@16 ; TargetNtOpenProcessToken(x,x,x,x)
		test	eax, eax
		jz	short loc_1000F162
		push	7		; int
		push	offset a_targetntop_10 ; "_TargetNtOpenProcessToken@16"
		push	edi		; int
		push	offset aNtopenprocesst ; "NtOpenProcessToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		jmp	short loc_1000F164
; ---------------------------------------------------------------------------

loc_1000F162:				; CODE XREF: sub_1000F0DF+6Aj
		mov	al, bl

loc_1000F164:				; CODE XREF: sub_1000F0DF+81j
		test	al, al
		jz	loc_1000F216
		mov	eax, offset _TargetNtSetInformationThread@20 ; TargetNtSetInformationThread(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F18C
		push	2		; int
		push	offset a_targetntset_2 ; "_TargetNtSetInformationThread@20"
		push	edi		; int
		push	offset aNtsetinforma_0 ; "NtSetInformationThread"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		jmp	short loc_1000F18E
; ---------------------------------------------------------------------------

loc_1000F18C:				; CODE XREF: sub_1000F0DF+94j
		mov	al, bl

loc_1000F18E:				; CODE XREF: sub_1000F0DF+ABj
		test	al, al
		jz	loc_1000F216
		mov	eax, offset _TargetNtOpenThreadToken@20	; TargetNtOpenThreadToken(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F1B6
		push	3		; int
		push	offset a_targetntop_11 ; "_TargetNtOpenThreadToken@20"
		push	edi		; int
		push	offset aNtopenthreadto ; "NtOpenThreadToken"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		jmp	short loc_1000F1B8
; ---------------------------------------------------------------------------

loc_1000F1B6:				; CODE XREF: sub_1000F0DF+BEj
		mov	al, bl

loc_1000F1B8:				; CODE XREF: sub_1000F0DF+D5j
		test	al, al
		jz	short loc_1000F216
		call	sub_100063D2
		cmp	dword ptr [eax], 1
		jl	short loc_1000F212
		mov	eax, offset _TargetNtOpenProcessTokenEx@20 ; TargetNtOpenProcessTokenEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F1E7
		push	8		; int
		push	offset a_targetntop_12 ; "_TargetNtOpenProcessTokenEx@20"
		push	1		; int
		push	offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		jmp	short loc_1000F1E9
; ---------------------------------------------------------------------------

loc_1000F1E7:				; CODE XREF: sub_1000F0DF+EEj
		mov	al, bl

loc_1000F1E9:				; CODE XREF: sub_1000F0DF+106j
		test	al, al
		jz	short loc_1000F216
		mov	eax, offset _TargetNtOpenThreadTokenEx@24 ; TargetNtOpenThreadTokenEx(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_1000F20E
		push	4		; int
		push	offset a_targetntop_13 ; "_TargetNtOpenThreadTokenEx@24"
		push	1		; int
		push	offset aNtopenthread_0 ; "NtOpenThreadTokenEx"
		push	ebp		; void *
		mov	ecx, esi
		call	sub_1000D8D2
		mov	bl, al

loc_1000F20E:				; CODE XREF: sub_1000F0DF+115j
		mov	al, bl
		jmp	short loc_1000F218
; ---------------------------------------------------------------------------

loc_1000F212:				; CODE XREF: sub_1000F0DF+E5j
		mov	al, 1
		jmp	short loc_1000F218
; ---------------------------------------------------------------------------

loc_1000F216:				; CODE XREF: sub_1000F0DF+33j
					; sub_1000F0DF+5Dj ...
		xor	al, al

loc_1000F218:				; CODE XREF: sub_1000F0DF+131j
					; sub_1000F0DF+135j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_1000F0DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F21E	proc near		; CODE XREF: sub_1000F491+34p
					; sub_1000FA3A+50p

var_BC		= byte ptr -0BCh
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 0C0h
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		xor	ebx, ebx
		mov	eax, 0FFFFh
		mov	[ebp+var_8], ebx
		cmp	eax, esi
		push	edi
		sbb	eax, eax
		mov	edi, ecx
		and	eax, 2
		jz	short loc_1000F264
		push	3
		push	1Ch
		push	offset aCBuildsMoz2__1 ; "c:\\builds\\moz2_slave\\rel-m-rel-w32_b"...
		lea	ecx, [ebp+var_BC]
		inc	ebx
		call	sub_10001B48
		mov	edx, offset aCheckFailedIsv ; "Check failed: IsValueInRangeForNumericT"...
		lea	ecx, [eax+8]
		call	sub_10002847

loc_1000F264:				; CODE XREF: sub_1000F21E+22j
		test	bl, 1
		jz	short loc_1000F274
		lea	ecx, [ebp+var_BC]
		call	sub_10001BED

loc_1000F274:				; CODE XREF: sub_1000F21E+49j
		mov	[edi+6], si
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1000F21E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F281	proc near		; CODE XREF: sub_1000F35E+97p
					; sub_1000F35E+A8p ...

arg_0		= dword	ptr  4

		lea	eax, [edx+edx]
		push	esi
		mov	esi, [esp+4+arg_0]
		mov	[esi+4], ecx
		mov	[esi], ax
		cmp	edx, 0FFFCh
		jbe	short loc_1000F29B
		xor	al, al
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_1000F29B:				; CODE XREF: sub_1000F281+14j
		test	ecx, ecx
		jz	short loc_1000F2A7
		movzx	eax, ax
		add	eax, 2
		jmp	short loc_1000F2A9
; ---------------------------------------------------------------------------

loc_1000F2A7:				; CODE XREF: sub_1000F281+1Cj
		xor	eax, eax

loc_1000F2A9:				; CODE XREF: sub_1000F281+24j
		mov	[esi+2], ax
		mov	al, 1
		pop	esi
		retn
sub_1000F281	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_1000F2B1(int, LPCWSTR lpString, int, int, int)
sub_1000F2B1	proc near		; CODE XREF: sub_1000FA3A+B6p
					; sub_1000FA3A+DEp

lpString	= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+10h+lpString]
		xor	eax, eax
		mov	ebx, ecx
		test	edi, edi
		jz	loc_1000F357
		cmp	ax, [edi]
		jz	loc_1000F355
		push	edi		; lpString
		call	ds:lstrlenW
		xor	ebp, ebp
		mov	[esp+10h+lpString], eax
		push	ebp
		push	[esp+14h+arg_10]
		mov	ecx, ebx
		push	5
		call	sub_1000F491
		mov	esi, eax
		test	esi, esi
		jz	short loc_1000F355
		mov	ecx, edi
		lea	edx, [ecx+2]

loc_1000F2F4:				; CODE XREF: sub_1000F2B1+4Cj
		mov	ax, [ecx]
		add	ecx, 2
		cmp	ax, bp
		jnz	short loc_1000F2F4
		sub	ecx, edx
		sar	ecx, 1
		lea	ebp, ds:2[ecx*2]
		mov	ecx, [ebx+4]
		mov	eax, ecx
		sub	eax, [ebx]
		cmp	eax, ebp
		jb	short loc_1000F355
		sub	ecx, ebp
		mov	[ebx+4], ecx
		test	cl, 1
		jz	short loc_1000F325
		call	ds:DebugBreak

loc_1000F325:				; CODE XREF: sub_1000F2B1+6Cj
		push	ebp		; size_t
		push	edi		; void *
		push	dword ptr [ebx+4] ; void *
		call	memcpy
		mov	eax, [ebx+4]
		add	esp, 0Ch
		sub	eax, esi
		jz	short loc_1000F355
		mov	[esi+8], eax
		mov	eax, [esp+10h+lpString]
		mov	[esi+0Ch], eax
		mov	eax, [esp+10h+arg_8]
		mov	[esi+10h], eax
		mov	eax, [esp+10h+arg_C]
		mov	[esi+14h], eax
		mov	eax, esi
		jmp	short loc_1000F357
; ---------------------------------------------------------------------------

loc_1000F355:				; CODE XREF: sub_1000F2B1+17j
					; sub_1000F2B1+3Cj ...
		xor	eax, eax

loc_1000F357:				; CODE XREF: sub_1000F2B1+Ej
					; sub_1000F2B1+A2j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	14h
sub_1000F2B1	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F35E	proc near		; CODE XREF: sub_1000F557+39p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebx
		push	ebp
		mov	ebp, [esp+20h+arg_0]
		push	esi
		push	edi
		test	ebp, ebp
		jz	loc_1000F486
		cmp	dword ptr [edx], 1
		jnz	loc_1000F486
		mov	eax, [edx+4]
		mov	esi, [ecx+0Ch]
		mov	edi, [ecx+10h]
		mov	edx, [eax]
		mov	eax, [ecx+14h]
		mov	[esp+28h+var_14], eax
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	ecx, [ebp+0]
		mov	[esp+28h+arg_0], eax
		lea	eax, [edx+ecx*2]
		push	eax
		mov	[esp+2Ch+var_18], eax
		call	dword_10031D58
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_1000F3B5

loc_1000F3AD:				; CODE XREF: sub_1000F35E+59j
					; sub_1000F35E+83j ...
		xor	eax, eax
		inc	eax
		jmp	loc_1000F489
; ---------------------------------------------------------------------------

loc_1000F3B5:				; CODE XREF: sub_1000F35E+4Dj
		cmp	esi, ebx
		jg	short loc_1000F3AD
		mov	ecx, [esp+28h+var_14]
		mov	al, cl
		and	al, 1
		mov	byte ptr [esp+28h+var_14], al
		test	edi, edi
		js	short loc_1000F430
		cmp	edi, 0FFFFFh
		jnz	short loc_1000F3D7
		mov	edi, ebx
		sub	edi, esi
		jmp	short loc_1000F3E3
; ---------------------------------------------------------------------------

loc_1000F3D7:				; CODE XREF: sub_1000F35E+71j
		test	cl, 2
		jz	short loc_1000F3E3
		lea	eax, [esi+edi]
		cmp	eax, ebx
		jnz	short loc_1000F3AD

loc_1000F3E3:				; CODE XREF: sub_1000F35E+77j
					; sub_1000F35E+7Cj
		lea	eax, [esi+edi]
		cmp	eax, ebx
		jg	short loc_1000F3AD
		mov	ecx, [esp+28h+arg_0]
		lea	eax, [esp+28h+var_8]
		push	eax
		mov	edx, esi
		call	sub_1000F281
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	eax, [esp+30h+var_18]
		lea	ecx, [eax+edi*2]
		call	sub_1000F281
		add	esp, 8
		lea	eax, [esp+28h+var_10]
		push	[esp+28h+var_14]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jnz	short loc_1000F3AD
		lea	eax, [esi+edi]

loc_1000F429:				; CODE XREF: sub_1000F35E+126j
		add	[ebp+0], eax
		xor	eax, eax
		jmp	short loc_1000F489
; ---------------------------------------------------------------------------

loc_1000F430:				; CODE XREF: sub_1000F35E+69j
		mov	ecx, [esp+28h+arg_0]
		lea	eax, [esp+28h+var_8]
		push	eax
		mov	edx, esi
		call	sub_1000F281
		mov	edi, [esp+2Ch+var_18]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		mov	ecx, edi
		call	sub_1000F281
		add	esp, 8

loc_1000F453:				; CODE XREF: sub_1000F35E+115j
		push	[esp+28h+var_14]
		lea	eax, [esp+2Ch+var_10]
		push	eax
		lea	eax, [esp+30h+var_8]
		push	eax
		call	dword_10031D3C
		test	eax, eax
		jz	short loc_1000F47A
		add	[esp+28h+var_C], 2
		dec	ebx
		cmp	ebx, esi
		jge	short loc_1000F453
		jmp	loc_1000F3AD
; ---------------------------------------------------------------------------

loc_1000F47A:				; CODE XREF: sub_1000F35E+10Bj
		mov	eax, [esp+28h+var_C]
		sub	eax, edi
		sar	eax, 1
		add	eax, esi
		jmp	short loc_1000F429
; ---------------------------------------------------------------------------

loc_1000F486:				; CODE XREF: sub_1000F35E+Dj
					; sub_1000F35E+16j
		push	2
		pop	eax

loc_1000F489:				; CODE XREF: sub_1000F35E+52j
					; sub_1000F35E+D0j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn
sub_1000F35E	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F491	proc near		; CODE XREF: sub_1000F2B1+33p
					; sub_1000F6EE+1Fp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= word ptr  0Ch

		mov	edx, ecx
		push	esi
		push	edi
		mov	eax, [edx+4]
		mov	esi, [edx]
		sub	eax, esi
		cmp	eax, 18h
		jnb	short loc_1000F4A5
		xor	eax, eax
		jmp	short loc_1000F4D5
; ---------------------------------------------------------------------------

loc_1000F4A5:				; CODE XREF: sub_1000F491+Ej
		test	esi, esi
		jz	short loc_1000F4B4
		push	6
		pop	ecx
		xor	eax, eax
		mov	edi, esi
		rep stosd
		jmp	short loc_1000F4B6
; ---------------------------------------------------------------------------

loc_1000F4B4:				; CODE XREF: sub_1000F491+16j
		xor	esi, esi

loc_1000F4B6:				; CODE XREF: sub_1000F491+21j
		add	dword ptr [edx], 18h
		mov	ecx, [esp+8+arg_0]
		push	[esp+8+arg_4]
		mov	[esi], ecx
		mov	ecx, esi
		call	sub_1000F21E
		mov	cx, [esp+8+arg_8]
		mov	eax, esi
		mov	[esi+4], cx

loc_1000F4D5:				; CODE XREF: sub_1000F491+12j
		pop	edi
		pop	esi
		retn	0Ch
sub_1000F491	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F4DA	proc near		; CODE XREF: sub_1000F602+8Ap

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		mov	eax, [esp+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		test	eax, eax
		jnz	short loc_1000F4EB

loc_1000F4E6:				; CODE XREF: sub_1000F4DA+23j
		push	2
		pop	eax
		jmp	short loc_1000F552
; ---------------------------------------------------------------------------

loc_1000F4EB:				; CODE XREF: sub_1000F4DA+Aj
		movzx	ecx, word ptr [edi+4]
		xor	edx, edx
		test	cx, cx
		js	short loc_1000F502
		movsx	ecx, cx
		cmp	ecx, [esp+8+arg_4]
		jnb	short loc_1000F4E6
		lea	edx, [eax+ecx*8]

loc_1000F502:				; CODE XREF: sub_1000F4DA+1Aj
		mov	esi, [esp+8+arg_8]
		mov	ecx, edi
		push	esi
		push	edx
		call	sub_1000F557
		movzx	ecx, word ptr [edi+6]
		xor	edx, edx
		cmp	dx, cx
		jz	short loc_1000F552
		test	cl, 1
		jz	short loc_1000F537
		test	eax, eax
		jnz	short loc_1000F526
		inc	eax
		jmp	short loc_1000F537
; ---------------------------------------------------------------------------

loc_1000F526:				; CODE XREF: sub_1000F4DA+47j
		cmp	eax, 1
		jnz	short loc_1000F52F
		xor	eax, eax
		jmp	short loc_1000F537
; ---------------------------------------------------------------------------

loc_1000F52F:				; CODE XREF: sub_1000F4DA+4Fj
		cmp	eax, 2
		jz	short loc_1000F537
		push	2
		pop	eax

loc_1000F537:				; CODE XREF: sub_1000F4DA+43j
					; sub_1000F4DA+4Aj ...
		test	esi, esi
		jz	short loc_1000F552
		test	cl, 2
		jz	short loc_1000F545
		and	[esi], edx
		and	[esi+4], edx

loc_1000F545:				; CODE XREF: sub_1000F4DA+64j
		test	byte ptr [edi+6], 4
		jz	short loc_1000F552
		mov	dword ptr [esi+4], 4

loc_1000F552:				; CODE XREF: sub_1000F4DA+Fj
					; sub_1000F4DA+3Ej ...
		pop	edi
		pop	esi
		retn	0Ch
sub_1000F4DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F557	proc near		; CODE XREF: sub_1000F4DA+30p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		xor	edx, edx
		mov	eax, [esi]
		sub	eax, edx
		jz	loc_1000F5F9
		dec	eax
		jz	loc_1000F5F5
		dec	eax
		jz	short loc_1000F5D5
		dec	eax
		jz	short loc_1000F5B1
		dec	eax
		jz	short loc_1000F598
		dec	eax
		jz	short loc_1000F58A
		dec	eax
		jz	short loc_1000F585
		push	2
		pop	eax
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F585:				; CODE XREF: sub_1000F557+27j
		mov	eax, [esi+8]
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F58A:				; CODE XREF: sub_1000F557+24j
		push	[ebp+arg_4]
		mov	edx, [ebp+arg_0]
		call	sub_1000F35E
		pop	ecx
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F598:				; CODE XREF: sub_1000F557+21j
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jnz	short loc_1000F5F1
		mov	eax, [eax+4]
		mov	ecx, [esi+8]
		and	ecx, [eax]
		neg	ecx
		sbb	ecx, ecx
		inc	ecx
		jmp	short loc_1000F5F1
; ---------------------------------------------------------------------------

loc_1000F5B1:				; CODE XREF: sub_1000F557+1Ej
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jnz	short loc_1000F5CF
		mov	eax, [eax+4]
		mov	eax, [eax]
		cmp	[esi+8], eax
		ja	short loc_1000F5CA
		cmp	[esi+0Ch], eax
		jnb	short loc_1000F5D1

loc_1000F5CA:				; CODE XREF: sub_1000F557+6Cj
		xor	edx, edx
		inc	edx
		jmp	short loc_1000F5D1
; ---------------------------------------------------------------------------

loc_1000F5CF:				; CODE XREF: sub_1000F557+62j
		mov	edx, ecx

loc_1000F5D1:				; CODE XREF: sub_1000F557+71j
					; sub_1000F557+76j
		mov	eax, edx
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F5D5:				; CODE XREF: sub_1000F557+1Bj
		mov	eax, [ebp+arg_0]
		push	2
		pop	ecx
		cmp	[eax], ecx
		jz	short loc_1000F5E4
		cmp	dword ptr [eax], 4
		jnz	short loc_1000F5F1

loc_1000F5E4:				; CODE XREF: sub_1000F557+86j
		mov	eax, [eax+4]
		xor	ecx, ecx
		mov	eax, [eax]
		cmp	[esi+8], eax
		setnz	cl

loc_1000F5F1:				; CODE XREF: sub_1000F557+49j
					; sub_1000F557+58j ...
		mov	eax, ecx
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F5F5:				; CODE XREF: sub_1000F557+14j
		xor	eax, eax
		jmp	short loc_1000F5FC
; ---------------------------------------------------------------------------

loc_1000F5F9:				; CODE XREF: sub_1000F557+Dj
		xor	eax, eax
		inc	eax

loc_1000F5FC:				; CODE XREF: sub_1000F557+2Cj
					; sub_1000F557+31j ...
		pop	esi
		pop	ecx
		pop	ebp
		retn	8
sub_1000F557	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000F602	proc near		; CODE XREF: sub_10010168+66p
					; sub_10015070+57p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 14h
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		mov	eax, [esi+8]
		test	eax, eax
		jz	loc_1000F6E3
		xor	edx, edx
		cmp	[eax], edx
		jz	loc_1000F6E3
		mov	[esi], edx
		mov	ecx, edx
		mov	dword ptr [esi+4], 1
		mov	bh, dl
		mov	eax, [eax]
		mov	bl, dl
		mov	[esp+20h+var_8], edx
		mov	edi, edx
		mov	[esp+20h+var_4], ecx
		mov	[esp+20h+var_C], eax
		test	eax, eax
		jz	loc_1000F6E3
		mov	[esp+20h+var_10], edx

loc_1000F650:				; CODE XREF: sub_1000F602+CCj
		mov	eax, [esi+8]
		add	edx, eax
		test	bl, bl
		jz	short loc_1000F67E
		cmp	dword ptr [edx+4], 6
		jnz	short loc_1000F676
		and	[esp+20h+var_8], 0
		mov	eax, ecx
		xor	ecx, ecx
		xor	bl, bl
		cmp	eax, 4
		mov	[esp+20h+var_4], ecx
		setnz	al
		jmp	short loc_1000F67A
; ---------------------------------------------------------------------------

loc_1000F676:				; CODE XREF: sub_1000F602+5Bj
		mov	bl, 1
		mov	al, bl

loc_1000F67A:				; CODE XREF: sub_1000F602+72j
		test	al, al
		jnz	short loc_1000F6BE

loc_1000F67E:				; CODE XREF: sub_1000F602+55j
		lea	eax, [esp+20h+var_8]
		push	eax
		push	[ebp+arg_8]
		lea	ecx, [edx+4]
		push	[ebp+arg_4]
		call	sub_1000F4DA
		mov	ecx, eax
		sub	eax, 0
		jz	short loc_1000F6B1
		dec	eax
		jz	short loc_1000F6A4
		dec	eax
		jnz	short loc_1000F6D9
		mov	ecx, [esp+20h+var_4]
		jmp	short loc_1000F6BE
; ---------------------------------------------------------------------------

loc_1000F6A4:				; CODE XREF: sub_1000F602+97j
		mov	ecx, [esp+20h+var_4]
		xor	bh, bh
		cmp	ecx, 4
		jz	short loc_1000F6BE
		jmp	short loc_1000F6BC
; ---------------------------------------------------------------------------

loc_1000F6B1:				; CODE XREF: sub_1000F602+94j
		mov	ecx, [esp+20h+var_4]
		mov	bh, 1
		cmp	ecx, 4
		jnz	short loc_1000F6BE

loc_1000F6BC:				; CODE XREF: sub_1000F602+ADj
		mov	bl, 1

loc_1000F6BE:				; CODE XREF: sub_1000F602+7Aj
					; sub_1000F602+A0j ...
		mov	edx, [esp+20h+var_10]
		inc	edi
		add	edx, 18h
		mov	[esp+20h+var_10], edx
		cmp	edi, [esp+20h+var_C]
		jnz	short loc_1000F650
		test	bh, bh
		jz	short loc_1000F6E3
		push	2
		pop	eax
		jmp	short loc_1000F6E5
; ---------------------------------------------------------------------------

loc_1000F6D9:				; CODE XREF: sub_1000F602+9Aj
		xor	eax, eax
		mov	[esi], edi
		mov	[esi+4], ecx
		inc	eax
		jmp	short loc_1000F6E5
; ---------------------------------------------------------------------------

loc_1000F6E3:				; CODE XREF: sub_1000F602+13j
					; sub_1000F602+1Dj ...
		xor	eax, eax

loc_1000F6E5:				; CODE XREF: sub_1000F602+D5j
					; sub_1000F602+DFj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_1000F602	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F6EE	proc near		; CODE XREF: sub_1000B3A3+15Fp
					; sub_1000B3A3+191p ...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+18h+arg_4]
		mov	ebx, ecx
		push	edi
		xor	edi, edi
		cmp	byte ptr [esi+0Ch], 0
		jnz	short loc_1000F721
		mov	ecx, [esi+4]
		mov	ebp, [esi+8]
		push	edi
		push	edi
		push	6
		call	sub_1000F491
		test	eax, eax
		jz	short loc_1000F75C
		mov	[eax+8], ebp
		mov	eax, [esi]
		inc	dword ptr [eax]
		mov	byte ptr [esi+0Ch], 1

loc_1000F721:				; CODE XREF: sub_1000F6EE+13j
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_1000F738
		push	esi
		mov	ecx, eax
		call	sub_1000F9D3
		mov	edi, eax

loc_1000F738:				; CODE XREF: sub_1000F6EE+3Ej
		mov	ecx, [esp+1Ch+arg_0]
		mov	[esp+1Ch+var_8], ecx
		lea	ecx, [esp+1Ch+var_C]
		push	ecx
		mov	ecx, ebx
		mov	[esp+20h+var_C], edi
		call	sub_1000FDBA
		mov	al, 1

loc_1000F752:				; CODE XREF: sub_1000F6EE+70j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	8
; ---------------------------------------------------------------------------

loc_1000F75C:				; CODE XREF: sub_1000F6EE+26j
		xor	al, al
		jmp	short loc_1000F752
sub_1000F6EE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F760	proc near		; CODE XREF: sub_10014EC9+15p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8

		sub	esp, 2Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	1Ch
		mov	esi, ecx
		xor	ebx, ebx
		pop	ebp
		push	ebp
		mov	[esp+40h+var_20], esi
		mov	[esp+40h+var_C], ebx
		mov	[esp+40h+var_8], ebx
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		mov	ecx, eax
		test	ecx, ecx
		jnz	short loc_1000F78E

loc_1000F788:				; CODE XREF: sub_1000F760+8Ej
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1000F78E:				; CODE XREF: sub_1000F760+26j
		lea	eax, [ecx+4]
		mov	[ecx], ecx
		test	eax, eax
		jz	short loc_1000F799
		mov	[eax], ecx

loc_1000F799:				; CODE XREF: sub_1000F760+35j
		lea	eax, [ecx+8]
		test	eax, eax
		jz	short loc_1000F7A2
		mov	[eax], ecx

loc_1000F7A2:				; CODE XREF: sub_1000F760+3Ej
		mov	word ptr [ecx+0Ch], 101h
		mov	eax, [esi]
		mov	[esp+3Ch+var_C], ecx
		mov	edi, [eax]
		cmp	edi, eax
		jz	loc_1000F8A2

loc_1000F7B8:				; CODE XREF: sub_1000F760+132j
		mov	edx, [edi+0Ch]
		mov	esi, ecx
		mov	[esp+3Ch+var_14], edx
		mov	eax, [ecx+4]
		jmp	short loc_1000F7D4
; ---------------------------------------------------------------------------

loc_1000F7C6:				; CODE XREF: sub_1000F760+77j
		cmp	[eax+10h], edx
		jnb	short loc_1000F7D0
		mov	eax, [eax+8]
		jmp	short loc_1000F7D4
; ---------------------------------------------------------------------------

loc_1000F7D0:				; CODE XREF: sub_1000F760+69j
		mov	esi, eax
		mov	eax, [eax]

loc_1000F7D4:				; CODE XREF: sub_1000F760+64j
					; sub_1000F760+6Ej
		cmp	[eax+0Dh], bl
		jz	short loc_1000F7C6
		cmp	esi, ecx
		jz	short loc_1000F7E2
		cmp	edx, [esi+10h]
		jnb	short loc_1000F84A

loc_1000F7E2:				; CODE XREF: sub_1000F760+7Bj
		push	ebp
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebp, eax
		pop	ecx
		test	ebp, ebp
		jz	short loc_1000F788
		mov	eax, [esp+3Ch+var_C]
		lea	ecx, [ebp+4]
		mov	[ebp+0], eax
		test	ecx, ecx
		jz	short loc_1000F804
		mov	eax, [esp+3Ch+var_C]
		mov	[ecx], eax

loc_1000F804:				; CODE XREF: sub_1000F760+9Cj
		lea	ecx, [ebp+8]
		test	ecx, ecx
		jz	short loc_1000F811
		mov	eax, [esp+3Ch+var_C]
		mov	[ecx], eax

loc_1000F811:				; CODE XREF: sub_1000F760+A9j
		lea	ecx, [ebp+10h]
		mov	[ebp+0Ch], bx
		test	ecx, ecx
		jz	short loc_1000F835
		mov	eax, [esp+3Ch+var_14]
		push	ebx
		mov	[ecx], eax
		push	ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		call	sub_1000917F
		lea	ecx, [ebp+10h]
		mov	[ecx+4], eax

loc_1000F835:				; CODE XREF: sub_1000F760+BAj
		push	ebp
		push	ecx
		push	esi
		lea	eax, [esp+48h+var_18]
		push	eax
		lea	ecx, [esp+4Ch+var_C]
		call	sub_1000FE74
		mov	esi, [esp+3Ch+var_18]

loc_1000F84A:				; CODE XREF: sub_1000F760+80j
		mov	ebp, [esi+14h]
		push	dword ptr [ebp+4]
		push	ebp
		call	sub_1000917F
		mov	ecx, eax
		lea	edx, [ecx+8]
		test	edx, edx
		jz	short loc_1000F864
		mov	eax, [edi+8]
		mov	[edx], eax

loc_1000F864:				; CODE XREF: sub_1000F760+FDj
		mov	edx, [esi+18h]
		mov	eax, 15555554h
		sub	eax, edx
		cmp	eax, 1
		jb	short loc_1000F897
		lea	eax, [edx+1]
		mov	[esi+18h], eax
		mov	esi, [esp+3Ch+var_20]
		mov	[ebp+4], ecx
		mov	eax, [ecx+4]
		mov	[eax], ecx
		mov	edi, [edi]
		mov	ecx, [esp+3Ch+var_C]
		cmp	edi, [esi]
		jz	short loc_1000F8A2
		push	1Ch
		pop	ebp
		jmp	loc_1000F7B8
; ---------------------------------------------------------------------------

loc_1000F897:				; CODE XREF: sub_1000F760+111j
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000F8A2:				; CODE XREF: sub_1000F760+52j
					; sub_1000F760+12Dj
		mov	eax, [esi+8]
		mov	ebp, [eax+80h]
		lea	esi, [eax+84h]
		mov	[esp+3Ch+var_24], esi
		lea	eax, [esi+ebp]
		mov	[esp+3Ch+var_28], eax
		mov	eax, [ecx]
		mov	[esp+3Ch+var_14], eax
		cmp	eax, ecx
		jz	loc_1000F976

loc_1000F8CA:				; CODE XREF: sub_1000F760+210j
		mov	edx, [eax+10h]
		cmp	edx, 20h
		jnb	loc_1000F978
		mov	ecx, [esp+3Ch+var_20]
		mov	ecx, [ecx+8]
		mov	[ecx+edx*4], esi
		mov	ecx, ebx
		mov	edi, [eax+14h]
		mov	esi, [edi]
		jmp	short loc_1000F93C
; ---------------------------------------------------------------------------

loc_1000F8E9:				; CODE XREF: sub_1000F760+1E2j
		mov	eax, [esi+8]
		mov	eax, [eax]
		mov	eax, [eax]
		imul	edx, eax, 18h
		mov	[esp+3Ch+var_10], eax
		cmp	ebp, edx
		jb	short loc_1000F978
		mov	eax, ebp
		sub	eax, edx
		mov	[esp+3Ch+var_1C], eax
		lea	eax, [esp+3Ch+var_1C]
		push	eax
		push	[esp+40h+var_28]
		imul	eax, ecx, 18h
		mov	ecx, [esp+44h+var_24]
		add	ecx, 4
		push	edx
		add	eax, ecx
		mov	ecx, [esi+8]
		push	eax
		call	sub_1000FCE3
		test	al, al
		jz	short loc_1000F978
		mov	ecx, [esp+3Ch+var_18]
		mov	eax, ebp
		sub	eax, [esp+3Ch+var_1C]
		sub	[esp+3Ch+var_28], eax
		sub	ebp, eax
		add	ecx, [esp+3Ch+var_10]
		mov	esi, [esi]

loc_1000F93C:				; CODE XREF: sub_1000F760+187j
		mov	[esp+3Ch+var_18], ecx
		cmp	esi, edi
		jnz	short loc_1000F8E9
		mov	esi, [esp+3Ch+var_24]
		xor	edx, edx
		imul	eax, ecx, 18h
		push	1Ch
		add	[esi], ecx
		pop	ecx
		div	ecx
		add	esi, ecx
		lea	ecx, [esp+3Ch+var_14]
		imul	eax, 1Ch
		add	esi, eax
		mov	[esp+3Ch+var_24], esi
		call	sub_10004B87
		mov	eax, [esp+3Ch+var_14]
		cmp	eax, [esp+3Ch+var_C]
		jnz	loc_1000F8CA

loc_1000F976:				; CODE XREF: sub_1000F760+164j
		mov	bl, 1

loc_1000F978:				; CODE XREF: sub_1000F760+170j
					; sub_1000F760+199j ...
		lea	ecx, [esp+3Ch+var_C]
		call	sub_1000FE0F
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 2Ch
		retn
sub_1000F760	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F98B	proc near		; CODE XREF: sub_1000B3A3+AAp
					; sub_1000B3A3+B5p ...

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		push	esi
		mov	esi, ecx
		push	101Ch
		mov	[esi+8], eax
		mov	byte ptr [esi+0Ch], 0
		call	sub_10018CBA
		mov	[esi], eax
		push	8
		and	dword ptr [eax], 0
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_1000F9C8
		mov	ecx, [esi]
		add	ecx, 4
		mov	[eax], ecx
		add	ecx, 1018h
		mov	[eax+4], ecx
		jmp	short loc_1000F9CA
; ---------------------------------------------------------------------------

loc_1000F9C8:				; CODE XREF: sub_1000F98B+29j
		xor	eax, eax

loc_1000F9CA:				; CODE XREF: sub_1000F98B+3Bj
		mov	[esi+4], eax
		mov	eax, esi
		pop	esi
		retn	4
sub_1000F98B	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000F9D3	proc near		; CODE XREF: sub_1000F6EE+43p

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	esi, ecx
		cmp	esi, edi
		jz	short loc_1000FA33
		mov	eax, [edi+8]
		push	ebx
		mov	[esi+8], eax
		mov	ebx, 101Ch
		mov	al, [edi+0Ch]
		push	ebx
		mov	[esi+0Ch], al
		call	sub_10018CBA
		push	ebx		; size_t
		mov	[esi], eax
		push	dword ptr [edi]	; void *
		push	eax		; void *
		call	memcpy
		mov	ecx, [esi]
		push	8
		imul	eax, [ecx], 18h
		lea	ebx, [ecx+4]
		add	ebx, eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		add	esp, 14h
		test	eax, eax
		jz	short loc_1000FA2D
		mov	ecx, [edi+4]
		mov	edx, [ecx+4]
		sub	edx, [ecx]
		mov	[eax], ebx
		lea	ecx, [edx+ebx]
		mov	[eax+4], ecx
		jmp	short loc_1000FA2F
; ---------------------------------------------------------------------------

loc_1000FA2D:				; CODE XREF: sub_1000F9D3+46j
		xor	eax, eax

loc_1000FA2F:				; CODE XREF: sub_1000F9D3+58j
		mov	[esi+4], eax
		pop	ebx

loc_1000FA33:				; CODE XREF: sub_1000F9D3+Aj
		pop	edi
		mov	eax, esi
		pop	esi
		retn	4
sub_1000F9D3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FA3A	proc near		; CODE XREF: sub_1000FB42+7Ep
					; sub_1000FB42+D0p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_C		= dword	ptr  10h
arg_10		= byte ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		mov	dl, [esp+arg_10]
		push	ebx
		push	ebp
		xor	ebp, ebp
		mov	ebx, ecx
		mov	eax, ebp
		push	esi
		push	edi
		test	dl, dl
		jz	short loc_1000FA5A
		mov	eax, [esp+10h+arg_0]
		dec	eax
		neg	eax
		sbb	eax, eax
		add	eax, 3
		jmp	short loc_1000FA64
; ---------------------------------------------------------------------------

loc_1000FA5A:				; CODE XREF: sub_1000FA3A+10j
		cmp	[esp+10h+arg_0], 1
		jnz	short loc_1000FA64
		push	5
		pop	eax

loc_1000FA64:				; CODE XREF: sub_1000FA3A+1Ej
					; sub_1000FA3A+25j
		mov	edi, [esp+10h+arg_18]
		cmp	[edi+10h], ebp
		jnz	short loc_1000FA94
		test	dl, dl
		jz	loc_1000FB39
		mov	edx, [ebx]
		mov	ecx, [edx]
		test	ecx, ecx
		jz	loc_1000FB39
		imul	ecx, 18h
		push	eax
		add	ecx, 0FFFFFFECh
		add	ecx, edx
		call	sub_1000F21E
		jmp	loc_1000FB39
; ---------------------------------------------------------------------------

loc_1000FA94:				; CODE XREF: sub_1000FA3A+31j
		cmp	[esp+10h+arg_C], 1
		jnz	short loc_1000FACD
		test	dl, dl
		jz	short loc_1000FAB8
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FAA9
		mov	ecx, [edi]
		jmp	short loc_1000FAAB
; ---------------------------------------------------------------------------

loc_1000FAA9:				; CODE XREF: sub_1000FA3A+69j
		mov	ecx, edi

loc_1000FAAB:				; CODE XREF: sub_1000FA3A+6Dj
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFh

loc_1000FAB5:				; CODE XREF: sub_1000FA3A+91j
		push	ecx
		jmp	short loc_1000FB14
; ---------------------------------------------------------------------------

loc_1000FAB8:				; CODE XREF: sub_1000FA3A+63j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FAC2
		mov	ecx, [edi]
		jmp	short loc_1000FAC4
; ---------------------------------------------------------------------------

loc_1000FAC2:				; CODE XREF: sub_1000FA3A+82j
		mov	ecx, edi

loc_1000FAC4:				; CODE XREF: sub_1000FA3A+86j
		push	eax
		push	[esp+14h+arg_4]
		push	0FFFFFFFFh
		jmp	short loc_1000FAB5
; ---------------------------------------------------------------------------

loc_1000FACD:				; CODE XREF: sub_1000FA3A+5Fj
		cmp	[esp+10h+arg_C], 2
		jnz	short loc_1000FAF9
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FADE
		mov	ecx, [edi]
		jmp	short loc_1000FAE0
; ---------------------------------------------------------------------------

loc_1000FADE:				; CODE XREF: sub_1000FA3A+9Ej
		mov	ecx, edi

loc_1000FAE0:				; CODE XREF: sub_1000FA3A+A2j
		mov	esi, [esp+10h+arg_14]
		push	eax		; int
		push	[esp+14h+arg_4]	; int
		push	dword ptr [esi]	; int
		push	ecx		; lpString
		push	ecx		; int
		mov	ecx, [ebx+4]
		call	sub_1000F2B1
		mov	[esi], ebp
		jmp	short loc_1000FB1D
; ---------------------------------------------------------------------------

loc_1000FAF9:				; CODE XREF: sub_1000FA3A+98j
		mov	ecx, [esp+10h+arg_4]
		test	dl, dl
		jz	short loc_1000FB04
		or	ecx, 2

loc_1000FB04:				; CODE XREF: sub_1000FA3A+C5j
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1000FB0E
		mov	edx, [edi]
		jmp	short loc_1000FB10
; ---------------------------------------------------------------------------

loc_1000FB0E:				; CODE XREF: sub_1000FA3A+CEj
		mov	edx, edi

loc_1000FB10:				; CODE XREF: sub_1000FA3A+D2j
		push	eax		; int
		push	ecx		; int
		push	ebp		; int
		push	edx		; lpString

loc_1000FB14:				; CODE XREF: sub_1000FA3A+7Cj
		push	ecx		; int
		mov	ecx, [ebx+4]
		call	sub_1000F2B1

loc_1000FB1D:				; CODE XREF: sub_1000FA3A+BDj
		test	eax, eax
		jnz	short loc_1000FB25
		xor	al, al
		jmp	short loc_1000FB3B
; ---------------------------------------------------------------------------

loc_1000FB25:				; CODE XREF: sub_1000FA3A+E5j
		mov	eax, [ebx]
		inc	dword ptr [eax]
		cmp	dword ptr [edi+14h], 8
		mov	[edi+10h], ebp
		jb	short loc_1000FB34
		mov	edi, [edi]

loc_1000FB34:				; CODE XREF: sub_1000FA3A+F6j
		xor	eax, eax
		mov	[edi], ax

loc_1000FB39:				; CODE XREF: sub_1000FA3A+35j
					; sub_1000FA3A+41j ...
		mov	al, 1

loc_1000FB3B:				; CODE XREF: sub_1000FA3A+E9j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	1Ch
sub_1000FA3A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FB42	proc near		; CODE XREF: sub_1000B3A3+149p
					; sub_1000B3A3+17Bp ...

var_24		= dword	ptr -24h
var_20		= word ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+0Ch], 0
		jz	short loc_1000FB63
		xor	al, al
		jmp	loc_1000FC65
; ---------------------------------------------------------------------------

loc_1000FB63:				; CODE XREF: sub_1000FB42+18j
		mov	esi, [esp+34h+arg_8]
		xor	eax, eax
		and	[esp+34h+var_24], eax
		xor	ecx, ecx
		and	[esp+34h+var_10], eax
		xor	ebx, ebx
		mov	[esp+34h+var_C], 7
		mov	[esp+34h+var_20], cx
		cmp	cx, [esi]
		jz	loc_1000FC2F
		push	3Fh
		pop	ebp

loc_1000FB8E:				; CODE XREF: sub_1000FB42+E7j
		movzx	ecx, word ptr [esi]
		cmp	ecx, 2Ah
		jz	short loc_1000FBF6
		cmp	ecx, 2Fh
		jz	short loc_1000FBD9
		cmp	ecx, ebp
		jnz	short loc_1000FBE2
		cmp	eax, 6
		jz	loc_1000FC50
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	0
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA3A
		test	al, al
		jz	loc_1000FC50
		inc	[esp+34h+var_24]
		push	0Ah
		pop	eax
		push	2
		pop	ebx
		jmp	short loc_1000FC21
; ---------------------------------------------------------------------------

loc_1000FBD9:				; CODE XREF: sub_1000FB42+57j
		cmp	bp, [esi+2]
		jnz	short loc_1000FBE2
		add	esi, 2

loc_1000FBE2:				; CODE XREF: sub_1000FB42+5Bj
					; sub_1000FB42+9Bj
		movzx	eax, word ptr [esi]
		lea	ecx, [esp+34h+var_20]
		push	eax
		push	1
		call	sub_100030C7
		xor	eax, eax
		inc	eax
		jmp	short loc_1000FC21
; ---------------------------------------------------------------------------

loc_1000FBF6:				; CODE XREF: sub_1000FB42+52j
		test	al, 2
		jnz	short loc_1000FC50
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	0
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA3A
		test	al, al
		jz	short loc_1000FC50
		push	6
		xor	ebx, ebx
		pop	eax
		inc	ebx

loc_1000FC21:				; CODE XREF: sub_1000FB42+95j
					; sub_1000FB42+B2j
		add	esi, 2
		xor	ecx, ecx
		cmp	cx, [esi]
		jnz	loc_1000FB8E

loc_1000FC2F:				; CODE XREF: sub_1000FB42+43j
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_24]
		push	eax
		push	1
		push	ebx
		push	ecx
		push	[esp+48h+arg_C]
		mov	ecx, edi
		push	[esp+4Ch+arg_0]
		call	sub_1000FA3A
		test	al, al
		jnz	short loc_1000FC54

loc_1000FC50:				; CODE XREF: sub_1000FB42+60j
					; sub_1000FB42+85j ...
		xor	bl, bl
		jmp	short loc_1000FC56
; ---------------------------------------------------------------------------

loc_1000FC54:				; CODE XREF: sub_1000FB42+10Cj
		mov	bl, 1

loc_1000FC56:				; CODE XREF: sub_1000FB42+110j
		push	0
		push	1
		lea	ecx, [esp+3Ch+var_20]
		call	sub_10002311
		mov	al, bl

loc_1000FC65:				; CODE XREF: sub_1000FB42+1Cj
		mov	ecx, [esp+34h+var_8]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 24h
		retn	10h
sub_1000FB42	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FC7A	proc near		; CODE XREF: sub_1000B3A3+F8p
					; sub_1000B3A3+108p ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		mov	esi, ecx
		cmp	byte ptr [esi+0Ch], 0
		jz	short loc_1000FC8B

loc_1000FC87:				; CODE XREF: sub_1000FC7A+32j
					; sub_1000FC7A+55j
		xor	al, al
		jmp	short loc_1000FCDD
; ---------------------------------------------------------------------------

loc_1000FC8B:				; CODE XREF: sub_1000FC7A+Bj
		xor	eax, eax
		cmp	[ebp+arg_0], 1
		setz	al
		cmp	[ebp+arg_C], 0
		jnz	short loc_1000FCB7
		push	[ebp+arg_4]
		mov	ecx, [esi+4]
		push	eax
		push	2
		call	sub_1000F491
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_1000FC87
		mov	dword ptr [ecx+0Ch], 2
		jmp	short loc_1000FCD1
; ---------------------------------------------------------------------------

loc_1000FCB7:				; CODE XREF: sub_1000FC7A+1Ej
		cmp	[ebp+arg_C], 1
		jnz	short loc_1000FCD7
		push	[ebp+arg_4]
		mov	ecx, [esi+4]
		push	eax
		push	4
		call	sub_1000F491
		mov	ecx, eax
		test	ecx, ecx
		jz	short loc_1000FC87

loc_1000FCD1:				; CODE XREF: sub_1000FC7A+3Bj
		mov	eax, [ebp+arg_8]
		mov	[ecx+8], eax

loc_1000FCD7:				; CODE XREF: sub_1000FC7A+41j
		mov	ecx, [esi]
		mov	al, 1
		inc	dword ptr [ecx]

loc_1000FCDD:				; CODE XREF: sub_1000FC7A+Fj
		pop	esi
		pop	ecx
		pop	ebp
		retn	10h
sub_1000FC7A	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FCE3	proc near		; CODE XREF: sub_1000F760+1BDp

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		xor	ebx, ebx
		push	edi
		mov	[esp+1Ch+var_4], esi
		mov	eax, [esi]
		mov	eax, [eax]
		mov	[esp+1Ch+var_C], eax
		test	eax, eax
		jz	loc_1000FD96
		mov	ebp, [esp+1Ch+arg_0]
		mov	ecx, ebx
		mov	eax, [esp+1Ch+arg_4]
		mov	edx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_8], ecx

loc_1000FD14:				; CODE XREF: sub_1000FCE3+ADj
		cmp	eax, 18h
		jb	short loc_1000FD92
		mov	eax, [esi]
		add	ecx, 4
		add	eax, ecx
		mov	edi, ebp
		push	6
		pop	ecx
		mov	esi, eax
		mov	[esp+1Ch+arg_0], eax
		rep movsd
		cmp	dword ptr [eax], 5
		jnz	short loc_1000FD6E
		mov	edx, [esp+1Ch+arg_C]
		mov	eax, [eax+0Ch]
		add	eax, eax
		mov	ecx, [edx]
		cmp	ecx, eax
		jb	short loc_1000FD92
		mov	esi, [esp+1Ch+arg_8]
		sub	ecx, eax
		mov	[edx], ecx
		sub	esi, eax
		mov	ecx, [esp+1Ch+arg_0]
		push	eax		; size_t
		mov	[esp+20h+arg_8], esi
		mov	eax, [ecx+8]
		add	eax, ecx
		push	eax		; void *
		push	esi		; void *
		call	memcpy
		mov	edx, [esp+28h+var_C]
		mov	eax, esi
		add	esp, 0Ch
		sub	eax, ebp
		mov	[ebp+8], eax

loc_1000FD6E:				; CODE XREF: sub_1000FCE3+4Dj
		mov	eax, [esp+1Ch+arg_4]
		add	ebp, 18h
		mov	ecx, [esp+1Ch+var_8]
		sub	eax, 18h
		inc	ebx
		mov	[esp+1Ch+arg_4], eax
		add	ecx, 18h
		mov	[esp+1Ch+var_8], ecx
		cmp	ebx, edx
		jz	short loc_1000FD96
		mov	esi, [esp+1Ch+var_4]
		jmp	short loc_1000FD14
; ---------------------------------------------------------------------------

loc_1000FD92:				; CODE XREF: sub_1000FCE3+34j
					; sub_1000FCE3+5Cj
		xor	al, al
		jmp	short loc_1000FD98
; ---------------------------------------------------------------------------

loc_1000FD96:				; CODE XREF: sub_1000FCE3+19j
					; sub_1000FCE3+A7j
		mov	al, 1

loc_1000FD98:				; CODE XREF: sub_1000FCE3+B1j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 0Ch
		retn	10h
sub_1000FCE3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FDA2	proc near		; CODE XREF: sub_1000B3A3+222p
					; sub_1000B3A3+22Bp ...
		push	esi
		mov	esi, ecx
		push	dword ptr [esi]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		push	dword ptr [esi+4]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	ecx
		pop	esi
		retn
sub_1000FDA2	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FDBA	proc near		; CODE XREF: sub_1000F6EE+5Dp
					; sub_10017F0F+4Dp

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebx, [edi]
		push	dword ptr [ebx+4]
		push	ebx
		call	sub_1000914C
		mov	esi, eax
		lea	eax, [esi+8]
		test	eax, eax
		jz	short loc_1000FDE1
		mov	edx, [esp+0Ch+arg_0]
		mov	ecx, [edx]
		mov	[eax], ecx
		mov	ecx, [edx+4]
		mov	[eax+4], ecx

loc_1000FDE1:				; CODE XREF: sub_1000FDBA+17j
		mov	ecx, [edi+4]
		mov	eax, 0FFFFFFEh
		sub	eax, ecx
		cmp	eax, 1
		jnb	short loc_1000FDFB
		push	offset aListTTooLong ; "list<T>	too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000FDFB:				; CODE XREF: sub_1000FDBA+34j
		lea	eax, [ecx+1]
		mov	[edi+4], eax
		mov	[ebx+4], esi
		mov	eax, [esi+4]
		pop	edi
		mov	[eax], esi
		pop	esi
		pop	ebx
		retn	4
sub_1000FDBA	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FE0F	proc near		; CODE XREF: sub_1000F760+21Cp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		push	dword ptr [eax+4]
		call	sub_1000FE39
		mov	eax, [esi]
		mov	[eax+4], eax
		mov	eax, [esi]
		mov	[eax], eax
		mov	eax, [esi]
		mov	[eax+8], eax
		push	dword ptr [esi]
		and	dword ptr [esi+4], 0
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		pop	esi
		retn
sub_1000FE0F	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FE39	proc near		; CODE XREF: sub_1000FE0F+8p
					; sub_1000FE39+16p

arg_0		= dword	ptr  4

		push	ebx
		push	esi
		mov	esi, [esp+8+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, esi
		cmp	byte ptr [esi+0Dh], 0
		jnz	short loc_1000FE6E

loc_1000FE4A:				; CODE XREF: sub_1000FE39+33j
		push	dword ptr [edi+8]
		mov	ecx, ebx
		call	sub_1000FE39
		mov	edi, [edi]
		lea	ecx, [esi+14h]
		call	sub_10008D00
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		cmp	byte ptr [edi+0Dh], 0
		mov	esi, edi
		pop	ecx
		jz	short loc_1000FE4A

loc_1000FE6E:				; CODE XREF: sub_1000FE39+Fj
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_1000FE39	endp


; =============== S U B	R O U T	I N E =======================================


sub_1000FE74	proc near		; CODE XREF: sub_1000F760+E1p

var_C		= dword	ptr -0Ch
var_8		= byte ptr -8
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		sub	esp, 0Ch
		push	edi
		mov	edi, ecx
		xor	edx, edx
		mov	[esp+10h+var_C], edx
		cmp	[edi+4], edx
		jnz	short loc_1000FEA0
		push	[esp+10h+arg_C]
		push	ecx
		push	dword ptr [edi]
		push	1
		push	[esp+20h+arg_0]
		call	sub_1000FF87
		mov	eax, [esp+10h+arg_0]
		jmp	loc_1000FF80
; ---------------------------------------------------------------------------

loc_1000FEA0:				; CODE XREF: sub_1000FE74+Fj
		push	ebx
		mov	ebx, [esp+14h+arg_8]
		push	ebp
		mov	ebp, [edi]
		push	esi
		mov	esi, [esp+1Ch+arg_4]
		cmp	esi, [ebp+0]
		jnz	short loc_1000FEC8
		mov	eax, [ebx]
		cmp	eax, [esi+10h]
		jnb	loc_1000FF63
		push	[esp+1Ch+arg_C]
		push	ecx

loc_1000FEC2:				; CODE XREF: sub_1000FE74+A0j
		push	esi
		jmp	loc_1000FF52
; ---------------------------------------------------------------------------

loc_1000FEC8:				; CODE XREF: sub_1000FE74+3Cj
		cmp	esi, ebp
		jnz	short loc_1000FEE5
		mov	ecx, [ebp+8]
		mov	eax, [ecx+10h]
		cmp	eax, [ebx]
		jnb	loc_1000FF63
		push	[esp+1Ch+arg_C]
		push	ecx
		push	ecx
		push	edx
		mov	ecx, edi
		jmp	short loc_1000FF54
; ---------------------------------------------------------------------------

loc_1000FEE5:				; CODE XREF: sub_1000FE74+56j
		mov	eax, [ebx]
		cmp	[esi+10h], eax
		jbe	short loc_1000FF1E
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004EEF
		mov	ecx, [ebx]
		mov	eax, [eax]
		cmp	[eax+10h], ecx
		jnb	short loc_1000FF19
		mov	eax, [esp+1Ch+var_C]
		push	[esp+1Ch+arg_C]
		mov	ecx, [eax+8]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000FEC2
		push	eax
		jmp	short loc_1000FF4D
; ---------------------------------------------------------------------------

loc_1000FF19:				; CODE XREF: sub_1000FE74+8Cj
		mov	eax, ecx
		cmp	[esi+10h], eax

loc_1000FF1E:				; CODE XREF: sub_1000FE74+76j
		jnb	short loc_1000FF63
		lea	ecx, [esp+1Ch+var_C]
		mov	[esp+1Ch+var_C], esi
		call	sub_10004B87
		cmp	[eax], ebp
		mov	eax, [esp+1Ch+var_C]
		jz	short loc_1000FF3C
		mov	ecx, [ebx]
		cmp	ecx, [eax+10h]
		jnb	short loc_1000FF63

loc_1000FF3C:				; CODE XREF: sub_1000FE74+BFj
		mov	ecx, [esi+8]
		push	[esp+1Ch+arg_C]
		push	ecx
		cmp	byte ptr [ecx+0Dh], 0
		mov	ecx, edi
		jz	short loc_1000FF51
		push	esi

loc_1000FF4D:				; CODE XREF: sub_1000FE74+A3j
		push	0
		jmp	short loc_1000FF54
; ---------------------------------------------------------------------------

loc_1000FF51:				; CODE XREF: sub_1000FE74+D6j
		push	eax

loc_1000FF52:				; CODE XREF: sub_1000FE74+4Fj
		push	1

loc_1000FF54:				; CODE XREF: sub_1000FE74+6Fj
					; sub_1000FE74+DBj
		push	[esp+2Ch+arg_0]
		call	sub_1000FF87
		mov	eax, [esp+1Ch+arg_0]
		jmp	short loc_1000FF7D
; ---------------------------------------------------------------------------

loc_1000FF63:				; CODE XREF: sub_1000FE74+43j
					; sub_1000FE74+60j ...
		push	[esp+1Ch+arg_C]
		lea	eax, [esp+20h+var_8]
		push	ebx
		push	ecx
		push	eax
		mov	ecx, edi
		call	sub_100100B4
		mov	ecx, [eax]
		mov	eax, [esp+1Ch+arg_0]
		mov	[eax], ecx

loc_1000FF7D:				; CODE XREF: sub_1000FE74+EDj
		pop	esi
		pop	ebp
		pop	ebx

loc_1000FF80:				; CODE XREF: sub_1000FE74+27j
		pop	edi
		add	esp, 0Ch
		retn	10h
sub_1000FE74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1000FF87	proc near		; CODE XREF: sub_1000FE74+1Ep
					; sub_1000FE74+E4p ...

var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8
arg_4		= byte ptr  0Ch
arg_8		= dword	ptr  10h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ebx
		mov	ebx, ecx
		push	esi
		push	edi
		mov	eax, [ebx+4]
		cmp	eax, 9249248h
		jb	short loc_1000FFB8
		mov	esi, [ebp+arg_10]
		lea	ecx, [esi+14h]
		call	sub_10008D00
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	[esp+0Ch+var_C], offset	aMapSetTTooLong	; "map/set<T> too long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_1000FFB8:				; CODE XREF: sub_1000FF87+10j
		mov	edi, [ebp+arg_10]
		inc	eax
		mov	[ebx+4], eax
		mov	eax, [ebp+arg_8]
		mov	[edi+4], eax
		mov	ecx, [ebx]
		cmp	eax, ecx
		jnz	short loc_1000FFD9
		mov	[ecx+4], edi
		mov	eax, [ebx]
		mov	[eax], edi
		mov	eax, [ebx]
		mov	[eax+8], edi
		jmp	short loc_1000FFF8
; ---------------------------------------------------------------------------

loc_1000FFD9:				; CODE XREF: sub_1000FF87+42j
		cmp	[ebp+arg_4], 0
		jz	short loc_1000FFEB
		mov	[eax], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx]
		jnz	short loc_1000FFF8
		mov	[ecx], edi
		jmp	short loc_1000FFF8
; ---------------------------------------------------------------------------

loc_1000FFEB:				; CODE XREF: sub_1000FF87+56j
		mov	[eax+8], edi
		mov	ecx, [ebx]
		cmp	eax, [ecx+8]
		jnz	short loc_1000FFF8
		mov	[ecx+8], edi

loc_1000FFF8:				; CODE XREF: sub_1000FF87+50j
					; sub_1000FF87+5Ej ...
		mov	eax, [edi+4]
		mov	esi, edi
		jmp	loc_10010095
; ---------------------------------------------------------------------------

loc_10010002:				; CODE XREF: sub_1000FF87+112j
		mov	eax, [esi+4]
		mov	edx, [eax+4]
		mov	ecx, [edx]
		cmp	eax, ecx
		jnz	short loc_10010046
		mov	ecx, [edx+8]
		cmp	byte ptr [ecx+0Ch], 0
		jz	short loc_1001004C
		cmp	esi, [eax+8]
		jnz	short loc_10010026
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B03

loc_10010026:				; CODE XREF: sub_1000FF87+93j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B44
		jmp	short loc_10010092
; ---------------------------------------------------------------------------

loc_10010046:				; CODE XREF: sub_1000FF87+85j
		cmp	byte ptr [ecx+0Ch], 0
		jnz	short loc_10010066

loc_1001004C:				; CODE XREF: sub_1000FF87+8Ej
		mov	byte ptr [eax+0Ch], 1
		mov	byte ptr [ecx+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		mov	esi, [eax+4]
		jmp	short loc_10010092
; ---------------------------------------------------------------------------

loc_10010066:				; CODE XREF: sub_1000FF87+C3j
		cmp	esi, [eax]
		jnz	short loc_10010074
		mov	esi, eax
		mov	ecx, ebx
		push	esi
		call	sub_10004B44

loc_10010074:				; CODE XREF: sub_1000FF87+E1j
		mov	eax, [esi+4]
		mov	ecx, ebx
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [esi+4]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 0
		mov	eax, [esi+4]
		push	dword ptr [eax+4]
		call	sub_10004B03

loc_10010092:				; CODE XREF: sub_1000FF87+BDj
					; sub_1000FF87+DDj
		mov	eax, [esi+4]

loc_10010095:				; CODE XREF: sub_1000FF87+76j
		cmp	byte ptr [eax+0Ch], 0
		jz	loc_10010002
		mov	eax, [ebx]
		mov	eax, [eax+4]
		mov	byte ptr [eax+0Ch], 1
		mov	eax, [ebp+arg_0]
		mov	[eax], edi
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn	14h
sub_1000FF87	endp


; =============== S U B	R O U T	I N E =======================================


sub_100100B4	proc near		; CODE XREF: sub_1000FE74+FCp

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		mov	ebx, [esp+8+arg_8]
		mov	dl, 1
		push	ebp
		mov	ebp, ecx
		mov	byte ptr [esp+0Ch+var_4], dl
		push	esi
		push	edi
		mov	ecx, [ebp+0]
		mov	edi, ecx
		mov	eax, [ecx+4]
		cmp	byte ptr [eax+0Dh], 0
		jnz	short loc_100100F2
		mov	esi, [ebx]

loc_100100D5:				; CODE XREF: sub_100100B4+3Cj
		cmp	esi, [eax+10h]
		mov	edi, eax
		setb	dl
		mov	byte ptr [esp+14h+var_4], dl
		test	dl, dl
		jz	short loc_100100E9
		mov	eax, [eax]
		jmp	short loc_100100EC
; ---------------------------------------------------------------------------

loc_100100E9:				; CODE XREF: sub_100100B4+2Fj
		mov	eax, [eax+8]

loc_100100EC:				; CODE XREF: sub_100100B4+33j
		cmp	byte ptr [eax+0Dh], 0
		jz	short loc_100100D5

loc_100100F2:				; CODE XREF: sub_100100B4+1Dj
		mov	esi, edi
		mov	[esp+14h+arg_8], esi
		test	dl, dl
		jz	short loc_1001012F
		cmp	edi, [ecx]
		jnz	short loc_10010122
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	1

loc_10010108:				; CODE XREF: sub_100100B4+8Cj
		lea	eax, [esp+24h+arg_C]
		mov	ecx, ebp
		push	eax
		call	sub_1000FF87
		mov	ecx, [eax]
		mov	eax, [esp+14h+arg_0]
		mov	[eax], ecx
		mov	byte ptr [eax+4], 1
		jmp	short loc_10010160
; ---------------------------------------------------------------------------

loc_10010122:				; CODE XREF: sub_100100B4+4Aj
		lea	ecx, [esp+14h+arg_8]
		call	sub_10004EEF
		mov	esi, [esp+14h+arg_8]

loc_1001012F:				; CODE XREF: sub_100100B4+46j
		mov	eax, [esi+10h]
		cmp	eax, [ebx]
		jnb	short loc_10010142
		push	[esp+14h+arg_C]
		push	ecx
		push	edi
		push	[esp+20h+var_4]
		jmp	short loc_10010108
; ---------------------------------------------------------------------------

loc_10010142:				; CODE XREF: sub_100100B4+80j
		mov	edi, [esp+14h+arg_C]
		lea	ecx, [edi+14h]
		call	sub_10008D00
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	eax, [esp+18h+arg_0]
		pop	ecx
		mov	[eax], esi
		mov	byte ptr [eax+4], 0

loc_10010160:				; CODE XREF: sub_100100B4+6Cj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
sub_100100B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010168	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+122p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+10Dp	...

var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 20h
		jnb	short loc_100101E3
		mov	edx, dword_10031DEC
		cmp	dword ptr [edx+ecx*4], 0
		jz	short loc_100101E3
		mov	eax, [edx+ecx*4]
		mov	edi, dword_10031DEC
		mov	ecx, [edx+80h]
		add	edi, eax
		cmp	eax, ecx
		ja	short loc_100101E3
		cmp	g_shared_policy_size, ecx
		jb	short loc_100101E3
		xor	eax, eax
		cmp	[esi], eax
		jle	short loc_100101B7
		lea	ecx, [esi+4]

loc_100101AA:				; CODE XREF: sub_10010168+4Dj
		cmp	dword ptr [ecx], 0
		jz	short loc_100101E3
		inc	eax
		add	ecx, 8
		cmp	eax, [esi]
		jl	short loc_100101AA

loc_100101B7:				; CODE XREF: sub_10010168+3Dj
		push	dword ptr [esi]
		and	[ebp+var_C], 0
		lea	eax, [esi+4]
		push	eax
		xor	ebx, ebx
		mov	[ebp+var_4], edi
		push	ecx
		inc	ebx
		lea	ecx, [ebp+var_C]
		mov	[ebp+var_8], ebx
		call	sub_1000F602
		cmp	eax, ebx
		jnz	short loc_100101DD
		cmp	[ebp+var_8], 3
		jz	short loc_100101DF

loc_100101DD:				; CODE XREF: sub_10010168+6Dj
		xor	ebx, ebx

loc_100101DF:				; CODE XREF: sub_10010168+73j
		mov	al, bl
		jmp	short loc_100101E5
; ---------------------------------------------------------------------------

loc_100101E3:				; CODE XREF: sub_10010168+Ej
					; sub_10010168+1Aj ...
		xor	al, al

loc_100101E5:				; CODE XREF: sub_10010168+79j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10010168	endp

; Exported entry  39. _TargetNtSetInformationThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtSetInformationThread(x, x, x, x, x)
		public _TargetNtSetInformationThread@20
_TargetNtSetInformationThread@20 proc near ; DATA XREF:	sub_1000F0DF+8Do
					; .rdata:off_1002E058o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 2
		jg	short loc_10010229
		cmp	[ebp+arg_8], 5
		jnz	short loc_10010229
		cmp	[ebp+arg_C], 0
		jz	short loc_10010229
		cmp	[ebp+arg_10], 4
		jb	short loc_10010229
		mov	edx, [ebp+arg_C]
		lea	ecx, [ebp+var_4]
		push	4
		call	sub_10013EBD
		pop	ecx
		test	eax, eax
		js	short loc_10010229
		cmp	[ebp+var_4], 0
		jnz	short loc_10010229
		xor	eax, eax
		jmp	short loc_10010238
; ---------------------------------------------------------------------------

loc_10010229:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+Dj
					; TargetNtSetInformationThread(x,x,x,x,x)+13j ...
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]

loc_10010238:				; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+3Bj
		mov	esp, ebp
		pop	ebp
		retn	14h
_TargetNtSetInformationThread@20 endp

; Exported entry  34. _TargetNtOpenThreadToken@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadToken(x, x, x, x,	x)
		public _TargetNtOpenThreadToken@20
_TargetNtOpenThreadToken@20 proc near	; DATA XREF: sub_1000F0DF+B7o
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		call	sub_10013CCD
		push	[ebp+arg_10]
		cmp	dword ptr [eax+4], 2
		setle	al
		dec	al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	14h
_TargetNtOpenThreadToken@20 endp

; Exported entry  35. _TargetNtOpenThreadTokenEx@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThreadTokenEx(x, x, x, x, x, x)
		public _TargetNtOpenThreadTokenEx@24
_TargetNtOpenThreadTokenEx@24 proc near	; DATA XREF: sub_1000F0DF+10Eo
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		call	sub_10013CCD
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		cmp	dword ptr [eax+4], 2
		setle	al
		dec	al
		and	byte ptr [ebp+arg_C], al
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		pop	ebp
		retn	18h
_TargetNtOpenThreadTokenEx@24 endp


; =============== S U B	R O U T	I N E =======================================


sub_1001028F	proc near		; CODE XREF: sub_10017D8F+141p

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		sub	esp, 14h
		push	ebx
		mov	ebx, dword_10031E14
		push	ebp
		push	esi
		mov	esi, g_shared_delayed_mitigations
		push	edi
		push	ebx
		push	esi
		call	sub_1001067D
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_100102B6

loc_100102AF:				; CODE XREF: sub_1001028F+73j
					; sub_1001028F+96j ...
		xor	al, al
		jmp	loc_100104AD
; ---------------------------------------------------------------------------

loc_100102B6:				; CODE XREF: sub_1001028F+1Ej
		call	sub_100063D2
		push	offset aKernel32_dll_3 ; "kernel32.dll"
		mov	edi, [eax]
		mov	[esp+28h+var_4], edi
		call	ds:GetModuleHandleA
		cmp	edi, 3
		mov	ebp, eax
		mov	edi, ds:GetLastError
		jl	short loc_10010327
		and	ebx, 1
		xor	eax, eax
		or	eax, ebx
		jz	short loc_10010304
		push	offset aSetdefaultdlld ; "SetDefaultDllDirectories"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10010304
		push	1000h
		call	eax
		test	eax, eax
		jnz	short loc_10010304
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_100102AF

loc_10010304:				; CODE XREF: sub_1001028F+51j
					; sub_1001028F+61j ...
		mov	eax, esi
		and	eax, 20h
		or	eax, 0
		jz	short loc_10010327
		push	0		; HeapInformationLength
		push	0		; HeapInformation
		push	1		; HeapInformationClass
		push	0		; HeapHandle
		call	ds:HeapSetInformation
		test	eax, eax
		jnz	short loc_10010327
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	short loc_100102AF

loc_10010327:				; CODE XREF: sub_1001028F+48j
					; sub_1001028F+7Dj ...
		mov	eax, esi
		and	eax, 1
		or	eax, 0
		jz	loc_100103C4
		xor	ebx, ebx
		mov	eax, esi
		inc	ebx
		cmp	[esp+24h+var_4], 3
		setnl	byte ptr [esp+24h+var_10+3]
		and	eax, 2
		or	eax, 0
		jz	short loc_1001034F
		push	3
		pop	ebx

loc_1001034F:				; CODE XREF: sub_1001028F+BBj
		push	offset aSetprocessdepp ; "SetProcessDEPPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		test	eax, eax
		jz	short loc_10010379
		push	ebx
		call	eax
		test	eax, eax
		jnz	short loc_100103C4

loc_10010366:				; CODE XREF: sub_1001028F+133j
		call	edi ; GetLastError
		cmp	eax, 5
		jz	short loc_100103C4
		cmp	byte ptr [esp+24h+var_10+3], 0
		jz	short loc_100103C4
		jmp	loc_100102AF
; ---------------------------------------------------------------------------

loc_10010379:				; CODE XREF: sub_1001028F+CEj
		and	[esp+24h+var_C], 0
		lea	edx, [esp+24h+var_C]
		mov	ecx, offset aNtsetinforma_1 ; "NtSetInformationProcess"
		call	sub_10018835
		cmp	[esp+24h+var_C], 0
		jz	loc_100102AF
		mov	[esp+24h+var_8], 0Ah
		test	bl, 2
		jnz	short loc_100103AC
		mov	[esp+24h+var_8], 0Eh

loc_100103AC:				; CODE XREF: sub_1001028F+113j
		push	4
		lea	eax, [esp+28h+var_8]
		push	eax
		push	22h
		call	ds:GetCurrentProcess
		push	eax
		call	[esp+34h+var_C]
		test	eax, eax
		js	short loc_10010366

loc_100103C4:				; CODE XREF: sub_1001028F+A0j
					; sub_1001028F+D5j ...
		cmp	[esp+24h+var_4], 5
		jl	loc_100104AB
		push	offset aSetprocessmiti ; "SetProcessMitigationPolicy"
		push	ebp		; hModule
		call	ds:GetProcAddress
		mov	ebx, eax
		test	ebx, ebx
		jz	loc_100102AF
		mov	eax, esi
		xor	ebp, ebp
		and	eax, 8
		or	eax, ebp
		jz	short loc_10010427
		mov	eax, esi
		and	eax, 10h
		or	eax, ebp
		jz	short loc_100103FE
		xor	eax, eax
		inc	eax
		jmp	short loc_10010400
; ---------------------------------------------------------------------------

loc_100103FE:				; CODE XREF: sub_1001028F+168j
		mov	eax, ebp

loc_10010400:				; CODE XREF: sub_1001028F+16Dj
		and	eax, 1
		shl	eax, 3
		or	eax, 2
		mov	[esp+24h+var_4], eax
		lea	eax, [esp+24h+var_4]
		push	4
		push	eax
		push	1
		call	ebx
		test	eax, eax
		jnz	short loc_10010427
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_100102AF

loc_10010427:				; CODE XREF: sub_1001028F+15Fj
					; sub_1001028F+18Bj
		mov	eax, esi
		and	eax, 100h
		or	eax, ebp
		jz	short loc_10010452
		push	3
		pop	ecx
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], ecx
		push	eax
		push	ecx
		call	ebx
		test	eax, eax
		jnz	short loc_10010452
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_100102AF

loc_10010452:				; CODE XREF: sub_1001028F+1A1j
					; sub_1001028F+1B6j
		mov	eax, esi
		and	eax, 200h
		or	eax, ebp
		jz	short loc_1001047F
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], 1
		push	eax
		push	4
		call	ebx
		test	eax, eax
		jnz	short loc_1001047F
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_100102AF

loc_1001047F:				; CODE XREF: sub_1001028F+1CCj
					; sub_1001028F+1E3j
		and	esi, 400h
		or	esi, ebp
		jz	short loc_100104AB
		push	4
		lea	eax, [esp+28h+var_4]
		mov	[esp+28h+var_4], 1
		push	eax
		push	6
		call	ebx
		test	eax, eax
		jnz	short loc_100104AB
		call	edi ; GetLastError
		cmp	eax, 5
		jnz	loc_100102AF

loc_100104AB:				; CODE XREF: sub_1001028F+13Aj
					; sub_1001028F+1F8j ...
		mov	al, 1

loc_100104AD:				; CODE XREF: sub_1001028F+22j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 14h
		retn
sub_1001028F	endp


; =============== S U B	R O U T	I N E =======================================


sub_100104B5	proc near		; CODE XREF: sub_100083E3+2B2p

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		call	sub_100063D2
		xor	ebx, ebx
		push	3
		mov	edx, [eax]
		xor	eax, eax
		cmp	edx, 5
		mov	[edi], ebx
		mov	[edi+4], ebx
		setnl	al
		lea	eax, ds:4[eax*4]
		mov	[esi], eax
		pop	esi
		cmp	edx, esi
		jle	loc_100105CD
		mov	ecx, [esp+14h+arg_0]
		xor	ebp, ebp
		inc	ebp
		mov	eax, ecx
		and	eax, ebp
		or	eax, ebx
		jz	short loc_1001050A
		mov	eax, ecx
		mov	[edi], ebp
		and	eax, 2
		mov	[edi+4], ebx
		or	eax, ebx
		jnz	short loc_1001050A
		mov	[edi], esi
		mov	[edi+4], ebx

loc_1001050A:				; CODE XREF: sub_100104B5+40j
					; sub_100104B5+4Ej
		mov	eax, ecx
		and	eax, 4
		or	eax, ebx
		jz	short loc_1001051C
		mov	eax, [edi+4]
		or	dword ptr [edi], 4
		mov	[edi+4], eax

loc_1001051C:				; CODE XREF: sub_100104B5+5Cj
		cmp	edx, 5
		jl	loc_100105CD
		mov	eax, ecx
		mov	edx, 100h
		and	eax, 8
		or	eax, ebx
		jz	short loc_10010550
		mov	eax, [edi+4]
		or	[edi], edx
		mov	[edi+4], eax
		mov	eax, ecx
		and	eax, 10h
		or	eax, ebx
		jz	short loc_10010550
		mov	eax, [edi+4]
		or	dword ptr [edi], 300h
		mov	[edi+4], eax

loc_10010550:				; CODE XREF: sub_100104B5+7Cj
					; sub_100104B5+8Dj
		mov	eax, ecx
		and	eax, 20h
		or	eax, ebx
		jz	short loc_10010565
		mov	eax, [edi+4]
		or	dword ptr [edi], 1000h
		mov	[edi+4], eax

loc_10010565:				; CODE XREF: sub_100104B5+A2j
		mov	eax, ecx
		and	eax, 40h
		or	eax, ebx
		jz	short loc_1001057A
		mov	eax, [edi+4]
		or	dword ptr [edi], 10000h
		mov	[edi+4], eax

loc_1001057A:				; CODE XREF: sub_100104B5+B7j
		mov	eax, ecx
		and	eax, 80h
		or	eax, ebx
		jz	short loc_10010591
		mov	eax, [edi+4]
		or	dword ptr [edi], 100000h
		mov	[edi+4], eax

loc_10010591:				; CODE XREF: sub_100104B5+CEj
		mov	eax, ecx
		and	eax, edx
		or	eax, ebx
		jz	short loc_100105A5
		mov	eax, [edi+4]
		or	dword ptr [edi], 1000000h
		mov	[edi+4], eax

loc_100105A5:				; CODE XREF: sub_100104B5+E2j
		mov	eax, ecx
		and	eax, 200h
		or	eax, ebx
		jz	short loc_100105BC
		mov	eax, [edi+4]
		or	dword ptr [edi], 10000000h
		mov	[edi+4], eax

loc_100105BC:				; CODE XREF: sub_100104B5+F9j
		and	ecx, 400h
		or	ecx, ebx
		jz	short loc_100105CD
		mov	eax, [edi]
		or	[edi+4], ebp
		mov	[edi], eax

loc_100105CD:				; CODE XREF: sub_100104B5+2Dj
					; sub_100104B5+6Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn
sub_100104B5	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100105D3@<eax>(HANDLE hProcess@<ecx>, int)
sub_100105D3	proc near		; CODE XREF: sub_10014EC9+27p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Buffer		= _MEMORY_BASIC_INFORMATION ptr	-1Ch
arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		sub	esp, 24h
		and	eax, 40h
		push	ebp
		push	edi
		xor	edi, edi
		mov	ebp, ecx
		or	eax, edi
		jz	loc_10010675
		lea	eax, [esp+2Ch+arg_0]
		push	esi
		push	eax
		call	ds:rand_s
		mov	esi, [esp+34h+arg_0]
		and	esi, 3FFFh
		add	esi, 200h
		shl	esi, 0Ah
		pop	ecx
		and	esi, 0FFFF0000h
		jbe	short loc_10010674
		push	ebx

loc_10010614:				; CODE XREF: sub_100105D3+9Ej
		push	1Ch		; dwLength
		lea	eax, [esp+38h+Buffer]
		push	eax		; lpBuffer
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualQueryEx
		test	eax, eax
		jz	short loc_10010673
		mov	eax, [esp+34h+Buffer.RegionSize]
		mov	ecx, esi
		add	eax, 0FFFFh
		sub	ecx, edi
		and	eax, 0FFFF0000h
		mov	[esp+34h+var_24], ecx
		mov	[esp+34h+var_20], eax
		cmp	ecx, eax
		lea	eax, [esp+34h+var_24]
		jb	short loc_1001064D
		lea	eax, [esp+34h+var_20]

loc_1001064D:				; CODE XREF: sub_100105D3+74j
		mov	ebx, [eax]
		test	edi, edi
		jz	short loc_1001066D
		cmp	[esp+34h+Buffer.State],	10000h
		jnz	short loc_1001066D
		push	1		; flProtect
		push	2000h		; flAllocationType
		push	ebx		; dwSize
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualAllocEx

loc_1001066D:				; CODE XREF: sub_100105D3+7Ej
					; sub_100105D3+88j
		add	edi, ebx
		cmp	edi, esi
		jb	short loc_10010614

loc_10010673:				; CODE XREF: sub_100105D3+52j
		pop	ebx

loc_10010674:				; CODE XREF: sub_100105D3+3Ej
		pop	esi

loc_10010675:				; CODE XREF: sub_100105D3+12j
		pop	edi
		mov	al, 1
		pop	ebp
		add	esp, 24h
		retn
sub_100105D3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001067D	proc near		; CODE XREF: sub_1001028F+15p
					; sub_10014B53+Ep ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [esp+arg_0]
		mov	eax, [esp+arg_4]
		and	ecx, 0FFFFFA84h
		and	eax, 0FFFFFFFEh
		or	ecx, eax
		jnz	short loc_10010696
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010696:				; CODE XREF: sub_1001067D+13j
		xor	eax, eax
		retn
sub_1001067D	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010699	proc near		; DATA XREF: .rdata:1002C7D8o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C7D0
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_100106B6
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100106B6:				; CODE XREF: sub_10010699+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10010699	endp


; =============== S U B	R O U T	I N E =======================================


sub_100106BC	proc near		; DATA XREF: .rdata:1002C7D4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	ecx, [ecx+10h]
		add	ecx, 10h
		mov	eax, [ecx]
		call	dword ptr [eax+44h]
		xor	ecx, ecx
		and	eax, 200h
		and	edx, ecx
		or	eax, edx
		jnz	short loc_100106D8

loc_100106D4:				; CODE XREF: sub_100106BC+29j
		xor	al, al
		jmp	short locret_1001074A
; ---------------------------------------------------------------------------

loc_100106D8:				; CODE XREF: sub_100106BC+16j
		mov	eax, [esp+arg_4]
		sub	eax, 13h
		jz	short loc_1001071E
		dec	eax
		jz	short loc_10010705
		dec	eax
		jnz	short loc_100106D4
		mov	eax, offset _TargetRegisterClassW@8 ; TargetRegisterClassW(x,x)
		test	eax, eax
		jz	short loc_10010745
		push	18h
		push	offset a_targetregis_0 ; "_TargetRegisterClassW@8"
		push	2
		push	offset aRegisterclassw ; "RegisterClassW"
		push	offset aUser32_dll_0 ; "user32.dll"
		jmp	short loc_1001073A
; ---------------------------------------------------------------------------

loc_10010705:				; CODE XREF: sub_100106BC+26j
		mov	eax, offset _TargetGetStockObject@8 ; TargetGetStockObject(x,x)
		test	eax, eax
		jz	short loc_10010745
		push	17h
		push	offset a_targetgetst_0 ; "_TargetGetStockObject@8"
		push	2
		push	offset aGetstockobject ; "GetStockObject"
		jmp	short loc_10010735
; ---------------------------------------------------------------------------

loc_1001071E:				; CODE XREF: sub_100106BC+23j
		mov	eax, offset _TargetGdiDllInitialize@12 ; TargetGdiDllInitialize(x,x,x)
		test	eax, eax
		jz	short loc_10010745
		push	16h		; int
		push	offset a_targetgdidl_0 ; "_TargetGdiDllInitialize@12"
		push	2		; int
		push	offset aGdidllinitiali ; "GdiDllInitialize"

loc_10010735:				; CODE XREF: sub_100106BC+60j
		push	offset aGdi32_dll ; "gdi32.dll"

loc_1001073A:				; CODE XREF: sub_100106BC+47j
		mov	ecx, [esp+14h+arg_0]
		call	sub_1000D8D2
		mov	cl, al

loc_10010745:				; CODE XREF: sub_100106BC+32j
					; sub_100106BC+50j ...
		test	cl, cl
		setnz	al

locret_1001074A:			; CODE XREF: sub_100106BC+1Aj
		retn	8
sub_100106BC	endp

; Exported entry  20. _TargetGdiDllInitialize@12

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGdiDllInitialize(x, x, x)
		public _TargetGdiDllInitialize@12
_TargetGdiDllInitialize@12 proc	near	; DATA XREF: sub_100106BC:loc_1001071Eo
					; .rdata:off_1002E058o
		xor	eax, eax
		inc	eax
		retn	0Ch
_TargetGdiDllInitialize@12 endp

; Exported entry  21. _TargetGetStockObject@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetGetStockObject(x, x)
		public _TargetGetStockObject@8
_TargetGetStockObject@8	proc near	; DATA XREF: sub_100106BC:loc_10010705o
					; .rdata:off_1002E058o
		xor	eax, eax
		retn	8
_TargetGetStockObject@8	endp

; Exported entry  41. _TargetRegisterClassW@8

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetRegisterClassW(x, x)
		public _TargetRegisterClassW@8
_TargetRegisterClassW@8	proc near	; DATA XREF: sub_100106BC+2Bo
					; .rdata:off_1002E058o
		xor	eax, eax
		inc	eax
		retn	8
_TargetRegisterClassW@8	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001075E	proc near		; CODE XREF: sub_10015277+9Fp

var_14		= byte ptr -14h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		lea	ecx, [ebp+var_14]
		push	ebx
		push	0Ah
		call	sub_1000F98B
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	13h
		call	sub_1000F6EE
		test	al, al
		jz	short loc_100107A9
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	14h
		call	sub_1000F6EE
		test	al, al
		jz	short loc_100107A9
		mov	ecx, [ebp+arg_0]
		lea	eax, [ebp+var_14]
		push	eax
		push	15h
		call	sub_1000F6EE
		test	al, al
		jz	short loc_100107A9
		mov	bl, 1
		jmp	short loc_100107AB
; ---------------------------------------------------------------------------

loc_100107A9:				; CODE XREF: sub_1001075E+21j
					; sub_1001075E+33j ...
		xor	bl, bl

loc_100107AB:				; CODE XREF: sub_1001075E+49j
		lea	ecx, [ebp+var_14]
		call	sub_1000FDA2
		mov	al, bl
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_1001075E	endp


; =============== S U B	R O U T	I N E =======================================


sub_100107BA	proc near		; DATA XREF: .rdata:1002C878o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C870
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_100107D7
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100107D7:				; CODE XREF: sub_100107BA+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_100107BA	endp


; =============== S U B	R O U T	I N E =======================================


sub_100107DD	proc near		; CODE XREF: sub_10010BFA+73p

var_3C		= dword	ptr -3Ch
var_38		= word ptr -38h
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8

		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, edx
		mov	[esp+48h+var_24], 7
		xor	ebp, ebp
		xor	eax, eax
		push	edi
		mov	ebx, ecx
		mov	[esp+4Ch+var_28], ebp
		cmp	dword ptr [esi+14h], 8
		mov	[esp+4Ch+var_38], ax
		jb	short loc_10010812
		mov	eax, [esi]
		jmp	short loc_10010814
; ---------------------------------------------------------------------------

loc_10010812:				; CODE XREF: sub_100107DD+2Fj
		mov	eax, esi

loc_10010814:				; CODE XREF: sub_100107DD+33j
		push	22h
		xor	edi, edi
		pop	ecx
		inc	edi
		cmp	[eax], cx
		push	edi
		lea	eax, [esp+50h+var_3C]
		jnz	short loc_10010845
		push	edi
		mov	[esp+54h+var_3C], ecx
		mov	ecx, esi
		push	eax
		call	sub_100036D7
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10010840
		push	esi
		mov	ecx, ebx
		call	sub_100038A0
		jmp	short loc_1001089F
; ---------------------------------------------------------------------------

loc_10010840:				; CODE XREF: sub_100107DD+57j
		dec	eax
		push	eax
		push	edi
		jmp	short loc_10010872
; ---------------------------------------------------------------------------

loc_10010845:				; CODE XREF: sub_100107DD+45j
		push	ebp
		push	eax
		mov	ecx, esi
		mov	[esp+58h+var_3C], 20h
		call	sub_100036D7
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10010870
		lea	eax, [esp+4Ch+var_38]
		cmp	eax, esi
		jz	short loc_10010893
		push	0FFFFFFFFh	; int
		push	ebp		; int
		push	esi		; int
		mov	ecx, eax	; void *
		call	sub_100023D9
		jmp	short loc_10010893
; ---------------------------------------------------------------------------

loc_10010870:				; CODE XREF: sub_100107DD+7Cj
		push	eax		; int
		push	ebp		; int

loc_10010872:				; CODE XREF: sub_100107DD+66j
		lea	eax, [esp+54h+var_20]
		mov	ecx, esi	; int
		push	eax		; void *
		call	sub_100035B5
		push	eax		; void *
		lea	ecx, [esp+50h+var_38]
		call	sub_10003B36
		push	ebp
		push	edi
		lea	ecx, [esp+54h+var_20]
		call	sub_10002311

loc_10010893:				; CODE XREF: sub_100107DD+84j
					; sub_100107DD+91j
		lea	eax, [esp+4Ch+var_38]
		mov	ecx, ebx
		push	eax		; void *
		call	sub_10003481

loc_1001089F:				; CODE XREF: sub_100107DD+61j
		push	ebp
		push	edi
		lea	ecx, [esp+54h+var_38]
		call	sub_10002311
		mov	ecx, [esp+4Ch+var_8]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 3Ch
		retn
sub_100107DD	endp


; =============== S U B	R O U T	I N E =======================================


sub_100108BF	proc near		; CODE XREF: sub_10010BFA+93p
		push	esi
		push	edi
		mov	esi, ecx
		mov	edi, offset asc_1002C7E4 ; "\\\\"
		mov	ecx, edi
		call	sub_10001AF3
		push	eax
		push	0
		push	edi
		mov	ecx, esi
		call	sub_100036D7
		test	eax, eax
		jz	short loc_100108FE
		mov	edi, offset asc_1002C7DC ; ":\\"
		mov	ecx, edi
		call	sub_10001AF3
		push	eax
		push	0
		push	edi
		mov	ecx, esi
		call	sub_100036D7
		cmp	eax, 1
		jz	short loc_100108FE
		mov	al, 1
		jmp	short loc_10010900
; ---------------------------------------------------------------------------

loc_100108FE:				; CODE XREF: sub_100108BF+1Dj
					; sub_100108BF+39j
		xor	al, al

loc_10010900:				; CODE XREF: sub_100108BF+3Dj
		pop	edi
		pop	esi
		retn
sub_100108BF	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_10010903@<eax>(LPCWSTR lpPath@<ecx>, void *)
sub_10010903	proc near		; CODE XREF: sub_10010BFA+ACp

FilePart	= dword	ptr -210h
Buffer		= word ptr -20Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 210h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+210h+var_4], eax
		and	[esp+210h+FilePart], 0
		push	ebp
		mov	ebp, 104h
		push	esi
		mov	esi, [esp+218h+arg_0]
		push	edi
		mov	edi, ecx
		test	dl, dl
		jz	short loc_10010956
		cmp	dword ptr [esi+14h], 8
		jb	short loc_1001093A
		mov	eax, [esi]
		jmp	short loc_1001093C
; ---------------------------------------------------------------------------

loc_1001093A:				; CODE XREF: sub_10010903+31j
		mov	eax, esi

loc_1001093C:				; CODE XREF: sub_10010903+35j
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	ebp		; nBufferLength
		push	0		; lpExtension
		push	eax		; lpFileName
		push	0		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jnz	short loc_10010983

loc_10010956:				; CODE XREF: sub_10010903+2Bj
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10010960
		mov	eax, [esi]
		jmp	short loc_10010962
; ---------------------------------------------------------------------------

loc_10010960:				; CODE XREF: sub_10010903+57j
		mov	eax, esi

loc_10010962:				; CODE XREF: sub_10010903+5Bj
		cmp	dword ptr [edi+14h], 8
		jb	short loc_1001096A
		mov	edi, [edi]

loc_1001096A:				; CODE XREF: sub_10010903+63j
		lea	ecx, [esp+21Ch+FilePart]
		push	ecx		; lpFilePart
		lea	ecx, [esp+220h+Buffer]
		push	ecx		; lpBuffer
		push	ebp		; nBufferLength
		push	0		; lpExtension
		push	eax		; lpFileName
		push	edi		; lpPath
		call	ds:SearchPathW
		test	eax, eax
		jz	short loc_100109A1

loc_10010983:				; CODE XREF: sub_10010903+51j
		cmp	eax, ebp
		jnb	short loc_100109A1
		lea	ecx, [esp+21Ch+Buffer]
		call	sub_10001AF3
		push	eax		; int
		lea	eax, [esp+220h+Buffer]
		mov	ecx, esi	; void *
		push	eax		; void *
		call	sub_10002356
		mov	al, 1
		jmp	short loc_100109A3
; ---------------------------------------------------------------------------

loc_100109A1:				; CODE XREF: sub_10010903+7Ej
					; sub_10010903+82j
		xor	al, al

loc_100109A3:				; CODE XREF: sub_10010903+9Cj
		mov	ecx, [esp+21Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 210h
		retn
sub_10010903	endp


; =============== S U B	R O U T	I N E =======================================


sub_100109BB	proc near		; CODE XREF: sub_10014386+13Dp

arg_0		= dword	ptr  4

		push	esi
		push	edi
		mov	edi, ecx
		xor	eax, eax
		push	offset dword_1002C8D4
		lea	esi, [edi+4]
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		mov	eax, [esp+0Ch+arg_0]
		mov	dword ptr [edi], offset	off_1002C870
		mov	[edi+10h], eax
		call	sub_1000A1C3
		push	offset dword_1002C900
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002C8A8
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002C844
		mov	ecx, esi
		call	sub_1000A1C3
		push	offset dword_1002C87C
		mov	ecx, esi
		call	sub_1000A1C3
		mov	eax, edi
		pop	edi
		pop	esi
		retn	4
sub_100109BB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010A1C	proc near		; DATA XREF: .rdata:1002C874o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		xor	ebx, ebx
		cmp	[ebp+arg_4], 9
		mov	[esp+8+var_4], ebx
		jl	short loc_10010A9B
		cmp	[ebp+arg_4], 0Ch
		jle	short loc_10010A9B
		cmp	[ebp+arg_4], 0Dh
		jnz	short loc_10010A9B
		mov	eax, offset _TargetCreateProcessW@44 ; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010A62
		mov	ecx, [ebp+arg_0]
		push	0Fh		; int
		push	offset a_targetcreat_1 ; "_TargetCreateProcessW@44"
		push	2		; int
		push	offset aCreateprocessw ; "CreateProcessW"
		push	offset aKernel32_dll_2 ; "kernel32.dll"
		call	sub_1000D8D2
		jmp	short loc_10010A64
; ---------------------------------------------------------------------------

loc_10010A62:				; CODE XREF: sub_10010A1C+27j
		mov	al, bl

loc_10010A64:				; CODE XREF: sub_10010A1C+44j
		test	al, al
		jz	short loc_10010A97
		mov	eax, offset _TargetCreateProcessA@44 ; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10010A8E
		mov	ecx, [ebp+arg_0]
		push	10h		; int
		push	offset a_targetcreat_2 ; "_TargetCreateProcessA@44"
		push	2		; int
		push	offset aCreateprocessa ; "CreateProcessA"
		push	offset ModuleName ; "kernel32.dll"
		call	sub_1000D8D2
		jmp	short loc_10010A90
; ---------------------------------------------------------------------------

loc_10010A8E:				; CODE XREF: sub_10010A1C+53j
		mov	al, bl

loc_10010A90:				; CODE XREF: sub_10010A1C+70j
		test	al, al
		jz	short loc_10010A97
		xor	ebx, ebx
		inc	ebx

loc_10010A97:				; CODE XREF: sub_10010A1C+4Aj
					; sub_10010A1C+76j
		mov	al, bl
		jmp	short loc_10010A9D
; ---------------------------------------------------------------------------

loc_10010A9B:				; CODE XREF: sub_10010A1C+12j
					; sub_10010A1C+18j ...
		xor	al, al

loc_10010A9D:				; CODE XREF: sub_10010A1C+7Dj
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10010A1C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010AA4	proc near		; DATA XREF: .rdata:1002C8FCo

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_4]
		lea	eax, [ebp+TargetHandle]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, [esi+4]
		call	sub_10011A87
		pop	ecx
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		pop	ecx
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10010AA4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010AD2	proc near		; DATA XREF: .rdata:1002C928o

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		mov	edx, [ebp+arg_4]
		lea	eax, [ebp+TargetHandle]
		push	esi
		mov	esi, [ebp+arg_0]
		push	eax		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, [esi+4]
		call	sub_10011B1A
		pop	ecx
		mov	[esi+10h], eax
		mov	eax, [ebp+TargetHandle]
		pop	ecx
		mov	[esi+18h], eax
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10010AD2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010B00	proc near		; DATA XREF: .rdata:1002C8D0o

TargetHandle	= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		lea	edx, [esp+18h+arg_0]
		xor	ebp, ebp
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		mov	[esp+18h+TargetHandle],	ebp
		mov	[esp+18h+arg_0], ebp
		mov	ebx, [edi+4]
		call	sub_10018835
		cmp	[esp+18h+arg_4], 0FFFFFFFFh
		jnz	short loc_10010B61
		lea	eax, [esp+18h+hSourceHandle]
		push	eax
		push	[esp+1Ch+arg_8]
		push	dword ptr [ebx]
		call	[esp+24h+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10010B66
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		lea	eax, [esp+24h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+2Ch+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10010B66

loc_10010B61:				; CODE XREF: sub_10010B00+2Aj
		mov	esi, 0C0000022h

loc_10010B66:				; CODE XREF: sub_10010B00+3Fj
					; sub_10010B00+5Fj
		mov	eax, [esp+18h+TargetHandle]
		mov	[edi+10h], esi
		mov	[edi+18h], eax
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_10010B00	endp


; =============== S U B	R O U T	I N E =======================================


sub_10010B7B	proc near		; DATA XREF: .rdata:1002C86Co

TargetHandle	= dword	ptr -8
hSourceHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, [esp+18h+arg_0]
		lea	edx, [esp+18h+arg_0]
		xor	ebp, ebp
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		mov	[esp+18h+TargetHandle],	ebp
		mov	[esp+18h+arg_0], ebp
		mov	ebx, [edi+4]
		call	sub_10018835
		cmp	[esp+18h+arg_4], 0FFFFFFFFh
		jnz	short loc_10010BE0
		lea	eax, [esp+18h+hSourceHandle]
		push	eax
		push	[esp+1Ch+arg_C]
		push	[esp+20h+arg_8]
		push	dword ptr [ebx]
		call	[esp+28h+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10010BE5
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		lea	eax, [esp+24h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+2Ch+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10010BE5

loc_10010BE0:				; CODE XREF: sub_10010B7B+2Aj
		mov	esi, 0C0000022h

loc_10010BE5:				; CODE XREF: sub_10010B7B+43j
					; sub_10010B7B+63j
		mov	eax, [esp+18h+TargetHandle]
		mov	[edi+10h], esi
		mov	[edi+18h], eax
		mov	al, 1
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	10h
sub_10010B7B	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10010BFA	proc near		; DATA XREF: .rdata:1002C8A4o

var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
lpPath		= dword	ptr -38h
ApplicationName	= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_8]
		push	ebx
		mov	ebx, [ebp+arg_10]
		push	esi
		mov	esi, [ebp+arg_4]
		mov	[esp+4Ch+var_44], ecx
		cmp	dword ptr [ebx], 10h
		mov	ecx, [ebp+arg_C]
		push	edi
		mov	edi, [ebp+arg_0]
		mov	[esp+50h+var_40], eax
		mov	[esp+50h+lpPath], ecx
		jz	short loc_10010C38
		xor	al, al
		jmp	loc_10010D1D
; ---------------------------------------------------------------------------

loc_10010C38:				; CODE XREF: sub_10010BFA+35j
		xor	edx, edx
		mov	[esp+50h+var_20], 7
		xor	ecx, ecx
		mov	[esp+50h+var_24], edx
		mov	[esp+50h+ApplicationName], cx
		cmp	[esi+10h], edx
		jz	short loc_10010C67
		lea	eax, [esp+50h+ApplicationName]
		cmp	eax, esi
		jz	short loc_10010C89
		push	0FFFFFFFFh	; int
		push	edx		; int
		push	esi		; int
		mov	ecx, eax	; void *
		call	sub_100023D9
		jmp	short loc_10010C89
; ---------------------------------------------------------------------------

loc_10010C67:				; CODE XREF: sub_10010BFA+56j
		mov	edx, eax
		lea	ecx, [esp+50h+var_1C]
		call	sub_100107DD
		push	eax		; void *
		lea	ecx, [esp+54h+ApplicationName]
		call	sub_10003B36
		push	0
		push	1
		lea	ecx, [esp+58h+var_1C]
		call	sub_10002311

loc_10010C89:				; CODE XREF: sub_10010BFA+5Ej
					; sub_10010BFA+6Bj
		lea	ecx, [esp+50h+ApplicationName]
		call	sub_100108BF
		test	al, al
		jz	short loc_10010CB9
		cmp	dword ptr [esi+10h], 0
		lea	eax, [esp+50h+ApplicationName]
		mov	ecx, [esp+50h+lpPath] ;	lpPath
		setz	dl
		push	eax		; void *
		call	sub_10010903
		pop	ecx
		test	al, al
		jnz	short loc_10010CB9
		mov	dword ptr [edi+10h], 2
		jmp	short loc_10010D0E
; ---------------------------------------------------------------------------

loc_10010CB9:				; CODE XREF: sub_10010BFA+9Aj
					; sub_10010BFA+B4j
		cmp	[esp+50h+var_20], 8
		mov	eax, dword ptr [esp+50h+ApplicationName]
		jnb	short loc_10010CC8
		lea	eax, [esp+50h+ApplicationName]

loc_10010CC8:				; CODE XREF: sub_10010BFA+C8j
		xor	ecx, ecx
		mov	[esp+50h+var_3C], eax
		inc	ecx
		lea	eax, [esp+50h+var_3C]
		mov	[esp+50h+var_1C], ecx
		mov	[esp+50h+var_18], ecx
		mov	ecx, [esp+50h+var_44]
		mov	[esp+50h+var_14], eax
		lea	eax, [esp+50h+var_1C]
		push	eax
		push	0Dh
		mov	ecx, [ecx+10h]
		call	sub_10015070
		push	dword ptr [ebx+4] ; lpProcessInformation
		mov	edx, [edi+4]
		lea	ecx, [esp+54h+ApplicationName]
		push	[esp+54h+var_40] ; wchar_t *
		push	ecx		; lpApplicationName
		mov	ecx, eax
		call	sub_10011BB2
		add	esp, 0Ch
		mov	[edi+10h], eax

loc_10010D0E:				; CODE XREF: sub_10010BFA+BDj
		push	0
		push	1
		lea	ecx, [esp+58h+ApplicationName]
		call	sub_10002311
		mov	al, 1

loc_10010D1D:				; CODE XREF: sub_10010BFA+39j
		mov	ecx, [esp+50h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_10010BFA	endp

; Exported entry  33. _TargetNtOpenThread@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenThread(x, x, x,	x, x)
		public _TargetNtOpenThread@20
_TargetNtOpenThread@20 proc near	; DATA XREF: sub_1000F0DF+7o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_28		= byte ptr -28h
var_1D		= byte ptr -1Dh
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	4Ch
		push	offset stru_1002DDF8
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_10]
		push	ebx
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_10], esi
		test	esi, esi
		jns	loc_10010E5E
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		call	sub_100029E2
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_10010E5C
		test	ebx, ebx
		jz	loc_10010E5C
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		cmp	[ebx], eax
		jz	short loc_10010D91
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010D91:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+59j
		test	cl, cl
		jnz	short loc_10010DB7
		test	edi, edi
		jz	short loc_10010DB7
		cmp	[edi+0Ch], eax
		jnz	short loc_10010DB2
		cmp	[edi+8], eax
		jnz	short loc_10010DB2
		cmp	[edi+4], eax
		jnz	short loc_10010DB2
		cmp	[edi+10h], eax
		jnz	short loc_10010DB2
		cmp	[edi+14h], eax
		jz	short loc_10010DB7

loc_10010DB2:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+6Bj
					; TargetNtOpenThread(x,x,x,x,x)+70j ...
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010DB7:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+62j
					; TargetNtOpenThread(x,x,x,x,x)+66j ...
		mov	eax, [ebx+4]
		mov	[ebp+arg_C], eax
		push	0FFFFFFFEh
		pop	edi
		mov	[ebp+ms_exc.registration.TryLevel], edi
		test	cl, cl
		jnz	loc_10010E5C
		push	1
		push	4
		pop	edx
		mov	ebx, [ebp+arg_4]
		mov	ecx, ebx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	short loc_10010E5C
		call	sub_10013DEB
		test	eax, eax
		jz	short loc_10010E5C
		push	eax
		lea	ecx, [ebp+var_28]
		call	sub_10015A20
		and	[ebp+var_5C], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_58]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		push	9
		pop	edx
		lea	ecx, [ebp+var_28]
		call	sub_100114C3
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10010E5C
		cmp	[ebp+var_54], eax
		jl	short loc_10010E5C
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_4C]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], edi
		xor	edx, edx
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		call	sub_10002AE3
		mov	eax, [ebp+var_54]
		jmp	short loc_10010E5E
; ---------------------------------------------------------------------------

loc_10010E45:				; DATA XREF: .rdata:stru_1002DDF8o
		xor	eax, eax	; Exception filter 1 for function 10010D31
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010E49:				; DATA XREF: .rdata:stru_1002DDF8o
		jmp	short loc_10010E4F ; Exception handler 1 for function 10010D31
; ---------------------------------------------------------------------------

loc_10010E4B:				; DATA XREF: .rdata:stru_1002DDF8o
		xor	eax, eax	; Exception filter 0 for function 10010D31
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010E4F:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x):loc_10010E49j
					; DATA XREF: .rdata:stru_1002DDF8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010D31
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_10]

loc_10010E5C:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+42j
					; TargetNtOpenThread(x,x,x,x,x)+4Aj ...
		mov	eax, esi

loc_10010E5E:				; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+24j
					; TargetNtOpenThread(x,x,x,x,x)+112j
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenThread@20 endp

; Exported entry  30. _TargetNtOpenProcess@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcess(x, x, x, x, x)
		public _TargetNtOpenProcess@20
_TargetNtOpenProcess@20	proc near	; DATA XREF: sub_1000F0DF+39o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_28		= byte ptr -28h
var_1D		= byte ptr -1Dh
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	4Ch
		push	offset stru_1002DE20
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_10]
		push	ebx
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	edi, eax
		mov	[ebp+arg_10], edi
		test	edi, edi
		jns	loc_10010F6D
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_10010F6B
		test	ebx, ebx
		jz	loc_10010F6B
		xor	eax, eax
		mov	cl, al
		mov	[ebp+ms_exc.registration.TryLevel], eax
		test	esi, esi
		jz	short loc_10010ED0
		cmp	[esi+0Ch], eax
		jnz	short loc_10010ECB
		cmp	[esi+8], eax
		jnz	short loc_10010ECB
		cmp	[esi+4], eax
		jnz	short loc_10010ECB
		cmp	[esi+10h], eax
		jnz	short loc_10010ECB
		cmp	[esi+14h], eax
		jz	short loc_10010ED0

loc_10010ECB:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+4Fj
					; TargetNtOpenProcess(x,x,x,x,x)+54j ...
		mov	cl, 1
		mov	[ebp+var_1D], cl

loc_10010ED0:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+4Aj
					; TargetNtOpenProcess(x,x,x,x,x)+63j
		mov	eax, [ebx]
		mov	[ebp+arg_C], eax
		push	0FFFFFFFEh
		pop	esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		test	cl, cl
		jnz	loc_10010F6B
		push	1
		push	4
		pop	edx
		mov	ebx, [ebp+arg_4]
		mov	ecx, ebx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	short loc_10010F6B
		call	sub_10013DEB
		test	eax, eax
		jz	short loc_10010F6B
		push	eax
		lea	ecx, [ebp+var_28]
		call	sub_10015A20
		and	[ebp+var_5C], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_58]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		push	0Ah
		pop	edx
		lea	ecx, [ebp+var_28]
		call	sub_100114C3
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10010F6B
		mov	ecx, [ebp+var_54]
		test	ecx, ecx
		jns	short loc_10010F43

loc_10010F3F:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+ECj
		mov	eax, ecx
		jmp	short loc_10010F6D
; ---------------------------------------------------------------------------

loc_10010F43:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+D7j
		mov	[ebp+ms_exc.registration.TryLevel], 1
		mov	eax, [ebp+var_4C]
		mov	[ebx], eax
		mov	[ebp+ms_exc.registration.TryLevel], esi
		jmp	short loc_10010F3F
; ---------------------------------------------------------------------------

loc_10010F54:				; DATA XREF: .rdata:stru_1002DE20o
		xor	eax, eax	; Exception filter 1 for function 10010E66
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010F58:				; DATA XREF: .rdata:stru_1002DE20o
		jmp	short loc_10010F5E ; Exception handler 1 for function 10010E66
; ---------------------------------------------------------------------------

loc_10010F5A:				; DATA XREF: .rdata:stru_1002DE20o
		xor	eax, eax	; Exception filter 0 for function 10010E66
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10010F5E:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x):loc_10010F58j
					; DATA XREF: .rdata:stru_1002DE20o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010E66
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+arg_10]

loc_10010F6B:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+33j
					; TargetNtOpenProcess(x,x,x,x,x)+3Bj ...
		mov	eax, edi

loc_10010F6D:				; CODE XREF: TargetNtOpenProcess(x,x,x,x,x)+24j
					; TargetNtOpenProcess(x,x,x,x,x)+DBj
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenProcess@20	endp

; Exported entry  31. _TargetNtOpenProcessToken@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessToken(x,	x, x, x)
		public _TargetNtOpenProcessToken@16
_TargetNtOpenProcessToken@16 proc near	; DATA XREF: sub_1000F0DF+63o
					; .rdata:off_1002E058o

var_58		= dword	ptr -58h
var_54		= byte ptr -54h
var_50		= dword	ptr -50h
var_48		= dword	ptr -48h
var_24		= byte ptr -24h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	48h
		push	offset stru_1002DE48
		call	__SEH_prolog4
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_C], esi
		test	esi, esi
		jns	loc_10011049
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_100029E2
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_10011047
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	loc_10011047
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	short loc_10011047
		call	sub_10013DEB
		test	eax, eax
		jz	short loc_10011047
		push	eax
		lea	ecx, [ebp+var_24]
		call	sub_10015A20
		and	[ebp+var_58], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_54]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_58]
		push	eax		; int
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; int
		lea	ecx, [ebp+var_24]
		call	sub_10011546
		add	esp, 18h
		test	eax, eax
		jnz	short loc_10011047
		mov	esi, [ebp+var_50]
		test	esi, esi
		js	short loc_10011047
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_48]
		mov	[edi], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edx, edx
		mov	ecx, offset aNtopenprocesst ; "NtOpenProcessToken"
		call	sub_10002AE3
		jmp	short loc_10011047
; ---------------------------------------------------------------------------

loc_10011036:				; DATA XREF: .rdata:stru_1002DE48o
		xor	eax, eax	; Exception filter 0 for function 10010F75
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001103A:				; DATA XREF: .rdata:stru_1002DE48o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10010F75
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_C]

loc_10011047:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+3Ej
					; TargetNtOpenProcessToken(x,x,x,x)+48j ...
		mov	eax, esi

loc_10011049:				; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+20j
		call	__SEH_epilog4
		retn	10h
_TargetNtOpenProcessToken@16 endp

; Exported entry  32. _TargetNtOpenProcessTokenEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenProcessTokenEx(x, x, x,	x, x)
		public _TargetNtOpenProcessTokenEx@20
_TargetNtOpenProcessTokenEx@20 proc near ; DATA	XREF: sub_1000F0DF+E7o
					; .rdata:off_1002E058o

var_54		= dword	ptr -54h
var_50		= byte ptr -50h
var_4C		= dword	ptr -4Ch
var_44		= dword	ptr -44h
var_20		= byte ptr -20h
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	44h
		push	offset stru_1002DE68
		call	__SEH_prolog4
		mov	edi, [ebp+arg_10]
		push	edi
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		mov	[ebp+arg_10], esi
		test	esi, esi
		jns	loc_1001112C
		push	2
		xor	edx, edx
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_100029E2
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_1001112A
		cmp	[ebp+arg_4], 0FFFFFFFFh
		jnz	loc_1001112A
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	short loc_1001112A
		call	sub_10013DEB
		test	eax, eax
		jz	short loc_1001112A
		push	eax
		lea	ecx, [ebp+var_20]
		call	sub_10015A20
		and	[ebp+var_54], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_50]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_54]
		push	eax		; int
		lea	eax, [ebp+arg_C]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_4]
		push	eax		; int
		lea	ecx, [ebp+var_20]
		call	sub_100115D9
		add	esp, 1Ch
		test	eax, eax
		jnz	short loc_1001112A
		mov	esi, [ebp+var_4C]
		test	esi, esi
		js	short loc_1001112A
		and	[ebp+ms_exc.registration.TryLevel], eax
		mov	eax, [ebp+var_44]
		mov	[edi], eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edx, edx
		mov	ecx, offset aNtopenproces_0 ; "NtOpenProcessTokenEx"
		call	sub_10002AE3
		jmp	short loc_1001112A
; ---------------------------------------------------------------------------

loc_10011119:				; DATA XREF: .rdata:stru_1002DE68o
		xor	eax, eax	; Exception filter 0 for function 10011051
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001111D:				; DATA XREF: .rdata:stru_1002DE68o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10011051
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	esi, [ebp+arg_10]

loc_1001112A:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+41j
					; TargetNtOpenProcessTokenEx(x,x,x,x,x)+4Bj ...
		mov	eax, esi

loc_1001112C:				; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+23j
		call	__SEH_epilog4
		retn	14h
_TargetNtOpenProcessTokenEx@20 endp

; Exported entry  19. _TargetCreateProcessW@44

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateProcessW(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessW@44
_TargetCreateProcessW@44 proc near	; DATA XREF: sub_10010A1C+20o
					; .rdata:off_1002E058o

var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
var_25C		= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_240		= byte ptr -240h
dwErrCode	= dword	ptr -23Ch
Buffer		= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_4], eax
		mov	eax, [ebp+arg_0]
		mov	ecx, [ebp+arg_20]
		mov	edx, [ebp+arg_1C]
		push	ebx
		mov	ebx, [ebp+arg_8]
		and	[esp+270h+var_254], 0
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		mov	[esp+278h+var_264], eax
		mov	eax, [ebp+arg_4]
		mov	[esp+278h+var_268], ebx
		mov	[esp+278h+var_258], ebx
		mov	ebx, [ebp+arg_28]
		push	ebx
		mov	[esp+27Ch+var_24C], eax
		mov	[esp+27Ch+var_248], eax
		mov	eax, [ebp+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[ebp+arg_18]
		mov	[esp+28Ch+var_260], ebx
		push	[ebp+arg_14]
		mov	ebx, [esp+290h+var_268]
		push	esi
		mov	esi, [esp+294h+var_24C]
		push	edi
		push	ebx
		push	esi
		call	[esp+2A0h+var_264]
		test	eax, eax
		jz	short loc_100111AF

loc_100111A7:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+165j
		xor	eax, eax
		inc	eax
		jmp	loc_100112AA
; ---------------------------------------------------------------------------

loc_100111AF:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+71j
		mov	edx, esi
		mov	ecx, offset aCreateprocessw ; "CreateProcessW"
		call	sub_100029FE
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_100112A8
		call	ds:GetLastError
		mov	ebx, [esp+278h+var_260]
		mov	ecx, ebx
		push	1
		push	10h
		pop	edx
		mov	[esp+27Ch+var_264], eax
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_1001129E
		call	sub_10013DEB
		mov	edi, eax
		test	edi, edi
		jz	loc_1001129E
		and	[esp+278h+var_268], 0
		lea	eax, [esp+278h+Buffer]
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_10011224
		cmp	eax, 104h
		jnb	short loc_10011224
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_268], eax

loc_10011224:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+DFj
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+E6j
		mov	eax, [edi+8]
		and	[esp+278h+var_244], 0
		add	eax, edi
		push	30h		; size_t
		mov	[esp+27Ch+var_25C], eax
		lea	eax, [esp+27Ch+var_240]
		push	0		; int
		push	eax		; void *
		mov	[esp+284h+var_260], edi
		call	memset
		add	esp, 0Ch
		mov	[esp+278h+var_254], 10h
		lea	eax, [esp+278h+var_244]
		mov	[esp+278h+var_250], ebx
		lea	ecx, [esp+278h+var_260]
		push	eax
		lea	eax, [esp+27Ch+var_254]
		push	eax
		lea	eax, [esp+280h+var_268]
		push	eax
		lea	eax, [esp+284h+var_258]
		push	eax
		lea	eax, [esp+288h+var_248]
		push	eax
		call	sub_10011685
		add	esp, 14h
		test	eax, eax
		jnz	short loc_1001129E
		push	[esp+278h+dwErrCode] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+278h+dwErrCode], 0
		jnz	short loc_100112A8
		mov	edx, esi
		mov	ecx, offset aCreateprocessw ; "CreateProcessW"
		call	sub_10002AFD
		jmp	loc_100111A7
; ---------------------------------------------------------------------------

loc_1001129E:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+B3j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+C2j ...
		push	[esp+278h+var_264] ; dwErrCode
		call	ds:SetLastError

loc_100112A8:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+90j
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+157j
		xor	eax, eax

loc_100112AA:				; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+76j
		mov	ecx, [esp+278h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	2Ch
_TargetCreateProcessW@44 endp

; Exported entry  18. _TargetCreateProcessA@44

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetCreateProcessA(x, x, x, x, x,	x, x, x, x, x, x)
		public _TargetCreateProcessA@44
_TargetCreateProcessA@44 proc near	; DATA XREF: sub_10010A1C+4Co
					; .rdata:off_1002E058o

var_26C		= dword	ptr -26Ch
var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_260		= dword	ptr -260h
dwErrCode	= dword	ptr -25Ch
var_258		= dword	ptr -258h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_248		= dword	ptr -248h
var_244		= dword	ptr -244h
var_240		= byte ptr -240h
var_23C		= dword	ptr -23Ch
Buffer		= word ptr -210h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h
arg_24		= dword	ptr  2Ch
arg_28		= dword	ptr  30h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_4], eax
		mov	eax, [ebp+arg_4]
		mov	ecx, [ebp+arg_20]
		mov	edx, [ebp+arg_1C]
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_10]
		push	edi
		mov	edi, [ebp+arg_C]
		and	[esp+278h+dwErrCode], 0
		mov	[esp+278h+var_26C], eax
		mov	eax, [ebp+arg_8]
		mov	[esp+278h+var_264], ebx
		mov	ebx, [ebp+arg_28]
		push	ebx
		mov	[esp+27Ch+var_268], eax
		mov	eax, [ebp+arg_24]
		push	eax
		push	ecx
		push	edx
		push	[ebp+arg_18]
		mov	[esp+28Ch+var_260], ebx
		push	[ebp+arg_14]
		mov	ebx, [esp+290h+var_264]
		push	esi
		mov	esi, [esp+294h+var_268]
		push	edi
		push	esi
		push	[esp+29Ch+var_26C]
		call	ebx
		test	eax, eax
		jz	short loc_10011335

loc_1001132D:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1FDj
		xor	eax, eax
		inc	eax
		jmp	loc_100113C4
; ---------------------------------------------------------------------------

loc_10011335:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+6Aj
		mov	ebx, [esp+278h+var_26C]
		mov	ecx, offset aCreateprocessa ; "CreateProcessA"
		push	2
		mov	edx, ebx
		call	sub_100029E2
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	short loc_100113C2
		call	ds:GetLastError
		mov	ecx, [esp+278h+var_260]
		push	1
		push	10h
		pop	edx
		mov	[esp+27Ch+dwErrCode], eax
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	short loc_100113B8
		call	sub_10013DEB
		mov	[esp+278h+var_254], eax
		test	eax, eax
		jz	short loc_100113B8
		xor	ecx, ecx
		xor	edi, edi
		mov	[esp+278h+var_26C], ecx
		test	esi, esi
		jz	short loc_1001139A
		mov	ecx, esi
		call	sub_100140A6
		mov	edi, eax
		test	edi, edi
		jz	short loc_100113B8
		mov	ecx, [esp+278h+var_26C]

loc_1001139A:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+C6j
		test	ebx, ebx
		jz	short loc_100113DB
		mov	ecx, ebx
		call	sub_100140A6
		mov	ecx, eax
		mov	[esp+278h+var_26C], eax
		test	ecx, ecx
		jnz	short loc_100113DB
		xor	edx, edx
		mov	ecx, edi
		call	sub_10014324

loc_100113B8:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+ADj
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+BAj ...
		push	[esp+278h+dwErrCode] ; dwErrCode
		call	ds:SetLastError

loc_100113C2:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+90j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1EBj
		xor	eax, eax

loc_100113C4:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+6Fj
		mov	ecx, [esp+278h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	2Ch
; ---------------------------------------------------------------------------

loc_100113DB:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+DBj
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+ECj
		xor	esi, esi
		test	edi, edi
		jz	short loc_100113EA
		mov	eax, [edi+4]
		mov	[esp+278h+var_264], eax
		jmp	short loc_100113EE
; ---------------------------------------------------------------------------

loc_100113EA:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+11Ej
		mov	[esp+278h+var_264], esi

loc_100113EE:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+127j
		test	ecx, ecx
		jz	short loc_100113FB
		mov	eax, [ecx+4]
		mov	[esp+278h+var_268], eax
		jmp	short loc_100113FF
; ---------------------------------------------------------------------------

loc_100113FB:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+12Fj
		mov	[esp+278h+var_268], esi

loc_100113FF:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+138j
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_258], esi
		push	eax		; lpBuffer
		push	104h		; nBufferLength
		call	ds:GetCurrentDirectoryW
		test	eax, eax
		jz	short loc_10011426
		cmp	eax, 104h
		jnb	short loc_10011426
		lea	eax, [esp+278h+Buffer]
		mov	[esp+278h+var_258], eax

loc_10011426:				; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+154j
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+15Bj
		mov	ecx, [esp+278h+var_254]
		push	30h		; size_t
		push	esi		; int
		mov	[esp+280h+var_24C], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		mov	[esp+280h+var_244], esi
		mov	[esp+280h+var_248], eax
		lea	eax, [esp+280h+var_240]
		push	eax		; void *
		call	memset
		mov	eax, [esp+284h+var_260]
		lea	ecx, [esp+284h+var_24C]
		add	esp, 0Ch
		mov	[esp+278h+var_250], eax
		lea	eax, [esp+278h+var_244]
		mov	[esp+278h+var_254], 10h
		push	eax
		lea	eax, [esp+27Ch+var_254]
		push	eax
		lea	eax, [esp+280h+var_258]
		push	eax
		lea	eax, [esp+284h+var_264]
		push	eax
		lea	eax, [esp+288h+var_268]
		push	eax
		call	sub_100117AA
		add	esp, 14h
		xor	edx, edx
		mov	ecx, edi
		mov	esi, eax
		call	sub_10014324
		mov	ecx, [esp+278h+var_26C]
		xor	edx, edx
		call	sub_10014324
		test	esi, esi
		jnz	loc_100113B8
		push	[esp+278h+var_23C] ; dwErrCode
		call	ds:SetLastError
		cmp	[esp+278h+var_23C], esi
		jnz	loc_100113C2
		mov	edx, ebx
		mov	ecx, offset aCreateprocessa ; "CreateProcessA"
		call	sub_10002AE3
		jmp	loc_1001132D
_TargetCreateProcessA@44 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100114C3(void	*, void	*, int)
sub_100114C3	proc near		; CODE XREF: TargetNtOpenThread(x,x,x,x,x)+E3p
					; TargetNtOpenProcess(x,x,x,x,x)+C6p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		push	esi
		push	edi
		mov	ebx, edx
		mov	edi, ecx
		call	sub_100159C9
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100114DA
		push	4
		pop	eax
		jmp	short loc_10011542
; ---------------------------------------------------------------------------

loc_100114DA:				; CODE XREF: sub_100114C3+10j
		push	ebp
		push	2
		pop	eax
		push	eax		; int
		xor	ebp, ebp
		mov	[esi], ebx
		push	ebp		; char
		push	4
		pop	ebx
		push	ebx		; size_t
		push	[esp+1Ch+arg_0]	; void *
		mov	[esi+4], ebp
		mov	ecx, esi
		mov	[esi+3Ch], eax
		push	ebp		; int
		mov	dword ptr [esi+44h], 64h
		call	sub_100118CF
		test	al, al
		jz	short loc_1001153F
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+1Ch+arg_4]	; void *
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_100118CF
		test	al, al
		jz	short loc_1001153F
		push	[esp+10h+arg_8]
		mov	ecx, edi
		push	esi
		call	sub_10015A42
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1001153F
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1001153F:				; CODE XREF: sub_100114C3+40j
					; sub_100114C3+55j ...
		mov	eax, ebx
		pop	ebp

loc_10011542:				; CODE XREF: sub_100114C3+15j
		pop	edi
		pop	esi
		pop	ebx
		retn
sub_100114C3	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011546(int,	void *,	int)
sub_10011546	proc near		; CODE XREF: TargetNtOpenProcessToken(x,x,x,x)+91p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159C9
		mov	esi, eax
		test	esi, esi
		jnz	short loc_1001155B
		push	4
		pop	eax
		jmp	short loc_100115D5
; ---------------------------------------------------------------------------

loc_1001155B:				; CODE XREF: sub_10011546+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+var_4]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 0Bh
		push	ebp		; char
		push	ebx		; size_t
		mov	[esi+4], ebp
		mov	dword ptr [esi+3Ch], 2
		push	ecx		; void *
		mov	dword ptr [esi+44h], 64h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+var_4], eax
		call	sub_100118CF
		test	al, al
		jz	short loc_100115D1
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+20h+arg_4]	; void *
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_100118CF
		test	al, al
		jz	short loc_100115D1
		push	[esp+14h+arg_8]
		mov	ecx, edi
		push	esi
		call	sub_10015A42
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_100115D1
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_100115D1:				; CODE XREF: sub_10011546+4Fj
					; sub_10011546+64j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_100115D5:				; CODE XREF: sub_10011546+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_10011546	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100115D9(int,	void *,	void *,	int)
sub_100115D9	proc near		; CODE XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+98p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	esi
		push	edi
		mov	edi, ecx
		call	sub_100159C9
		mov	esi, eax
		test	esi, esi
		jnz	short loc_100115F1
		push	4
		pop	eax
		jmp	loc_10011681
; ---------------------------------------------------------------------------

loc_100115F1:				; CODE XREF: sub_100115D9+Ej
		mov	eax, [esp+0Ch+arg_0]
		lea	ecx, [esp+0Ch+var_4]
		push	ebx
		push	ebp
		push	4
		pop	ebx
		push	ebx		; int
		xor	ebp, ebp
		mov	dword ptr [esi], 0Ch
		push	ebp		; char
		push	ebx		; size_t
		mov	[esi+4], ebp
		mov	dword ptr [esi+3Ch], 3
		push	ecx		; void *
		mov	dword ptr [esi+44h], 70h
		mov	ecx, esi
		mov	eax, [eax]
		push	ebp		; int
		mov	[esp+28h+var_4], eax
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1001167D
		push	2		; int
		push	ebp		; char
		push	ebx		; size_t
		push	[esp+20h+arg_4]	; void *
		inc	ebp
		mov	ecx, esi
		push	ebp		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1001167D
		push	2		; int
		push	0		; char
		push	ebx		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, esi
		push	2		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_1001167D
		push	[esp+14h+arg_C]
		mov	ecx, edi
		push	esi
		call	sub_10015A42
		mov	ebx, eax
		cmp	ebx, 0Ah
		jz	short loc_1001167D
		sub	esi, [edi+4]
		mov	eax, [edi]
		shr	esi, 0Ah
		add	eax, 0Ch
		imul	edx, esi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1001167D:				; CODE XREF: sub_100115D9+52j
					; sub_100115D9+67j ...
		pop	ebp
		mov	eax, ebx
		pop	ebx

loc_10011681:				; CODE XREF: sub_100115D9+13j
		pop	edi
		pop	esi
		pop	ecx
		retn
sub_100115D9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011685	proc near		; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+13Cp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100116A0

loc_10011698:				; CODE XREF: sub_10011685+59j
					; sub_10011685+7Dj ...
		push	4

loc_1001169A:				; CODE XREF: sub_10011685+10Aj
		pop	eax
		jmp	loc_100117A3
; ---------------------------------------------------------------------------

loc_100116A0:				; CODE XREF: sub_10011685+11j
		mov	esi, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_8]
		and	dword ptr [edi+4], 0
		xor	ebx, ebx
		mov	dword ptr [edi], 0Dh
		inc	ebx
		mov	dword ptr [edi+3Ch], 4
		push	ebx		; int
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		push	0		; char
		mov	[esp+20h+var_8], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	short loc_10011698
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+var_8]
		mov	esi, [esi]
		mov	[esp+18h+var_8], esi
		call	sub_1000A366
		push	ebx		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	short loc_10011698
		mov	esi, [esp+18h+arg_8]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	2		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	loc_10011698
		mov	eax, [esp+18h+arg_C]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+28h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+2Ch+var_4], eax
		call	sub_1000D5A8
		test	al, al
		jz	loc_10011698
		push	[esp+18h+arg_10]
		mov	ecx, ebp
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_100117A1
		mov	ecx, [edi+68h]
		add	ecx, edi
		push	ecx		; void *
		lea	ecx, [esp+1Ch+var_8]
		call	sub_1000A3BB
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_10011794
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_1001169A
; ---------------------------------------------------------------------------

loc_10011794:				; CODE XREF: sub_10011685+F9j
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_100117A1:				; CODE XREF: sub_10011685+E0j
		mov	eax, esi

loc_100117A3:				; CODE XREF: sub_10011685+16j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_10011685	endp


; =============== S U B	R O U T	I N E =======================================


sub_100117AA	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+1B7p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100117C5

loc_100117BD:				; CODE XREF: sub_100117AA+59j
					; sub_100117AA+7Dj ...
		push	4

loc_100117BF:				; CODE XREF: sub_100117AA+10Aj
		pop	eax
		jmp	loc_100118C8
; ---------------------------------------------------------------------------

loc_100117C5:				; CODE XREF: sub_100117AA+11j
		mov	esi, [esp+18h+arg_0]
		lea	ecx, [esp+18h+var_8]
		and	dword ptr [edi+4], 0
		xor	ebx, ebx
		inc	ebx
		mov	dword ptr [edi], 0Dh
		push	ebx		; int
		mov	esi, [esi]
		mov	dword ptr [edi+3Ch], 4
		push	0		; char
		mov	dword ptr [edi+44h], 7Ch
		mov	[esp+20h+var_8], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	short loc_100117BD
		mov	esi, [esp+18h+arg_4]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	ebx		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	short loc_100117BD
		mov	esi, [esp+18h+arg_8]
		lea	ecx, [esp+18h+var_8]
		push	ebx		; int
		push	0		; char
		mov	esi, [esi]
		mov	[esp+20h+var_8], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	2		; int
		mov	ecx, edi
		call	sub_1000D5A8
		test	al, al
		jz	loc_100117BD
		mov	eax, [esp+18h+arg_C]
		push	6		; int
		push	ebx		; char
		mov	ecx, [eax]
		mov	eax, [eax+4]
		push	ecx		; size_t
		push	eax		; void *
		mov	[esp+28h+var_8], ecx
		mov	ecx, edi
		push	3		; int
		mov	[esp+2Ch+var_4], eax
		call	sub_1000D5A8
		test	al, al
		jz	loc_100117BD
		push	[esp+18h+arg_10]
		mov	ecx, ebp
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_100118C6
		mov	ecx, [edi+68h]
		add	ecx, edi
		push	ecx		; void *
		lea	ecx, [esp+1Ch+var_8]
		call	sub_1000A3BB
		sub	edi, [ebp+4]
		shr	edi, 0Ah
		test	al, al
		jnz	short loc_100118B9
		mov	ecx, [ebp+0]
		imul	edx, edi, 14h
		add	ecx, 0Ch
		add	ecx, edx
		xchg	ebx, [ecx]
		push	2
		jmp	loc_100117BF
; ---------------------------------------------------------------------------

loc_100118B9:				; CODE XREF: sub_100117AA+F9j
		mov	eax, [ebp+0]
		imul	ecx, edi, 14h
		add	eax, 0Ch
		add	eax, ecx
		xchg	ebx, [eax]

loc_100118C6:				; CODE XREF: sub_100117AA+E0j
		mov	eax, esi

loc_100118C8:				; CODE XREF: sub_100117AA+16j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn
sub_100117AA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_100118CF(int, void *, size_t, char,	int)
sub_100118CF	proc near		; CODE XREF: sub_100114C3+39p
					; sub_100114C3+4Ep ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DE88
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 2
		jnb	loc_10011975
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_10011975
		test	esi, esi
		jz	short loc_100118FF
		cmp	[ebp+arg_4], 0
		jz	short loc_10011975

loc_100118FF:				; CODE XREF: sub_100118CF+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_10011975
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_10011975
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_10011940
		mov	dword ptr [edi+4], 1

loc_10011940:				; CODE XREF: sub_100118CF+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_10011977
; ---------------------------------------------------------------------------

loc_10011967:				; DATA XREF: .rdata:stru_1002DE88o
		xor	eax, eax	; Exception filter 0 for function 100118CF
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_1001196B:				; DATA XREF: .rdata:stru_1002DE88o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100118CF
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_10011975:				; CODE XREF: sub_100118CF+14j
					; sub_100118CF+20j ...
		xor	al, al

loc_10011977:				; CODE XREF: sub_100118CF+96j
		call	__SEH_epilog4
		retn	14h
sub_100118CF	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_1001197F@<eax>(HANDLE hTargetProcessHandle@<ecx>, LPCWSTR lpApplicationName, LPWSTR lpCommandLine,	int, int, int, int, int, int, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
sub_1001197F	proc near		; CODE XREF: sub_10011BB2+69p

lpApplicationName= dword ptr  4
lpCommandLine	= dword	ptr  8
lpStartupInfo	= dword	ptr  24h
lpProcessInformation= dword ptr	 28h

		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+0Ch+lpProcessInformation]
		xor	eax, eax
		push	esi		; lpProcessInformation
		push	[esp+10h+lpStartupInfo]	; lpStartupInfo
		mov	ebx, edx
		mov	ebp, ecx
		push	eax		; lpCurrentDirectory
		push	eax		; lpEnvironment
		push	eax		; dwCreationFlags
		push	eax		; bInheritHandles
		push	eax		; lpThreadAttributes
		push	eax		; lpProcessAttributes
		push	[esp+2Ch+lpCommandLine]	; lpCommandLine
		push	[esp+30h+lpApplicationName] ; lpApplicationName
		call	ds:CreateProcessW
		test	eax, eax
		jz	short loc_10011A07
		mov	eax, 101C01h
		push	edi
		mov	edi, 100C43h
		test	ebx, ebx
		jz	short loc_100119C2
		mov	eax, 1F0FFFh
		mov	edi, 1F03FFh

loc_100119C2:				; CODE XREF: sub_1001197F+37j
		mov	ebx, ds:GetCurrentProcess
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	eax		; dwDesiredAccess
		push	esi		; lpTargetHandle
		push	ebp		; hTargetProcessHandle
		push	dword ptr [esi]	; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_100119EB
		push	dword ptr [esi+4] ; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	short loc_10011A06
; ---------------------------------------------------------------------------

loc_100119EB:				; CODE XREF: sub_1001197F+5Dj
		push	1		; dwOptions
		push	0		; bInheritHandle
		push	edi		; dwDesiredAccess
		lea	eax, [esi+4]
		push	eax		; lpTargetHandle
		push	ebp		; hTargetProcessHandle
		push	dword ptr [eax]	; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		neg	eax

loc_10011A06:				; CODE XREF: sub_1001197F+6Aj
		pop	edi

loc_10011A07:				; CODE XREF: sub_1001197F+28j
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_1001197F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011A0B	proc near		; CODE XREF: sub_10015277+106p

arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ecx
		sub	edx, 7
		jz	short loc_10011A2C
		dec	edx
		jnz	short loc_10011A6B
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10011A46
		push	6
		jmp	short loc_10011A3B
; ---------------------------------------------------------------------------

loc_10011A2C:				; CODE XREF: sub_10011A0B+Bj
		push	10h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10011A46
		push	5

loc_10011A3B:				; CODE XREF: sub_10011A0B+1Fj
		mov	ecx, eax
		call	sub_1000F98B
		mov	esi, eax
		jmp	short loc_10011A48
; ---------------------------------------------------------------------------

loc_10011A46:				; CODE XREF: sub_10011A0B+1Bj
					; sub_10011A0B+2Cj
		xor	esi, esi

loc_10011A48:				; CODE XREF: sub_10011A0B+39j
		xor	ebx, ebx
		inc	ebx
		push	ebx
		push	edi
		push	ecx
		push	0
		mov	ecx, esi
		call	sub_1000FB42
		test	al, al
		jz	short loc_10011A6B
		mov	ecx, [esp+10h+arg_0]
		push	esi
		push	0Dh
		call	sub_1000F6EE
		test	al, al
		jnz	short loc_10011A6D

loc_10011A6B:				; CODE XREF: sub_10011A0B+Ej
					; sub_10011A0B+4Ej
		xor	bl, bl

loc_10011A6D:				; CODE XREF: sub_10011A0B+5Ej
		test	esi, esi
		jz	short loc_10011A80
		mov	ecx, esi
		call	sub_1000FDA2
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10011A80:				; CODE XREF: sub_10011A0B+64j
		pop	edi
		pop	esi
		mov	al, bl
		pop	ebx
		pop	ecx
		retn
sub_10011A0B	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011A87(int,	LPHANDLE lpTargetHandle)
sub_10011A87	proc near		; CODE XREF: sub_10010AA4+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		sub	esp, 24h
		push	ebx
		push	ebp
		mov	ebp, [esp+2Ch+lpTargetHandle]
		mov	ebx, ecx
		and	[esp+2Ch+lpTargetHandle], 0
		mov	ecx, offset aNtopenthread ; "NtOpenThread"
		push	esi
		mov	esi, edx
		lea	edx, [esp+30h+lpTargetHandle]
		and	dword ptr [ebp+0], 0
		push	edi
		call	sub_10018835
		xor	eax, eax
		lea	edi, [esp+34h+var_14]
		stosd
		stosd
		stosd
		stosd
		stosd
		mov	eax, [ebx+8]
		xor	edi, edi
		mov	[esp+34h+var_20], eax
		mov	eax, [esp+34h+arg_0]
		mov	[esp+34h+var_1C], edi
		mov	[esp+34h+var_1C], eax
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+var_18], 18h
		push	eax
		push	esi
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	esi, eax
		test	esi, esi
		js	short loc_10011B10
		push	3		; dwOptions
		push	edi		; bInheritHandle
		push	edi		; dwDesiredAccess
		push	ebp		; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10011B12

loc_10011B10:				; CODE XREF: sub_10011A87+66j
		mov	eax, esi

loc_10011B12:				; CODE XREF: sub_10011A87+87j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10011A87	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10011B1A(int,	LPHANDLE lpTargetHandle)
sub_10011B1A	proc near		; CODE XREF: sub_10010AD2+15p

hSourceHandle	= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= byte ptr -14h
arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		sub	esp, 24h
		push	ebx
		mov	ebx, [esp+28h+lpTargetHandle]
		and	[esp+28h+lpTargetHandle], 0
		push	ebp
		push	esi
		and	dword ptr [ebx], 0
		mov	ebp, edx
		mov	esi, ecx
		lea	edx, [esp+30h+lpTargetHandle]
		mov	ecx, offset aNtopenprocess ; "NtOpenProcess"
		call	sub_10018835
		mov	ecx, [esi+8]
		cmp	ecx, [esp+30h+arg_0]
		jz	short loc_10011B4E
		mov	eax, 0C0000022h
		jmp	short loc_10011BAB
; ---------------------------------------------------------------------------

loc_10011B4E:				; CODE XREF: sub_10011B1A+2Bj
		push	edi
		xor	eax, eax
		and	[esp+34h+var_1C], 0
		lea	edi, [esp+34h+var_14]
		mov	[esp+34h+var_20], ecx
		stosd
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+34h+var_20]
		push	eax
		lea	eax, [esp+38h+var_18]
		mov	[esp+38h+var_18], 18h
		push	eax
		push	ebp
		lea	eax, [esp+40h+hSourceHandle]
		push	eax
		call	[esp+44h+lpTargetHandle]
		mov	edi, eax
		test	edi, edi
		js	short loc_10011BA8
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	ebx		; lpTargetHandle
		push	dword ptr [esi]	; hTargetProcessHandle
		push	[esp+48h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10011BAA

loc_10011BA8:				; CODE XREF: sub_10011B1A+69j
		mov	eax, edi

loc_10011BAA:				; CODE XREF: sub_10011B1A+8Cj
		pop	edi

loc_10011BAB:				; CODE XREF: sub_10011B1A+32j
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 24h
		retn
sub_10011B1A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10011BB2(LPCWSTR lpApplicationName, wchar_t *, LPPROCESS_INFORMATION lpProcessInformation)
sub_10011BB2	proc near		; CODE XREF: sub_10010BFA+109p

StartupInfo	= _STARTUPINFOW	ptr -44h
lpApplicationName= dword ptr  8
arg_4		= dword	ptr  0Ch
lpProcessInformation= dword ptr	 10h

		push	ebp
		mov	ebp, esp
		sub	esp, 44h
		push	ebx
		push	edi
		mov	edi, ecx
		mov	ebx, edx
		cmp	edi, 6
		jz	short loc_10011BCD
		cmp	edi, 5
		jz	short loc_10011BCD
		push	5
		pop	eax
		jmp	short loc_10011C3C
; ---------------------------------------------------------------------------

loc_10011BCD:				; CODE XREF: sub_10011BB2+Fj
					; sub_10011BB2+14j
		push	40h		; size_t
		lea	eax, [ebp+StartupInfo.lpReserved]
		push	0		; int
		push	eax		; void *
		call	memset
		mov	eax, [ebp+arg_4]
		add	esp, 0Ch
		mov	[ebp+StartupInfo.cb], 44h
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10011BEF
		mov	eax, [eax]

loc_10011BEF:				; CODE XREF: sub_10011BB2+39j
		push	esi
		push	eax		; wchar_t *
		call	ds:_wcsdup
		xor	edx, edx
		mov	esi, eax
		mov	eax, [ebp+lpApplicationName]
		cmp	edi, 6
		pop	ecx
		setz	dl
		cmp	dword ptr [eax+14h], 8
		jb	short loc_10011C0D
		mov	eax, [eax]

loc_10011C0D:				; CODE XREF: sub_10011BB2+57j
		push	[ebp+lpProcessInformation] ; lpProcessInformation
		lea	ecx, [ebp+StartupInfo]
		push	ecx		; lpStartupInfo
		mov	ecx, [ebx]	; hTargetProcessHandle
		sub	esp, 18h
		push	esi		; lpCommandLine
		push	eax		; lpApplicationName
		call	sub_1001197F
		add	esp, 28h
		mov	edi, eax
		neg	edi
		sbb	edi, edi
		and	edi, 0FFFFFFFBh
		test	esi, esi
		jz	short loc_10011C38
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10011C38:				; CODE XREF: sub_10011BB2+7Cj
		lea	eax, [edi+5]
		pop	esi

loc_10011C3C:				; CODE XREF: sub_10011BB2+19j
		pop	edi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10011BB2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011C42	proc near		; DATA XREF: .rdata:1002C9F4o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002C9EC
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_10011C5F
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10011C5F:				; CODE XREF: sub_10011C42+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_10011C42	endp


; =============== S U B	R O U T	I N E =======================================


sub_10011C65	proc near		; CODE XREF: sub_10011D74+7Ap
					; sub_10011EDC+7Ap

arg_0		= dword	ptr  4

		push	esi
		mov	esi, edx
		test	ecx, ecx
		jz	short loc_10011CA4
		mov	edx, [esp+4+arg_0]
		call	sub_1001873D
		test	al, al
		jnz	short loc_10011C7B
		pop	esi
		retn
; ---------------------------------------------------------------------------

loc_10011C7B:				; CODE XREF: sub_10011C65+12j
		push	edi
		mov	edi, offset asc_1002BB98 ; "\\"
		mov	ecx, edi
		call	sub_10001AF3
		mov	ecx, [esp+8+arg_0]
		push	eax		; int
		push	edi		; void *
		call	sub_10003388
		mov	ecx, [esp+8+arg_0]
		push	0FFFFFFFFh
		push	0
		push	esi
		call	sub_100032F4
		pop	edi
		jmp	short loc_10011CB6
; ---------------------------------------------------------------------------

loc_10011CA4:				; CODE XREF: sub_10011C65+5j
		mov	ecx, [esp+4+arg_0] ; void *
		cmp	ecx, esi
		jz	short loc_10011CB6
		push	0FFFFFFFFh	; int
		push	0		; int
		push	esi		; int
		call	sub_100023D9

loc_10011CB6:				; CODE XREF: sub_10011C65+3Dj
					; sub_10011C65+45j
		mov	al, 1
		pop	esi
		retn
sub_10011C65	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011CBA	proc near		; DATA XREF: .rdata:1002C9F0o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_4], 10h
		jnz	short loc_10011CF0
		mov	eax, offset _TargetNtCreateKey@32 ; TargetNtCreateKey(x,x,x,x,x,x,x,x)
		test	eax, eax
		jz	loc_10011D6E
		mov	ecx, [ebp+arg_0]
		push	11h		; int
		push	offset a_targetntcre_3 ; "_TargetNtCreateKey@32"
		push	1		; int
		push	offset aNtcreatekey ; "NtCreateKey"
		push	offset aNtdll_dll_2 ; "ntdll.dll"
		call	sub_1000D8D2
		jmp	loc_10011D70
; ---------------------------------------------------------------------------

loc_10011CF0:				; CODE XREF: sub_10011CBA+7j
		cmp	[ebp+arg_4], 11h
		jnz	short loc_10011D6E
		push	ebx
		mov	eax, offset _TargetNtOpenKey@16	; TargetNtOpenKey(x,x,x,x)
		push	esi
		mov	esi, offset aNtdll_dll_2 ; "ntdll.dll"
		test	eax, eax
		jz	short loc_10011D21
		mov	ecx, [ebp+arg_0]
		push	12h		; int
		push	offset a_targetntope_6 ; "_TargetNtOpenKey@16"
		push	1		; int
		push	offset aNtopenkey ; "NtOpenKey"
		push	esi		; void *
		call	sub_1000D8D2
		mov	bl, al
		jmp	short loc_10011D23
; ---------------------------------------------------------------------------

loc_10011D21:				; CODE XREF: sub_10011CBA+4Aj
		xor	bl, bl

loc_10011D23:				; CODE XREF: sub_10011CBA+65j
		call	sub_100063D2
		cmp	dword ptr [eax], 4
		jge	short loc_10011D42
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jnz	short loc_10011D68
		call	sub_100063D2
		cmp	dword ptr [eax+10h], 2
		jnz	short loc_10011D68

loc_10011D42:				; CODE XREF: sub_10011CBA+71j
		mov	eax, offset _TargetNtOpenKeyEx@20 ; TargetNtOpenKeyEx(x,x,x,x,x)
		test	eax, eax
		jz	short loc_10011D64
		mov	ecx, [ebp+arg_0]
		push	13h		; int
		push	offset a_targetntope_7 ; "_TargetNtOpenKeyEx@20"
		push	1		; int
		push	offset aNtopenkeyex ; "NtOpenKeyEx"
		push	esi		; void *
		call	sub_1000D8D2
		jmp	short loc_10011D66
; ---------------------------------------------------------------------------

loc_10011D64:				; CODE XREF: sub_10011CBA+8Fj
		xor	eax, eax

loc_10011D66:				; CODE XREF: sub_10011CBA+A8j
		and	bl, al

loc_10011D68:				; CODE XREF: sub_10011CBA+7Bj
					; sub_10011CBA+86j
		pop	esi
		mov	al, bl
		pop	ebx
		jmp	short loc_10011D70
; ---------------------------------------------------------------------------

loc_10011D6E:				; CODE XREF: sub_10011CBA+10j
					; sub_10011CBA+3Aj
		xor	al, al

loc_10011D70:				; CODE XREF: sub_10011CBA+31j
					; sub_10011CBA+B2j
		pop	ebp
		retn	8
sub_10011CBA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011D74	proc near		; DATA XREF: .rdata:1002C9BCo

hSourceHandle	= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
TargetHandle	= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 4Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+4Ch+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[esp+4Ch+var_40], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [esp+58h+var_1C]
		push	edi
		mov	[esp+5Ch+hSourceHandle], eax
		call	sub_100038A0
		mov	ecx, [esp+58h+hSourceHandle]
		test	ecx, ecx
		jz	short loc_10011DE7
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+64h+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[esp+6Ch+hSourceHandle]	; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10011DF8
		push	[esp+58h+hSourceHandle]
		lea	ecx, [esp+5Ch+var_40]
		call	sub_10004610
		mov	ecx, [esp+58h+hSourceHandle]

loc_10011DE7:				; CODE XREF: sub_10011D74+3Bj
		lea	eax, [esp+58h+var_1C]
		mov	edx, edi
		push	eax
		call	sub_10011C65
		pop	ecx
		test	al, al
		jnz	short loc_10011DFF

loc_10011DF8:				; CODE XREF: sub_10011D74+60j
		xor	bl, bl
		jmp	loc_10011EB0
; ---------------------------------------------------------------------------

loc_10011DFF:				; CODE XREF: sub_10011D74+82j
		cmp	[esp+58h+var_8], 8
		mov	eax, [esp+58h+var_1C]
		jnb	short loc_10011E0E
		lea	eax, [esp+58h+var_1C]

loc_10011E0E:				; CODE XREF: sub_10011D74+94j
		xor	edx, edx
		mov	[esp+58h+var_3C], eax
		inc	edx
		mov	[esp+58h+var_30], 2
		lea	eax, [esp+58h+var_2C]
		mov	ecx, edx

loc_10011E23:				; CODE XREF: sub_10011D74+BAj
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10011E23
		mov	ecx, [ebx+10h]
		lea	eax, [esp+58h+var_3C]
		mov	[esp+58h+var_28], eax
		lea	eax, [ebp+arg_10]
		mov	[esp+58h+var_20], eax
		lea	eax, [esp+58h+var_30]
		push	eax
		push	10h
		mov	[esp+60h+var_2C], edx
		mov	[esp+60h+var_24], 2
		call	sub_10015070
		mov	edx, [esi+4]
		lea	ecx, [esp+58h+var_44]
		push	ecx		; int
		and	[esp+5Ch+var_44], 0
		lea	ecx, [esp+5Ch+var_34]
		push	ecx		; int
		lea	ecx, [esp+60h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_18]	; int
		mov	ecx, eax
		push	[ebp+arg_14]	; int
		push	[ebp+arg_10]	; int
		push	[esp+70h+hSourceHandle]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_100128C9
		add	esp, 24h
		mov	bl, 1
		test	al, al
		jnz	short loc_10011E9B
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_10011EB0
; ---------------------------------------------------------------------------

loc_10011E9B:				; CODE XREF: sub_10011D74+11Cj
		mov	eax, [esp+58h+var_44]
		mov	[esi+1Ch], eax
		mov	eax, [esp+58h+var_34]
		mov	[esi+10h], eax
		mov	eax, [esp+58h+TargetHandle]
		mov	[esi+18h], eax

loc_10011EB0:				; CODE XREF: sub_10011D74+86j
					; sub_10011D74+125j
		push	0
		push	1
		lea	ecx, [esp+60h+var_1C]
		call	sub_10002311
		lea	ecx, [esp+58h+var_40]
		call	sub_10004646
		mov	ecx, [esp+58h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	1Ch
sub_10011D74	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10011EDC	proc near		; DATA XREF: .rdata:1002C9E8o

hSourceHandle	= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
TargetHandle	= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 44h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+44h+var_4], eax
		mov	eax, [ebp+arg_C]
		and	[esp+44h+var_40], 0
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, ecx
		push	edi
		mov	edi, [ebp+arg_4]
		lea	ecx, [esp+50h+var_1C]
		push	edi
		mov	[esp+54h+hSourceHandle], eax
		call	sub_100038A0
		mov	ecx, [esp+50h+hSourceHandle]
		test	ecx, ecx
		jz	short loc_10011F4F
		push	2		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		lea	eax, [esp+5Ch+hSourceHandle]
		push	eax		; lpTargetHandle
		call	ds:GetCurrentProcess
		push	eax		; hTargetProcessHandle
		mov	eax, [esi+4]
		push	[esp+64h+hSourceHandle]	; hSourceHandle
		push	dword ptr [eax]	; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10011F60
		push	[esp+50h+hSourceHandle]
		lea	ecx, [esp+54h+var_40]
		call	sub_10004610
		mov	ecx, [esp+50h+hSourceHandle]

loc_10011F4F:				; CODE XREF: sub_10011EDC+3Bj
		lea	eax, [esp+50h+var_1C]
		mov	edx, edi
		push	eax
		call	sub_10011C65
		pop	ecx
		test	al, al
		jnz	short loc_10011F67

loc_10011F60:				; CODE XREF: sub_10011EDC+60j
		xor	bl, bl
		jmp	loc_10012001
; ---------------------------------------------------------------------------

loc_10011F67:				; CODE XREF: sub_10011EDC+82j
		cmp	[esp+50h+var_8], 8
		mov	eax, [esp+50h+var_1C]
		jnb	short loc_10011F76
		lea	eax, [esp+50h+var_1C]

loc_10011F76:				; CODE XREF: sub_10011EDC+94j
		xor	edx, edx
		mov	[esp+50h+var_34], eax
		inc	edx
		mov	[esp+50h+var_30], 2
		lea	eax, [esp+50h+var_2C]
		mov	ecx, edx

loc_10011F8B:				; CODE XREF: sub_10011EDC+BAj
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10011F8B
		mov	ecx, [ebx+10h]
		lea	eax, [esp+50h+var_34]
		mov	[esp+50h+var_28], eax
		lea	eax, [ebp+arg_10]
		mov	[esp+50h+var_20], eax
		lea	eax, [esp+50h+var_30]
		push	eax
		push	11h
		mov	[esp+58h+var_2C], edx
		mov	[esp+58h+var_24], 2
		call	sub_10015070
		mov	edx, [esi+4]
		lea	ecx, [esp+50h+var_3C]
		push	ecx		; int
		lea	ecx, [esp+54h+TargetHandle]
		push	ecx		; lpTargetHandle
		push	[ebp+arg_10]	; int
		mov	ecx, eax
		push	[esp+5Ch+hSourceHandle]	; int
		push	[ebp+arg_8]	; int
		push	edi		; int
		call	sub_10012949
		add	esp, 18h
		mov	bl, 1
		test	al, al
		jnz	short loc_10011FF3
		mov	dword ptr [esi+10h], 0C0000022h
		jmp	short loc_10012001
; ---------------------------------------------------------------------------

loc_10011FF3:				; CODE XREF: sub_10011EDC+10Cj
		mov	eax, [esp+50h+var_3C]
		mov	[esi+10h], eax
		mov	eax, [esp+50h+TargetHandle]
		mov	[esi+18h], eax

loc_10012001:				; CODE XREF: sub_10011EDC+86j
					; sub_10011EDC+115j
		push	0
		push	1
		lea	ecx, [esp+58h+var_1C]
		call	sub_10002311
		lea	ecx, [esp+50h+var_40]
		call	sub_10004646
		mov	ecx, [esp+50h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	14h
sub_10011EDC	endp

; Exported entry  24. _TargetNtCreateKey@32

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateKey(x, x, x, x, x, x,	x, x)
		public _TargetNtCreateKey@32
_TargetNtCreateKey@32 proc near		; DATA XREF: sub_10011CBA+9o
					; .rdata:off_1002E058o

var_5C		= dword	ptr -5Ch
var_58		= byte ptr -58h
var_54		= dword	ptr -54h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_28		= byte ptr -28h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	4Ch
		push	offset stru_1002DEA8
		call	__SEH_prolog4
		mov	ebx, [ebp+arg_1C]
		push	ebx
		push	[ebp+arg_18]
		mov	esi, [ebp+arg_14]
		push	esi
		push	[ebp+arg_10]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		mov	ecx, [ebp+arg_4]
		push	ecx
		call	[ebp+arg_0]
		mov	edi, eax
		mov	[ebp+var_20], edi
		test	edi, edi
		jns	loc_100121BE
		cmp	edi, 0C0000034h
		jz	short loc_10012081
		mov	eax, [ebp+arg_C]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002A69
		pop	ecx

loc_10012081:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+3Aj
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_100121BC
		push	1
		push	4
		pop	edx
		mov	ecx, [ebp+arg_4]
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_100121BC
		test	ebx, ebx
		jz	short loc_100120BF
		push	1
		push	4
		pop	edx
		mov	ecx, ebx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_100121BC

loc_100120BF:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+7Bj
		xor	ebx, ebx
		test	esi, esi
		jz	short loc_100120D3
		cmp	[esi+4], ebx
		jz	short loc_100120D3
		cmp	[esi], bx
		jnz	loc_100121BC

loc_100120D3:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+96j
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+9Bj
		cmp	[ebp+arg_18], 0
		jnz	loc_100121BC
		call	sub_10013DEB
		mov	esi, eax
		test	esi, esi
		jz	loc_100121BC
		mov	[ebp+var_1C], ebx
		mov	[ebp+arg_0], ebx
		lea	eax, [ebp+arg_0]
		push	eax
		lea	eax, [ebp+var_1C]
		push	eax
		lea	edx, [ebp+arg_14]
		mov	ecx, [ebp+arg_C]
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_100121BC
		cmp	[ebp+arg_14], 0
		jz	loc_100121BC
		push	esi
		lea	ecx, [ebp+var_28]
		call	sub_10015A20
		mov	[ebp+var_5C], ebx
		push	30h		; size_t
		push	ebx		; int
		lea	eax, [ebp+var_58]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_5C]
		push	eax		; int
		lea	eax, [ebp+arg_18]
		push	eax		; void *
		lea	eax, [ebp+arg_10]
		push	eax		; void *
		lea	eax, [ebp+arg_8]
		push	eax		; void *
		lea	eax, [ebp+arg_0]
		push	eax		; int
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	eax, [ebp+arg_14]
		push	eax		; int
		lea	ecx, [ebp+var_28]
		call	sub_10012366
		add	esp, 28h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, [ebp+arg_14]
		call	sub_10014324
		test	esi, esi
		jnz	short loc_100121BC
		cmp	[ebp+var_54], esi
		jl	short loc_100121BC
		mov	[ebp+ms_exc.registration.TryLevel], ebx
		mov	eax, [ebp+var_4C]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		mov	ecx, [ebp+arg_1C]
		test	ecx, ecx
		jz	short loc_10012184
		mov	eax, [ebp+var_48]
		mov	[ecx], eax

loc_10012184:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+150j
		mov	edi, [ebp+var_54]
		mov	[ebp+var_20], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+arg_C]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_100121BC
; ---------------------------------------------------------------------------

loc_100121AB:				; DATA XREF: .rdata:stru_1002DEA8o
		xor	eax, eax	; Exception filter 0 for function 1001202D
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100121AF:				; DATA XREF: .rdata:stru_1002DEA8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001202D
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_20]

loc_100121BC:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+5Dj
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+73j ...
		mov	eax, edi

loc_100121BE:				; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+2Ej
		call	__SEH_epilog4
		retn	20h
_TargetNtCreateKey@32 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100121C6	proc near		; CODE XREF: TargetNtOpenKey(x,x,x,x)+3Ep
					; TargetNtOpenKeyEx(x,x,x,x,x)+47p

var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_5C		= dword	ptr -5Ch
var_54		= dword	ptr -54h
var_30		= byte ptr -30h
var_28		= byte ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch

		push	54h
		push	offset stru_1002DEC8
		call	__SEH_prolog4
		mov	ebx, edx
		mov	edi, ecx
		mov	[ebp+var_20], edi
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jle	loc_100122C1
		push	1
		push	4
		pop	edx
		mov	ecx, ebx
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_100122C1
		call	sub_10013DEB
		mov	esi, eax
		test	esi, esi
		jz	loc_100122C1
		lea	eax, [ebp+var_24]
		push	eax
		lea	eax, [ebp+var_28]
		push	eax
		lea	edx, [ebp+var_1C]
		mov	ecx, [ebp+arg_4]
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_100122C1
		cmp	[ebp+var_1C], 0
		jz	loc_100122C1
		push	esi
		lea	ecx, [ebp+var_30]
		call	sub_10015A20
		and	[ebp+var_64], 0
		push	30h		; size_t
		push	0		; int
		lea	eax, [ebp+var_60]
		push	eax		; void *
		call	memset
		lea	eax, [ebp+var_64]
		push	eax		; int
		lea	eax, [ebp+arg_0]
		push	eax		; void *
		lea	eax, [ebp+var_24]
		push	eax		; int
		lea	eax, [ebp+var_28]
		push	eax		; void *
		lea	eax, [ebp+var_1C]
		push	eax		; int
		lea	ecx, [ebp+var_30]
		call	sub_10012472
		add	esp, 20h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, [ebp+var_1C]
		call	sub_10014324
		test	esi, esi
		jnz	short loc_100122C1
		cmp	[ebp+var_5C], esi
		jl	short loc_100122C1
		and	[ebp+ms_exc.registration.TryLevel], esi
		mov	eax, [ebp+var_54]
		mov	[ebx], eax
		mov	edi, [ebp+var_5C]
		mov	[ebp+var_20], edi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+arg_4]
		mov	edx, [eax+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenkeyEx ; "NtOpenKey[Ex]"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_100122C1
; ---------------------------------------------------------------------------

loc_100122B0:				; DATA XREF: .rdata:stru_1002DEC8o
		xor	eax, eax	; Exception filter 0 for function 100121C6
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100122B4:				; DATA XREF: .rdata:stru_1002DEC8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 100121C6
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edi, [ebp+var_20]

loc_100122C1:				; CODE XREF: sub_100121C6+1Cj
					; sub_100121C6+31j ...
		mov	eax, edi
		call	__SEH_epilog4
		retn	8
sub_100121C6	endp

; Exported entry  28. _TargetNtOpenKey@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKey(x, x, x, x)
		public _TargetNtOpenKey@16
_TargetNtOpenKey@16 proc near		; DATA XREF: sub_10011CBA+3Do
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_1001230E
		cmp	esi, 0C0000034h
		jz	short loc_10012300
		mov	edx, [edi+8]
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A69
		pop	ecx

loc_10012300:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+1Ej
		mov	edx, [ebp+arg_4]
		mov	ecx, esi
		push	edi
		push	[ebp+arg_8]
		call	sub_100121C6

loc_1001230E:				; CODE XREF: TargetNtOpenKey(x,x,x,x)+16j
		pop	edi
		pop	esi
		pop	ebp
		retn	10h
_TargetNtOpenKey@16 endp

; Exported entry  29. _TargetNtOpenKeyEx@20

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenKeyEx(x, x, x, x, x)
		public _TargetNtOpenKeyEx@20
_TargetNtOpenKeyEx@20 proc near		; DATA XREF: sub_10011CBA:loc_10011D42o
					; .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		push	[ebp+arg_10]
		mov	edi, [ebp+arg_C]
		push	edi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		jns	short loc_10012360
		cmp	[ebp+arg_10], 0
		jnz	short loc_10012360
		cmp	esi, 0C0000034h
		jz	short loc_10012352
		mov	edx, [edi+8]
		mov	ecx, offset aNtopenkeyex ; "NtOpenKeyEx"
		movzx	eax, word ptr [edx]
		mov	edx, [edx+4]
		push	eax
		call	sub_10002A69
		pop	ecx

loc_10012352:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+27j
		mov	edx, [ebp+arg_4]
		mov	ecx, esi
		push	edi
		push	[ebp+arg_8]
		call	sub_100121C6

loc_10012360:				; CODE XREF: TargetNtOpenKeyEx(x,x,x,x,x)+19j
					; TargetNtOpenKeyEx(x,x,x,x,x)+1Fj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
_TargetNtOpenKeyEx@20 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012366(int,	void *,	int, void *, void *, void *, int)
sub_10012366	proc near		; CODE XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+123p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001237E
		push	4
		pop	eax
		jmp	loc_1001246E
; ---------------------------------------------------------------------------

loc_1001237E:				; CODE XREF: sub_10012366+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 10h
		mov	dword ptr [edi+3Ch], 6
		mov	dword ptr [edi+44h], 94h
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A366
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		call	sub_1001254C
		test	al, al
		jnz	short loc_100123C8
		push	4
		pop	eax
		jmp	loc_1001246C
; ---------------------------------------------------------------------------

loc_100123C8:				; CODE XREF: sub_10012366+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1001254C
		test	al, al
		jz	loc_1001246A
		mov	eax, [esp+14h+arg_8]
		mov	ecx, edi
		push	esi		; int
		push	0		; char
		push	esi		; size_t
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; void *
		push	2		; int
		call	sub_1001254C
		test	al, al
		jz	short loc_1001246A
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	3		; int
		call	sub_1001254C
		test	al, al
		jz	short loc_1001246A
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_10] ; void	*
		mov	ecx, edi
		push	esi		; int
		call	sub_1001254C
		test	al, al
		jz	short loc_1001246A
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_14] ; void	*
		mov	ecx, edi
		push	5		; int
		call	sub_1001254C
		test	al, al
		jz	short loc_1001246A
		push	[esp+14h+arg_18]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_1001246A
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_1001246A:				; CODE XREF: sub_10012366+78j
					; sub_10012366+9Cj ...
		mov	eax, esi

loc_1001246C:				; CODE XREF: sub_10012366+5Dj
		pop	esi
		pop	ebp

loc_1001246E:				; CODE XREF: sub_10012366+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10012366	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10012472(int,	void *,	int, void *, int)
sub_10012472	proc near		; CODE XREF: sub_100121C6+9Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_1001248A
		push	4
		pop	eax
		jmp	loc_10012548
; ---------------------------------------------------------------------------

loc_1001248A:				; CODE XREF: sub_10012472+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		mov	dword ptr [edi], 11h
		mov	dword ptr [edi+3Ch], 4
		mov	dword ptr [edi+44h], 7Ch
		mov	esi, [esi]
		mov	[esp+14h+var_4], esi
		call	sub_1000A366
		xor	ebp, ebp
		mov	ecx, edi
		inc	ebp
		push	ebp		; int
		push	0		; char
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		call	sub_1000D5A8
		test	al, al
		jnz	short loc_100124D1
		push	4
		pop	eax
		jmp	short loc_10012546
; ---------------------------------------------------------------------------

loc_100124D1:				; CODE XREF: sub_10012472+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_10012544
		mov	eax, [esp+14h+arg_8]
		mov	ecx, edi
		push	esi		; int
		push	0		; char
		push	esi		; size_t
		mov	eax, [eax]
		mov	[esp+20h+var_4], eax
		lea	eax, [esp+20h+var_4]
		push	eax		; void *
		push	2		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_10012544
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_C]	; void *
		mov	ecx, edi
		push	3		; int
		call	sub_1000D5A8
		test	al, al
		jz	short loc_10012544
		push	[esp+14h+arg_10]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10012544
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10012544:				; CODE XREF: sub_10012472+75j
					; sub_10012472+95j ...
		mov	eax, esi

loc_10012546:				; CODE XREF: sub_10012472+5Dj
		pop	esi
		pop	ebp

loc_10012548:				; CODE XREF: sub_10012472+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10012472	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_1001254C(int, void *, size_t, char,	int)
sub_1001254C	proc near		; CODE XREF: sub_10012366+51p
					; sub_10012366+71p ...

ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= byte ptr  14h
arg_10		= dword	ptr  18h

		push	8
		push	offset stru_1002DEE8
		call	__SEH_prolog4
		mov	edi, ecx
		mov	ebx, [ebp+arg_0]
		cmp	ebx, 6
		jnb	loc_100125F2
		mov	esi, [ebp+arg_8]
		cmp	esi, 0FFFFFFFFh
		jz	loc_100125F2
		test	esi, esi
		jz	short loc_1001257C
		cmp	[ebp+arg_4], 0
		jz	short loc_100125F2

loc_1001257C:				; CODE XREF: sub_1001254C+28j
		mov	eax, 400h
		cmp	esi, eax
		ja	short loc_100125F2
		imul	ecx, ebx, 0Ch
		mov	[ebp+arg_0], ecx
		mov	ecx, [ecx+edi+44h]
		sub	eax, esi
		cmp	ecx, eax
		ja	short loc_100125F2
		lea	eax, [ecx+edi]
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	esi		; size_t
		push	[ebp+arg_4]	; void *
		push	eax		; void *
		call	memcpy
		add	esp, 0Ch
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		cmp	[ebp+arg_C], 0
		jz	short loc_100125BD
		mov	dword ptr [edi+4], 1

loc_100125BD:				; CODE XREF: sub_1001254C+68j
		mov	eax, [ebp+arg_0]
		mov	ecx, [eax+edi+44h]
		add	ecx, 7
		add	ecx, esi
		and	ecx, 0FFFFFFF8h
		mov	[eax+edi+50h], ecx
		lea	ecx, [ebx+6]
		imul	ecx, 0Ch
		mov	[ecx+edi], esi
		mov	ecx, [ebp+arg_10]
		mov	[eax+edi+40h], ecx
		mov	al, 1
		jmp	short loc_100125F4
; ---------------------------------------------------------------------------

loc_100125E4:				; DATA XREF: .rdata:stru_1002DEE8o
		xor	eax, eax	; Exception filter 0 for function 1001254C
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100125E8:				; DATA XREF: .rdata:stru_1002DEE8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 1001254C
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh

loc_100125F2:				; CODE XREF: sub_1001254C+14j
					; sub_1001254C+20j ...
		xor	al, al

loc_100125F4:				; CODE XREF: sub_1001254C+96j
		call	__SEH_epilog4
		retn	14h
sub_1001254C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100125FC	proc near		; CODE XREF: sub_100126A0+30p
					; sub_1001272D+2Ep

var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	esi, ecx
		xor	ebx, ebx
		lea	edx, [ebp+var_4C]
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		mov	[ebp+var_4C], ebx
		call	sub_10018835
		lea	edx, [ebp+var_48]
		mov	[ebp+var_48], ebx
		mov	ecx, offset aNtclose ; "NtClose"
		call	sub_10018835
		lea	edx, [ebp+var_50]
		mov	[ebp+var_50], ebx
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		call	sub_10018835
		push	esi
		push	dword ptr [edi]
		lea	eax, [ebp+var_44]
		push	eax
		call	[ebp+var_4C]
		test	eax, eax
		js	short loc_1001268F
		push	34h		; size_t
		lea	eax, [ebp+var_3C]
		mov	[ebp+var_40], ebx
		push	ebx		; int
		push	eax		; void *
		call	memset
		add	esp, 0Ch
		lea	eax, [ebp+var_40]
		push	ebx
		push	38h
		push	eax
		push	ebx
		push	[ebp+var_44]
		call	[ebp+var_50]
		push	[ebp+var_44]
		mov	esi, eax
		call	[ebp+var_48]
		test	esi, esi
		jns	short loc_10012683
		mov	eax, esi
		jmp	short loc_1001268F
; ---------------------------------------------------------------------------

loc_10012683:				; CODE XREF: sub_100125FC+81j
		mov	eax, [ebp+var_3C]
		and	eax, 0A0020019h
		mov	[edi], eax
		xor	eax, eax

loc_1001268F:				; CODE XREF: sub_100125FC+55j
					; sub_100125FC+85j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100125FC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100126A0@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int, int, int, int, HANDLE hTargetProcessHandle)
sub_100126A0	proc near		; CODE XREF: sub_100128C9+6Ap

hSourceHandle	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
hTargetProcessHandle= dword ptr	 1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		xor	ebx, ebx
		mov	[ebp+var_4], esi
		lea	edx, [ebp+var_8]
		mov	[ebp+var_8], ebx
		mov	ecx, offset aNtcreatekey ; "NtCreateKey"
		call	sub_10018835
		test	esi, 2000000h
		jz	short loc_100126E3
		mov	ecx, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		call	sub_100125FC
		test	eax, eax
		jns	short loc_100126E0
		mov	eax, 0C0000022h
		jmp	short loc_10012726
; ---------------------------------------------------------------------------

loc_100126E0:				; CODE XREF: sub_100126A0+37j
		mov	esi, [ebp+var_4]

loc_100126E3:				; CODE XREF: sub_100126A0+28j
		push	[ebp+arg_10]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		lea	eax, [ebp+hSourceHandle]
		push	[ebp+arg_C]
		push	ebx
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		push	esi
		push	eax
		call	[ebp+var_8]
		test	eax, eax
		js	short loc_10012726
		push	3		; dwOptions
		push	ebx		; bInheritHandle
		push	ebx		; dwDesiredAccess
		push	edi		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_10012726:				; CODE XREF: sub_100126A0+3Ej
					; sub_100126A0+5Ej
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_100126A0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_1001272D@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	HANDLE hTargetProcessHandle)
sub_1001272D	proc near		; CODE XREF: sub_10012949+57p

hSourceHandle	= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
hTargetProcessHandle= dword ptr	 0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 10h
		and	[ebp+var_8], 0
		push	esi
		push	edi
		mov	esi, edx
		mov	edi, ecx
		lea	edx, [ebp+var_8]
		mov	[ebp+var_4], esi
		mov	ecx, offset aNtopenkey ; "NtOpenKey"
		call	sub_10018835
		test	esi, 2000000h
		jz	short loc_1001276E
		mov	ecx, [ebp+arg_0]
		lea	edx, [ebp+var_4]
		call	sub_100125FC
		test	eax, eax
		jns	short loc_1001276B
		mov	eax, 0C0000022h
		jmp	short loc_100127A9
; ---------------------------------------------------------------------------

loc_1001276B:				; CODE XREF: sub_1001272D+35j
		mov	esi, [ebp+var_4]

loc_1001276E:				; CODE XREF: sub_1001272D+26j
		push	[ebp+arg_0]
		or	[ebp+hSourceHandle], 0FFFFFFFFh
		lea	eax, [ebp+hSourceHandle]
		push	esi
		push	eax
		call	[ebp+var_8]
		test	eax, eax
		js	short loc_100127A9
		push	3		; dwOptions
		push	0		; bInheritHandle
		push	0		; dwDesiredAccess
		push	edi		; lpTargetHandle
		push	[ebp+hTargetProcessHandle] ; hTargetProcessHandle
		push	[ebp+hSourceHandle] ; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		neg	eax
		sbb	eax, eax
		and	eax, 3FFFFFDEh
		add	eax, 0C0000022h

loc_100127A9:				; CODE XREF: sub_1001272D+3Cj
					; sub_1001272D+52j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001272D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100127AF@<eax>(void *@<ecx>, int)
sub_100127AF	proc near		; CODE XREF: sub_10015277+E4p

var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_30		= byte ptr -30h
var_20		= dword	ptr -20h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		and	[ebp+var_44], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		push	ecx		; void *
		lea	ecx, [ebp+var_20] ; void *
		mov	edi, edx
		call	sub_10001C7F
		cmp	[ebp+var_10], 0
		jz	loc_100128A8
		sub	esp, 18h
		lea	eax, [ebp+var_20]
		mov	ecx, esp
		push	eax
		call	sub_100038A0
		lea	ecx, [ebp+var_20]
		call	sub_10018091
		add	esp, 18h
		test	al, al
		jz	loc_100128A8
		cmp	[ebp+var_C], 8
		mov	esi, [ebp+var_20]
		jnb	short loc_1001280B
		lea	esi, [ebp+var_20]

loc_1001280B:				; CODE XREF: sub_100127AF+57j
		push	3
		lea	ecx, [ebp+var_40]
		call	sub_1000F98B
		push	3
		lea	ecx, [ebp+var_30]
		call	sub_1000F98B
		sub	edi, 0Bh
		jz	short loc_1001283B
		dec	edi
		jz	short loc_1001285E

loc_10012827:				; CODE XREF: sub_100127AF+BFj
					; sub_100127AF+D0j ...
		xor	bl, bl

loc_10012829:				; CODE XREF: sub_100127AF+F7j
		lea	ecx, [ebp+var_30]
		call	sub_1000FDA2
		lea	ecx, [ebp+var_40]
		call	sub_1000FDA2
		jmp	short loc_100128AA
; ---------------------------------------------------------------------------

loc_1001283B:				; CODE XREF: sub_100127AF+73j
		push	1
		mov	edi, 5DFDFFE6h
		lea	ecx, [ebp+var_40]
		push	edi
		push	1
		push	1
		call	sub_1000FC7A
		push	1
		push	edi
		push	1
		push	1
		lea	ecx, [ebp+var_30]
		call	sub_1000FC7A

loc_1001285E:				; CODE XREF: sub_100127AF+76j
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_30]
		call	sub_1000FB42
		test	al, al
		jz	short loc_10012827
		lea	eax, [ebp+var_30]
		mov	ecx, ebx
		push	eax
		push	10h
		call	sub_1000F6EE
		test	al, al
		jz	short loc_10012827
		push	1
		push	esi
		push	ecx
		push	0
		lea	ecx, [ebp+var_40]
		call	sub_1000FB42
		test	al, al
		jz	short loc_10012827
		lea	eax, [ebp+var_40]
		mov	ecx, ebx
		push	eax
		push	11h
		call	sub_1000F6EE
		test	al, al
		jz	short loc_10012827
		mov	bl, 1
		jmp	short loc_10012829
; ---------------------------------------------------------------------------

loc_100128A8:				; CODE XREF: sub_100127AF+29j
					; sub_100127AF+4Aj
		xor	bl, bl

loc_100128AA:				; CODE XREF: sub_100127AF+8Aj
		push	0
		push	1
		lea	ecx, [ebp+var_20]
		call	sub_10002311
		mov	ecx, [ebp+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100127AF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_100128C9(int,	int, int, int, int, int, LPHANDLE lpTargetHandle, int, int)
sub_100128C9	proc near		; CODE XREF: sub_10011D74+110p

var_24		= dword	ptr -24h
var_20		= byte ptr -20h
var_C		= word ptr -0Ch
var_A		= dword	ptr -0Ah
var_6		= word ptr -6
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
lpTargetHandle	= dword	ptr  20h
arg_1C		= dword	ptr  24h
arg_20		= dword	ptr  28h

		push	ebp
		mov	ebp, esp
		sub	esp, 28h
		push	ebx
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_100128E6

loc_100128D9:				; CODE XREF: sub_100128C9+21j
		mov	eax, [ebp+arg_1C]
		mov	dword ptr [eax], 0C0000022h
		xor	al, al
		jmp	short loc_10012942
; ---------------------------------------------------------------------------

loc_100128E6:				; CODE XREF: sub_100128C9+Ej
		cmp	[ebp+arg_14], 0
		jnz	short loc_100128D9
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		mov	[ebp+var_C], ax
		lea	edi, [ebp+var_20]
		xor	ebx, ebx
		mov	ecx, [ebp+arg_0]
		mov	[ebp+var_24], ebx
		stosd
		mov	[ebp+var_A], ebx
		mov	[ebp+var_6], bx
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_C]
		push	eax
		lea	eax, [ebp+var_24]
		push	eax
		push	[ebp+arg_8]
		call	sub_10015438
		mov	edx, [ebp+arg_C]
		lea	eax, [ebp+var_24]
		add	esp, 0Ch
		push	dword ptr [esi]	; hTargetProcessHandle
		push	[ebp+arg_20]	; int
		push	ebx		; int
		push	ecx		; int
		push	[ebp+arg_10]	; int
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		push	eax		; int
		call	sub_100126A0
		mov	ecx, [ebp+arg_1C]
		add	esp, 18h
		mov	[ecx], eax
		mov	al, 1

loc_10012942:				; CODE XREF: sub_100128C9+1Bj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_100128C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10012949(int,	int, int, int, LPHANDLE	lpTargetHandle,	int)
sub_10012949	proc near		; CODE XREF: sub_10011EDC+100p

var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_8		= word ptr -8
var_6		= dword	ptr -6
var_2		= word ptr -2
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
lpTargetHandle	= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		push	esi
		mov	esi, edx
		push	edi
		cmp	ecx, 3
		jz	short loc_10012963
		mov	eax, [ebp+arg_14]
		mov	dword ptr [eax], 0C0000022h
		jmp	short loc_100129AC
; ---------------------------------------------------------------------------

loc_10012963:				; CODE XREF: sub_10012949+Dj
		xor	eax, eax
		mov	edx, [ebp+arg_4]
		mov	[ebp+var_20], eax
		lea	edi, [ebp+var_1C]
		mov	[ebp+var_8], ax
		mov	[ebp+var_6], eax
		mov	[ebp+var_2], ax
		stosd
		mov	ecx, [ebp+arg_0]
		stosd
		stosd
		stosd
		stosd
		lea	eax, [ebp+var_8]
		push	eax
		lea	eax, [ebp+var_20]
		push	eax
		push	[ebp+arg_8]
		call	sub_10015438
		mov	edx, [ebp+arg_C]
		lea	eax, [ebp+var_20]
		mov	ecx, [ebp+lpTargetHandle] ; lpTargetHandle
		add	esp, 0Ch
		push	dword ptr [esi]	; hTargetProcessHandle
		push	eax		; int
		call	sub_1001272D
		pop	ecx
		pop	ecx
		mov	ecx, [ebp+arg_14]
		mov	[ecx], eax

loc_100129AC:				; CODE XREF: sub_10012949+18j
		pop	edi
		mov	al, 1
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10012949	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100129B4	proc near		; DATA XREF: .rdata:1002C044o
					; .rdata:1002C05Co ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h

		push	ebp
		mov	ebp, esp
		cmp	[ebp+arg_14], 0
		push	esi
		mov	esi, ecx
		jz	short loc_10012A21
		cmp	[ebp+arg_18], 0
		jz	short loc_10012A21
		cmp	[ebp+arg_0], 0
		jz	short loc_10012A21
		cmp	[ebp+arg_8], 0
		jz	short loc_10012A21
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		cmp	[ebp+arg_18], eax
		jnb	short loc_100129E3
		mov	eax, 0C0000023h
		jmp	short loc_10012A26
; ---------------------------------------------------------------------------

loc_100129E3:				; CODE XREF: sub_100129B4+26j
		cmp	[ebp+arg_10], 0
		jnz	short loc_100129FE
		mov	eax, [esi]
		lea	ecx, [ebp+arg_10]
		push	ecx
		push	[ebp+arg_C]
		mov	ecx, esi
		push	[ebp+arg_4]
		call	dword ptr [eax+8]
		test	eax, eax
		js	short loc_10012A26

loc_100129FE:				; CODE XREF: sub_100129B4+33j
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	ecx, eax
		test	ecx, ecx
		jns	short loc_10012A19

loc_10012A15:				; CODE XREF: sub_100129B4+6Bj
		mov	eax, ecx
		jmp	short loc_10012A26
; ---------------------------------------------------------------------------

loc_10012A19:				; CODE XREF: sub_100129B4+5Fj
		mov	eax, [ebp+arg_10]
		mov	[esi+8], eax
		jmp	short loc_10012A15
; ---------------------------------------------------------------------------

loc_10012A21:				; CODE XREF: sub_100129B4+Aj
					; sub_100129B4+10j ...
		mov	eax, 0C000000Dh

loc_10012A26:				; CODE XREF: sub_100129B4+2Dj
					; sub_100129B4+48j ...
		pop	esi
		pop	ebp
		retn	1Ch
sub_100129B4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012A2B	proc near		; CODE XREF: sub_10012ADBj
					; DATA XREF: .rdata:1002C038o ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_10012A3E
		mov	eax, 0C000000Dh
		jmp	short loc_10012A78
; ---------------------------------------------------------------------------

loc_10012A3E:				; CODE XREF: sub_10012A2B+Aj
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100058D3
		test	al, al
		jnz	short loc_10012A5B
		mov	eax, 0C000007Bh
		jmp	short loc_10012A78
; ---------------------------------------------------------------------------

loc_10012A5B:				; CODE XREF: sub_10012A2B+27j
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		call	sub_1000579F
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jnz	short loc_10012A76
		mov	eax, 0C000007Ah
		jmp	short loc_10012A78
; ---------------------------------------------------------------------------

loc_10012A76:				; CODE XREF: sub_10012A2B+42j
		xor	eax, eax

loc_10012A78:				; CODE XREF: sub_10012A2B+11j
					; sub_10012A2B+2Ej ...
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10012A2B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012A7E	proc near		; CODE XREF: sub_10009A67+41p
					; sub_100156CD+6Cp ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		cmp	[esp+arg_4], 1Eh
		jnb	short loc_10012A89
		xor	al, al
		jmp	short locret_10012AD8
; ---------------------------------------------------------------------------

loc_10012A89:				; CODE XREF: sub_10012A7E+5j
		mov	ecx, [esp+arg_0]
		test	ecx, ecx
		jz	short loc_10012AC6
		and	dword ptr [ecx+10h], 0
		mov	eax, 0C35Ah
		and	dword ptr [ecx+18h], 0
		mov	dword ptr [ecx], 5208EC83h
		mov	dword ptr [ecx+4], 0C24548Bh
		mov	dword ptr [ecx+8], 8245489h
		mov	dword ptr [ecx+0Ch], 0C2444C7h
		mov	dword ptr [ecx+14h], 42444C7h
		mov	[ecx+1Ch], ax
		jmp	short loc_10012AC8
; ---------------------------------------------------------------------------

loc_10012AC6:				; CODE XREF: sub_10012A7E+11j
		xor	ecx, ecx

loc_10012AC8:				; CODE XREF: sub_10012A7E+46j
		mov	eax, [esp+arg_C]
		mov	[ecx+18h], eax
		mov	eax, [esp+arg_8]
		mov	[ecx+10h], eax
		mov	al, 1

locret_10012AD8:			; CODE XREF: sub_10012A7E+9j
		retn	10h
sub_10012A7E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame thunk

sub_10012ADB	proc near		; DATA XREF: .rdata:1002C03Co
					; .rdata:1002C24Co ...
		jmp	sub_10012A2B
sub_10012ADB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012AE0	proc near		; CODE XREF: sub_10012DA7+1Cp
					; sub_10013578+129p

var_6C		= dword	ptr -6Ch
phNewToken	= dword	ptr -68h
var_64		= dword	ptr -64h
DisableSidCount	= dword	ptr -60h
RestrictedSidCount= dword ptr -5Ch
SidsToDisable	= dword	ptr -58h
lpTargetHandle	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 70h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+70h+var_4], eax
		and	[esp+70h+DisableSidCount], 0
		mov	eax, [esp+70h+arg_0]
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+80h+lpTargetHandle], eax
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10012B11
		mov	eax, 3F0h
		jmp	loc_10012D92
; ---------------------------------------------------------------------------

loc_10012B11:				; CODE XREF: sub_10012AE0+25j
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		push	44h
		pop	ecx
		idiv	ecx
		mov	ebp, [edi+10h]
		mov	esi, eax
		sub	ebp, [edi+0Ch]
		mov	eax, [edi+4]
		sub	eax, [edi]
		cdq
		idiv	ecx
		and	[esp+80h+SidsToDisable], 0
		sar	ebp, 3
		mov	ebx, eax
		mov	[esp+80h+var_6C], ecx
		mov	[esp+80h+DisableSidCount], esi
		mov	[esp+80h+RestrictedSidCount], ebx
		mov	[esp+80h+var_64], ebp
		push	8
		pop	edx
		test	esi, esi
		jz	short loc_10012BA9
		xor	ecx, ecx
		mov	eax, esi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		pop	ecx
		mov	ecx, eax
		xor	esi, esi
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		idiv	[esp+80h+var_6C]
		mov	[esp+80h+SidsToDisable], ecx
		test	eax, eax
		jz	short loc_10012BA6
		push	44h
		xor	ebx, ebx
		pop	ebp

loc_10012B7E:				; CODE XREF: sub_10012AE0+BCj
		mov	dword ptr [ecx+esi*8+4], 10h
		mov	eax, [edi+18h]
		add	eax, ebx
		add	ebx, ebp
		mov	[ecx+esi*8], eax
		inc	esi
		mov	eax, [edi+1Ch]
		sub	eax, [edi+18h]
		cdq
		idiv	ebp
		cmp	esi, eax
		jb	short loc_10012B7E
		mov	ebp, [esp+80h+var_64]
		mov	ebx, [esp+80h+RestrictedSidCount]

loc_10012BA6:				; CODE XREF: sub_10012AE0+97j
		push	8
		pop	edx

loc_10012BA9:				; CODE XREF: sub_10012AE0+6Cj
		xor	esi, esi
		mov	[esp+80h+var_6C], esi
		test	ebx, ebx
		jz	short loc_10012BEF
		xor	ecx, ecx
		mov	eax, ebx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		xor	ecx, ecx
		mov	[esp+80h+var_6C], esi
		test	ebx, ebx
		jz	short loc_10012BEF
		push	44h
		xor	edx, edx
		pop	ebp

loc_10012BD8:				; CODE XREF: sub_10012AE0+109j
		and	dword ptr [esi+ecx*8+4], 0
		mov	eax, [edi]
		add	eax, edx
		add	edx, ebp
		mov	[esi+ecx*8], eax
		inc	ecx
		cmp	ecx, ebx
		jb	short loc_10012BD8
		mov	ebp, [esp+80h+var_64]

loc_10012BEF:				; CODE XREF: sub_10012AE0+D1j
					; sub_10012AE0+F1j
		xor	ebx, ebx
		test	ebp, ebp
		jz	short loc_10012C3C
		xor	ecx, ecx
		mov	eax, ebp
		push	0Ch
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		and	[esp+84h+var_64], 0
		mov	ebx, eax
		pop	ecx
		test	ebp, ebp
		jz	short loc_10012C3C
		mov	esi, [esp+80h+var_64]
		mov	edx, ebx

loc_10012C1D:				; CODE XREF: sub_10012AE0+156j
		and	dword ptr [edx+8], 0
		mov	ecx, [edi+0Ch]
		mov	eax, [ecx+esi*8]
		mov	[edx], eax
		lea	edx, [edx+0Ch]
		mov	eax, [ecx+esi*8+4]
		inc	esi
		mov	[edx-8], eax
		cmp	esi, ebp
		jb	short loc_10012C1D
		mov	esi, [esp+80h+var_6C]

loc_10012C3C:				; CODE XREF: sub_10012AE0+113j
					; sub_10012AE0+135j
		and	[esp+80h+phNewToken], 0
		mov	ecx, [esp+80h+DisableSidCount]
		mov	eax, [esp+80h+RestrictedSidCount]
		test	ecx, ecx
		jnz	short loc_10012C6F
		test	eax, eax
		jnz	short loc_10012C6F
		test	ebp, ebp
		jnz	short loc_10012C6F
		lea	eax, [esp+80h+phNewToken]
		push	eax		; phNewToken
		push	1		; TokenType
		push	1		; ImpersonationLevel
		push	ebp		; lpTokenAttributes
		push	0F01FFh		; dwDesiredAccess
		push	dword ptr [edi+24h] ; hExistingToken
		call	ds:DuplicateTokenEx
		jmp	short loc_10012C88
; ---------------------------------------------------------------------------

loc_10012C6F:				; CODE XREF: sub_10012AE0+16Bj
					; sub_10012AE0+16Fj ...
		lea	edx, [esp+80h+phNewToken]
		push	edx		; NewTokenHandle
		push	esi		; SidsToRestrict
		push	eax		; RestrictedSidCount
		push	ebx		; PrivilegesToDelete
		push	ebp		; DeletePrivilegeCount
		push	[esp+94h+SidsToDisable]	; SidsToDisable
		push	ecx		; DisableSidCount
		push	2		; Flags
		push	dword ptr [edi+24h] ; ExistingTokenHandle
		call	ds:CreateRestrictedToken

loc_10012C88:				; CODE XREF: sub_10012AE0+18Dj
		mov	ebp, ds:??_V@YAXPAX@Z ;	operator delete[](void *)
		mov	[esp+80h+var_6C], eax
		mov	eax, [esp+80h+SidsToDisable]
		test	eax, eax
		jz	short loc_10012C9E
		push	eax
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012C9E:				; CODE XREF: sub_10012AE0+1B8j
		test	esi, esi
		jz	short loc_10012CA6
		push	esi
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012CA6:				; CODE XREF: sub_10012AE0+1C0j
		test	ebx, ebx
		jz	short loc_10012CAE
		push	ebx
		call	ebp ; operator delete[](void *)	; operator delete[](void *)
		pop	ecx

loc_10012CAE:				; CODE XREF: sub_10012AE0+1C8j
		cmp	[esp+80h+var_6C], 0
		jnz	short loc_10012CC0

loc_10012CB5:				; CODE XREF: sub_10012AE0+1FCj
					; sub_10012AE0+229j ...
		call	ds:GetLastError
		jmp	loc_10012D92
; ---------------------------------------------------------------------------

loc_10012CC0:				; CODE XREF: sub_10012AE0+1D3j
		push	12h		; WellKnownSidType
		lea	ecx, [esp+84h+pDestinationSid] ; pSid
		call	sub_10016266
		push	ecx
		mov	ecx, [esp+84h+phNewToken] ; TokenHandle
		lea	edx, [esp+84h+pDestinationSid]
		call	sub_10007911
		pop	ecx
		test	al, al
		jz	short loc_10012CB5
		mov	ebx, [esp+80h+phNewToken]
		push	4Ch
		pop	ebp
		push	ebp		; size_t
		mov	[esp+84h+DisableSidCount], ebp
		call	ds:malloc
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+80h+DisableSidCount]
		push	eax		; ReturnLength
		push	ebp		; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	ebx		; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10012D15
		test	esi, esi
		jz	short loc_10012CB5
		push	esi		; void *
		call	ds:free
		pop	ecx
		jmp	short loc_10012CB5
; ---------------------------------------------------------------------------

loc_10012D15:				; CODE XREF: sub_10012AE0+225j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [esp+84h+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h
		pop	eax
		push	eax		; nDestinationSidLength
		call	ds:CopySid
		push	ecx
		lea	edx, [esp+84h+pDestinationSid]
		mov	ecx, ebx	; TokenHandle
		call	sub_10007911
		pop	ecx
		push	esi		; void *
		mov	bl, al
		call	ds:free
		pop	ecx
		test	bl, bl
		jz	loc_10012CB5
		mov	edx, [edi+28h]
		mov	ecx, [esp+80h+phNewToken] ; TokenHandle
		call	sub_10013C26
		test	eax, eax
		jnz	short loc_10012D92
		mov	esi, ds:GetCurrentProcess
		push	eax		; dwOptions
		push	eax		; bInheritHandle
		push	0F01FFh		; dwDesiredAccess
		push	[esp+8Ch+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[esp+94h+phNewToken] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		mov	ecx, [esp+80h+phNewToken]
		mov	esi, eax
		cmp	ecx, [edi+24h]
		jz	short loc_10012D88
		push	ecx		; hObject
		call	ds:CloseHandle

loc_10012D88:				; CODE XREF: sub_10012AE0+29Fj
		test	esi, esi
		jz	loc_10012CB5
		xor	eax, eax

loc_10012D92:				; CODE XREF: sub_10012AE0+2Cj
					; sub_10012AE0+1DBj ...
		mov	ecx, [esp+80h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 70h
		retn	4
sub_10012AE0	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10012DA7(LPHANDLE lpTargetHandle)
sub_10012DA7	proc near		; CODE XREF: sub_10013578+48Cp

DuplicateTokenHandle= dword ptr	-8
ExistingTokenHandle= dword ptr -4
lpTargetHandle	= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		xor	esi, esi
		mov	[ebp+DuplicateTokenHandle], esi
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_10012DBF
		mov	eax, 3F0h
		jmp	short loc_10012E26
; ---------------------------------------------------------------------------

loc_10012DBF:				; CODE XREF: sub_10012DA7+Fj
		lea	eax, [ebp+ExistingTokenHandle]
		push	eax
		call	sub_10012AE0
		test	eax, eax
		jnz	short loc_10012E26
		lea	eax, [ebp+DuplicateTokenHandle]
		push	eax		; DuplicateTokenHandle
		push	2		; ImpersonationLevel
		push	[ebp+ExistingTokenHandle] ; ExistingTokenHandle
		call	ds:DuplicateToken
		push	[ebp+ExistingTokenHandle] ; hObject
		test	eax, eax
		jnz	short loc_10012DF0
		call	ds:CloseHandle

loc_10012DE8:				; CODE XREF: sub_10012DA7+7Bj
		call	ds:GetLastError
		jmp	short loc_10012E26
; ---------------------------------------------------------------------------

loc_10012DF0:				; CODE XREF: sub_10012DA7+39j
		call	ds:CloseHandle
		push	esi		; dwOptions
		push	esi		; bInheritHandle
		mov	esi, ds:GetCurrentProcess
		push	0F01FFh		; dwDesiredAccess
		push	[ebp+lpTargetHandle] ; lpTargetHandle
		call	esi ; GetCurrentProcess
		push	eax		; hTargetProcessHandle
		push	[ebp+DuplicateTokenHandle] ; hSourceHandle
		call	esi ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		push	[ebp+DuplicateTokenHandle] ; hObject
		mov	esi, eax
		call	ds:CloseHandle
		test	esi, esi
		jz	short loc_10012DE8
		xor	eax, eax

loc_10012E26:				; CODE XREF: sub_10012DA7+16j
					; sub_10012DA7+23j ...
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10012DA7	endp


; =============== S U B	R O U T	I N E =======================================


sub_10012E2D	proc near		; CODE XREF: sub_10013578+463p

var_69		= byte ptr -69h
ReturnLength	= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 6Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+6Ch+var_4], eax
		mov	eax, [esp+6Ch+arg_0]
		push	ebx
		mov	ebx, ecx
		mov	[esp+70h+var_54], eax
		push	ebp
		xor	ecx, ecx
		push	esi
		push	edi
		mov	[esp+7Ch+var_58], ecx
		cmp	[ebx+2Ch], cl
		jnz	short loc_10012E5E
		mov	eax, 3F0h
		jmp	loc_10012F86
; ---------------------------------------------------------------------------

loc_10012E5E:				; CODE XREF: sub_10012E2D+25j
		mov	edi, ds:GetTokenInformation
		lea	eax, [esp+7Ch+ReturnLength]
		push	eax		; ReturnLength
		push	ecx		; TokenInformationLength
		push	ecx		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		mov	[esp+90h+ReturnLength],	ecx
		call	edi ; GetTokenInformation
		cmp	[esp+7Ch+ReturnLength],	0
		jnz	short loc_10012E88

loc_10012E7D:				; CODE XREF: sub_10012E2D+84j
		call	ds:GetLastError
		jmp	loc_10012F86
; ---------------------------------------------------------------------------

loc_10012E88:				; CODE XREF: sub_10012E2D+4Ej
		push	[esp+7Ch+ReturnLength]
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+7Ch+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+80h+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	edi ; GetTokenInformation
		test	eax, eax
		jnz	short loc_10012EB3
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_10012E7D
; ---------------------------------------------------------------------------

loc_10012EB3:				; CODE XREF: sub_10012E2D+7Aj
		xor	ebp, ebp
		cmp	[esi], ebp
		jbe	loc_10012F7C
		push	44h
		pop	ecx
		lea	edi, [esi+4]
		mov	[esp+7Ch+var_58], ecx

loc_10012EC7:				; CODE XREF: sub_10012E2D+149j
		test	byte ptr [edi+4], 20h
		jnz	loc_10012F70
		test	dword ptr [edi+4], 0C0000000h
		jnz	loc_10012F70
		mov	ecx, [esp+7Ch+var_54]
		mov	[esp+7Ch+var_69], 0
		push	44h
		test	ecx, ecx
		jz	short loc_10012F4C
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	[esp+80h+var_64], edx
		mov	edx, [ecx]
		sub	eax, edx
		mov	[esp+80h+var_5C], edx
		cdq
		pop	ecx
		idiv	ecx
		test	eax, eax
		jz	short loc_10012F4D
		xor	ecx, ecx
		mov	[esp+7Ch+var_60], ecx

loc_10012F0C:				; CODE XREF: sub_10012E2D+11Bj
		mov	eax, [esp+7Ch+var_5C]
		push	dword ptr [edi]	; pSid2
		add	eax, ecx
		push	eax		; pSid1
		call	ds:EqualSid
		push	44h
		test	eax, eax
		jnz	short loc_10012F9B
		mov	ecx, [esp+80h+var_60]
		pop	eax
		add	ecx, eax
		inc	[esp+7Ch+var_64]
		mov	eax, [esp+7Ch+var_54]
		mov	[esp+7Ch+var_60], ecx
		mov	edx, [eax]
		mov	eax, [eax+4]
		sub	eax, edx
		mov	[esp+7Ch+var_5C], edx
		cdq
		idiv	[esp+7Ch+var_58]
		cmp	[esp+7Ch+var_64], eax
		jb	short loc_10012F0C
		push	44h

loc_10012F4C:				; CODE XREF: sub_10012E2D+BEj
		pop	ecx

loc_10012F4D:				; CODE XREF: sub_10012E2D+D7j
		mov	al, [esp+7Ch+var_69]

loc_10012F51:				; CODE XREF: sub_10012E2D+171j
		test	al, al
		jnz	short loc_10012F70
		push	dword ptr [edi]	; pSourceSid
		lea	eax, [esp+80h+pDestinationSid]
		push	eax		; pDestinationSid
		push	ecx		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [esp+7Ch+pDestinationSid]
		push	eax
		lea	ecx, [ebx+18h]
		call	sub_100133AE

loc_10012F70:				; CODE XREF: sub_10012E2D+9Ej
					; sub_10012E2D+ABj ...
		inc	ebp
		add	edi, 8
		cmp	ebp, [esi]
		jb	loc_10012EC7

loc_10012F7C:				; CODE XREF: sub_10012E2D+8Aj
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10012F86:				; CODE XREF: sub_10012E2D+2Cj
					; sub_10012E2D+56j
		mov	ecx, [esp+7Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 6Ch
		retn	4
; ---------------------------------------------------------------------------

loc_10012F9B:				; CODE XREF: sub_10012E2D+F2j
		mov	al, 1
		pop	ecx
		jmp	short loc_10012F51
sub_10012E2D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10012FA0	proc near		; CODE XREF: sub_10013578+413p
					; sub_10013578+433p

TokenInformationLength=	dword ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_10012FC5
		mov	eax, 3F0h
		jmp	short loc_1001301F
; ---------------------------------------------------------------------------

loc_10012FC5:				; CODE XREF: sub_10012FA0+1Cj
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_10012FFB
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_1001301F
; ---------------------------------------------------------------------------

loc_10012FFB:				; CODE XREF: sub_10012FA0+49j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		push	eax
		lea	ecx, [edi+18h]
		call	sub_100133AE
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_1001301F:				; CODE XREF: sub_10012FA0+23j
					; sub_10012FA0+59j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10012FA0	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001302F	proc near		; CODE XREF: sub_10013578+47Bp

ReturnLength	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
Luid		= _LUID	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 18h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		xor	ebp, ebp
		mov	[esp+28h+var_C], ebp
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_1001304E
		mov	eax, 3F0h
		jmp	loc_10013150
; ---------------------------------------------------------------------------

loc_1001304E:				; CODE XREF: sub_1001302F+13j
		mov	ebx, ds:GetTokenInformation
		lea	eax, [esp+28h+ReturnLength]
		push	eax		; ReturnLength
		push	ebp		; TokenInformationLength
		push	ebp		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		mov	[esp+3Ch+ReturnLength],	ebp
		call	ebx ; GetTokenInformation
		cmp	[esp+28h+ReturnLength],	ebp
		jnz	short loc_10013077

loc_1001306C:				; CODE XREF: sub_1001302F+71j
		call	ds:GetLastError
		jmp	loc_10013150
; ---------------------------------------------------------------------------

loc_10013077:				; CODE XREF: sub_1001302F+3Bj
		push	[esp+28h+ReturnLength]
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		lea	eax, [esp+28h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+2Ch+ReturnLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	3		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ebx ; GetTokenInformation
		test	eax, eax
		jnz	short loc_100130A2
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_1001306C
; ---------------------------------------------------------------------------

loc_100130A2:				; CODE XREF: sub_1001302F+67j
		cmp	[esi], ebp
		jbe	loc_10013146
		lea	ebx, [esi+4]
		mov	[esp+28h+var_C], 18h

loc_100130B5:				; CODE XREF: sub_1001302F+111j
		mov	ecx, [esp+28h+arg_0]
		test	ecx, ecx
		jz	short loc_10013131
		mov	eax, [ecx+4]
		xor	edx, edx
		mov	ecx, [ecx]
		sub	eax, ecx
		mov	[esp+28h+var_14], edx
		cdq
		idiv	[esp+28h+var_C]
		test	eax, eax
		jz	short loc_10013131
		xor	eax, eax
		mov	[esp+28h+var_10], eax

loc_100130D9:				; CODE XREF: sub_1001302F+100j
		and	[esp+28h+Luid.LowPart],	0
		add	eax, ecx
		and	[esp+28h+Luid.HighPart], 0
		cmp	dword ptr [eax+14h], 8
		jb	short loc_100130ED
		mov	eax, [eax]

loc_100130ED:				; CODE XREF: sub_1001302F+BAj
		lea	ecx, [esp+28h+Luid]
		push	ecx		; lpLuid
		push	eax		; lpName
		push	0		; lpSystemName
		call	ds:LookupPrivilegeValueW
		mov	eax, [ebx+4]
		cmp	eax, [esp+28h+Luid.HighPart]
		jnz	short loc_1001310C
		mov	eax, [ebx]
		cmp	eax, [esp+28h+Luid.LowPart]
		jz	short loc_1001313A

loc_1001310C:				; CODE XREF: sub_1001302F+D3j
		push	18h
		pop	eax
		add	[esp+28h+var_10], eax
		mov	eax, [esp+28h+arg_0]
		inc	[esp+28h+var_14]
		mov	ecx, [eax]
		mov	eax, [eax+4]
		sub	eax, ecx
		cdq
		idiv	[esp+28h+var_C]
		cmp	[esp+28h+var_14], eax
		mov	eax, [esp+28h+var_10]
		jb	short loc_100130D9

loc_10013131:				; CODE XREF: sub_1001302F+8Cj
					; sub_1001302F+A2j
		push	ebx
		lea	ecx, [edi+0Ch]
		call	sub_10013416

loc_1001313A:				; CODE XREF: sub_1001302F+DBj
		inc	ebp
		add	ebx, 0Ch
		cmp	ebp, [esi]
		jb	loc_100130B5

loc_10013146:				; CODE XREF: sub_1001302F+75j
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10013150:				; CODE XREF: sub_1001302F+1Aj
					; sub_1001302F+43j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 18h
		retn	4
sub_1001302F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001315A	proc near		; CODE XREF: sub_100132D8+ACp
					; sub_10013578+298p ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		cmp	byte ptr [ecx+2Ch], 0
		jnz	short loc_1001316F
		mov	eax, 3F0h
		jmp	short loc_10013179
; ---------------------------------------------------------------------------

loc_1001316F:				; CODE XREF: sub_1001315A+Cj
		push	[ebp+arg_0]
		call	sub_100133AE
		xor	eax, eax

loc_10013179:				; CODE XREF: sub_1001315A+13j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_1001315A	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001317F	proc near		; CODE XREF: sub_10013578+2ECp

ReturnLength	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	ebx, ecx
		xor	esi, esi
		mov	[ebp+ReturnLength], esi
		push	edi
		cmp	byte ptr [ebx+2Ch], 0
		jnz	short loc_100131A9
		mov	eax, 3F0h
		jmp	loc_10013239
; ---------------------------------------------------------------------------

loc_100131A9:				; CODE XREF: sub_1001317F+1Ej
		lea	eax, [ebp+ReturnLength]
		mov	[ebp+ReturnLength], esi
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		cmp	[ebp+ReturnLength], esi
		jnz	short loc_100131CA

loc_100131C2:				; CODE XREF: sub_1001317F+75j
		call	ds:GetLastError
		jmp	short loc_10013239
; ---------------------------------------------------------------------------

loc_100131CA:				; CODE XREF: sub_1001317F+41j
		push	[ebp+ReturnLength]
		call	sub_10018CBA
		pop	ecx
		mov	edi, eax
		lea	eax, [ebp+ReturnLength]
		push	eax		; ReturnLength
		push	[ebp+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_100131F6
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_100131C2
; ---------------------------------------------------------------------------

loc_100131F6:				; CODE XREF: sub_1001317F+6Bj
		cmp	[edi], esi
		jbe	short loc_1001322F
		lea	eax, [edi+8]

loc_100131FD:				; CODE XREF: sub_1001317F+8Cj
		test	dword ptr [eax], 0C0000000h
		jnz	short loc_1001320F
		inc	esi
		add	eax, 8
		cmp	esi, [edi]
		jb	short loc_100131FD
		jmp	short loc_1001322F
; ---------------------------------------------------------------------------

loc_1001320F:				; CODE XREF: sub_1001317F+84j
		mov	eax, [edi+esi*8+4]
		test	eax, eax
		jz	short loc_1001322F
		push	eax		; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, ebx
		push	eax
		call	sub_100133AE

loc_1001322F:				; CODE XREF: sub_1001317F+79j
					; sub_1001317F+8Ej ...
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_10013239:				; CODE XREF: sub_1001317F+25j
					; sub_1001317F+49j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001317F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001324A	proc near		; CODE XREF: sub_100132D8:loc_10013302p
					; sub_10013578+2E1p

TokenInformationLength=	dword ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		and	[ebp+TokenInformationLength], 0
		push	esi
		push	edi
		mov	edi, ecx
		cmp	byte ptr [edi+2Ch], 0
		jnz	short loc_1001326F
		mov	eax, 3F0h
		jmp	short loc_100132C8
; ---------------------------------------------------------------------------

loc_1001326F:				; CODE XREF: sub_1001324A+1Cj
		push	4Ch
		pop	eax
		push	eax
		mov	[ebp+TokenInformationLength], eax
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+TokenInformationLength]
		push	eax		; ReturnLength
		push	[ebp+TokenInformationLength] ; TokenInformationLength
		push	esi		; TokenInformation
		push	1		; TokenInformationClass
		push	dword ptr [edi+24h] ; TokenHandle
		call	ds:GetTokenInformation
		test	eax, eax
		jnz	short loc_100132A5
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		call	ds:GetLastError
		jmp	short loc_100132C8
; ---------------------------------------------------------------------------

loc_100132A5:				; CODE XREF: sub_1001324A+49j
		push	dword ptr [esi]	; pSourceSid
		lea	eax, [ebp+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [ebp+pDestinationSid]
		mov	ecx, edi
		push	eax
		call	sub_100133AE
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_100132C8:				; CODE XREF: sub_1001324A+23j
					; sub_1001324A+59j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_1001324A	endp


; =============== S U B	R O U T	I N E =======================================


sub_100132D8	proc near		; CODE XREF: sub_10013578+FCp

ReturnLength	= dword	ptr -54h
pDestinationSid	= byte ptr -50h
var_4		= dword	ptr -4

		sub	esp, 54h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+54h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	ebx, ecx
		xor	esi, esi
		mov	[esp+60h+ReturnLength],	esi
		push	edi
		cmp	byte ptr [ebx+2Ch], 0
		jnz	short loc_10013302
		mov	eax, 3F0h
		jmp	loc_1001339B
; ---------------------------------------------------------------------------

loc_10013302:				; CODE XREF: sub_100132D8+1Ej
		call	sub_1001324A
		test	eax, eax
		jnz	loc_1001339B
		mov	ebp, ds:GetTokenInformation
		lea	eax, [esp+64h+ReturnLength]
		push	eax		; ReturnLength
		push	esi		; TokenInformationLength
		push	esi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		mov	[esp+78h+ReturnLength],	esi
		call	ebp ; GetTokenInformation
		cmp	[esp+64h+ReturnLength],	esi
		jnz	short loc_10013335

loc_1001332D:				; CODE XREF: sub_100132D8+86j
		call	ds:GetLastError
		jmp	short loc_1001339B
; ---------------------------------------------------------------------------

loc_10013335:				; CODE XREF: sub_100132D8+53j
		push	[esp+64h+ReturnLength]
		call	sub_10018CBA
		pop	ecx
		mov	edi, eax
		lea	eax, [esp+64h+ReturnLength]
		push	eax		; ReturnLength
		push	[esp+68h+ReturnLength] ; TokenInformationLength
		push	edi		; TokenInformation
		push	2		; TokenInformationClass
		push	dword ptr [ebx+24h] ; TokenHandle
		call	ebp ; GetTokenInformation
		test	eax, eax
		jnz	short loc_10013360
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		jmp	short loc_1001332D
; ---------------------------------------------------------------------------

loc_10013360:				; CODE XREF: sub_100132D8+7Cj
		cmp	[edi], esi
		jbe	short loc_10013391
		lea	ebp, [edi+4]

loc_10013367:				; CODE XREF: sub_100132D8+B7j
		test	byte ptr [ebp+4], 20h
		jnz	short loc_10013389
		push	dword ptr [ebp+0] ; pSourceSid
		lea	eax, [esp+68h+pDestinationSid]
		push	eax		; pDestinationSid
		push	44h		; nDestinationSidLength
		call	ds:CopySid
		lea	eax, [esp+64h+pDestinationSid]
		mov	ecx, ebx
		push	eax
		call	sub_1001315A

loc_10013389:				; CODE XREF: sub_100132D8+93j
		inc	esi
		add	ebp, 8
		cmp	esi, [edi]
		jb	short loc_10013367

loc_10013391:				; CODE XREF: sub_100132D8+8Aj
		push	edi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx
		xor	eax, eax

loc_1001339B:				; CODE XREF: sub_100132D8+25j
					; sub_100132D8+31j ...
		mov	ecx, [esp+64h+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 54h
		retn
sub_100132D8	endp


; =============== S U B	R O U T	I N E =======================================


sub_100133AE	proc near		; CODE XREF: sub_10012E2D+13Ep
					; sub_10012FA0+70p ...

arg_0		= dword	ptr  4

		push	ebx
		mov	ebx, ecx
		push	esi
		mov	esi, [esp+8+arg_0]
		push	edi
		mov	ecx, [ebx+4]
		cmp	esi, ecx
		jnb	short loc_100133F3
		cmp	[ebx], esi
		ja	short loc_100133F3
		sub	esi, [ebx]
		push	ebp
		mov	eax, esi
		push	44h
		cdq
		pop	ebp
		idiv	ebp
		mov	esi, eax
		cmp	ecx, [ebx+8]
		jnz	short loc_100133DC
		push	ecx
		mov	ecx, ebx
		call	sub_10013475

loc_100133DC:				; CODE XREF: sub_100133AE+24j
		mov	edi, [ebx+4]
		imul	esi, 44h
		add	esi, [ebx]
		test	edi, edi
		jz	short loc_100133ED
		push	11h
		pop	ecx
		rep movsd

loc_100133ED:				; CODE XREF: sub_100133AE+38j
		add	[ebx+4], ebp
		pop	ebp
		jmp	short loc_10013410
; ---------------------------------------------------------------------------

loc_100133F3:				; CODE XREF: sub_100133AE+Ej
					; sub_100133AE+12j
		cmp	ecx, [ebx+8]
		jnz	short loc_10013400
		push	ecx
		mov	ecx, ebx
		call	sub_10013475

loc_10013400:				; CODE XREF: sub_100133AE+48j
		mov	edi, [ebx+4]
		test	edi, edi
		jz	short loc_1001340C
		push	11h
		pop	ecx
		rep movsd

loc_1001340C:				; CODE XREF: sub_100133AE+57j
		add	dword ptr [ebx+4], 44h

loc_10013410:				; CODE XREF: sub_100133AE+43j
		pop	edi
		pop	esi
		pop	ebx
		retn	4
sub_100133AE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013416	proc near		; CODE XREF: sub_1001302F+106p

arg_0		= dword	ptr  4

		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	eax, [esi+4]
		cmp	edi, eax
		jnb	short loc_10013450
		cmp	[esi], edi
		ja	short loc_10013450
		sub	edi, [esi]
		sar	edi, 3
		cmp	eax, [esi+8]
		jnz	short loc_10013439
		push	ecx
		call	sub_10007DBE

loc_10013439:				; CODE XREF: sub_10013416+1Bj
		mov	edx, [esi+4]
		test	edx, edx
		jz	short loc_1001346C
		mov	ecx, [esi]
		mov	eax, [ecx+edi*8]
		mov	[edx], eax
		mov	eax, [ecx+edi*8+4]
		mov	[edx+4], eax
		jmp	short loc_1001346C
; ---------------------------------------------------------------------------

loc_10013450:				; CODE XREF: sub_10013416+Dj
					; sub_10013416+11j
		cmp	eax, [esi+8]
		jnz	short loc_1001345B
		push	ecx
		call	sub_10007DBE

loc_1001345B:				; CODE XREF: sub_10013416+3Dj
		mov	ecx, [esi+4]
		test	ecx, ecx
		jz	short loc_1001346C
		mov	eax, [edi]
		mov	[ecx], eax
		mov	eax, [edi+4]
		mov	[ecx+4], eax

loc_1001346C:				; CODE XREF: sub_10013416+28j
					; sub_10013416+38j ...
		add	dword ptr [esi+4], 8
		pop	edi
		pop	esi
		retn	4
sub_10013416	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013475	proc near		; CODE XREF: sub_100133AE+29p
					; sub_100133AE+4Dp
		push	ebp
		push	esi
		mov	esi, ecx
		push	edi
		push	44h
		pop	ebp
		mov	edi, [esi+8]
		mov	eax, edi
		mov	ecx, [esi+4]
		sub	eax, ecx
		cdq
		idiv	ebp
		cmp	eax, 1
		jnb	short loc_100134D9
		sub	ecx, [esi]
		mov	eax, ecx
		cdq
		idiv	ebp
		push	ebx
		mov	ebx, 3C3C3C3h
		mov	ecx, ebx
		sub	ecx, eax
		cmp	ecx, 1
		jnb	short loc_100134B0
		push	offset aVectorTTooLong ; "vector<T> too	long"
		call	ds:?_Xlength_error@std@@YAXPBD@Z ; std::_Xlength_error(char const *)

loc_100134B0:				; CODE XREF: sub_10013475+2Ej
		sub	edi, [esi]
		lea	ecx, [eax+1]
		mov	eax, edi
		cdq
		idiv	ebp
		mov	edx, eax
		shr	edx, 1
		sub	ebx, edx
		cmp	ebx, eax
		jnb	short loc_100134C8
		xor	eax, eax
		jmp	short loc_100134CA
; ---------------------------------------------------------------------------

loc_100134C8:				; CODE XREF: sub_10013475+4Dj
		add	eax, edx

loc_100134CA:				; CODE XREF: sub_10013475+51j
		cmp	eax, ecx
		jnb	short loc_100134D0
		mov	eax, ecx

loc_100134D0:				; CODE XREF: sub_10013475+57j
		push	eax
		mov	ecx, esi
		call	sub_100134DF
		pop	ebx

loc_100134D9:				; CODE XREF: sub_10013475+18j
		pop	edi
		pop	esi
		pop	ebp
		retn	4
sub_10013475	endp


; =============== S U B	R O U T	I N E =======================================


sub_100134DF	proc near		; CODE XREF: sub_10013475+5Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		mov	esi, [esp+10h+arg_0]
		xor	ebx, ebx
		mov	ebp, ecx
		test	esi, esi
		jz	short loc_1001350E
		cmp	esi, 3C3C3C3h
		ja	short loc_10013508
		imul	eax, esi, 44h
		push	eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jnz	short loc_1001350E

loc_10013508:				; CODE XREF: sub_100134DF+16j
		call	ds:?_Xbad_alloc@std@@YAXXZ ; std::_Xbad_alloc(void)

loc_1001350E:				; CODE XREF: sub_100134DF+Ej
					; sub_100134DF+27j
		mov	ecx, [ebp+4]
		mov	edx, ebx
		mov	eax, [ebp+0]
		mov	[esp+10h+var_4], ecx
		push	edi
		push	44h
		pop	edi
		cmp	eax, ecx
		jz	short loc_10013542

loc_10013522:				; CODE XREF: sub_100134DF+5Dj
		test	edx, edx
		jz	short loc_10013536
		push	11h
		pop	ecx
		mov	esi, eax
		mov	edi, edx
		rep movsd
		mov	ecx, [esp+14h+var_4]
		push	44h
		pop	edi

loc_10013536:				; CODE XREF: sub_100134DF+45j
		add	eax, edi
		add	edx, edi
		cmp	eax, ecx
		jnz	short loc_10013522
		mov	esi, [esp+14h+arg_0]

loc_10013542:				; CODE XREF: sub_100134DF+41j
		mov	eax, [ebp+4]
		sub	eax, [ebp+0]
		cdq
		idiv	edi
		cmp	dword ptr [ebp+0], 0
		mov	edi, eax
		jz	short loc_1001355D
		push	dword ptr [ebp+0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1001355D:				; CODE XREF: sub_100134DF+72j
		imul	ecx, esi, 44h
		imul	eax, edi, 44h
		pop	edi
		pop	esi
		mov	[ebp+0], ebx
		add	ecx, ebx
		add	eax, ebx
		mov	[ebp+8], ecx
		mov	[ebp+4], eax
		pop	ebp
		pop	ebx
		pop	ecx
		retn	4
sub_100134DF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_10013578@<eax>(LPHANDLE lpTargetHandle@<ecx>, int,	int)
sub_10013578	proc near		; CODE XREF: sub_10014E0C+13p
					; sub_10014E0C+A5p

var_608		= dword	ptr -608h
var_604		= dword	ptr -604h
var_600		= dword	ptr -600h
var_5FC		= dword	ptr -5FCh
var_5F8		= dword	ptr -5F8h
var_5F4		= dword	ptr -5F4h
var_5F0		= dword	ptr -5F0h
var_5EC		= dword	ptr -5ECh
var_5E8		= dword	ptr -5E8h
var_5E4		= dword	ptr -5E4h
var_5E0		= dword	ptr -5E0h
var_5DC		= dword	ptr -5DCh
TokenHandle	= dword	ptr -5D8h
var_5D4		= dword	ptr -5D4h
var_5D0		= byte ptr -5D0h
var_5CC		= dword	ptr -5CCh
var_5C8		= dword	ptr -5C8h
var_5C4		= dword	ptr -5C4h
var_5C0		= byte ptr -5C0h
var_578		= byte ptr -578h
var_530		= byte ptr -530h
var_4E8		= byte ptr -4E8h
var_4A0		= byte ptr -4A0h
var_458		= byte ptr -458h
var_410		= byte ptr -410h
var_3C8		= byte ptr -3C8h
var_380		= byte ptr -380h
var_338		= byte ptr -338h
var_2F0		= byte ptr -2F0h
var_2A8		= byte ptr -2A8h
var_260		= byte ptr -260h
var_218		= byte ptr -218h
pSid		= byte ptr -1D0h
var_188		= byte ptr -188h
var_140		= byte ptr -140h
var_F8		= byte ptr -0F8h
var_B0		= byte ptr -0B0h
var_64		= byte ptr -64h
var_4C		= byte ptr -4Ch
var_34		= byte ptr -34h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 60Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		test	edi, edi
		jnz	short loc_100135A0
		mov	eax, 0A0h
		jmp	loc_10013A74
; ---------------------------------------------------------------------------

loc_100135A0:				; CODE XREF: sub_10013578+1Cj
		xor	ebx, ebx
		mov	[ebp+var_5D4], 7
		lea	eax, [ebp+TokenHandle]
		mov	[ebp+var_5FC], ebx
		push	eax		; TokenHandle
		push	0F01FFh		; DesiredAccess
		mov	[ebp+var_5F8], ebx
		mov	[ebp+var_5F4], ebx
		mov	[ebp+var_5F0], ebx
		mov	[ebp+var_5EC], ebx
		mov	[ebp+var_5E8], ebx
		mov	[ebp+var_5E4], ebx
		mov	[ebp+var_5E0], ebx
		mov	[ebp+var_5DC], ebx
		mov	[ebp+TokenHandle], ebx
		mov	[ebp+var_5D0], bl
		call	ds:GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_10013613
		call	ds:GetLastError
		jmp	short loc_1001361A
; ---------------------------------------------------------------------------

loc_10013613:				; CODE XREF: sub_10013578+91j
		mov	[ebp+var_5D0], 1

loc_1001361A:				; CODE XREF: sub_10013578+99j
		mov	[ebp+var_608], ebx
		mov	[ebp+var_604], ebx
		mov	[ebp+var_600], ebx
		mov	[ebp+var_5CC], ebx
		mov	[ebp+var_5C8], ebx
		mov	[ebp+var_5C4], ebx
		sub	esi, ebx
		jz	loc_100139A5
		dec	esi
		jz	loc_1001395E
		dec	esi
		jz	loc_1001386E
		dec	esi
		jz	loc_10013753
		dec	esi
		jz	short loc_100136AB
		dec	esi
		jz	short loc_1001366E
		dec	esi
		jz	short loc_10013683

loc_10013664:				; CODE XREF: sub_10013578+120j
		mov	esi, 0A0h
		jmp	loc_10013A0B
; ---------------------------------------------------------------------------

loc_1001366E:				; CODE XREF: sub_10013578+E7j
		lea	ecx, [ebp+var_5FC]
		call	sub_100132D8

loc_10013679:				; CODE XREF: sub_10013578+480j
		mov	esi, eax
		test	esi, esi
		jnz	loc_10013A0B

loc_10013683:				; CODE XREF: sub_10013578+EAj
		mov	eax, [ebp+arg_0]
		mov	[ebp+var_5D4], eax
		mov	eax, [ebp+arg_4]
		sub	eax, ebx
		jz	loc_100139FD
		dec	eax
		jnz	short loc_10013664
		push	edi
		lea	ecx, [ebp+var_5FC]
		call	sub_10012AE0
		jmp	loc_10013A09
; ---------------------------------------------------------------------------

loc_100136AB:				; CODE XREF: sub_10013578+E4j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+pSid]	; pSid
		call	sub_10016266
		lea	eax, [ebp+pSid]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_410] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_410]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_260] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_260]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+var_578] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_578]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_1C] ; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	ecx, [ebp+var_608]
		call	sub_100035E0
		push	ebx
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311
		jmp	loc_100139CE
; ---------------------------------------------------------------------------

loc_10013753:				; CODE XREF: sub_10013578+DDj
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_2F0] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_2F0]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_B0] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_B0]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_380] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_380]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	11h		; WellKnownSidType
		lea	ecx, [ebp+var_140] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_140]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_34] ; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_34]
		push	eax		; void *
		lea	ecx, [ebp+var_608]
		call	sub_100035E0
		push	ebx
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_10002311
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_F8] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_F8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_218] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_218]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_2A8] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_2A8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		lea	ecx, [ebp+var_5FC]
		call	sub_1001324A

loc_1001385E:				; CODE XREF: sub_10013578+3E1j
		lea	ecx, [ebp+var_5FC]
		call	sub_1001317F
		jmp	loc_100139CE
; ---------------------------------------------------------------------------

loc_1001386E:				; CODE XREF: sub_10013578+D6j
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_338] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_338]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_3C8] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_3C8]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	0Bh		; WellKnownSidType
		lea	ecx, [ebp+var_458] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_458]
		push	eax
		lea	ecx, [ebp+var_5CC]
		call	sub_100133AE
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_64] ; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_64]
		push	eax		; void *
		lea	ecx, [ebp+var_608]
		call	sub_100035E0
		push	ebx
		push	1
		lea	ecx, [ebp+var_64]
		call	sub_10002311
		push	1Bh		; WellKnownSidType
		lea	ecx, [ebp+var_530] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_530]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		push	1		; WellKnownSidType
		lea	ecx, [ebp+var_5C0] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_5C0]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_4E8] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_4E8]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jl	short loc_100139CE
		jmp	loc_1001385E
; ---------------------------------------------------------------------------

loc_1001395E:				; CODE XREF: sub_10013578+CFj
		push	offset aSechangenotify ; "SeChangeNotifyPrivilege"
		lea	ecx, [ebp+var_4C] ; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_4C]
		push	eax		; void *
		lea	ecx, [ebp+var_608]
		call	sub_100035E0
		push	ebx
		push	1
		lea	ecx, [ebp+var_4C]
		call	sub_10002311
		lea	ecx, [ebp+var_5FC]
		call	sub_10012FA0
		push	12h		; WellKnownSidType
		lea	ecx, [ebp+var_4A0] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_4A0]
		jmp	short loc_100139C2
; ---------------------------------------------------------------------------

loc_100139A5:				; CODE XREF: sub_10013578+C8j
		lea	ecx, [ebp+var_5FC]
		call	sub_10012FA0
		push	ebx		; WellKnownSidType
		lea	ecx, [ebp+var_188] ; pSid
		call	sub_10016266
		lea	eax, [ebp+var_188]

loc_100139C2:				; CODE XREF: sub_10013578+42Bj
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001315A

loc_100139CE:				; CODE XREF: sub_10013578+1D6j
					; sub_10013578+2F1j ...
		lea	eax, [ebp+var_5CC]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_10012E2D
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10013A0B
		lea	eax, [ebp+var_608]
		push	eax
		lea	ecx, [ebp+var_5FC]
		call	sub_1001302F
		jmp	loc_10013679
; ---------------------------------------------------------------------------

loc_100139FD:				; CODE XREF: sub_10013578+119j
		push	edi		; lpTargetHandle
		lea	ecx, [ebp+var_5FC]
		call	sub_10012DA7

loc_10013A09:				; CODE XREF: sub_10013578+12Ej
		mov	esi, eax

loc_10013A0B:				; CODE XREF: sub_10013578+F1j
					; sub_10013578+105j ...
		lea	ecx, [ebp+var_5CC]
		call	sub_10013CB0
		lea	ecx, [ebp+var_608]
		call	sub_1000394E
		cmp	[ebp+TokenHandle], ebx
		jz	short loc_10013A35
		push	[ebp+TokenHandle] ; hObject
		call	ds:CloseHandle

loc_10013A35:				; CODE XREF: sub_10013578+4AFj
		lea	ecx, [ebp+var_5E4]
		call	sub_10013CB0
		cmp	[ebp+var_5F0], ebx
		jz	short loc_10013A67
		push	[ebp+var_5F0]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	[ebp+var_5F0], ebx
		mov	[ebp+var_5EC], ebx
		mov	[ebp+var_5E8], ebx

loc_10013A67:				; CODE XREF: sub_10013578+4CEj
		lea	ecx, [ebp+var_5FC]
		call	sub_10013CB0
		mov	eax, esi

loc_10013A74:				; CODE XREF: sub_10013578+23j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10013578	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10013A85(int,	void *)
sub_10013A85	proc near		; CODE XREF: sub_10014E0C+56p

bSaclPresent	= dword	ptr -2Ch
bSaclDefaulted	= dword	ptr -28h
pSacl		= dword	ptr -24h
SecurityDescriptor= dword ptr -20h
StringSecurityDescriptor= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		lea	ecx, [ebp+StringSecurityDescriptor] ; void *
		push	edi
		mov	edi, handle
		push	offset aS	; "S:("
		call	sub_10001C7F
		mov	ebx, offset aMl	; "ML"
		mov	ecx, ebx
		call	sub_10001AF3
		push	eax		; int
		push	ebx		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	ebx, offset asc_1002CA50 ; ";;"
		mov	ecx, ebx
		call	sub_10001AF3
		push	eax		; int
		push	ebx		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	ebx, offset SubKey
		mov	ecx, ebx
		call	sub_10001AF3
		push	eax		; int
		push	ebx		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	ebx, offset asc_1002CA48 ; ";;;"
		mov	ecx, ebx
		call	sub_10001AF3
		push	eax		; int
		push	ebx		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	ecx, esi
		call	sub_10001AF3
		push	eax		; int
		push	esi		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	esi, offset asc_1002CA74 ; ")"
		mov	ecx, esi
		call	sub_10001AF3
		push	eax		; int
		push	esi		; void *
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10003388
		mov	eax, [ebp+StringSecurityDescriptor]
		xor	ebx, ebx
		cmp	[ebp+var_8], 8
		mov	[ebp+SecurityDescriptor], ebx
		mov	[ebp+pSacl], ebx
		mov	[ebp+bSaclPresent], ebx
		mov	[ebp+bSaclDefaulted], ebx
		jnb	short loc_10013B47
		lea	eax, [ebp+StringSecurityDescriptor]

loc_10013B47:				; CODE XREF: sub_10013A85+BDj
		push	ebx		; SecurityDescriptorSize
		lea	ecx, [ebp+SecurityDescriptor]
		push	ecx		; SecurityDescriptor
		push	1		; StringSDRevision
		push	eax		; StringSecurityDescriptor
		call	ds:ConvertStringSecurityDescriptorToSecurityDescriptorW
		test	eax, eax
		jz	short loc_10013B98
		lea	eax, [ebp+bSaclDefaulted]
		push	eax		; lpbSaclDefaulted
		lea	eax, [ebp+pSacl]
		push	eax		; pSacl
		lea	eax, [ebp+bSaclPresent]
		push	eax		; lpbSaclPresent
		push	[ebp+SecurityDescriptor] ; pSecurityDescriptor
		call	ds:GetSecurityDescriptorSacl
		test	eax, eax
		jz	short loc_10013B85
		push	[ebp+pSacl]	; pSacl
		push	ebx		; pDacl
		push	ebx		; psidGroup
		push	ebx		; psidOowner
		push	10h		; SecurityInfo
		push	7		; ObjectType
		push	edi		; handle
		call	ds:SetSecurityInfo
		jmp	short loc_10013B8B
; ---------------------------------------------------------------------------

loc_10013B85:				; CODE XREF: sub_10013A85+EBj
		call	ds:GetLastError

loc_10013B8B:				; CODE XREF: sub_10013A85+FEj
		push	[ebp+SecurityDescriptor] ; hMem
		mov	esi, eax
		call	ds:LocalFree
		jmp	short loc_10013BA0
; ---------------------------------------------------------------------------

loc_10013B98:				; CODE XREF: sub_10013A85+D2j
		call	ds:GetLastError
		mov	esi, eax

loc_10013BA0:				; CODE XREF: sub_10013A85+111j
		push	ebx
		push	1
		lea	ecx, [ebp+StringSecurityDescriptor]
		call	sub_10002311
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10013A85	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013BBE	proc near		; CODE XREF: sub_10013C26+1Dp
					; sub_10014E0C+4Fp

var_4		= dword	ptr -4

		push	ecx
		and	[esp+4+var_4], 0
		cmp	ecx, 7		; switch 8 cases
		ja	short loc_10013C00 ; jumptable 10013BC8	default	case
		jmp	ds:off_10013C06[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10013BCF:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS11616384 ; jumptable 10013BC8 case 0
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BD6:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS11612288 ; jumptable 10013BC8 case 1
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BDD:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS1168192 ;	jumptable 10013BC8 case	2
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BE4:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS1166144 ;	jumptable 10013BC8 case	3
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BEB:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS1164096 ;	jumptable 10013BC8 case	4
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BF2:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS1162048 ;	jumptable 10013BC8 case	5
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013BF9:				; CODE XREF: sub_10013BBE+Aj
					; DATA XREF: .text:off_10013C06o
		mov	eax, offset aS1160 ; jumptable 10013BC8	case 6
		pop	ecx
		retn
; ---------------------------------------------------------------------------

loc_10013C00:				; CODE XREF: sub_10013BBE+8j
					; sub_10013BBE+Aj
					; DATA XREF: ...
		xor	eax, eax	; jumptable 10013BC8 default case
		pop	ecx
		retn
sub_10013BBE	endp

; ---------------------------------------------------------------------------
		db 8Bh,	0FFh
off_10013C06	dd offset loc_10013BCF	; DATA XREF: sub_10013BBE+Ar
		dd offset loc_10013BD6	; jump table for switch	statement
		dd offset loc_10013BDD
		dd offset loc_10013BE4
		dd offset loc_10013BEB
		dd offset loc_10013BF2
		dd offset loc_10013BF9
		dd offset loc_10013C00

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10013C26(HANDLE TokenHandle)
sub_10013C26	proc near		; CODE XREF: sub_10012AE0+26Cp
					; sub_10017D8F+69p

TokenInformation= dword	ptr -0Ch
var_8		= dword	ptr -8
Sid		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	ebx
		push	esi
		push	edi
		mov	esi, edx
		mov	ebx, ecx
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jge	short loc_10013C41

loc_10013C3D:				; CODE XREF: sub_10013C26+24j
		xor	eax, eax
		jmp	short loc_10013CA9
; ---------------------------------------------------------------------------

loc_10013C41:				; CODE XREF: sub_10013C26+15j
		mov	ecx, esi
		call	sub_10013BBE
		test	eax, eax
		jz	short loc_10013C3D
		lea	ecx, [ebp+Sid]
		xor	edi, edi
		push	ecx		; Sid
		push	eax		; StringSid
		mov	[ebp+Sid], edi
		call	ds:ConvertStringSidToSidW
		test	eax, eax
		jnz	short loc_10013C68
		call	ds:GetLastError
		jmp	short loc_10013CA9
; ---------------------------------------------------------------------------

loc_10013C68:				; CODE XREF: sub_10013C26+38j
		mov	eax, [ebp+Sid]
		mov	[ebp+var_8], edi
		push	eax		; pSid
		mov	[ebp+var_8], 20h
		mov	[ebp+TokenInformation],	eax
		call	ds:GetLengthSid
		add	eax, 8
		push	eax		; TokenInformationLength
		lea	eax, [ebp+TokenInformation]
		push	eax		; TokenInformation
		push	19h		; TokenInformationClass
		push	ebx		; TokenHandle
		call	ds:SetTokenInformation
		push	[ebp+Sid]	; hMem
		mov	esi, eax
		call	ds:LocalFree
		test	esi, esi
		jnz	short loc_10013CA7
		call	ds:GetLastError
		mov	edi, eax

loc_10013CA7:				; CODE XREF: sub_10013C26+77j
		mov	eax, edi

loc_10013CA9:				; CODE XREF: sub_10013C26+19j
					; sub_10013C26+40j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10013C26	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013CB0	proc near		; CODE XREF: sub_10013578+499p
					; sub_10013578+4C3p ...
		push	esi
		mov	esi, ecx
		cmp	dword ptr [esi], 0
		jz	short loc_10013CCB
		push	dword ptr [esi]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi], eax
		mov	[esi+4], eax
		mov	[esi+8], eax

loc_10013CCB:				; CODE XREF: sub_10013CB0+6j
		pop	esi
		retn
sub_10013CB0	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013CCD	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+60p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+4Fp ...
		cmp	g_shared_section, 0
		jnz	short loc_10013CD9
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10013CD9:				; CODE XREF: sub_10013CCD+7j
		mov	eax, dword_10031FA4
		mov	byte_10031CB9, 0
		test	al, 1
		jnz	short loc_10013D02
		or	eax, 1
		mov	dword_10031F9C,	offset off_1002D9CC
		and	dword_10031FA0,	0
		mov	dword_10031FA4,	eax

loc_10013D02:				; CODE XREF: sub_10013CCD+1Aj
		mov	eax, offset dword_10031F9C
		retn
sub_10013CCD	endp

; Exported entry  16. IsSandboxedProcess

; =============== S U B	R O U T	I N E =======================================


		public IsSandboxedProcess
IsSandboxedProcess proc	near		; DATA XREF: .rdata:off_1002E058o
		xor	eax, eax
		cmp	g_shared_section, eax
		setnz	al
		retn
IsSandboxedProcess endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013D14	proc near		; CODE XREF: sub_100142EE+2Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, edx

loc_10013D1C:				; CODE XREF: sub_10013D14+37j
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_8]
		push	1
		push	2000h
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], 10000h
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10013D72
		cmp	[ebp+var_4], 80000h
		jb	short loc_10013D1C
		push	4
		push	1000h
		lea	eax, [ebp+var_8]
		mov	[ebp+var_8], esi
		push	eax
		push	0
		lea	eax, [ebp+var_4]
		push	eax
		push	0FFFFFFFFh
		call	g_nt
		test	eax, eax
		js	short loc_10013D72
		mov	eax, [ebp+var_4]
		jmp	short loc_10013D74
; ---------------------------------------------------------------------------

loc_10013D72:				; CODE XREF: sub_10013D14+2Ej
					; sub_10013D14+57j
		xor	eax, eax

loc_10013D74:				; CODE XREF: sub_10013D14+5Cj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10013D14	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013D79	proc near		; CODE XREF: sub_10013DEBp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		xor	ecx, ecx
		cmp	dword_10031DF0,	ecx
		jnz	short loc_10013DE1
		push	4
		push	ecx
		push	2
		lea	eax, [ebp+var_8]
		mov	[ebp+var_4], ecx
		push	eax
		push	ecx
		push	ecx
		push	ecx
		lea	eax, [ebp+var_4]
		mov	[ebp+var_8], ecx
		push	eax
		push	0FFFFFFFFh
		push	g_shared_section
		call	dword_10031D18
		test	eax, eax
		js	short loc_10013DE7
		mov	ecx, [ebp+var_4]
		test	ecx, ecx
		jz	short loc_10013DE7
		mov	edx, offset dword_10031DF0
		xor	eax, eax
		lock cmpxchg [edx], ecx
		test	eax, eax
		jz	short loc_10013DD1
		push	[ebp+var_4]
		push	0FFFFFFFFh
		call	dword_10031D30

loc_10013DD1:				; CODE XREF: sub_10013D79+4Bj
		mov	eax, dword_10031DF0
		add	eax, g_shared_IPC_size
		mov	dword_10031DEC,	eax

loc_10013DE1:				; CODE XREF: sub_10013D79+Dj
		mov	al, 1

loc_10013DE3:				; CODE XREF: sub_10013D79+70j
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10013DE7:				; CODE XREF: sub_10013D79+35j
					; sub_10013D79+3Cj
		xor	al, al
		jmp	short loc_10013DE3
sub_10013D79	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013DEB	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+A1p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+90p ...
		call	sub_10013D79
		test	al, al
		jnz	short loc_10013DF7
		xor	eax, eax
		retn
; ---------------------------------------------------------------------------

loc_10013DF7:				; CODE XREF: sub_10013DEB+7j
		mov	eax, dword_10031DF0
		retn
sub_10013DEB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10013DFD	proc near		; CODE XREF: sub_1000E4CB+22p
					; sub_1000E740+Bp ...
		cmp	dword_10031DF8,	0
		jnz	short loc_10013E38
		xor	eax, eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	eax
		push	2
		call	dword_10031D40
		mov	edx, eax
		test	edx, edx
		jnz	short loc_10013E1E
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10013E1E:				; CODE XREF: sub_10013DFD+1Cj
		push	esi
		mov	ecx, edx
		mov	esi, offset dword_10031DF8
		xor	eax, eax
		lock cmpxchg [esi], ecx
		pop	esi
		test	eax, eax
		jz	short loc_10013E38
		push	edx
		call	dword_10031D48

loc_10013E38:				; CODE XREF: sub_10013DFD+7j
					; sub_10013DFD+32j
		xor	eax, eax
		cmp	dword_10031DF8,	eax
		setnz	al
		retn
sub_10013DFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013E44	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+7Ep
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+93p ...

var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	10h
		push	offset stru_1002DF08
		call	__SEH_prolog4
		mov	eax, edx
		xor	edx, edx
		mov	[ebp+ms_exc.registration.TryLevel], edx
		mov	[ebp+var_20], edx
		mov	[ebp+var_1C], ecx
		lea	esi, [ecx-1]
		add	esi, eax
		cmp	[ebp+arg_0], 1
		jnz	short loc_10013E7D

loc_10013E68:				; CODE XREF: sub_10013E44+33j
		cmp	ecx, esi
		jnb	short loc_10013E79
		mov	[ecx], dl
		add	ecx, 1000h
		mov	[ebp+var_1C], ecx
		jmp	short loc_10013E68
; ---------------------------------------------------------------------------

loc_10013E79:				; CODE XREF: sub_10013E44+26j
		mov	[esi], dl
		jmp	short loc_10013E9C
; ---------------------------------------------------------------------------

loc_10013E7D:				; CODE XREF: sub_10013E44+22j
					; sub_10013E44+4Ej
		cmp	ecx, esi
		jnb	short loc_10013E94
		movsx	eax, byte ptr [ecx]
		add	edx, eax
		mov	[ebp+var_20], edx
		add	ecx, 1000h
		mov	[ebp+var_1C], ecx
		jmp	short loc_10013E7D
; ---------------------------------------------------------------------------

loc_10013E94:				; CODE XREF: sub_10013E44+3Bj
		movsx	eax, byte ptr [esi]
		add	edx, eax
		mov	[ebp+var_20], edx

loc_10013E9C:				; CODE XREF: sub_10013E44+37j
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	al, 1
		jmp	short loc_10013EB7
; ---------------------------------------------------------------------------

loc_10013EA7:				; DATA XREF: .rdata:stru_1002DF08o
		xor	eax, eax	; Exception filter 0 for function 10013E44
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013EAB:				; DATA XREF: .rdata:stru_1002DF08o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013E44
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	al, al

loc_10013EB7:				; CODE XREF: sub_10013E44+61j
		call	__SEH_epilog4
		retn
sub_10013E44	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013EBD	proc near		; CODE XREF: TargetNtSetInformationThread(x,x,x,x,x)+29p
					; sub_10013F01+ABp ...

var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	0Ch
		push	offset stru_1002DF28
		call	__SEH_prolog4
		xor	esi, esi
		mov	[ebp+ms_exc.registration.TryLevel], esi
		push	[ebp+arg_0]
		push	edx
		push	ecx
		call	dword_10031D5C
		add	esp, 0Ch
		jmp	short loc_10013EF2
; ---------------------------------------------------------------------------

loc_10013EDE:				; DATA XREF: .rdata:stru_1002DF28o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10013EBD
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_1C], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013EEC:				; DATA XREF: .rdata:stru_1002DF28o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013EBD
		mov	esi, [ebp+var_1C]

loc_10013EF2:				; CODE XREF: sub_10013EBD+1Fj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, esi
		call	__SEH_epilog4
		retn
sub_10013EBD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10013F01	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+C0p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+ABp ...

var_34		= dword	ptr -34h
var_30		= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	24h
		push	offset stru_1002DF48
		call	__SEH_prolog4
		mov	ebx, edx
		mov	[ebp+var_34], ebx
		mov	[ebp+var_1C], ecx
		call	sub_10013DFD
		test	al, al
		jnz	short loc_10013F28
		mov	eax, 0C0000017h
		jmp	loc_10014028
; ---------------------------------------------------------------------------

loc_10013F28:				; CODE XREF: sub_10013F01+1Bj
		xor	edi, edi
		mov	[ebx], edi
		mov	esi, 0C0000001h
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	eax, [ebp+var_1C]
		cmp	[eax+4], edi
		jz	short loc_10013F45
		cmp	[ebp+arg_4], edi
		jz	loc_10013FE7

loc_10013F45:				; CODE XREF: sub_10013F01+39j
		mov	eax, [eax+8]
		test	eax, eax
		jz	loc_10013FE7
		cmp	[eax+4], edi
		jz	loc_10013FE7
		movzx	eax, word ptr [eax]
		push	2
		pop	edx
		add	eax, edx
		mov	[ebp+var_28], eax
		shr	eax, 1
		mov	[ebp+var_2C], eax
		xor	ecx, ecx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		mov	[ebp+var_24], ecx
		call	sub_10013DFD
		test	al, al
		jz	short loc_10013F94
		push	[ebp+var_24]
		push	edi
		push	dword_10031DF8
		call	dword_10031D34
		mov	ecx, eax
		jmp	short loc_10013F96
; ---------------------------------------------------------------------------

loc_10013F94:				; CODE XREF: sub_10013F01+7Dj
		mov	ecx, edi

loc_10013F96:				; CODE XREF: sub_10013F01+91j
		mov	[ebx], ecx
		test	ecx, ecx
		jz	short loc_10013FE7
		mov	eax, [ebp+var_28]
		add	eax, 0FFFFFFFEh
		push	eax
		mov	edx, [ebp+var_1C]
		mov	edx, [edx+8]
		mov	edx, [edx+4]
		call	sub_10013EBD
		pop	ecx
		mov	esi, eax
		mov	[ebp+var_20], esi
		test	esi, esi
		js	short loc_10013FE7
		mov	eax, [ebx]
		xor	edx, edx
		mov	ecx, [ebp+var_2C]
		mov	[eax+ecx*2-2], dx
		mov	edx, [ebp+arg_0]
		mov	ecx, [ebp+var_1C]
		test	edx, edx
		jz	short loc_10013FD6
		mov	eax, [ecx+0Ch]
		mov	[edx], eax

loc_10013FD6:				; CODE XREF: sub_10013F01+CEj
		mov	edx, [ebp+arg_4]
		test	edx, edx
		jz	short loc_10013FE2
		mov	eax, [ecx+4]
		mov	[edx], eax

loc_10013FE2:				; CODE XREF: sub_10013F01+DAj
		mov	esi, edi
		mov	[ebp+var_20], esi

loc_10013FE7:				; CODE XREF: sub_10013F01+3Ej
					; sub_10013F01+49j ...
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		jmp	short loc_10014013
; ---------------------------------------------------------------------------

loc_10013FF0:				; DATA XREF: .rdata:stru_1002DF48o
		mov	eax, [ebp+ms_exc.exc_ptr] ; Exception filter 0 for function 10013F01
		mov	eax, [eax]
		mov	eax, [eax]
		mov	[ebp+var_30], eax
		xor	eax, eax
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10013FFE:				; DATA XREF: .rdata:stru_1002DF48o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10013F01
		mov	esi, [ebp+var_30]
		mov	[ebp+var_20], esi
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		xor	edi, edi
		mov	ebx, [ebp+var_34]

loc_10014013:				; CODE XREF: sub_10013F01+EDj
		test	esi, esi
		jns	short loc_10014026
		mov	ecx, [ebx]
		test	ecx, ecx
		jz	short loc_10014026
		xor	edx, edx
		call	sub_10014324
		mov	[ebx], edi

loc_10014026:				; CODE XREF: sub_10013F01+114j
					; sub_10013F01+11Aj
		mov	eax, esi

loc_10014028:				; CODE XREF: sub_10013F01+22j
		call	__SEH_epilog4
		retn
sub_10013F01	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001402E	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+7Ap
					; TargetNtUnmapViewOfSection(x,x,x)+16p

var_1C		= byte ptr -1Ch
var_C		= dword	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		push	esi
		mov	esi, ecx
		cmp	esi, 0FFFFFFFFh
		jnz	short loc_10014040
		mov	al, 1
		jmp	short loc_100140A1
; ---------------------------------------------------------------------------

loc_10014040:				; CODE XREF: sub_1001402E+Cj
		cmp	dword_10031F74,	0
		jnz	short loc_1001406F
		lea	eax, [ebp+var_4]
		push	eax
		push	18h
		lea	eax, [ebp+var_1C]
		push	eax
		push	0
		push	0FFFFFFFFh
		call	dword_10031D20
		test	eax, eax
		js	short loc_1001409F
		cmp	[ebp+var_4], 18h
		jnz	short loc_1001406F
		mov	eax, [ebp+var_C]
		mov	dword_10031F74,	eax

loc_1001406F:				; CODE XREF: sub_1001402E+19j
					; sub_1001402E+37j
		lea	eax, [ebp+var_4]
		push	eax
		push	18h
		lea	eax, [ebp+var_1C]
		push	eax
		push	0
		push	esi
		call	dword_10031D20
		test	eax, eax
		js	short loc_1001409F
		cmp	[ebp+var_4], 18h
		mov	ecx, [ebp+var_C]
		jz	short loc_10014092
		mov	ecx, [ebp+var_4]

loc_10014092:				; CODE XREF: sub_1001402E+5Fj
		xor	eax, eax
		cmp	ecx, dword_10031F74
		setz	al
		jmp	short loc_100140A1
; ---------------------------------------------------------------------------

loc_1001409F:				; CODE XREF: sub_1001402E+31j
					; sub_1001402E+56j
		xor	al, al

loc_100140A1:				; CODE XREF: sub_1001402E+10j
					; sub_1001402E+6Fj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001402E	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100140A6	proc near		; CODE XREF: TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+CAp
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+DFp ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, ecx
		push	esi
		call	dword_10031D54
		mov	word ptr [ebp+var_8], ax
		mov	edx, [ebp+var_8]
		inc	edx
		mov	[ebp+var_4], esi
		mov	word ptr [ebp+var_8+2],	dx
		pop	ecx
		cmp	ax, dx
		ja	short loc_1001411B
		movzx	eax, dx
		lea	esi, ds:8[eax*2]
		call	sub_10013DFD
		test	al, al
		jz	short loc_1001411B
		push	esi
		push	0
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax
		test	esi, esi
		jz	short loc_1001411B
		mov	ecx, [ebp+var_8+2]
		lea	eax, [ebp+var_8]
		add	ecx, ecx
		push	0
		mov	[esi+2], cx
		lea	ecx, [esi+8]
		push	eax
		push	esi
		mov	[esi+4], ecx
		call	dword_10031D38
		test	eax, eax
		jns	short loc_10014122
		xor	edx, edx
		mov	ecx, esi
		call	sub_10014324

loc_1001411B:				; CODE XREF: sub_100140A6+22j
					; sub_100140A6+35j ...
		xor	eax, eax

loc_1001411D:				; CODE XREF: sub_100140A6+7Ej
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
; ---------------------------------------------------------------------------

loc_10014122:				; CODE XREF: sub_100140A6+6Aj
		mov	eax, esi
		jmp	short loc_1001411D
sub_100140A6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014126	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+112p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h

		push	14h
		push	offset stru_1002DF68
		call	__SEH_prolog4
		mov	esi, edx
		mov	edx, ecx
		xor	edi, edi
		mov	[ebp+var_1C], edi
		mov	[ebp+ms_exc.registration.TryLevel], edi
		mov	[esi], edi
		mov	ebx, offset off_1001AA20
		mov	[ebp+var_24], ebx
		mov	[ebp+var_20], edx
		lea	ecx, [ebp+var_24]
		call	sub_100058D3
		test	al, al
		jz	short loc_100141A0
		mov	dword ptr [esi], 1
		mov	eax, [edx+3Ch]
		push	dword ptr [eax+edx+78h]
		lea	ecx, [ebp+var_24]
		call	ds:off_1001AA24
		test	eax, eax
		jz	short loc_10014186
		push	dword ptr [eax+0Ch]
		lea	ecx, [ebp+var_24]
		call	sub_10005906
		mov	ecx, eax
		call	sub_100140A6
		mov	[ebp+var_1C], eax

loc_10014186:				; CODE XREF: sub_10014126+49j
		mov	eax, [ebp+var_20]
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		jz	short loc_100141A0
		cmp	[ecx+28h], edi
		jz	short loc_10014198
		or	dword ptr [esi], 2

loc_10014198:				; CODE XREF: sub_10014126+6Dj
		cmp	[ecx+1Ch], edi
		jz	short loc_100141A0
		or	dword ptr [esi], 4

loc_100141A0:				; CODE XREF: sub_10014126+2Fj
					; sub_10014126+68j ...
		mov	[ebp+var_24], ebx
		jmp	short loc_100141AC
; ---------------------------------------------------------------------------

loc_100141A5:				; DATA XREF: .rdata:stru_1002DF68o
		xor	eax, eax	; Exception filter 0 for function 10014126
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_100141A9:				; DATA XREF: .rdata:stru_1002DF68o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10014126

loc_100141AC:				; CODE XREF: sub_10014126+7Dj
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	eax, [ebp+var_1C]
		call	__SEH_epilog4
		retn
sub_10014126	endp


; =============== S U B	R O U T	I N E =======================================


sub_100141BC	proc near		; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+192p
		push	ebx
		push	esi
		push	edi
		test	ecx, ecx
		jz	short loc_100141F2
		mov	edx, [ecx+4]
		test	edx, edx
		jz	short loc_100141F2
		movzx	eax, word ptr [ecx]
		xor	edi, edi
		shr	eax, 1
		dec	eax
		mov	ecx, eax
		js	short loc_100141FC
		lea	esi, [edx+eax*2]

loc_100141D9:				; CODE XREF: sub_100141BC+27j
		cmp	word ptr [esi],	5Ch
		jz	short loc_100141E7
		sub	esi, 2
		dec	ecx
		jns	short loc_100141D9
		jmp	short loc_100141EA
; ---------------------------------------------------------------------------

loc_100141E7:				; CODE XREF: sub_100141BC+21j
		lea	edi, [edx+ecx*2]

loc_100141EA:				; CODE XREF: sub_100141BC+29j
		cmp	ecx, eax
		jnz	short loc_100141F8
		test	edi, edi
		jz	short loc_100141FC

loc_100141F2:				; CODE XREF: sub_100141BC+5j
					; sub_100141BC+Cj ...
		xor	eax, eax

loc_100141F4:				; CODE XREF: sub_100141BC+A9j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_100141F8:				; CODE XREF: sub_100141BC+30j
		test	edi, edi
		jnz	short loc_100141FF

loc_100141FC:				; CODE XREF: sub_100141BC+18j
					; sub_100141BC+34j
		lea	edi, [edx-2]

loc_100141FF:				; CODE XREF: sub_100141BC+3Ej
		sub	eax, ecx
		lea	ebx, ds:2[eax*2]
		call	sub_10013DFD
		test	al, al
		jz	short loc_100141F2
		lea	eax, [ebx+8]
		push	eax
		push	0
		push	dword_10031DF8
		call	dword_10031D34
		mov	esi, eax
		test	esi, esi
		jz	short loc_100141F2
		lea	edx, [ebx-2]
		mov	[esi+2], bx
		movzx	eax, dx
		lea	ecx, [esi+8]
		mov	[esi], dx
		lea	edx, [edi+2]
		push	eax
		mov	[esi+4], ecx
		call	sub_10013EBD
		pop	ecx
		test	eax, eax
		jns	short loc_10014255
		xor	edx, edx
		mov	ecx, esi
		call	sub_10014324
		jmp	short loc_100141F2
; ---------------------------------------------------------------------------

loc_10014255:				; CODE XREF: sub_100141BC+8Cj
		movzx	ecx, word ptr [esi]
		mov	eax, [esi+4]
		shr	ecx, 1
		xor	edx, edx
		mov	[eax+ecx*2], dx
		mov	eax, esi
		jmp	short loc_100141F4
sub_100141BC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014267	proc near		; CODE XREF: sub_10009A67+67p
					; sub_10016763+6Cp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_4]
		push	esi
		mov	esi, ecx
		mov	[ebp+arg_4], eax
		lea	eax, [esi+0Ch]
		push	eax
		push	4
		lea	eax, [ebp+arg_4]
		push	eax
		lea	eax, [ebp+arg_0]
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D1C
		test	eax, eax
		js	short loc_1001429C
		mov	ecx, [ebp+arg_0]
		mov	[esi+4], ecx
		mov	ecx, [ebp+arg_4]
		mov	byte ptr [esi],	1
		mov	[esi+8], ecx

loc_1001429C:				; CODE XREF: sub_10014267+24j
		pop	esi
		pop	ebp
		retn	0Ch
sub_10014267	endp


; =============== S U B	R O U T	I N E =======================================


sub_100142A1	proc near		; CODE XREF: sub_1000A086+4Bp
					; TargetNtSetInformationFile(x,x,x,x,x,x)+C2p

arg_0		= dword	ptr  4

		cmp	[esp+arg_0], 0Ah
		jnz	short loc_100142EB
		cmp	edx, 10h
		jb	short loc_100142EB
		lea	eax, [edx-0Ch]
		cmp	eax, [ecx+8]
		jb	short loc_100142EB
		cmp	dword ptr [ecx+4], 0
		jnz	short loc_100142EB
		cmp	dword ptr [ecx+8], 8
		jb	short loc_100142EB
		cmp	dword ptr [ecx+8], 0FFFFh
		ja	short loc_100142EB
		push	5Ch
		pop	eax
		cmp	[ecx+0Ch], ax
		jnz	short loc_100142EB
		push	3Fh
		pop	edx
		cmp	[ecx+0Eh], dx
		jnz	short loc_100142EB
		cmp	[ecx+10h], dx
		jnz	short loc_100142EB
		cmp	[ecx+12h], ax
		jnz	short loc_100142EB
		mov	al, 1
		retn
; ---------------------------------------------------------------------------

loc_100142EB:				; CODE XREF: sub_100142A1+5j
					; sub_100142A1+Aj ...
		xor	al, al
		retn
sub_100142A1	endp


; =============== S U B	R O U T	I N E =======================================


sub_100142EE	proc near		; CODE XREF: sub_1000E52C+97p
		push	esi
		xor	esi, esi
		push	edi
		mov	edi, ecx
		test	edx, edx
		jnz	short loc_10014311
		call	sub_10013DFD
		test	al, al
		jz	short loc_1001431F
		push	edi
		push	esi
		push	dword_10031DF8
		call	dword_10031D34
		jmp	short loc_1001431D
; ---------------------------------------------------------------------------

loc_10014311:				; CODE XREF: sub_100142EE+8j
		cmp	edx, 1
		jnz	short loc_1001431F
		mov	edx, edi
		call	sub_10013D14

loc_1001431D:				; CODE XREF: sub_100142EE+21j
		mov	esi, eax

loc_1001431F:				; CODE XREF: sub_100142EE+11j
					; sub_100142EE+26j
		pop	edi
		mov	eax, esi
		pop	esi
		retn
sub_100142EE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014324	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+1CFp
					; TargetNtOpenFile(x,x,x,x,x,x,x)+1B2p	...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		test	edx, edx
		jnz	short loc_1001433D
		push	ecx
		push	edx
		push	dword_10031DF8
		call	dword_10031D4C
		jmp	short loc_1001435E
; ---------------------------------------------------------------------------

loc_1001433D:				; CODE XREF: sub_10014324+7j
		cmp	edx, 1
		jnz	short loc_1001435E
		and	[ebp+var_4], 0
		lea	eax, [ebp+var_4]
		push	8000h
		push	eax
		lea	eax, [ebp+var_8]
		mov	[ebp+var_8], ecx
		push	eax
		push	0FFFFFFFFh
		call	dword_10031D14

loc_1001435E:				; CODE XREF: sub_10014324+17j
					; sub_10014324+1Cj
		mov	esp, ebp
		pop	ebp
		retn
sub_10014324	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_10014362(HANDLE hFile)
sub_10014362	proc near		; CODE XREF: sub_10014B8A+Ap
					; sub_10014BAC+Ap
		test	ecx, ecx
		jnz	short loc_10014369

loc_10014366:				; CODE XREF: sub_10014362+Aj
		xor	al, al
		retn
; ---------------------------------------------------------------------------

loc_10014369:				; CODE XREF: sub_10014362+2j
		cmp	ecx, 0FFFFFFFFh
		jz	short loc_10014366
		push	ecx		; hFile
		call	ds:GetFileType
		mov	ecx, eax
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jz	short locret_10014385
		cmp	ecx, 3
		jz	short locret_10014385
		xor	eax, eax

locret_10014385:			; CODE XREF: sub_10014362+1Aj
					; sub_10014362+1Fj
		retn
sub_10014362	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014386	proc near		; CODE XREF: sub_100081A6+15p
		push	ebx
		push	ebp
		push	edi
		mov	edi, ecx
		xor	ebx, ebx
		push	ebx
		push	ebx
		mov	[edi+4], ebx
		mov	[edi+8], ebx
		mov	[edi+0Ch], ebx
		mov	dword ptr [edi+10h], offset off_1002CC74
		mov	dword ptr [edi], offset	off_1002CD44
		mov	dword ptr [edi+10h], offset off_1002CCDC
		mov	[edi+2Ch], ebx
		mov	[edi+30h], ebx
		call	sub_1000917F
		mov	[edi+2Ch], eax
		lea	ecx, [edi+0DCh]
		or	dword ptr [edi+50h], 0FFFFFFFFh
		or	dword ptr [edi+54h], 0FFFFFFFFh
		push	7
		pop	eax
		mov	dword ptr [edi+34h], 1
		mov	[edi+38h], ebx
		mov	[edi+3Ch], ebx
		mov	[edi+40h], ebx
		mov	[edi+44h], ebx
		mov	[edi+48h], ebx
		mov	dword ptr [edi+4Ch], 1000000h
		mov	[edi+58h], eax
		mov	[edi+5Ch], eax
		mov	[edi+60h], ebx
		mov	[edi+64h], ebx
		mov	[edi+68h], ebx
		mov	[edi+6Ch], ebx
		mov	[edi+0C8h], ebx
		mov	[edi+0CCh], ebx
		mov	[edi+0D0h], ebx
		mov	[edi+0D4h], ebx
		mov	[edi+0D8h], ebx
		call	sub_1000C1AF
		lea	eax, [edi+14h]
		mov	[edi+0E4h], ebx
		mov	[edi+0E8h], ebx
		mov	[edi+0ECh], ebx
		push	eax		; lpCriticalSection
		mov	[edi+0F0h], ebx
		call	ds:InitializeCriticalSection
		push	58h		; size_t
		lea	eax, [edi+70h]
		push	ebx		; int
		push	eax		; void *
		call	memset
		mov	ebp, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		push	14h
		call	ebp ; operator new(uint) ; operator new(uint)
		add	esp, 10h
		test	eax, eax
		jz	short loc_10014466
		push	edi
		mov	ecx, eax
		call	sub_10009BD2
		jmp	short loc_10014468
; ---------------------------------------------------------------------------

loc_10014466:				; CODE XREF: sub_10014386+D4j
		mov	eax, ebx

loc_10014468:				; CODE XREF: sub_10014386+DEj
		push	esi
		push	14h
		mov	[edi+7Ch], eax
		mov	[edi+80h], eax
		mov	[edi+8Ch], eax
		mov	[edi+84h], eax
		mov	[edi+88h], eax
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_100144AF
		lea	ecx, [esi+4]
		mov	[ecx], ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		push	offset dword_1002C2E4
		mov	dword ptr [esi], offset	off_1002C2D8
		mov	[esi+10h], edi
		call	sub_1000A1C3
		jmp	short loc_100144B1
; ---------------------------------------------------------------------------

loc_100144AF:				; CODE XREF: sub_10014386+107j
		mov	esi, ebx

loc_100144B1:				; CODE XREF: sub_10014386+127j
		push	14h
		mov	[edi+90h], esi
		call	ebp ; operator new(uint) ; operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_100144CA
		push	edi
		mov	ecx, eax
		call	sub_100109BB
		jmp	short loc_100144CC
; ---------------------------------------------------------------------------

loc_100144CA:				; CODE XREF: sub_10014386+138j
		mov	eax, ebx

loc_100144CC:				; CODE XREF: sub_10014386+142j
		push	14h
		mov	[edi+94h], eax
		mov	[edi+98h], eax
		mov	[edi+0A4h], eax
		mov	[edi+9Ch], eax
		mov	[edi+0A0h], eax
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_10014525
		lea	esi, [ebx+4]
		xor	eax, eax
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		push	offset dword_1002D8D0
		mov	dword ptr [ebx], offset	off_1002D898
		mov	[ebx+10h], edi
		call	sub_1000A1C3
		push	offset dword_1002D8A4
		mov	ecx, esi
		call	sub_1000A1C3
		jmp	short loc_10014527
; ---------------------------------------------------------------------------

loc_10014525:				; CODE XREF: sub_10014386+16Dj
		xor	ebx, ebx

loc_10014527:				; CODE XREF: sub_10014386+19Dj
		push	14h
		mov	[edi+0A8h], ebx
		mov	[edi+0ACh], ebx
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_1001456E
		lea	esi, [ebx+4]
		xor	eax, eax
		mov	[esi], eax
		mov	ecx, esi
		mov	[esi+4], eax
		mov	[esi+8], eax
		push	offset dword_1002C994
		mov	dword ptr [ebx], offset	off_1002C9EC
		mov	[ebx+10h], edi
		call	sub_1000A1C3
		push	offset dword_1002C9C0
		mov	ecx, esi
		call	sub_1000A1C3
		jmp	short loc_10014570
; ---------------------------------------------------------------------------

loc_1001456E:				; CODE XREF: sub_10014386+1B6j
		xor	ebx, ebx

loc_10014570:				; CODE XREF: sub_10014386+1E6j
		push	14h
		mov	[edi+0B0h], ebx
		mov	[edi+0B4h], ebx
		call	ebp ; operator new(uint) ; operator new(uint)
		mov	esi, eax
		xor	ebx, ebx
		pop	ecx
		test	esi, esi
		jz	short loc_100145A9
		lea	ecx, [esi+4]
		mov	[ecx], ebx
		mov	[ecx+4], ebx
		mov	[ecx+8], ebx
		push	offset dword_1002BFE8
		mov	dword ptr [esi], offset	off_1002C014
		mov	[esi+10h], edi
		call	sub_1000A1C3
		jmp	short loc_100145AB
; ---------------------------------------------------------------------------

loc_100145A9:				; CODE XREF: sub_10014386+201j
		mov	esi, ebx

loc_100145AB:				; CODE XREF: sub_10014386+221j
		push	14h
		mov	[edi+0B8h], esi
		call	ebp ; operator new(uint) ; operator new(uint)
		pop	ecx
		pop	esi
		test	eax, eax
		jz	short loc_100145CF
		mov	[eax+4], ebx
		mov	[eax+8], ebx
		mov	[eax+0Ch], ebx
		mov	dword ptr [eax], offset	off_1002C7D0
		mov	[eax+10h], edi
		jmp	short loc_100145D1
; ---------------------------------------------------------------------------

loc_100145CF:				; CODE XREF: sub_10014386+233j
		mov	eax, ebx

loc_100145D1:				; CODE XREF: sub_10014386+247j
		mov	[edi+0BCh], eax
		mov	[edi+0C0h], eax
		mov	[edi+0C4h], eax
		mov	eax, edi
		pop	edi
		pop	ebp
		pop	ebx
		retn
sub_10014386	endp


; =============== S U B	R O U T	I N E =======================================


sub_100145E9	proc near		; DATA XREF: .rdata:1002CD4Co

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		call	sub_10014606
		test	[esp+4+arg_0], 1
		jz	short loc_10014600
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10014600:				; CODE XREF: sub_100145E9+Dj
		mov	eax, esi
		pop	esi
		retn	4
sub_100145E9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014606	proc near		; CODE XREF: sub_100145E9+3p

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		mov	ebp, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		push	esi
		push	edi
		mov	edi, ecx
		mov	eax, [edi+2Ch]
		mov	dword ptr [edi], offset	off_1002CD44
		mov	dword ptr [edi+10h], offset off_1002CCDC
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10014642

loc_10014629:				; CODE XREF: sub_10014606+3Aj
		mov	ebx, [esi+8]
		test	ebx, ebx
		jz	short loc_1001463B
		mov	ecx, ebx
		call	sub_10017807
		push	ebx
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_1001463B:				; CODE XREF: sub_10014606+28j
		mov	esi, [esi]
		cmp	esi, [edi+2Ch]
		jnz	short loc_10014629

loc_10014642:				; CODE XREF: sub_10014606+21j
		mov	ecx, [edi+7Ch]
		xor	esi, esi
		inc	esi
		test	ecx, ecx
		jz	short loc_10014652
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014652:				; CODE XREF: sub_10014606+44j
		mov	ecx, [edi+90h]
		test	ecx, ecx
		jz	short loc_10014662
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014662:				; CODE XREF: sub_10014606+54j
		mov	ecx, [edi+94h]
		test	ecx, ecx
		jz	short loc_10014672
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014672:				; CODE XREF: sub_10014606+64j
		mov	ecx, [edi+0A8h]
		test	ecx, ecx
		jz	short loc_10014682
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014682:				; CODE XREF: sub_10014606+74j
		mov	ecx, [edi+0B0h]
		test	ecx, ecx
		jz	short loc_10014692
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_10014692:				; CODE XREF: sub_10014606+84j
		mov	ecx, [edi+0B8h]
		test	ecx, ecx
		jz	short loc_100146A2
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax+8]

loc_100146A2:				; CODE XREF: sub_10014606+94j
		mov	ebx, [edi+0C8h]
		test	ebx, ebx
		jz	short loc_100146DE
		mov	eax, [ebx]
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_100146D3

loc_100146B4:				; CODE XREF: sub_10014606+CBj
		mov	eax, [esi+8]
		mov	[esp+14h+var_4], eax
		test	eax, eax
		jz	short loc_100146CD
		mov	ecx, eax
		call	sub_1000FDA2
		push	[esp+14h+var_4]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_100146CD:				; CODE XREF: sub_10014606+B7j
		mov	esi, [esi]
		cmp	esi, [ebx]
		jnz	short loc_100146B4

loc_100146D3:				; CODE XREF: sub_10014606+ACj
		mov	ecx, ebx
		call	sub_10008D00
		push	ebx
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_100146DE:				; CODE XREF: sub_10014606+A4j
		push	dword ptr [edi+0CCh]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		lea	eax, [edi+14h]
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		mov	esi, [edi+0F0h]
		test	esi, esi
		jz	short loc_10014747
		mov	eax, [esi+14h]
		xor	ebx, ebx
		sub	eax, [esi+10h]
		sar	eax, 3
		test	eax, eax
		jz	short loc_10014724

loc_1001470A:				; CODE XREF: sub_10014606+11Cj
		mov	eax, [esi+10h]
		push	dword ptr [eax+ebx*8] ;	hMem
		call	ds:LocalFree
		mov	eax, [esi+14h]
		inc	ebx
		sub	eax, [esi+10h]
		sar	eax, 3
		cmp	ebx, eax
		jb	short loc_1001470A

loc_10014724:				; CODE XREF: sub_10014606+102j
		push	dword ptr [esi]	; hMem
		call	ds:LocalFree
		cmp	dword ptr [esi+10h], 0
		jz	short loc_10014743
		push	dword ptr [esi+10h]
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		xor	eax, eax
		pop	ecx
		mov	[esi+10h], eax
		mov	[esi+14h], eax
		mov	[esi+18h], eax

loc_10014743:				; CODE XREF: sub_10014606+12Aj
		push	esi
		call	ebp ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_10014747:				; CODE XREF: sub_10014606+F3j
		lea	ecx, [edi+0E4h]
		call	sub_1000394E
		lea	ecx, [edi+0DCh]
		call	sub_1000C1EC
		lea	ecx, [edi+0D0h]
		call	sub_1000394E
		lea	ecx, [edi+2Ch]
		call	sub_10008D00
		mov	ecx, edi
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 4
		jmp	sub_10009B6C
sub_10014606	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001477E	proc near		; DATA XREF: .rdata:off_1002CCDCo
		xor	eax, eax
		add	ecx, 24h
		inc	eax
		lock xadd [ecx], eax
		retn
sub_1001477E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014789	proc near		; DATA XREF: .rdata:1002CCE0o
		lea	eax, [ecx+24h]
		or	edx, 0FFFFFFFFh
		lock xadd [eax], edx
		jnz	short locret_100147A1
		add	ecx, 0FFFFFFF0h
		jz	short locret_100147A1
		mov	eax, [ecx]
		push	1
		call	dword ptr [eax+8]

locret_100147A1:			; CODE XREF: sub_10014789+Aj
					; sub_10014789+Fj
		retn
sub_10014789	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147A2	proc near		; DATA XREF: .rdata:1002CCE4o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	eax, [esp+arg_0]
		mov	edx, [esp+arg_4]
		cmp	eax, edx
		jge	short loc_100147B3
		push	2
		pop	eax
		jmp	short locret_100147BB
; ---------------------------------------------------------------------------

loc_100147B3:				; CODE XREF: sub_100147A2+Aj
		mov	[ecx+2Ch], eax
		xor	eax, eax
		mov	[ecx+28h], edx

locret_100147BB:			; CODE XREF: sub_100147A2+Fj
		retn	8
sub_100147A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147BE	proc near		; DATA XREF: .rdata:1002CCE8o
		mov	eax, [ecx+2Ch]
		retn
sub_100147BE	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147C2	proc near		; DATA XREF: .rdata:1002CCECo
		mov	eax, [ecx+28h]
		retn
sub_100147C2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147C6	proc near		; DATA XREF: .rdata:1002CCF0o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	dword ptr [ecx+38h], 0
		mov	eax, [esp+arg_0]
		jz	short loc_100147DA
		cmp	eax, 5
		jnz	short loc_100147DA
		push	2
		pop	eax
		jmp	short locret_100147E6
; ---------------------------------------------------------------------------

loc_100147DA:				; CODE XREF: sub_100147C6+8j
					; sub_100147C6+Dj
		mov	[ecx+30h], eax
		mov	eax, [esp+arg_4]
		mov	[ecx+34h], eax
		xor	eax, eax

locret_100147E6:			; CODE XREF: sub_100147C6+12j
		retn	8
sub_100147C6	endp


; =============== S U B	R O U T	I N E =======================================


sub_100147E9	proc near		; DATA XREF: .rdata:1002CCF4o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		test	eax, eax
		jz	short loc_100147FC
		cmp	dword ptr [ecx+30h], 5
		jnz	short loc_100147FC
		push	2
		pop	eax
		jmp	short locret_10014801
; ---------------------------------------------------------------------------

loc_100147FC:				; CODE XREF: sub_100147E9+6j
					; sub_100147E9+Cj
		mov	[ecx+38h], eax
		xor	eax, eax

locret_10014801:			; CODE XREF: sub_100147E9+11j
		retn	4
sub_100147E9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014804	proc near		; DATA XREF: .rdata:1002CCF8o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	edx, [ecx]
		push	eax
		mov	byte ptr [ecx+3Ch], 1
		mov	[ecx+3Dh], al
		call	dword ptr [edx+24h]
		retn	4
sub_10014804	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014818	proc near		; DATA XREF: .rdata:1002CCFCo

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		mov	al, [ecx+3Ch]
		test	al, al
		jnz	short loc_1001483E
		cmp	[ecx+3Dh], al
		jnz	short loc_1001483C

loc_10014827:				; CODE XREF: sub_10014818+2Fj
					; sub_10014818+39j ...
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax+10h], 0
		xor	ecx, ecx
		mov	dword ptr [eax+14h], 7
		mov	[eax], cx
		jmp	short loc_10014869
; ---------------------------------------------------------------------------

loc_1001483C:				; CODE XREF: sub_10014818+Dj
		test	al, al

loc_1001483E:				; CODE XREF: sub_10014818+8j
		mov	eax, handle
		jz	short loc_10014849
		test	eax, eax
		jz	short loc_10014827

loc_10014849:				; CODE XREF: sub_10014818+2Bj
		cmp	byte ptr [ecx+3Dh], 0
		jz	short loc_1001485C
		test	eax, eax
		jz	short loc_10014827
		cmp	hObj, 0
		jz	short loc_10014827

loc_1001485C:				; CODE XREF: sub_10014818+35j
		push	ecx
		mov	ecx, [ebp+arg_0]
		call	sub_10018B96
		mov	eax, [ebp+arg_0]
		pop	ecx

loc_10014869:				; CODE XREF: sub_10014818+22j
		pop	ebp
		retn	4
sub_10014818	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_1001486D	proc near		; DATA XREF: .rdata:1002CD00o

var_21		= byte ptr -21h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= byte ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		push	ebx
		xor	ebx, ebx
		mov	[esp+28h+var_20], ebx
		cmp	[ebp+arg_0], bl
		jz	loc_1001496A
		cmp	hObj, ebx
		jnz	short loc_100148A9
		cmp	handle,	ebx
		jz	short loc_100148B5

loc_100148A1:				; CODE XREF: sub_1001486D+103j
		push	3

loc_100148A3:				; CODE XREF: sub_1001486D+99j
		pop	eax
		jmp	loc_10014958
; ---------------------------------------------------------------------------

loc_100148A9:				; CODE XREF: sub_1001486D+2Aj
		cmp	handle,	ebx
		jnz	loc_10014956

loc_100148B5:				; CODE XREF: sub_1001486D+32j
		call	sub_10018960
		test	eax, eax
		jnz	loc_10014958
		mov	edx, hObj	; hObj
		test	edx, edx
		jz	short loc_100148E3
		push	2
		pop	ebx
		lea	ecx, [esp+28h+var_1C] ;	void *
		call	sub_10018B02
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_100148E8

loc_100148E3:				; CODE XREF: sub_1001486D+5Dj
		mov	[esp+28h+var_21], 1

loc_100148E8:				; CODE XREF: sub_1001486D+74j
		test	bl, 2
		jz	short loc_100148FD
		push	0
		push	1
		lea	ecx, [esp+30h+var_1C]
		and	ebx, 0FFFFFFFDh
		call	sub_10002311

loc_100148FD:				; CODE XREF: sub_1001486D+7Ej
		cmp	[esp+28h+var_21], 0
		jz	short loc_10014908

loc_10014904:				; CODE XREF: sub_1001486D+E7j
		push	0Bh
		jmp	short loc_100148A3
; ---------------------------------------------------------------------------

loc_10014908:				; CODE XREF: sub_1001486D+95j
		mov	ecx, hObj	; hWinSta
		call	sub_100189BE
		test	eax, eax
		jnz	short loc_10014958
		mov	edx, handle	; hObj
		test	edx, edx
		jz	short loc_10014938
		lea	ecx, [esp+28h+var_1C] ;	void *
		or	ebx, 4
		call	sub_10018B02
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_1001493D

loc_10014938:				; CODE XREF: sub_1001486D+B2j
		mov	[esp+28h+var_21], 1

loc_1001493D:				; CODE XREF: sub_1001486D+C9j
		test	bl, 4

loc_10014940:				; CODE XREF: sub_1001486D+145j
		jz	short loc_1001494F
		push	0
		push	1
		lea	ecx, [esp+30h+var_1C]
		call	sub_10002311

loc_1001494F:				; CODE XREF: sub_1001486D:loc_10014940j
		cmp	[esp+28h+var_21], 0
		jnz	short loc_10014904

loc_10014956:				; CODE XREF: sub_1001486D+42j
					; sub_1001486D+10Fj
		xor	eax, eax

loc_10014958:				; CODE XREF: sub_1001486D+37j
					; sub_1001486D+4Fj ...
		mov	ecx, [esp+28h+var_4]
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
; ---------------------------------------------------------------------------

loc_1001496A:				; CODE XREF: sub_1001486D+1Ej
		cmp	hObj, ebx
		jnz	loc_100148A1
		cmp	handle,	ebx
		jnz	short loc_10014956
		xor	ecx, ecx	; hWinSta
		call	sub_100189BE
		test	eax, eax
		jnz	short loc_10014958
		mov	edx, handle	; hObj
		test	edx, edx
		jz	short loc_100149AA
		push	8
		pop	ebx
		lea	ecx, [esp+28h+var_1C] ;	void *
		call	sub_10018B02
		mov	[esp+28h+var_21], 0
		cmp	dword ptr [eax+10h], 0
		jnz	short loc_100149AF

loc_100149AA:				; CODE XREF: sub_1001486D+124j
		mov	[esp+28h+var_21], 1

loc_100149AF:				; CODE XREF: sub_1001486D+13Bj
		test	bl, 8
		jmp	short loc_10014940
sub_1001486D	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149B4	proc near		; DATA XREF: .rdata:1002CD04o
		mov	eax, handle
		test	eax, eax
		jz	short loc_100149CB
		push	eax		; hDesktop
		call	ds:CloseDesktop
		and	handle,	0

loc_100149CB:				; CODE XREF: sub_100149B4+7j
		mov	eax, hObj
		test	eax, eax
		jz	short locret_100149E2
		push	eax		; hWinSta
		call	ds:CloseWindowStation
		and	hObj, 0

locret_100149E2:			; CODE XREF: sub_100149B4+1Ej
		retn
sub_100149B4	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149E3	proc near		; DATA XREF: .rdata:1002CD08o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+48h], eax
		xor	eax, eax
		retn	4
sub_100149E3	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149EF	proc near		; DATA XREF: .rdata:1002CD0Co
		mov	eax, [ecx+48h]
		retn
sub_100149EF	endp


; =============== S U B	R O U T	I N E =======================================


sub_100149F3	proc near		; DATA XREF: .rdata:1002CD10o

arg_0		= dword	ptr  4

		mov	eax, [esp+arg_0]
		mov	[ecx+4Ch], eax
		xor	eax, eax
		retn	4
sub_100149F3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100149FF	proc near		; DATA XREF: .rdata:1002CD14o

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
StringSid	= word ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+24h+var_4], eax
		and	[esp+24h+var_20], 0
		push	ebx
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		mov	esi, ecx
		mov	[esp+30h+var_24], edi
		call	sub_100063D2
		cmp	dword ptr [eax], 5
		jge	short loc_10014A35
		xor	eax, eax
		jmp	loc_10014ABE
; ---------------------------------------------------------------------------

loc_10014A35:				; CODE XREF: sub_100149FF+2Dj
		mov	eax, [esi+28h]
		cmp	eax, 2
		jl	short loc_10014ABB
		cmp	eax, [esi+2Ch]
		jnz	short loc_10014ABB
		push	1Ch
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	ebx, eax
		pop	ecx
		test	ebx, ebx
		jz	short loc_10014A68
		xor	eax, eax
		mov	edi, ebx
		mov	[ebx+10h], eax
		mov	[ebx+14h], eax
		mov	[ebx+18h], eax
		stosd
		stosd
		stosd
		stosd
		mov	edi, [esp+30h+var_24]
		jmp	short loc_10014A6A
; ---------------------------------------------------------------------------

loc_10014A68:				; CODE XREF: sub_100149FF+50j
		xor	ebx, ebx

loc_10014A6A:				; CODE XREF: sub_100149FF+67j
		mov	ecx, [esi+0E0h]
		and	dword ptr [esi+0E0h], 0
		test	ecx, ecx
		jz	short loc_10014A81
		push	ecx
		call	sub_100153DA

loc_10014A81:				; CODE XREF: sub_100149FF+7Aj
		push	edi		; void *
		lea	ecx, [esp+34h+StringSid] ; void	*
		mov	[esi+0E0h], ebx
		call	sub_10001C7F
		mov	ecx, [esi+0E0h]
		lea	eax, [esi+0D4h]
		push	eax		; int
		lea	eax, [esp+34h+StringSid]
		push	eax		; StringSid
		call	sub_10007A6C
		push	0
		push	1
		lea	ecx, [esp+38h+StringSid]
		mov	esi, eax
		call	sub_10002311
		mov	eax, esi
		jmp	short loc_10014ABE
; ---------------------------------------------------------------------------

loc_10014ABB:				; CODE XREF: sub_100149FF+3Cj
					; sub_100149FF+41j
		push	10h
		pop	eax

loc_10014ABE:				; CODE XREF: sub_100149FF+31j
					; sub_100149FF+BAj
		mov	ecx, [esp+30h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100149FF	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014AD2(void *)
sub_10014AD2	proc near		; DATA XREF: .rdata:1002CD18o

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_1C] ; void *
		push	eax		; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	ecx, [esi+0D4h]
		call	sub_100035E0
		push	0
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014AD2	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B1F	proc near		; DATA XREF: .rdata:1002CD1Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	edx, esi
		push	edi
		mov	edi, [esp+8+arg_4]
		and	edx, 100h
		mov	eax, edi
		and	eax, 1
		or	edx, eax
		jz	short loc_10014B3F
		push	2
		pop	eax
		jmp	short loc_10014B47
; ---------------------------------------------------------------------------

loc_10014B3F:				; CODE XREF: sub_10014B1F+19j
		mov	[ecx+50h], esi
		xor	eax, eax
		mov	[ecx+54h], edi

loc_10014B47:				; CODE XREF: sub_10014B1F+1Ej
		pop	edi
		pop	esi
		retn	8
sub_10014B1F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B4C	proc near		; DATA XREF: .rdata:1002CD20o
		mov	eax, [ecx+50h]
		mov	edx, [ecx+54h]
		retn
sub_10014B4C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B53	proc near		; DATA XREF: .rdata:1002CD24o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		mov	edx, [esp+arg_4]
		push	esi
		mov	esi, [esp+4+arg_0]
		push	edi
		push	edx
		push	esi
		mov	edi, ecx
		call	sub_1001067D
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10014B71
		push	2
		pop	eax
		jmp	short loc_10014B79
; ---------------------------------------------------------------------------

loc_10014B71:				; CODE XREF: sub_10014B53+17j
		mov	[edi+58h], esi
		xor	eax, eax
		mov	[edi+5Ch], edx

loc_10014B79:				; CODE XREF: sub_10014B53+1Cj
		pop	edi
		pop	esi
		retn	8
sub_10014B53	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B7E	proc near		; DATA XREF: .rdata:1002CD28o
		mov	eax, [ecx+58h]
		mov	edx, [ecx+5Ch]
		retn
sub_10014B7E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014B85	proc near		; DATA XREF: .rdata:1002CD2Co
		mov	byte ptr [ecx+3Fh], 0
		retn
sub_10014B85	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014B8A(HANDLE hFile)
sub_10014B8A	proc near		; DATA XREF: .rdata:1002CD30o

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		mov	edi, ecx
		mov	ecx, esi	; hFile
		call	sub_10014362
		test	al, al
		jnz	short loc_10014BA2
		push	2
		pop	eax
		jmp	short loc_10014BA7
; ---------------------------------------------------------------------------

loc_10014BA2:				; CODE XREF: sub_10014B8A+11j
		mov	[edi+40h], esi
		xor	eax, eax

loc_10014BA7:				; CODE XREF: sub_10014B8A+16j
		pop	edi
		pop	esi
		retn	4
sub_10014B8A	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014BAC(HANDLE hFile)
sub_10014BAC	proc near		; DATA XREF: .rdata:1002CD34o

hFile		= dword	ptr  4

		push	esi
		mov	esi, [esp+4+hFile]
		push	edi
		mov	edi, ecx
		mov	ecx, esi	; hFile
		call	sub_10014362
		test	al, al
		jnz	short loc_10014BC4
		push	2
		pop	eax
		jmp	short loc_10014BC9
; ---------------------------------------------------------------------------

loc_10014BC4:				; CODE XREF: sub_10014BAC+11j
		mov	[edi+44h], esi
		xor	eax, eax

loc_10014BC9:				; CODE XREF: sub_10014BAC+16j
		pop	edi
		pop	esi
		retn	4
sub_10014BAC	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014BCE(int, int, void *)
sub_10014BCE	proc near		; DATA XREF: .rdata:1002CD38o

var_B4		= dword	ptr -0B4h
var_B0		= byte ptr -0B0h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 0B8h
		push	ebx
		push	esi
		push	[ebp+arg_8]	; void *
		xor	ebx, ebx
		add	ecx, 0FFFFFFF0h
		push	[ebp+arg_4]	; int
		mov	[esp+0C8h+var_B4], ebx
		push	[ebp+arg_0]	; int
		call	sub_10015277
		cmp	dword_10031374,	2
		mov	esi, eax
		jg	loc_10014C92
		test	esi, esi
		jz	loc_10014C92
		push	2
		push	17Ch
		push	offset aCBuildsMoz2__2 ; "c:/builds/moz2_slave/rel-m-rel-w32_bld-"...
		lea	ecx, [esp+0CCh+var_B0]
		inc	ebx
		call	sub_10001B48
		push	[ebp+arg_4]
		mov	edx, offset aFailedToAddSan ; "Failed to add sandbox rule."
		push	[ebp+arg_0]
		lea	ecx, [eax+8]
		push	esi
		call	sub_10002847
		mov	edx, offset aError ; " error = "
		mov	ecx, eax
		call	sub_10002847
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aSubsystem ; ", subsystem =	"
		mov	ecx, eax
		call	sub_10002847
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aSemantics ; ", semantics =	"
		mov	ecx, eax
		call	sub_10002847
		mov	ecx, eax
		call	ds:??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z	; std::basic_ostream<char,std::char_traits<char>>::operator<<(int)
		mov	edx, offset aPattern ; ", pattern = '"
		mov	ecx, eax
		call	sub_10002847
		mov	edx, [ebp+arg_8]
		mov	ecx, eax
		call	sub_10001C05
		mov	edx, offset asc_1002CB94 ; "'"
		mov	ecx, eax
		call	sub_10002847

loc_10014C92:				; CODE XREF: sub_10014BCE+2Ej
					; sub_10014BCE+36j
		test	bl, 1
		jz	short loc_10014CA0
		lea	ecx, [esp+0C0h+var_B0]
		call	sub_10001BED

loc_10014CA0:				; CODE XREF: sub_10014BCE+C7j
		mov	eax, esi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10014BCE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10014CAA(void *)
sub_10014CAA	proc near		; DATA XREF: .rdata:1002CD3Co

var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		mov	eax, [ebp+arg_0]
		push	esi
		mov	esi, ecx
		lea	ecx, [ebp+var_1C] ; void *
		push	eax		; void *
		call	sub_10001C7F
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		lea	ecx, [esi+0C0h]
		call	sub_100035E0
		push	0
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311
		mov	ecx, [ebp+var_4]
		xor	eax, eax
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014CAA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014CF7	proc near		; DATA XREF: .rdata:1002CD40o
		add	ecx, 0CCh
		jmp	sub_1000BC43
sub_10014CF7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014D02	proc near		; DATA XREF: .rdata:off_1002CD44o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ebx
		push	esi
		mov	esi, [ebp+arg_0]
		mov	ebx, offset dword_1002CC24
		push	edi
		mov	edi, ecx
		xor	ecx, ecx
		mov	[esp+10h+var_4], ecx
		mov	edx, ecx

loc_10014D1E:				; CODE XREF: sub_10014D02+28j
		mov	eax, [ebx+edx*4]
		cmp	eax, [esi+edx*4]
		jnz	short loc_10014D2E
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_10014D1E
		jmp	short loc_10014D43
; ---------------------------------------------------------------------------

loc_10014D2E:				; CODE XREF: sub_10014D02+22j
		mov	ebx, offset dword_1002CC4C
		mov	edx, ecx

loc_10014D35:				; CODE XREF: sub_10014D02+3Fj
		mov	eax, [ebx+edx*4]
		cmp	eax, [esi+edx*4]
		jnz	short loc_10014D50
		inc	edx
		cmp	edx, 0Ah
		jnz	short loc_10014D35

loc_10014D43:				; CODE XREF: sub_10014D02+2Aj
		mov	eax, [ebp+arg_4]
		mov	dword ptr [eax], offset	sub_100150E4
		mov	eax, edi
		jmp	short loc_10014D6E
; ---------------------------------------------------------------------------

loc_10014D50:				; CODE XREF: sub_10014D02+39j
		mov	edx, [esi]
		lea	eax, [edx-1]
		cmp	eax, 14h
		ja	short loc_10014D5E
		mov	ecx, [edi+edx*4+70h]

loc_10014D5E:				; CODE XREF: sub_10014D02+56j
		test	ecx, ecx
		jnz	short loc_10014D66
		xor	eax, eax
		jmp	short loc_10014D6E
; ---------------------------------------------------------------------------

loc_10014D66:				; CODE XREF: sub_10014D02+5Ej
		push	[ebp+arg_4]
		mov	eax, [ecx]
		push	esi
		call	dword ptr [eax]

loc_10014D6E:				; CODE XREF: sub_10014D02+4Cj
					; sub_10014D02+62j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10014D02	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014D77	proc near		; DATA XREF: .rdata:1002CD48o

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		mov	edx, [ebp+arg_4]
		push	esi
		mov	esi, ecx
		xor	ecx, ecx
		mov	[esp+8+var_4], ecx
		cmp	edx, 1
		jz	short loc_10014DB3
		cmp	edx, 2
		jz	short loc_10014DB3
		lea	eax, [edx-1]
		cmp	eax, 14h
		ja	short loc_10014DA0
		mov	ecx, [esi+edx*4+70h]

loc_10014DA0:				; CODE XREF: sub_10014D77+23j
		test	ecx, ecx
		jnz	short loc_10014DA8
		xor	al, al
		jmp	short loc_10014DB5
; ---------------------------------------------------------------------------

loc_10014DA8:				; CODE XREF: sub_10014D77+2Bj
		mov	eax, [ecx]
		push	edx
		push	[ebp+arg_0]
		call	dword ptr [eax+4]
		jmp	short loc_10014DB5
; ---------------------------------------------------------------------------

loc_10014DB3:				; CODE XREF: sub_10014D77+16j
					; sub_10014D77+1Bj
		mov	al, 1

loc_10014DB5:				; CODE XREF: sub_10014D77+2Fj
					; sub_10014D77+3Aj
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10014D77	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10014DBC	proc near		; CODE XREF: sub_100083E3+20Ap

hObject		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		cmp	dword ptr [ecx+40h], 5
		jz	short loc_10014DFE
		push	dword ptr [ecx+48h]
		and	[ebp+hObject], 0
		push	dword ptr [ecx+44h]
		push	ecx
		push	dword ptr [ecx+40h]
		lea	ecx, [ebp+hObject]
		call	sub_1000E80A
		test	eax, eax
		jz	short loc_10014DF4
		cmp	[ebp+hObject], 0
		jz	short loc_10014DEF
		push	[ebp+hObject]	; hObject
		call	ds:CloseHandle

loc_10014DEF:				; CODE XREF: sub_10014DBC+28j
		xor	eax, eax
		inc	eax
		jmp	short loc_10014E06
; ---------------------------------------------------------------------------

loc_10014DF4:				; CODE XREF: sub_10014DBC+22j
		mov	ecx, [ebp+arg_0]
		mov	eax, [ebp+hObject]
		mov	[ecx], eax
		jmp	short loc_10014E04
; ---------------------------------------------------------------------------

loc_10014DFE:				; CODE XREF: sub_10014DBC+8j
		mov	eax, [ebp+arg_0]
		and	dword ptr [eax], 0

loc_10014E04:				; CODE XREF: sub_10014DBC+40j
		xor	eax, eax

loc_10014E06:				; CODE XREF: sub_10014DBC+36j
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10014DBC	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10014E0C(LPHANDLE, LPHANDLE	lpTargetHandle)
sub_10014E0C	proc near		; CODE XREF: sub_100083E3+123p
					; sub_100083E3+1D0p

arg_0		= dword	ptr  4
lpTargetHandle	= dword	ptr  8

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, [esp+0Ch+lpTargetHandle]
		mov	ecx, edi	; lpTargetHandle
		push	1		; int
		push	dword ptr [esi+58h] ; int
		mov	edx, [esi+38h]
		call	sub_10013578
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10014E2F

loc_10014E2A:				; CODE XREF: sub_10014E0C+5Fj
					; sub_10014E0C+B8j
		xor	eax, eax
		inc	eax
		jmp	short loc_10014E9A
; ---------------------------------------------------------------------------

loc_10014E2F:				; CODE XREF: sub_10014E0C+1Cj
		cmp	handle,	0
		jz	short loc_10014E75
		cmp	byte ptr [esi+4Ch], 0
		jz	short loc_10014E75
		mov	eax, [esi+58h]
		cmp	eax, 7
		jz	short loc_10014E75
		cmp	dword_10031E04,	eax
		jge	short loc_10014E75
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jl	short loc_10014E75
		mov	ecx, [esi+58h]
		call	sub_10013BBE
		push	eax		; void *
		push	ecx		; int
		call	sub_10013A85
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10014E2A
		mov	eax, [esi+58h]
		mov	dword_10031E04,	eax

loc_10014E75:				; CODE XREF: sub_10014E0C+2Aj
					; sub_10014E0C+30j ...
		mov	eax, [esi+0F0h]
		test	eax, eax
		jz	short loc_10014EA5
		cmp	dword ptr [eax], 0
		jz	short loc_10014EA5
		mov	eax, [esi+38h]
		cmp	eax, 2
		jl	short loc_10014EA0
		cmp	eax, [esi+3Ch]
		jnz	short loc_10014EA0
		mov	eax, [esp+0Ch+arg_0]
		or	dword ptr [eax], 0FFFFFFFFh

loc_10014E98:				; CODE XREF: sub_10014E0C+AEj
		xor	eax, eax

loc_10014E9A:				; CODE XREF: sub_10014E0C+21j
					; sub_10014E0C+97j
		pop	edi
		pop	esi
		pop	ecx
		retn	8
; ---------------------------------------------------------------------------

loc_10014EA0:				; CODE XREF: sub_10014E0C+7Ej
					; sub_10014E0C+83j
		push	10h
		pop	eax
		jmp	short loc_10014E9A
; ---------------------------------------------------------------------------

loc_10014EA5:				; CODE XREF: sub_10014E0C+71j
					; sub_10014E0C+76j
		mov	edx, [esi+3Ch]
		mov	ecx, [esp+0Ch+arg_0] ; lpTargetHandle
		push	0		; int
		push	dword ptr [esi+58h] ; int
		call	sub_10013578
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	short loc_10014E98
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		jmp	loc_10014E2A
sub_10014E0C	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014EC9	proc near		; CODE XREF: sub_100083E3+493p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		cmp	dword ptr [edi+0CCh], 0
		jz	short loc_10014EE3
		mov	ecx, [edi+0C8h]
		call	sub_1000F760

loc_10014EE3:				; CODE XREF: sub_10014EC9+Dj
		mov	ebp, [esp+10h+arg_0]
		push	dword ptr [edi+64h]
		push	dword ptr [edi+60h] ; int
		mov	ecx, [ebp+0]	; hProcess
		call	sub_100105D3
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10014F02

loc_10014EFB:				; CODE XREF: sub_10014EC9+43j
					; sub_10014EC9+53j ...
		xor	al, al
		jmp	loc_10014FF6
; ---------------------------------------------------------------------------

loc_10014F02:				; CODE XREF: sub_10014EC9+30j
		push	ebp
		mov	ecx, edi
		call	sub_10015127
		test	al, al
		jz	short loc_10014EFB
		push	ebp
		lea	ecx, [edi+0DCh]
		call	sub_1000BEB1
		test	al, al
		jz	short loc_10014EFB
		push	ecx		; int
		push	ecx		; int
		push	dword ptr [edi+0CCh] ; void *
		mov	ecx, ebp
		push	edi		; int
		call	sub_10017B53
		test	eax, eax
		jnz	short loc_10014EFB
		mov	eax, [edi+5Ch]
		mov	ecx, ebp
		push	4		; nSize
		push	offset g_shared_delayed_integrity_level	; lpBuffer
		push	offset aG_shared_del_1 ; "g_shared_delayed_integrity_level"
		mov	g_shared_delayed_integrity_level, eax
		call	sub_10017AD9
		mov	g_shared_delayed_integrity_level, 7
		test	eax, eax
		jnz	short loc_10014EFB
		mov	esi, [edi+60h]
		mov	ebx, [edi+64h]
		call	sub_100063D2
		cmp	dword ptr [eax], 3
		jge	short loc_10014F72
		and	esi, 3
		xor	ebx, ebx
		jmp	short loc_10014F87
; ---------------------------------------------------------------------------

loc_10014F72:				; CODE XREF: sub_10014EC9+A0j
		cmp	dword ptr [eax], 4
		jge	short loc_10014F7C

loc_10014F77:				; CODE XREF: sub_10014EC9+B6j
		and	esi, 60h
		jmp	short loc_10014F84
; ---------------------------------------------------------------------------

loc_10014F7C:				; CODE XREF: sub_10014EC9+ACj
		cmp	dword ptr [eax], 5
		jl	short loc_10014F77
		and	esi, 40h

loc_10014F84:				; CODE XREF: sub_10014EC9+B1j
		and	ebx, 1

loc_10014F87:				; CODE XREF: sub_10014EC9+A7j
		mov	eax, [edi+6Ch]
		mov	ecx, [edi+68h]
		or	eax, ebx
		or	ecx, esi
		mov	dword_10031E14,	eax
		push	eax
		push	ecx
		mov	g_shared_delayed_mitigations, ecx
		call	sub_1001067D
		pop	ecx
		pop	ecx
		test	al, al
		jz	loc_10014EFB
		push	8		; nSize
		push	offset g_shared_delayed_mitigations ; lpBuffer
		push	offset aG_shared_del_2 ; "g_shared_delayed_mitigations"
		mov	ecx, ebp
		call	sub_10017AD9
		and	g_shared_delayed_mitigations, 0
		and	dword_10031E14,	0
		test	eax, eax
		jnz	loc_10014EFB
		lea	esi, [edi+14h]
		push	esi		; lpCriticalSection
		call	ds:EnterCriticalSection
		lea	ecx, [esp+10h+arg_0]
		push	ecx
		lea	ecx, [edi+2Ch]
		call	sub_10008D33
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_10014FF6:				; CODE XREF: sub_10014EC9+34j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	4
sub_10014EC9	endp


; =============== S U B	R O U T	I N E =======================================


sub_10014FFD	proc near		; CODE XREF: sub_100081CF+26p

arg_0		= dword	ptr  4

		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		lea	ebp, [edi+14h]
		push	ebp		; lpCriticalSection
		call	ds:EnterCriticalSection
		mov	edx, [edi+2Ch]
		mov	eax, [edx]
		cmp	eax, edx
		jz	short loc_1001502C
		mov	esi, [esp+10h+arg_0]

loc_1001501A:				; CODE XREF: sub_10014FFD+29j
		mov	ecx, [eax+8]
		cmp	[ecx+1Ch], esi
		jz	short loc_10015028
		mov	eax, [eax]
		cmp	eax, edx
		jnz	short loc_1001501A

loc_10015028:				; CODE XREF: sub_10014FFD+23j
		cmp	eax, edx
		jnz	short loc_10015030

loc_1001502C:				; CODE XREF: sub_10014FFD+17j
		xor	bl, bl
		jmp	short loc_10015060
; ---------------------------------------------------------------------------

loc_10015030:				; CODE XREF: sub_10014FFD+2Dj
		mov	edx, [eax+4]
		mov	ecx, [eax]
		mov	esi, [eax+8]
		push	eax
		mov	[edx], ecx
		mov	edx, [eax]
		mov	ecx, [eax+4]
		mov	[edx+4], ecx
		dec	dword ptr [edi+30h]
		mov	edi, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		test	esi, esi
		jz	short loc_1001505E
		mov	ecx, esi
		call	sub_10017807
		push	esi
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx

loc_1001505E:				; CODE XREF: sub_10014FFD+54j
		mov	bl, 1

loc_10015060:				; CODE XREF: sub_10014FFD+31j
		push	ebp		; lpCriticalSection
		call	ds:LeaveCriticalSection
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		retn	4
sub_10014FFD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015070	proc near		; CODE XREF: sub_10009CE2+98p
					; sub_10009DE6+98p ...

var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 14h
		and	[esp+14h+var_10], 0
		mov	ecx, [ecx+0CCh]
		push	esi
		test	ecx, ecx
		jz	short loc_100150DA
		mov	eax, [ebp+arg_0]
		mov	esi, [ecx+eax*4]
		test	esi, esi
		jz	short loc_100150DA
		mov	edx, [ebp+arg_4]
		xor	eax, eax
		cmp	[edx], eax
		jle	short loc_100150AC
		lea	ecx, [edx+4]

loc_1001509F:				; CODE XREF: sub_10015070+3Aj
		cmp	dword ptr [ecx], 0
		jz	short loc_100150D6
		inc	eax
		add	ecx, 8
		cmp	eax, [edx]
		jl	short loc_1001509F

loc_100150AC:				; CODE XREF: sub_10015070+2Aj
		push	dword ptr [edx]
		and	[esp+1Ch+var_C], 0
		lea	eax, [edx+4]
		mov	[esp+1Ch+var_4], esi
		xor	esi, esi
		push	eax
		push	ecx
		inc	esi
		lea	ecx, [esp+24h+var_C]
		mov	[esp+24h+var_8], esi
		call	sub_1000F602
		cmp	eax, esi
		jnz	short loc_100150DA
		mov	eax, [esp+18h+var_8]
		jmp	short loc_100150DD
; ---------------------------------------------------------------------------

loc_100150D6:				; CODE XREF: sub_10015070+32j
		push	9
		jmp	short loc_100150DC
; ---------------------------------------------------------------------------

loc_100150DA:				; CODE XREF: sub_10015070+17j
					; sub_10015070+21j ...
		push	4

loc_100150DC:				; CODE XREF: sub_10015070+68j
		pop	eax

loc_100150DD:				; CODE XREF: sub_10015070+64j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10015070	endp


; =============== S U B	R O U T	I N E =======================================


sub_100150E4	proc near		; DATA XREF: sub_10014D02+44o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		mov	esi, [esp+4+arg_0]
		mov	eax, [esi]
		dec	eax
		jz	short loc_10015108
		dec	eax
		jnz	short loc_100150FA
		mov	ecx, [esp+4+arg_4]
		cmp	dword ptr [ecx], 4
		jz	short loc_100150FE

loc_100150FA:				; CODE XREF: sub_100150E4+Bj
		xor	al, al
		jmp	short loc_10015123
; ---------------------------------------------------------------------------

loc_100150FE:				; CODE XREF: sub_100150E4+14j
		mov	ecx, [ecx+4]
		imul	eax, [ecx], 3
		mov	[ecx], eax
		jmp	short loc_10015121
; ---------------------------------------------------------------------------

loc_10015108:				; CODE XREF: sub_100150E4+8j
		mov	dword ptr [esi+14h], 2
		call	ds:GetTickCount
		mov	[esi+1Ch], eax
		mov	eax, [esp+4+arg_4]
		add	eax, eax
		mov	[esi+20h], eax

loc_10015121:				; CODE XREF: sub_100150E4+22j
		mov	al, 1

loc_10015123:				; CODE XREF: sub_100150E4+18j
		pop	esi
		retn	8
sub_100150E4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015127	proc near		; CODE XREF: sub_10014EC9+3Cp

var_74		= dword	ptr -74h
var_70		= dword	ptr -70h
var_6C		= dword	ptr -6Ch
var_68		= dword	ptr -68h
var_64		= dword	ptr -64h
var_60		= byte ptr -60h
var_58		= byte ptr -58h
var_40		= byte ptr -40h
var_10		= dword	ptr -10h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 78h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+78h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+80h+arg_0]
		xor	eax, eax
		push	esi
		push	edi
		mov	edi, ecx
		mov	[esp+88h+var_64], ebp
		push	eax
		push	eax
		mov	[esp+90h+var_74], ebp
		mov	bl, [edi+4Fh]
		mov	[esp+90h+var_70], eax
		mov	[esp+90h+var_6C], eax
		call	sub_1000E40A
		xor	edx, edx
		mov	[esp+88h+var_70], eax
		mov	byte ptr [esp+88h+var_68], dl
		mov	byte ptr [esp+88h+var_68+1], bl
		cmp	[edi+0CCh], edx
		jz	short loc_100151B0
		push	0FFFFFF90h
		pop	ebp
		mov	esi, edx
		lea	ebx, [edi+70h]
		sub	ebp, edi

loc_1001517E:				; CODE XREF: sub_10015127+83j
		mov	eax, [edi+0CCh]
		lea	ecx, [ebx+ebp]
		cmp	[ecx+eax], edx
		jz	short loc_100151A3
		mov	ecx, [ebx]
		lea	edx, [esp+88h+var_74]
		push	esi
		push	edx
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	loc_10015252
		xor	edx, edx

loc_100151A3:				; CODE XREF: sub_10015127+63j
		inc	esi
		add	ebx, 4
		cmp	esi, 16h
		jl	short loc_1001517E
		mov	ebp, [esp+88h+var_64]

loc_100151B0:				; CODE XREF: sub_10015127+4Bj
		mov	eax, [edi+0D0h]
		cmp	eax, [edi+0D4h]
		jz	short loc_1001522D
		mov	esi, eax
		jmp	short loc_10015225
; ---------------------------------------------------------------------------

loc_100151C2:				; CODE XREF: sub_10015127+104j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100151CC
		mov	ebx, [esi]
		jmp	short loc_100151CE
; ---------------------------------------------------------------------------

loc_100151CC:				; CODE XREF: sub_10015127+9Fj
		mov	ebx, esi

loc_100151CE:				; CODE XREF: sub_10015127+A3j
		lea	ecx, [esp+88h+var_60]
		call	sub_1000D87F
		mov	ecx, ebx
		mov	dword ptr [esp+88h+var_60], 5
		call	sub_10001AF3
		push	eax		; int
		push	ebx		; void *
		lea	ecx, [esp+90h+var_58] ;	void *
		call	sub_10002356
		xor	ebx, ebx
		lea	ecx, [esp+88h+var_40] ;	void *
		inc	ebx
		push	ebx		; size_t
		push	offset a@	; "@"
		call	sub_100018DB
		lea	eax, [esp+88h+var_60]
		mov	[esp+88h+var_10], ebx
		push	eax
		push	[esp+8Ch+var_70]
		lea	ecx, [esp+90h+var_70]
		call	sub_1000E43D
		lea	ecx, [esp+88h+var_60]
		call	sub_1000D8A9
		add	esi, 18h

loc_10015225:				; CODE XREF: sub_10015127+99j
		cmp	esi, [edi+0D4h]
		jnz	short loc_100151C2

loc_1001522D:				; CODE XREF: sub_10015127+95j
		lea	ecx, [esp+88h+var_74]
		call	sub_1000F0DF
		test	al, al
		jz	short loc_10015252
		lea	ecx, [esp+88h+var_74]
		call	sub_1000D979
		test	al, al
		jz	short loc_10015252
		mov	ecx, ebp
		call	sub_1000EE56
		mov	bl, al
		jmp	short loc_10015254
; ---------------------------------------------------------------------------

loc_10015252:				; CODE XREF: sub_10015127+74j
					; sub_10015127+111j ...
		xor	ebx, ebx

loc_10015254:				; CODE XREF: sub_10015127+129j
		lea	ecx, [esp+88h+var_70]
		call	sub_1000E3CD
		mov	ecx, [esp+88h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 78h
		retn	4
sub_10015127	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10015277(int, int, void *)
sub_10015277	proc near		; CODE XREF: sub_10014BCE+20p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ecx
		push	ebx
		push	ebp
		mov	ebx, ecx
		xor	ebp, ebp
		push	esi
		push	edi
		mov	[esp+18h+var_4], ebp
		cmp	[ebx+0CCh], ebp
		jnz	short loc_100152E7
		mov	edi, ds:__imp_??2@YAPAXI@Z ; operator new(uint)
		mov	ebp, 0E000h
		push	ebp
		call	edi ; operator new(uint) ; operator new(uint)
		pop	ecx
		push	ebp		; size_t
		xor	ebp, ebp
		mov	esi, eax
		push	ebp		; int
		push	esi		; void *
		call	memset
		add	esp, 0Ch
		mov	dword ptr [esi+80h], 0DF60h
		mov	[ebx+0CCh], esi
		push	0Ch
		call	edi ; operator new(uint) ; operator new(uint)
		mov	edi, eax
		pop	ecx
		test	edi, edi
		jz	short loc_100152DF
		mov	esi, [ebx+0CCh]
		push	ebp
		push	ebp
		mov	[edi], ebp
		mov	[edi+4], ebp
		call	sub_1000914C
		mov	[edi], eax
		mov	[edi+8], esi
		jmp	short loc_100152E1
; ---------------------------------------------------------------------------

loc_100152DF:				; CODE XREF: sub_10015277+4Dj
		mov	edi, ebp

loc_100152E1:				; CODE XREF: sub_10015277+66j
		mov	[ebx+0C8h], edi

loc_100152E7:				; CODE XREF: sub_10015277+14j
		mov	eax, [esp+18h+arg_0]
		sub	eax, ebp
		jz	loc_10015399
		dec	eax
		jz	loc_10015384
		dec	eax
		jz	short loc_10015362
		dec	eax
		jz	short loc_1001534D
		dec	eax
		jz	short loc_10015338
		dec	eax
		jz	short loc_10015320
		dec	eax
		jz	short loc_10015310
		push	3
		jmp	loc_100153B0
; ---------------------------------------------------------------------------

loc_10015310:				; CODE XREF: sub_10015277+90j
		push	dword ptr [ebx+0C8h]
		call	sub_1001075E
		jmp	loc_100153CA
; ---------------------------------------------------------------------------

loc_10015320:				; CODE XREF: sub_10015277+8Dj
		push	dword ptr [ebx+0C8h]
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8]
		call	sub_1000D658
		jmp	loc_100153CA
; ---------------------------------------------------------------------------

loc_10015338:				; CODE XREF: sub_10015277+8Aj
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8] ; void *
		call	sub_100172C3
		jmp	short loc_100153CA
; ---------------------------------------------------------------------------

loc_1001534D:				; CODE XREF: sub_10015277+87j
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8] ; void *
		call	sub_100127AF
		jmp	short loc_100153CA
; ---------------------------------------------------------------------------

loc_10015362:				; CODE XREF: sub_10015277+84j
		mov	edx, [esp+18h+arg_4]
		push	3
		pop	eax
		cmp	[ebx+38h], eax
		jge	short loc_10015373
		cmp	edx, 8
		jz	short loc_100153D1

loc_10015373:				; CODE XREF: sub_10015277+F5j
		push	dword ptr [ebx+0C8h]
		mov	ecx, [esp+1Ch+arg_8]
		call	sub_10011A0B
		jmp	short loc_100153CA
; ---------------------------------------------------------------------------

loc_10015384:				; CODE XREF: sub_10015277+7Dj
		push	dword ptr [ebx+0C8h]
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8]
		call	sub_1000EE01
		jmp	short loc_100153CA
; ---------------------------------------------------------------------------

loc_10015399:				; CODE XREF: sub_10015277+76j
		cmp	byte ptr [ebx+4Eh], 0
		jnz	short loc_100153B7
		mov	ecx, [ebx+0C8h]
		call	sub_1000B617
		test	al, al
		jnz	short loc_100153B3

loc_100153AE:				; CODE XREF: sub_10015277+156j
		push	2

loc_100153B0:				; CODE XREF: sub_10015277+94j
		pop	eax
		jmp	short loc_100153D1
; ---------------------------------------------------------------------------

loc_100153B3:				; CODE XREF: sub_10015277+135j
		mov	byte ptr [ebx+4Eh], 1

loc_100153B7:				; CODE XREF: sub_10015277+126j
		push	dword ptr [ebx+0C8h] ; int
		mov	edx, [esp+1Ch+arg_4]
		mov	ecx, [esp+1Ch+arg_8] ; void *
		call	sub_1000B3A3

loc_100153CA:				; CODE XREF: sub_10015277+A4j
					; sub_10015277+BCj ...
		pop	ecx
		test	al, al
		jz	short loc_100153AE
		xor	eax, eax

loc_100153D1:				; CODE XREF: sub_10015277+FAj
					; sub_10015277+13Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_10015277	endp


; =============== S U B	R O U T	I N E =======================================


sub_100153DA	proc near		; CODE XREF: sub_100149FF+7Dp
		push	esi
		mov	esi, ecx
		push	edi
		xor	edi, edi
		mov	eax, [esi+14h]
		sub	eax, [esi+10h]
		sar	eax, 3
		test	eax, eax
		jz	short loc_10015407

loc_100153ED:				; CODE XREF: sub_100153DA+2Bj
		mov	eax, [esi+10h]
		push	dword ptr [eax+edi*8] ;	hMem
		call	ds:LocalFree
		mov	eax, [esi+14h]
		inc	edi
		sub	eax, [esi+10h]
		sar	eax, 3
		cmp	edi, eax
		jb	short loc_100153ED

loc_10015407:				; CODE XREF: sub_100153DA+11j
		push	dword ptr [esi]	; hMem
		call	ds:LocalFree
		cmp	dword ptr [esi+10h], 0
		mov	edi, ds:__imp_??3@YAXPAX@Z ; operator delete(void *)
		jz	short loc_1001542D
		push	dword ptr [esi+10h]
		call	edi ; operator delete(void *) ;	operator delete(void *)
		and	dword ptr [esi+10h], 0
		and	dword ptr [esi+14h], 0
		and	dword ptr [esi+18h], 0
		pop	ecx

loc_1001542D:				; CODE XREF: sub_100153DA+3Fj
		push	esi
		call	edi ; operator delete(void *) ;	operator delete(void *)
		pop	ecx
		pop	edi
		mov	eax, esi
		pop	esi
		retn	4
sub_100153DA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015438	proc near		; CODE XREF: sub_1000B759+4Bp
					; sub_1000B7E7+4Ap ...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+var_4], 0
		mov	eax, dword_10031F98
		push	esi
		mov	esi, ecx
		push	edi
		mov	edi, edx
		test	eax, eax
		jnz	short loc_1001546B
		push	offset aNtdll_dll_3 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		push	offset aRtlinitunicode ; "RtlInitUnicodeString"
		push	eax		; hModule
		call	ds:GetProcAddress
		mov	dword_10031F98,	eax

loc_1001546B:				; CODE XREF: sub_10015438+15j
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10015473
		mov	esi, [esi]

loc_10015473:				; CODE XREF: sub_10015438+37j
		push	esi
		mov	esi, [ebp+arg_8]
		push	esi
		call	eax ; dword_10031F98
		mov	ecx, [ebp+arg_4]
		mov	eax, [ebp+arg_0]
		and	dword ptr [ecx+10h], 0
		and	dword ptr [ecx+14h], 0
		mov	[ecx+0Ch], edi
		pop	edi
		mov	[ecx+8], esi
		mov	dword ptr [ecx], 18h
		mov	[ecx+4], eax
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10015438	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001549D	proc near		; DATA XREF: .rdata:1002C050o
					; .rdata:1002C078o ...
		mov	eax, [ecx]
		jmp	dword ptr [eax+0Ch]
sub_1001549D	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100154A2	proc near		; DATA XREF: .rdata:1002C054o
					; .rdata:1002C07Co ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		test	eax, eax
		jnz	short loc_100154B5

loc_100154AE:				; CODE XREF: sub_100154A2+2Fj
		mov	eax, 0C0000001h
		jmp	short loc_100154D5
; ---------------------------------------------------------------------------

loc_100154B5:				; CODE XREF: sub_100154A2+Aj
		push	[ebp+arg_4]
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_1000579F
		mov	ecx, [ebp+arg_8]
		mov	[ecx], eax
		test	eax, eax
		jz	short loc_100154AE
		xor	eax, eax

loc_100154D5:				; CODE XREF: sub_100154A2+11j
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_100154A2	endp


; =============== S U B	R O U T	I N E =======================================


sub_100154DB	proc near		; DATA XREF: .rdata:1002C060o
					; .rdata:1002C088o ...
		push	esi
		push	offset aNtdll_dll_5 ; "ntdll.dll"
		mov	esi, ecx
		call	ds:GetModuleHandleW
		mov	[esi+0Ch], eax
		pop	esi
		retn
sub_100154DB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100154EE	proc near		; DATA XREF: .rdata:1002C04Co
					; .rdata:1002C074o ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch
arg_18		= dword	ptr  20h
arg_1C		= dword	ptr  24h

		push	ebp
		mov	ebp, esp
		push	edi
		push	[ebp+arg_18]
		mov	edi, ecx
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		mov	eax, [edi]
		push	[ebp+arg_C]
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	short loc_10015577
		mov	eax, [edi]
		mov	ecx, edi
		and	dword ptr [edi+18h], 0
		push	ebx
		push	esi
		call	dword ptr [eax+10h]
		mov	ebx, eax
		push	ebx
		call	sub_10018CBA
		mov	edx, [edi]
		mov	esi, eax
		pop	ecx
		push	esi
		mov	ecx, edi
		call	dword ptr [edx+20h]
		test	al, al
		jnz	short loc_10015551
		cmp	[edi+14h], al
		jz	short loc_1001554A
		push	[ebp+arg_14]
		mov	ecx, edi
		push	esi
		call	sub_100157B9
		test	al, al
		jnz	short loc_10015551

loc_1001554A:				; CODE XREF: sub_100154EE+4Bj
		mov	edi, 0C0000001h
		jmp	short loc_10015567
; ---------------------------------------------------------------------------

loc_10015551:				; CODE XREF: sub_100154EE+46j
					; sub_100154EE+5Aj
		push	[ebp+arg_14]
		mov	eax, [edi]
		mov	ecx, edi
		push	esi
		call	dword ptr [eax+24h]
		mov	edi, eax
		mov	eax, [ebp+arg_1C]
		test	eax, eax
		jz	short loc_10015567
		mov	[eax], ebx

loc_10015567:				; CODE XREF: sub_100154EE+61j
					; sub_100154EE+75j
		test	esi, esi
		jz	short loc_10015573
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10015573:				; CODE XREF: sub_100154EE+7Bj
		pop	esi
		mov	eax, edi
		pop	ebx

loc_10015577:				; CODE XREF: sub_100154EE+22j
		pop	edi
		pop	ebp
		retn	20h
sub_100154EE	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001557C	proc near		; DATA XREF: .rdata:1002C058o
					; .rdata:1002C080o ...
		push	36h
		pop	eax
		retn
sub_1001557C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015580	proc near		; DATA XREF: .rdata:1002C064o
					; .rdata:1002C08Co ...

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		mov	esi, ecx
		push	edi
		mov	edx, [esi]
		lea	eax, [esi+4]
		push	eax
		push	[ebp+arg_4]
		push	[ebp+arg_0]
		call	dword ptr [edx+0Ch]
		mov	edi, eax
		test	edi, edi
		js	short loc_100155E2
		mov	eax, [esi]
		mov	ecx, esi
		push	ebx
		call	dword ptr [eax+10h]
		mov	ebx, eax
		cmp	[ebp+arg_C], ebx
		jb	short loc_100155CF
		mov	eax, [esi]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	dword ptr [eax+20h]
		test	al, al
		jnz	short loc_100155D6
		cmp	[esi+14h], al
		jz	short loc_100155CF
		push	[ebp+arg_8]
		mov	ecx, esi
		push	[ebp+arg_8]
		call	sub_100157B9
		test	al, al
		jnz	short loc_100155D6

loc_100155CF:				; CODE XREF: sub_10015580+29j
					; sub_10015580+3Cj
		mov	eax, 0C0000001h
		jmp	short loc_100155E1
; ---------------------------------------------------------------------------

loc_100155D6:				; CODE XREF: sub_10015580+37j
					; sub_10015580+4Dj
		mov	eax, [ebp+arg_10]
		test	eax, eax
		jz	short loc_100155DF
		mov	[eax], ebx

loc_100155DF:				; CODE XREF: sub_10015580+5Bj
		mov	eax, edi

loc_100155E1:				; CODE XREF: sub_10015580+54j
		pop	ebx

loc_100155E2:				; CODE XREF: sub_10015580+1Aj
		pop	edi
		pop	esi
		pop	ebp
		retn	14h
sub_10015580	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100155E8	proc near		; DATA XREF: .rdata:1002C068o

lpModuleName	= dword	ptr -24h
phModule	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= byte ptr -0Fh
lpBaseAddress	= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 24h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		mov	ebx, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	esi
		push	edi
		mov	edi, ds:ReadProcessMemory
		mov	esi, ecx
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	loc_100156B8
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	loc_100156B8
		cmp	[ebp+Buffer], 0B8h
		jnz	loc_100156B8
		cmp	[ebp+var_F], 0BAh
		jnz	short loc_100156B8
		mov	eax, 12FFh
		mov	ecx, 0D2FFh
		cmp	ax, [ebp+var_A]
		jz	short loc_10015650
		cmp	cx, [ebp+var_A]
		jnz	short loc_100156B8

loc_10015650:				; CODE XREF: sub_100155E8+60j
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_100156B8
		cmp	cx, [ebp+var_A]
		jz	short loc_100156AB
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	4		; nSize
		lea	eax, [ebp+lpModuleName]
		push	eax		; lpBuffer
		push	[ebp+lpBaseAddress] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	edi ; ReadProcessMemory
		test	eax, eax
		jz	short loc_100156B8
		cmp	[ebp+NumberOfBytesRead], 4
		jnz	short loc_100156B8
		mov	edi, ds:GetModuleHandleExW
		lea	eax, [ebp+phModule]
		push	eax		; phModule
		push	[ebp+lpModuleName] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_100156B8
		mov	eax, [esi+0Ch]
		test	eax, eax
		jnz	short loc_100156A6
		lea	eax, [ebp+var_1C]
		push	eax		; phModule
		push	dword ptr [esi+4] ; lpModuleName
		push	6		; dwFlags
		call	edi ; GetModuleHandleExW
		test	eax, eax
		jz	short loc_100156B8
		mov	eax, [ebp+var_1C]

loc_100156A6:				; CODE XREF: sub_100155E8+AAj
		cmp	[ebp+phModule],	eax
		jnz	short loc_100156B8

loc_100156AB:				; CODE XREF: sub_100155E8+72j
		mov	edi, ebx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		jmp	short loc_100156BA
; ---------------------------------------------------------------------------

loc_100156B8:				; CODE XREF: sub_100155E8+32j
					; sub_100155E8+3Cj ...
		xor	al, al

loc_100156BA:				; CODE XREF: sub_100155E8+CEj
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100155E8	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100156CD(LPVOID lpBuffer, int)
sub_100156CD	proc near		; DATA XREF: .rdata:1002C06Co
					; .rdata:1002C094o ...

NumberOfBytesWritten= dword ptr	-1Ch
lpBaseAddress	= dword	ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_F		= byte ptr -0Fh
var_E		= dword	ptr -0Eh
var_A		= word ptr -0Ah
var_4		= dword	ptr -4
lpBuffer	= dword	ptr  4
arg_4		= dword	ptr  8

		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+24h+lpBuffer]
		mov	ebx, ecx
		mov	ecx, [esp+24h+arg_4]
		push	esi
		push	edi
		mov	eax, [ebp+1]
		lea	edi, [esp+2Ch+Buffer]
		mov	esi, ebp
		mov	[esp+2Ch+lpBaseAddress], ecx
		push	0Ch
		movsd
		movsd
		movsd
		movsd
		mov	[esp+30h+var_13], eax
		lea	eax, [ecx+18h]
		mov	[esp+30h+var_E], eax
		mov	eax, 0E2FFh
		mov	[esp+30h+var_A], ax
		mov	eax, [ebx+18h]
		mov	[esp+30h+Buffer], 0B8h
		mov	[esp+30h+var_F], 0BAh
		pop	esi
		test	eax, eax
		jz	short loc_1001572F
		push	5
		mov	[esp+30h+Buffer], 0E9h
		mov	[esp+30h+var_13], eax
		pop	esi

loc_1001572F:				; CODE XREF: sub_100156CD+54j
		push	dword ptr [ebx+8]
		lea	eax, [ebp+18h]
		push	ecx
		push	1Eh
		push	eax
		call	sub_10012A7E
		mov	eax, [ebx]
		mov	ecx, ebx
		call	dword ptr [eax+10h]
		mov	edi, eax
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	edi		; nSize
		push	ebp		; lpBuffer
		push	[esp+38h+lpBaseAddress]	; lpBaseAddress
		mov	ebp, ds:WriteProcessMemory
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax
		jnz	short loc_10015768

loc_10015761:				; CODE XREF: sub_100156CD+9Fj
					; sub_100156CD:loc_10015789j
		mov	eax, 0C0000001h
		jmp	short loc_1001578D
; ---------------------------------------------------------------------------

loc_10015768:				; CODE XREF: sub_100156CD+92j
		cmp	edi, [esp+2Ch+NumberOfBytesWritten]
		jnz	short loc_10015761
		cmp	dword ptr [ebx+0Ch], 0
		jz	short loc_100157A2
		lea	eax, [esp+2Ch+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		lea	eax, [esp+34h+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ebx+4] ; lpBaseAddress
		push	dword ptr [ebx+10h] ; hProcess
		call	ebp ; WriteProcessMemory
		test	eax, eax

loc_10015789:				; CODE XREF: sub_100156CD+EAj
		jz	short loc_10015761
		xor	eax, eax

loc_1001578D:				; CODE XREF: sub_100156CD+99j
		mov	ecx, [esp+2Ch+var_4]
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 1Ch
		retn	8
; ---------------------------------------------------------------------------

loc_100157A2:				; CODE XREF: sub_100156CD+A5j
		mov	edx, [ebx+4]	; lpAddress
		lea	eax, [esp+2Ch+Buffer]
		mov	ecx, [ebx+10h]	; hProcess
		push	esi		; dwSize
		push	eax		; lpBuffer
		call	sub_100187CE
		pop	ecx
		pop	ecx
		test	al, al
		jmp	short loc_10015789
sub_100156CD	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100157B9	proc near		; CODE XREF: sub_100154EE+53p
					; sub_10015580+46p

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_13		= dword	ptr -13h
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	esi
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		mov	esi, ecx
		lea	eax, [ebp+Buffer]
		push	10h		; nSize
		push	eax		; lpBuffer
		push	dword ptr [esi+4] ; lpBaseAddress
		push	dword ptr [esi+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jnz	short loc_100157EE

loc_100157EA:				; CODE XREF: sub_100157B9+39j
		xor	al, al
		jmp	short loc_10015817
; ---------------------------------------------------------------------------

loc_100157EE:				; CODE XREF: sub_100157B9+2Fj
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_100157EA
		cmp	[ebp+Buffer], 0E9h
		jnz	short loc_1001580E
		mov	eax, [esi+4]
		mov	ecx, [ebp+arg_4]
		sub	eax, ecx
		sub	ecx, [esi+4]
		add	[ebp+var_13], eax
		add	ecx, 13h
		mov	[esi+18h], ecx

loc_1001580E:				; CODE XREF: sub_100157B9+3Fj
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd

loc_10015817:				; CODE XREF: sub_100157B9+33j
		mov	ecx, [ebp+var_4]
		pop	edi
		xor	ecx, ebp
		pop	esi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	8
sub_100157B9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015829	proc near		; DATA XREF: .rdata:1002C0B8o

NumberOfBytesRead= dword ptr -20h
Buffer		= byte ptr -1Ch
var_17		= word ptr -17h
var_15		= dword	ptr -15h
var_11		= dword	ptr -11h
var_D		= word ptr -0Dh
var_B		= byte ptr -0Bh
var_A		= byte ptr -0Ah
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	18h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100158B7
		cmp	[ebp+NumberOfBytesRead], 18h
		jnz	short loc_100158B7
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_100158B7
		mov	eax, 0C933h
		cmp	ax, [ebp+var_17]
		jnz	short loc_100158B7
		cmp	[ebp+var_15], 424548Dh
		jnz	short loc_100158B7
		cmp	[ebp+var_11], 0C015FF64h
		jnz	short loc_100158B7
		xor	eax, eax
		cmp	ax, [ebp+var_D]
		jnz	short loc_100158B7
		cmp	[ebp+var_B], al
		jnz	short loc_100158B7
		mov	al, [ebp+var_A]
		cmp	al, 83h
		jnz	short loc_100158A5
		mov	ecx, 4C4h
		cmp	cx, [ebp+var_9]
		jnz	short loc_100158B7
		cmp	[ebp+var_7], 0C2h
		jz	short loc_100158A9

loc_100158A5:				; CODE XREF: sub_10015829+69j
		cmp	al, 0C2h
		jnz	short loc_100158B7

loc_100158A9:				; CODE XREF: sub_10015829+7Aj
		push	esi
		push	6
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_100158B9
; ---------------------------------------------------------------------------

loc_100158B7:				; CODE XREF: sub_10015829+2Cj
					; sub_10015829+32j ...
		xor	al, al

loc_100158B9:				; CODE XREF: sub_10015829+8Cj
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015829	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100158CA	proc near		; DATA XREF: .rdata:1002C090o

NumberOfBytesRead= dword ptr -18h
Buffer		= byte ptr -14h
var_F		= dword	ptr -0Fh
var_B		= word ptr -0Bh
var_9		= byte ptr -9
var_8		= byte ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	10h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_1001592D
		cmp	[ebp+NumberOfBytesRead], 10h
		jnz	short loc_1001592D
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_1001592D
		cmp	[ebp+var_F], 0C015FF64h
		jnz	short loc_1001592D
		xor	eax, eax
		cmp	ax, [ebp+var_B]
		jnz	short loc_1001592D
		cmp	[ebp+var_9], al
		jnz	short loc_1001592D
		cmp	[ebp+var_8], 0C2h
		jnz	short loc_1001592D
		push	esi
		lea	esi, [ebp+Buffer]
		mov	al, 1
		movsd
		movsd
		movsd
		movsd
		pop	esi
		jmp	short loc_1001592F
; ---------------------------------------------------------------------------

loc_1001592D:				; CODE XREF: sub_100158CA+2Cj
					; sub_100158CA+32j ...
		xor	al, al

loc_1001592F:				; CODE XREF: sub_100158CA+61j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_100158CA	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015940	proc near		; DATA XREF: .rdata:1002C0E0o

NumberOfBytesRead= dword ptr -1Ch
Buffer		= byte ptr -18h
var_13		= byte ptr -13h
var_12		= dword	ptr -12h
var_E		= byte ptr -0Eh
var_B		= word ptr -0Bh
var_9		= word ptr -9
var_7		= byte ptr -7
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	edi
		mov	edi, [ebp+arg_0]
		lea	eax, [ebp+NumberOfBytesRead]
		push	eax		; lpNumberOfBytesRead
		push	14h		; nSize
		lea	eax, [ebp+Buffer]
		push	eax		; lpBuffer
		push	dword ptr [ecx+4] ; lpBaseAddress
		push	dword ptr [ecx+10h] ; hProcess
		call	ds:ReadProcessMemory
		test	eax, eax
		jz	short loc_100159B6
		cmp	[ebp+NumberOfBytesRead], 14h
		jnz	short loc_100159B6
		cmp	[ebp+Buffer], 0B8h
		jnz	short loc_100159B6
		cmp	[ebp+var_13], 0E8h
		jnz	short loc_100159B6
		cmp	[ebp+var_12], 3
		jnz	short loc_100159B6
		cmp	[ebp+var_E], 0C2h
		jnz	short loc_100159B6
		mov	eax, 0D48Bh
		cmp	ax, [ebp+var_B]
		jnz	short loc_100159B6
		mov	eax, 340Fh
		cmp	ax, [ebp+var_9]
		jnz	short loc_100159B6
		cmp	[ebp+var_7], 0C3h
		jnz	short loc_100159B6
		push	esi
		push	5
		pop	ecx
		lea	esi, [ebp+Buffer]
		mov	al, 1
		rep movsd
		pop	esi
		jmp	short loc_100159B8
; ---------------------------------------------------------------------------

loc_100159B6:				; CODE XREF: sub_10015940+2Cj
					; sub_10015940+32j ...
		xor	al, al

loc_100159B8:				; CODE XREF: sub_10015940+74j
		mov	ecx, [ebp+var_4]
		xor	ecx, ebp
		pop	edi
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015940	endp


; =============== S U B	R O U T	I N E =======================================


sub_100159C9	proc near		; CODE XREF: sub_1000ACB8+5p
					; sub_1000ADD0+5p ...
		push	ebx
		push	esi
		mov	esi, ecx
		push	edi
		mov	ebx, [esi]
		cmp	dword ptr [ebx], 0
		jz	short loc_10015A0D

loc_100159D5:				; CODE XREF: sub_100159C9+42j
		mov	eax, [esi]
		xor	edx, edx
		cmp	[eax], edx
		jz	short loc_100159F9
		lea	edi, [ebx+0Ch]

loc_100159E0:				; CODE XREF: sub_100159C9+2Ej
		push	2
		xor	eax, eax
		pop	ecx
		inc	eax
		lock cmpxchg [edi], ecx
		cmp	eax, 1
		jz	short loc_10015A13
		mov	eax, [esi]
		inc	edx
		add	edi, 14h
		cmp	edx, [eax]
		jnz	short loc_100159E0

loc_100159F9:				; CODE XREF: sub_100159C9+12j
		mov	eax, [esi]
		push	32h		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jz	short loc_100159D5

loc_10015A0D:				; CODE XREF: sub_100159C9+Aj
		xor	eax, eax

loc_10015A0F:				; CODE XREF: sub_100159C9+55j
		pop	edi
		pop	esi
		pop	ebx
		retn
; ---------------------------------------------------------------------------

loc_10015A13:				; CODE XREF: sub_100159C9+24j
		mov	ecx, [esi]
		imul	eax, edx, 14h
		mov	eax, [eax+ecx+8]
		add	eax, ecx
		jmp	short loc_10015A0F
sub_100159C9	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015A20	proc near		; CODE XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+135p
					; TargetNtOpenFile(x,x,x,x,x,x,x)+120p	...

var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		push	ecx
		push	ecx
		mov	edx, [ebp+arg_0]
		and	[esp+8+var_4], 0
		mov	[ecx], edx
		mov	eax, [edx+8]
		add	eax, edx
		mov	[ecx+4], eax
		mov	eax, ecx
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10015A20	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015A42	proc near		; CODE XREF: sub_1000ACB8+F2p
					; sub_1000ADD0+C2p ...

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, [edi]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10015A56
		push	0Ah
		pop	eax
		jmp	loc_10015AE9
; ---------------------------------------------------------------------------

loc_10015A56:				; CODE XREF: sub_10015A42+Aj
		mov	ecx, [esp+8+arg_0]
		mov	eax, ecx
		sub	eax, [edi+4]
		push	ebx
		shr	eax, 0Ah
		imul	ebx, eax, 14h
		mov	eax, [ecx]
		push	0		; bAlertable
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hObjectToWaitOn
		mov	[ebx+esi+18h], eax
		push	dword ptr [ebx+esi+10h]	; hObjectToSignal
		call	ds:SignalObjectAndWait
		cmp	eax, 102h
		jnz	short loc_10015ACA

loc_10015A88:				; CODE XREF: sub_10015A42+72j
		mov	eax, [edi]
		push	0		; dwMilliseconds
		push	dword ptr [eax+4] ; hHandle
		call	ds:WaitForSingleObject
		cmp	eax, 102h
		jnz	short loc_10015AB8
		push	3E8h		; dwMilliseconds
		push	dword ptr [ebx+esi+14h]	; hHandle
		call	ds:WaitForSingleObject
		test	eax, eax
		jz	short loc_10015AD3
		cmp	eax, 102h
		jz	short loc_10015A88
		jmp	short loc_10015ACE
; ---------------------------------------------------------------------------

loc_10015AB8:				; CODE XREF: sub_10015A42+58j
		push	5
		lea	eax, [esi+0Ch]
		pop	ecx
		add	eax, ebx
		xchg	ecx, [eax]
		mov	eax, [edi]
		and	dword ptr [eax+4], 0
		jmp	short loc_10015ACE
; ---------------------------------------------------------------------------

loc_10015ACA:				; CODE XREF: sub_10015A42+44j
		test	eax, eax
		jz	short loc_10015AD3

loc_10015ACE:				; CODE XREF: sub_10015A42+74j
					; sub_10015A42+86j
		push	0Ah
		pop	eax
		jmp	short loc_10015AE8
; ---------------------------------------------------------------------------

loc_10015AD3:				; CODE XREF: sub_10015A42+6Bj
					; sub_10015A42+8Aj
		mov	eax, [esp+0Ch+arg_4]
		mov	edi, eax
		mov	esi, [esp+0Ch+arg_0]
		push	0Dh
		add	esi, 8
		pop	ecx
		rep movsd
		mov	eax, [eax+4]

loc_10015AE8:				; CODE XREF: sub_10015A42+8Fj
		pop	ebx

loc_10015AE9:				; CODE XREF: sub_10015A42+Fj
		pop	edi
		pop	esi
		retn	8
sub_10015A42	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10015AEE	proc near		; CODE XREF: sub_10017B53+14Bp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	esi
		push	edi
		mov	esi, ecx
		xor	edi, edi
		push	edi
		push	edi
		mov	[esi], edi
		mov	[esi+4], edi
		mov	[esi+8], edi
		call	sub_1000917F
		mov	[esi+4], eax
		mov	eax, [ebp+arg_C]
		mov	[esi+0Ch], eax
		mov	eax, [ebp+arg_0]
		mov	[esi+10h], eax
		mov	eax, [ebp+arg_4]
		mov	[esi+14h], eax
		mov	eax, [ebp+arg_8]
		mov	[esi+18h], eax
		mov	eax, [ebp+arg_10]
		mov	[esi+1Ch], eax
		cmp	hSourceHandle, edi
		jnz	short loc_10015B53
		push	edi		; lpName
		push	1		; bInitialOwner
		push	edi		; lpMutexAttributes
		call	ds:CreateMutexW
		mov	edx, eax
		mov	edi, offset hSourceHandle
		mov	ecx, edx
		xor	eax, eax
		lock cmpxchg [edi], ecx
		test	eax, eax
		jz	short loc_10015B53
		push	edx		; hObject
		call	ds:CloseHandle

loc_10015B53:				; CODE XREF: sub_10015AEE+3Fj
					; sub_10015AEE+5Cj
		pop	edi
		mov	eax, esi
		pop	esi
		pop	ebp
		retn	14h
sub_10015AEE	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015B5B	proc near		; CODE XREF: sub_10017B53+16Ep

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		push	esi
		mov	esi, ecx
		mov	[esp+14h+var_8], 94h
		push	edi
		mov	[esi], ebx
		and	dword ptr [ebx], 0
		xor	ebp, ebp

loc_10015B76:				; CODE XREF: sub_10015B5B+C3j
		mov	eax, [esi]
		add	eax, 8
		add	eax, ebp
		push	28h
		mov	[esp+1Ch+arg_0], eax
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	edi, eax
		lea	eax, [esp+1Ch+var_4]
		pop	ecx
		push	eax
		lea	ecx, [esi+4]
		mov	[esp+1Ch+var_4], edi
		call	sub_10008D33
		mov	ecx, [esp+18h+arg_0]
		lea	eax, [ecx+0Ch]
		push	eax		; LPHANDLE
		lea	eax, [ecx+8]
		mov	ecx, esi
		push	eax		; lpTargetHandle
		lea	eax, [edi+4]
		push	eax		; int
		push	edi		; int
		call	sub_100161F4
		test	al, al
		jz	loc_10015C59
		mov	ecx, [esp+18h+arg_0]
		mov	edx, [esp+18h+var_8]
		push	edi
		push	offset sub_10016177
		mov	[ecx], edx
		add	edx, 400h
		mov	dword ptr [ecx+4], 1
		mov	[edi+10h], ebx
		mov	dword ptr [edi+8], 400h
		mov	[edi+14h], ecx
		mov	eax, [edi+10h]
		add	eax, [ecx]
		mov	[edi+0Ch], eax
		mov	eax, [esi+1Ch]
		mov	[edi+18h], eax
		mov	eax, [esi+10h]
		mov	[edi+1Ch], eax
		mov	eax, [esi+14h]
		mov	[edi+24h], eax
		mov	eax, [esi+18h]
		mov	[edi+20h], eax
		mov	ecx, [esi+0Ch]
		push	dword ptr [edi]
		mov	[esp+24h+var_8], edx
		push	esi
		mov	eax, [ecx]
		call	dword ptr [eax]
		add	ebp, 14h
		cmp	ebp, 8Ch
		jnz	loc_10015B76
		mov	eax, [esi]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		add	eax, 4
		push	eax		; lpTargetHandle
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	hSourceHandle	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10015C59
		mov	ecx, [esi]
		mov	al, 1
		mov	dword ptr [ecx], 7
		jmp	short loc_10015C5B
; ---------------------------------------------------------------------------

loc_10015C59:				; CODE XREF: sub_10015B5B+5Cj
					; sub_10015B5B+F0j
		xor	al, al

loc_10015C5B:				; CODE XREF: sub_10015B5B+FCj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	0Ch
sub_10015B5B	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015C64	proc near		; CODE XREF: sub_10015CAB+145p
					; sub_10015CAB+154p ...
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, edx
		lea	ebp, [ecx+4]
		xor	esi, esi

loc_10015C6F:				; CODE XREF: sub_10015C64+40j
		mov	eax, [ebp+0]
		dec	eax
		jz	short loc_10015C7F
		sub	eax, 5
		jnz	short loc_10015C9D
		push	dword ptr [edi+esi*4]
		jmp	short loc_10015C92
; ---------------------------------------------------------------------------

loc_10015C7F:				; CODE XREF: sub_10015C64+Fj
		mov	ebx, [edi+esi*4]
		test	ebx, ebx
		jz	short loc_10015C99
		push	0
		push	1
		mov	ecx, ebx
		call	sub_10002311
		push	ebx

loc_10015C92:				; CODE XREF: sub_10015C64+19j
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10015C99:				; CODE XREF: sub_10015C64+20j
		and	dword ptr [edi+esi*4], 0

loc_10015C9D:				; CODE XREF: sub_10015C64+14j
		inc	esi
		add	ebp, 4
		cmp	esi, 9
		jb	short loc_10015C6F
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn
sub_10015C64	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015CAB	proc near		; CODE XREF: sub_10015E1F+80p

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebp
		push	esi
		mov	esi, ecx
		mov	ebp, edx
		mov	[esp+24h+var_14], esi
		cmp	dword ptr [esi+3Ch], 9
		jbe	short loc_10015CC5
		xor	al, al
		jmp	loc_10015DE6
; ---------------------------------------------------------------------------

loc_10015CC5:				; CODE XREF: sub_10015CAB+11j
		push	ebx
		push	edi
		xor	edi, edi
		cmp	[esi+3Ch], edi
		jbe	loc_10015DE2
		mov	ebx, [esp+2Ch+arg_0]
		lea	eax, [ebp+4]
		mov	[esp+2Ch+var_1C], eax

loc_10015CDD:				; CODE XREF: sub_10015CAB+131j
		lea	eax, [esp+2Ch+var_10]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+30h+var_C]
		push	eax
		push	edi
		call	sub_10009948
		mov	[ebx+edi*4], eax
		test	eax, eax
		jz	loc_10015DD3
		mov	ecx, [esp+2Ch+var_1C]
		mov	eax, [esp+2Ch+var_10]
		mov	[ecx], eax
		dec	eax
		jz	loc_10015D9A
		dec	eax
		jz	short loc_10015D6A
		dec	eax
		dec	eax
		jz	short loc_10015D39
		dec	eax
		dec	eax
		jnz	loc_10015DD3
		push	8
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10015D35
		mov	ecx, [esp+2Ch+var_C]
		mov	[eax], ecx
		mov	ecx, [ebx+edi*4]
		mov	[eax+4], ecx
		jmp	short loc_10015D95
; ---------------------------------------------------------------------------

loc_10015D35:				; CODE XREF: sub_10015CAB+7Aj
		xor	eax, eax
		jmp	short loc_10015D95
; ---------------------------------------------------------------------------

loc_10015D39:				; CODE XREF: sub_10015CAB+65j
		and	[esp+2Ch+var_18], 0
		lea	eax, [esp+2Ch+var_8]
		push	eax
		lea	eax, [esp+30h+var_18]
		mov	ecx, esi
		push	eax
		push	edi
		call	sub_10009948
		test	eax, eax
		jz	loc_10015DEC
		cmp	[esp+2Ch+var_18], 4
		jnz	loc_10015DEC
		cmp	[esp+2Ch+var_8], 4
		jmp	short loc_10015D91
; ---------------------------------------------------------------------------

loc_10015D6A:				; CODE XREF: sub_10015CAB+61j
		and	[esp+2Ch+var_18], 0
		lea	eax, [esp+2Ch+var_4]
		push	eax
		lea	eax, [esp+30h+var_18]
		mov	ecx, esi
		push	eax
		push	edi
		call	sub_10009948
		test	eax, eax
		jz	short loc_10015DEC
		cmp	[esp+2Ch+var_18], 4
		jnz	short loc_10015DEC
		cmp	[esp+2Ch+var_4], 2

loc_10015D91:				; CODE XREF: sub_10015CAB+BDj
		jnz	short loc_10015DEC
		mov	eax, [eax]

loc_10015D95:				; CODE XREF: sub_10015CAB+88j
					; sub_10015CAB+8Cj
		mov	[ebx+edi*4], eax
		jmp	short loc_10015DD3
; ---------------------------------------------------------------------------

loc_10015D9A:				; CODE XREF: sub_10015CAB+5Aj
		push	18h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		mov	esi, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10015DBB
		and	dword ptr [esi+10h], 0
		xor	eax, eax
		mov	dword ptr [esi+14h], 7
		mov	[esi], ax
		jmp	short loc_10015DBD
; ---------------------------------------------------------------------------

loc_10015DBB:				; CODE XREF: sub_10015CAB+FCj
		xor	esi, esi

loc_10015DBD:				; CODE XREF: sub_10015CAB+10Ej
		mov	ecx, [esp+2Ch+var_14]
		push	esi		; void *
		push	edi		; int
		call	sub_1000997E
		test	al, al
		jz	short loc_10015DF7
		mov	[ebx+edi*4], esi
		mov	esi, [esp+2Ch+var_14]

loc_10015DD3:				; CODE XREF: sub_10015CAB+49j
					; sub_10015CAB+69j ...
		add	[esp+2Ch+var_1C], 4
		inc	edi
		cmp	edi, [esi+3Ch]
		jb	loc_10015CDD

loc_10015DE2:				; CODE XREF: sub_10015CAB+21j
		mov	al, 1

loc_10015DE4:				; CODE XREF: sub_10015CAB+172j
		pop	edi
		pop	ebx

loc_10015DE6:				; CODE XREF: sub_10015CAB+15j
		pop	esi
		pop	ebp
		add	esp, 1Ch
		retn
; ---------------------------------------------------------------------------

loc_10015DEC:				; CODE XREF: sub_10015CAB+A7j
					; sub_10015CAB+B2j ...
		mov	edx, ebx
		mov	ecx, ebp
		call	sub_10015C64
		jmp	short loc_10015E1B
; ---------------------------------------------------------------------------

loc_10015DF7:				; CODE XREF: sub_10015CAB+11Fj
		and	dword ptr [ebx+edi*4], 0
		mov	edx, ebx
		mov	ecx, ebp
		call	sub_10015C64
		test	esi, esi
		jz	short loc_10015E1B
		push	0
		push	1
		mov	ecx, esi
		call	sub_10002311
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_10015E1B:				; CODE XREF: sub_10015CAB+14Aj
					; sub_10015CAB+15Bj
		xor	al, al
		jmp	short loc_10015DE4
sub_10015CAB	endp


; =============== S U B	R O U T	I N E =======================================


sub_10015E1F	proc near		; CODE XREF: sub_10016177+4Ep

var_A5		= byte ptr -0A5h
var_A4		= byte ptr -0A4h
var_A0		= dword	ptr -0A0h
var_9C		= dword	ptr -9Ch
var_98		= dword	ptr -98h
var_94		= dword	ptr -94h
var_90		= dword	ptr -90h
var_8C		= dword	ptr -8Ch
var_88		= dword	ptr -88h
var_84		= byte ptr -84h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4

		sub	esp, 0A8h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+0A8h+var_4], eax
		push	ebx
		push	ebp
		mov	ebp, [esp+0B0h+arg_0]
		mov	eax, ecx
		push	esi
		xor	ebx, ebx
		mov	[esp+0B4h+var_98], eax
		mov	[esp+0B4h+var_9C], ebx
		lea	ecx, [esp+0B4h+var_A0]
		mov	esi, edx
		mov	dword ptr [ebp+4], 5
		push	edi
		mov	[ebp+0Ch], ebx
		mov	edx, [eax+8]
		push	ecx
		mov	ecx, esi
		mov	[esp+0BCh+var_94], esi
		mov	[esp+0BCh+var_A0], ebx
		call	sub_100097F5
		mov	esi, eax
		mov	[esp+0BCh+var_9C], esi
		pop	ecx
		test	esi, esi
		jz	loc_10016134
		mov	edx, [esi]
		lea	edi, [esp+0B8h+var_4C]
		push	9
		xor	eax, eax
		mov	[esp+0BCh+var_90], edx
		pop	ecx
		rep stosd
		lea	eax, [esp+0B8h+var_28]
		mov	[esp+0B8h+var_50], edx
		push	eax
		lea	edx, [esp+0BCh+var_50]
		mov	ecx, esi
		call	sub_10015CAB
		pop	ecx
		test	al, al
		jz	loc_10016128
		push	38h		; size_t
		lea	eax, [esp+0BCh+var_88]
		push	ebx		; int
		push	eax		; void *
		call	memset
		mov	ecx, [esp+0C4h+var_98]
		lea	edx, [esp+0C4h+var_A4]
		mov	eax, [esp+0C4h+var_90]
		add	esp, 0Ch
		mov	[esp+0B8h+var_8C], eax
		mov	[esp+0B8h+var_A5], 1
		lea	eax, [ecx+1Ch]
		mov	ecx, [ecx+18h]
		mov	[esp+0B8h+var_88], eax
		push	edx
		lea	edx, [esp+0BCh+var_50]
		mov	eax, [ecx]
		push	edx
		call	dword ptr [eax]
		test	eax, eax
		jz	loc_10016111
		mov	ecx, [esi+3Ch]
		cmp	ecx, 9		; switch 10 cases
		ja	loc_10016107	; jumptable 10015EFA default case
		jmp	ds:off_1001614F[ecx*4] ; switch	jump
; ---------------------------------------------------------------------------

loc_10015F01:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		lea	ecx, [esp+0B8h+var_8C] ; jumptable 10015EFA case 0
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0BCh+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015F11:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_28] ; jumptable 10015EFA case 1
		lea	ecx, [esp+0BCh+var_8C]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C0h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015F28:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_24] ; jumptable 10015EFA case 2
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C4h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015F46:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_20] ; jumptable 10015EFA case 3
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_24]
		push	[esp+0C0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0C8h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015F6B:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_1C] ; jumptable 10015EFA case 4
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_20]
		push	[esp+0C0h+var_24]
		push	[esp+0C4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0CCh+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015F97:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_18] ; jumptable 10015EFA case 5
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_1C]
		push	[esp+0C0h+var_20]
		push	[esp+0C4h+var_24]
		push	[esp+0C8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D0h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10015FCA:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_14] ; jumptable 10015EFA case 6
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_18]
		push	[esp+0C0h+var_1C]
		push	[esp+0C4h+var_20]
		push	[esp+0C8h+var_24]
		push	[esp+0CCh+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D4h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10016004:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_10] ; jumptable 10015EFA case 7
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_14]
		push	[esp+0C0h+var_18]
		push	[esp+0C4h+var_1C]
		push	[esp+0C8h+var_20]
		push	[esp+0CCh+var_24]
		push	[esp+0D0h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0D8h+var_A4]
		jmp	loc_100160D4
; ---------------------------------------------------------------------------

loc_10016045:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_C] ; jumptable 10015EFA case 8
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_10]
		push	[esp+0C0h+var_14]
		push	[esp+0C4h+var_18]
		push	[esp+0C8h+var_1C]
		push	[esp+0CCh+var_20]
		push	[esp+0D0h+var_24]
		push	[esp+0D4h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0DCh+var_A4]
		jmp	short loc_100160D4
; ---------------------------------------------------------------------------

loc_1001608A:				; CODE XREF: sub_10015E1F+DBj
					; DATA XREF: .text:off_1001614Fo
		push	[esp+0B8h+var_8] ; jumptable 10015EFA case 9
		lea	ecx, [esp+0BCh+var_8C]
		push	[esp+0BCh+var_C]
		push	[esp+0C0h+var_10]
		push	[esp+0C4h+var_14]
		push	[esp+0C8h+var_18]
		push	[esp+0CCh+var_1C]
		push	[esp+0D0h+var_20]
		push	[esp+0D4h+var_24]
		push	[esp+0D8h+var_28]
		push	ecx
		mov	ecx, eax
		call	dword ptr [esp+0E0h+var_A4]

loc_100160D4:				; CODE XREF: sub_10015E1F+EDj
					; sub_10015E1F+104j ...
		test	al, al
		jz	short loc_10016107 ; jumptable 10015EFA	default	case
		push	0Dh
		pop	ecx
		lea	esi, [esp+0B8h+var_84]
		mov	[esp+0B8h+var_A5], bl
		mov	edi, ebp
		rep movsd
		mov	esi, [esp+0B8h+var_9C]
		mov	[ebp+4], ebx
		cmp	dword ptr [esi+4], 1
		jnz	short loc_10016111
		push	[esp+0B8h+var_A0] ; size_t
		push	esi		; void *
		push	[esp+0C0h+var_94] ; void *
		call	memcpy
		add	esp, 0Ch
		jmp	short loc_10016111
; ---------------------------------------------------------------------------

loc_10016107:				; CODE XREF: sub_10015E1F+D5j
					; sub_10015E1F+2B7j
		mov	dword ptr [ebp+4], 6 ; jumptable 10015EFA default case
		mov	[ebp+0Ch], ebx

loc_10016111:				; CODE XREF: sub_10015E1F+C9j
					; sub_10015E1F+2D3j ...
		lea	edx, [esp+0B8h+var_28]
		lea	ecx, [esp+0B8h+var_50]
		call	sub_10015C64
		cmp	[esp+0B8h+var_A5], bl
		setz	bl

loc_10016128:				; CODE XREF: sub_10015E1F+88j
		test	esi, esi
		jz	short loc_10016134
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10016134:				; CODE XREF: sub_10015E1F+57j
					; sub_10015E1F+30Bj
		mov	ecx, [esp+0B8h+var_4]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 0A8h
		retn
sub_10015E1F	endp

; ---------------------------------------------------------------------------
off_1001614F	dd offset loc_10015F01	; DATA XREF: sub_10015E1F+DBr
		dd offset loc_10015F11	; jump table for switch	statement
		dd offset loc_10015F28
		dd offset loc_10015F46
		dd offset loc_10015F6B
		dd offset loc_10015F97
		dd offset loc_10015FCA
		dd offset loc_10016004
		dd offset loc_10016045
		dd offset loc_1001608A

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016177	proc near		; DATA XREF: sub_10015B5B+6Bo

var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		xor	esi, esi
		mov	[esp+44h+var_38], esi
		push	edi
		test	ebx, ebx
		jz	short loc_100161EB
		mov	ecx, [ebx+14h]
		push	3
		pop	edx
		push	2
		add	ecx, 4
		pop	eax
		lock cmpxchg [ecx], edx
		cmp	eax, 2
		jnz	short loc_100161EB
		push	30h		; size_t
		lea	eax, [esp+4Ch+var_30]
		mov	[esp+4Ch+var_34], esi
		push	esi		; int
		push	eax		; void *
		call	memset
		mov	edi, [ebx+0Ch]
		lea	eax, [esp+54h+var_34]
		add	esp, 0Ch
		mov	edx, edi
		mov	ecx, ebx
		push	eax
		call	sub_10015E1F
		pop	ecx
		push	0Dh
		pop	ecx
		add	edi, 8
		lea	esi, [esp+48h+var_34]
		rep movsd
		mov	eax, [ebx+14h]
		push	3
		add	eax, 4
		pop	ecx
		xchg	ecx, [eax]
		push	dword ptr [ebx+4] ; hEvent
		call	ds:SetEvent

loc_100161EB:				; CODE XREF: sub_10016177+17j
					; sub_10016177+2Cj
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	8
sub_10016177	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100161F4(int, int, LPHANDLE	lpTargetHandle,	LPHANDLE)
sub_100161F4	proc near		; CODE XREF: sub_10015B5B+55p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ebx
		push	esi
		xor	ebx, ebx
		mov	esi, ecx
		push	ebx		; lpName
		push	ebx		; bInitialState
		push	ebx		; bManualReset
		push	ebx		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_0]
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		mov	ebx, ds:GetCurrentProcess
		push	100002h		; dwDesiredAccess
		push	[esp+14h+lpTargetHandle] ; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jnz	short loc_10016230
		xor	al, al
		jmp	short loc_10016261
; ---------------------------------------------------------------------------

loc_10016230:				; CODE XREF: sub_100161F4+36j
		xor	eax, eax
		push	eax		; lpName
		push	eax		; bInitialState
		push	eax		; bManualReset
		push	eax		; lpEventAttributes
		call	ds:CreateEventW
		mov	ecx, [esp+8+arg_4]
		push	0		; dwOptions
		push	0		; bInheritHandle
		push	100002h		; dwDesiredAccess
		push	[esp+14h+arg_C]	; lpTargetHandle
		mov	[ecx], eax
		push	dword ptr [esi+10h] ; hTargetProcessHandle
		push	eax		; hSourceHandle
		call	ebx ; GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		setnz	al

loc_10016261:				; CODE XREF: sub_100161F4+3Aj
		pop	esi
		pop	ebx
		retn	10h
sub_100161F4	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10016266(PSID pSid, WELL_KNOWN_SID_TYPE WellKnownSidType)
sub_10016266	proc near		; CODE XREF: sub_10012AE0+1E6p
					; sub_10013578+13Bp ...

cbSid		= dword	ptr -4
WellKnownSidType= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	ecx
		and	[ebp+cbSid], 0
		lea	eax, [ebp+cbSid]
		push	esi
		push	eax		; cbSid
		mov	esi, ecx
		mov	[ebp+cbSid], 44h
		push	esi		; pSid
		push	0		; DomainSid
		push	[ebp+WellKnownSidType] ; WellKnownSidType
		call	ds:CreateWellKnownSid
		mov	eax, esi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	4
sub_10016266	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016291	proc near		; CODE XREF: sub_1001662E+35p
					; sub_1001662E+43p
		mov	al, [ecx+0Bh]
		mov	[ecx+0Ah], al
		mov	al, [ecx+0Dh]
		mov	[ecx+0Ch], al
		xor	eax, eax
		mov	[ecx+4], eax
		mov	[ecx+8], ax
		mov	dword ptr [ecx], 1
		mov	[ecx+0Eh], ax
		mov	[ecx+10h], al
		retn
sub_10016291	endp


; =============== S U B	R O U T	I N E =======================================


sub_100162B4	proc near		; CODE XREF: sub_100162B4+68p
					; sub_1001662E+53p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	edx, ecx
		push	8
		pop	esi
		movzx	eax, byte ptr [edi]
		imul	ecx, eax, 64h
		add	ecx, ds:off_1001B410
		mov	eax, [ecx+4]
		sub	eax, 3
		jz	short loc_100162EE
		dec	eax
		jz	short loc_100162E4
		dec	eax
		jnz	short loc_10016321
		cmp	[edx+0Bh], al
		setz	al
		mov	[edx+0Ah], al
		jmp	short loc_100162EE
; ---------------------------------------------------------------------------

loc_100162E4:				; CODE XREF: sub_100162B4+20j
		cmp	byte ptr [edx+0Dh], 0
		setz	al
		mov	[edx+0Ch], al

loc_100162EE:				; CODE XREF: sub_100162B4+1Dj
					; sub_100162B4+2Ej
		mov	al, [edi]
		cmp	al, 0F2h
		jnz	short loc_100162FA
		mov	byte ptr [edx+0Eh], 1
		jmp	short loc_1001630C
; ---------------------------------------------------------------------------

loc_100162FA:				; CODE XREF: sub_100162B4+3Ej
		cmp	al, 0F3h
		jnz	short loc_10016304
		mov	byte ptr [edx+0Fh], 1
		jmp	short loc_1001630C
; ---------------------------------------------------------------------------

loc_10016304:				; CODE XREF: sub_100162B4+48j
		cmp	al, 66h
		jnz	short loc_1001630C
		mov	byte ptr [edx+10h], 1

loc_1001630C:				; CODE XREF: sub_100162B4+44j
					; sub_100162B4+4Ej ...
		mov	esi, [ecx+4]
		mov	ecx, [esp+8+arg_4]
		push	ecx
		inc	dword ptr [ecx]
		lea	ecx, [edi+1]
		push	ecx
		mov	ecx, edx
		call	sub_100162B4

loc_10016321:				; CODE XREF: sub_100162B4+23j
		pop	edi
		mov	eax, esi
		pop	esi
		retn	8
sub_100162B4	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016328	proc near		; CODE XREF: sub_10016328+6Dp
					; sub_1001662E+7Fp

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ebx
		mov	ebx, [esp+4+arg_4]
		push	ebp
		mov	ebp, [esp+8+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	cl, ds:byte_1001B414[ebx*8]
		mov	al, [ebp+0]
		shr	al, cl
		and	al, ds:byte_1001B415[ebx*8]
		cmp	al, ds:byte_1001B416[ebx*8]
		jb	loc_1001642D
		cmp	al, ds:byte_1001B417[ebx*8]
		ja	loc_1001642D
		movzx	eax, al
		imul	esi, eax, 64h
		add	esi, ds:off_1001B410[ebx*8]
		cmp	dword ptr [esi+4], 0
		jnz	short loc_10016380
		and	dword ptr [edi], 0
		xor	eax, eax
		jmp	loc_10016432
; ---------------------------------------------------------------------------

loc_10016380:				; CODE XREF: sub_10016328+4Cj
		cmp	dword ptr [esi+4], 2
		jnz	short loc_100163A1
		mov	eax, [esp+10h+arg_8]
		mov	ecx, edi
		push	eax
		push	dword ptr [esi]
		inc	dword ptr [eax]
		lea	eax, [ebp+1]
		push	eax
		call	sub_10016328
		mov	eax, [edi]
		jmp	loc_10016432
; ---------------------------------------------------------------------------

loc_100163A1:				; CODE XREF: sub_10016328+5Cj
		cmp	byte ptr [esi+18h], 0
		jz	short loc_100163D4
		xor	eax, eax
		cmp	[edi+0Eh], al
		jz	short loc_100163B8
		cmp	[esi+30h], eax
		jz	short loc_100163B8
		add	esi, 1Ch
		jmp	short loc_100163D4
; ---------------------------------------------------------------------------

loc_100163B8:				; CODE XREF: sub_10016328+84j
					; sub_10016328+89j
		cmp	[edi+0Fh], al
		jz	short loc_100163C7
		cmp	[esi+48h], eax
		jz	short loc_100163C7
		add	esi, 34h
		jmp	short loc_100163D4
; ---------------------------------------------------------------------------

loc_100163C7:				; CODE XREF: sub_10016328+93j
					; sub_10016328+98j
		cmp	[edi+10h], al
		jz	short loc_100163D4
		cmp	[esi+60h], eax
		jz	short loc_100163D4
		add	esi, 4Ch

loc_100163D4:				; CODE XREF: sub_10016328+7Dj
					; sub_10016328+8Ej ...
		mov	eax, [esi+4]
		mov	ecx, edi
		mov	[edi], eax
		push	dword ptr [esi+8]
		call	sub_10016439
		push	dword ptr [esi+0Ch]
		call	sub_10016439
		push	dword ptr [esi+10h]
		call	sub_10016439
		cmp	ds:byte_1001B415[ebx*8], 0FFh
		jz	short loc_1001641A
		cmp	byte ptr [edi+8], 0
		jz	short loc_10016412
		push	[esp+10h+arg_8]
		push	ebp

loc_10016408:				; CODE XREF: sub_10016328+103j
		call	sub_100165A3

loc_1001640D:				; CODE XREF: sub_10016328+F0j
					; sub_10016328+FCj
		push	8
		pop	eax
		jmp	short loc_10016432
; ---------------------------------------------------------------------------

loc_10016412:				; CODE XREF: sub_10016328+D9j
		mov	eax, [esp+10h+arg_8]
		inc	dword ptr [eax]
		jmp	short loc_1001640D
; ---------------------------------------------------------------------------

loc_1001641A:				; CODE XREF: sub_10016328+D3j
		mov	eax, [esp+10h+arg_8]
		inc	dword ptr [eax]
		cmp	byte ptr [edi+8], 0
		jz	short loc_1001640D
		push	eax
		lea	eax, [ebp+1]
		push	eax
		jmp	short loc_10016408
; ---------------------------------------------------------------------------

loc_1001642D:				; CODE XREF: sub_10016328+28j
					; sub_10016328+35j
		xor	eax, eax
		inc	eax
		mov	[edi], eax

loc_10016432:				; CODE XREF: sub_10016328+53j
					; sub_10016328+74j ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		retn	0Ch
sub_10016328	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016439	proc near		; CODE XREF: sub_10016328+B6p
					; sub_10016328+BEp ...

arg_0		= dword	ptr  4

		mov	edx, [esp+arg_0]
		push	ebx
		xor	ebx, ebx
		inc	ebx
		test	edx, edx
		jz	loc_1001659D
		mov	eax, edx
		push	esi
		and	eax, 0FF0000h
		mov	esi, 0A0000h
		cmp	eax, esi
		jg	loc_10016565
		jz	short loc_100164AA
		cmp	eax, 20000h
		jz	loc_10016599
		cmp	eax, 30000h
		jz	loc_10016599
		cmp	eax, 40000h
		jz	loc_10016596
		cmp	eax, 60000h
		jz	loc_10016599
		cmp	eax, 70000h
		jz	short loc_100164AA
		cmp	eax, 80000h
		jz	short loc_100164AA
		cmp	eax, 90000h
		jz	loc_10016596
		jmp	loc_1001659C
; ---------------------------------------------------------------------------

loc_100164AA:				; CODE XREF: sub_10016439+25j
					; sub_10016439+58j ...
		and	edx, 0FF000000h
		mov	eax, 9000000h
		cmp	edx, eax
		jg	short loc_1001651F
		jz	loc_1001654F
		cmp	edx, 2000000h
		jz	short loc_1001651A
		cmp	edx, 3000000h
		jz	short loc_10016514
		cmp	edx, 4000000h
		jz	short loc_1001650B
		cmp	edx, 5000000h
		jz	short loc_100164F3
		cmp	edx, 6000000h
		jz	short loc_100164FC
		cmp	edx, 8000000h
		jnz	loc_1001659C

loc_100164F3:				; CODE XREF: sub_10016439+A4j
		add	dword ptr [ecx+4], 10h
		jmp	loc_1001659C
; ---------------------------------------------------------------------------

loc_100164FC:				; CODE XREF: sub_10016439+ACj
		cmp	byte ptr [ecx+0Ah], 0
		jz	short loc_1001650B

loc_10016502:				; CODE XREF: sub_10016439+ECj
		add	dword ptr [ecx+4], 6
		jmp	loc_1001659C
; ---------------------------------------------------------------------------

loc_1001650B:				; CODE XREF: sub_10016439+9Cj
					; sub_10016439+C7j ...
		add	dword ptr [ecx+4], 4
		jmp	loc_1001659C
; ---------------------------------------------------------------------------

loc_10016514:				; CODE XREF: sub_10016439+94j
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_1001655B

loc_1001651A:				; CODE XREF: sub_10016439+8Cj
		inc	dword ptr [ecx+4]
		jmp	short loc_1001659C
; ---------------------------------------------------------------------------

loc_1001651F:				; CODE XREF: sub_10016439+7Ej
		cmp	edx, 0A000000h
		jz	short loc_10016502
		cmp	edx, 0B000000h
		jz	short loc_10016561
		cmp	edx, 0D000000h
		jz	short loc_10016555
		cmp	edx, 0E000000h
		jz	short loc_1001655B
		cmp	edx, 0F000000h
		jz	short loc_1001654F
		cmp	edx, 10000000h
		jnz	short loc_1001659C

loc_1001654F:				; CODE XREF: sub_10016439+80j
					; sub_10016439+10Cj
		add	dword ptr [ecx+4], 8
		jmp	short loc_1001659C
; ---------------------------------------------------------------------------

loc_10016555:				; CODE XREF: sub_10016439+FCj
		cmp	byte ptr [ecx+0Ah], 0
		jnz	short loc_1001650B

loc_1001655B:				; CODE XREF: sub_10016439+DFj
					; sub_10016439+104j
		add	dword ptr [ecx+4], 2
		jmp	short loc_1001659C
; ---------------------------------------------------------------------------

loc_10016561:				; CODE XREF: sub_10016439+F4j
		xor	bl, bl
		jmp	short loc_1001659C
; ---------------------------------------------------------------------------

loc_10016565:				; CODE XREF: sub_10016439+1Fj
		cmp	eax, 0B0000h
		jz	short loc_10016599
		cmp	eax, 0C0000h
		jz	short loc_10016596
		cmp	eax, 0D0000h
		jz	short loc_10016599
		cmp	eax, 0E0000h
		jz	short loc_10016599
		cmp	eax, 0F0000h
		jz	short loc_10016599
		cmp	eax, 100000h
		jz	short loc_10016599
		cmp	eax, 110000h
		jnz	short loc_1001659C

loc_10016596:				; CODE XREF: sub_10016439+42j
					; sub_10016439+66j ...
		mov	[ecx+9], bl

loc_10016599:				; CODE XREF: sub_10016439+2Cj
					; sub_10016439+37j ...
		mov	[ecx+8], bl

loc_1001659C:				; CODE XREF: sub_10016439+6Cj
					; sub_10016439+B4j ...
		pop	esi

loc_1001659D:				; CODE XREF: sub_10016439+Aj
		mov	al, bl
		pop	ebx
		retn	4
sub_10016439	endp


; =============== S U B	R O U T	I N E =======================================


sub_100165A3	proc near		; CODE XREF: sub_10016328:loc_10016408p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	byte ptr [ecx+9], 0
		jnz	short loc_100165B1
		mov	eax, [esp+arg_4]
		inc	dword ptr [eax]
		jmp	short loc_10016629
; ---------------------------------------------------------------------------

loc_100165B1:				; CODE XREF: sub_100165A3+4j
		push	esi
		push	edi
		mov	edi, [esp+8+arg_0]
		mov	al, [edi]
		mov	dl, al
		and	al, 7
		shr	dl, 3
		and	dl, 18h
		or	al, dl
		shr	dl, 3
		cmp	byte ptr [ecx+0Ch], 0
		movzx	eax, al
		lea	esi, dword_1001ACD0[eax*8]
		jnz	short loc_100165DF
		lea	esi, dword_1001ABD0[eax*8]

loc_100165DF:				; CODE XREF: sub_100165A3+33j
		cmp	byte ptr [esi],	0
		jz	short loc_100165EA
		mov	eax, [esi+4]
		add	[ecx+4], eax

loc_100165EA:				; CODE XREF: sub_100165A3+3Fj
		cmp	byte ptr [esi+1], 0
		jz	short loc_10016621
		mov	esi, [esp+8+arg_4]
		mov	al, [edi+1]
		and	al, 7
		push	ebx
		inc	dword ptr [esi]
		mov	ebx, [esi]
		cmp	al, 5
		jnz	short loc_10016614
		movzx	eax, dl
		sub	eax, 0
		jz	short loc_10016610
		dec	eax
		jz	short loc_1001661C
		dec	eax
		jnz	short loc_10016614

loc_10016610:				; CODE XREF: sub_100165A3+65j
		add	dword ptr [ecx+4], 4

loc_10016614:				; CODE XREF: sub_100165A3+5Dj
					; sub_100165A3+6Bj ...
		lea	eax, [ebx+1]
		mov	[esi], eax
		pop	ebx
		jmp	short loc_10016627
; ---------------------------------------------------------------------------

loc_1001661C:				; CODE XREF: sub_100165A3+68j
		inc	dword ptr [ecx+4]
		jmp	short loc_10016614
; ---------------------------------------------------------------------------

loc_10016621:				; CODE XREF: sub_100165A3+4Bj
		mov	eax, [esp+8+arg_4]
		inc	dword ptr [eax]

loc_10016627:				; CODE XREF: sub_100165A3+77j
		pop	edi
		pop	esi

loc_10016629:				; CODE XREF: sub_100165A3+Cj
		mov	al, 1
		retn	8
sub_100165A3	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001662E	proc near		; CODE XREF: sub_10016763+7Fp

var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_9		= byte ptr -9
var_7		= byte ptr -7
arg_0		= dword	ptr  4

		sub	esp, 1Ch
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edi, ecx
		mov	ebp, edx
		test	edi, edi
		jz	loc_10016758
		test	ebp, ebp
		jz	loc_10016758
		mov	ebx, [esp+2Ch+arg_0]
		test	ebx, ebx
		jz	loc_10016758
		lea	ecx, [esp+2Ch+var_14]
		mov	[esp+2Ch+var_9], 1
		mov	[esp+2Ch+var_7], 1
		call	sub_10016291
		xor	esi, esi

loc_1001666A:				; CODE XREF: sub_1001662E+BBj
		lea	ecx, [esp+2Ch+var_14]
		lea	edx, [esi+edi]
		call	sub_10016291
		and	[esp+2Ch+var_1C], 0
		lea	eax, [esp+2Ch+var_1C]
		push	eax
		push	edx
		call	sub_100162B4
		cmp	eax, 1
		jz	loc_10016754
		mov	eax, [esp+2Ch+var_1C]
		lea	ecx, [esi+edi]
		and	[esp+2Ch+var_1C], 0
		add	eax, ecx
		lea	ecx, [esp+2Ch+var_1C]
		mov	[esp+2Ch+var_18], eax
		push	ecx
		push	0
		push	eax
		lea	ecx, [esp+38h+var_14]
		call	sub_10016328
		mov	ecx, [esp+2Ch+var_14]
		cmp	ecx, 1
		jz	short loc_100166D4
		test	ecx, ecx
		jz	short loc_100166D4
		mov	eax, [esp+2Ch+var_10]
		lea	edx, [esi+edi]
		sub	eax, edx
		add	eax, [esp+2Ch+var_1C]
		add	eax, [esp+2Ch+var_18]
		add	esi, eax
		jmp	short loc_100166D7
; ---------------------------------------------------------------------------

loc_100166D4:				; CODE XREF: sub_1001662E+8Bj
					; sub_1001662E+8Fj
		xor	ecx, ecx
		inc	ecx

loc_100166D7:				; CODE XREF: sub_1001662E+A4j
		cmp	ecx, 6
		jz	short loc_1001674F
		cmp	ecx, 7
		jz	short loc_1001674B
		cmp	ecx, 8
		jnz	short loc_10016754
		cmp	esi, 5
		jb	loc_1001666A
		lea	eax, [esi+5]
		cmp	eax, 20h
		jbe	short loc_100166FB
		push	2
		jmp	short loc_10016751
; ---------------------------------------------------------------------------

loc_100166FB:				; CODE XREF: sub_1001662E+C7j
		test	esi, esi
		jz	short loc_10016714
		mov	edx, edi
		mov	ecx, ebx
		sub	edx, ebx
		mov	ebx, esi

loc_10016707:				; CODE XREF: sub_1001662E+E0j
		mov	al, [ecx+edx]
		mov	[ecx], al
		inc	ecx
		dec	ebx
		jnz	short loc_10016707
		mov	ebx, [esp+2Ch+arg_0]

loc_10016714:				; CODE XREF: sub_1001662E+CFj
		mov	eax, edi
		mov	byte ptr [esi+ebx], 0E9h
		sub	eax, ebx
		sub	ebp, edi
		sub	eax, 5
		sub	ebp, 5
		mov	[esi+ebx+1], eax
		mov	byte ptr [edi],	0E9h
		mov	[edi+1], ebp
		cmp	esi, 5
		jbe	short loc_10016747
		add	edi, 5
		add	esi, 0FFFFFFFBh
		jz	short loc_10016747
		push	esi		; size_t
		push	0FFFFFFCCh	; int
		push	edi		; void *
		call	memset
		add	esp, 0Ch

loc_10016747:				; CODE XREF: sub_1001662E+103j
					; sub_1001662E+10Bj
		xor	eax, eax
		jmp	short loc_1001675B
; ---------------------------------------------------------------------------

loc_1001674B:				; CODE XREF: sub_1001662E+B1j
		push	4
		jmp	short loc_10016751
; ---------------------------------------------------------------------------

loc_1001674F:				; CODE XREF: sub_1001662E+ACj
		push	3

loc_10016751:				; CODE XREF: sub_1001662E+CBj
					; sub_1001662E+11Fj ...
		pop	eax
		jmp	short loc_1001675B
; ---------------------------------------------------------------------------

loc_10016754:				; CODE XREF: sub_1001662E+5Bj
					; sub_1001662E+B6j
		push	5
		jmp	short loc_10016751
; ---------------------------------------------------------------------------

loc_10016758:				; CODE XREF: sub_1001662E+Dj
					; sub_1001662E+15j ...
		xor	eax, eax
		inc	eax

loc_1001675B:				; CODE XREF: sub_1001662E+11Bj
					; sub_1001662E+124j
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 1Ch
		retn
sub_1001662E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016763	proc near		; CODE XREF: sub_1001682B+65p
					; DATA XREF: .rdata:1002C274o

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		sub	esp, 10h
		push	ebx
		mov	ebx, [esp+14h+arg_14]
		push	esi
		mov	esi, [esp+18h+arg_18]
		push	edi
		push	esi
		push	ebx
		push	[esp+24h+arg_10]
		mov	edi, ecx
		push	[esp+28h+arg_C]
		push	[esp+2Ch+arg_8]
		mov	eax, [edi]
		push	[esp+30h+arg_4]
		push	[esp+34h+arg_0]
		call	dword ptr [eax+14h]
		test	eax, eax
		js	loc_1001681E
		push	ebp
		push	dword ptr [edi+8]
		lea	eax, [esi-20h]
		push	ebx
		push	eax
		lea	ebp, [ebx+20h]
		push	ebp
		call	sub_10012A7E
		test	al, al
		jnz	short loc_100167B3
		mov	eax, 0C0000023h
		jmp	short loc_1001681D
; ---------------------------------------------------------------------------

loc_100167B3:				; CODE XREF: sub_10016763+47j
		push	ecx
		xor	eax, eax
		lea	ecx, [esp+24h+var_10]
		push	20h
		push	dword ptr [edi+4]
		mov	[esp+2Ch+var_10], al
		mov	[esp+2Ch+var_C], eax
		mov	[esp+2Ch+var_8], eax
		mov	[esp+2Ch+var_4], eax
		call	sub_10014267
		mov	esi, eax
		test	esi, esi
		js	short loc_10016812
		push	ecx
		push	ecx
		mov	ecx, [edi+4]
		mov	edx, ebp
		push	ebx
		call	sub_1001662E
		add	esp, 0Ch
		cmp	eax, 2
		jnz	short loc_100167F6
		mov	esi, 0C0000023h
		jmp	short loc_10016812
; ---------------------------------------------------------------------------

loc_100167F6:				; CODE XREF: sub_10016763+8Aj
		test	eax, eax
		jz	short loc_10016801
		mov	esi, 0C0000001h
		jmp	short loc_10016812
; ---------------------------------------------------------------------------

loc_10016801:				; CODE XREF: sub_10016763+95j
		mov	ebx, [esp+20h+arg_1C]
		test	ebx, ebx
		jz	short loc_10016812
		mov	edx, [edi]
		mov	ecx, edi
		call	dword ptr [edx+10h]
		mov	[ebx], eax

loc_10016812:				; CODE XREF: sub_10016763+75j
					; sub_10016763+91j ...
		lea	ecx, [esp+20h+var_10]
		call	sub_10009A2B
		mov	eax, esi

loc_1001681D:				; CODE XREF: sub_10016763+4Ej
		pop	ebp

loc_1001681E:				; CODE XREF: sub_10016763+2Dj
		pop	edi
		pop	esi
		pop	ebx
		add	esp, 10h
		retn	20h
sub_10016763	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016827	proc near		; DATA XREF: .rdata:1002C280o
		push	3Eh
		pop	eax
		retn
sub_10016827	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001682B	proc near		; DATA XREF: .rdata:1002C244o

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h

		push	ebp
		push	esi
		mov	esi, ecx
		mov	eax, [esi]
		call	dword ptr [eax+10h]
		mov	ebp, [esp+8+arg_18]
		cmp	ebp, eax
		jnb	short loc_10016843
		mov	eax, 0C0000023h
		jmp	short loc_100168BD
; ---------------------------------------------------------------------------

loc_10016843:				; CODE XREF: sub_1001682B+Fj
		mov	eax, [esp+8+arg_10]
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	edi
		mov	edi, [esp+10h+arg_14]
		mov	[edi], ebx
		test	eax, eax
		jz	short loc_1001685C
		mov	[edi+4], eax
		jmp	short loc_10016873
; ---------------------------------------------------------------------------

loc_1001685C:				; CODE XREF: sub_1001682B+2Aj
		mov	edx, [esi]
		lea	eax, [edi+4]
		push	eax
		push	[esp+14h+arg_C]
		mov	ecx, esi
		push	[esp+18h+arg_4]
		call	dword ptr [edx+8]
		test	eax, eax
		js	short loc_100168BB

loc_10016873:				; CODE XREF: sub_1001682B+2Fj
		push	0
		lea	eax, [ebp-8]
		mov	ecx, esi
		push	eax
		lea	eax, [edi+8]
		mov	ebp, offset loc_100168C6
		push	eax
		push	ebp
		push	0
		push	[esp+24h+arg_8]
		push	[esp+28h+arg_4]
		push	ebx
		call	sub_10016763
		mov	ebx, eax
		test	ebx, ebx
		js	short loc_100168B9
		push	ebp
		push	edi
		push	1Eh
		lea	eax, [edi+28h]
		push	eax
		call	sub_10012A7E
		mov	edi, [esp+10h+arg_1C]
		test	edi, edi
		jz	short loc_100168B9
		mov	eax, [esi]
		mov	ecx, esi
		call	dword ptr [eax+10h]
		mov	[edi], eax

loc_100168B9:				; CODE XREF: sub_1001682B+6Ej
					; sub_1001682B+83j
		mov	eax, ebx

loc_100168BB:				; CODE XREF: sub_1001682B+46j
		pop	edi
		pop	ebx

loc_100168BD:				; CODE XREF: sub_1001682B+16j
		pop	esi
		pop	ebp
		retn	20h
sub_1001682B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100168C2	proc near		; DATA XREF: .rdata:1002C250o
		push	46h
		pop	eax
		retn
sub_100168C2	endp

; ---------------------------------------------------------------------------

loc_100168C6:				; DATA XREF: sub_1001682B+53o
		push	eax
		push	eax
		push	ebx
		push	ecx
		push	edx
		mov	ebx, [esp+18h]
		mov	edx, [esp+14h]
		mov	eax, [ebx]
		push	edx
		push	eax
		call	sub_10016909
		add	esp, 8
		test	eax, eax
		lea	edx, [ebx+8]
		jz	short loc_100168F9
		mov	ecx, [esp+14h]
		mov	[esp+18h], ecx
		mov	[esp+10h], edx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn	4
; ---------------------------------------------------------------------------

loc_100168F9:				; CODE XREF: .text:100168E4j
		mov	ecx, [ebx+4]
		mov	[esp+18h], edx
		mov	[esp+10h], ecx
		pop	edx
		pop	ecx
		pop	ebx
		pop	eax
		retn

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016909	proc near		; CODE XREF: .text:100168D7p

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		mov	eax, [ebp+arg_0]
		lea	ecx, [ebp+var_8]
		push	[ebp+arg_4]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], eax
		call	sub_100056BC
		test	eax, eax
		setnz	al
		mov	esp, ebp
		pop	ebp
		retn
sub_10016909	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001692F	proc near		; DATA XREF: .rdata:1002D8A0o

arg_0		= byte ptr  4

		push	esi
		mov	esi, ecx
		mov	dword ptr [esi], offset	off_1002D898
		call	sub_10009B6C
		test	[esp+4+arg_0], 1
		jz	short loc_1001694C
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_1001694C:				; CODE XREF: sub_1001692F+13j
		mov	eax, esi
		pop	esi
		retn	4
sub_1001692F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10016952	proc near		; DATA XREF: .rdata:1002D89Co

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		cmp	[esp+arg_4], 0Eh
		jnz	short loc_10016984
		mov	eax, offset _TargetNtCreateEvent@24 ; TargetNtCreateEvent(x,x,x,x,x,x)
		test	eax, eax
		jz	short loc_10016980
		mov	ecx, [esp+arg_0]
		push	14h		; int
		push	offset a_targetntcre_4 ; "_TargetNtCreateEvent@24"
		push	1		; int
		push	offset aNtcreateevent ;	"NtCreateEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000D8D2
		jmp	short locret_100169C0
; ---------------------------------------------------------------------------

loc_10016980:				; CODE XREF: sub_10016952+Ej
		xor	al, al
		jmp	short locret_100169C0
; ---------------------------------------------------------------------------

loc_10016984:				; CODE XREF: sub_10016952+5j
		cmp	[esp+arg_4], 0Fh
		push	ebx
		jnz	short loc_100169BB
		xor	ebx, ebx
		mov	eax, offset _TargetNtOpenEvent@16 ; TargetNtOpenEvent(x,x,x,x)
		inc	ebx
		test	eax, eax
		jz	short loc_100169B5
		mov	ecx, [esp+4+arg_0]
		push	15h		; int
		push	offset a_targetntop_14 ; "_TargetNtOpenEvent@16"
		push	ebx		; int
		push	offset aNtopenevent ; "NtOpenEvent"
		push	offset aNtdll_dll_6 ; "ntdll.dll"
		call	sub_1000D8D2
		jmp	short loc_100169B7
; ---------------------------------------------------------------------------

loc_100169B5:				; CODE XREF: sub_10016952+44j
		xor	al, al

loc_100169B7:				; CODE XREF: sub_10016952+61j
		test	al, al
		jnz	short loc_100169BD

loc_100169BB:				; CODE XREF: sub_10016952+38j
		xor	ebx, ebx

loc_100169BD:				; CODE XREF: sub_10016952+67j
		mov	al, bl
		pop	ebx

locret_100169C0:			; CODE XREF: sub_10016952+2Cj
					; sub_10016952+30j
		retn	8
sub_10016952	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100169C3	proc near		; DATA XREF: .rdata:1002D8F8o

TargetHandle	= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 1Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+1Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_100169EA
		mov	eax, [esi]
		jmp	short loc_100169EC
; ---------------------------------------------------------------------------

loc_100169EA:				; CODE XREF: sub_100169C3+21j
		mov	eax, esi

loc_100169EC:				; CODE XREF: sub_100169C3+25j
		mov	ecx, [ecx+10h]
		xor	ebx, ebx
		mov	[esp+28h+var_14], eax
		inc	ebx
		lea	eax, [esp+28h+var_14]
		mov	[esp+28h+var_10], ebx
		mov	[esp+28h+var_8], eax
		lea	eax, [esp+28h+var_10]
		push	eax
		push	0Eh
		mov	[esp+30h+var_C], ebx
		call	sub_10015070
		mov	edx, [edi+4]
		lea	ecx, [esp+28h+TargetHandle]
		and	[esp+28h+TargetHandle],	0
		push	ecx		; lpTargetHandle
		push	[ebp+arg_C]	; int
		mov	ecx, eax
		push	[ebp+arg_8]	; int
		push	esi		; int
		call	sub_100173BA
		mov	ecx, [esp+38h+TargetHandle]
		add	esp, 10h
		mov	[edi+18h], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[edi+10h], eax
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_100169C3	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016A50	proc near		; DATA XREF: .rdata:1002D8CCo

TargetHandle	= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 20h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+20h+var_4], eax
		push	esi
		mov	esi, [ebp+arg_4]
		mov	edx, ecx
		push	edi
		mov	edi, [ebp+arg_0]
		cmp	dword ptr [esi+14h], 8
		jb	short loc_10016A78
		mov	eax, [esi]
		jmp	short loc_10016A7A
; ---------------------------------------------------------------------------

loc_10016A78:				; CODE XREF: sub_10016A50+22j
		mov	eax, esi

loc_10016A7A:				; CODE XREF: sub_10016A50+26j
		xor	ecx, ecx
		mov	[esp+28h+var_1C], eax
		mov	[esp+28h+var_18], 2
		lea	eax, [esp+28h+var_14]
		inc	ecx

loc_10016A8D:				; CODE XREF: sub_10016A50+48j
		and	dword ptr [eax], 0
		lea	eax, [eax+8]
		and	dword ptr [eax-4], 0
		dec	ecx
		jns	short loc_10016A8D
		mov	ecx, [edx+10h]
		lea	eax, [esp+28h+var_1C]
		mov	[esp+28h+var_10], eax
		lea	eax, [ebp+arg_8]
		mov	[esp+28h+var_8], eax
		lea	eax, [esp+28h+var_18]
		push	eax
		push	0Fh
		mov	[esp+30h+var_14], 1
		mov	[esp+30h+var_C], 2
		call	sub_10015070
		mov	edx, [edi+4]
		lea	ecx, [esp+28h+TargetHandle]
		and	[esp+28h+TargetHandle],	0
		push	ecx		; lpTargetHandle
		push	[ebp+arg_8]	; int
		mov	ecx, eax
		push	esi		; int
		call	sub_10017479
		mov	ecx, [esp+34h+TargetHandle]
		add	esp, 0Ch
		mov	[edi+18h], ecx
		mov	ecx, [esp+28h+var_4]
		mov	[edi+10h], eax
		mov	al, 1
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10016A50	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016B02	proc near		; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+E2p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= byte ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 18h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+18h+var_4], eax
		and	[esp+18h+var_10], 0
		push	esi
		mov	esi, [ebp+arg_8]
		push	edi
		mov	[esp+20h+var_18], ecx
		xor	edi, edi
		lea	ecx, [esp+20h+var_18]
		mov	[esp+20h+var_14], edx
		inc	edi
		mov	[esp+20h+var_8], ecx
		push	0Eh
		lea	edx, [esp+24h+var_10]
		mov	[esp+24h+var_10], edi
		pop	ecx
		mov	[esp+20h+var_C], edi
		call	sub_10010168
		test	al, al
		jnz	short loc_10016B4F
		mov	eax, edi
		jmp	short loc_10016B7A
; ---------------------------------------------------------------------------

loc_10016B4F:				; CODE XREF: sub_10016B02+47j
		mov	ecx, [ebp+arg_4]
		push	esi		; int
		mov	[esp+24h+var_10], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		lea	ecx, [esp+24h+var_10]
		mov	[esp+24h+var_C], eax
		lea	eax, [esp+24h+var_14]
		push	eax		; void *
		lea	eax, [ebp+arg_0]
		push	eax		; void *
		lea	eax, [esp+2Ch+var_18]
		push	eax		; int
		call	sub_10016EBD
		add	esp, 10h

loc_10016B7A:				; CODE XREF: sub_10016B02+4Bj
		mov	ecx, [esp+20h+var_4]
		pop	edi
		pop	esi
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10016B02	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10016B8B	proc near		; CODE XREF: TargetNtOpenEvent(x,x,x,x)+D6p

var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_4], eax
		push	ebx
		push	esi
		mov	esi, [ebp+arg_4]
		lea	eax, [esp+34h+var_14]
		push	edi
		mov	[esp+38h+var_24], edx
		xor	edi, edi
		xor	edx, edx
		mov	[esp+38h+var_28], ecx
		push	2
		pop	ebx
		inc	edi
		mov	[esp+38h+var_20], edx
		mov	[esp+38h+var_18], ebx
		mov	ecx, edi

loc_10016BC3:				; CODE XREF: sub_10016B8B+41j
		dec	ecx
		mov	[eax], edx
		mov	[eax+4], edx
		lea	eax, [eax+8]
		jns	short loc_10016BC3
		lea	ecx, [esp+38h+var_24]
		mov	[esp+38h+var_14], edi
		lea	eax, [esp+38h+var_28]
		mov	[esp+38h+var_8], ecx
		push	0Fh
		lea	edx, [esp+3Ch+var_18]
		mov	[esp+3Ch+var_10], eax
		pop	ecx
		mov	[esp+38h+var_C], ebx
		call	sub_10010168
		test	al, al
		jnz	short loc_10016BFA
		mov	eax, edi
		jmp	short loc_10016C21
; ---------------------------------------------------------------------------

loc_10016BFA:				; CODE XREF: sub_10016B8B+69j
		mov	ecx, [ebp+arg_0]
		push	esi		; int
		mov	[esp+3Ch+var_20], ecx
		mov	eax, [ecx+8]
		add	eax, ecx
		lea	ecx, [esp+3Ch+var_20]
		mov	[esp+3Ch+var_1C], eax
		lea	eax, [esp+3Ch+var_24]
		push	eax		; void *
		lea	eax, [esp+40h+var_28]
		push	eax		; int
		call	sub_10016F77
		add	esp, 0Ch

loc_10016C21:				; CODE XREF: sub_10016B8B+6Dj
		mov	ecx, [esp+38h+var_4]
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10016B8B	endp

; Exported entry  22. _TargetNtCreateEvent@24

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtCreateEvent(x, x, x, x, x, x)
		public _TargetNtCreateEvent@24
_TargetNtCreateEvent@24	proc near	; DATA XREF: sub_10016952+7o
					; .rdata:off_1002E058o

var_6C		= dword	ptr -6Ch
var_68		= byte ptr -68h
var_64		= dword	ptr -64h
var_5C		= dword	ptr -5Ch
var_38		= byte ptr -38h
var_34		= dword	ptr -34h
var_20		= byte ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h
arg_14		= dword	ptr  1Ch

		push	5Ch
		push	offset stru_1002DF88
		call	__SEH_prolog4
		push	[ebp+arg_14]
		push	[ebp+arg_10]
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+arg_8]
		mov	edi, [ebp+arg_4]
		push	edi
		call	[ebp+arg_0]
		mov	ebx, eax
		mov	[ebp+var_1C], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10016D76
		test	esi, esi
		jz	loc_10016D76
		mov	edx, [esi+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreatevent ; "NtCreatEvent"
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_10016C93
		mov	eax, ebx
		jmp	loc_10016D76
; ---------------------------------------------------------------------------

loc_10016C93:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+57j
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_10016D74
		call	sub_10013DEB
		mov	[ebp+arg_0], eax
		test	eax, eax
		jz	loc_10016D74
		push	6
		pop	ecx
		lea	edi, [ebp+var_38]
		rep movsd
		xor	esi, esi
		mov	[ebp+var_34], esi
		mov	[ebp+arg_8], esi
		push	esi
		lea	eax, [ebp+var_20]
		push	eax
		lea	edx, [ebp+arg_8]
		lea	ecx, [ebp+var_38]
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_10016D74
		mov	edi, [ebp+arg_8]
		test	edi, edi
		jz	loc_10016D74
		mov	[ebp+var_6C], esi
		push	30h		; size_t
		push	esi		; int
		lea	eax, [ebp+var_68]
		push	eax		; void *
		call	memset
		mov	[ebp+var_64], 0C0000022h
		lea	eax, [ebp+var_6C]
		push	eax
		push	[ebp+arg_0]
		push	[ebp+arg_10]
		mov	eax, [ebp+arg_14]
		movzx	edx, al
		mov	ecx, edi
		call	sub_10016B02
		add	esp, 18h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, edi
		call	sub_10014324
		test	esi, esi
		jz	short loc_10016D31
		mov	ebx, [ebp+var_64]
		jmp	short loc_10016D74
; ---------------------------------------------------------------------------

loc_10016D31:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+F7j
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+var_5C]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebp+arg_C]
		mov	edx, [edx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtcreateevent ; "NtCreateEvent"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_10016D74
; ---------------------------------------------------------------------------

loc_10016D63:				; DATA XREF: .rdata:stru_1002DF88o
		xor	eax, eax	; Exception filter 0 for function 10016C33
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10016D67:				; DATA XREF: .rdata:stru_1002DF88o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10016C33
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_1C]

loc_10016D74:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+6Fj
					; TargetNtCreateEvent(x,x,x,x,x,x)+7Fj	...
		mov	eax, ebx

loc_10016D76:				; CODE XREF: TargetNtCreateEvent(x,x,x,x,x,x)+2Bj
					; TargetNtCreateEvent(x,x,x,x,x,x)+33j	...
		call	__SEH_epilog4
		retn	18h
_TargetNtCreateEvent@24	endp

; Exported entry  26. _TargetNtOpenEvent@16

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtOpenEvent(x, x, x, x)
		public _TargetNtOpenEvent@16
_TargetNtOpenEvent@16 proc near		; DATA XREF: sub_10016952+3Co
					; .rdata:off_1002E058o

var_70		= dword	ptr -70h
var_6C		= byte ptr -6Ch
var_68		= dword	ptr -68h
var_60		= dword	ptr -60h
var_3C		= byte ptr -3Ch
var_38		= dword	ptr -38h
var_24		= byte ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h

		push	60h
		push	offset stru_1002DFA8
		call	__SEH_prolog4
		mov	esi, [ebp+arg_C]
		push	esi
		push	[ebp+arg_8]
		mov	edi, [ebp+arg_4]
		push	edi
		call	[ebp+arg_0]
		mov	ebx, eax
		mov	[ebp+var_1C], ebx
		cmp	ebx, 0C0000022h
		jnz	loc_10016EB5
		test	esi, esi
		jz	loc_10016EB5
		mov	edx, [esi+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002A69
		pop	ecx
		call	sub_10013CCD
		cmp	dword ptr [eax+4], 1
		jg	short loc_10016DD8
		mov	eax, ebx
		jmp	loc_10016EB5
; ---------------------------------------------------------------------------

loc_10016DD8:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+51j
		push	1
		push	4
		pop	edx
		mov	ecx, edi
		call	sub_10013E44
		pop	ecx
		test	al, al
		jz	loc_10016EB3
		call	sub_10013DEB
		mov	[ebp+var_20], eax
		test	eax, eax
		jz	loc_10016EB3
		push	6
		pop	ecx
		lea	edi, [ebp+var_3C]
		rep movsd
		xor	esi, esi
		mov	[ebp+var_38], esi
		mov	[ebp+arg_0], esi
		push	esi
		lea	eax, [ebp+var_24]
		push	eax
		lea	edx, [ebp+arg_0]
		lea	ecx, [ebp+var_3C]
		call	sub_10013F01
		pop	ecx
		pop	ecx
		test	eax, eax
		js	loc_10016EB3
		mov	edi, [ebp+arg_0]
		test	edi, edi
		jz	loc_10016EB3
		mov	[ebp+var_70], esi
		push	30h		; size_t
		push	esi		; int
		lea	eax, [ebp+var_6C]
		push	eax		; void *
		call	memset
		mov	[ebp+var_68], 0C0000022h
		lea	eax, [ebp+var_70]
		push	eax
		push	[ebp+var_20]
		mov	edx, [ebp+arg_8]
		mov	ecx, edi
		call	sub_10016B8B
		add	esp, 14h
		mov	esi, eax
		xor	edx, edx
		mov	ecx, edi
		call	sub_10014324
		test	esi, esi
		jz	short loc_10016E70
		mov	ebx, [ebp+var_68]
		jmp	short loc_10016EB3
; ---------------------------------------------------------------------------

loc_10016E70:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+EBj
		and	[ebp+ms_exc.registration.TryLevel], 0
		mov	eax, [ebp+var_60]
		mov	ecx, [ebp+arg_4]
		mov	[ecx], eax
		xor	ebx, ebx
		mov	[ebp+var_1C], ebx
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	edx, [ebp+arg_C]
		mov	edx, [edx+8]
		movzx	eax, word ptr [edx]
		push	eax
		mov	edx, [edx+4]
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		call	sub_10002B65
		pop	ecx
		jmp	short loc_10016EB3
; ---------------------------------------------------------------------------

loc_10016EA2:				; DATA XREF: .rdata:stru_1002DFA8o
		xor	eax, eax	; Exception filter 0 for function 10016D7E
		inc	eax
		retn
; ---------------------------------------------------------------------------

loc_10016EA6:				; DATA XREF: .rdata:stru_1002DFA8o
		mov	esp, [ebp+ms_exc.old_esp] ; Exception handler 0	for function 10016D7E
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		mov	ebx, [ebp+var_1C]

loc_10016EB3:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+69j
					; TargetNtOpenEvent(x,x,x,x)+79j ...
		mov	eax, ebx

loc_10016EB5:				; CODE XREF: TargetNtOpenEvent(x,x,x,x)+25j
					; TargetNtOpenEvent(x,x,x,x)+2Dj ...
		call	__SEH_epilog4
		retn	10h
_TargetNtOpenEvent@16 endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016EBD(int,	void *,	void *,	int)
sub_10016EBD	proc near		; CODE XREF: sub_10016B02+70p

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10016ED5
		push	4
		pop	eax
		jmp	loc_10016F73
; ---------------------------------------------------------------------------

loc_10016ED5:				; CODE XREF: sub_10016EBD+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 0Eh
		inc	ebp
		mov	dword ptr [edi+3Ch], 3
		push	ebp		; int
		mov	dword ptr [edi+44h], 70h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_1000B0F3
		test	al, al
		jnz	short loc_10016F1C
		push	4
		pop	eax
		jmp	short loc_10016F71
; ---------------------------------------------------------------------------

loc_10016F1C:				; CODE XREF: sub_10016EBD+58j
		push	2		; int
		push	0		; char
		push	4
		pop	esi
		push	esi		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_10016F6F
		push	2		; int
		push	0		; char
		push	esi		; size_t
		push	[esp+20h+arg_8]	; void *
		mov	ecx, edi
		push	2		; int
		call	sub_1000B0F3
		test	al, al
		jz	short loc_10016F6F
		push	[esp+14h+arg_C]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10016F6F
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10016F6F:				; CODE XREF: sub_10016EBD+75j
					; sub_10016EBD+8Bj ...
		mov	eax, esi

loc_10016F71:				; CODE XREF: sub_10016EBD+5Dj
		pop	esi
		pop	ebp

loc_10016F73:				; CODE XREF: sub_10016EBD+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10016EBD	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10016F77(int,	void *,	int)
sub_10016F77	proc near		; CODE XREF: sub_10016B8B+8Ep

var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch

		push	ecx
		push	ebx
		push	edi
		mov	ebx, ecx
		call	sub_100159C9
		mov	edi, eax
		test	edi, edi
		jnz	short loc_10016F8F
		push	4
		pop	eax
		jmp	loc_10017015
; ---------------------------------------------------------------------------

loc_10016F8F:				; CODE XREF: sub_10016F77+Ej
		and	dword ptr [edi+4], 0
		lea	ecx, [esp+0Ch+var_4]
		push	ebp
		push	esi
		mov	esi, [esp+14h+arg_0]
		xor	ebp, ebp
		mov	dword ptr [edi], 0Fh
		inc	ebp
		mov	dword ptr [edi+3Ch], 2
		push	ebp		; int
		mov	dword ptr [edi+44h], 64h
		mov	esi, [esi]
		push	0		; char
		mov	[esp+1Ch+var_4], esi
		call	sub_1000A366
		push	eax		; size_t
		push	esi		; void *
		push	0		; int
		mov	ecx, edi
		call	sub_100118CF
		test	al, al
		jz	short loc_10016FE7
		push	2		; int
		push	0		; char
		push	4		; size_t
		push	[esp+20h+arg_4]	; void *
		mov	ecx, edi
		push	ebp		; int
		call	sub_100118CF
		test	al, al
		jnz	short loc_10016FEC

loc_10016FE7:				; CODE XREF: sub_10016F77+58j
		push	4
		pop	eax
		jmp	short loc_10017013
; ---------------------------------------------------------------------------

loc_10016FEC:				; CODE XREF: sub_10016F77+6Ej
		push	[esp+14h+arg_8]
		mov	ecx, ebx
		push	edi
		call	sub_10015A42
		mov	esi, eax
		cmp	esi, 0Ah
		jz	short loc_10017011
		sub	edi, [ebx+4]
		mov	eax, [ebx]
		shr	edi, 0Ah
		add	eax, 0Ch
		imul	edx, edi, 14h
		add	eax, edx
		xchg	ebp, [eax]

loc_10017011:				; CODE XREF: sub_10016F77+86j
		mov	eax, esi

loc_10017013:				; CODE XREF: sub_10016F77+73j
		pop	esi
		pop	ebp

loc_10017015:				; CODE XREF: sub_10016F77+13j
		pop	edi
		pop	ebx
		pop	ecx
		retn
sub_10016F77	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017019(void	*)
sub_10017019	proc near		; CODE XREF: sub_100171B6+8Bp

var_64		= dword	ptr -64h
var_60		= dword	ptr -60h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= dword	ptr -4Ch
var_48		= dword	ptr -48h
var_44		= dword	ptr -44h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= dword	ptr -38h
var_34		= dword	ptr -34h
var_30		= byte ptr -30h
var_18		= byte ptr -18h
arg_0		= dword	ptr  4

		sub	esp, 68h
		push	ebx
		push	ebp
		push	esi
		xor	ebp, ebp
		mov	ebx, edx
		mov	esi, ecx
		mov	[esp+74h+var_4C], ebp
		push	edi
		lea	edx, [esp+78h+var_50]
		mov	[esp+78h+var_50], ebp
		mov	ecx, offset aNtopendirector ; "NtOpenDirectoryObject"
		call	sub_10018835
		lea	edx, [esp+78h+var_54]
		mov	[esp+78h+var_54], ebp
		mov	ecx, offset aNtquerysymboli ; "NtQuerySymbolicLinkObject"
		call	sub_10018835
		lea	edx, [esp+78h+var_4C]
		mov	[esp+78h+var_4C], ebp
		mov	ecx, offset aNtopensymbolic ; "NtOpenSymbolicLinkObject"
		call	sub_10018835
		lea	edx, [esp+78h+var_5C]
		mov	[esp+78h+var_5C], ebp
		mov	ecx, offset aNtclose ; "NtClose"
		call	sub_10018835
		push	6
		pop	ecx
		xor	eax, eax
		mov	[esp+78h+var_40], ebp
		lea	edi, [esp+78h+var_30]
		mov	[esp+78h+var_3C], ebp
		rep stosd
		lea	eax, [esp+78h+var_40]
		mov	ecx, esi
		push	eax
		lea	eax, [esp+7Ch+var_30]
		push	eax
		push	ebp
		push	40h
		pop	edx
		call	sub_10015438
		add	esp, 0Ch
		mov	[esp+78h+var_58], ebp
		lea	eax, [esp+78h+var_30]
		push	eax
		push	1
		lea	eax, [esp+80h+var_58]
		push	eax
		call	[esp+84h+var_50]
		test	eax, eax
		jnz	loc_100171AE
		push	6
		pop	ecx
		lea	edi, [esp+78h+var_18]
		mov	[esp+78h+var_38], ebp
		rep stosd
		lea	eax, [esp+78h+var_38]
		mov	[esp+78h+var_34], ebp
		push	eax
		lea	eax, [esp+7Ch+var_18]
		mov	ecx, ebx
		push	eax
		push	[esp+80h+var_58]
		push	40h
		pop	edx
		call	sub_10015438
		add	esp, 0Ch
		mov	[esp+78h+var_64], ebp
		lea	eax, [esp+78h+var_18]
		push	eax
		push	80000000h
		lea	eax, [esp+80h+var_64]
		push	eax
		call	[esp+84h+var_4C]
		push	[esp+78h+var_58]
		mov	esi, eax
		call	[esp+7Ch+var_5C]
		test	esi, esi
		jnz	loc_100171AC
		lea	eax, [esp+78h+var_60]
		mov	[esp+78h+var_48], ebp
		push	eax
		lea	eax, [esp+7Ch+var_48]
		mov	[esp+7Ch+var_44], ebp
		push	eax
		push	[esp+80h+var_64]
		mov	[esp+84h+var_60], ebp
		call	[esp+84h+var_54]
		mov	esi, eax
		cmp	esi, 0C0000023h
		jz	short loc_10017140
		push	[esp+78h+var_64]
		call	[esp+7Ch+var_5C]
		jmp	short loc_100171AC
; ---------------------------------------------------------------------------

loc_10017140:				; CODE XREF: sub_10017019+11Bj
		xor	eax, eax
		xor	ecx, ecx
		mov	word ptr [esp+78h+var_48], ax
		mov	eax, [esp+78h+var_60]
		mov	word ptr [esp+78h+var_48+2], ax
		movzx	eax, ax
		push	2
		inc	eax
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		pop	ecx
		mov	[esp+78h+var_44], eax
		lea	eax, [esp+78h+var_60]
		push	eax
		lea	eax, [esp+7Ch+var_48]
		push	eax
		push	[esp+80h+var_64]
		call	[esp+84h+var_54]
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10017199
		push	[esp+78h+var_60] ; int
		mov	ecx, [esp+7Ch+arg_0] ; void *
		push	[esp+7Ch+var_44] ; void	*
		call	sub_10002356

loc_10017199:				; CODE XREF: sub_10017019+16Aj
		push	[esp+78h+var_64]
		call	[esp+7Ch+var_5C]
		push	[esp+78h+var_44]
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_100171AC:				; CODE XREF: sub_10017019+EFj
					; sub_10017019+125j
		mov	eax, esi

loc_100171AE:				; CODE XREF: sub_10017019+9Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 68h
		retn
sub_10017019	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100171B6	proc near		; CODE XREF: sub_100173BA+33p
					; sub_10017479+33p

var_74		= byte ptr -74h
var_5C		= dword	ptr -5Ch
var_58		= dword	ptr -58h
pSessionId	= dword	ptr -54h
var_50		= dword	ptr -50h
var_4C		= byte ptr -4Ch
var_34		= byte ptr -34h
var_1C		= word ptr -1Ch
var_C		= dword	ptr -0Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		xor	ebx, ebx
		push	esi
		mov	[ebp+var_50], ebx
		mov	esi, ecx
		mov	eax, dword_10031F78
		push	edi
		test	eax, eax
		jz	short loc_100171E2
		mov	[esi], eax
		xor	eax, eax
		jmp	loc_100172B2
; ---------------------------------------------------------------------------

loc_100171E2:				; CODE XREF: sub_100171B6+21j
		lea	edx, [ebp+var_50]
		mov	[ebp+var_50], ebx
		mov	ecx, offset aNtopendirector ; "NtOpenDirectoryObject"
		call	sub_10018835
		lea	eax, [ebp+pSessionId]
		mov	[ebp+pSessionId], ebx
		push	eax		; pSessionId
		call	ds:GetCurrentProcessId
		push	eax		; dwProcessId
		call	ds:ProcessIdToSessionId
		xor	eax, eax
		mov	[ebp+var_8], 7
		push	offset aSessionsBnolin ; "\\Sessions\\BNOLINKS"
		lea	ecx, [ebp+var_34] ; void *
		mov	[ebp+var_C], ebx
		mov	[ebp+var_1C], ax
		call	sub_10001C7F
		lea	eax, [ebp+var_1C]
		push	eax		; void *
		push	ecx
		push	[ebp+pSessionId]
		lea	eax, [ebp+var_4C]
		push	offset aD	; "%d"
		push	eax
		call	sub_10004119
		add	esp, 10h
		lea	ecx, [ebp+var_34]
		mov	edx, eax
		call	sub_10017019
		pop	ecx
		push	ebx
		push	1
		lea	ecx, [ebp+var_4C]
		mov	edi, eax
		call	sub_10002311
		push	ebx
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_10002311
		test	edi, edi
		jnz	short loc_100172A5
		push	6
		pop	ecx
		xor	eax, eax
		mov	[ebp+var_5C], ebx
		lea	edi, [ebp+var_74]
		mov	[ebp+var_58], ebx
		rep stosd
		lea	eax, [ebp+var_5C]
		push	eax
		lea	eax, [ebp+var_74]
		push	eax
		push	ebx
		push	40h
		pop	edx
		lea	ecx, [ebp+var_1C]
		call	sub_10015438
		add	esp, 0Ch
		lea	eax, [ebp+var_74]
		push	eax
		push	0Fh
		push	offset dword_10031F78
		call	[ebp+var_50]
		mov	edi, eax
		test	edi, edi
		jnz	short loc_100172A5
		mov	eax, dword_10031F78
		mov	[esi], eax

loc_100172A5:				; CODE XREF: sub_100171B6+ABj
					; sub_100171B6+E6j
		push	ebx
		push	1
		lea	ecx, [ebp+var_1C]
		call	sub_10002311
		mov	eax, edi

loc_100172B2:				; CODE XREF: sub_100171B6+27j
		mov	ecx, [ebp+var_4]
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100171B6	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __usercall sub_100172C3@<eax>(void *@<ecx>, int)
sub_100172C3	proc near		; CODE XREF: sub_10015277+CFp

var_44		= dword	ptr -44h
var_40		= byte ptr -40h
var_30		= byte ptr -30h
var_20		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 48h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_8], eax
		and	[ebp+var_44], 0
		push	ebx
		mov	ebx, [ebp+arg_0]
		push	esi
		push	edi
		mov	edi, ecx
		mov	esi, edx
		push	edi		; void *
		lea	ecx, [ebp+var_20] ; void *
		call	sub_10001C7F
		cmp	[ebp+var_10], 0
		jz	loc_10017399
		cmp	esi, 9
		jz	short loc_10017302
		cmp	esi, 0Ah
		jnz	loc_10017399

loc_10017302:				; CODE XREF: sub_100172C3+34j
		push	3
		lea	ecx, [ebp+var_40]
		call	sub_1000F98B
		push	1
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_40]
		call	sub_1000FB42
		test	al, al
		jz	short loc_1001738D
		cmp	esi, 0Ah
		jnz	short loc_10017336
		push	1
		push	7FEDFFFFh
		push	1
		push	1
		lea	ecx, [ebp+var_40]
		call	sub_1000FC7A

loc_10017336:				; CODE XREF: sub_100172C3+5Ej
		lea	eax, [ebp+var_40]
		mov	ecx, ebx
		push	eax
		push	0Fh
		call	sub_1000F6EE
		test	al, al
		jz	short loc_1001738D
		cmp	esi, 0Ah
		jz	short loc_10017381
		push	3
		lea	ecx, [ebp+var_30]
		call	sub_1000F98B
		push	1
		push	edi
		push	ecx
		push	0
		lea	ecx, [ebp+var_30]
		call	sub_1000FB42
		test	al, al
		jz	short loc_10017385
		lea	eax, [ebp+var_30]
		mov	ecx, ebx
		push	eax
		push	0Eh
		call	sub_1000F6EE
		test	al, al
		jz	short loc_10017385
		lea	ecx, [ebp+var_30]
		call	sub_1000FDA2

loc_10017381:				; CODE XREF: sub_100172C3+87j
		mov	bl, 1
		jmp	short loc_1001738F
; ---------------------------------------------------------------------------

loc_10017385:				; CODE XREF: sub_100172C3+A3j
					; sub_100172C3+B4j
		lea	ecx, [ebp+var_30]
		call	sub_1000FDA2

loc_1001738D:				; CODE XREF: sub_100172C3+59j
					; sub_100172C3+82j
		xor	bl, bl

loc_1001738F:				; CODE XREF: sub_100172C3+C0j
		lea	ecx, [ebp+var_40]
		call	sub_1000FDA2
		jmp	short loc_1001739B
; ---------------------------------------------------------------------------

loc_10017399:				; CODE XREF: sub_100172C3+2Bj
					; sub_100172C3+39j
		xor	bl, bl

loc_1001739B:				; CODE XREF: sub_100172C3+D4j
		push	0
		push	1
		lea	ecx, [ebp+var_20]
		call	sub_10002311
		mov	ecx, [ebp+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_100172C3	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100173BA(int,	int, int, LPHANDLE lpTargetHandle)
sub_100173BA	proc near		; CODE XREF: sub_100169C3+65p

hSourceHandle	= dword	ptr -30h
var_2C		= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
lpTargetHandle	= dword	ptr  10h

		sub	esp, 34h
		push	ebx
		push	ebp
		push	esi
		mov	ebx, edx
		mov	esi, ecx
		xor	ebp, ebp
		lea	edx, [esp+40h+var_28]
		push	edi
		mov	ecx, offset aNtcreateevent ; "NtCreateEvent"
		mov	[esp+44h+var_28], ebp
		call	sub_10018835
		cmp	esi, 3
		jz	short loc_100173E5
		xor	eax, eax
		jmp	loc_10017471
; ---------------------------------------------------------------------------

loc_100173E5:				; CODE XREF: sub_100173BA+22j
		lea	ecx, [esp+44h+var_2C]
		mov	[esp+44h+var_2C], ebp
		call	sub_100171B6
		test	eax, eax
		jnz	short loc_10017471
		push	6
		pop	ecx
		lea	edi, [esp+44h+var_1C]
		mov	[esp+44h+var_24], ebp
		rep stosd
		mov	ecx, [esp+44h+arg_0]
		lea	eax, [esp+44h+var_24]
		push	eax
		lea	eax, [esp+48h+var_1C]
		mov	[esp+48h+var_20], ebp
		push	eax
		push	[esp+4Ch+var_2C]
		push	40h
		pop	edx
		call	sub_10015438
		add	esp, 0Ch
		mov	[esp+44h+hSourceHandle], ebp
		lea	eax, [esp+44h+var_1C]
		push	[esp+44h+arg_8]
		push	[esp+48h+arg_4]
		push	eax
		push	1F0003h
		lea	eax, [esp+54h+hSourceHandle]
		push	eax
		call	[esp+58h+var_28]
		mov	esi, eax
		cmp	[esp+44h+hSourceHandle], ebp
		jz	short loc_10017471
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	[esp+50h+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+58h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10017471
		mov	eax, esi

loc_10017471:				; CODE XREF: sub_100173BA+26j
					; sub_100173BA+3Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 34h
		retn
sub_100173BA	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10017479(int,	int, LPHANDLE lpTargetHandle)
sub_10017479	proc near		; CODE XREF: sub_10016A50+8Bp

hSourceHandle	= dword	ptr -2Ch
var_28		= dword	ptr -28h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= dword	ptr -1Ch
var_18		= byte ptr -18h
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
lpTargetHandle	= dword	ptr  0Ch

		sub	esp, 30h
		push	ebx
		push	ebp
		push	esi
		mov	ebx, edx
		mov	esi, ecx
		xor	ebp, ebp
		lea	edx, [esp+3Ch+var_24]
		push	edi
		mov	ecx, offset aNtopenevent ; "NtOpenEvent"
		mov	[esp+40h+var_24], ebp
		call	sub_10018835
		cmp	esi, 3
		jz	short loc_100174A4
		xor	eax, eax
		jmp	loc_10017527
; ---------------------------------------------------------------------------

loc_100174A4:				; CODE XREF: sub_10017479+22j
		lea	ecx, [esp+40h+var_28]
		mov	[esp+40h+var_28], ebp
		call	sub_100171B6
		test	eax, eax
		jnz	short loc_10017527
		push	6
		pop	ecx
		lea	edi, [esp+40h+var_18]
		mov	[esp+40h+var_20], ebp
		rep stosd
		mov	ecx, [esp+40h+arg_0]
		lea	eax, [esp+40h+var_20]
		push	eax
		lea	eax, [esp+44h+var_18]
		mov	[esp+44h+var_1C], ebp
		push	eax
		push	[esp+48h+var_28]
		push	40h
		pop	edx
		call	sub_10015438
		add	esp, 0Ch
		mov	[esp+40h+hSourceHandle], ebp
		lea	eax, [esp+40h+var_18]
		push	eax
		push	[esp+44h+arg_4]
		lea	eax, [esp+48h+hSourceHandle]
		push	eax
		call	[esp+4Ch+var_24]
		mov	esi, eax
		cmp	[esp+40h+hSourceHandle], ebp
		jz	short loc_10017527
		push	3		; dwOptions
		push	ebp		; bInheritHandle
		push	ebp		; dwDesiredAccess
		push	[esp+4Ch+lpTargetHandle] ; lpTargetHandle
		push	dword ptr [ebx]	; hTargetProcessHandle
		push	[esp+54h+hSourceHandle]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		mov	eax, 0C0000022h
		jz	short loc_10017527
		mov	eax, esi

loc_10017527:				; CODE XREF: sub_10017479+26j
					; sub_10017479+3Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		add	esp, 30h
		retn
sub_10017479	endp

; Exported entry  25. _TargetNtMapViewOfSection@44

; =============== S U B	R O U T	I N E =======================================


; __stdcall TargetNtMapViewOfSection(x,	x, x, x, x, x, x, x, x,	x, x)
		public _TargetNtMapViewOfSection@44
_TargetNtMapViewOfSection@44 proc near	; DATA XREF: .rdata:off_1002E058o

var_10		= byte ptr -10h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h
arg_14		= dword	ptr  18h
arg_18		= dword	ptr  1Ch
arg_1C		= dword	ptr  20h
arg_20		= dword	ptr  24h
arg_24		= dword	ptr  28h
arg_28		= dword	ptr  2Ch

		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		push	[esp+20h+arg_28]
		mov	ebp, [esp+24h+arg_C]
		push	[esp+24h+arg_24]
		mov	esi, [esp+28h+arg_4]
		push	[esp+28h+arg_20]
		push	[esp+2Ch+arg_1C]
		push	[esp+30h+arg_18]
		push	[esp+34h+arg_14]
		push	[esp+38h+arg_10]
		push	ebp
		push	[esp+40h+arg_8]
		push	esi
		call	[esp+48h+arg_0]
		mov	ebx, eax
		xor	edi, edi
		cmp	dword_10031F7C,	1
		mov	[esp+20h+arg_28], ebx
		jnz	short loc_10017590
		call	sub_10013CCD
		cmp	[eax+4], edi
		jnz	short loc_10017586
		mov	dword ptr [eax+4], 1

loc_10017586:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+4Ej
		mov	dword_10031F7C,	2

loc_10017590:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+44j
		test	ebx, ebx
		js	loc_10017713
		call	sub_10013DFD
		test	al, al
		jz	loc_10017713
		mov	ecx, [esp+20h+arg_8]
		call	sub_1001402E
		test	al, al
		jz	loc_10017713
		test	esi, esi
		jz	loc_10017713
		test	ebp, ebp
		jz	loc_10017713
		cmp	[esp+20h+arg_1C], edi
		jz	loc_10017713
		cmp	[esp+20h+arg_18], edi
		jnz	loc_10017713
		push	edi
		push	edi
		push	1
		lea	eax, [esp+2Ch+arg_1C]
		push	eax
		push	0FFFFFFFFh
		push	esi
		push	0FFFFFFFFh
		call	dword_10031D10
		test	eax, eax
		js	loc_10017713
		lea	eax, [esp+20h+arg_18]
		push	eax
		push	10h
		lea	eax, [esp+28h+var_10]
		push	eax
		push	edi
		push	[esp+30h+arg_1C]
		call	dword_10031D28
		push	[esp+20h+arg_1C]
		mov	esi, eax
		call	dword_10031D0C
		test	esi, esi
		js	loc_10017713
		cmp	[esp+20h+arg_18], 10h
		jnz	loc_10017713
		test	[esp+20h+var_C], 1000000h
		jz	loc_10017713
		mov	ecx, [ebp+0]
		lea	edx, [esp+20h+arg_20]
		call	sub_10014126
		mov	esi, eax
		mov	ebx, 208h
		mov	eax, [ebp+0]
		mov	[esp+20h+arg_18], eax

loc_10017654:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+172j
		mov	[esp+20h+arg_1C], ebx
		call	sub_10013DFD
		test	al, al
		jz	short loc_100176B4
		push	ebx
		push	edi
		push	dword_10031DF8
		call	dword_10031D34
		mov	ebx, eax
		test	ebx, ebx
		jz	short loc_100176B4
		lea	eax, [esp+20h+arg_24]
		push	eax
		push	[esp+24h+arg_1C]
		push	ebx
		push	2
		push	[esp+30h+arg_18]
		push	0FFFFFFFFh
		call	dword_10031D2C
		cmp	eax, 80000005h
		jnz	short loc_100176A3
		xor	edx, edx
		mov	ecx, ebx
		call	sub_10014324
		mov	ebx, [esp+20h+arg_24]
		jmp	short loc_10017654
; ---------------------------------------------------------------------------

loc_100176A3:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+163j
		test	eax, eax
		jns	short loc_100176B2
		xor	edx, edx
		mov	ecx, ebx
		call	sub_10014324
		jmp	short loc_100176B4
; ---------------------------------------------------------------------------

loc_100176B2:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+176j
		mov	edi, ebx

loc_100176B4:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+130j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+144j	...
		test	esi, esi
		jnz	short loc_100176C8
		test	byte ptr [esp+20h+arg_20], 4
		jz	short loc_100176C8
		mov	ecx, edi
		call	sub_100141BC
		mov	esi, eax

loc_100176C8:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+187j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+18Ej
		call	sub_1000E4CB
		test	eax, eax
		jz	short loc_100176F5
		push	dword ptr [ebp+0]
		mov	ecx, eax
		push	esi
		push	edi
		call	sub_1000E52C
		test	al, al
		jnz	short loc_100176F5
		push	dword ptr [ebp+0]
		push	[esp+24h+arg_8]
		call	dword_10031D30
		mov	ebx, 0C0000001h
		jmp	short loc_100176F9
; ---------------------------------------------------------------------------

loc_100176F5:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1A0j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1B0j
		mov	ebx, [esp+20h+arg_28]

loc_100176F9:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1C4j
		test	esi, esi
		jz	short loc_10017706
		xor	edx, edx
		mov	ecx, esi
		call	sub_10014324

loc_10017706:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1CCj
		test	edi, edi
		jz	short loc_10017713
		xor	edx, edx
		mov	ecx, edi
		call	sub_10014324

loc_10017713:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+63j
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+70j ...
		cmp	dword_10031F7C,	0
		jnz	short loc_10017726
		mov	dword_10031F7C,	1

loc_10017726:				; CODE XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+1EBj
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ebx
		pop	ebx
		add	esp, 10h
		retn	2Ch
_TargetNtMapViewOfSection@44 endp

; Exported entry  40. _TargetNtUnmapViewOfSection@12

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; __stdcall TargetNtUnmapViewOfSection(x, x, x)
		public _TargetNtUnmapViewOfSection@12
_TargetNtUnmapViewOfSection@12 proc near ; DATA	XREF: .rdata:off_1002E058o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	esi
		push	[ebp+arg_8]
		push	[ebp+arg_4]
		call	[ebp+arg_0]
		mov	esi, eax
		test	esi, esi
		js	short loc_10017766
		mov	ecx, [ebp+arg_4]
		call	sub_1001402E
		test	al, al
		jz	short loc_10017764
		call	sub_1000E4CB
		test	eax, eax
		jz	short loc_10017764
		push	[ebp+arg_8]
		mov	ecx, eax
		call	sub_1000E62E

loc_10017764:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+1Dj
					; TargetNtUnmapViewOfSection(x,x,x)+26j
		mov	eax, esi

loc_10017766:				; CODE XREF: TargetNtUnmapViewOfSection(x,x,x)+11j
		pop	esi
		pop	ebp
		retn	0Ch
_TargetNtUnmapViewOfSection@12 endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1001776B(LPCWSTR lpLibFileName)
sub_1001776B	proc near		; CODE XREF: sub_100178B5+1BDp

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		push	ecx		; lpLibFileName
		mov	edi, edx
		call	ds:LoadLibraryW
		mov	esi, eax
		test	esi, esi
		jz	short loc_100177B1
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_8], offset off_1001AA20
		mov	[ebp+var_4], esi
		call	sub_100058D3
		push	esi		; hLibModule
		test	al, al
		jnz	short loc_100177A0
		call	ds:FreeLibrary
		jmp	short loc_100177AF
; ---------------------------------------------------------------------------

loc_100177A0:				; CODE XREF: sub_1001776B+2Bj
		mov	eax, [esi+3Ch]
		sub	edi, [eax+esi+28h]
		call	ds:FreeLibrary
		mov	esi, edi

loc_100177AF:				; CODE XREF: sub_1001776B+33j
		mov	eax, esi

loc_100177B1:				; CODE XREF: sub_1001776B+14j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_1001776B	endp


; =============== S U B	R O U T	I N E =======================================


sub_100177B7	proc near		; CODE XREF: sub_100083E3+460p

arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h

		push	ecx
		push	esi
		mov	esi, ecx
		push	edi
		push	[esp+0Ch+arg_4]
		xor	edi, edi
		mov	[esi], edi
		lea	ecx, [esi+10h]
		mov	[esi+4], edi
		mov	[esi+8], edi
		mov	[esi+0Ch], edi
		mov	[ecx], edi
		call	sub_10004610
		push	[esp+0Ch+arg_0]
		lea	ecx, [esi+14h]
		mov	[ecx], edi
		call	sub_10004610
		mov	eax, [esp+0Ch+arg_8]
		mov	[esi+18h], edi
		mov	[esi+1Ch], eax
		mov	eax, [esp+0Ch+arg_C]
		mov	[esi+20h], edi
		mov	[esi+24h], eax
		mov	eax, esi
		mov	[esi+28h], edi
		mov	[esi+2Ch], edi
		pop	edi
		pop	esi
		pop	ecx
		retn	10h
sub_100177B7	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017807	proc near		; CODE XREF: sub_10007ECF+2Ep
					; sub_10014606+2Cp ...

ExitCode	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		push	edi
		xor	edi, edi
		mov	esi, ecx
		mov	[ebp+ExitCode],	edi
		call	sub_100061F8
		test	al, al
		jz	short loc_10017861
		push	32h		; dwMilliseconds
		push	dword ptr [esi]	; hHandle
		call	ds:WaitForSingleObject
		lea	eax, [ebp+ExitCode]
		push	eax		; lpExitCode
		push	dword ptr [esi]	; hProcess
		call	ds:GetExitCodeProcess
		test	eax, eax
		jz	short loc_10017841
		cmp	[ebp+ExitCode],	103h
		jnz	short loc_10017861

loc_10017841:				; CODE XREF: sub_10017807+2Fj
		lea	ecx, [esi+18h]
		cmp	[ecx], edi
		jz	short loc_10017852
		cmp	dword ptr [ecx], 0FFFFFFFFh
		jz	short loc_10017852
		call	sub_1000629D

loc_10017852:				; CODE XREF: sub_10017807+3Fj
					; sub_10017807+44j
		mov	[esi+20h], edi
		mov	ecx, esi
		mov	[esi+8], edi
		call	sub_1000629D
		jmp	short loc_10017874
; ---------------------------------------------------------------------------

loc_10017861:				; CODE XREF: sub_10017807+15j
					; sub_10017807+38j
		mov	ecx, [esi+20h]
		mov	[esi+20h], edi
		test	ecx, ecx
		jz	short loc_10017871
		push	ecx
		call	sub_10017CEB

loc_10017871:				; CODE XREF: sub_10017807+62j
		mov	[esi+20h], edi

loc_10017874:				; CODE XREF: sub_10017807+58j
		cmp	[esi+2Ch], edi
		jz	short loc_10017883
		push	dword ptr [esi+2Ch] ; void *
		call	ds:free
		pop	ecx

loc_10017883:				; CODE XREF: sub_10017807+70j
		mov	ecx, [esi+20h]
		test	ecx, ecx
		jz	short loc_10017890
		push	ecx
		call	sub_10017CEB

loc_10017890:				; CODE XREF: sub_10017807+81j
		lea	ecx, [esi+18h]
		call	sub_10004646
		lea	ecx, [esi+14h]
		call	sub_10004646
		lea	ecx, [esi+10h]
		call	sub_10004646
		mov	ecx, esi
		call	sub_100061CB
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10017807	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_100178B5(wchar_t *,	wchar_t	*, int,	int, int)
sub_100178B5	proc near		; CODE XREF: sub_100083E3+483p

lpStartupInfo	= dword	ptr -318h
dwCreationFlags	= dword	ptr -314h
hProcess	= dword	ptr -310h
hThread		= dword	ptr -30Ch
var_308		= dword	ptr -308h
var_304		= dword	ptr -304h
lpApplicationName= dword ptr -300h
var_2FC		= dword	ptr -2FCh
ProcessInformation= _PROCESS_INFORMATION ptr -2F8h
var_2E8		= byte ptr -2E8h
Context		= CONTEXT ptr -2D8h
var_4		= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8
arg_8		= dword	ptr  0Ch
arg_C		= dword	ptr  10h
arg_10		= dword	ptr  14h

		sub	esp, 318h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+318h+var_4], eax
		mov	eax, [esp+318h+arg_C]
		push	ebx
		push	ebp
		push	esi
		mov	esi, ds:_wcsdup
		mov	ebp, ecx
		mov	ecx, [esp+324h+arg_0]
		xor	ebx, ebx
		push	edi
		mov	edi, [esp+328h+arg_4]
		mov	[esp+328h+lpStartupInfo], eax
		mov	eax, [esp+328h+arg_10]
		push	ecx		; wchar_t *
		mov	[esp+32Ch+lpApplicationName], ecx
		mov	[esp+32Ch+var_2FC], eax
		mov	[esp+32Ch+dwCreationFlags], ebx
		call	esi ; _wcsdup
		pop	ecx
		mov	ecx, [ebp+2Ch]
		mov	[esp+328h+dwCreationFlags], eax
		mov	[ebp+2Ch], ebx
		test	ecx, ecx
		jz	short loc_10017921
		push	ecx		; void *
		call	ds:free
		mov	eax, [esp+32Ch+dwCreationFlags]
		pop	ecx

loc_10017921:				; CODE XREF: sub_100178B5+5Ej
		push	edi		; wchar_t *
		mov	[ebp+2Ch], eax
		call	esi ; _wcsdup
		mov	esi, eax
		mov	edi, 40Ch
		mov	eax, [esp+32Ch+lpStartupInfo]
		pop	ecx
		mov	[esp+328h+dwCreationFlags], edi
		cmp	[eax+44h], ebx
		jz	short loc_10017945
		mov	edi, 8040Ch
		mov	[esp+328h+dwCreationFlags], edi

loc_10017945:				; CODE XREF: sub_100178B5+85j
		cmp	[ebp+1Ch], ebx
		jz	short loc_1001795E
		call	sub_100063D2
		cmp	dword ptr [eax], 5
		jge	short loc_1001795E
		or	edi, 1000000h
		mov	[esp+328h+dwCreationFlags], edi

loc_1001795E:				; CODE XREF: sub_100178B5+93j
					; sub_100178B5+9Dj
		xor	eax, eax
		lea	edi, [esp+328h+ProcessInformation]
		stosd
		stosd
		stosd
		stosd
		lea	eax, [esp+328h+ProcessInformation]
		push	eax		; lpProcessInformation
		push	[esp+32Ch+lpStartupInfo] ; lpStartupInfo
		mov	eax, [esp+330h+arg_8]
		push	ebx		; lpCurrentDirectory
		push	ebx		; lpEnvironment
		push	[esp+338h+dwCreationFlags] ; dwCreationFlags
		movzx	eax, al
		push	eax		; bInheritHandles
		push	ebx		; lpThreadAttributes
		push	ebx		; lpProcessAttributes
		push	esi		; lpCommandLine
		push	[esp+34Ch+lpApplicationName] ; lpApplicationName
		push	dword ptr [ebp+10h] ; hToken
		call	ds:CreateProcessAsUserW
		test	eax, eax
		jnz	short loc_100179A3
		call	ds:GetLastError
		mov	ebx, eax
		jmp	loc_10017AB0
; ---------------------------------------------------------------------------

loc_100179A3:				; CODE XREF: sub_100178B5+DFj
		lea	eax, [esp+328h+ProcessInformation]
		mov	[esp+328h+hProcess], ebx
		push	eax
		lea	ecx, [esp+32Ch+hProcess]
		mov	[esp+32Ch+hThread], ebx
		mov	[esp+32Ch+var_308], ebx
		mov	[esp+32Ch+var_304], ebx
		call	sub_10006211
		lea	ecx, [ebp+10h]
		call	sub_10004646
		cmp	[ebp+1Ch], ebx
		jz	short loc_100179E3
		push	[esp+328h+hProcess] ; hProcess
		push	dword ptr [ebp+1Ch] ; hJob
		call	ds:AssignProcessToJobObject
		test	eax, eax
		jz	loc_10017A92

loc_100179E3:				; CODE XREF: sub_100178B5+117j
		lea	edi, [ebp+14h]
		cmp	[edi], ebx
		jz	short loc_10017A13
		cmp	dword ptr [edi], 0FFFFFFFFh
		jz	short loc_10017A13
		mov	eax, [esp+328h+hThread]
		push	dword ptr [edi]	; Token
		mov	[esp+32Ch+lpStartupInfo], eax
		lea	eax, [esp+32Ch+lpStartupInfo]
		push	eax		; Thread
		call	ds:SetThreadToken
		test	eax, eax
		jz	loc_10017A92
		mov	ecx, edi
		call	sub_10004646

loc_10017A13:				; CODE XREF: sub_100178B5+133j
					; sub_100178B5+138j
		lea	eax, [esp+328h+Context]
		mov	[esp+328h+Context.ContextFlags], 1003Fh
		push	eax		; lpContext
		push	[esp+32Ch+hThread] ; hThread
		call	ds:GetThreadContext
		test	eax, eax
		jz	short loc_10017A92
		mov	eax, [esp+328h+Context._Eax]
		mov	edi, [esp+328h+var_2FC]
		mov	edx, edi
		mov	ecx, [esp+328h+hProcess] ; hSourceHandle
		mov	[esp+328h+lpStartupInfo], eax
		call	sub_1000617D
		test	al, al
		jz	short loc_10017A92
		mov	ecx, [esp+328h+hThread]	; hSourceHandle
		lea	edx, [edi+4]
		call	sub_1000617D
		test	al, al
		jz	short loc_10017A92
		mov	eax, [esp+328h+var_308]
		mov	edx, [esp+328h+lpStartupInfo]
		mov	ecx, [esp+328h+lpApplicationName] ; lpLibFileName
		mov	[edi+8], eax
		mov	eax, [esp+328h+var_304]
		mov	[edi+0Ch], eax
		call	sub_1001776B
		mov	[ebp+28h], eax
		lea	ecx, [esp+328h+hProcess]
		lea	eax, [esp+328h+var_2E8]
		push	eax
		call	sub_1000625C
		push	eax
		mov	ecx, ebp
		call	sub_10006211
		jmp	short loc_10017AA7
; ---------------------------------------------------------------------------

loc_10017A92:				; CODE XREF: sub_100178B5+128j
					; sub_100178B5+151j ...
		call	ds:GetLastError
		push	ebx		; uExitCode
		push	[esp+32Ch+hProcess] ; hProcess
		mov	edi, eax
		call	ds:TerminateProcess
		mov	ebx, edi

loc_10017AA7:				; CODE XREF: sub_100178B5+1DBj
		lea	ecx, [esp+328h+hProcess]
		call	sub_100061CB

loc_10017AB0:				; CODE XREF: sub_100178B5+E9j
		test	esi, esi
		jz	short loc_10017ABC
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10017ABC:				; CODE XREF: sub_100178B5+1FDj
		mov	ecx, [esp+328h+var_4]
		mov	eax, ebx
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 318h
		retn	14h
sub_100178B5	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10017AD9(LPCSTR lpProcName,	LPVOID lpBuffer, DWORD nSize)
sub_10017AD9	proc near		; CODE XREF: sub_1000BEB1+8Ep
					; sub_1000D979+6Bp ...

NumberOfBytesWritten= dword ptr	-4
lpProcName	= dword	ptr  4
lpBuffer	= dword	ptr  8
nSize		= dword	ptr  0Ch

		push	ecx
		push	edi
		mov	edi, ecx
		call	sub_100061F8
		test	al, al
		jnz	short loc_10017AEB
		push	8
		pop	eax
		jmp	short loc_10017B4E
; ---------------------------------------------------------------------------

loc_10017AEB:				; CODE XREF: sub_10017AD9+Bj
		push	esi
		push	dword ptr [edi+2Ch] ; lpLibFileName
		call	ds:LoadLibraryW
		mov	esi, eax
		test	esi, esi
		jnz	short loc_10017AFE
		inc	eax
		jmp	short loc_10017B4D
; ---------------------------------------------------------------------------

loc_10017AFE:				; CODE XREF: sub_10017AD9+20j
		push	ebx
		push	[esp+10h+lpProcName] ; lpProcName
		push	esi		; hModule
		call	ds:GetProcAddress
		push	esi		; hLibModule
		mov	ebx, eax
		call	ds:FreeLibrary
		test	ebx, ebx
		jnz	short loc_10017B1C
		xor	eax, eax
		inc	eax
		jmp	short loc_10017B4C
; ---------------------------------------------------------------------------

loc_10017B1C:				; CODE XREF: sub_10017AD9+3Cj
		mov	eax, [edi+28h]
		lea	ecx, [esp+10h+NumberOfBytesWritten]
		push	ebp
		mov	ebp, [esp+14h+nSize]
		sub	eax, esi
		push	ecx		; lpNumberOfBytesWritten
		push	ebp		; nSize
		push	[esp+1Ch+lpBuffer] ; lpBuffer
		add	eax, ebx
		push	eax		; lpBaseAddress
		push	dword ptr [edi]	; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jnz	short loc_10017B42
		inc	eax
		jmp	short loc_10017B4B
; ---------------------------------------------------------------------------

loc_10017B42:				; CODE XREF: sub_10017AD9+64j
		xor	eax, eax
		cmp	[esp+14h+NumberOfBytesWritten],	ebp
		setnz	al

loc_10017B4B:				; CODE XREF: sub_10017AD9+67j
		pop	ebp

loc_10017B4C:				; CODE XREF: sub_10017AD9+41j
		pop	ebx

loc_10017B4D:				; CODE XREF: sub_10017AD9+23j
		pop	esi

loc_10017B4E:				; CODE XREF: sub_10017AD9+10j
		pop	edi
		pop	ecx
		retn	0Ch
sub_10017AD9	endp


; =============== S U B	R O U T	I N E =======================================


; int __stdcall	sub_10017B53(int, void *, int, int)
sub_10017B53	proc near		; CODE XREF: sub_10014EC9+60p

TargetHandle	= dword	ptr -4
arg_0		= dword	ptr  4
arg_4		= dword	ptr  8

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		xor	ebx, ebx
		mov	esi, ecx
		push	ebx		; lpName
		push	10000h		; dwMaximumSizeLow
		push	ebx		; dwMaximumSizeHigh
		push	8000004h	; flProtect
		push	ebx		; lpFileMappingAttributes
		push	0FFFFFFFFh	; hFile
		lea	edi, [esi+18h]
		call	ds:CreateFileMappingW
		push	eax
		mov	ecx, edi
		call	sub_10004610
		cmp	[edi], ebx
		jz	loc_10017C20
		cmp	dword ptr [edi], 0FFFFFFFFh
		jz	loc_10017C20
		push	ebx		; dwOptions
		push	ebx		; bInheritHandle
		push	6		; dwDesiredAccess
		lea	eax, [esp+20h+TargetHandle]
		push	eax		; lpTargetHandle
		push	dword ptr [esi]	; hTargetProcessHandle
		push	dword ptr [edi]	; hSourceHandle
		call	ds:GetCurrentProcess
		push	eax		; hSourceProcessHandle
		call	ds:DuplicateHandle
		test	eax, eax
		jz	short loc_10017C20
		push	ebx		; dwNumberOfBytesToMap
		push	ebx		; dwFileOffsetLow
		push	ebx		; dwFileOffsetHigh
		push	6		; dwDesiredAccess
		push	dword ptr [edi]	; hFileMappingObject
		call	ds:MapViewOfFile
		mov	ebp, eax
		test	ebp, ebp
		jz	short loc_10017C20
		mov	edi, [esp+14h+arg_4]
		lea	ebx, [ebp+2000h]
		test	edi, edi
		jz	short loc_10017BEF
		push	0E000h		; size_t
		push	edi		; void *
		push	ebx		; void *
		call	memcpy
		add	esp, 0Ch
		xor	eax, eax

loc_10017BDD:				; CODE XREF: sub_10017B53+9Aj
		mov	ecx, [ebx+eax*4]
		test	ecx, ecx
		jz	short loc_10017BE9
		sub	ecx, edi
		mov	[ebx+eax*4], ecx

loc_10017BE9:				; CODE XREF: sub_10017B53+8Fj
		inc	eax
		cmp	eax, 20h
		jb	short loc_10017BDD

loc_10017BEF:				; CODE XREF: sub_10017B53+77j
		mov	eax, [esp+14h+TargetHandle]
		mov	ecx, esi
		push	4		; nSize
		push	offset g_shared_section	; lpBuffer
		push	offset aG_shared_sec_0 ; "g_shared_section"
		mov	g_shared_section, eax
		call	sub_10017AD9
		mov	ecx, eax
		xor	ebx, ebx
		mov	g_shared_section, ebx
		test	ecx, ecx
		jz	short loc_10017C2E

loc_10017C19:				; CODE XREF: sub_10017B53+102j
					; sub_10017B53+12Bj
		xor	eax, eax
		inc	eax
		cmp	ecx, eax
		jnz	short loc_10017C26

loc_10017C20:				; CODE XREF: sub_10017B53+2Bj
					; sub_10017B53+34j ...
		call	ds:GetLastError

loc_10017C26:				; CODE XREF: sub_10017B53+CBj
					; sub_10017B53+17Aj ...
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		pop	ecx
		retn	10h
; ---------------------------------------------------------------------------

loc_10017C2E:				; CODE XREF: sub_10017B53+C4j
		push	4		; nSize
		push	offset g_shared_IPC_size ; lpBuffer
		push	offset aG_shared_ipc_0 ; "g_shared_IPC_size"
		mov	ecx, esi
		mov	g_shared_IPC_size, 2000h
		call	sub_10017AD9
		mov	ecx, eax
		mov	g_shared_IPC_size, ebx
		test	ecx, ecx
		jnz	short loc_10017C19
		push	4		; nSize
		push	offset g_shared_policy_size ; lpBuffer
		push	offset aG_shared_pol_0 ; "g_shared_policy_size"
		mov	ecx, esi
		mov	g_shared_policy_size, 0E000h
		call	sub_10017AD9
		mov	ecx, eax
		mov	g_shared_policy_size, ebx
		test	ecx, ecx
		jnz	short loc_10017C19
		push	20h
		call	ds:__imp_??2@YAPAXI@Z ;	operator new(uint)
		pop	ecx
		test	eax, eax
		jz	short loc_10017CA7
		push	[esp+14h+arg_0]
		mov	ecx, eax
		push	dword ptr [esi+24h]
		push	dword ptr [esi+1Ch]
		push	dword ptr [esi+8]
		push	dword ptr [esi]
		call	sub_10015AEE
		mov	edi, eax
		jmp	short loc_10017CA9
; ---------------------------------------------------------------------------

loc_10017CA7:				; CODE XREF: sub_10017B53+138j
		mov	edi, ebx

loc_10017CA9:				; CODE XREF: sub_10017B53+152j
		mov	ecx, [esi+20h]
		mov	[esi+20h], ebx
		test	ecx, ecx
		jz	short loc_10017CB9
		push	ecx
		call	sub_10017CEB

loc_10017CB9:				; CODE XREF: sub_10017B53+15Ej
		push	ecx
		push	ecx
		push	ebp
		mov	ecx, edi
		mov	[esi+20h], edi
		call	sub_10015B5B
		test	al, al
		jnz	short loc_10017CD2
		push	8
		pop	eax
		jmp	loc_10017C26
; ---------------------------------------------------------------------------

loc_10017CD2:				; CODE XREF: sub_10017B53+175j
		lea	ecx, [esi+4]
		mov	[esi+0Ch], ebx
		call	sub_1000629D
		push	eax		; hObject
		call	ds:CloseHandle
		xor	eax, eax
		jmp	loc_10017C26
sub_10017B53	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017CEB	proc near		; CODE XREF: sub_10017807+65p
					; sub_10017807+84p ...
		push	ebx
		mov	ebx, ecx
		push	ebx
		mov	ecx, [ebx+0Ch]
		mov	eax, [ecx]
		call	dword ptr [eax+4]
		test	al, al
		jz	short loc_10017D38
		mov	eax, [ebx+4]
		push	esi
		mov	esi, [eax]
		cmp	esi, eax
		jz	short loc_10017D2A
		push	edi

loc_10017D06:				; CODE XREF: sub_10017CEB+3Cj
		mov	edi, [esi+8]
		push	dword ptr [edi]	; hObject
		call	ds:CloseHandle
		push	dword ptr [edi+4] ; hObject
		call	ds:CloseHandle
		push	edi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		mov	esi, [esi]
		pop	ecx
		cmp	esi, [ebx+4]
		jnz	short loc_10017D06
		pop	edi

loc_10017D2A:				; CODE XREF: sub_10017CEB+18j
		cmp	dword ptr [ebx], 0
		pop	esi
		jz	short loc_10017D38
		push	dword ptr [ebx]	; lpBaseAddress
		call	ds:UnmapViewOfFile

loc_10017D38:				; CODE XREF: sub_10017CEB+Ej
					; sub_10017CEB+43j
		lea	ecx, [ebx+4]
		call	sub_10008D00
		push	ebx
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		mov	eax, ebx
		pop	ebx
		retn	4
sub_10017CEB	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10017D4E(HKEY hKey)
sub_10017D4E	proc near		; CODE XREF: sub_10017D8F+ADp
					; sub_10017D8F+BBp ...

phkResult	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		lea	eax, [ebp+phkResult]
		push	eax		; phkResult
		push	2000000h	; samDesired
		push	0		; ulOptions
		push	0		; lpSubKey
		push	ecx		; hKey
		call	ds:RegOpenKeyExW
		test	eax, eax
		jnz	short loc_10017D7B
		push	[ebp+phkResult]	; hKey
		call	ds:RegCloseKey
		test	eax, eax
		jz	short loc_10017D7B
		xor	al, al
		jmp	short loc_10017D7D
; ---------------------------------------------------------------------------

loc_10017D7B:				; CODE XREF: sub_10017D4E+1Aj
					; sub_10017D4E+27j
		mov	al, 1

loc_10017D7D:				; CODE XREF: sub_10017D4E+2Bj
		mov	esp, ebp
		pop	ebp
		retn
sub_10017D4E	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017D81	proc near		; DATA XREF: .rdata:off_1002D9CCo
		push	2
		pop	eax
		cmp	[ecx+4], eax
		jge	short loc_10017D8C
		mov	[ecx+4], eax

loc_10017D8C:				; CODE XREF: sub_10017D81+6j
		xor	eax, eax
		retn
sub_10017D81	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017D8F	proc near		; DATA XREF: .rdata:1002D9D0o

var_C		= dword	ptr -0Ch
TokenHandle	= dword	ptr -8

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 10h
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, ecx
		mov	ebx, g_shared_delayed_integrity_level
		call	sub_100063D2
		mov	edi, ds:TerminateProcess
		mov	esi, ds:GetCurrentProcess
		cmp	dword ptr [eax], 3
		jl	short loc_10017E16
		cmp	ebx, 7
		jz	short loc_10017E16
		lea	eax, [esp+20h+TokenHandle]
		push	eax		; TokenHandle
		push	80h		; DesiredAccess
		call	esi ; GetCurrentProcess
		push	eax		; ProcessHandle
		call	ds:OpenProcessToken
		test	eax, eax
		jnz	short loc_10017DE0
		call	ds:GetLastError
		mov	ebx, eax
		jmp	short loc_10017E08
; ---------------------------------------------------------------------------

loc_10017DE0:				; CODE XREF: sub_10017D8F+45j
		push	[esp+20h+TokenHandle]
		and	[esp+24h+var_C], 0
		lea	ecx, [esp+24h+var_C]
		call	sub_10004610
		mov	ecx, [esp+20h+var_C] ; TokenHandle
		mov	edx, ebx
		call	sub_10013C26
		lea	ecx, [esp+20h+var_C]
		mov	ebx, eax
		call	sub_10004646

loc_10017E08:				; CODE XREF: sub_10017D8F+4Fj
		test	ebx, ebx
		jz	short loc_10017E16
		push	1B5Eh		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E16:				; CODE XREF: sub_10017D8F+29j
					; sub_10017D8F+2Ej ...
		cmp	dword ptr [ebp+4], 3
		jge	short loc_10017E23
		mov	dword ptr [ebp+4], 3

loc_10017E23:				; CODE XREF: sub_10017D8F+8Bj
		call	ds:RevertToSelf
		test	eax, eax
		jnz	short loc_10017E37
		push	1B5Fh		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E37:				; CODE XREF: sub_10017D8F+9Cj
		mov	ecx, 80000002h	; hKey
		call	sub_10017D4E
		test	al, al
		jz	short loc_10017E61
		mov	ecx, 80000000h	; hKey
		call	sub_10017D4E
		test	al, al
		jz	short loc_10017E61
		mov	ecx, 80000003h	; hKey
		call	sub_10017D4E
		test	al, al
		jnz	short loc_10017E6B

loc_10017E61:				; CODE XREF: sub_10017D8F+B4j
					; sub_10017D8F+C2j
		push	1B60h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E6B:				; CODE XREF: sub_10017D8F+D0j
		call	ds:RegDisablePredefinedCache
		test	eax, eax
		jz	short loc_10017E7F
		push	1B61h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017E7F:				; CODE XREF: sub_10017D8F+E4j
		cmp	g_handles_to_close, 0
		jz	short loc_10017EC1
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000C1AF
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000C863
		lea	ecx, [esp+20h+TokenHandle]
		call	sub_1000CA9E
		lea	ecx, [esp+20h+TokenHandle]
		test	al, al
		jnz	short loc_10017EBC
		call	sub_1000C1EC
		push	1B62h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess
		jmp	short loc_10017EC1
; ---------------------------------------------------------------------------

loc_10017EBC:				; CODE XREF: sub_10017D8F+11Aj
		call	sub_1000C1EC

loc_10017EC1:				; CODE XREF: sub_10017D8F+F7j
					; sub_10017D8F+12Bj
		mov	eax, g_shared_delayed_mitigations
		or	eax, dword_10031E14
		jz	short loc_10017EE5
		push	ecx
		push	ecx
		call	sub_1001028F
		pop	ecx
		pop	ecx
		test	al, al
		jnz	short loc_10017EE5
		push	1B63h		; uExitCode
		call	esi ; GetCurrentProcess
		push	eax		; hProcess
		call	edi ; TerminateProcess

loc_10017EE5:				; CODE XREF: sub_10017D8F+13Dj
					; sub_10017D8F+14Aj
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10017D8F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017EED	proc near		; DATA XREF: .rdata:1002D9D4o
		lea	eax, [ecx+4]
		retn
sub_10017EED	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10017EF1	proc near		; DATA XREF: .rdata:1002D9D8o

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h
arg_C		= dword	ptr  14h
arg_10		= dword	ptr  18h

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_10]
		mov	edx, [ebp+arg_4]
		push	[ebp+arg_C]
		mov	ecx, [ebp+arg_0]
		push	[ebp+arg_8]
		call	sub_1000D439
		add	esp, 0Ch
		pop	ebp
		retn	14h
sub_10017EF1	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __stdcall	sub_10017F0F(HANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context)
sub_10017F0F	proc near		; DATA XREF: .rdata:off_1002BC80o

var_8		= dword	ptr -8
var_4		= dword	ptr -4
phNewWaitObject	= dword	ptr  8
hObject		= dword	ptr  0Ch
Callback	= dword	ptr  10h
Context		= dword	ptr  14h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		push	esi
		mov	esi, [ebp+phNewWaitObject]
		push	edi
		mov	edi, ecx
		test	esi, esi
		jnz	short loc_10017F23

loc_10017F1F:				; CODE XREF: sub_10017F0F+31j
		xor	al, al
		jmp	short loc_10017F6A
; ---------------------------------------------------------------------------

loc_10017F23:				; CODE XREF: sub_10017F0F+Ej
		and	[ebp+phNewWaitObject], 0
		lea	eax, [ebp+phNewWaitObject]
		push	0		; dwFlags
		push	0FFFFFFFFh	; dwMilliseconds
		push	[ebp+Context]	; Context
		push	[ebp+Callback]	; Callback
		push	[ebp+hObject]	; hObject
		push	eax		; phNewWaitObject
		call	ds:RegisterWaitForSingleObject
		test	eax, eax
		jz	short loc_10017F1F
		mov	eax, [ebp+phNewWaitObject]
		mov	[ebp+var_8], esi
		lea	esi, [edi+0Ch]
		push	esi		; lpCriticalSection
		mov	[ebp+var_4], eax
		call	ds:EnterCriticalSection
		lea	eax, [ebp+var_8]
		push	eax
		lea	ecx, [edi+4]
		call	sub_1000FDBA
		push	esi		; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, 1

loc_10017F6A:				; CODE XREF: sub_10017F0F+12j
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn	10h
sub_10017F0F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017F72	proc near		; DATA XREF: .rdata:1002BC84o

var_5		= byte ptr -5
lpCriticalSection= dword ptr -4
arg_0		= dword	ptr  4

		push	ecx
		push	ecx
		push	ebx
		mov	ebx, [esp+0Ch+arg_0]
		push	ebp
		mov	ebp, ecx
		test	ebx, ebx
		jnz	short loc_10017F84
		xor	al, al
		jmp	short loc_10017FF5
; ---------------------------------------------------------------------------

loc_10017F84:				; CODE XREF: sub_10017F72+Cj
		lea	eax, [ebp+0Ch]
		push	edi
		push	eax		; lpCriticalSection
		mov	[esp+18h+lpCriticalSection], eax
		call	ds:EnterCriticalSection
		mov	eax, [ebp+4]
		mov	[esp+14h+var_5], 1
		mov	edi, [eax]
		cmp	edi, eax
		jz	short loc_10017FE6
		push	esi

loc_10017FA2:				; CODE XREF: sub_10017F72+71j
		cmp	[edi+8], ebx
		jnz	short loc_10017FDE
		mov	eax, [edi+4]
		mov	ebx, [edi+0Ch]
		mov	esi, [edi]
		push	edi
		mov	[eax], esi
		mov	ecx, [edi]
		mov	eax, [edi+4]
		mov	[ecx+4], eax
		dec	dword ptr [ebp+8]
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx
		push	0FFFFFFFFh	; CompletionEvent
		push	ebx		; WaitHandle
		mov	edi, esi
		call	ds:UnregisterWaitEx
		mov	ebx, [esp+18h+arg_0]
		test	eax, eax
		setnz	al
		and	[esp+18h+var_5], al
		jmp	short loc_10017FE0
; ---------------------------------------------------------------------------

loc_10017FDE:				; CODE XREF: sub_10017F72+33j
		mov	edi, [edi]

loc_10017FE0:				; CODE XREF: sub_10017F72+6Aj
		cmp	edi, [ebp+4]
		jnz	short loc_10017FA2
		pop	esi

loc_10017FE6:				; CODE XREF: sub_10017F72+2Dj
		push	[esp+14h+lpCriticalSection] ; lpCriticalSection
		call	ds:LeaveCriticalSection
		mov	al, [esp+14h+var_5]
		pop	edi

loc_10017FF5:				; CODE XREF: sub_10017F72+10j
		pop	ebp
		pop	ebx
		pop	ecx
		pop	ecx
		retn	4
sub_10017F72	endp


; =============== S U B	R O U T	I N E =======================================


sub_10017FFC	proc near		; CODE XREF: sub_10007EB2+3p
		push	esi
		mov	esi, ecx
		lea	eax, [esi+0Ch]
		mov	dword ptr [esi], offset	off_1002BC80
		push	eax		; lpCriticalSection
		call	ds:DeleteCriticalSection
		lea	ecx, [esi+4]
		call	sub_10008D00
		mov	dword ptr [esi], offset	off_1002BC8C
		pop	esi
		retn
sub_10017FFC	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001801F	proc near		; CODE XREF: sub_10018182+64p
					; sub_10018284+28p

var_10		= byte ptr -10h
var_4		= dword	ptr -4

		sub	esp, 10h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+10h+var_4], eax
		push	ebx
		push	ebp
		push	esi
		mov	ebp, ecx
		mov	esi, offset a??_2 ; "\\??\\"
		push	edi
		mov	ecx, esi
		xor	ebx, ebx
		call	sub_10001AF3
		push	eax
		push	esi
		push	4
		push	ebx
		mov	ecx, ebp
		call	sub_10003F14
		test	eax, eax
		jnz	short loc_10018054
		push	4
		pop	ebx

loc_10018054:				; CODE XREF: sub_1001801F+30j
		mov	esi, offset aPipe ; "pipe\\"
		lea	edi, [esp+20h+var_10]
		lea	ecx, [esp+20h+var_10]
		movsd
		movsd
		movsd
		call	sub_10001AF3
		push	eax
		lea	eax, [esp+24h+var_10]
		mov	ecx, ebp
		push	eax
		push	5
		push	ebx
		call	sub_10003F14
		mov	ecx, [esp+20h+var_4]
		neg	eax
		pop	edi
		pop	esi
		pop	ebp
		sbb	eax, eax
		pop	ebx
		xor	ecx, esp
		inc	eax
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 10h
		retn
sub_1001801F	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018091	proc near		; CODE XREF: sub_1000BC43+ACp
					; sub_100127AF+40p

phkResult	= dword	ptr -28h
dwDisposition	= dword	ptr -24h
var_20		= byte ptr -20h
var_8		= dword	ptr -8
arg_0		= dword	ptr  4

		sub	esp, 2Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+2Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		xor	ebx, ebx
		mov	ebp, ecx
		push	edi
		mov	edi, ebx

loc_100180A9:				; CODE XREF: sub_10018091+3Aj
		mov	esi, ds:off_1002BA00[edi*8]
		mov	ecx, esi
		call	sub_10001AF3
		push	eax
		push	ebx
		push	esi
		lea	ecx, [esp+48h+arg_0]
		call	sub_100036D7
		test	eax, eax
		jz	short loc_100180D2
		inc	edi
		cmp	edi, 9
		jb	short loc_100180A9
		jmp	loc_1001815F
; ---------------------------------------------------------------------------

loc_100180D2:				; CODE XREF: sub_10018091+34j
		lea	eax, [esp+3Ch+dwDisposition]
		push	eax		; lpdwDisposition
		lea	eax, [esp+40h+phkResult]
		push	eax		; phkResult
		push	ebx		; lpSecurityAttributes
		push	2000000h	; samDesired
		push	ebx		; dwOptions
		push	ebx		; lpClass
		push	ebx		; Reserved
		push	offset SubKey	; lpSubKey
		push	ds:hKey[edi*8]	; hKey
		call	ds:RegCreateKeyExW
		test	eax, eax
		jnz	short loc_1001815F
		mov	ecx, [esp+3Ch+phkResult]
		mov	edx, ebp
		call	sub_1001873D
		push	[esp+3Ch+phkResult] ; hKey
		mov	bl, al
		call	ds:RegCloseKey
		test	bl, bl
		jz	short loc_1001815D
		mov	edx, ds:off_1002BA00[edi*8]
		xor	esi, esi
		lea	ecx, [edx+2]

loc_10018122:				; CODE XREF: sub_10018091+9Aj
		mov	ax, [edx]
		add	edx, 2
		cmp	ax, si
		jnz	short loc_10018122
		sub	edx, ecx
		lea	eax, [esp+3Ch+var_20]
		push	0FFFFFFFFh	; int
		sar	edx, 1
		lea	ecx, [esp+40h+arg_0] ; int
		push	edx		; int
		push	eax		; void *
		call	sub_100035B5
		push	0FFFFFFFFh
		push	esi
		push	eax
		mov	ecx, ebp
		call	sub_100032F4
		push	esi
		push	1
		lea	ecx, [esp+44h+var_20]
		call	sub_10002311
		mov	bl, 1
		jmp	short loc_10018161
; ---------------------------------------------------------------------------

loc_1001815D:				; CODE XREF: sub_10018091+83j
		xor	ebx, ebx

loc_1001815F:				; CODE XREF: sub_10018091+3Cj
					; sub_10018091+68j
		xor	esi, esi

loc_10018161:				; CODE XREF: sub_10018091+CAj
		push	esi
		push	1
		lea	ecx, [esp+44h+arg_0]
		call	sub_10002311
		mov	ecx, [esp+3Ch+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 2Ch
		retn
sub_10018091	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018182	proc near		; CODE XREF: sub_1000B9D4+15p

var_34		= byte ptr -34h
lpFileName	= dword	ptr -1Ch
var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 34h
		mov	eax, ___security_cookie
		xor	eax, ebp
		mov	[ebp+var_4], eax
		push	ebx
		push	esi
		push	edi
		push	ecx
		lea	ecx, [ebp+lpFileName]
		mov	edi, edx
		call	sub_100038A0
		mov	esi, offset a??_2 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001AF3
		push	eax
		push	esi
		push	4
		xor	ebx, ebx
		lea	ecx, [ebp+lpFileName]
		push	ebx
		call	sub_10003F14
		test	eax, eax
		jnz	short loc_100181E3
		push	0FFFFFFFFh	; int
		push	4		; int
		lea	eax, [ebp+var_34]
		push	eax		; void *
		lea	ecx, [ebp+lpFileName] ;	int
		call	sub_100035B5
		push	eax		; void *
		lea	ecx, [ebp+lpFileName]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_10002311

loc_100181E3:				; CODE XREF: sub_10018182+3Bj
		lea	ecx, [ebp+lpFileName]
		call	sub_1001801F
		test	al, al
		jz	short loc_100181F3

loc_100181EF:				; CODE XREF: sub_10018182+DDj
		mov	[edi], bl
		jmp	short loc_10018264
; ---------------------------------------------------------------------------

loc_100181F3:				; CODE XREF: sub_10018182+6Bj
		or	eax, 0FFFFFFFFh

loc_100181F6:				; CODE XREF: sub_10018182+DBj
		push	eax		; int
		push	ebx		; int
		lea	eax, [ebp+var_34]
		push	eax		; void *
		lea	ecx, [ebp+lpFileName] ;	int
		call	sub_100035B5
		push	eax		; void *
		lea	ecx, [ebp+lpFileName]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [ebp+var_34]
		call	sub_10002311
		cmp	[ebp+var_8], 8
		mov	eax, [ebp+lpFileName]
		jnb	short loc_10018224
		lea	eax, [ebp+lpFileName]

loc_10018224:				; CODE XREF: sub_10018182+9Dj
		push	eax		; lpFileName
		call	ds:GetFileAttributesW
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10018249
		call	ds:GetLastError
		mov	esi, eax
		cmp	esi, 2
		jz	short loc_10018250
		cmp	esi, 3
		jz	short loc_10018250
		cmp	esi, 7Bh
		jnz	short loc_10018266
		jmp	short loc_10018250
; ---------------------------------------------------------------------------

loc_10018249:				; CODE XREF: sub_10018182+ACj
		test	eax, 400h
		jnz	short loc_10018261

loc_10018250:				; CODE XREF: sub_10018182+B9j
					; sub_10018182+BEj ...
		push	ecx
		push	ecx
		lea	ecx, [ebp+lpFileName]
		call	sub_1001889F
		cmp	eax, 2
		ja	short loc_100181F6
		jmp	short loc_100181EF
; ---------------------------------------------------------------------------

loc_10018261:				; CODE XREF: sub_10018182+CCj
		mov	byte ptr [edi],	1

loc_10018264:				; CODE XREF: sub_10018182+6Fj
		mov	esi, ebx

loc_10018266:				; CODE XREF: sub_10018182+C3j
		push	ebx
		push	1
		lea	ecx, [ebp+lpFileName]
		call	sub_10002311
		mov	ecx, [ebp+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		xor	ecx, ebp
		pop	ebx
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018182	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018284	proc near		; CODE XREF: sub_1000B303+57p

var_268		= dword	ptr -268h
var_264		= dword	ptr -264h
var_254		= dword	ptr -254h
var_250		= dword	ptr -250h
var_24C		= dword	ptr -24Ch
var_23C		= dword	ptr -23Ch
var_238		= dword	ptr -238h
var_234		= byte ptr -234h
DeviceName	= word ptr -21Ch
var_216		= word ptr -216h
TargetPath	= word ptr -214h
var_8		= dword	ptr -8

		sub	esp, 26Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+26Ch+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	esi, ecx
		lea	ecx, [esp+27Ch+var_264]	; void *
		push	edx		; void *
		call	sub_10001C7F
		lea	ecx, [esp+27Ch+var_264]
		call	sub_1001801F
		xor	ebx, ebx
		test	al, al
		jz	short loc_100182BE
		mov	bl, 1
		jmp	loc_10018494
; ---------------------------------------------------------------------------

loc_100182BE:				; CODE XREF: sub_10018284+31j
		xor	eax, eax
		mov	[esp+27Ch+var_238], 7
		lea	edx, [esp+27Ch+var_24C]
		mov	[esp+27Ch+var_23C], ebx
		mov	ecx, esi
		mov	word ptr [esp+27Ch+var_24C], ax
		call	sub_1001873D
		test	al, al
		jz	loc_10018486
		mov	ecx, [esp+27Ch+var_250]
		mov	eax, [esp+27Ch+var_264]
		mov	edx, eax
		push	8
		pop	ebp
		cmp	ecx, ebp
		jnb	short loc_100182F9
		lea	edx, [esp+27Ch+var_264]

loc_100182F9:				; CODE XREF: sub_10018284+6Fj
		mov	esi, [esp+27Ch+var_254]
		push	5Ch
		pop	edi
		cmp	[edx+esi*2-2], di
		jnz	short loc_10018338
		lea	eax, [esi-1]
		push	eax		; int
		push	ebx		; int
		lea	eax, [esp+284h+var_234]
		push	eax		; void *
		lea	ecx, [esp+288h+var_264]	; int
		call	sub_100035B5
		push	eax		; void *
		lea	ecx, [esp+280h+var_264]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [esp+284h+var_234]
		call	sub_10002311
		mov	ecx, [esp+27Ch+var_250]
		mov	eax, [esp+27Ch+var_264]

loc_10018338:				; CODE XREF: sub_10018284+81j
		cmp	ecx, ebp
		jnb	short loc_10018340
		lea	eax, [esp+27Ch+var_264]

loc_10018340:				; CODE XREF: sub_10018284+B6j
		mov	ecx, [esp+27Ch+var_24C]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_1001834E
		lea	ecx, [esp+27Ch+var_24C]

loc_1001834E:				; CODE XREF: sub_10018284+C4j
		mov	ebx, ds:_wcsicmp
		push	eax		; wchar_t *
		push	ecx		; wchar_t *
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10018365

loc_1001835E:				; CODE XREF: sub_10018284+1F2j
		mov	bl, 1
		jmp	loc_10018486
; ---------------------------------------------------------------------------

loc_10018365:				; CODE XREF: sub_10018284+D8j
		push	1
		xor	eax, eax
		mov	[esp+280h+var_268], 3Ah
		push	eax
		lea	eax, [esp+284h+var_268]
		push	eax
		lea	ecx, [esp+288h+var_264]
		call	sub_100036D7
		mov	edi, eax
		test	edi, edi
		jz	loc_10018482
		cmp	edi, 0FFFFFFFFh
		jz	loc_10018482
		mov	eax, [esp+27Ch+var_264]
		cmp	edi, 1
		jbe	short loc_100183BB
		mov	ecx, eax
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_100183A8
		lea	ecx, [esp+27Ch+var_264]

loc_100183A8:				; CODE XREF: sub_10018284+11Ej
		push	5Ch
		pop	edx
		cmp	[ecx+edi*2-4], dx
		jz	short loc_100183BB
		xor	edx, edx

loc_100183B4:				; CODE XREF: sub_10018284+1A1j
		mov	bl, dl
		jmp	loc_10018486
; ---------------------------------------------------------------------------

loc_100183BB:				; CODE XREF: sub_10018284+116j
					; sub_10018284+12Cj
		xor	ecx, ecx
		mov	[esp+27Ch+DeviceName], cx
		mov	dword ptr [esp+27Ch+DeviceName+2], ecx
		mov	[esp+27Ch+var_216], cx
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_100183D5
		lea	eax, [esp+27Ch+var_264]

loc_100183D5:				; CODE XREF: sub_10018284+14Bj
		mov	eax, [eax+edi*2-2]
		mov	esi, 104h
		mov	dword ptr [esp+27Ch+DeviceName], eax
		lea	eax, [esp+27Ch+TargetPath]
		push	esi		; ucchMax
		push	eax		; lpTargetPath
		lea	eax, [esp+284h+DeviceName]
		push	eax		; lpDeviceName
		call	ds:QueryDosDeviceW
		cmp	eax, 2
		jb	loc_1001847C
		cmp	eax, esi
		jz	short loc_1001847C
		lea	esi, [esp+27Ch+TargetPath]
		xor	edx, edx
		lea	ecx, [esi+2]

loc_10018409:				; CODE XREF: sub_10018284+18Ej
		mov	ax, [esi]
		add	esi, 2
		cmp	ax, dx
		jnz	short loc_10018409
		mov	eax, [esp+27Ch+var_254]
		sub	esi, ecx
		sub	eax, edi
		sar	esi, 1
		dec	eax
		add	eax, esi
		cmp	eax, [esp+27Ch+var_23C]
		jnz	short loc_100183B4
		mov	eax, [esp+27Ch+var_24C]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_10018435
		lea	eax, [esp+27Ch+var_24C]

loc_10018435:				; CODE XREF: sub_10018284+1ABj
		push	esi		; size_t
		lea	ecx, [esp+280h+TargetPath]
		push	ecx		; wchar_t *
		push	eax		; wchar_t *
		call	ds:_wcsnicmp
		add	esp, 0Ch
		test	eax, eax
		jnz	short loc_1001847C
		mov	eax, [esp+27Ch+var_264]
		cmp	[esp+27Ch+var_250], ebp
		jnb	short loc_10018457
		lea	eax, [esp+27Ch+var_264]

loc_10018457:				; CODE XREF: sub_10018284+1CDj
		mov	ecx, [esp+27Ch+var_24C]
		cmp	[esp+27Ch+var_238], ebp
		jnb	short loc_10018465
		lea	ecx, [esp+27Ch+var_24C]

loc_10018465:				; CODE XREF: sub_10018284+1DBj
		lea	eax, [eax+edi*2]
		add	eax, 2
		push	eax		; wchar_t *
		lea	eax, [ecx+esi*2]
		push	eax		; wchar_t *
		call	ebx ; _wcsicmp
		pop	ecx
		pop	ecx
		test	eax, eax
		jz	loc_1001835E

loc_1001847C:				; CODE XREF: sub_10018284+172j
					; sub_10018284+17Aj ...
		xor	eax, eax
		mov	bl, al
		jmp	short loc_10018488
; ---------------------------------------------------------------------------

loc_10018482:				; CODE XREF: sub_10018284+100j
					; sub_10018284+109j
		xor	eax, eax
		mov	bl, al

loc_10018486:				; CODE XREF: sub_10018284+5Aj
					; sub_10018284+DCj ...
		xor	eax, eax

loc_10018488:				; CODE XREF: sub_10018284+1FCj
		push	eax
		push	1
		lea	ecx, [esp+284h+var_24C]
		call	sub_10002311

loc_10018494:				; CODE XREF: sub_10018284+35j
		xor	eax, eax
		lea	ecx, [esp+27Ch+var_264]
		push	eax
		push	1
		call	sub_10002311
		mov	ecx, [esp+27Ch+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 26Ch
		retn
sub_10018284	endp


; =============== S U B	R O U T	I N E =======================================


sub_100184BD	proc near		; CODE XREF: sub_1000B9D4+7p
					; sub_100184BD+15Bp

var_6D		= byte ptr -6Dh
var_6C		= dword	ptr -6Ch
lpszShortPath	= dword	ptr -68h
var_54		= dword	ptr -54h
var_50		= word ptr -50h
var_40		= dword	ptr -40h
var_3C		= dword	ptr -3Ch
var_38		= byte ptr -38h
var_28		= dword	ptr -28h
var_20		= byte ptr -20h
var_10		= dword	ptr -10h
var_8		= dword	ptr -8

		sub	esp, 74h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+74h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	ebp, edx
		xor	ebx, ebx
		push	ecx
		lea	ecx, [esp+88h+lpszShortPath]
		mov	[esp+88h+var_6C], ebp
		mov	[esp+88h+var_6D], bl
		call	sub_100038A0
		mov	esi, offset a??_2 ; "\\??\\"
		mov	ecx, esi
		call	sub_10001AF3
		push	eax
		push	esi
		push	4
		push	ebx
		lea	ecx, [esp+94h+lpszShortPath]
		call	sub_10003F14
		test	eax, eax
		jnz	short loc_10018530
		push	0FFFFFFFFh	; int
		push	4		; int
		lea	eax, [esp+8Ch+var_20]
		push	eax		; void *
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035B5
		push	eax		; void *
		lea	ecx, [esp+88h+lpszShortPath]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_20]
		call	sub_10002311
		mov	[esp+84h+var_6D], 1

loc_10018530:				; CODE XREF: sub_100184BD+44j
		xor	ecx, ecx
		mov	edi, 104h
		push	2
		pop	edx
		mov	eax, edi
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		cmp	[esp+88h+var_54], 8
		mov	esi, eax
		mov	eax, [esp+88h+lpszShortPath]
		pop	ecx
		jnb	short loc_1001855D
		lea	eax, [esp+84h+lpszShortPath]

loc_1001855D:				; CODE XREF: sub_100184BD+9Aj
		push	edi		; cchBuffer
		push	esi		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jb	short loc_100185B7
		push	2
		pop	ebp

loc_1001856F:				; CODE XREF: sub_100184BD+F4j
		add	edi, edi
		xor	ecx, ecx
		mov	eax, edi
		mul	ebp
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		mov	ebx, eax
		pop	ecx
		test	esi, esi
		jz	short loc_10018593
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10018593:				; CODE XREF: sub_100184BD+CCj
		cmp	[esp+84h+var_54], 8
		mov	esi, ebx
		mov	eax, [esp+84h+lpszShortPath]
		jnb	short loc_100185A4
		lea	eax, [esp+84h+lpszShortPath]

loc_100185A4:				; CODE XREF: sub_100184BD+E1j
		push	edi		; cchBuffer
		push	ebx		; lpszLongPath
		push	eax		; lpszShortPath
		call	ds:GetLongPathNameW
		mov	ebx, eax
		cmp	ebx, edi
		jnb	short loc_1001856F
		mov	ebp, [esp+84h+var_6C]

loc_100185B7:				; CODE XREF: sub_100184BD+ADj
		call	ds:GetLastError
		test	ebx, ebx
		jnz	loc_100186B9
		push	2
		pop	ecx
		cmp	eax, ecx
		jz	short loc_100185D6
		cmp	eax, 3
		jz	short loc_100185D6
		cmp	eax, 7Bh
		jnz	short loc_100185E8

loc_100185D6:				; CODE XREF: sub_100184BD+10Dj
					; sub_100184BD+112j
		push	ecx
		push	ecx
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_1001889F
		mov	edi, eax
		cmp	edi, 0FFFFFFFFh
		jnz	short loc_100185EF

loc_100185E8:				; CODE XREF: sub_100184BD+117j
		xor	bl, bl
		jmp	loc_1001870F
; ---------------------------------------------------------------------------

loc_100185EF:				; CODE XREF: sub_100184BD+129j
		push	edi		; int
		xor	ebx, ebx
		lea	eax, [esp+88h+var_38]
		push	ebx		; int
		push	eax		; void *
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035B5
		push	0FFFFFFFFh	; int
		push	edi		; int
		lea	eax, [esp+8Ch+var_20]
		push	eax		; void *
		lea	ecx, [esp+90h+lpszShortPath] ; int
		call	sub_100035B5
		lea	edx, [esp+84h+var_38]
		mov	ecx, edx
		call	sub_100184BD
		test	al, al
		jnz	short loc_1001863E
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_20]
		call	sub_10002311
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_38]
		call	sub_10002311
		jmp	loc_1001870F
; ---------------------------------------------------------------------------

loc_1001863E:				; CODE XREF: sub_100184BD+162j
		xor	eax, eax
		mov	[esp+84h+var_3C], 7
		mov	[esp+84h+var_50], ax
		lea	ecx, [esp+84h+var_50]
		mov	eax, [esp+84h+var_10]
		add	eax, [esp+84h+var_28]
		push	eax
		mov	[esp+88h+var_40], ebx
		call	sub_1000322E
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+var_38]
		push	eax
		lea	ecx, [esp+90h+var_50]
		call	sub_100032F4
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+var_20]
		push	eax
		lea	ecx, [esp+90h+var_50]
		call	sub_100032F4
		lea	eax, [esp+84h+var_50]
		push	eax		; void *
		lea	ecx, [esp+88h+lpszShortPath]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_50]
		call	sub_10002311
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_20]
		call	sub_10002311
		push	ebx
		push	1
		lea	ecx, [esp+8Ch+var_38]
		call	sub_10002311
		jmp	short loc_100186CD
; ---------------------------------------------------------------------------

loc_100186B9:				; CODE XREF: sub_100184BD+102j
		mov	ecx, esi
		call	sub_10001AF3
		push	eax		; int
		push	esi		; void *
		lea	ecx, [esp+8Ch+lpszShortPath] ; void *
		call	sub_10002356
		xor	ebx, ebx

loc_100186CD:				; CODE XREF: sub_100184BD+1FAj
		cmp	[esp+84h+var_6D], 0
		jz	short loc_100186FA
		mov	edi, offset a??_2 ; "\\??\\"
		mov	ecx, edi
		call	sub_10001AF3
		push	eax		; int
		push	edi		; void *
		mov	ecx, ebp	; void *
		call	sub_10002356
		push	0FFFFFFFFh
		push	ebx
		lea	eax, [esp+8Ch+lpszShortPath]
		mov	ecx, ebp
		push	eax
		call	sub_100032F4
		jmp	short loc_1001870D
; ---------------------------------------------------------------------------

loc_100186FA:				; CODE XREF: sub_100184BD+215j
		lea	eax, [esp+84h+lpszShortPath]
		cmp	ebp, eax
		jz	short loc_1001870D
		push	0FFFFFFFFh	; int
		push	ebx		; int
		push	eax		; int
		mov	ecx, ebp	; void *
		call	sub_100023D9

loc_1001870D:				; CODE XREF: sub_100184BD+23Bj
					; sub_100184BD+243j
		mov	bl, 1

loc_1001870F:				; CODE XREF: sub_100184BD+12Dj
					; sub_100184BD+17Cj
		test	esi, esi
		jz	short loc_1001871B
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_1001871B:				; CODE XREF: sub_100184BD+254j
		push	0
		push	1
		lea	ecx, [esp+8Ch+lpszShortPath]
		call	sub_10002311
		mov	ecx, [esp+84h+var_8]
		mov	al, bl
		pop	edi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 74h
		retn
sub_100184BD	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001873D	proc near		; CODE XREF: sub_10011C65+Bp
					; sub_10018091+70p ...

var_14		= dword	ptr -14h
var_10		= dword	ptr -10h
var_C		= dword	ptr -0Ch
var_8		= byte ptr -8

		sub	esp, 14h
		push	ebx
		push	ebp
		push	esi
		mov	[esp+20h+var_C], edx
		mov	ebp, ecx
		xor	ebx, ebx
		lea	edx, [esp+20h+var_10]
		push	edi
		mov	ecx, offset aNtqueryobject ; "NtQueryObject"
		mov	[esp+24h+var_10], ebx
		call	sub_10018835
		push	8
		pop	ecx
		lea	eax, [esp+24h+var_14]
		mov	[esp+24h+var_14], ecx
		push	eax
		push	ecx
		lea	edi, [esp+2Ch+var_8]
		mov	eax, edi
		push	eax
		push	1
		push	ebp
		call	[esp+38h+var_10]
		mov	esi, ebx
		cmp	[esp+24h+var_14], ebx
		jz	short loc_100187A0
		push	[esp+24h+var_14]
		call	sub_10018CBA
		pop	ecx
		mov	edi, eax
		lea	eax, [esp+24h+var_14]
		push	eax
		push	[esp+28h+var_14]
		mov	esi, edi
		push	edi
		push	1
		push	ebp
		call	[esp+38h+var_10]

loc_100187A0:				; CODE XREF: sub_1001873D+42j
		test	eax, eax
		jnz	short loc_100187B8
		movzx	eax, word ptr [edi]
		mov	ecx, [esp+24h+var_C] ; void *
		shr	eax, 1
		push	eax		; int
		push	dword ptr [edi+4] ; void *
		call	sub_10002356
		mov	bl, 1

loc_100187B8:				; CODE XREF: sub_1001873D+65j
		test	esi, esi
		jz	short loc_100187C4
		push	esi
		call	ds:__imp_??3@YAXPAX@Z ;	operator delete(void *)
		pop	ecx

loc_100187C4:				; CODE XREF: sub_1001873D+7Dj
		pop	edi
		pop	esi
		pop	ebp
		mov	al, bl
		pop	ebx
		add	esp, 14h
		retn
sub_1001873D	endp


; =============== S U B	R O U T	I N E =======================================


; int __usercall sub_100187CE@<eax>(HANDLE hProcess@<ecx>, LPVOID lpAddress@<edx>, LPVOID lpBuffer, DWORD dwSize)
sub_100187CE	proc near		; CODE XREF: sub_100156CD+E1p

flOldProtect	= dword	ptr -8
NumberOfBytesWritten= dword ptr	-4
lpBuffer	= dword	ptr  4
dwSize		= dword	ptr  8

		push	ecx
		push	ecx
		push	ebp
		push	esi
		mov	esi, [esp+10h+dwSize]
		lea	eax, [esp+10h+flOldProtect]
		push	edi
		push	eax		; lpflOldProtect
		push	8		; flNewProtect
		push	esi		; dwSize
		mov	edi, edx
		mov	ebp, ecx
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualProtectEx
		test	eax, eax
		jnz	short loc_100187F3
		xor	al, al
		jmp	short loc_1001882F
; ---------------------------------------------------------------------------

loc_100187F3:				; CODE XREF: sub_100187CE+1Fj
		push	ebx
		lea	eax, [esp+18h+NumberOfBytesWritten]
		push	eax		; lpNumberOfBytesWritten
		push	esi		; nSize
		push	[esp+20h+lpBuffer] ; lpBuffer
		push	edi		; lpBaseAddress
		push	ebp		; hProcess
		call	ds:WriteProcessMemory
		test	eax, eax
		jz	short loc_10018814
		cmp	esi, [esp+18h+NumberOfBytesWritten]
		jnz	short loc_10018814
		mov	bl, 1
		jmp	short loc_10018816
; ---------------------------------------------------------------------------

loc_10018814:				; CODE XREF: sub_100187CE+3Aj
					; sub_100187CE+40j
		xor	bl, bl

loc_10018816:				; CODE XREF: sub_100187CE+44j
		lea	eax, [esp+18h+flOldProtect]
		push	eax		; lpflOldProtect
		push	[esp+1Ch+flOldProtect] ; flNewProtect
		push	esi		; dwSize
		push	edi		; lpAddress
		push	ebp		; hProcess
		call	ds:VirtualProtectEx
		neg	eax
		sbb	al, al
		and	al, bl
		pop	ebx

loc_1001882F:				; CODE XREF: sub_100187CE+23j
		pop	edi
		pop	esi
		pop	ebp
		pop	ecx
		pop	ecx
		retn
sub_100187CE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_10018835(LPCSTR lpProcName)
sub_10018835	proc near		; CODE XREF: sub_1000B303+19p
					; sub_1000B872+25p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		cmp	hModule, 0
		push	ebx
		push	esi
		push	edi
		mov	edi, edx
		mov	ebx, ecx
		jnz	short loc_10018884
		push	offset aNtdll_dll_4 ; "ntdll.dll"
		call	ds:GetModuleHandleW
		mov	esi, eax
		mov	[ebp+var_8], offset off_1001AA20
		lea	ecx, [ebp+var_8]
		mov	[ebp+var_4], esi
		call	sub_100058D3
		test	al, al
		jnz	short loc_1001886F
		int	3		; Trap to Debugger

loc_1001886F:				; CODE XREF: sub_10018835+37j
		mov	ecx, offset hModule
		xor	eax, eax
		lock cmpxchg [ecx], esi
		cmp	hModule, 0
		jnz	short loc_10018884
		int	3		; Trap to Debugger

loc_10018884:				; CODE XREF: sub_10018835+14j
					; sub_10018835+4Cj
		push	ebx		; lpProcName
		push	hModule		; hModule
		call	ds:GetProcAddress
		mov	[edi], eax
		test	eax, eax
		jnz	short loc_10018898
		int	3		; Trap to Debugger

loc_10018898:				; CODE XREF: sub_10018835+60j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10018835	endp


; =============== S U B	R O U T	I N E =======================================


sub_1001889F	proc near		; CODE XREF: sub_10018182+D3p
					; sub_100184BD+11Fp

var_4		= dword	ptr -4

		push	ecx
		push	ebx
		push	ebp
		push	esi
		push	edi
		mov	edx, ecx
		push	5Ch
		pop	ebp
		mov	[esp+14h+var_4], ebp
		mov	eax, [edx+10h]
		cmp	eax, 1
		jb	short loc_1001891F
		dec	eax
		cmp	eax, 0FFFFFFFFh
		jbe	short loc_100188BE
		or	eax, 0FFFFFFFFh

loc_100188BE:				; CODE XREF: sub_1001889F+1Aj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_100188C6
		mov	ecx, [edx]

loc_100188C6:				; CODE XREF: sub_1001889F+23j
		lea	ecx, [ecx+eax*2]

loc_100188C9:				; CODE XREF: sub_1001889F+70j
		cmp	[ecx], bp
		jnz	short loc_100188FC
		xor	ebx, ebx
		lea	esi, [esp+14h+var_4]
		inc	ebx
		mov	edi, ecx

loc_100188D7:				; CODE XREF: sub_1001889F+47j
		mov	ax, [edi]
		cmp	ax, [esi]
		jnz	short loc_100188EC
		add	edi, 2
		add	esi, 2
		dec	ebx
		jnz	short loc_100188D7
		xor	eax, eax
		jmp	short loc_100188F8
; ---------------------------------------------------------------------------

loc_100188EC:				; CODE XREF: sub_1001889F+3Ej
		movzx	eax, word ptr [edi]
		cmp	ax, [esi]
		sbb	eax, eax
		and	eax, 0FFFFFFFEh
		inc	eax

loc_100188F8:				; CODE XREF: sub_1001889F+4Bj
		test	eax, eax
		jz	short loc_10018911

loc_100188FC:				; CODE XREF: sub_1001889F+2Dj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10018906
		mov	eax, [edx]
		jmp	short loc_10018908
; ---------------------------------------------------------------------------

loc_10018906:				; CODE XREF: sub_1001889F+61j
		mov	eax, edx

loc_10018908:				; CODE XREF: sub_1001889F+65j
		cmp	ecx, eax
		jz	short loc_1001891F
		sub	ecx, 2
		jmp	short loc_100188C9
; ---------------------------------------------------------------------------

loc_10018911:				; CODE XREF: sub_1001889F+5Bj
		cmp	dword ptr [edx+14h], 8
		jb	short loc_10018919
		mov	edx, [edx]

loc_10018919:				; CODE XREF: sub_1001889F+76j
		sub	ecx, edx
		sar	ecx, 1
		jmp	short loc_10018922
; ---------------------------------------------------------------------------

loc_1001891F:				; CODE XREF: sub_1001889F+14j
					; sub_1001889F+6Bj
		or	ecx, 0FFFFFFFFh

loc_10018922:				; CODE XREF: sub_1001889F+7Ej
		pop	edi
		pop	esi
		pop	ebp
		mov	eax, ecx
		pop	ebx
		pop	ecx
		retn	8
sub_1001889F	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __thiscall sub_1001892C(HANDLE handle)
sub_1001892C	proc near		; CODE XREF: sub_10018960+1Dp
					; sub_100189BE+81p

ppDacl		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	esi
		xor	esi, esi
		mov	dword ptr [edx], 0Ch
		lea	eax, [edx+4]
		mov	[edx+8], esi
		push	eax		; ppSecurityDescriptor
		push	esi		; ppSacl
		lea	eax, [ebp+ppDacl]
		mov	[ebp+ppDacl], esi
		push	eax		; ppDacl
		push	esi		; ppsidGroup
		push	esi		; ppsidOowner
		push	4		; SecurityInfo
		push	7		; ObjectType
		push	ecx		; handle
		call	ds:GetSecurityInfo
		neg	eax
		pop	esi
		sbb	al, al
		inc	al
		mov	esp, ebp
		pop	ebp
		retn
sub_1001892C	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018960	proc near		; CODE XREF: sub_1001486D:loc_100148B5p

sa		= _SECURITY_ATTRIBUTES ptr -0Ch

		push	ebp
		mov	ebp, esp
		sub	esp, 0Ch
		push	esi
		xor	esi, esi
		mov	[ebp+sa.nLength], esi
		mov	[ebp+sa.lpSecurityDescriptor], esi
		mov	[ebp+sa.bInheritHandle], esi
		call	ds:GetProcessWindowStation
		lea	edx, [ebp+sa]
		mov	ecx, eax	; handle
		call	sub_1001892C
		test	al, al
		jnz	short loc_1001898B
		push	0Ch
		pop	eax
		jmp	short loc_100189B9
; ---------------------------------------------------------------------------

loc_1001898B:				; CODE XREF: sub_10018960+24j
		lea	eax, [ebp+sa]
		push	eax		; lpsa
		push	80000008h	; dwDesiredAccess
		push	esi		; dwReserved
		push	esi		; lpwinsta
		call	ds:CreateWindowStationW
		push	[ebp+sa.lpSecurityDescriptor] ;	hMem
		mov	hObj, eax
		call	ds:LocalFree
		mov	eax, hObj
		neg	eax
		sbb	eax, eax
		and	eax, 0FFFFFFF4h
		add	eax, 0Ch

loc_100189B9:				; CODE XREF: sub_10018960+29j
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10018960	endp


; =============== S U B	R O U T	I N E =======================================


; int __thiscall sub_100189BE(HWINSTA hWinSta)
sub_100189BE	proc near		; CODE XREF: sub_1001486D+A1p
					; sub_1001486D+113p

sa		= _SECURITY_ATTRIBUTES ptr -98h
lpszDesktop	= dword	ptr -8Ch
var_78		= dword	ptr -78h
pSid		= byte ptr -74h
DstBuf		= word ptr -28h
var_8		= dword	ptr -8

		sub	esp, 98h
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+98h+var_8], eax
		push	ebx
		push	ebp
		push	esi
		mov	esi, ecx
		lea	ecx, [esp+0A4h+lpszDesktop] ; void *
		push	offset aSbox_alternate ; "sbox_alternate_desktop_"
		call	sub_10001C7F
		call	ds:GetCurrentProcessId
		push	eax		; ArgList
		push	offset Format	; "0x%X"
		lea	eax, [esp+0ACh+DstBuf]
		push	10h		; MaxCount
		push	eax		; DstBuf
		call	sub_10018C67
		add	esp, 10h
		lea	ecx, [esp+0A4h+DstBuf]
		call	sub_10001AF3
		push	eax		; int
		lea	eax, [esp+0A8h+DstBuf]
		push	eax		; void *
		lea	ecx, [esp+0ACh+lpszDesktop]
		call	sub_10003388
		xor	ebp, ebp
		mov	[esp+0A4h+sa.nLength], ebp
		mov	[esp+0A4h+sa.lpSecurityDescriptor], ebp
		mov	[esp+0A4h+sa.bInheritHandle], ebp
		call	ds:GetCurrentThreadId
		push	eax		; dwThreadId
		call	ds:GetThreadDesktop
		lea	edx, [esp+0A4h+sa]
		mov	ecx, eax	; handle
		call	sub_1001892C
		test	al, al
		jz	short loc_10018A69
		call	ds:GetProcessWindowStation
		mov	ebx, eax
		test	esi, esi
		jz	short loc_10018A92
		push	esi		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_10018A92
		push	[esp+0A4h+sa.lpSecurityDescriptor] ; hMem
		call	ds:LocalFree

loc_10018A69:				; CODE XREF: sub_100189BE+88j
					; sub_100189BE+11Fj
		push	0Bh

loc_10018A6B:				; CODE XREF: sub_100189BE+117j
		pop	esi

loc_10018A6C:				; CODE XREF: sub_100189BE+13Fj
		push	ebp
		push	1
		lea	ecx, [esp+0ACh+lpszDesktop]
		call	sub_10002311
		mov	ecx, [esp+0A4h+var_8]
		mov	eax, esi
		pop	esi
		pop	ebp
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		add	esp, 98h
		retn
; ---------------------------------------------------------------------------

loc_10018A92:				; CODE XREF: sub_100189BE+94j
					; sub_100189BE+9Fj
		cmp	[esp+0A4h+var_78], 8
		mov	eax, [esp+0A4h+lpszDesktop]
		jnb	short loc_10018AA1
		lea	eax, [esp+0A4h+lpszDesktop]

loc_10018AA1:				; CODE XREF: sub_100189BE+DDj
		lea	ecx, [esp+0A4h+sa]
		push	ecx		; lpsa
		push	0E0003h		; dwDesiredAccess
		push	ebp		; dwFlags
		push	ebp		; pDevmode
		push	ebp		; lpszDevice
		push	eax		; lpszDesktop
		call	ds:CreateDesktopW
		push	[esp+0A4h+sa.lpSecurityDescriptor] ; hMem
		mov	handle,	eax
		call	ds:LocalFree
		test	esi, esi
		jz	short loc_10018AD7
		push	ebx		; hWinSta
		call	ds:SetProcessWindowStation
		test	eax, eax
		jnz	short loc_10018AD7
		push	0Dh
		jmp	short loc_10018A6B
; ---------------------------------------------------------------------------

loc_10018AD7:				; CODE XREF: sub_100189BE+108j
					; sub_100189BE+113j
		cmp	handle,	ebp
		jz	short loc_10018A69
		push	ecx
		push	ecx
		push	12h		; WellKnownSidType
		lea	ecx, [esp+0B0h+pSid] ; pSid
		call	sub_10016266
		mov	ecx, handle	; handle
		push	eax		; pSourceSid
		call	sub_1000799B
		add	esp, 0Ch
		mov	esi, ebp
		jmp	loc_10018A6C
sub_100189BE	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __fastcall sub_10018B02(void *, HANDLE hObj)
sub_10018B02	proc near		; CODE XREF: sub_1001486D+66p
					; sub_1001486D+BBp ...

nLengthNeeded	= dword	ptr -4

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ebx
		push	esi
		push	edi
		xor	esi, esi
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	esi		; nLength
		push	esi		; pvInfo
		push	2
		pop	eax
		mov	ebx, edx
		mov	[ebp+nLengthNeeded], esi
		push	eax		; nIndex
		push	ebx		; hObj
		mov	edi, ecx
		mov	[ebp+nLengthNeeded], esi
		call	ds:GetUserObjectInformationW
		mov	eax, [ebp+nLengthNeeded]
		test	eax, eax
		jnz	short loc_10018B3C
		mov	dword ptr [edi+14h], 7
		mov	[edi+10h], esi
		mov	[edi], ax
		jmp	short loc_10018B8D
; ---------------------------------------------------------------------------

loc_10018B3C:				; CODE XREF: sub_10018B02+29j
		xor	ecx, ecx
		push	2
		pop	edx
		mul	edx
		seto	cl
		neg	ecx
		or	ecx, eax
		push	ecx
		call	sub_10018CBA
		pop	ecx
		mov	esi, eax
		lea	eax, [ebp+nLengthNeeded]
		push	eax		; lpnLengthNeeded
		push	[ebp+nLengthNeeded] ; nLength
		push	esi		; pvInfo
		push	2
		pop	eax
		push	eax		; nIndex
		push	ebx		; hObj
		call	ds:GetUserObjectInformationW
		test	eax, eax
		jnz	short loc_10018B79
		and	[edi+10h], eax
		mov	dword ptr [edi+14h], 7
		mov	[edi], ax
		jmp	short loc_10018B81
; ---------------------------------------------------------------------------

loc_10018B79:				; CODE XREF: sub_10018B02+66j
		push	esi		; void *
		mov	ecx, edi	; void *
		call	sub_10001C7F

loc_10018B81:				; CODE XREF: sub_10018B02+75j
		test	esi, esi
		jz	short loc_10018B8D
		push	esi
		call	ds:??_V@YAXPAX@Z ; operator delete[](void *)
		pop	ecx

loc_10018B8D:				; CODE XREF: sub_10018B02+38j
					; sub_10018B02+81j
		mov	eax, edi
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn
sub_10018B02	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018B96	proc near		; CODE XREF: sub_10014818+48p

var_38		= dword	ptr -38h
var_34		= word ptr -34h
var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
var_1C		= byte ptr -1Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		and	esp, 0FFFFFFF8h
		sub	esp, 3Ch
		mov	eax, ___security_cookie
		xor	eax, esp
		mov	[esp+3Ch+var_4], eax
		mov	edx, hObj	; hObj
		xor	eax, eax
		push	ebx
		push	esi
		push	edi
		mov	edi, handle
		xor	ebx, ebx
		mov	[esp+48h+var_38], ebx
		mov	esi, ecx
		test	edi, edi
		jnz	short loc_10018BD6
		mov	dword ptr [esi+14h], 7
		mov	[esi+10h], ebx
		mov	[esi], ax
		jmp	short loc_10018C53
; ---------------------------------------------------------------------------

loc_10018BD6:				; CODE XREF: sub_10018B96+2Fj
		mov	[esp+48h+var_20], 7
		mov	[esp+48h+var_24], ebx
		mov	[esp+48h+var_34], ax
		test	edx, edx
		jz	short loc_10018C17
		lea	ecx, [esp+48h+var_1C] ;	void *
		call	sub_10018B02
		push	eax		; void *
		lea	ecx, [esp+4Ch+var_34]
		call	sub_10003B36
		push	ebx
		push	1
		lea	ecx, [esp+50h+var_1C]
		call	sub_10002311
		push	5Ch
		push	1
		lea	ecx, [esp+50h+var_34]
		call	sub_100030C7

loc_10018C17:				; CODE XREF: sub_10018B96+53j
		mov	edx, edi	; hObj
		lea	ecx, [esp+48h+var_1C] ;	void *
		call	sub_10018B02
		push	0FFFFFFFFh
		push	ebx
		push	eax
		lea	ecx, [esp+54h+var_34]
		call	sub_100032F4
		push	ebx
		push	1
		lea	ecx, [esp+50h+var_1C]
		call	sub_10002311
		lea	eax, [esp+48h+var_34]
		mov	ecx, esi
		push	eax		; void *
		call	sub_10003481
		push	ebx
		push	1
		lea	ecx, [esp+50h+var_34]
		call	sub_10002311

loc_10018C53:				; CODE XREF: sub_10018B96+3Ej
		mov	ecx, [esp+48h+var_4]
		mov	eax, esi
		pop	edi
		pop	esi
		pop	ebx
		xor	ecx, esp
		call	@__security_check_cookie@4 ; __security_check_cookie(x)
		mov	esp, ebp
		pop	ebp
		retn
sub_10018B96	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_10018C67(wchar_t *DstBuf, size_t MaxCount, wchar_t *Format, char ArgList)
sub_10018C67	proc near		; CODE XREF: sub_100189BE+3Dp

DstBuf		= dword	ptr  4
MaxCount	= dword	ptr  8
Format		= dword	ptr  0Ch
ArgList		= byte ptr  10h

		lea	eax, [esp+ArgList]
		push	eax		; ArgList
		push	[esp+4+Format]	; Format
		push	[esp+8+MaxCount] ; MaxCount
		push	10h		; SizeInWords
		push	[esp+10h+DstBuf] ; DstBuf
		call	ds:_vsnwprintf_s
		add	esp, 14h
		retn
sub_10018C67	endp

; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018CBA	proc near		; CODE XREF: sub_10006340+2Ep
					; sub_100097F5+72p ...
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	??2@YAPAXI@Z	; operator new(uint)
sub_10018CBA	endp


; =============== S U B	R O U T	I N E =======================================


sub_10018CC3	proc near		; CODE XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+Cp
		mov	ecx, [ecx+4]
		mov	eax, [ecx]
		call	dword ptr [eax+8]
		test	eax, eax
		jz	short locret_10018CD7
		mov	edx, [eax]
		mov	ecx, eax
		push	1
		call	dword ptr [edx]

locret_10018CD7:			; CODE XREF: sub_10018CC3+Aj
		retn
sub_10018CC3	endp

; [00000024 BYTES: COLLAPSED FUNCTION std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)]
; [00000028 BYTES: COLLAPSED FUNCTION std::_Facet_Register(std::_Facet_base *)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const &)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)]
; [00000006 BYTES: COLLAPSED FUNCTION std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)]
; [0000000F BYTES: COLLAPSED FUNCTION __security_check_cookie(x)]
; [0000003C BYTES: COLLAPSED FUNCTION ___atonexitinit]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018DA5(_onexit_t)
sub_10018DA5	proc near		; CODE XREF: sub_1000D77D+30p
					; sub_10018E4E+6p

var_24		= dword	ptr -24h
var_20		= dword	ptr -20h
Ptr		= dword	ptr -1Ch
ms_exc		= CPPEH_RECORD ptr -18h
arg_0		= dword	ptr  8

		push	14h
		push	offset stru_1002DFC8
		call	__SEH_prolog4
		and	[ebp+var_24], 0
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		cmp	eax, 0FFFFFFFFh
		jnz	short loc_10018DD7
		push	[ebp+arg_0]	; _onexit_t
		call	ds:_onexit
		pop	ecx
		jmp	short loc_10018E3C
; ---------------------------------------------------------------------------

loc_10018DD7:				; CODE XREF: sub_10018DA5+24j
		push	8
		call	_lock
		pop	ecx
		and	[ebp+ms_exc.registration.TryLevel], 0
		push	Ptr		; Ptr
		call	esi ; DecodePointer
		mov	[ebp+Ptr], eax
		push	dword_10031FB4	; Ptr
		call	esi ; DecodePointer
		mov	[ebp+var_20], eax
		lea	eax, [ebp+var_20]
		push	eax
		lea	eax, [ebp+Ptr]
		push	eax
		push	[ebp+arg_0]	; Ptr
		mov	esi, ds:EncodePointer
		call	esi ; EncodePointer
		push	eax
		call	__dllonexit
		add	esp, 0Ch
		mov	edi, eax
		mov	[ebp+var_24], edi
		push	[ebp+Ptr]	; Ptr
		call	esi ; EncodePointer
		mov	Ptr, eax
		push	[ebp+var_20]	; Ptr
		call	esi ; EncodePointer
		mov	dword_10031FB4,	eax
		mov	[ebp+ms_exc.registration.TryLevel], 0FFFFFFFEh
		call	loc_10018E45
; ---------------------------------------------------------------------------

loc_10018E3A:				; CODE XREF: sub_10018DA5+A8j
		mov	eax, edi

loc_10018E3C:				; CODE XREF: sub_10018DA5+30j
		call	__SEH_epilog4
		retn
; ---------------------------------------------------------------------------

loc_10018E42:				; DATA XREF: .rdata:stru_1002DFC8o
		mov	edi, [ebp+var_24] ; Finally handler 0 for function 10018DA5

loc_10018E45:				; CODE XREF: sub_10018DA5+90j
		push	8
		call	_unlock
		pop	ecx
		retn
sub_10018DA5	endp


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

; int __cdecl sub_10018E4E(_onexit_t)
sub_10018E4E	proc near		; CODE XREF: sub_10001000+5p
					; sub_1000100C+5p ...

arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		push	[ebp+arg_0]	; _onexit_t
		call	sub_10018DA5
		neg	eax
		pop	ecx
		sbb	eax, eax
		neg	eax
		dec	eax
		pop	ebp
		retn
sub_10018E4E	endp

; ---------------------------------------------------------------------------
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _purecall]
; [00000006 BYTES: COLLAPSED FUNCTION operator delete(void *)]
; [00000006 BYTES: COLLAPSED FUNCTION operator new(uint)]
; [0000004C BYTES: COLLAPSED FUNCTION _pre_c_init]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10018EC2	proc near		; CODE XREF: ___DllMainCRTStartup+64p
					; ___DllMainCRTStartup+A3p ...

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		push	ecx
		push	ecx
		cmp	[ebp+arg_4], 0
		push	ebx
		push	esi
		push	edi
		jnz	loc_10018FFD
		mov	eax, dword_10031038
		test	eax, eax
		jle	loc_10018FF6
		dec	eax
		mov	ebx, offset dword_10031FA8
		mov	dword_10031038,	eax
		xor	edi, edi
		mov	eax, large fs:18h
		mov	[ebp+var_4], edi
		mov	edx, [eax+4]
		jmp	short loc_10018F00
; ---------------------------------------------------------------------------

loc_10018EFC:				; CODE XREF: sub_10018EC2+48j
		cmp	eax, edx
		jz	short loc_10018F0E

loc_10018F00:				; CODE XREF: sub_10018EC2+38j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_10018EFC
		jmp	short loc_10018F15
; ---------------------------------------------------------------------------

loc_10018F0E:				; CODE XREF: sub_10018EC2+3Cj
		mov	[ebp+var_4], 1

loc_10018F15:				; CODE XREF: sub_10018EC2+4Aj
		cmp	dword_10031FAC,	2
		jz	short loc_10018F2B
		push	1Fh
		call	_amsg_exit
		pop	ecx
		jmp	loc_100190AD
; ---------------------------------------------------------------------------

loc_10018F2B:				; CODE XREF: sub_10018EC2+5Aj
		push	Ptr		; Ptr
		call	ds:DecodePointer
		mov	esi, eax
		mov	[ebp+arg_8], esi
		test	esi, esi
		jz	loc_10018FDE
		push	dword_10031FB4	; Ptr
		call	ds:DecodePointer
		mov	ebx, eax
		mov	[ebp+arg_4], esi
		mov	[ebp+arg_0], ebx

loc_10018F58:				; CODE XREF: sub_10018EC2+9Fj
					; sub_10018EC2+AAj ...
		sub	ebx, 4
		cmp	ebx, esi
		jb	short loc_10018FBB
		cmp	[ebx], edi
		jz	short loc_10018F58
		push	edi		; Ptr
		call	ds:EncodePointer
		cmp	[ebx], eax
		jz	short loc_10018F58
		push	dword ptr [ebx]	; Ptr
		call	ds:DecodePointer
		push	edi		; Ptr
		mov	esi, eax
		call	ds:EncodePointer
		mov	[ebx], eax
		call	esi
		push	Ptr		; Ptr
		mov	esi, ds:DecodePointer
		call	esi ; DecodePointer
		push	dword_10031FB4	; Ptr
		mov	[ebp+var_8], eax
		call	esi ; DecodePointer
		mov	ecx, [ebp+var_8]
		cmp	[ebp+arg_4], ecx
		jnz	short loc_10018FAC
		mov	esi, [ebp+arg_8]
		cmp	[ebp+arg_0], eax
		jz	short loc_10018F58

loc_10018FAC:				; CODE XREF: sub_10018EC2+E0j
		mov	esi, ecx
		mov	[ebp+arg_4], ecx
		mov	[ebp+arg_8], esi
		mov	ebx, eax
		mov	[ebp+arg_0], eax
		jmp	short loc_10018F58
; ---------------------------------------------------------------------------

loc_10018FBB:				; CODE XREF: sub_10018EC2+9Bj
		cmp	esi, 0FFFFFFFFh
		jz	short loc_10018FC8
		push	esi		; void *
		call	ds:free
		pop	ecx

loc_10018FC8:				; CODE XREF: sub_10018EC2+FCj
		push	edi		; Ptr
		call	ds:EncodePointer
		mov	dword_10031FB4,	eax
		mov	ebx, offset dword_10031FA8
		mov	Ptr, eax

loc_10018FDE:				; CODE XREF: sub_10018EC2+7Cj
		mov	dword_10031FAC,	edi
		cmp	[ebp+var_4], edi
		jnz	loc_100190AD
		xor	eax, eax
		xchg	eax, [ebx]
		jmp	loc_100190AD
; ---------------------------------------------------------------------------

loc_10018FF6:				; CODE XREF: sub_10018EC2+19j
					; sub_10018EC2+19Fj
		xor	eax, eax
		jmp	loc_100190B0
; ---------------------------------------------------------------------------

loc_10018FFD:				; CODE XREF: sub_10018EC2+Cj
		cmp	[ebp+arg_4], 1
		jnz	loc_100190AD
		mov	eax, large fs:18h
		xor	edi, edi
		mov	esi, edi
		mov	ebx, offset dword_10031FA8
		mov	edx, [eax+4]
		jmp	short loc_1001901F
; ---------------------------------------------------------------------------

loc_1001901B:				; CODE XREF: sub_10018EC2+167j
		cmp	eax, edx
		jz	short loc_1001902D

loc_1001901F:				; CODE XREF: sub_10018EC2+157j
		xor	eax, eax
		mov	ecx, edx
		lock cmpxchg [ebx], ecx
		test	eax, eax
		jnz	short loc_1001901B
		jmp	short loc_10019030
; ---------------------------------------------------------------------------

loc_1001902D:				; CODE XREF: sub_10018EC2+15Bj
		xor	esi, esi
		inc	esi

loc_10019030:				; CODE XREF: sub_10018EC2+169j
		cmp	dword_10031FAC,	edi
		push	2
		pop	edi
		jz	short loc_10019044
		push	1Fh
		call	_amsg_exit
		jmp	short loc_10019079
; ---------------------------------------------------------------------------

loc_10019044:				; CODE XREF: sub_10018EC2+177j
		push	offset dword_1001A394
		push	offset dword_1001A388
		mov	dword_10031FAC,	1
		call	_initterm_e
		pop	ecx
		pop	ecx
		test	eax, eax
		jnz	short loc_10018FF6
		push	offset dword_1001A384
		push	offset dword_1001A36C
		call	_initterm
		pop	ecx
		mov	dword_10031FAC,	edi

loc_10019079:				; CODE XREF: sub_10018EC2+180j
		pop	ecx
		test	esi, esi
		jnz	short loc_10019082
		xor	eax, eax
		xchg	eax, [ebx]

loc_10019082:				; CODE XREF: sub_10018EC2+1BAj
		cmp	dword_10031FB0,	0
		jz	short loc_100190A7
		push	offset dword_10031FB0
		call	__IsNonwritableInCurrentImage
		pop	ecx
		test	eax, eax
		jz	short loc_100190A7
		push	[ebp+arg_8]
		push	edi
		push	[ebp+arg_0]
		call	dword_10031FB0

loc_100190A7:				; CODE XREF: sub_10018EC2+1C7j
					; sub_10018EC2+1D6j
		inc	dword_10031038

loc_100190AD:				; CODE XREF: sub_10018EC2+64j
					; sub_10018EC2+125j ...
		xor	eax, eax
		inc	eax

loc_100190B0:				; CODE XREF: sub_10018EC2+136j
		pop	edi
		pop	esi
		pop	ebx
		mov	esp, ebp
		pop	ebp
		retn	0Ch
sub_10018EC2	endp

; [00000023 BYTES: COLLAPSED FUNCTION DllEntryPoint]
; [00000133 BYTES: COLLAPSED FUNCTION ___DllMainCRTStartup]
; [0000003D BYTES: COLLAPSED FUNCTION ___raise_securityfailure]
; [000000FB BYTES: COLLAPSED FUNCTION ___report_gsfailure]
		align 4
; [00000006 BYTES: COLLAPSED FUNCTION _lock]
; [00000006 BYTES: COLLAPSED FUNCTION _unlock]
; [00000006 BYTES: COLLAPSED FUNCTION __dllonexit]
		align 10h
; [00000045 BYTES: COLLAPSED FUNCTION __SEH_prolog4]
; [00000014 BYTES: COLLAPSED FUNCTION __SEH_epilog4]
; [00000023 BYTES: COLLAPSED FUNCTION __except_handler4]
; [00000006 BYTES: COLLAPSED FUNCTION __CppXcptFilter]
; [00000006 BYTES: COLLAPSED FUNCTION _amsg_exit]
		align 10h

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_100193F0	proc near		; CODE XREF: __IsNonwritableInCurrentImage+59p

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		mov	ebp, esp
		mov	eax, [ebp+arg_0]
		xor	edx, edx
		push	ebx
		push	esi
		push	edi
		mov	ecx, [eax+3Ch]
		add	ecx, eax
		movzx	eax, word ptr [ecx+14h]
		movzx	ebx, word ptr [ecx+6]
		add	eax, 18h
		add	eax, ecx
		test	ebx, ebx
		jz	short loc_1001942C
		mov	edi, [ebp+arg_4]

loc_10019414:				; CODE XREF: sub_100193F0+3Aj
		mov	esi, [eax+0Ch]
		cmp	edi, esi
		jb	short loc_10019424
		mov	ecx, [eax+8]
		add	ecx, esi
		cmp	edi, ecx
		jb	short loc_1001942E

loc_10019424:				; CODE XREF: sub_100193F0+29j
		inc	edx
		add	eax, 28h
		cmp	edx, ebx
		jb	short loc_10019414

loc_1001942C:				; CODE XREF: sub_100193F0+1Fj
		xor	eax, eax

loc_1001942E:				; CODE XREF: sub_100193F0+32j
		pop	edi
		pop	esi
		pop	ebx
		pop	ebp
		retn
sub_100193F0	endp

; ---------------------------------------------------------------------------
		align 10h
; [000000BA BYTES: COLLAPSED FUNCTION __IsNonwritableInCurrentImage]
		align 10h
; [00000031 BYTES: COLLAPSED FUNCTION __ValidateImageBase]

; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame

sub_10019531	proc near		; CODE XREF: DllEntryPoint+9p

PerformanceCount= LARGE_INTEGER	ptr -14h
SystemTimeAsFileTime= _FILETIME	ptr -0Ch
var_4		= dword	ptr -4

		push	ebp
		mov	ebp, esp
		sub	esp, 14h
		and	[ebp+SystemTimeAsFileTime.dwLowDateTime], 0
		and	[ebp+SystemTimeAsFileTime.dwHighDateTime], 0
		mov	eax, ___security_cookie
		push	esi
		push	edi
		mov	edi, 0BB40E64Eh
		mov	esi, 0FFFF0000h
		cmp	eax, edi
		jz	short loc_10019561
		test	esi, eax
		jz	short loc_10019561
		not	eax
		mov	dword_10031004,	eax
		jmp	short loc_100195C7
; ---------------------------------------------------------------------------

loc_10019561:				; CODE XREF: sub_10019531+21j
					; sub_10019531+25j
		lea	eax, [ebp+SystemTimeAsFileTime]
		push	eax		; lpSystemTimeAsFileTime
		call	ds:GetSystemTimeAsFileTime
		mov	eax, [ebp+SystemTimeAsFileTime.dwHighDateTime]
		xor	eax, [ebp+SystemTimeAsFileTime.dwLowDateTime]
		mov	[ebp+var_4], eax
		call	ds:GetCurrentThreadId
		xor	[ebp+var_4], eax
		call	ds:GetCurrentProcessId
		xor	[ebp+var_4], eax
		lea	eax, [ebp+PerformanceCount]
		push	eax		; lpPerformanceCount
		call	ds:QueryPerformanceCounter
		mov	ecx, dword ptr [ebp+PerformanceCount+4]
		lea	eax, [ebp+var_4]
		xor	ecx, dword ptr [ebp+PerformanceCount]
		xor	ecx, [ebp+var_4]
		xor	ecx, eax
		cmp	ecx, edi
		jnz	short loc_100195A9
		mov	ecx, 0BB40E64Fh
		jmp	short loc_100195B9
; ---------------------------------------------------------------------------

loc_100195A9:				; CODE XREF: sub_10019531+6Fj
		test	esi, ecx
		jnz	short loc_100195B9
		mov	eax, ecx
		or	eax, 4711h
		shl	eax, 10h
		or	ecx, eax

loc_100195B9:				; CODE XREF: sub_10019531+76j
					; sub_10019531+7Aj
		mov	___security_cookie, ecx
		not	ecx
		mov	dword_10031004,	ecx

loc_100195C7:				; CODE XREF: sub_10019531+2Ej
		pop	edi
		pop	esi
		mov	esp, ebp
		pop	ebp
		retn
sub_10019531	endp

; [00000022 BYTES: COLLAPSED FUNCTION DllMain(x,x,x)]

; =============== S U B	R O U T	I N E =======================================


sub_100195EF	proc near		; CODE XREF: _pre_c_init+2Cp
		push	esi
		push	edi
		mov	esi, offset dword_1002DC68
		mov	edi, offset dword_1002DC68
		jmp	short loc_10019608
; ---------------------------------------------------------------------------

loc_100195FD:				; CODE XREF: sub_100195EF+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10019605
		call	eax

loc_10019605:				; CODE XREF: sub_100195EF+12j
		add	esi, 4

loc_10019608:				; CODE XREF: sub_100195EF+Cj
		cmp	esi, edi
		jb	short loc_100195FD
		pop	edi
		pop	esi
		retn
sub_100195EF	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001960F()
sub_1001960F	proc near		; DATA XREF: _pre_c_init+31o
		push	esi
		push	edi
		mov	esi, offset dword_1002DC70
		mov	edi, offset dword_1002DC70
		jmp	short loc_10019628
; ---------------------------------------------------------------------------

loc_1001961D:				; CODE XREF: sub_1001960F+1Bj
		mov	eax, [esi]
		test	eax, eax
		jz	short loc_10019625
		call	eax

loc_10019625:				; CODE XREF: sub_1001960F+12j
		add	esi, 4

loc_10019628:				; CODE XREF: sub_1001960F+Cj
		cmp	esi, edi
		jb	short loc_1001961D
		pop	edi
		pop	esi
		retn
sub_1001960F	endp

; ---------------------------------------------------------------------------
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _initterm]
; [00000006 BYTES: COLLAPSED FUNCTION _initterm_e]

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_1001963C()
sub_1001963C	proc near		; DATA XREF: _pre_c_init+3Bo
		push	offset dword_10031360
		call	__clean_type_info_names_internal
		pop	ecx
		retn
sub_1001963C	endp

; [00000006 BYTES: COLLAPSED FUNCTION _crt_debugger_hook]
; [00000006 BYTES: COLLAPSED FUNCTION __crtUnhandledException]
; [00000006 BYTES: COLLAPSED FUNCTION __crtTerminateProcess]
; [00000006 BYTES: COLLAPSED FUNCTION _except_handler4_common]
; [00000006 BYTES: COLLAPSED FUNCTION __clean_type_info_names_internal]
; [00000006 BYTES: COLLAPSED FUNCTION IsProcessorFeaturePresent]
		align 10h
; [00000048 BYTES: COLLAPSED FUNCTION __SEH_prolog4_GS]
; [0000000F BYTES: COLLAPSED FUNCTION __SEH_epilog4_GS]
		align 10h
; [000000AA BYTES: COLLAPSED FUNCTION __alldiv]
		align 10h
; [00000034 BYTES: COLLAPSED FUNCTION __allmul]
; [00000006 BYTES: COLLAPSED FUNCTION memcmp]
; [00000006 BYTES: COLLAPSED FUNCTION memcpy]
; [00000006 BYTES: COLLAPSED FUNCTION memset]
		align 10h

; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197D0()
sub_100197D0	proc near		; DATA XREF: sub_10001018o
		mov	off_1003101C, offset off_1001A92C
		retn
sub_100197D0	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197DB()
sub_100197DB	proc near		; DATA XREF: sub_1000100Co
		mov	off_10031024, offset off_1001A92C
		retn
sub_100197DB	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197E6()
sub_100197E6	proc near		; DATA XREF: sub_10001000o
		mov	off_10031020, offset off_1001A92C
		retn
sub_100197E6	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197F1()
sub_100197F1	proc near		; DATA XREF: sub_10001024+10o
		push	offset CriticalSection ; lpCriticalSection
		call	ds:DeleteCriticalSection
		retn
sub_100197F1	endp


; =============== S U B	R O U T	I N E =======================================


; int __cdecl sub_100197FD()
sub_100197FD	proc near		; DATA XREF: sub_10001040o
		mov	ecx, offset dword_10031034
		jmp	??1_Fac_tidy_reg_t@std@@QAE@XZ ; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)
sub_100197FD	endp

; ---------------------------------------------------------------------------
		align 200h
		dd 180h	dup(?)
_text		ends

; Section 2. (virtual address 0001A000)
; Virtual size			: 000166BC (  91836.)
; Section size in file		: 00016800 (  92160.)
; Offset to raw	data for section: 00018E00
; Flags	40000040: Data Readable
; Alignment	: default
;
; Imports from ADVAPI32.dll
;
; ===========================================================================

; Segment type:	Externs
; _idata
; BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid)
		extrn CopySid:dword	; CODE XREF: sub_1000799B+48p
					; sub_10012AE0+240p ...
; LONG __stdcall RegCreateKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD Reserved, LPWSTR lpClass, DWORD dwOptions, REGSAM samDesired, LPSECURITY_ATTRIBUTES	lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition)
		extrn RegCreateKeyExW:dword ; CODE XREF: sub_10018091+60p
					; DATA XREF: sub_10018091+60r
; LONG __stdcall RegCloseKey(HKEY hKey)
		extrn RegCloseKey:dword	; CODE XREF: sub_10017D4E+1Fp
					; sub_10018091+7Bp
					; DATA XREF: ...
; LONG __stdcall RegOpenKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired,	PHKEY phkResult)
		extrn RegOpenKeyExW:dword ; CODE XREF: sub_10017D4E+12p
					; DATA XREF: sub_10017D4E+12r
; BOOL __stdcall RevertToSelf()
		extrn RevertToSelf:dword ; CODE	XREF: sub_10017D8F:loc_10017E23p
					; DATA XREF: sub_10017D8F:loc_10017E23r
; LSTATUS __stdcall RegDisablePredefinedCache()
		extrn RegDisablePredefinedCache:dword
					; CODE XREF: sub_10017D8F:loc_10017E6Bp
					; DATA XREF: sub_10017D8F:loc_10017E6Br
; BOOL __stdcall CreateWellKnownSid(WELL_KNOWN_SID_TYPE	WellKnownSidType, PSID DomainSid, PSID pSid, DWORD *cbSid)
		extrn CreateWellKnownSid:dword ; CODE XREF: sub_10016266+1Cp
					; DATA XREF: sub_10016266+1Cr
; DWORD	__stdcall GetLengthSid(PSID pSid)
		extrn GetLengthSid:dword ; CODE	XREF: sub_10013C26+53p
					; DATA XREF: sub_10013C26+53r
; BOOL __stdcall GetSecurityDescriptorSacl(PSECURITY_DESCRIPTOR	pSecurityDescriptor, LPBOOL lpbSaclPresent, PACL *pSacl, LPBOOL	lpbSaclDefaulted)
		extrn GetSecurityDescriptorSacl:dword ;	CODE XREF: sub_10013A85+E3p
					; DATA XREF: sub_10013A85+E3r
; BOOL __stdcall ConvertStringSecurityDescriptorToSecurityDescriptorW(LPCWSTR StringSecurityDescriptor,	DWORD StringSDRevision,	PSECURITY_DESCRIPTOR *SecurityDescriptor, PULONG SecurityDescriptorSize)
		extrn ConvertStringSecurityDescriptorToSecurityDescriptorW:dword
					; CODE XREF: sub_10013A85+CAp
					; DATA XREF: sub_10013A85+CAr
; BOOL __stdcall CreateProcessAsUserW(HANDLE hToken, LPCWSTR lpApplicationName,	LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL	bInheritHandles, DWORD dwCreationFlags,	LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo,	LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessAsUserW:dword ; CODE	XREF: sub_100178B5+D7p
					; DATA XREF: sub_100178B5+D7r
; BOOL __stdcall SetThreadToken(PHANDLE	Thread,	HANDLE Token)
		extrn SetThreadToken:dword ; CODE XREF:	sub_100178B5+149p
					; DATA XREF: sub_100178B5+149r
; BOOL __stdcall LookupPrivilegeValueW(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid)
		extrn LookupPrivilegeValueW:dword ; CODE XREF: sub_1001302F+C6p
					; DATA XREF: sub_1001302F+C6r
; BOOL __stdcall EqualSid(PSID pSid1, PSID pSid2)
		extrn EqualSid:dword	; CODE XREF: sub_10012E2D+E8p
					; DATA XREF: sub_10012E2D+E8r
; BOOL __stdcall CreateRestrictedToken(HANDLE ExistingTokenHandle, DWORD Flags,	DWORD DisableSidCount, PSID_AND_ATTRIBUTES SidsToDisable, DWORD	DeletePrivilegeCount, PLUID_AND_ATTRIBUTES PrivilegesToDelete, DWORD RestrictedSidCount, PSID_AND_ATTRIBUTES SidsToRestrict, PHANDLE NewTokenHandle)
		extrn CreateRestrictedToken:dword ; CODE XREF: sub_10012AE0+1A2p
					; DATA XREF: sub_10012AE0+1A2r
; BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle,	DWORD DesiredAccess, PHANDLE TokenHandle)
		extrn OpenProcessToken:dword ; CODE XREF: sub_10013578+89p
					; sub_10017D8F+3Dp
					; DATA XREF: ...
; BOOL __stdcall DuplicateTokenEx(HANDLE hExistingToken, DWORD dwDesiredAccess,	LPSECURITY_ATTRIBUTES lpTokenAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, TOKEN_TYPE TokenType,	PHANDLE	phNewToken)
		extrn DuplicateTokenEx:dword ; CODE XREF: sub_100083E3+1B2p
					; sub_10012AE0+187p
					; DATA XREF: ...
; BOOL __stdcall DuplicateToken(HANDLE ExistingTokenHandle, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, PHANDLE DuplicateTokenHandle)
		extrn DuplicateToken:dword ; CODE XREF:	sub_100083E3+194p
					; sub_10012DA7+2Ep
					; DATA XREF: ...
; BOOL __stdcall ConvertStringSidToSidW(LPCWSTR	StringSid, PSID	*Sid)
		extrn ConvertStringSidToSidW:dword ; CODE XREF:	sub_10007A4A+11p
					; sub_10007B85+18p ...
; DWORD	__stdcall SetEntriesInAclW(ULONG cCountOfExplicitEntries, PEXPLICIT_ACCESS_W pListOfExplicitEntries, PACL OldAcl, PACL *NewAcl)
		extrn SetEntriesInAclW:dword ; CODE XREF: sub_100078C4+3Bp
					; DATA XREF: sub_100078C4+3Br
; DWORD	__stdcall SetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOowner,	PSID psidGroup,	PACL pDacl, PACL pSacl)
		extrn SetSecurityInfo:dword ; CODE XREF: sub_1000799B+81p
					; sub_10013A85+F8p
					; DATA XREF: ...
; DWORD	__stdcall GetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE	ObjectType, SECURITY_INFORMATION SecurityInfo, PSID *ppsidOowner, PSID *ppsidGroup, PACL *ppDacl, PACL *ppSacl,	PSECURITY_DESCRIPTOR *ppSecurityDescriptor)
		extrn GetSecurityInfo:dword ; CODE XREF: sub_1000799B+33p
					; sub_1001892C+23p
					; DATA XREF: ...
; BOOL __stdcall SetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength)
		extrn SetTokenInformation:dword	; CODE XREF: sub_10007911+5Cp
					; sub_10013C26+64p
					; DATA XREF: ...
; BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass,	LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength)
		extrn GetTokenInformation:dword	; CODE XREF: sub_10007853+25p
					; sub_10007853+5Fp ...

;
; Imports from KERNEL32.dll
;
; BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount)
		extrn QueryPerformanceCounter:dword ; CODE XREF: sub_100053BD+74p
					; sub_10005577+1Dp ...
; void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime)
		extrn GetSystemTimeAsFileTime:dword ; CODE XREF: sub_10019531+34p
					; DATA XREF: sub_10019531+34r
; BOOL __stdcall QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency)
		extrn QueryPerformanceFrequency:dword ;	CODE XREF: sub_100053BD+58p
					; DATA XREF: sub_100053BD+58r
; HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName)
		extrn GetModuleHandleW:dword ; CODE XREF: sub_100062BD+48p
					; sub_10006426+3Fp ...
; void __stdcall GetNativeSystemInfo(LPSYSTEM_INFO lpSystemInfo)
		extrn GetNativeSystemInfo:dword	; CODE XREF: sub_10006426+12Dp
					; DATA XREF: sub_10006426+12Dr
; BOOL __stdcall GetVersionExW(LPOSVERSIONINFOW	lpVersionInformation)
		extrn GetVersionExW:dword ; CODE XREF: sub_10006426+A1p
					; DATA XREF: sub_10006426+A1r
; BOOL __stdcall CreateProcessW(LPCWSTR	lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation)
		extrn CreateProcessW:dword ; CODE XREF:	sub_10006844+1FDp
					; sub_1001197F+20p
					; DATA XREF: ...
; BOOL __stdcall SetEvent(HANDLE hEvent)
		extrn SetEvent:dword	; CODE XREF: sub_10006AFB+99p
					; StartAddress+D5p ...
; BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesRead)
		extrn ReadProcessMemory:dword ;	CODE XREF: sub_100066A3+1Fp
					; sub_100066A3+4Dp ...
; BOOL __stdcall GetExitCodeProcess(HANDLE hProcess, LPDWORD lpExitCode)
		extrn GetExitCodeProcess:dword ; CODE XREF: sub_10006844+23Cp
					; sub_10017807+27p
					; DATA XREF: ...
; DWORD	__stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize)
		extrn GetModuleFileNameW:dword ; CODE XREF: sub_10006844+35p
					; DATA XREF: sub_10006844+35r
; LPVOID __stdcall VirtualAllocEx(HANDLE hProcess, LPVOID lpAddress, DWORD dwSize, DWORD flAllocationType, DWORD flProtect)
		extrn VirtualAllocEx:dword ; CODE XREF:	sub_1000672E+93p
					; sub_1000BEB1+53p ...
; BOOL __stdcall ResetEvent(HANDLE hEvent)
		extrn ResetEvent:dword	; CODE XREF: sub_10006AFB+4Dp
					; StartAddress:loc_10008322p
					; DATA XREF: ...
; HANDLE __stdcall CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState,	LPCWSTR	lpName)
		extrn CreateEventW:dword ; CODE	XREF: sub_1000672E+2Bp
					; sub_1000672E+35p ...
; BOOL __stdcall WriteProcessMemory(HANDLE hProcess, LPVOID lpBaseAddress, LPVOID lpBuffer, DWORD nSize, LPDWORD lpNumberOfBytesWritten)
		extrn WriteProcessMemory:dword ; CODE XREF: sub_100066A3+6Bp
					; sub_1000672E+D0p ...
; DWORD	__stdcall SuspendThread(HANDLE hThread)
		extrn SuspendThread:dword ; CODE XREF: sub_10006AFB+8Cp
					; DATA XREF: sub_10006AFB+8Cr
; HLOCAL __stdcall LocalFree(HLOCAL hMem)
		extrn LocalFree:dword	; CODE XREF: sub_10007911+68p
					; sub_1000799B+6Ep ...
; BOOL __stdcall SetInformationJobObject(HANDLE	hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength)
		extrn SetInformationJobObject:dword ; CODE XREF: sub_100083E3+504p
					; sub_1000E80A+CDp ...
; BOOL __stdcall GetQueuedCompletionStatus(HANDLE CompletionPort, LPDWORD lpNumberOfBytesTransferred, LPDWORD lpCompletionKey, LPOVERLAPPED *lpOverlapped, DWORD dwMilliseconds)
		extrn GetQueuedCompletionStatus:dword ;	CODE XREF: StartAddress+1B9p
					; DATA XREF: StartAddress+1B9r
; void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn InitializeCriticalSection:dword ;	CODE XREF: sub_10008003+14p
					; sub_100083E3+411p ...
; DWORD	__stdcall GetProcessId(HANDLE Process)
		extrn GetProcessId:dword ; CODE	XREF: sub_10008A84+22p
					; DATA XREF: sub_10008A84+22r
; BOOL __stdcall RegisterWaitForSingleObject(PHANDLE phNewWaitObject, HANDLE hObject, WAITORTIMERCALLBACK Callback, PVOID Context, ULONG dwMilliseconds, ULONG dwFlags)
		extrn RegisterWaitForSingleObject:dword	; CODE XREF: sub_10008A84+BEp
					; sub_10017F0F+29p
					; DATA XREF: ...
; BOOL __stdcall PostQueuedCompletionStatus(HANDLE CompletionPort, DWORD dwNumberOfBytesTransferred, DWORD dwCompletionKey, LPOVERLAPPED lpOverlapped)
		extrn PostQueuedCompletionStatus:dword ; CODE XREF: sub_10008064+2Cp
					; Callback+Ep
					; DATA XREF: ...
; HANDLE __stdcall CreateIoCompletionPort(HANDLE FileHandle, HANDLE ExistingCompletionPort, DWORD CompletionKey, DWORD NumberOfConcurrentThreads)
		extrn CreateIoCompletionPort:dword ; CODE XREF:	sub_10008003+1Fp
					; DATA XREF: sub_10008003+1Fr
; BOOL __stdcall TerminateJobObject(HANDLE hJob, UINT uExitCode)
		extrn TerminateJobObject:dword ; CODE XREF: sub_100081CF+13p
					; StartAddress+82p
					; DATA XREF: ...
; BOOL __stdcall UnregisterWaitEx(HANDLE WaitHandle, HANDLE CompletionEvent)
		extrn UnregisterWaitEx:dword ; CODE XREF: sub_10007F18+Ep
					; sub_10017F72+57p
					; DATA XREF: ...
; BOOL __stdcall VirtualFreeEx(HANDLE hProcess,	LPVOID lpAddress, DWORD	dwSize,	DWORD dwFreeType)
		extrn VirtualFreeEx:dword ; CODE XREF: sub_1000BEB1+A6p
					; sub_1000DD99+63p
					; DATA XREF: ...
; BOOL __stdcall SetHandleInformation(HANDLE hObject, DWORD dwMask, DWORD dwFlags)
		extrn SetHandleInformation:dword ; CODE	XREF: sub_1000CA9E+186p
					; DATA XREF: sub_1000CA9E+186r
; BOOL __stdcall VirtualFree(LPVOID lpAddress, DWORD dwSize, DWORD dwFreeType)
		extrn VirtualFree:dword	; CODE XREF: sub_1000C863+215p
					; DATA XREF: sub_1000C863+215r
; BOOL __stdcall GetProcessHandleCount(HANDLE hProcess,	PDWORD pdwHandleCount)
		extrn GetProcessHandleCount:dword ; CODE XREF: sub_1000CA9E+27p
					; DATA XREF: sub_1000CA9E+27r
; HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId)
		extrn OpenProcess:dword	; CODE XREF: sub_1000D6D6+43p
					; DATA XREF: sub_1000D6D6+43r
; DWORD	__stdcall GetCurrentProcessId()
		extrn GetCurrentProcessId:dword	; CODE XREF: sub_1000D658+20p
					; sub_1000D658+30p ...
; BOOL __stdcall FreeLibrary(HMODULE hLibModule)
		extrn FreeLibrary:dword	; CODE XREF: sub_1000E032+33Fp
					; sub_1001776B+2Dp ...
; HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName)
		extrn LoadLibraryW:dword ; CODE	XREF: sub_1000E032+12Dp
					; sub_1001776B+Ap ...
; HANDLE __stdcall CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes, LPCWSTR lpName)
		extrn CreateJobObjectW:dword ; CODE XREF: sub_1000E80A+27p
					; DATA XREF: sub_1000E80A+27r
; BOOL __stdcall AssignProcessToJobObject(HANDLE hJob, HANDLE hProcess)
		extrn AssignProcessToJobObject:dword ; CODE XREF: sub_100178B5+120p
					; DATA XREF: sub_100178B5+120r
; HANDLE __stdcall CreateNamedPipeW(LPCWSTR lpName, DWORD dwOpenMode, DWORD dwPipeMode,	DWORD nMaxInstances, DWORD nOutBufferSize, DWORD nInBufferSize,	DWORD nDefaultTimeOut, LPSECURITY_ATTRIBUTES lpSecurityAttributes)
		extrn CreateNamedPipeW:dword ; CODE XREF: sub_1000E968+190p
					; DATA XREF: sub_1000E968+190r
; int __stdcall	lstrlenW(LPCWSTR lpString)
		extrn lstrlenW:dword	; CODE XREF: sub_1000F2B1+1Ep
					; DATA XREF: sub_1000F2B1+1Er
; void __stdcall DebugBreak()
		extrn DebugBreak:dword	; CODE XREF: sub_1000F2B1+6Ep
					; DATA XREF: sub_1000F2B1+6Er
; DWORD	__stdcall VirtualQueryEx(HANDLE	hProcess, LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, DWORD dwLength)
		extrn VirtualQueryEx:dword ; CODE XREF:	sub_100105D3+4Ap
					; DATA XREF: sub_100105D3+4Ar
; HMODULE __stdcall GetModuleHandleA(LPCSTR lpModuleName)
		extrn GetModuleHandleA:dword ; CODE XREF: sub_1001028F+37p
					; DATA XREF: sub_1001028F+37r
; BOOL __stdcall HeapSetInformation(HANDLE HeapHandle, HEAP_INFORMATION_CLASS HeapInformationClass, PVOID HeapInformation, SIZE_T HeapInformationLength)
		extrn HeapSetInformation:dword ; CODE XREF: sub_1001028F+87p
					; DATA XREF: sub_1001028F+87r
; DWORD	__stdcall SearchPathW(LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart)
		extrn SearchPathW:dword	; CODE XREF: sub_10010903+49p
					; sub_10010903+76p
					; DATA XREF: ...
; DWORD	__stdcall GetCurrentDirectoryW(DWORD nBufferLength, LPWSTR lpBuffer)
		extrn GetCurrentDirectoryW:dword
					; CODE XREF: TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+D7p
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+14Cp
					; DATA XREF: ...
; BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT	uExitCode)
		extrn TerminateProcess:dword ; CODE XREF: sub_10007ECF+22p
					; sub_100178B5+1EAp ...
; DWORD	__stdcall GetTickCount()
		extrn GetTickCount:dword ; CODE	XREF: sub_100150E4+2Bp
					; DATA XREF: sub_100150E4+2Br
; DWORD	__stdcall GetFileType(HANDLE hFile)
		extrn GetFileType:dword	; CODE XREF: sub_10014362+Dp
					; DATA XREF: sub_10014362+Dr
; DWORD	__stdcall SignalObjectAndWait(HANDLE hObjectToSignal, HANDLE hObjectToWaitOn, DWORD dwMilliseconds, BOOL bAlertable)
		extrn SignalObjectAndWait:dword	; CODE XREF: sub_10015A42+39p
					; DATA XREF: sub_10015A42+39r
; HANDLE __stdcall CreateMutexW(LPSECURITY_ATTRIBUTES lpMutexAttributes, BOOL bInitialOwner, LPCWSTR lpName)
		extrn CreateMutexW:dword ; CODE	XREF: sub_10015AEE+45p
					; DATA XREF: sub_10015AEE+45r
; BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress)
		extrn UnmapViewOfFile:dword ; CODE XREF: sub_10017CEB+47p
					; DATA XREF: sub_10017CEB+47r
; BOOL __stdcall ProcessIdToSessionId(DWORD dwProcessId, DWORD *pSessionId)
		extrn ProcessIdToSessionId:dword ; CODE	XREF: sub_100171B6+4Ap
					; DATA XREF: sub_100171B6+4Ar
; BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext)
		extrn GetThreadContext:dword ; CODE XREF: sub_100178B5+16Fp
					; DATA XREF: sub_100178B5+16Fr
; LPVOID __stdcall MapViewOfFile(HANDLE	hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, DWORD	dwNumberOfBytesToMap)
		extrn MapViewOfFile:dword ; CODE XREF: sub_10017B53+5Fp
					; DATA XREF: sub_10017B53+5Fr
; HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName)
		extrn CreateFileMappingW:dword ; CODE XREF: sub_10017B53+1Bp
					; DATA XREF: sub_10017B53+1Br
; DWORD	__stdcall GetFileAttributesW(LPCWSTR lpFileName)
		extrn GetFileAttributesW:dword ; CODE XREF: sub_10018182+A3p
					; DATA XREF: sub_10018182+A3r
; DWORD	__stdcall GetLongPathNameW(LPCWSTR lpszShortPath, LPWSTR lpszLongPath, DWORD cchBuffer)
		extrn GetLongPathNameW:dword ; CODE XREF: sub_100184BD+A3p
					; sub_100184BD+EAp
					; DATA XREF: ...
; DWORD	__stdcall QueryDosDeviceW(LPCWSTR lpDeviceName,	LPWSTR lpTargetPath, DWORD ucchMax)
		extrn QueryDosDeviceW:dword ; CODE XREF: sub_10018284+169p
					; DATA XREF: sub_10018284+169r
; HANDLE __stdcall GetStdHandle(DWORD nStdHandle)
		extrn GetStdHandle:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+29p
					; mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void *	*)+39p
					; DATA XREF: ...
; BOOL __stdcall DisableThreadLibraryCalls(HMODULE hLibModule)
		extrn DisableThreadLibraryCalls:dword ;	CODE XREF: DllMain(x,x,x)+15p
					; DATA XREF: DllMain(x,x,x)+15r
; BOOL __stdcall IsProcessorFeaturePresent(DWORD ProcessorFeature)
		extrn __imp_IsProcessorFeaturePresent:dword
					; DATA XREF: IsProcessorFeaturePresentr
; PVOID	__stdcall DecodePointer(PVOID Ptr)
		extrn DecodePointer:dword ; CODE XREF: sub_10018DA5+1Cp
					; sub_10018DA5+44p ...
; PVOID	__stdcall EncodePointer(PVOID Ptr)
		extrn EncodePointer:dword ; CODE XREF: ___atonexitinit+1Cp
					; sub_10018DA5+65p ...
; BOOL __stdcall CloseHandle(HANDLE hObject)
		extrn CloseHandle:dword	; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+85p
					; sub_1000591B+Ep ...
; DWORD	__stdcall ResumeThread(HANDLE hThread)
		extrn ResumeThread:dword
					; CODE XREF: mozilla::SandboxBroker::LaunchApp(wchar_t const *,wchar_t const *,bool,void * *)+7Cp
					; sub_10006AFB+22p
					; DATA XREF: ...
; DWORD	__stdcall GetLastError()
		extrn GetLastError:dword ; CODE	XREF: sub_10001B48+27p
					; sub_10001B95+27p ...
; void __stdcall SetLastError(DWORD dwErrCode)
		extrn SetLastError:dword ; CODE	XREF: sub_10001BED+9p
					; sub_10007ECF+3Cp ...
; BOOL __stdcall GetModuleHandleExW(DWORD dwFlags, LPCWSTR lpModuleName, HMODULE *phModule)
		extrn GetModuleHandleExW:dword ; CODE XREF: sub_1000E032+7Ap
					; sub_1000EE56+39p ...
; FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName)
		extrn GetProcAddress:dword ; CODE XREF:	sub_100062BD+5Cp
					; sub_100062BD+69p ...
; BOOL __stdcall InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount)
		extrn InitializeCriticalSectionAndSpinCount:dword
					; CODE XREF: sub_10001024+Ap
					; sub_1000469E+1Ap ...
; void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn LeaveCriticalSection:dword ; CODE	XREF: sub_10004646+48p
					; sub_1000469E+10Ep ...
; void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn EnterCriticalSection:dword ; CODE	XREF: sub_10004646+2Cp
					; sub_1000469E+DDp ...
; HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, DWORD	dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter,	DWORD dwCreationFlags, LPDWORD lpThreadId)
		extrn CreateThread:dword ; CODE	XREF: sub_10008003+47p
					; DATA XREF: sub_10008003+47r
; BOOL __stdcall DuplicateHandle(HANDLE	hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD	dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions)
		extrn DuplicateHandle:dword ; CODE XREF: sub_1000617D+2Ep
					; sub_1000672E+56p ...
; DWORD	__stdcall GetCurrentThreadId()
		extrn GetCurrentThreadId:dword ; CODE XREF: sub_10004592+11p
					; sub_10004592:loc_100045F4p ...
; BOOL __stdcall IsDebuggerPresent()
		extrn IsDebuggerPresent:dword ;	CODE XREF: sub_10004592:loc_100045E1p
					; ___raise_securityfailure+3p
					; DATA XREF: ...
; void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const DWORD *lpArguments)
		extrn RaiseException:dword ; CODE XREF:	sub_10004545+31p
					; DATA XREF: sub_10004545+31r
; void __stdcall Sleep(DWORD dwMilliseconds)
		extrn Sleep:dword	; CODE XREF: sub_10002F37+16p
					; sub_100047C7+40p
					; DATA XREF: ...
; DWORD	__stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds)
		extrn WaitForSingleObject:dword	; CODE XREF: sub_10006844+22Bp
					; sub_10006AFB+36p ...
; HANDLE __stdcall GetCurrentProcess()
		extrn GetCurrentProcess:dword ;	CODE XREF: sub_1000617D+1Fp
					; sub_1000617D+27p ...
; void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection)
		extrn DeleteCriticalSection:dword ; CODE XREF: sub_10008064+C1p
					; sub_10014606+E5p ...
; BOOL __stdcall VirtualProtectEx(HANDLE hProcess, LPVOID lpAddress, DWORD dwSize, DWORD flNewProtect, PDWORD lpflOldProtect)
		extrn VirtualProtectEx:dword ; CODE XREF: sub_1000DE85+170p
					; sub_100187CE+17p ...

;
; Imports from MSVCP120.dll
;
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)r
					; .rdata:1002E910o
; public: virtual __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::~basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10006C63+45r
; public: class	std::locale __thiscall std::ios_base::getloc(void)const
		extrn ?getloc@ios_base@std@@QBE?AVlocale@2@XZ:dword
					; CODE XREF: sub_10007678+72p
					; DATA XREF: sub_10007678+72r
; protected: __thiscall	std::basic_ios<char, struct std::char_traits<char>>::basic_ios<char, struct std::char_traits<char>>(void)
		extrn ??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10001CAD+15p
					; DATA XREF: sub_10001CAD+15r
; public: static unsigned int __cdecl std::ctype<wchar_t>::_Getcat(class std::locale::facet const * *, class std::locale const *)
		extrn ?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z:dword
					; CODE XREF: sub_10007384+6Bp
					; DATA XREF: sub_10007384+6Br
; public: wchar_t __thiscall std::ctype<wchar_t>::widen(char)const
		extrn ?widen@?$ctype@_W@std@@QBE_WD@Z:dword ; CODE XREF: sub_10007678+119p
					; DATA XREF: sub_10007678+119r
; public: __thiscall std::locale::id::operator unsigned	int(void)
		extrn ??Bid@locale@std@@QAEIXZ:dword ; CODE XREF: sub_10007384+24p
					; DATA XREF: sub_10007384+24r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)r
; char const * __cdecl std::_Winerror_map(int)
		extrn ?_Winerror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_100011EC+4p
					; DATA XREF: sub_100011EC+4r
; char const * __cdecl std::_Syserror_map(int)
		extrn ?_Syserror_map@std@@YAPBDH@Z:dword ; CODE	XREF: sub_10001191+4p
					; sub_10001211+6p
					; DATA XREF: ...
; void __cdecl std::_Xbad_alloc(void)
		extrn ?_Xbad_alloc@std@@YAXXZ:dword ; CODE XREF: sub_10001ACB:loc_10001AE8p
					; sub_10002657:loc_10002678p ...
; void __cdecl std::_Xout_of_range(char	const *)
		extrn ?_Xout_of_range@std@@YAXPBD@Z:dword ; CODE XREF: sub_10001802+1Ap
					; sub_100023D9+1Ap ...
; void __cdecl std::_Xlength_error(char	const *)
		extrn ?_Xlength_error@std@@YAXPBD@Z:dword ; CODE XREF: sub_100019A3+Fp
					; sub_1000245E+12p ...
; __int64 const	std::_BADOFF
		extrn ?_BADOFF@std@@3_JB:dword ; DATA XREF: sub_10001FC1+38r
					; sub_10001FC1+107r ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(unsigned int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z:dword
					; CODE XREF: sub_1000325B+3Bp
					; sub_1000325B+4Fp
					; DATA XREF: ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::operator<<(int)
		extrn ??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z:dword
					; CODE XREF: sub_10014BCE+74p
					; sub_10014BCE+88p ...
; public: __int64 __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::sputn(char const *, __int64)
		extrn ?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z:dword
					; CODE XREF: sub_10002683+A0p
					; sub_10002847+C2p
					; DATA XREF: ...
; public: void __thiscall std::basic_ostream<char, struct std::char_traits<char>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_1000254F+5p
					; DATA XREF: sub_1000254F+5r
; public: int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sputc(char)
		extrn ?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z:dword
					; CODE XREF: sub_10002683+79p
					; sub_10002683+C9p ...
; public: class	std::basic_ostream<char, struct	std::char_traits<char>>	& __thiscall std::basic_ostream<char, struct std::char_traits<char>>::flush(void)
		extrn ?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_100024FE+34p
					; DATA XREF: sub_100024FE+34r
; protected: __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::basic_streambuf<char, struct	std::char_traits<char>>(void)
		extrn ??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10001CAD+43p
					; DATA XREF: sub_10001CAD+43r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)r
; protected: char * __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ:dword
					; CODE XREF: sub_10001D8A+5Fp
					; sub_10001D8A+17Ep
					; DATA XREF: ...
; public: virtual __thiscall std::basic_ostream<char, struct std::char_traits<char>>::~basic_ostream<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10001D0F+2Ar
; public: __thiscall std::basic_ostream<char, struct std::char_traits<char>>::basic_ostream<char, struct std::char_traits<char>>(class std::basic_streambuf<char, struct std::char_traits<char>> *, bool)
		extrn ??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_streambuf@DU?$char_traits@D@std@@@1@_N@Z:dword
					; CODE XREF: sub_10001CAD+23p
					; DATA XREF: sub_10001CAD+23r
; public: void __thiscall std::basic_ios<char, struct std::char_traits<char>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_10002683+FFp
					; sub_10002847+126p
					; DATA XREF: ...
; public: virtual __thiscall std::basic_ios<char, struct std::char_traits<char>>::~basic_ios<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; CODE XREF: sub_1000325B+8Bp
					; DATA XREF: sub_10001B81+Er ...
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<char, struct std::char_traits<char>>::imbue(class std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::sync(void)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<char, struct std::char_traits<char>> * __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::setbuf(char *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsputn(char const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::xsgetn(char *,	__int64)
		extrn __imp_?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<char, struct std::char_traits<char>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::uflow(void)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<char, struct	std::char_traits<char>>::showmanyc(void)
		extrn __imp_?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Unlock(void)
		extrn __imp_?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)r
; __declspec(dllimport)	public:	virtual	void __thiscall	std::basic_streambuf<char, struct std::char_traits<char>>::_Lock(void)
		extrn __imp_?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ:dword
					; DATA XREF: std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)r
; public: virtual __thiscall std::basic_streambuf<char,	struct std::char_traits<char>>::~basic_streambuf<char, struct std::char_traits<char>>(void)
		extrn ??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10001D3F+45r
; public: static class std::locale::id std::ctype<wchar_t>::id
		extrn ?id@?$ctype@_W@std@@2V0locale@2@A:dword ;	DATA XREF: sub_10007384+1Br
; public: __thiscall std::_Lockit::~_Lockit(void)
		extrn ??1_Lockit@std@@QAE@XZ:dword ; CODE XREF:	sub_10007384+98p
					; DATA XREF: sub_10007384+98r
; public: __thiscall std::_Lockit::_Lockit(int)
		extrn ??0_Lockit@std@@QAE@H@Z:dword ; CODE XREF: sub_10007384+10p
					; DATA XREF: sub_10007384+10r
; private: static class	std::locale::_Locimp * __cdecl std::locale::_Getgloballocale(void)
		extrn ?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ:dword
					; CODE XREF: sub_10007384+46p
					; DATA XREF: sub_10007384+46r
; public: __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputn(wchar_t const *, __int64)
		extrn ?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W_J@Z:dword
					; CODE XREF: sub_1000742B+BBp
					; sub_10007562+9Fp
					; DATA XREF: ...
; public: unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::sputc(wchar_t)
		extrn ?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z:dword
					; CODE XREF: sub_1000742B+88p
					; sub_1000742B+E0p ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::flush(void)
		extrn ?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ:dword
					; CODE XREF: sub_10007312+34p
					; DATA XREF: sub_10007312+34r
; public: void __thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::_Osfx(void)
		extrn ?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ:dword
					; CODE XREF: sub_10007363+5p
					; DATA XREF: sub_10007363+5r
; protected: __thiscall	std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10006BCF+49p
					; DATA XREF: sub_10006BCF+49r
; public: __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> *)
		extrn ??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic_streambuf@_WU?$char_traits@_W@std@@@1@@Z:dword
					; CODE XREF: sub_10006BCF+29p
					; DATA XREF: sub_10006BCF+29r
; protected: __thiscall	std::basic_ios<wchar_t,	struct std::char_traits<wchar_t>>::basic_ios<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ:dword
					; CODE XREF: sub_10006BCF+1Cp
					; DATA XREF: sub_10006BCF+1Cr
; protected: wchar_t * __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::_Pninc(void)
		extrn ?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WXZ:dword
					; CODE XREF: sub_10006CAE+71p
					; sub_10006CAE+1C8p
					; DATA XREF: ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::pbump(int)
		extrn ?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10006F45+17Dp
					; sub_10007106+F6p
					; DATA XREF: ...
; protected: void __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::gbump(int)
		extrn ?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z:dword
					; CODE XREF: sub_10006E8A+34p
					; sub_10006F45+BCp ...
; public: virtual __thiscall std::basic_iostream<wchar_t, struct std::char_traits<wchar_t>>::~basic_iostream<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; DATA XREF: sub_10006C33+2Ar
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(unsigned long)
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z:dword
					; CODE XREF: sub_10006844+16Ep
					; sub_10006844+17Ep
					; DATA XREF: ...
; public: class	std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>> &	__thiscall std::basic_ostream<wchar_t, struct std::char_traits<wchar_t>>::operator<<(class std::ios_base & (__cdecl *)(class std::ios_base &))
		extrn ??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAVios_base@1@AAV21@@Z@Z:dword
					; CODE XREF: sub_10006844+137p
					; sub_10006844+13Fp
					; DATA XREF: ...
; public: void __thiscall std::basic_ios<wchar_t, struct std::char_traits<wchar_t>>::setstate(int, bool)
		extrn ?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z:dword
					; CODE XREF: sub_1000742B+11Ep
					; sub_10007562+FDp ...
; public: virtual __thiscall std::basic_ios<wchar_t, struct std::char_traits<wchar_t>>::~basic_ios<wchar_t, struct std::char_traits<wchar_t>>(void)
		extrn ??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ:dword
					; CODE XREF: sub_10006844+284p
					; sub_1000784B-615p
					; DATA XREF: ...
; __declspec(dllimport)	protected: virtual void	__thiscall std::basic_streambuf<wchar_t, struct	std::char_traits<wchar_t>>::imbue(class	std::locale const &)
		extrn __imp_?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale	const &)r
; __declspec(dllimport)	protected: virtual int __thiscall std::basic_streambuf<wchar_t,	struct std::char_traits<wchar_t>>::sync(void)
		extrn __imp_?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)r
; __declspec(dllimport)	protected: virtual class std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>> * __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::setbuf(wchar_t *, __int64)
		extrn __imp_?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsputn(wchar_t const *, __int64)
		extrn __imp_?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)r
; __declspec(dllimport)	protected: virtual __int64 __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::xsgetn(wchar_t *, __int64)
		extrn __imp_?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)r
; __declspec(dllimport)	protected: virtual unsigned short __thiscall std::basic_streambuf<wchar_t, struct std::char_traits<wchar_t>>::uflow(void)
		extrn __imp_?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ:dword
					; DATA XREF: std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)r

;
; Imports from MSVCR120.dll
;
		extrn __imp__amsg_exit:dword ; DATA XREF: _amsg_exitr
					; .rdata:1002E924o
		extrn _malloc_crt:dword	; CODE XREF: _pre_c_init+6p
					; DATA XREF: _pre_c_init+6r
		extrn __imp__initterm:dword ; DATA XREF: _inittermr
		extrn __imp__initterm_e:dword ;	DATA XREF: _initterm_er
		extrn __imp__crt_debugger_hook:dword ; DATA XREF: _crt_debugger_hookr
		extrn __imp___crtUnhandledException:dword
					; DATA XREF: __crtUnhandledExceptionr
		extrn __imp___crtTerminateProcess:dword	; DATA XREF: __crtTerminateProcessr
		extrn __imp__except_handler4_common:dword
					; DATA XREF: _except_handler4_commonr
		extrn __imp___clean_type_info_names_internal:dword
					; DATA XREF: __clean_type_info_names_internalr
; int __cdecl memcmp(const void	*, const void *, size_t)
		extrn __imp_memcmp:dword ; DATA	XREF: memcmpr
; void *__cdecl	memcpy(void *, const void *, size_t)
		extrn __imp_memcpy:dword ; DATA	XREF: memcpyr
; void *__cdecl	memset(void *, int, size_t)
		extrn __imp_memset:dword ; DATA	XREF: memsetr
; void *__cdecl	memmove(void *,	const void *, size_t)
		extrn memmove:dword	; CODE XREF: sub_100010F8+Dp
					; sub_10001B2D+Dp ...
		extrn __imp__purecall:dword ; DATA XREF: _purecallr
; __declspec(dllimport)	void __cdecl operator delete(void *)
		extrn __imp_??3@YAXPAX@Z:dword ; CODE XREF: sub_10001074+2Bp
					; sub_10001074+45p ...
; __declspec(dllimport)	void * __cdecl operator	new(unsigned int)
		extrn __imp_??2@YAPAXI@Z:dword ; CODE XREF: sub_10001ACB+10p
					; sub_10002657+14p ...
; int __cdecl strnicmp(const char *, const char	*, size_t)
		extrn _strnicmp:dword	; CODE XREF: sub_100056F9+3Ap
					; DATA XREF: sub_100056F9+3Ar
; int __cdecl vscwprintf_p(const wchar_t *Format, va_list ArgList)
		extrn _vscwprintf_p:dword ; CODE XREF: sub_100040D8+33p
					; sub_10004143+5Cp
					; DATA XREF: ...
; int __cdecl vswprintf_p(wchar_t *DstBuf, size_t MaxCount, const wchar_t *Format, va_list ArgList)
		extrn _vswprintf_p:dword ; CODE	XREF: sub_100040D8+17p
					; sub_10004143+41p
					; DATA XREF: ...
; void __cdecl free(void *)
		extrn free:dword	; CODE XREF: sub_10006844+26Ap
					; sub_10007853+47p ...
; void *__cdecl	malloc(size_t)
		extrn malloc:dword	; CODE XREF: sub_10007853+33p
					; sub_1000C08E+41p ...
; void __cdecl operator	delete[](void *)
		extrn ??_V@YAXPAX@Z:dword ; CODE XREF: sub_10006340+4Dp
					; sub_100083E3+5B9p ...
; void __cdecl __noreturn abort()
		extrn abort:dword	; CODE XREF: sub_10007384+78p
					; DATA XREF: sub_10007384+78r
; wchar_t *__cdecl wcsdup(const	wchar_t	*)
		extrn _wcsdup:dword	; CODE XREF: sub_10006844+1B1p
					; sub_10011BB2+3Fp ...
; char *__cdecl	getenv(const char *)
		extrn getenv:dword	; CODE XREF: sub_100083E3+3A5p
					; DATA XREF: sub_100083E3+3A5r
; int __cdecl wcsnicmp(const wchar_t *,	const wchar_t *, size_t)
		extrn _wcsnicmp:dword	; CODE XREF: sub_1000B3A3+4Ep
					; sub_10018284+1B8p
					; DATA XREF: ...
		extrn wmemcpy_s:dword	; CODE XREF: sub_1000C17D+23p
					; DATA XREF: sub_1000C17D+23r
		extrn rand_s:dword	; CODE XREF: sub_1000D7F6+4Fp
					; sub_100105D3+1Ep
					; DATA XREF: ...
; errno_t __cdecl memcpy_s(void	*Dst, rsize_t DstSize, const void *Src,	rsize_t	MaxCount)
		extrn memcpy_s:dword	; CODE XREF: sub_1000E39B+23p
					; DATA XREF: sub_1000E39B+23r
; int __cdecl wcsicmp(const wchar_t *, const wchar_t *)
		extrn _wcsicmp:dword	; CODE XREF: sub_10018284+D2p
					; sub_10018284+1ECp
					; DATA XREF: ...
; int __cdecl vsnwprintf_s(wchar_t *DstBuf, size_t SizeInWords,	size_t MaxCount, const wchar_t *Format,	va_list	ArgList)
		extrn _vsnwprintf_s:dword ; CODE XREF: sub_10018C67+13p
					; DATA XREF: sub_10018C67+13r
		extrn __imp__lock:dword	; DATA XREF: _lockr
		extrn __imp__unlock:dword ; DATA XREF: _unlockr
		extrn _calloc_crt:dword	; CODE XREF: ___atonexitinit+11p
					; DATA XREF: ___atonexitinit+11r
		extrn __imp___dllonexit:dword ;	DATA XREF: __dllonexitr
; _onexit_t __cdecl onexit(_onexit_t)
		extrn _onexit:dword	; CODE XREF: sub_10018DA5+29p
					; DATA XREF: sub_10018DA5+29r
		extrn __imp___CppXcptFilter:dword ; DATA XREF: __CppXcptFilterr

;
; Imports from USER32.dll
;
; HWINSTA __stdcall CreateWindowStationW(LPWSTR	lpwinsta, DWORD	dwReserved, ACCESS_MASK	dwDesiredAccess, LPSECURITY_ATTRIBUTES lpsa)
		extrn CreateWindowStationW:dword ; CODE	XREF: sub_10018960+36p
					; DATA XREF: sub_10018960+36r ...
; BOOL __stdcall CloseDesktop(HDESK hDesktop)
		extrn CloseDesktop:dword ; CODE	XREF: sub_100149B4+Ap
					; DATA XREF: sub_100149B4+Ar
; BOOL __stdcall CloseWindowStation(HWINSTA hWinSta)
		extrn CloseWindowStation:dword ; CODE XREF: sub_100149B4+21p
					; DATA XREF: sub_100149B4+21r
; HDESK	__stdcall CreateDesktopW(LPWSTR	lpszDesktop, LPWSTR lpszDevice,	LPDEVMODEW pDevmode, DWORD dwFlags, ACCESS_MASK	dwDesiredAccess, LPSECURITY_ATTRIBUTES lpsa)
		extrn CreateDesktopW:dword ; CODE XREF:	sub_100189BE+F1p
					; DATA XREF: sub_100189BE+F1r
; BOOL __stdcall SetProcessWindowStation(HWINSTA hWinSta)
		extrn SetProcessWindowStation:dword ; CODE XREF: sub_100189BE+97p
					; sub_100189BE+10Bp
					; DATA XREF: ...
; HDESK	__stdcall GetThreadDesktop(DWORD dwThreadId)
		extrn GetThreadDesktop:dword ; CODE XREF: sub_100189BE+75p
					; DATA XREF: sub_100189BE+75r
; BOOL __stdcall GetUserObjectInformationW(HANDLE hObj,	int nIndex, PVOID pvInfo, DWORD	nLength, LPDWORD lpnLengthNeeded)
		extrn GetUserObjectInformationW:dword ;	CODE XREF: sub_10018B02+1Ep
					; sub_10018B02+5Ep
					; DATA XREF: ...
; HWINSTA __stdcall GetProcessWindowStation()
		extrn GetProcessWindowStation:dword ; CODE XREF: sub_10018960+12p
					; sub_100189BE+8Ap
					; DATA XREF: ...

;
; Imports from WINMM.dll
;
; DWORD	__stdcall timeGetTime()
		extrn __imp_timeGetTime:dword ;	DATA XREF: timeGetTimer
					; .rdata:1002E8E8o


; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read
_rdata		segment	para public 'DATA' use32
		assume cs:_rdata
		;org 1001A36Ch
dword_1001A36C	dd 0			; DATA XREF: sub_10018EC2+1A6o
		dd offset sub_10001040
		dd offset sub_10001000
		dd offset sub_1000100C
		dd offset sub_10001018
		dd offset sub_10001024
dword_1001A384	dd 0			; DATA XREF: sub_10018EC2+1A1o
dword_1001A388	dd 0			; DATA XREF: sub_10018EC2+187o
		dd offset _pre_c_init
		dd offset ___atonexitinit
dword_1001A394	dd 3 dup(0)		; DATA XREF: sub_10018EC2:loc_10019044o
; Debug	Directory entries
		dd 0			; Characteristics
		dd 5632BAB7h		; TimeDateStamp: Fri Oct 30 00:32:55 2015
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 2			; Type:	IMAGE_DEBUG_TYPE_CODEVIEW
		dd 97h			; SizeOfData
		dd rva asc_1002DBA8	; AddressOfRawData
		dd 2C9A8h		; PointerToRawData
		dd 0			; Characteristics
		dd 5632BAB7h		; TimeDateStamp: Fri Oct 30 00:32:55 2015
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 0Ch			; Type
		dd 14h			; SizeOfData
		dd rva dword_1002DC40	; AddressOfRawData
		dd 2CA40h		; PointerToRawData
		dd 0			; Characteristics
		dd 5632BAB7h		; TimeDateStamp: Fri Oct 30 00:32:55 2015
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd 0Ah			; Type:	IMAGE_DEBUG_TYPE_RESERVED10
		dd 4			; SizeOfData
		dd rva dword_1002DC54	; AddressOfRawData
		dd 2CA54h		; PointerToRawData
dword_1001A3F4	dd 0			; DATA XREF: ___DllMainCRTStartup:loc_1001911Ar
					; ___DllMainCRTStartup+A8r ...
off_1001A3F8	dd offset dword_10031040 ; DATA	XREF: ___report_gsfailure+EDo
		dd offset dword_10031090
aGeneric	db 'generic',0          ; DATA XREF: sub_1000118Bo
aUnknownError	db 'unknown error',0    ; DATA XREF: sub_10001191+Fo
					; sub_100011EC+Fo
		align 4
aIostream	db 'iostream',0         ; DATA XREF: sub_100011B6o
		align 4
aIostreamStream	db 'iostream stream error',0 ; DATA XREF: sub_100011BC+Co
		align 4
aSystem		db 'system',0           ; DATA XREF: sub_100011E6o
		align 4
a??PipeChrome_:				; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+D6o
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+FFo
		unicode	0, <\??\pipe\chrome.*>,0
a??PipeGeckoCra:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+FBo
					; mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+124o
		unicode	0, <\??\pipe\gecko-crash-server-pipe.*>,0
		align 10h
aSection:				; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+120o
		unicode	0, <Section>,0
a??PipeJpi2_pid:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForPluginProcess(int)+164o
		unicode	0, <\??\pipe\jpi2_pid*_pipe*>,0
		align 4
aHkey_current_u:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+149o
					; .rdata:1002BA08o
		unicode	0, <HKEY_CURRENT_USER>,0
aHkey_current_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+16Fo
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop>,0
aHkey_current_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+192o
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\LanguageConfigura>
		unicode	0, <tion>,0
		align 8
aHkey_local_mac:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1B5o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide>,0
aHkey_local_m_0:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1D8o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\MUI\Settin>
		unicode	0, <gs>,0
aHkey_current_2:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+1FBo
		unicode	0, <HKEY_CURRENT_USER\Software\Policies\Microsoft\Control Pan>
		unicode	0, <el\Desktop>,0
aHkey_current_3:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+21Eo
		unicode	0, <HKEY_CURRENT_USER\Control Panel\Desktop\PreferredUILangua>
		unicode	0, <ges>,0
		align 8
aHkey_local_m_1:			; DATA XREF: mozilla::SandboxBroker::SetSecurityLevelForGMPlugin(void)+241o
		unicode	0, <HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVers>
		unicode	0, <ion\SideBySide\PreferExternalManifest>,0
		align 4
aStringTooLong	db 'string too long',0  ; DATA XREF: sub_100019A3+Ao
					; sub_1000245E+Do ...
aInvalidStringP	db 'invalid string position',0 ; DATA XREF: sub_10001802:loc_10001817o
					; sub_100023D9:loc_100023EEo ...
; Exported entry   5. ??_7SandboxBroker@mozilla@@6B@
		public ??_7SandboxBroker@mozilla@@6B@
; const	mozilla::SandboxBroker::`vftable'
??_7SandboxBroker@mozilla@@6B@ dd offset sub_10001074
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker const	&)+4o
					; mozilla::SandboxBroker::SandboxBroker(void)+3o ...
off_1001A8E4	dd offset sub_10001113	; DATA XREF: .data:off_10031020o
		dd offset sub_1000118B
		dd offset sub_10001191
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A8FC	dd offset sub_10001113	; DATA XREF: .data:off_1003101Co
		dd offset sub_100011E6
		dd offset sub_100011EC
		dd offset sub_10001211
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A914	dd offset sub_10001113	; DATA XREF: .data:off_10031024o
		dd offset sub_100011B6
		dd offset sub_100011BC
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
off_1001A92C	dd offset sub_10001113	; DATA XREF: sub_10001113+8o
					; sub_100197D0o ...
		dd offset _purecall
		dd offset _purecall
		dd offset sub_10001131
		dd offset sub_10001170
		dd offset sub_10001141
dword_1001A944	dd 29h			; DATA XREF: sub_1000325B+55o
aVs_		db ' vs. ',0            ; DATA XREF: sub_1000325B+41o
		align 10h
asc_1001A950	db ' (',0               ; DATA XREF: sub_1000325B+2Do
		align 4
off_1001A954	dd offset sub_10002986	; DATA XREF: sub_10001CAD+2Eo
					; sub_10001D0F+Co
off_1001A958	dd offset sub_100022AD	; DATA XREF: sub_10001CAD+4Fo
					; sub_10001D3F+7o
		dd offset ?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ ; std::basic_streambuf<char,std::char_traits<char>>::_Unlock(void)
		dd offset sub_10001D8A
		dd offset sub_10001F1E
		dd offset ?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ ; std::basic_streambuf<char,std::char_traits<char>>::showmanyc(void)
		dd offset sub_10001F6A
		dd offset ?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ; std::basic_streambuf<char,std::char_traits<char>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsgetn(char *,__int64)
		dd offset ?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J@Z ;	std::basic_streambuf<char,std::char_traits<char>>::xsputn(char const *,__int64)
		dd offset sub_10001FC1
		dd offset sub_10002174
		dd offset ?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@PAD_J@Z ; std::basic_streambuf<char,std::char_traits<char>>::setbuf(char *,__int64)
		dd offset ?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ ;	std::basic_streambuf<char,std::char_traits<char>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<char,std::char_traits<char>>::imbue(std::locale const	&)
dword_1001A994	dd 0			; DATA XREF: sub_10001CAD+Fo
		dd 50h
aDummy:					; DATA XREF: sub_1000298E+4o
		unicode	0, <dummy>,0
aHkey_current_4:			; DATA XREF: sub_1000298E+23o
		unicode	0, <HKEY_CURRENT_USER\dummy>,0
aBlocked	db 'BLOCKED',0          ; DATA XREF: sub_100029E2+11o
aBrokerAllowed	db 'Broker ALLOWED',0   ; DATA XREF: sub_10002AE3+Fo
		align 10h
aCheckFailedFal	db 'Check failed: false. ',0 ; DATA XREF: sub_1000591B+2Co
					; sub_10005965+9Fo ...
		align 4
aUnknown	db 'unknown',0          ; DATA XREF: sub_10002C02+6o
; char a_thunks[]
a_thunks	db '.thunks',0          ; DATA XREF: sub_10002E8B+13o
; char a_syzygy[]
a_syzygy	db '.syzygy',0          ; DATA XREF: sub_10002E8B+32o
off_1001AA20	dd offset sub_10002E6D	; DATA XREF: sub_10002E6D+8o
					; sub_10002E8B+1Bo ...
off_1001AA24	dd offset sub_10005906	; DATA XREF: sub_10014126+41r
aVectorTTooLong	db 'vector<T> too long',0 ; DATA XREF: sub_1000316B+1Fo
					; sub_1000376C+30o ...
		align 10h
		dd 0C0B0A09h
		db 0Dh,	20h, 0
byte_1001AA47	db 0			; DATA XREF: sub_1000469E+BDo
		dw 9, 0Ah, 0Bh
		dw 0Ch
		dw 0Dh
		unicode	0, < >
		dw 85h
aA		db '',0
		dd 20001680h, 20022001h, 20042003h, 20062005h, 20082007h
		dd 200A2009h, 20292028h, 205F202Fh, 3000h
asc_1001AA7C:				; DATA XREF: sub_100038E4+1Bo
		dw 9, 0Ah, 0Bh
		dw 0Ch
		dw 0Dh
		unicode	0, < >
		dw 85h
aA_0		db '',0
		dd 20001680h, 20022001h, 20042003h, 20062005h, 20082007h
		dd 200A2009h, 20292028h, 205F202Fh, 3000h
		dd offset dword_10031380
off_1001AAB4	dd offset timeGetTime	; DATA XREF: sub_10005333+Er
		dd 1
; const	WCHAR aKernel32_dll_1
aKernel32_dll_1:			; DATA XREF: sub_10007B85+36o
					; sub_10007C21+35o ...
		unicode	0, <kernel32.dll>,0
		align 4
; const	WCHAR aKernelbase_dll
aKernelbase_dll:			; DATA XREF: sub_10007B85+4Eo
					; sub_10007C21+4Do ...
		unicode	0, <kernelbase.dll>,0
		align 4
aNtdll_dll:				; DATA XREF: sub_10009C33+9Do
		unicode	0, <ntdll.dll>,0
; wchar_t aDevice
aDevice:				; DATA XREF: sub_1000B3A3+48o
		unicode	0, <\Device\>,0
		align 10h
a??_1:					; DATA XREF: sub_1000BA03+28o
		unicode	0, <\??\>,0
		align 4
dword_1001AB2C	dd 10000h		; DATA XREF: sub_1000D7F6+1Eo
; const	WCHAR aNtdll_dll_0
aNtdll_dll_0:				; DATA XREF: sub_1000DE0C+28o
					; sub_1000DE85+45o ...
		unicode	0, <ntdll.dll>,0
a@:					; DATA XREF: sub_1000DCE4+1Co
					; sub_10015127+D2o
		unicode	0, <@>,0
aKernel32_dll_0:			; DATA XREF: sub_1000E935+22o
		unicode	0, <kernel32.dll>,0
		align 4
; const	WCHAR aNtdll_dll_1
aNtdll_dll_1:				; DATA XREF: sub_1000EE56+7o
					; sub_1000F0DF+11o
		unicode	0, <ntdll.dll>,0
aKernel32_dll_2:			; DATA XREF: sub_10010A1C+3Ao
		unicode	0, <kernel32.dll>,0
		align 4
aNtdll_dll_2:				; DATA XREF: sub_10011CBA+27o
					; sub_10011CBA+43o
		unicode	0, <ntdll.dll>,0
; const	WCHAR aNtdll_dll_3
aNtdll_dll_3:				; DATA XREF: sub_10015438+17o
		unicode	0, <ntdll.dll>,0
; const	WCHAR aNtdll_dll_5
aNtdll_dll_5:				; DATA XREF: sub_100154DB+1o
		unicode	0, <ntdll.dll>,0
dword_1001ABD0	dd 0Ch dup(0)		; DATA XREF: sub_100165A3+35o
		dd 1, 2, 2 dup(0)
		dd 11h dup(1), 2, 1, 2,	1, 2, 1, 2, 1, 2, 1, 2,	1, 2, 1
		dd 2, 10h dup(0)
dword_1001ACD0	dd 8 dup(0)		; DATA XREF: sub_100165A3+2Co
		dd 100h, 0
		dd 1, 4, 4 dup(0)
dword_1001AD10	dd 8 dup(1), 101h, 8 dup(1), 4,	1, 4, 1, 4, 1, 4, 101h
		dd 4, 1, 4, 1, 4, 1, 4,	11h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSgdt		; "sgdt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aSidt		; "sidt"
		dd 14h dup(0)
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLgdt		; "lgdt"
		align 80h
		dd 8, 0A090000h, 2 dup(0)
		dd offset aLidt		; "lidt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSmsw		; "smsw"
		dd 2Dh dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLmsw		; "lmsw"
		dd 14h dup(0)
		dd 8, 2090000h,	2 dup(0)
		dd offset aInvlpg	; "invlpg"
dword_1001B0A4	dd 14h dup(0)
		dd 8, 80090000h, 2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aPrefetch	; "prefetch"
		dd 77h dup(0)
off_1001B410	dd offset dword_1001B8C0 ; DATA	XREF: sub_100162B4+11r
					; sub_10016328+41r
byte_1001B414	db 0			; DATA XREF: sub_10016328+Er
byte_1001B415	db 0FFh			; DATA XREF: sub_10016328+1Ar
					; sub_10016328+CBr
byte_1001B416	db 0			; DATA XREF: sub_10016328+21r
byte_1001B417	db 0FFh			; DATA XREF: sub_10016328+2Er
		dd offset dword_10024948
		dd 0FF00FF00h
		dd offset dword_10024628
		dd 7000703h
		dd offset dword_1002B6A8
		dd 7000703h
		dd offset dword_10022C60
		dd 7000703h
		dd offset dword_100239A8
		dd 7000703h
		dd offset dword_1002B068
		dd 7000703h
		dd offset dword_10021FE0
		dd 7000703h
		dd offset dword_100232A0
		dd 7000703h
		dd offset dword_10022620
		dd 7000703h
		dd offset dword_10023CC8
		dd 7000703h
		dd offset dword_10022F80
		dd 7000703h
		dd offset dword_10024308
		dd 7000703h
		dd offset dword_1002AD48
		dd 7000703h
		dd offset dword_100235C0
		dd 1000703h
		dd offset dword_10021CC0
		dd 7000703h
		dd offset dword_1001B5A0
		dd 7000703h
		dd offset dword_1001AD10+0C0h
		dd 7000703h
		dd offset dword_1001B0A4+4Ch
		dd 7000703h
		dd offset dword_10022300
		dd 7000703h
		dd offset dword_1002B388
		dd 7000703h
		dd offset dword_10023688
		dd 7000703h
		dd offset dword_10022940
		dd 7000703h
		dd offset dword_10023FE8
		dd 7000703h
		dd offset dword_1001B4D8
		dd 1000703h
dword_1001B4D8	dd 1Ah dup(0)		; DATA XREF: .rdata:1001B4D0o
		dd 8, 9090000h,	2 dup(0)
		dd offset aCmpxch8b	; "cmpxch8b"
		dd 13h dup(0)
dword_1001B5A0	dd 0			; DATA XREF: .rdata:1001B490o
		dd 8, 0E040000h, 2 dup(0)
		dd offset aSldt		; "sldt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aStr		; "str"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLldt		; "lldt"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aLtr		; "ltr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerr		; "verr"
		dd 14h dup(0)
		dd 8, 0E040000h, 2 dup(0)
		dd offset aVerw		; "verw"
		dd 45h dup(0)
dword_1001B8C0	dd 0			; DATA XREF: .rdata:off_1001B410o
		dd 8, 2040000h,	2060000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		align 80h
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 13h dup(0)
		dd 1, 2, 18h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDaa		; "daa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aDas		; "das"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAaa		; "aaa"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 8, 3	dup(0)
		dd offset aAas		; "aas"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		align 80h
		dd 8, 0D140000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 0D140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushad	; "pushad"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopad	; "popad"
		dd 14h dup(0)
		dd 8, 0D060000h, 1090000h, 0
		dd offset aBound	; "bound"
		dd 14h dup(0)
		dd 8, 0E040000h, 0E060000h, 0
		dd offset aArpl		; "arpl"
		dd 14h dup(0)
		dd 3, 18h dup(0)
		dd 3, 18h dup(0)
		dd 5, 18h dup(0)
		dd 4, 18h dup(0)
		dd 8, 0D070000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0D070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 2070000h
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aInsb		; "insb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aInsd		; "insd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aOutsb	; "outsb"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJc		; "jc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJg		; "jg"
		dd 13h dup(0)
		dd 2 dup(2), 2040000h, 2070000h, 15h dup(0)
		dd 3, 2, 0D040000h, 0D070000h, 15h dup(0)
		dd 4, 2, 0D040000h, 2070000h, 15h dup(0)
		dd 5, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXchg		; "xchg"
		align 80h
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2060000h,	2040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E040000h, 0E0E0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D060000h, 80090000h, 0
		dd offset aLea		; "lea"
		dd 14h dup(0)
		dd 8, 0E0E0000h, 0E040000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aNop		; "nop"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 2	dup(0D140000h),	0
		dd offset aXchg		; "xchg"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCwde		; "cwde"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCdq		; "cdq"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aCallf	; "callf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWait		; "wait"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPushfd	; "pushfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aPopfd	; "popfd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSahf		; "sahf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLahf		; "lahf"
		dd 14h dup(0)
		dd 8, 2140000h,	20A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D0A0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 20A0000h,	2140000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D0A0000h, 0D140000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aMovsb	; "movsb"
		dd 14h dup(0)
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aMovsd	; "movsd"
		dd 14h dup(0)
		dd 8, 2120000h,	2130000h, 0
		dd offset aCmpsb	; "cmpsb"
		align 80h
		dd 8, 0D120000h, 0D130000h, 0
		dd offset aCmpsd	; "cmpsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2130000h,	2140000h, 0
		dd offset aStosb	; "stosb"
		dd 14h dup(0)
		dd 8, 0D130000h, 0D140000h, 0
		dd offset aStosd	; "stosd"
		dd 14h dup(0)
		dd 8, 2140000h,	2120000h, 0
		dd offset aLodsb	; "lodsb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D120000h, 0
		dd offset aLodsd	; "lodsd"
		dd 14h dup(0)
		dd 8, 2140000h,	2130000h, 0
		dd offset aScasb	; "scasb"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D130000h, 0
		dd offset aScasd	; "scasd"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 13h dup(0)
		dd 6, 2, 2040000h, 2070000h, 15h dup(0)
		dd 7, 2, 0D040000h, 2070000h, 16h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRet		; "ret"
		dd 14h dup(0)
		dd 7, 3	dup(0)
		dd offset aRet		; "ret"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLes		; "les"
		dd 14h dup(0)
		dd 8, 0D060000h, 6090000h, 0
		dd offset aLds		; "lds"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aMov		; "mov"
		align 80h
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 0E070000h, 2070000h, 0
		dd offset aEnter	; "enter"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLeave	; "leave"
		dd 14h dup(0)
		dd 7, 0E070000h, 2 dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 7, 3	dup(0)
		dd offset aRetf		; "retf"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInt3		; "int3"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aInt		; "int"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aInto		; "into"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aIret		; "iret"
		align 80h
		dd 8, 2, 2040000h, 16h dup(0)
		dd 9, 2, 0D040000h, 16h	dup(0)
		dd 0Ah,	2, 2040000h, 16h dup(0)
		dd 0Bh,	2, 0D040000h, 17h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAam		; "aam"
		dd 14h dup(0)
		dd 8, 2070000h,	2 dup(0)
		dd offset aAad		; "aad"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aXlat		; "xlat"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopnz	; "loopnz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoopz	; "loopz"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aLoop		; "loop"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJcxz		; "jcxz"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2140000h,	2070000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		align 80h
		dd 8, 2070000h,	2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6010000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 2080000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 2140000h,	0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0D140000h, 0E140000h, 0
		dd offset aIn		; "in"
		dd 14h dup(0)
		dd 8, 0E140000h, 2140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 8, 0E140000h, 0D140000h, 0
		dd offset aOut		; "out"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aLock		; "lock:"
		dd 2Dh dup(0)
		dd 3, 3	dup(0)
		dd offset aRepne	; "repne:"
		dd 14h dup(0)
		dd 3, 3	dup(0)
		dd offset aRep		; "rep:"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aHlt		; "hlt"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCmc		; "cmc"
		dd 13h dup(0)
		dd 0Ch,	2, 2040000h, 16h dup(0)
		dd 0Dh,	2, 0D040000h, 17h dup(0)
		dd 8, 3	dup(0)
		dd offset aClc		; "clc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStc		; "stc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCli		; "cli"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSti		; "sti"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCld		; "cld"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStd		; "std"
		dd 13h dup(0)
		dd 0Eh,	2, 17h dup(0)
		dd 0Fh,	2, 17h dup(0)
dword_10021CC0	dd 0			; DATA XREF: .rdata:1001B488o
		dd 8, 0D040000h, 2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aDec		; "dec"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aCall		; "call"
		dd 14h dup(0)
		dd 6, 0D040000h, 2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 6, 6040000h,	2 dup(0)
		dd offset aJmp		; "jmp"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 2Ch dup(0)
dword_10021FE0	dd 0			; DATA XREF: .rdata:1001B448o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSar		; "sar"
		align 80h
dword_10022300	dd 33h dup(0)		; DATA XREF: .rdata:1001B4A8o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsraw	; "psraw"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	2070000h, 0
		dd offset aPsllw	; "psllw"
		dd 19h dup(0)
dword_10022620	dd 0			; DATA XREF: .rdata:1001B458o
		dd 8, 0D040000h, 150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_10022940	dd 0			; DATA XREF: .rdata:1001B4C0o
		dd 8, 3	dup(0)
		dd offset aFxsave	; "fxsave"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aFxrstor	; "fxrstor"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aLdmxcsr	; "ldmxcsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aStmxcsr	; "stmxcsr"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aLfence	; "lfence"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aMfence	; "mfence"
		align 80h
		dd 8, 3	dup(0)
		dd offset aClflushSfence ; "clflush/sfence"
		dd 13h dup(0)
dword_10022C60	dd 0			; DATA XREF: .rdata:1001B430o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		align 80h
dword_10022F80	dd 0			; DATA XREF: .rdata:1001B468o
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 0D040000h, 2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_100232A0	dd 0			; DATA XREF: .rdata:1001B450o
		dd 8, 2040000h,	150000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	150000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_100235C0	dd 0			; DATA XREF: .rdata:1001B480o
		dd 8, 2040000h,	2 dup(0)
		dd offset aInc		; "inc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aDec		; "dec"
		dd 13h dup(0)
dword_10023688	dd 33h dup(0)		; DATA XREF: .rdata:1001B4B8o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 4Ch dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsllq	; "psllq"
		align 8
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslldq	; "pslldq"
dword_100239A8	dd 0			; DATA XREF: .rdata:1001B438o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_10023CC8	dd 0			; DATA XREF: .rdata:1001B460o
		dd 8, 2040000h,	2140000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2140000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_10023FE8	dd 65h dup(0)		; DATA XREF: .rdata:1001B4C8o
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 0D040000h, 2070000h, 0
		dd offset aBtc		; "btc"
		dd 13h dup(0)
dword_10024308	dd 0			; DATA XREF: .rdata:1001B470o
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aMul		; "mul"
		align 80h
		dd 8, 2140000h,	2040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 2140000h,	2040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_10024628	dd 0			; DATA XREF: .rdata:1001B420o
		dd 8, 2040000h,	2070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
dword_10024948	dd 10h,	2, 17h dup(0)	; DATA XREF: .rdata:1001B418o
		dd 11h,	2, 18h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLar		; "lar"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aLsl		; "lsl"
		dd 46h dup(0)
		dd 8, 3	dup(0)
		dd offset aClts		; "clts"
		dd 2Dh dup(0)
		dd 8, 3	dup(0)
		dd offset aInvd		; "invd"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aWbinvd	; "wbinvd"
		dd 31h dup(0)
		dd offset aUd2		; "ud2"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMovsd	; "movsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMovss	; "movss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovupd	; "movupd"
		align 10h
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovups	; "movups"
		dd 1, 0
		dd 8, 0F110000h, 0F100000h, 0
		dd offset aMovsd	; "movsd"
		dd 0
		dd 8, 0B110000h, 0B100000h, 0
		dd offset aMovss	; "movss"
		dd 0
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovupd	; "movupd"
		dd 0
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 8
		dd 8, 2	dup(9100000h), 0
		dd offset aMovhlps	; "movhlps"
		align 10h
		dd 8, 9100000h,	0A110000h, 0
		dd offset aMovlpd	; "movlpd"
		align 8
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlps	; "movlps"
		dd 1, 0Dh dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovlpd	; "movlpd"
		dd 0
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpcklps	; "unpcklps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpcklpd	; "unpcklpd"
		align 10h
		dd 8, 8100000h,	9110000h, 0
		dd offset aUnpckhps	; "unpckhps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 9110000h, 0
		dd offset aUnpckhpd	; "unpckhpd"
		dd 0
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 8
		dd 8, 2	dup(9100000h), 0
		dd offset aMovlhps	; "movlhps"
		align 10h
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovhpd	; "movhpd"
		align 8
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhps	; "movhps"
		dd 1, 0Dh dup(0)
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovhpd	; "movhpd"
		dd 12h,	2, 0C7h	dup(0)
		dd 8, 40D0000h,	4020000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 40D0000h,	4030000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 4020000h,	40D0000h, 0
		dd offset aMov		; "mov"
		dd 14h dup(0)
		dd 8, 4030000h,	40D0000h, 0
		dd offset aMov		; "mov"
		dd 78h dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aMovapd	; "movapd"
		align 10h
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovaps	; "movaps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovapd	; "movapd"
		dd 0
		dd 8, 8100000h,	90C0000h, 0
		dd offset aCvtpi2ps	; "cvtpi2ps"
		dd 1, 0
		dd 8, 0F100000h, 4040000h, 0
		dd offset aCvtsi2sd	; "cvtsi2sd"
		align 8
		dd 8, 0B100000h, 4040000h, 0
		dd offset aCvtsi2ss	; "cvtsi2ss"
		align 10h
		dd 8, 10100000h, 50C0000h, 0
		dd offset aCvtpi2pd	; "cvtpi2pd"
		align 8
		dd 8, 8110000h,	8100000h, 0
		dd offset aMovntps	; "movntps"
		dd 1, 0Dh dup(0)
		dd 8, 10110000h, 10100000h, 0
		dd offset aMovntpd	; "movntpd"
		dd 0
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvttps2pi	; "cvttps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvttsd2si	; "cvttsd2si"
		align 10h
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvttss2si	; "cvttss2si"
		align 8
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvttpd2pi	; "cvttpd2pi"
		align 10h
		dd 8, 90C0000h,	8110000h, 0
		dd offset aCvtps2pi	; "cvtps2pi"
		dd 1, 0
		dd 8, 4060000h,	0F110000h, 0
		dd offset aCvtsd2si	; "cvtsd2si"
		dd 0
		dd 8, 4060000h,	0B110000h, 0
		dd offset aCvtss2si	; "cvtss2si"
		dd 0
		dd 8, 50C0000h,	10110000h, 0
		dd offset aCvtpd2pi	; "cvtpd2pi"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aUcomiss	; "ucomiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aUcomisd	; "ucomisd"
		align 8
		dd 8, 8100000h,	0B110000h, 0
		dd offset aComiss	; "comiss"
		dd 1, 0Dh dup(0)
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aComisd	; "comisd"
		dd 0
		dd 8, 3	dup(0)
		dd offset aWrmsr	; "wrmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdtsc	; "rdtsc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdmsr	; "rdmsr"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRdpmc	; "rdpmc"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aSysenter	; "sysenter"
		align 80h
		dd 8, 3	dup(0)
		dd offset aSysexit	; "sysexit"
		dd 0AAh	dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aMovnti	; "movnti"
		dd 5Fh dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovo	; "cmovo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovno	; "cmovno"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovc	; "cmovc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnc	; "cmovnc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovz	; "cmovz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovnz	; "cmovnz"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovbe	; "cmovbe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmova	; "cmova"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovs	; "cmovs"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovns	; "cmovns"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpe	; "cmovpe"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovpo	; "cmovpo"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovl	; "cmovl"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovge	; "cmovge"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovle	; "cmovle"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aCmovg	; "cmovg"
		dd 14h dup(0)
		dd 8, 4040000h,	8100000h, 0
		dd offset aMovmskps	; "movmskps"
		dd 1, 0Dh dup(0)
		dd 8, 4040000h,	10100000h, 0
		dd offset aMovmskpd	; "movmskpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aSqrtps	; "sqrtps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSqrtsd	; "sqrtsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSqrtss	; "sqrtss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aSqrtpd	; "sqrtpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aRsqrtps	; "rsqrtps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRsqrtss	; "rsqrtss"
		dd 7 dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aRcpps	; "rcpps"
		dd 1, 7	dup(0)
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aRcpss	; "rcpss"
		dd 7 dup(0)
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndps	; "andps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndpd	; "andpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aAndnps	; "andnps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aAndnpd	; "andnpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aOrps		; "orps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aOrpd		; "orpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aXorps	; "xorps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 0
		dd offset aXorpd	; "xorpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aAddps	; "addps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aAddsd	; "addsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aAddss	; "addss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aAddpd	; "addpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aMulps	; "mulps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMulsd	; "mulsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMulss	; "mulss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMulpd	; "mulpd"
		dd 0
		dd 8, 10100000h, 8110000h, 0
		dd offset aCvtps2pd	; "cvtps2pd"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aCvtsd2ss	; "cvtsd2ss"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aCvtss2sd	; "cvtss2sd"
		align 10h
		dd 8, 8100000h,	10110000h, 0
		dd offset aCvtpd2ps	; "cvtpd2ps"
		align 8
		dd 8, 8100000h,	5110000h, 0
		dd offset aCvtdq2ps	; "cvtdq2ps"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvttps2dq	; "cvttps2dq"
		dd 0
		dd 8, 5100000h,	8110000h, 0
		dd offset aCvtps2dq	; "cvtps2dq"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aSubps	; "subps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aSubsd	; "subsd"
		align 10h
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aSubss	; "subss"
		align 8
		dd 8, 10100000h, 10110000h, 0
		dd offset aSubpd	; "subpd"
		align 10h
		dd 8, 8100000h,	8110000h, 0
		dd offset aMinps	; "minps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMinsd	; "minsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMinss	; "minss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMinpd	; "minpd"
		dd 0
		dd 8, 8100000h,	8110000h, 0
		dd offset aDivps	; "divps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aDivsd	; "divsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aDivss	; "divss"
		align 10h
		dd 8, 10100000h, 10110000h, 0
		dd offset aDivpd	; "divpd"
		align 8
		dd 8, 8100000h,	8110000h, 0
		dd offset aMaxps	; "maxps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 0
		dd offset aMaxsd	; "maxsd"
		dd 0
		dd 8, 0B100000h, 0B110000h, 0
		dd offset aMaxss	; "maxss"
		dd 0
		dd 8, 10100000h, 10110000h, 0
		dd offset aMaxpd	; "maxpd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklbw	; "punpcklbw"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklwd	; "punpcklwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckldq	; "punpckldq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpckldq	; "punpckldq"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPacksswb	; "packsswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtb	; "pcmpgtb"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtw	; "pcmpgtw"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpgtd	; "pcmpgtd"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPackuswb	; "packuswb"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhbw	; "punpckhbw"
		align 10h
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhwd	; "punpckhwd"
		dd 0
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPunpckhdq	; "punpckhdq"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 1, 0Dh dup(0)
		dd 8, 50B0000h,	50C0000h, 0
		dd offset aPackssdw	; "packssdw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		align 10h
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPunpcklqdq	; "punpcklqdq"
		dd 0
		dd 8, 40B0000h,	4040000h, 0
		dd offset aMovd		; "movd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 0
		dd offset aMovd		; "movd"
		align 8
		dd 8, 90B0000h,	40C0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5100000h,	5110000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 8, 90B0000h,	90C0000h, 2070000h
		dd offset aPshuf	; "pshuf"
		dd 1, 0
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshuflw	; "pshuflw"
		align 10h
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufhw	; "pshufhw"
		align 8
		dd 8, 5100000h,	5110000h, 2070000h
		dd offset aPshufd	; "pshufd"
		dd 13h,	2, 17h dup(0)
		dd 14h,	2, 17h dup(0)
		dd 15h,	2, 18h dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqb	; "pcmpeqb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqw	; "pcmpeqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPcmpeqd	; "pcmpeqd"
		align 8
		dd 8, 3	dup(0)
		dd offset aEmms		; "emms"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 4040000h,	40B0000h, 0
		dd offset aMovd		; "movd"
		dd 1, 7	dup(0)
		dd 8, 9100000h,	9110000h, 0
		dd offset aMovq		; "movq"
		align 10h
		dd 8, 4040000h,	5100000h, 0
		dd offset aMovd		; "movd"
		align 8
		dd 8, 90C0000h,	90B0000h, 0
		dd offset aMovq		; "movq"
		dd 1, 7	dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqu	; "movdqu"
		dd 0
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovdqa	; "movdqa"
		dd 0
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJo		; "jo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJno		; "jno"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJc		; "jc"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnc		; "jnc"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJz		; "jz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJnz		; "jnz"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJbe		; "jbe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJa		; "ja"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJs		; "js"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJns		; "jns"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpe		; "jpe"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJpo		; "jpo"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJl		; "jl"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJge		; "jge"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJle		; "jle"
		dd 14h dup(0)
		dd 6, 0D080000h, 2 dup(0)
		dd offset aJg		; "jg"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeto		; "seto"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetno	; "setno"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetc		; "setc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnc	; "setnc"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetz		; "setz"
		align 80h
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetnz	; "setnz"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetbe	; "setbe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSeta		; "seta"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSets		; "sets"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetns	; "setns"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpe	; "setpe"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetpo	; "setpo"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetl		; "setl"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetge	; "setge"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetle	; "setle"
		dd 14h dup(0)
		dd 8, 2040000h,	2 dup(0)
		dd offset aSetg		; "setg"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aCpuid	; "cpuid"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBt		; "bt"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShld		; "shld"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 18h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPush		; "push"
		dd 14h dup(0)
		dd 8, 0E140000h, 2 dup(0)
		dd offset aPop		; "pop"
		dd 14h dup(0)
		dd 8, 3	dup(0)
		dd offset aRsm		; "rsm"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBts		; "bts"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2070000h
		dd offset aShrd		; "shrd"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 2170000h
		dd offset aShrd		; "shrd"
		dd 13h dup(0)
		dd 16h,	2, 18h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aCmpxchg	; "cmpxchg"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLss		; "lss"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtr		; "btr"
		dd 14h dup(0)
		dd 8, 6090000h,	2 dup(0)
		dd offset aLfs		; "lfs"
		align 80h
		dd 8, 6090000h,	2 dup(0)
		dd offset aLgs		; "lgs"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovzx	; "movzx"
		dd 14h dup(0)
		dd 1, 18h dup(0)
		dd 1, 3	dup(0)
		dd offset aUd1		; "ud1"
		dd 13h dup(0)
		dd 17h,	2, 18h dup(0)
		dd 8, 0D040000h, 0D060000h, 0
		dd offset aBtc		; "btc"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsf		; "bsf"
		dd 14h dup(0)
		dd 8, 0D060000h, 0D040000h, 0
		dd offset aBsr		; "bsr"
		dd 14h dup(0)
		dd 8, 0D060000h, 2040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 0D060000h, 0E040000h, 0
		dd offset aMovsx	; "movsx"
		dd 14h dup(0)
		dd 8, 2040000h,	2060000h, 0
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aXadd		; "xadd"
		dd 14h dup(0)
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aCmpps	; "cmpps"
		dd 1, 0
		dd 8, 0F100000h, 0F110000h, 2070000h
		dd offset aCmpsd	; "cmpsd"
		align 8
		dd 8, 0B100000h, 0B110000h, 2070000h
		dd offset aCmpss	; "cmpss"
		align 10h
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aCmppd	; "cmppd"
		align 8
		dd 8, 4040000h,	4060000h, 0
		dd offset aMovnti	; "movnti"
		dd 14h dup(0)
		dd 8, 90B0000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	4040000h, 2070000h
		dd offset aPinsrw	; "pinsrw"
		align 10h
		dd 8, 4060000h,	90B0000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 2070000h
		dd offset aPextrw	; "pextrw"
		dd 0
		dd 8, 8100000h,	8110000h, 2070000h
		dd offset aShufps	; "shufps"
		dd 1, 0Dh dup(0)
		dd 8, 10100000h, 10110000h, 2070000h
		dd offset aShufpd	; "shufpd"
		dd 18h,	2, 18h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 14h dup(0)
		dd 8, 4140000h,	2 dup(0)
		dd offset aBswap	; "bswap"
		dd 2Dh dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlw	; "psrlw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrld	; "psrld"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrlq	; "psrlq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddq	; "paddq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddq	; "paddq"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmullw	; "pmullw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmullw	; "pmullw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aUnusedWithoutP ; "unused without prefix"
		dd 1, 0
		dd 8, 90B0000h,	9110000h, 0
		dd offset aMovdq2q	; "movdq2q"
		align 8
		dd 8, 5100000h,	90C0000h, 0
		dd offset aMovq2dq	; "movq2dq"
		align 10h
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovq		; "movq"
		align 8
		dd 8, 4060000h,	90B0000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 1, 0Dh dup(0)
		dd 8, 4060000h,	5100000h, 0
		dd offset aPmovmskb	; "pmovmskb"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusb	; "psubusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusb	; "psubusb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubusw	; "psubusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminub	; "pminub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminub	; "pminub"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPand		; "pand"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPand		; "pand"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusb	; "paddusb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusb	; "paddusb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddusw	; "paddusw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxub	; "pmaxub"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxub	; "pmaxub"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPandn	; "pandn"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPandn	; "pandn"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgb	; "pavgb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgb	; "pavgb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsraw	; "psraw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrqw	; "psrqw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsrad	; "psrad"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPavgw	; "pavgw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPavgw	; "pavgw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmulhuw	; "pmulhuw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmulhw	; "pmulhw"
		dd 0
		dd 8, 3	dup(0)
		dd offset aNotUsedWithout ; "not used without prefix"
		dd 1, 0
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvtpd2dq	; "cvtpd2dq"
		align 8
		dd 8, 10100000h, 5110000h, 0
		dd offset aCvtdq2pd	; "cvtdq2pd"
		align 10h
		dd 8, 5100000h,	10110000h, 0
		dd offset aCvttpd2dq	; "cvttpd2dq"
		align 8
		dd 8, 9110000h,	9100000h, 0
		dd offset aMovntq	; "movntq"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	5100000h, 0
		dd offset aMovntdq	; "movntdq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsb	; "psubsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsb	; "psubsb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubsw	; "psubsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPminsw	; "pminsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPminsw	; "pminsw"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPor		; "por"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPor		; "por"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsb	; "paddsb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsb	; "paddsb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddsw	; "paddsw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaxsw	; "pmaxsw"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPxor		; "pxor"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPxor		; "pxor"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllw	; "psllw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllw	; "psllw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPslld	; "pslld"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsllq	; "psllq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsllq	; "psllq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmuludq	; "pmuludq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmuludq	; "pmuludq"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPmaddwd	; "pmaddwd"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsadbw	; "psadbw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsadbw	; "psadbw"
		align 8
		dd 8, 70B0000h,	70C0000h, 0
		dd offset aMaskmovq	; "maskmovq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aMaskmovdqu	; "maskmovdqu"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubb	; "psubb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubb	; "psubb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubw	; "psubw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubw	; "psubw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubd	; "psubd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubd	; "psubd"
		align 8
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPsubq	; "psubq"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPsubq	; "psubq"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddb	; "paddb"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddb	; "paddb"
		align 10h
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddw	; "paddw"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddw	; "paddw"
		dd 0
		dd 8, 90B0000h,	90C0000h, 0
		dd offset aPaddd	; "paddd"
		dd 1, 0Dh dup(0)
		dd 8, 5100000h,	5110000h, 0
		dd offset aPaddd	; "paddd"
		dd 19h dup(0)
dword_1002AD48	dd 0			; DATA XREF: .rdata:1001B478o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aTest		; "test"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNot		; "not"
		dd 14h dup(0)
		dd 8, 0D040000h, 2 dup(0)
		dd offset aNeg		; "neg"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aMul		; "mul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aImul		; "imul"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aDiv		; "div"
		dd 14h dup(0)
		dd 8, 0D140000h, 0D040000h, 0
		dd offset aIdiv		; "idiv"
		dd 13h dup(0)
dword_1002B068	dd 0			; DATA XREF: .rdata:1001B440o
		dd 8, 2040000h,	2070000h, 0
		dd offset aRol		; "rol"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRor		; "ror"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcl		; "rcl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aRcr		; "rcr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShl		; "shl"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aShr		; "shr"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSal		; "sal"
		dd 14h dup(0)
		dd 8, 2040000h,	2070000h, 0
		dd offset aSar		; "sar"
		dd 13h dup(0)
dword_1002B388	dd 33h dup(0)		; DATA XREF: .rdata:1001B4B0o
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrld	; "psrld"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPsrad	; "psrad"
		dd 1Ah dup(0)
		dd 8, 90B0000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 1, 0Dh dup(0)
		dd 8, 5110000h,	2070000h, 0
		dd offset aPslld	; "pslld"
		dd 19h dup(0)
dword_1002B6A8	dd 0			; DATA XREF: .rdata:1001B428o
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAdd		; "add"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aOr		; "or"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAdc		; "adc"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSbb		; "sbb"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aAnd		; "and"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aSub		; "sub"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aXor		; "xor"
		dd 14h dup(0)
		dd 8, 0D040000h, 0D070000h, 0
		dd offset aCmp		; "cmp"
		dd 13h dup(0)
aNtdll_dll_6:				; DATA XREF: sub_10016952+22o
					; sub_10016952+57o
		unicode	0, <ntdll.dll>,0
a??_2:					; DATA XREF: sub_1001801F+13o
					; sub_10018182+1Eo ...
		unicode	0, <\??\>,0
		align 4
; const	WCHAR aNtdll_dll_4
aNtdll_dll_4:				; DATA XREF: sub_10018835+16o
		unicode	0, <ntdll.dll>,0
		align 10h
off_1002BA00	dd offset aHkey_classes_r ; DATA XREF: sub_10018091:loc_100180A9r
					; sub_10018091+85r
					; "HKEY_CLASSES_ROOT"
; HKEY hKey
hKey		dd 80000000h		; DATA XREF: sub_10018091+59r
		dd offset aHkey_current_u ; "HKEY_CURRENT_USER"
		dd 80000001h
		dd offset aHkey_local_m_2 ; "HKEY_LOCAL_MACHINE"
		dd 80000002h
		dd offset aHkey_users	; "HKEY_USERS"
		dd 80000003h
		dd offset aHkey_performan ; "HKEY_PERFORMANCE_DATA"
		dd 80000004h
		dd offset aHkey_perform_0 ; "HKEY_PERFORMANCE_TEXT"
		dd 80000050h
		dd offset aHkey_perform_1 ; "HKEY_PERFORMANCE_NLSTEXT"
		dd 80000060h
		dd offset aHkey_current_c ; "HKEY_CURRENT_CONFIG"
		dd 80000005h
		dd offset aHkey_dyn_data ; "HKEY_DYN_DATA"
		dd 80000006h
aBrokerevent	db 'BrokerEvent',0      ; DATA XREF: sub_10004545+13o
					; sub_10004592+27o ...
aMapSetTTooLong	db 'map/set<T> too long',0 ; DATA XREF: sub_10004F33+1Ao
					; sub_100050F6+1Bo ...
aAuthenticamd	db 'AuthenticAMD',0     ; DATA XREF: sub_10005396+5o
		align 4
aCBuildsMoz2_sl	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_1000591B+1Co
					; sub_10005965+91o ...
		db 'y/sandbox/chromium/base/win/scoped_handle.cc',0
		align 4
aListTTooLong	db 'list<T> too long',0 ; DATA XREF: sub_10005F5C+3Do
					; sub_10008D33+2Fo ...
		align 4
; const	WCHAR ModuleName
ModuleName:				; DATA XREF: sub_100062BD:loc_10006300o
					; sub_10006426+38o ...
		unicode	0, <kernel32.dll>,0
		align 4
; CHAR ProcName[]
ProcName	db 'InitializeProcThreadAttributeList',0 ; DATA XREF: sub_100062BD+56o
		align 4
; CHAR aUpdateprocthre[]
aUpdateprocthre	db 'UpdateProcThreadAttribute',0 ; DATA XREF: sub_100062BD+5Eo
		align 4
; CHAR aDeleteprocthre[]
aDeleteprocthre	db 'DeleteProcThreadAttributeList',0 ; DATA XREF: sub_100062BD+6Bo
		align 4
; CHAR aGetproductinfo[]
aGetproductinfo	db 'GetProductInfo',0   ; DATA XREF: sub_10006426+179o
		align 4
; CHAR aIswow64process[]
aIswow64process	db 'IsWow64Process',0   ; DATA XREF: sub_10006426+33o
		align 4
asc_1002BB98	db '\',0                ; DATA XREF: sub_10006844+4Fo
					; sub_10006844+A3o ...
		align 4
asc_1002BB9C	db ' ',0                ; DATA XREF: sub_10007678+FBo
		align 10h
aWow_helper_exe:			; DATA XREF: sub_10006844+15Fo
		unicode	0, <wow_helper.exe" >,0
		align 4
asc_1002BBC4:				; DATA XREF: sub_10006844+145o
		unicode	0, <">,0
dword_1002BBC8	dd 0			; DATA XREF: sub_10006BCF+Fo
		dd 68h
off_1002BBD0	dd offset sub_10007252	; DATA XREF: sub_10006BCF+58o
					; sub_10006C63+7o
		dd offset ?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Lock(void)
		dd offset ?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::_Unlock(void)
		dd offset sub_10006CAE
		dd offset sub_10006E8A
		dd offset ?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JXZ ;	std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::showmanyc(void)
		dd offset sub_10006EE3
		dd offset ?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::uflow(void)
		dd offset ?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsgetn(wchar_t *,__int64)
		dd offset ?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::xsputn(wchar_t const *,__int64)
		dd offset sub_10006F45
		dd offset sub_10007106
		dd offset ?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12@PA_W_J@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::setbuf(wchar_t *,__int64)
		dd offset ?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ	; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::sync(void)
		dd offset ?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlocale@2@@Z ; std::basic_streambuf<wchar_t,std::char_traits<wchar_t>>::imbue(std::locale const	&)
off_1002BC0C	dd offset sub_1000784B	; DATA XREF: sub_10006BCF+34o
					; sub_10006C33+Co
dword_1002BC10	dd 0			; DATA XREF: sub_10006BCF+15o
		dd 58h
; CHAR aAppcontainerre[]
aAppcontainerre	db 'AppContainerRegisterSid',0 ; DATA XREF: sub_10007B85+3Do
; CHAR aAppcontainerun[]
aAppcontainerun	db 'AppContainerUnregisterSid',0 ; DATA XREF: sub_10007C21+3Co
		align 4
; CHAR aAppcontainerlo[]
aAppcontainerlo	db 'AppContainerLookupMoniker',0 ; DATA XREF: sub_10007CA5+5Co
					; sub_10007CA5+6Fo
		align 4
; CHAR aAppcontainerfr[]
aAppcontainerfr	db 'AppContainerFreeMemory',0 ; DATA XREF: sub_10007CA5+83o
					; sub_10007CA5+96o
		align 10h
off_1002BC80	dd offset sub_10017F0F	; DATA XREF: sub_100083E3+3F7o
					; sub_10017FFC+6o
		dd offset sub_10017F72
		dd offset sub_10007EB2
off_1002BC8C	dd offset _purecall	; DATA XREF: sub_10007E94+8o
					; sub_10017FFC+1Bo
		dd offset _purecall
		dd offset sub_10007E94
off_1002BC98	dd offset sub_10008003	; DATA XREF: sub_10007F44+9o
					; sub_10008064+17o
		dd offset sub_100081A6
		dd offset sub_100083E3
		dd offset sub_100089E1
		dd offset sub_10008A84
		dd offset sub_10008B8B
		dd offset sub_10008C66
; char aMoz_win_inheri[]
aMoz_win_inheri	db 'MOZ_WIN_INHERIT_STD_HANDLES_PRE_VISTA',0
					; DATA XREF: sub_100083E3:loc_10008783o
		align 4
; const	WCHAR SubKey
SubKey		dw 0			; DATA XREF: sub_1000997E+27o
					; sub_10013A85+55o ...
		align 10h
a_targetntcre_2	db '_TargetNtCreateFile@48',0 ; DATA XREF: sub_10009C33+8Eo
		align 4
; CHAR aNtcreatefile[]
aNtcreatefile	db 'NtCreateFile',0     ; DATA XREF: sub_10009C33+95o
					; TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+55o ...
		align 4
a_targetntope_5	db '_TargetNtOpenFile@28',0 ; DATA XREF: sub_10009C33+75o
		align 10h
aNtopenfile	db 'NtOpenFile',0       ; DATA XREF: sub_10009C33+7Co
					; TargetNtOpenFile(x,x,x,x,x,x,x)+44o ...
		align 4
a_targetntque_2	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: sub_10009C33+5Co
; CHAR aNtqueryattribu[]
aNtqueryattribu	db 'NtQueryAttributesFile',0 ; DATA XREF: sub_10009C33+63o
					; TargetNtQueryAttributesFile(x,x,x)+39o ...
		align 4
a_targetntque_1	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: sub_10009C33+43o
; CHAR aNtqueryfullatt[]
aNtqueryfullatt	db 'NtQueryFullAttributesFile',0 ; DATA XREF: sub_10009C33+4Ao
					; TargetNtQueryFullAttributesFile(x,x,x)+39o ...
		align 4
a_targetntset_1	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: sub_10009C33+2Ao
		align 4
; CHAR aNtsetinformati[]
aNtsetinformati	db 'NtSetInformationFile',0 ; DATA XREF: sub_10009C33+31o
					; TargetNtSetInformationFile(x,x,x,x,x,x)+42o ...
		align 4
off_1002BDDC	dd offset sub_100099E1	; DATA XREF: sub_10009BAF+3o
					; sub_10009BD2+1Co
		dd offset sub_10009C33
		dd offset sub_10009BAF
dword_1002BDE8	dd 3, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_10009BD2+6o
		dd offset sub_10009CE2
dword_1002BE14	dd 7, 4, 2 dup(6), 2 dup(2), 4 dup(0) ;	DATA XREF: sub_10009BD2+4Eo
		dd offset sub_1000A086
dword_1002BE40	dd 5, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_10009BD2+36o
		dd offset sub_10009EE4
dword_1002BE6C	dd 4, 1, 4 dup(2), 4 dup(0) ; DATA XREF: sub_10009BD2+2Ao
		dd offset sub_10009DE6
off_1002BE98	dd offset sub_100099E1	; DATA XREF: sub_10009B6C+3o
		dd offset _purecall
		dd offset sub_10009B92
dword_1002BEA4	dd 6, 1, 2, 6, 6 dup(0)	; DATA XREF: sub_10009BD2+42o
		dd offset sub_10009FB5
a??:					; DATA XREF: sub_1000B617+36o
		unicode	0, <\/?/?\*>,0
asc_1002BEE0:				; DATA XREF: sub_1000B617+59o
		unicode	0, <*~*>,0
a??_0:					; DATA XREF: sub_1000BA03+1Bo
		unicode	0, <\/?/?\>,0
		align 4
aKey:					; DATA XREF: sub_1000BC43+5Do
		unicode	0, <Key>,0
; CHAR aG_handles_to_0[]
aG_handles_to_0	db 'g_handles_to_close',0 ; DATA XREF: sub_1000BEB1+83o
		align 4
; CHAR aNtqueryobject[]
aNtqueryobject	db 'NtQueryObject',0    ; DATA XREF: sub_1000C08E+25o
					; sub_1000C7F7+1Fo ...
		align 4
aCheckFailedG_h	db 'Check failed: g_handles_to_close != NULL. ',0
					; DATA XREF: sub_1000C863+40o
		align 10h
aCBuildsMoz2__3	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_1000C863+31o
					; sub_1000C863+188o
		db 'y/sandbox/chromium/sandbox/win/src/handle_closer_agent.cc',0
		align 4
aCheckFailedNam	db 'Check failed: name.second. ',0 ; DATA XREF: sub_1000C863+199o
dword_1002BFE8	dd 12h,	4, 3 dup(2), 5 dup(0) ;	DATA XREF: sub_10014386+20Eo
		dd offset sub_1000D2DF
off_1002C014	dd offset sub_100099E1	; DATA XREF: sub_1000D2B1+3o
					; sub_10014386+213o
		dd offset sub_1000D2D4
		dd offset sub_1000D2B1
aDuplicatehandl	db 'DuplicateHandle',0  ; DATA XREF: sub_1000D439+87o
					; sub_1000D439+9Do
off_1002C030	dd offset sub_1000D7D8	; DATA XREF: sub_1000D7D8+8o
		dd offset _purecall
		dd offset sub_10012A2B
		dd offset sub_10012ADB
		dd offset _purecall
		dd offset sub_100129B4
off_1002C048	dd offset sub_1000D7D8	; DATA XREF: sub_1000E032+1BAo
		dd offset sub_100154EE
		dd offset sub_1001549D
		dd offset sub_100154A2
		dd offset sub_1001557C
		dd offset sub_100129B4
		dd offset sub_100154DB
		dd offset sub_10015580
		dd offset sub_100155E8
		dd offset sub_100156CD
off_1002C070	dd offset sub_1000D7D8	; DATA XREF: sub_1000E032+15Eo
		dd offset sub_100154EE
		dd offset sub_1001549D
		dd offset sub_100154A2
		dd offset sub_1001557C
		dd offset sub_100129B4
		dd offset sub_100154DB
		dd offset sub_10015580
		dd offset sub_100158CA
		dd offset sub_100156CD
off_1002C098	dd offset sub_1000D7D8	; DATA XREF: sub_1000E032+17Bo
		dd offset sub_100154EE
		dd offset sub_1001549D
		dd offset sub_100154A2
		dd offset sub_1001557C
		dd offset sub_100129B4
		dd offset sub_100154DB
		dd offset sub_10015580
		dd offset sub_10015829
		dd offset sub_100156CD
off_1002C0C0	dd offset sub_1000D7D8	; DATA XREF: sub_1000E032+19Do
		dd offset sub_100154EE
		dd offset sub_1001549D
		dd offset sub_100154A2
		dd offset sub_1001557C
		dd offset sub_100129B4
		dd offset sub_100154DB
		dd offset sub_10015580
		dd offset sub_10015940
		dd offset sub_100156CD
aSizeKallocgran	db 'size <= kAllocGranularity',0 ; DATA XREF: sub_1000D7F6+19o
		align 8
aCBuildsMoz2__0	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_10001B95+13o
					; sub_1000DE85+CBo
		db 'y/sandbox/chromium/sandbox/win/src/interception.cc',0
; CHAR aG_intercepti_0[]
aG_intercepti_0	db 'g_interceptions',0  ; DATA XREF: sub_1000D979+66o
a_targetntmap_0	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: sub_1000DE85+3Ao
		align 10h
aNtmapviewofsec	db 'NtMapViewOfSection',0 ; DATA XREF: sub_1000DE85+40o
					; sub_1000EE56+A7o
		align 4
a_targetntunm_0	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: sub_1000DE85+51o
		align 10h
aNtunmapviewofs	db 'NtUnmapViewOfSection',0 ; DATA XREF: sub_1000DE85+57o
					; sub_1000EE56+143o
		align 4
aCheckFailedThu	db 'Check failed: thunk_base. ',0 ; DATA XREF: sub_1000DE85+E1o
		align 4
; CHAR aG_originals_0[]
aG_originals_0	db 'g_originals',0      ; DATA XREF: sub_1000DE85+17Fo
aLdrgetdllhandl	db 'LdrGetDllHandle',0  ; DATA XREF: sub_1000E032:loc_1000E086o
					; sub_1000EE56+14o
off_1002C240	dd offset sub_1000D7D8	; DATA XREF: sub_1000E740+99o
		dd offset sub_1001682B
		dd offset sub_10012A2B
		dd offset sub_10012ADB
		dd offset sub_100168C2
		dd offset sub_100129B4
off_1002C258	dd offset sub_1000D7D8	; DATA XREF: sub_1000E740+27o
		dd offset sub_10009A67
		dd offset sub_10012A2B
		dd offset sub_10009B04
		dd offset sub_10009B68
		dd offset sub_100129B4
off_1002C270	dd offset sub_1000D7D8	; DATA XREF: sub_1000E740+61o
		dd offset sub_10016763
		dd offset sub_10012A2B
		dd offset sub_10012ADB
		dd offset sub_10016827
		dd offset sub_100129B4
aCreatenamedpip	db 'CreateNamedPipeW',0 ; DATA XREF: sub_1000E935+1Do
					; TargetCreateNamedPipeW(x,x,x,x,x,x,x,x,x)+85o ...
		align 4
a_targetcreat_3	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: sub_1000E935+16o
		align 4
a_:					; DATA XREF: sub_1000E968+11Fo
		unicode	0, <\\.\>,0
		align 4
a__:					; DATA XREF: sub_1000E968:loc_1000EA07o
					; sub_1000E968+AAo
		unicode	0, <..>,0
		align 4
a?:					; DATA XREF: sub_1000E968+140o
		unicode	0, <\\?\>,0
		align 4
off_1002C2D8	dd offset sub_100099E1	; DATA XREF: sub_1000E912+3o
					; sub_10014386+119o
		dd offset sub_1000E935
		dd offset sub_1000E912
dword_1002C2E4	dd 8, 1, 6 dup(2), 2 dup(0) ; DATA XREF: sub_10014386+114o
		dd offset sub_1000E968
aNtallocatevirt	db 'NtAllocateVirtualMemory',0 ; DATA XREF: sub_1000EE56:loc_1000EE95o
		align 10h
aNtduplicateobj	db 'NtDuplicateObject',0 ; DATA XREF: sub_1000EE56+73o
		align 4
; CHAR aNtclose[]
aNtclose	db 'NtClose',0          ; DATA XREF: sub_1000EE56+59o
					; sub_100125FC+2Fo ...
		align 10h
aNtprotectvirtu	db 'NtProtectVirtualMemory',0 ; DATA XREF: sub_1000EE56+C1o
		align 10h
aNtfreevirtualm	db 'NtFreeVirtualMemory',0 ; DATA XREF: sub_1000EE56+8Do
aNtquerysection	db 'NtQuerySection',0   ; DATA XREF: sub_1000EE56+10Fo
		align 10h
aNtqueryinforma	db 'NtQueryInformationProcess',0 ; DATA XREF: sub_1000EE56+DBo
		align 10h
aRtlallocatehea	db 'RtlAllocateHeap',0  ; DATA XREF: sub_1000EE56+15Do
aNtqueryvirtual	db 'NtQueryVirtualMemory',0 ; DATA XREF: sub_1000EE56+129o
		align 10h
aRtlcompareunic	db 'RtlCompareUnicodeString',0 ; DATA XREF: sub_1000EE56+191o
		align 10h
aRtlansistringt	db 'RtlAnsiStringToUnicodeString',0 ; DATA XREF: sub_1000EE56+177o
		align 10h
aRtlcreateusert	db 'RtlCreateUserThread',0 ; DATA XREF: sub_1000EE56+1C5o
aRtlcreateheap	db 'RtlCreateHeap',0    ; DATA XREF: sub_1000EE56+1ABo
		align 4
aRtlfreeheap	db 'RtlFreeHeap',0      ; DATA XREF: sub_1000EE56+1F9o
aRtldestroyheap	db 'RtlDestroyHeap',0   ; DATA XREF: sub_1000EE56+1DFo
		align 10h
aStrlen		db 'strlen',0           ; DATA XREF: sub_1000EE56+225o
		align 4
a_strnicmp	db '_strnicmp',0        ; DATA XREF: sub_1000EE56+20Fo
		align 4
aMemcpy		db 'memcpy',0           ; DATA XREF: sub_1000EE56+251o
		align 4
aWcslen		db 'wcslen',0           ; DATA XREF: sub_1000EE56+23Bo
		align 4
a_targetntope_8	db '_TargetNtOpenThread@20',0 ; DATA XREF: sub_1000F0DF+1Co
		align 4
; CHAR aG_nt_0[]
aG_nt_0		db 'g_nt',0             ; DATA XREF: sub_1000EE56+26Eo
		align 4
a_targetntope_9	db '_TargetNtOpenProcess@20',0 ; DATA XREF: sub_1000F0DF+44o
; CHAR aNtopenthread[]
aNtopenthread	db 'NtOpenThread',0     ; DATA XREF: sub_1000F0DF+22o
					; TargetNtOpenThread(x,x,x,x,x)+2Eo ...
		align 4
a_targetntop_10	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: sub_1000F0DF+6Eo
		align 4
; CHAR aNtopenprocess[]
aNtopenprocess	db 'NtOpenProcess',0    ; DATA XREF: sub_1000F0DF+4Ao
					; sub_10011B1A+1Ao
		align 4
a_targetntset_2	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: sub_1000F0DF+98o
		align 10h
; CHAR aNtopenprocesst[]
aNtopenprocesst	db 'NtOpenProcessToken',0 ; DATA XREF: sub_1000F0DF+74o
					; sub_10010B00+10o ...
		align 4
a_targetntop_11	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: sub_1000F0DF+C2o
aNtsetinforma_0	db 'NtSetInformationThread',0 ; DATA XREF: sub_1000F0DF+9Eo
		align 4
a_targetntop_12	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: sub_1000F0DF+F2o
		align 4
aNtopenthreadto	db 'NtOpenThreadToken',0 ; DATA XREF: sub_1000F0DF+C8o
		align 4
a_targetntop_13	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: sub_1000F0DF+119o
		align 4
; CHAR aNtopenproces_0[]
aNtopenproces_0	db 'NtOpenProcessTokenEx',0 ; DATA XREF: sub_1000F0DF+F9o
					; sub_10010B7B+10o ...
		align 4
aNtopenthread_0	db 'NtOpenThreadTokenEx',0 ; DATA XREF: sub_1000F0DF+120o
aCheckFailedIsv	db 'Check failed: IsValueInRangeForNumericType<Dst>(value). ',0
					; DATA XREF: sub_1000F21E+39o
		align 8
aCBuildsMoz2__1	db 'c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\securit'
					; DATA XREF: sub_1000F21E+28o
		db 'y\sandbox\chromium\base/numerics/safe_conversions.h',0
		align 10h
; CHAR aKernel32_dll_3[]
aKernel32_dll_3	db 'kernel32.dll',0     ; DATA XREF: sub_1001028F+2Co
		align 10h
; CHAR aSetprocessdepp[]
aSetprocessdepp	db 'SetProcessDEPPolicy',0 ; DATA XREF: sub_1001028F:loc_1001034Fo
; CHAR aSetdefaultdlld[]
aSetdefaultdlld	db 'SetDefaultDllDirectories',0 ; DATA XREF: sub_1001028F+53o
		align 10h
; CHAR aSetprocessmiti[]
aSetprocessmiti	db 'SetProcessMitigationPolicy',0 ; DATA XREF: sub_1001028F+140o
		align 4
; CHAR aNtsetinforma_1[]
aNtsetinforma_1	db 'NtSetInformationProcess',0 ; DATA XREF: sub_1001028F+F3o
a_targetgdidl_0	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: sub_100106BC+6Do
		align 10h
aGdi32_dll:				; DATA XREF: sub_100106BC:loc_10010735o
		unicode	0, <gdi32.dll>,0
aGdidllinitiali	db 'GdiDllInitialize',0 ; DATA XREF: sub_100106BC+74o
		align 4
aGetstockobject	db 'GetStockObject',0   ; DATA XREF: sub_100106BC+5Bo
		align 4
a_targetgetst_0	db '_TargetGetStockObject@8',0 ; DATA XREF: sub_100106BC+54o
aRegisterclassw	db 'RegisterClassW',0   ; DATA XREF: sub_100106BC+3Do
		align 10h
a_targetregis_0	db '_TargetRegisterClassW@8',0 ; DATA XREF: sub_100106BC+36o
aUser32_dll_0:				; DATA XREF: sub_100106BC+42o
		unicode	0, <user32.dll>,0
		align 10h
off_1002C7D0	dd offset sub_100099E1	; DATA XREF: sub_10010699+3o
					; sub_10014386+23Eo
		dd offset sub_100106BC
		dd offset sub_10010699
asc_1002C7DC:				; DATA XREF: sub_100108BF+1Fo
		unicode	0, <:\>,0
		align 4
asc_1002C7E4:				; DATA XREF: sub_100108BF+4o
		unicode	0, <\\>,0
		align 4
a_targetcreat_1	db '_TargetCreateProcessW@44',0 ; DATA XREF: sub_10010A1C+2Eo
		align 4
a_targetcreat_2	db '_TargetCreateProcessA@44',0 ; DATA XREF: sub_10010A1C+5Ao
		align 4
aCreateprocessw	db 'CreateProcessW',0   ; DATA XREF: sub_10010A1C+35o
					; TargetCreateProcessW(x,x,x,x,x,x,x,x,x,x,x)+7Do ...
		align 4
aCreateprocessa	db 'CreateProcessA',0   ; DATA XREF: sub_10010A1C+61o
					; TargetCreateProcessA(x,x,x,x,x,x,x,x,x,x,x)+78o ...
		align 4
dword_1002C844	dd 0Ch,	4, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_100109BB+42o
		dd offset sub_10010B7B
off_1002C870	dd offset sub_100099E1	; DATA XREF: sub_100107BA+3o
					; sub_100109BB+1Co
		dd offset sub_10010A1C
		dd offset sub_100107BA
dword_1002C87C	dd 0Dh,	3 dup(1), 6, 5 dup(0) ;	DATA XREF: sub_100109BB+4Eo
		dd offset sub_10010BFA
dword_1002C8A8	dd 0Bh,	4, 2, 7	dup(0)	; DATA XREF: sub_100109BB+36o
		dd offset sub_10010B00
dword_1002C8D4	dd 9, 2	dup(2),	7 dup(0) ; DATA	XREF: sub_100109BB+6o
		dd offset sub_10010AA4
dword_1002C900	dd 0Ah,	2 dup(2), 7 dup(0) ; DATA XREF:	sub_100109BB+2Ao
		dd offset sub_10010AD2
a_targetntcre_3	db '_TargetNtCreateKey@32',0 ; DATA XREF: sub_10011CBA+1Bo
		align 4
a_targetntope_6	db '_TargetNtOpenKey@16',0 ; DATA XREF: sub_10011CBA+51o
; CHAR aNtcreatekey[]
aNtcreatekey	db 'NtCreateKey',0      ; DATA XREF: sub_10011CBA+22o
					; TargetNtCreateKey(x,x,x,x,x,x,x,x)+49o ...
a_targetntope_7	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: sub_10011CBA+96o
		align 4
; CHAR aNtopenkey[]
aNtopenkey	db 'NtOpenKey',0        ; DATA XREF: sub_10011CBA+58o
					; TargetNtOpenKey(x,x,x,x)+23o	...
		align 4
aNtopenkeyex	db 'NtOpenKeyEx',0      ; DATA XREF: sub_10011CBA+9Do
					; TargetNtOpenKeyEx(x,x,x,x,x)+2Co
dword_1002C994	dd 10h,	1, 2, 4, 3 dup(2), 3 dup(0) ; DATA XREF: sub_10014386+1C7o
		dd offset sub_10011D74
dword_1002C9C0	dd 11h,	1, 2, 4, 2, 5 dup(0) ; DATA XREF: sub_10014386+1DAo
		dd offset sub_10011EDC
off_1002C9EC	dd offset sub_100099E1	; DATA XREF: sub_10011C42+3o
					; sub_10014386+1CCo
		dd offset sub_10011CBA
		dd offset sub_10011C42
aNtopenkeyEx	db 'NtOpenKey[Ex]',0    ; DATA XREF: sub_100121C6+DDo
		align 4
aSechangenotify:			; DATA XREF: sub_10013578+1AFo
					; sub_10013578+257o ...
		unicode	0, <SeChangeNotifyPrivilege>,0
aMl:					; DATA XREF: sub_10013A85+29o
		unicode	0, <ML>,0
		align 10h
aS:					; DATA XREF: sub_10013A85+1Fo
		unicode	0, <S:(>,0
asc_1002CA48:				; DATA XREF: sub_10013A85+6Bo
		unicode	0, <;;;>,0
asc_1002CA50:				; DATA XREF: sub_10013A85+3Fo
		unicode	0, <;;>,0
		align 4
aS11616384:				; DATA XREF: sub_10013BBE:loc_10013BCFo
		unicode	0, <S-1-16-16384>,0
		align 4
asc_1002CA74:				; DATA XREF: sub_10013A85+92o
		unicode	0, <)>,0
aS1168192:				; DATA XREF: sub_10013BBE:loc_10013BDDo
		unicode	0, <S-1-16-8192>,0
aS11612288:				; DATA XREF: sub_10013BBE:loc_10013BD6o
		unicode	0, <S-1-16-12288>,0
		align 4
aS1164096:				; DATA XREF: sub_10013BBE:loc_10013BEBo
		unicode	0, <S-1-16-4096>,0
aS1166144:				; DATA XREF: sub_10013BBE:loc_10013BE4o
		unicode	0, <S-1-16-6144>,0
aS1160:					; DATA XREF: sub_10013BBE:loc_10013BF9o
		unicode	0, <S-1-16-0>,0
		align 10h
aS1162048:				; DATA XREF: sub_10013BBE:loc_10013BF2o
		unicode	0, <S-1-16-2048>,0
aCBuildsMoz2__2	db 'c:/builds/moz2_slave/rel-m-rel-w32_bld-000000000000/build/securit'
					; DATA XREF: sub_10014BCE+43o
		db 'y/sandbox/chromium/sandbox/win/src/sandbox_policy_base.cc',0
		align 4
aPattern	db ', pattern = ',27h,0 ; DATA XREF: sub_10014BCE+A2o
		align 4
asc_1002CB94	db 27h,0		; DATA XREF: sub_10014BCE+B8o
		align 4
aSubsystem	db ', subsystem = ',0   ; DATA XREF: sub_10014BCE+7Ao
		align 4
aSemantics	db ', semantics = ',0   ; DATA XREF: sub_10014BCE+8Eo
		align 4
aFailedToAddSan	db 'Failed to add sandbox rule.',0 ; DATA XREF: sub_10014BCE+55o
aError		db ' error = ',0        ; DATA XREF: sub_10014BCE+66o
		align 10h
; CHAR aG_shared_del_2[]
aG_shared_del_2	db 'g_shared_delayed_mitigations',0 ; DATA XREF: sub_10014EC9+EBo
		align 10h
; CHAR aG_shared_del_1[]
aG_shared_del_1	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: sub_10014EC9+75o
		align 4
dword_1002CC24	dd 1, 2, 8 dup(0)	; DATA XREF: sub_10014D02+Co
dword_1002CC4C	dd 2, 6, 8 dup(0)	; DATA XREF: sub_10014D02:loc_10014D2Eo
off_1002CC74	dd offset _purecall	; DATA XREF: sub_10014386+12o
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
		dd offset _purecall
off_1002CCDC	dd offset sub_1001477E	; DATA XREF: sub_10014386+1Fo
					; sub_10014606+16o
		dd offset sub_10014789
		dd offset sub_100147A2
		dd offset sub_100147BE
		dd offset sub_100147C2
		dd offset sub_100147C6
		dd offset sub_100147E9
		dd offset sub_10014804
		dd offset sub_10014818
		dd offset sub_1001486D
		dd offset sub_100149B4
		dd offset sub_100149E3
		dd offset sub_100149EF
		dd offset sub_100149F3
		dd offset sub_100149FF
		dd offset sub_10014AD2
		dd offset sub_10014B1F
		dd offset sub_10014B4C
		dd offset sub_10014B53
		dd offset sub_10014B7E
		dd offset sub_10014B85
		dd offset sub_10014B8A
		dd offset sub_10014BAC
		dd offset sub_10014BCE
		dd offset sub_10014CAA
		dd offset sub_10014CF7
off_1002CD44	dd offset sub_10014D02	; DATA XREF: sub_10014386+19o
					; sub_10014606+10o
		dd offset sub_10014D77
		dd offset sub_100145E9
; CHAR aRtlinitunicode[]
aRtlinitunicode	db 'RtlInitUnicodeString',0 ; DATA XREF: sub_10015438+22o
		align 4
aAdd		db 'add',0              ; DATA XREF: .rdata:1001B8D4o
					; .rdata:1001B938o ...
aPop		db 'pop',0              ; DATA XREF: .rdata:1001BB90o
					; .rdata:1001C1D0o ...
aPush		db 'push',0             ; DATA XREF: .rdata:1001BB2Co
					; .rdata:1001BE4Co ...
		align 4
aAdc		db 'adc',0              ; DATA XREF: .rdata:1001BF14o
					; .rdata:1001BF78o ...
aOr		db 'or',0               ; DATA XREF: .rdata:1001BBF4o
					; .rdata:1001BC58o ...
		align 10h
aAnd		db 'and',0              ; DATA XREF: .rdata:1001C554o
					; .rdata:1001C5B8o ...
aSbb		db 'sbb',0              ; DATA XREF: .rdata:1001C234o
					; .rdata:1001C298o ...
aSub		db 'sub',0              ; DATA XREF: .rdata:1001C874o
					; .rdata:1001C8D8o ...
aDaa		db 'daa',0              ; DATA XREF: .rdata:1001C810o
aXor		db 'xor',0              ; DATA XREF: .rdata:1001CB94o
					; .rdata:1001CBF8o ...
aDas		db 'das',0              ; DATA XREF: .rdata:1001CB30o
aCmp		db 'cmp',0              ; DATA XREF: .rdata:1001CEB4o
					; .rdata:1001CF18o ...
aAaa		db 'aaa',0              ; DATA XREF: .rdata:1001CE50o
aInc		db 'inc',0              ; DATA XREF: .rdata:1001D1D4o
					; .rdata:1001D238o ...
aAas		db 'aas',0              ; DATA XREF: .rdata:1001D170o
aPushad		db 'pushad',0           ; DATA XREF: .rdata:1001DE54o
		align 10h
aDec		db 'dec',0              ; DATA XREF: .rdata:1001D4F4o
					; .rdata:1001D558o ...
aBound		db 'bound',0            ; DATA XREF: .rdata:1001DF1Co
		align 4
aPopad		db 'popad',0            ; DATA XREF: .rdata:1001DEB8o
		align 4
aImul		db 'imul',0             ; DATA XREF: .rdata:1001E1D8o
					; .rdata:1001E2A0o ...
		align 4
aArpl		db 'arpl',0             ; DATA XREF: .rdata:1001DF80o
		align 4
aInsd		db 'insd',0             ; DATA XREF: .rdata:1001E368o
		align 4
aInsb		db 'insb',0             ; DATA XREF: .rdata:1001E304o
		align 4
aJo		db 'jo',0               ; DATA XREF: .rdata:1001E494o
					; .rdata:10027B5Co
		align 4
aOutsb		db 'outsb',0            ; DATA XREF: .rdata:1001E3CCo
					; .rdata:1001E430o
		align 10h
aJc		db 'jc',0               ; DATA XREF: .rdata:1001E55Co
					; .rdata:10027C24o
		align 4
aJno		db 'jno',0              ; DATA XREF: .rdata:1001E4F8o
					; .rdata:10027BC0o
aJz		db 'jz',0               ; DATA XREF: .rdata:1001E624o
					; .rdata:10027CECo
		align 4
aJnc		db 'jnc',0              ; DATA XREF: .rdata:1001E5C0o
					; .rdata:10027C88o
aJbe		db 'jbe',0              ; DATA XREF: .rdata:1001E6ECo
					; .rdata:10027DB4o
aJnz		db 'jnz',0              ; DATA XREF: .rdata:1001E688o
					; .rdata:10027D50o
aJs		db 'js',0               ; DATA XREF: .rdata:1001E7B4o
					; .rdata:10027E7Co
		align 4
aJa		db 'ja',0               ; DATA XREF: .rdata:1001E750o
					; .rdata:10027E18o
		align 10h
aJpe		db 'jpe',0              ; DATA XREF: .rdata:1001E87Co
					; .rdata:10027F44o
aJns		db 'jns',0              ; DATA XREF: .rdata:1001E818o
					; .rdata:10027EE0o
aJl		db 'jl',0               ; DATA XREF: .rdata:1001E944o
					; .rdata:1002800Co
		align 4
aJpo		db 'jpo',0              ; DATA XREF: .rdata:1001E8E0o
					; .rdata:10027FA8o
aJle		db 'jle',0              ; DATA XREF: .rdata:1001EA0Co
					; .rdata:100280D4o
aJge		db 'jge',0              ; DATA XREF: .rdata:1001E9A8o
					; .rdata:10028070o
aTest		db 'test',0             ; DATA XREF: .rdata:1001EC64o
					; .rdata:1001ECC8o ...
		align 10h
aJg		db 'jg',0               ; DATA XREF: .rdata:1001EA70o
					; .rdata:10028138o
		align 4
aMov		db 'mov',0              ; DATA XREF: .rdata:1001EDF4o
					; .rdata:1001EE58o ...
aXchg		db 'xchg',0             ; DATA XREF: .rdata:1001ED2Co
					; .rdata:1001ED90o ...
		align 10h
aNop		db 'nop',0              ; DATA XREF: .rdata:1001F114o
aLea		db 'lea',0              ; DATA XREF: .rdata:1001EFE8o
aCdq		db 'cdq',0              ; DATA XREF: .rdata:1001F498o
aCwde		db 'cwde',0             ; DATA XREF: .rdata:1001F434o
		align 4
aWait		db 'wait',0             ; DATA XREF: .rdata:1001F560o
		align 4
aCallf		db 'callf',0            ; DATA XREF: .rdata:1001F4FCo
		align 4
aPopfd		db 'popfd',0            ; DATA XREF: .rdata:1001F628o
		align 4
aPushfd		db 'pushfd',0           ; DATA XREF: .rdata:1001F5C4o
		align 4
aLahf		db 'lahf',0             ; DATA XREF: .rdata:1001F6F0o
		align 4
aSahf		db 'sahf',0             ; DATA XREF: .rdata:1001F68Co
		align 4
aMovsd		db 'movsd',0            ; DATA XREF: .rdata:1001F948o
					; .rdata:10024FB8o ...
		align 4
aMovsb		db 'movsb',0            ; DATA XREF: .rdata:1001F8E4o
		align 4
aCmpsd		db 'cmpsd',0            ; DATA XREF: .rdata:1001FA10o
					; .rdata:10029540o
		align 4
aCmpsb		db 'cmpsb',0            ; DATA XREF: .rdata:1001F9ACo
		align 4
aStosd		db 'stosd',0            ; DATA XREF: .rdata:1001FBA0o
		align 4
aStosb		db 'stosb',0            ; DATA XREF: .rdata:1001FB3Co
		align 4
aLodsd		db 'lodsd',0            ; DATA XREF: .rdata:1001FC68o
		align 4
aLodsb		db 'lodsb',0            ; DATA XREF: .rdata:1001FC04o
		align 4
aScasd		db 'scasd',0            ; DATA XREF: .rdata:1001FD30o
		align 4
aScasb		db 'scasb',0            ; DATA XREF: .rdata:1001FCCCo
		align 4
aLes		db 'les',0              ; DATA XREF: .rdata:10020564o
aRet		db 'ret',0              ; DATA XREF: .rdata:1002049Co
					; .rdata:10020500o
aEnter		db 'enter',0            ; DATA XREF: .rdata:100206F4o
		align 4
aLds		db 'lds',0              ; DATA XREF: .rdata:100205C8o
aRetf		db 'retf',0             ; DATA XREF: .rdata:100207BCo
					; .rdata:10020820o
		align 10h
aLeave		db 'leave',0            ; DATA XREF: .rdata:10020758o
		align 4
aInt		db 'int',0              ; DATA XREF: .rdata:100208E8o
aInt3		db 'int3',0             ; DATA XREF: .rdata:10020884o
		align 4
aIret		db 'iret',0             ; DATA XREF: .rdata:100209B0o
		align 4
aInto		db 'into',0             ; DATA XREF: .rdata:1002094Co
		align 4
aAad		db 'aad',0              ; DATA XREF: .rdata:10020C08o
aAam		db 'aam',0              ; DATA XREF: .rdata:10020BA4o
aLoopnz		db 'loopnz',0           ; DATA XREF: .rdata:10021054o
		align 4
aXlat		db 'xlat',0             ; DATA XREF: .rdata:10020CD0o
		align 4
aLoop		db 'loop',0             ; DATA XREF: .rdata:1002111Co
		align 4
aLoopz		db 'loopz',0            ; DATA XREF: .rdata:100210B8o
		align 4
aIn		db 'in',0               ; DATA XREF: .rdata:100211E4o
					; .rdata:10021248o ...
		align 10h
aJcxz		db 'jcxz',0             ; DATA XREF: .rdata:10021180o
		align 4
aCall		db 'call',0             ; DATA XREF: .rdata:10021374o
					; .rdata:10021D9Co ...
		align 10h
aOut		db 'out',0              ; DATA XREF: .rdata:100212ACo
					; .rdata:10021310o ...
aLock		db 'lock:',0            ; DATA XREF: .rdata:10021694o
		align 4
aJmp		db 'jmp',0              ; DATA XREF: .rdata:100213D8o
					; .rdata:1002143Co ...
aRep		db 'rep:',0             ; DATA XREF: .rdata:100217C0o
		align 4
aRepne		db 'repne:',0           ; DATA XREF: .rdata:1002175Co
		align 10h
aCmc		db 'cmc',0              ; DATA XREF: .rdata:10021888o
aHlt		db 'hlt',0              ; DATA XREF: .rdata:10021824o
aStc		db 'stc',0              ; DATA XREF: .rdata:10021A18o
aClc		db 'clc',0              ; DATA XREF: .rdata:100219B4o
aSti		db 'sti',0              ; DATA XREF: .rdata:10021AE0o
aCli		db 'cli',0              ; DATA XREF: .rdata:10021A7Co
aStd		db 'std',0              ; DATA XREF: .rdata:10021BA8o
aCld		db 'cld',0              ; DATA XREF: .rdata:10021B44o
aLsl		db 'lsl',0              ; DATA XREF: .rdata:10024A88o
aLar		db 'lar',0              ; DATA XREF: .rdata:10024A24o
aInvd		db 'invd',0             ; DATA XREF: .rdata:10024C7Co
		align 10h
aClts		db 'clts',0             ; DATA XREF: .rdata:10024BB4o
		align 4
aUd2		db 'ud2',0              ; DATA XREF: .rdata:10024DA8o
aWbinvd		db 'wbinvd',0           ; DATA XREF: .rdata:10024CE0o
		align 4
aMovss		db 'movss',0            ; DATA XREF: .rdata:10024FD0o
					; .rdata:10025034o
		align 4
aMovups		db 'movups',0           ; DATA XREF: .rdata:10024F9Co
					; .rdata:10025000o
		align 4
aMovlps		db 'movlps',0           ; DATA XREF: .rdata:10025064o
					; .rdata:100250C8o
		align 4
aMovupd		db 'movupd',0           ; DATA XREF: .rdata:10024FE8o
					; .rdata:1002504Co
		align 4
aMovlpd		db 'movlpd',0           ; DATA XREF: .rdata:100250B0o
					; .rdata:10025114o
		align 4
aMovhlps	db 'movhlps',0          ; DATA XREF: .rdata:10025080o
					; .rdata:10025098o
aUnpcklpd	db 'unpcklpd',0         ; DATA XREF: .rdata:10025178o
		align 10h
aUnpcklps	db 'unpcklps',0         ; DATA XREF: .rdata:1002512Co
		align 4
aUnpckhpd	db 'unpckhpd',0         ; DATA XREF: .rdata:100251DCo
		align 4
aUnpckhps	db 'unpckhps',0         ; DATA XREF: .rdata:10025190o
		align 4
aMovlhps	db 'movlhps',0          ; DATA XREF: .rdata:10025210o
					; .rdata:10025228o
aMovhps		db 'movhps',0           ; DATA XREF: .rdata:100251F4o
					; .rdata:10025258o
		align 4
aMovaps		db 'movaps',0           ; DATA XREF: .rdata:100258FCo
					; .rdata:10025960o
		align 4
aMovhpd		db 'movhpd',0           ; DATA XREF: .rdata:10025240o
					; .rdata:100252A4o
		align 4
aCvtpi2ps	db 'cvtpi2ps',0         ; DATA XREF: .rdata:100259C4o
		align 10h
aMovapd		db 'movapd',0           ; DATA XREF: .rdata:10025948o
					; .rdata:100259ACo
		align 4
aCvtsi2ss	db 'cvtsi2ss',0         ; DATA XREF: .rdata:100259F8o
		align 4
aCvtsi2sd	db 'cvtsi2sd',0         ; DATA XREF: .rdata:100259E0o
		align 10h
aMovntps	db 'movntps',0          ; DATA XREF: .rdata:10025A28o
aCvtpi2pd	db 'cvtpi2pd',0         ; DATA XREF: .rdata:10025A10o
		align 4
aCvttps2pi	db 'cvttps2pi',0        ; DATA XREF: .rdata:10025A8Co
		align 10h
aMovntpd	db 'movntpd',0          ; DATA XREF: .rdata:10025A74o
aCvttss2si	db 'cvttss2si',0        ; DATA XREF: .rdata:10025AC0o
		align 4
aCvttsd2si	db 'cvttsd2si',0        ; DATA XREF: .rdata:10025AA8o
		align 10h
aCvtps2pi	db 'cvtps2pi',0         ; DATA XREF: .rdata:10025AF0o
		align 4
aCvttpd2pi	db 'cvttpd2pi',0        ; DATA XREF: .rdata:10025AD8o
		align 4
aCvtss2si	db 'cvtss2si',0         ; DATA XREF: .rdata:10025B24o
		align 4
aCvtsd2si	db 'cvtsd2si',0         ; DATA XREF: .rdata:10025B0Co
		align 10h
aUcomiss	db 'ucomiss',0          ; DATA XREF: .rdata:10025B54o
aCvtpd2pi	db 'cvtpd2pi',0         ; DATA XREF: .rdata:10025B3Co
		align 4
aComiss		db 'comiss',0           ; DATA XREF: .rdata:10025BB8o
		align 4
aUcomisd	db 'ucomisd',0          ; DATA XREF: .rdata:10025BA0o
aWrmsr		db 'wrmsr',0            ; DATA XREF: .rdata:10025C1Co
		align 4
aComisd		db 'comisd',0           ; DATA XREF: .rdata:10025C04o
		align 4
aRdmsr		db 'rdmsr',0            ; DATA XREF: .rdata:10025CE4o
		align 4
aRdtsc		db 'rdtsc',0            ; DATA XREF: .rdata:10025C80o
		align 4
aSysenter	db 'sysenter',0         ; DATA XREF: .rdata:10025DACo
		align 10h
aRdpmc		db 'rdpmc',0            ; DATA XREF: .rdata:10025D48o
		align 4
aMovnti		db 'movnti',0           ; DATA XREF: .rdata:100260CCo
					; .rdata:10029588o
		align 10h
aSysexit	db 'sysexit',0          ; DATA XREF: .rdata:10025E10o
aCmovno		db 'cmovno',0           ; DATA XREF: .rdata:100262C0o
		align 10h
aCmovo		db 'cmovo',0            ; DATA XREF: .rdata:1002625Co
		align 4
aCmovnc		db 'cmovnc',0           ; DATA XREF: .rdata:10026388o
		align 10h
aCmovc		db 'cmovc',0            ; DATA XREF: .rdata:10026324o
		align 4
aCmovnz		db 'cmovnz',0           ; DATA XREF: .rdata:10026450o
		align 10h
aCmovz		db 'cmovz',0            ; DATA XREF: .rdata:100263ECo
		align 4
aCmova		db 'cmova',0            ; DATA XREF: .rdata:10026518o
		align 10h
aCmovbe		db 'cmovbe',0           ; DATA XREF: .rdata:100264B4o
		align 4
aCmovns		db 'cmovns',0           ; DATA XREF: .rdata:100265E0o
		align 10h
aCmovs		db 'cmovs',0            ; DATA XREF: .rdata:1002657Co
		align 4
aCmovpo		db 'cmovpo',0           ; DATA XREF: .rdata:100266A8o
		align 10h
aCmovpe		db 'cmovpe',0           ; DATA XREF: .rdata:10026644o
		align 4
aCmovge		db 'cmovge',0           ; DATA XREF: .rdata:10026770o
		align 10h
aCmovl		db 'cmovl',0            ; DATA XREF: .rdata:1002670Co
		align 4
aCmovg		db 'cmovg',0            ; DATA XREF: .rdata:10026838o
		align 10h
aCmovle		db 'cmovle',0           ; DATA XREF: .rdata:100267D4o
		align 4
aMovmskpd	db 'movmskpd',0         ; DATA XREF: .rdata:100268E8o
		align 4
aMovmskps	db 'movmskps',0         ; DATA XREF: .rdata:1002689Co
		align 10h
aSqrtsd		db 'sqrtsd',0           ; DATA XREF: .rdata:1002691Co
		align 4
aSqrtps		db 'sqrtps',0           ; DATA XREF: .rdata:10026900o
		align 10h
aSqrtpd		db 'sqrtpd',0           ; DATA XREF: .rdata:1002694Co
		align 4
aSqrtss		db 'sqrtss',0           ; DATA XREF: .rdata:10026934o
		align 10h
aRsqrtss	db 'rsqrtss',0          ; DATA XREF: .rdata:10026998o
aRsqrtps	db 'rsqrtps',0          ; DATA XREF: .rdata:10026964o
aRcpss		db 'rcpss',0            ; DATA XREF: .rdata:100269FCo
		align 4
aRcpps		db 'rcpps',0            ; DATA XREF: .rdata:100269C8o
		align 10h
aAndpd		db 'andpd',0            ; DATA XREF: .rdata:10026A78o
		align 4
aAndps		db 'andps',0            ; DATA XREF: .rdata:10026A2Co
		align 10h
aAndnpd		db 'andnpd',0           ; DATA XREF: .rdata:10026ADCo
		align 4
aAndnps		db 'andnps',0           ; DATA XREF: .rdata:10026A90o
		align 10h
aOrpd		db 'orpd',0             ; DATA XREF: .rdata:10026B40o
		align 4
aOrps		db 'orps',0             ; DATA XREF: .rdata:10026AF4o
		align 10h
aXorpd		db 'xorpd',0            ; DATA XREF: .rdata:10026BA4o
		align 4
aXorps		db 'xorps',0            ; DATA XREF: .rdata:10026B58o
		align 10h
aAddsd		db 'addsd',0            ; DATA XREF: .rdata:10026BD8o
		align 4
aAddps		db 'addps',0            ; DATA XREF: .rdata:10026BBCo
		align 10h
aAddpd		db 'addpd',0            ; DATA XREF: .rdata:10026C08o
		align 4
aAddss		db 'addss',0            ; DATA XREF: .rdata:10026BF0o
		align 10h
aMulsd		db 'mulsd',0            ; DATA XREF: .rdata:10026C3Co
		align 4
aMulps		db 'mulps',0            ; DATA XREF: .rdata:10026C20o
		align 10h
aMulpd		db 'mulpd',0            ; DATA XREF: .rdata:10026C6Co
		align 4
aMulss		db 'mulss',0            ; DATA XREF: .rdata:10026C54o
		align 10h
aCvtsd2ss	db 'cvtsd2ss',0         ; DATA XREF: .rdata:10026CA0o
		align 4
aCvtps2pd	db 'cvtps2pd',0         ; DATA XREF: .rdata:10026C84o
		align 4
aCvtpd2ps	db 'cvtpd2ps',0         ; DATA XREF: .rdata:10026CD0o
		align 4
aCvtss2sd	db 'cvtss2sd',0         ; DATA XREF: .rdata:10026CB8o
		align 10h
aCvttps2dq	db 'cvttps2dq',0        ; DATA XREF: .rdata:10026D1Co
		align 4
aCvtdq2ps	db 'cvtdq2ps',0         ; DATA XREF: .rdata:10026CE8o
		align 4
aSubps		db 'subps',0            ; DATA XREF: .rdata:10026D4Co
		align 10h
aCvtps2dq	db 'cvtps2dq',0         ; DATA XREF: .rdata:10026D34o
		align 4
aSubss		db 'subss',0            ; DATA XREF: .rdata:10026D80o
		align 4
aSubsd		db 'subsd',0            ; DATA XREF: .rdata:10026D68o
		align 4
aMinps		db 'minps',0            ; DATA XREF: .rdata:10026DB0o
		align 4
aSubpd		db 'subpd',0            ; DATA XREF: .rdata:10026D98o
		align 4
aMinss		db 'minss',0            ; DATA XREF: .rdata:10026DE4o
		align 4
aMinsd		db 'minsd',0            ; DATA XREF: .rdata:10026DCCo
		align 4
aDivps		db 'divps',0            ; DATA XREF: .rdata:10026E14o
		align 4
aMinpd		db 'minpd',0            ; DATA XREF: .rdata:10026DFCo
		align 4
aDivss		db 'divss',0            ; DATA XREF: .rdata:10026E48o
		align 4
aDivsd		db 'divsd',0            ; DATA XREF: .rdata:10026E30o
		align 4
aMaxps		db 'maxps',0            ; DATA XREF: .rdata:10026E78o
		align 4
aDivpd		db 'divpd',0            ; DATA XREF: .rdata:10026E60o
		align 4
aMaxss		db 'maxss',0            ; DATA XREF: .rdata:10026EACo
		align 4
aMaxsd		db 'maxsd',0            ; DATA XREF: .rdata:10026E94o
		align 4
aPunpcklbw	db 'punpcklbw',0        ; DATA XREF: .rdata:10026EDCo
					; .rdata:10026F28o
		align 4
aMaxpd		db 'maxpd',0            ; DATA XREF: .rdata:10026EC4o
		align 10h
aPunpckldq	db 'punpckldq',0        ; DATA XREF: .rdata:10026FA4o
					; .rdata:10026FF0o
		align 4
aPunpcklwd	db 'punpcklwd',0        ; DATA XREF: .rdata:10026F40o
					; .rdata:10026F8Co
		align 4
aPcmpgtb	db 'pcmpgtb',0          ; DATA XREF: .rdata:1002706Co
					; .rdata:100270B8o
aPacksswb	db 'packsswb',0         ; DATA XREF: .rdata:10027008o
					; .rdata:10027054o
		align 4
aPcmpgtd	db 'pcmpgtd',0          ; DATA XREF: .rdata:10027134o
					; .rdata:10027180o
aPcmpgtw	db 'pcmpgtw',0          ; DATA XREF: .rdata:100270D0o
					; .rdata:1002711Co
aPunpckhbw	db 'punpckhbw',0        ; DATA XREF: .rdata:100271FCo
					; .rdata:10027248o
		align 4
aPackuswb	db 'packuswb',0         ; DATA XREF: .rdata:10027198o
					; .rdata:100271E4o
		align 4
aPunpckhdq	db 'punpckhdq',0        ; DATA XREF: .rdata:100272C4o
					; .rdata:10027310o
		align 10h
aPunpckhwd	db 'punpckhwd',0        ; DATA XREF: .rdata:10027260o
					; .rdata:100272ACo
		align 4
aNotUsedWithout	db 'not used without prefix',0 ; DATA XREF: .rdata:1002738Co
					; .rdata:100273F0o ...
aPackssdw	db 'packssdw',0         ; DATA XREF: .rdata:10027328o
					; .rdata:10027374o
		align 10h
aMovd		db 'movd',0             ; DATA XREF: .rdata:10027454o
					; .rdata:100274A0o ...
		align 4
aPunpcklqdq	db 'punpcklqdq',0       ; DATA XREF: .rdata:100273D8o
					; .rdata:1002743Co
		align 4
aMovdqu		db 'movdqu',0           ; DATA XREF: .rdata:100274ECo
					; .rdata:10027B2Co
		align 4
aMovq		db 'movq',0             ; DATA XREF: .rdata:100274B8o
					; .rdata:10027AC8o ...
		align 4
aPshuf		db 'pshuf',0            ; DATA XREF: .rdata:1002751Co
		align 4
aMovdqa		db 'movdqa',0           ; DATA XREF: .rdata:10027504o
					; .rdata:10027B44o
		align 4
aPshufhw	db 'pshufhw',0          ; DATA XREF: .rdata:10027550o
aPshuflw	db 'pshuflw',0          ; DATA XREF: .rdata:10027538o
aPcmpeqb	db 'pcmpeqb',0          ; DATA XREF: .rdata:100276ACo
					; .rdata:100276F8o
aPshufd		db 'pshufd',0           ; DATA XREF: .rdata:10027568o
		align 4
aPcmpeqd	db 'pcmpeqd',0          ; DATA XREF: .rdata:10027774o
					; .rdata:100277C0o
aPcmpeqw	db 'pcmpeqw',0          ; DATA XREF: .rdata:10027710o
					; .rdata:1002775Co
aSeto		db 'seto',0             ; DATA XREF: .rdata:1002819Co
		align 4
aEmms		db 'emms',0             ; DATA XREF: .rdata:100277D8o
		align 4
aSetc		db 'setc',0             ; DATA XREF: .rdata:10028264o
		align 4
aSetno		db 'setno',0            ; DATA XREF: .rdata:10028200o
		align 4
aSetz		db 'setz',0             ; DATA XREF: .rdata:1002832Co
		align 4
aSetnc		db 'setnc',0            ; DATA XREF: .rdata:100282C8o
		align 4
aSetbe		db 'setbe',0            ; DATA XREF: .rdata:100283F4o
		align 4
aSetnz		db 'setnz',0            ; DATA XREF: .rdata:10028390o
		align 4
aSets		db 'sets',0             ; DATA XREF: .rdata:100284BCo
		align 4
aSeta		db 'seta',0             ; DATA XREF: .rdata:10028458o
		align 4
aSetpe		db 'setpe',0            ; DATA XREF: .rdata:10028584o
		align 4
aSetns		db 'setns',0            ; DATA XREF: .rdata:10028520o
		align 4
aSetl		db 'setl',0             ; DATA XREF: .rdata:1002864Co
		align 4
aSetpo		db 'setpo',0            ; DATA XREF: .rdata:100285E8o
		align 4
aSetle		db 'setle',0            ; DATA XREF: .rdata:10028714o
		align 4
aSetge		db 'setge',0            ; DATA XREF: .rdata:100286B0o
		align 4
aCpuid		db 'cpuid',0            ; DATA XREF: .rdata:100288A4o
		align 4
aSetg		db 'setg',0             ; DATA XREF: .rdata:10028778o
		align 4
aShld		db 'shld',0             ; DATA XREF: .rdata:1002896Co
					; .rdata:100289D0o
		align 4
aBt		db 'bt',0               ; DATA XREF: .rdata:1002418Co
					; .rdata:10028908o
		align 10h
aBts		db 'bts',0              ; DATA XREF: .rdata:100241F0o
					; .rdata:10028C28o
aRsm		db 'rsm',0              ; DATA XREF: .rdata:10028BC4o
aCmpxchg	db 'cmpxchg',0          ; DATA XREF: .rdata:10028E1Co
					; .rdata:10028E80o
aShrd		db 'shrd',0             ; DATA XREF: .rdata:10028C8Co
					; .rdata:10028CF0o
		align 4
aBtr		db 'btr',0              ; DATA XREF: .rdata:10024254o
					; .rdata:10028F48o
aLss		db 'lss',0              ; DATA XREF: .rdata:10028EE4o
aLgs		db 'lgs',0              ; DATA XREF: .rdata:10029010o
aLfs		db 'lfs',0              ; DATA XREF: .rdata:10028FACo
aUd1		db 'ud1',0              ; DATA XREF: .rdata:100291A0o
aMovzx		db 'movzx',0            ; DATA XREF: .rdata:10029074o
					; .rdata:100290D8o
		align 4
aBsf		db 'bsf',0              ; DATA XREF: .rdata:100292CCo
aBtc		db 'btc',0              ; DATA XREF: .rdata:100242B8o
					; .rdata:10029268o
aMovsx		db 'movsx',0            ; DATA XREF: .rdata:10029394o
					; .rdata:100293F8o
		align 4
aBsr		db 'bsr',0              ; DATA XREF: .rdata:10029330o
aCmpps		db 'cmpps',0            ; DATA XREF: .rdata:10029524o
		align 10h
aXadd		db 'xadd',0             ; DATA XREF: .rdata:1002945Co
					; .rdata:100294C0o
		align 4
aCmppd		db 'cmppd',0            ; DATA XREF: .rdata:10029570o
		align 10h
aCmpss		db 'cmpss',0            ; DATA XREF: .rdata:10029558o
		align 4
aPextrw		db 'pextrw',0           ; DATA XREF: .rdata:10029650o
					; .rdata:1002969Co
		align 10h
aPinsrw		db 'pinsrw',0           ; DATA XREF: .rdata:100295ECo
					; .rdata:10029638o
		align 4
aShufpd		db 'shufpd',0           ; DATA XREF: .rdata:10029700o
		align 10h
aShufps		db 'shufps',0           ; DATA XREF: .rdata:100296B4o
		align 4
aPsrlw		db 'psrlw',0            ; DATA XREF: .rdata:100223DCo
					; .rdata:10022428o ...
		align 10h
aBswap		db 'bswap',0            ; DATA XREF: .rdata:1002977Co
					; .rdata:100297E0o ...
		align 4
aPsrlq		db 'psrlq',0            ; DATA XREF: .rdata:10023764o
					; .rdata:100237B0o ...
		align 10h
aPsrld		db 'psrld',0            ; DATA XREF: .rdata:10029B64o
					; .rdata:10029BB0o ...
		align 4
aPmullw		db 'pmullw',0           ; DATA XREF: .rdata:10029C90o
					; .rdata:10029CDCo
		align 10h
aPaddq		db 'paddq',0            ; DATA XREF: .rdata:10029C2Co
					; .rdata:10029C78o
		align 4
aMovdq2q	db 'movdq2q',0          ; DATA XREF: .rdata:10029D10o
aUnusedWithoutP	db 'unused without prefix',0 ; DATA XREF: .rdata:10029CF4o
		align 4
aPmovmskb	db 'pmovmskb',0         ; DATA XREF: .rdata:10029D58o
					; .rdata:10029DA4o
		align 4
aMovq2dq	db 'movq2dq',0          ; DATA XREF: .rdata:10029D28o
aPsubusw	db 'psubusw',0          ; DATA XREF: .rdata:10029E20o
					; .rdata:10029E6Co
aPsubusb	db 'psubusb',0          ; DATA XREF: .rdata:10029DBCo
					; .rdata:10029E08o
aPand		db 'pand',0             ; DATA XREF: .rdata:10029EE8o
					; .rdata:10029F34o
		align 4
aPminub		db 'pminub',0           ; DATA XREF: .rdata:10029E84o
					; .rdata:10029ED0o
		align 4
aPaddusw	db 'paddusw',0          ; DATA XREF: .rdata:10029FB0o
					; .rdata:10029FFCo
aPaddusb	db 'paddusb',0          ; DATA XREF: .rdata:10029F4Co
					; .rdata:10029F98o
aPandn		db 'pandn',0            ; DATA XREF: .rdata:1002A078o
					; .rdata:1002A0C4o
		align 4
aPmaxub		db 'pmaxub',0           ; DATA XREF: .rdata:1002A014o
					; .rdata:1002A060o
		align 4
aPsraw		db 'psraw',0            ; DATA XREF: .rdata:100224A4o
					; .rdata:100224F0o ...
		align 4
aPavgb		db 'pavgb',0            ; DATA XREF: .rdata:1002A0DCo
					; .rdata:1002A128o
		align 4
aPsrad		db 'psrad',0            ; DATA XREF: .rdata:1002A1A4o
					; .rdata:1002A1F0o ...
		align 4
aPsrqw		db 'psrqw',0            ; DATA XREF: .rdata:1002A18Co
		align 4
aPmulhuw	db 'pmulhuw',0          ; DATA XREF: .rdata:1002A26Co
					; .rdata:1002A2B8o ...
aPavgw		db 'pavgw',0            ; DATA XREF: .rdata:1002A208o
					; .rdata:1002A254o
		align 4
aCvtpd2dq	db 'cvtpd2dq',0         ; DATA XREF: .rdata:1002A350o
		align 4
aPmulhw		db 'pmulhw',0           ; DATA XREF: .rdata:1002A31Co
		align 10h
aCvttpd2dq	db 'cvttpd2dq',0        ; DATA XREF: .rdata:1002A380o
		align 4
aCvtdq2pd	db 'cvtdq2pd',0         ; DATA XREF: .rdata:1002A368o
		align 4
aMovntdq	db 'movntdq',0          ; DATA XREF: .rdata:1002A3E4o
aMovntq		db 'movntq',0           ; DATA XREF: .rdata:1002A398o
		align 4
aPsubsw		db 'psubsw',0           ; DATA XREF: .rdata:1002A460o
					; .rdata:1002A4ACo
		align 10h
aPsubsb		db 'psubsb',0           ; DATA XREF: .rdata:1002A3FCo
					; .rdata:1002A448o
		align 4
aPor		db 'por',0              ; DATA XREF: .rdata:1002A528o
					; .rdata:1002A574o
aPminsw		db 'pminsw',0           ; DATA XREF: .rdata:1002A4C4o
					; .rdata:1002A510o
		align 4
aPaddsw		db 'paddsw',0           ; DATA XREF: .rdata:1002A5F0o
					; .rdata:1002A63Co
		align 4
aPaddsb		db 'paddsb',0           ; DATA XREF: .rdata:1002A58Co
					; .rdata:1002A5D8o
		align 4
aPxor		db 'pxor',0             ; DATA XREF: .rdata:1002A6B8o
					; .rdata:1002A704o
		align 4
aPmaxsw		db 'pmaxsw',0           ; DATA XREF: .rdata:1002A654o
					; .rdata:1002A6A0o
		align 4
aPslld		db 'pslld',0            ; DATA XREF: .rdata:1002A7E4o
					; .rdata:1002A830o ...
		align 4
aPsllw		db 'psllw',0            ; DATA XREF: .rdata:1002256Co
					; .rdata:100225B8o ...
		align 4
aPmuludq	db 'pmuludq',0          ; DATA XREF: .rdata:1002A8ACo
					; .rdata:1002A8F8o
aPsllq		db 'psllq',0            ; DATA XREF: .rdata:100238F4o
					; .rdata:10023940o ...
		align 4
aPsadbw		db 'psadbw',0           ; DATA XREF: .rdata:1002A974o
					; .rdata:1002A9C0o
		align 4
aPmaddwd	db 'pmaddwd',0          ; DATA XREF: .rdata:1002A910o
					; .rdata:1002A95Co
aMaskmovdqu	db 'maskmovdqu',0       ; DATA XREF: .rdata:1002AA24o
		align 10h
aMaskmovq	db 'maskmovq',0         ; DATA XREF: .rdata:1002A9D8o
		align 4
aPsubw		db 'psubw',0            ; DATA XREF: .rdata:1002AAA0o
					; .rdata:1002AAECo
		align 4
aPsubb		db 'psubb',0            ; DATA XREF: .rdata:1002AA3Co
					; .rdata:1002AA88o
		align 4
aPsubq		db 'psubq',0            ; DATA XREF: .rdata:1002AB68o
					; .rdata:1002ABB4o
		align 4
aPsubd		db 'psubd',0            ; DATA XREF: .rdata:1002AB04o
					; .rdata:1002AB50o
		align 4
aPaddw		db 'paddw',0            ; DATA XREF: .rdata:1002AC30o
					; .rdata:1002AC7Co
		align 4
aPaddb		db 'paddb',0            ; DATA XREF: .rdata:1002ABCCo
					; .rdata:1002AC18o
		align 4
aSldt		db 'sldt',0             ; DATA XREF: .rdata:1001B5B4o
		align 4
aPaddd		db 'paddd',0            ; DATA XREF: .rdata:1002AC94o
					; .rdata:1002ACE0o
		align 4
aLldt		db 'lldt',0             ; DATA XREF: .rdata:1001B67Co
		align 4
aStr		db 'str',0              ; DATA XREF: .rdata:1001B618o
aVerr		db 'verr',0             ; DATA XREF: .rdata:1001B744o
		align 10h
aLtr		db 'ltr',0              ; DATA XREF: .rdata:1001B6E0o
aSgdt		db 'sgdt',0             ; DATA XREF: .rdata:1001ADE4o
		align 4
aVerw		db 'verw',0             ; DATA XREF: .rdata:1001B7A8o
		align 4
aLgdt		db 'lgdt',0             ; DATA XREF: .rdata:1001AEACo
		align 4
aSidt		db 'sidt',0             ; DATA XREF: .rdata:1001AE48o
		align 4
aSmsw		db 'smsw',0             ; DATA XREF: .rdata:1001AF74o
		align 4
aLidt		db 'lidt',0             ; DATA XREF: .rdata:1001AF10o
		align 4
aInvlpg		db 'invlpg',0           ; DATA XREF: .rdata:1001B0A0o
		align 4
aLmsw		db 'lmsw',0             ; DATA XREF: .rdata:1001B03Co
		align 4
aPslldq		db 'pslldq',0           ; DATA XREF: .rdata:10023958o
					; .rdata:100239A4o
		align 4
aPrefetch	db 'prefetch',0         ; DATA XREF: .rdata:1001B104o
					; .rdata:1001B168o ...
		align 4
aFxrstor	db 'fxrstor',0          ; DATA XREF: .rdata:100229B8o
aFxsave		db 'fxsave',0           ; DATA XREF: .rdata:10022954o
		align 4
aStmxcsr	db 'stmxcsr',0          ; DATA XREF: .rdata:10022A80o
aLdmxcsr	db 'ldmxcsr',0          ; DATA XREF: .rdata:10022A1Co
aMfence		db 'mfence',0           ; DATA XREF: .rdata:10022BACo
		align 10h
aLfence		db 'lfence',0           ; DATA XREF: .rdata:10022B48o
		align 4
aCmpxch8b	db 'cmpxch8b',0         ; DATA XREF: .rdata:1001B550o
		align 4
aClflushSfence	db 'clflush/sfence',0   ; DATA XREF: .rdata:10022C10o
		align 4
aRor		db 'ror',0              ; DATA XREF: .rdata:10022058o
					; .rdata:10022698o ...
aRol		db 'rol',0              ; DATA XREF: .rdata:10021FF4o
					; .rdata:10022634o ...
aRcr		db 'rcr',0              ; DATA XREF: .rdata:10022120o
					; .rdata:10022760o ...
aRcl		db 'rcl',0              ; DATA XREF: .rdata:100220BCo
					; .rdata:100226FCo ...
aShr		db 'shr',0              ; DATA XREF: .rdata:100221E8o
					; .rdata:10022828o ...
aShl		db 'shl',0              ; DATA XREF: .rdata:10022184o
					; .rdata:100227C4o ...
aSar		db 'sar',0              ; DATA XREF: .rdata:100222B0o
					; .rdata:100228F0o ...
aSal		db 'sal',0              ; DATA XREF: .rdata:1002224Co
					; .rdata:1002288Co ...
aNeg		db 'neg',0              ; DATA XREF: .rdata:10024448o
					; .rdata:1002AE88o
aNot		db 'not',0              ; DATA XREF: .rdata:100243E4o
					; .rdata:1002AE24o
aDiv		db 'div',0              ; DATA XREF: .rdata:10024574o
					; .rdata:1002AFB4o
aMul		db 'mul',0              ; DATA XREF: .rdata:100244ACo
					; .rdata:1002AEECo
aIdiv		db 'idiv',0             ; DATA XREF: .rdata:100245D8o
					; .rdata:1002B018o
		align 4
; CHAR aNtcreateevent[]
aNtcreateevent	db 'NtCreateEvent',0    ; DATA XREF: sub_10016952+1Do
					; TargetNtCreateEvent(x,x,x,x,x,x)+123o ...
		align 4
a_targetntcre_4	db '_TargetNtCreateEvent@24',0 ; DATA XREF: sub_10016952+16o
; CHAR aNtopenevent[]
aNtopenevent	db 'NtOpenEvent',0      ; DATA XREF: sub_10016952+52o
					; TargetNtOpenEvent(x,x,x,x)+3Do ...
a_targetntop_14	db '_TargetNtOpenEvent@16',0 ; DATA XREF: sub_10016952+4Co
		align 4
off_1002D898	dd offset sub_100099E1	; DATA XREF: sub_10014386+183o
					; sub_1001692F+3o
		dd offset sub_10016952
		dd offset sub_1001692F
dword_1002D8A4	dd 0Fh,	1, 2, 7	dup(0)	; DATA XREF: sub_10014386+191o
		dd offset sub_10016A50
dword_1002D8D0	dd 0Eh,	1, 2 dup(2), 6 dup(0) ;	DATA XREF: sub_10014386+17Eo
		dd offset sub_100169C3
aNtcreatevent	db 'NtCreatEvent',0     ; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+43o
		align 4
aD:					; DATA XREF: sub_100171B6+78o
		unicode	0, <%d>,0
		align 4
; CHAR aNtopendirector[]
aNtopendirector	db 'NtOpenDirectoryObject',0 ; DATA XREF: sub_10017019+19o
					; sub_100171B6+32o
		align 4
; CHAR aNtopensymbolic[]
aNtopensymbolic	db 'NtOpenSymbolicLinkObject',0 ; DATA XREF: sub_10017019+3Do
		align 4
; CHAR aNtquerysymboli[]
aNtquerysymboli	db 'NtQuerySymbolicLinkObject',0 ; DATA XREF: sub_10017019+2Bo
		align 4
aSessionsBnolin:			; DATA XREF: sub_100171B6+59o
		unicode	0, <\Sessions\BNOLINKS>,0
		align 4
; CHAR aG_shared_sec_0[]
aG_shared_sec_0	db 'g_shared_section',0 ; DATA XREF: sub_10017B53+A9o
		align 10h
; CHAR aG_shared_pol_0[]
aG_shared_pol_0	db 'g_shared_policy_size',0 ; DATA XREF: sub_10017B53+10Bo
		align 4
; CHAR aG_shared_ipc_0[]
aG_shared_ipc_0	db 'g_shared_IPC_size',0 ; DATA XREF: sub_10017B53+E2o
		align 4
off_1002D9CC	dd offset sub_10017D81	; DATA XREF: sub_10013CCD+1Fo
		dd offset sub_10017D8F
		dd offset sub_10017EED
		dd offset sub_10017EF1
aHkey_local_m_2:			; DATA XREF: .rdata:1002BA10o
		unicode	0, <HKEY_LOCAL_MACHINE>,0
		align 4
aHkey_classes_r:			; DATA XREF: .rdata:off_1002BA00o
		unicode	0, <HKEY_CLASSES_ROOT>,0
aHkey_performan:			; DATA XREF: .rdata:1002BA20o
		unicode	0, <HKEY_PERFORMANCE_DATA>,0
aHkey_users:				; DATA XREF: .rdata:1002BA18o
		unicode	0, <HKEY_USERS>,0
		align 4
aHkey_perform_1:			; DATA XREF: .rdata:1002BA30o
		unicode	0, <HKEY_PERFORMANCE_NLSTEXT>,0
		align 10h
aHkey_perform_0:			; DATA XREF: .rdata:1002BA28o
		unicode	0, <HKEY_PERFORMANCE_TEXT>,0
aHkey_dyn_data:				; DATA XREF: .rdata:1002BA40o
		unicode	0, <HKEY_DYN_DATA>,0
aHkey_current_c:			; DATA XREF: .rdata:1002BA38o
		unicode	0, <HKEY_CURRENT_CONFIG>,0
aPipe:					; DATA XREF: sub_1001801F:loc_10018054o
		unicode	0, <pipe\>,0
; wchar_t Format
Format:					; DATA XREF: sub_100189BE+2Eo
		unicode	0, <0x%X>,0
		align 4
aSbox_alternate:			; DATA XREF: sub_100189BE+1Do
		unicode	0, <sbox_alternate_desktop_>,0
flt_1002DB58	dd 4.2949673e9		; DATA XREF: sub_100060EC+19r
					; sub_100060EC+2Fr
		align 10h
__load_config_used dd 48h		; Size
		dd 0			; Time stamp
		dw 2 dup(0)		; Version: 0.0
		dd 0			; GlobalFlagsClear
		dd 0			; GlobalFlagsSet
		dd 0			; CriticalSectionDefaultTimeout
		dd 0			; DeCommitFreeBlockThreshold
		dd 0			; DeCommitTotalFreeThreshold
		dd 0			; LockPrefixTable
		dd 0			; MaximumAllocationSize
		dd 0			; VirtualMemoryThreshold
		dd 0			; ProcessAffinityMask
		dd 0			; ProcessHeapFlags
		dw 0			; CSDVersion
		dw 0			; Reserved1
		dd 0			; EditList
		dd offset ___security_cookie ; SecurityCookie
		dd offset ___safe_se_handler_table ; SEHandlerTable
		dd 1			; SEHandlerCount
; Debug	information (IMAGE_DEBUG_TYPE_CODEVIEW)
asc_1002DBA8	db 'RSDS'               ; DATA XREF: .rdata:1001A3B4o
					; CV signature
		dd 69E9C029h		; Data1	; GUID
		dw 0ED78h		; Data2
		dw 43E2h		; Data3
		db 0B1h, 95h, 0A0h, 2Dh, 99h, 84h, 83h,	0D7h; Data4
		dd 2			; Age
		db 'c:\builds\moz2_slave\rel-m-rel-w32_bld-000000000000\build\obj-fir' ; PdbFileName
		db 'efox\security\sandbox\win\src\sandboxbroker\sandboxbroker.pdb',0
		align 10h
; Debug	information (type 12)
dword_1002DC40	dd 0			; DATA XREF: .rdata:1001A3D0o
		dd 2 dup(7Ah), 2 dup(0)
; Debug	information (IMAGE_DEBUG_TYPE_RESERVED10)
dword_1002DC54	dd 50475500h, 2	dup(0)	; DATA XREF: .rdata:1001A3ECo
___safe_se_handler_table dd rva	__except_handler4 ; DATA XREF: .rdata:1002DBA0o
		align 8
dword_1002DC68	dd 2 dup(0)		; DATA XREF: sub_100195EF+2o
					; sub_100195EF+7o
dword_1002DC70	dd 2 dup(0)		; DATA XREF: sub_1001960F+2o
					; sub_1001960F+7o
stru_1002DC78	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10004545+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10004545
		dd 0FFFFFFC8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000457E	; ScopeRecord.FilterFunc
		dd offset loc_10004582	; ScopeRecord.HandlerFunc
		align 8
stru_1002DC98	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100097F5+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100097F5
		dd 0FFFFFFB4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10009928	; ScopeRecord.FilterFunc
		dd offset loc_1000992C	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCB8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000A366+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A366
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A3A4	; ScopeRecord.FilterFunc
		dd offset loc_1000A3A8	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCD8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000A3BB+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A3BB
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A3E6	; ScopeRecord.FilterFunc
		dd offset loc_1000A3EA	; ScopeRecord.HandlerFunc
		align 8
stru_1002DCF8	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtCreateFile(x,x,x,x,x,x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A3FE
		dd 0FFFFFF7Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A5B3	; ScopeRecord.FilterFunc
		dd offset loc_1000A5B7	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD18	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtOpenFile(x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000A5DC
		dd 0FFFFFF7Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000A774	; ScopeRecord.FilterFunc
		dd offset loc_1000A778	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD38	dd 0FFFFFFE4h		; GSCookieOffset
					; DATA XREF: TargetNtSetInformationFile(x,x,x,x,x,x)+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000AAC7
		dd 0FFFFFF58h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000AC8F	; ScopeRecord.FilterFunc
		dd offset loc_1000AC93	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD58	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B0F3+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B0F3
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B18B	; ScopeRecord.FilterFunc
		dd offset loc_1000B18F	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD78	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B1A3+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B1A3
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B23B	; ScopeRecord.FilterFunc
		dd offset loc_1000B23F	; ScopeRecord.HandlerFunc
		align 8
stru_1002DD98	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000B253+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000B253
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000B2EB	; ScopeRecord.FilterFunc
		dd offset loc_1000B2EF	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDB8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000C7F7+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000C7F7
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000C838	; ScopeRecord.FilterFunc
		dd offset loc_1000C84B	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDD8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1000D5A8+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1000D5A8
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_1000D640	; ScopeRecord.FilterFunc
		dd offset loc_1000D644	; ScopeRecord.HandlerFunc
		align 8
stru_1002DDF8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenThread(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010D31
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010E4B	; ScopeRecord.FilterFunc
		dd offset loc_10010E4F	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010E45	; ScopeRecord.FilterFunc
		dd offset loc_10010E49	; ScopeRecord.HandlerFunc
stru_1002DE20	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcess(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010E66
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010F5A	; ScopeRecord.FilterFunc
		dd offset loc_10010F5E	; ScopeRecord.HandlerFunc
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10010F54	; ScopeRecord.FilterFunc
		dd offset loc_10010F58	; ScopeRecord.HandlerFunc
stru_1002DE48	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessToken(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10010F75
		dd 0FFFFFF98h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011036	; ScopeRecord.FilterFunc
		dd offset loc_1001103A	; ScopeRecord.HandlerFunc
		align 8
stru_1002DE68	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenProcessTokenEx(x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10011051
		dd 0FFFFFF9Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011119	; ScopeRecord.FilterFunc
		dd offset loc_1001111D	; ScopeRecord.HandlerFunc
		align 8
stru_1002DE88	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100118CF+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100118CF
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10011967	; ScopeRecord.FilterFunc
		dd offset loc_1001196B	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEA8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtCreateKey(x,x,x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001202D
		dd 0FFFFFF94h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100121AB	; ScopeRecord.FilterFunc
		dd offset loc_100121AF	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEC8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_100121C6+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100121C6
		dd 0FFFFFF8Ch		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100122B0	; ScopeRecord.FilterFunc
		dd offset loc_100122B4	; ScopeRecord.HandlerFunc
		align 8
stru_1002DEE8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_1001254C+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 1001254C
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100125E4	; ScopeRecord.FilterFunc
		dd offset loc_100125E8	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF08	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013E44+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013E44
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013EA7	; ScopeRecord.FilterFunc
		dd offset loc_10013EAB	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF28	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013EBD+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013EBD
		dd 0FFFFFFD4h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013EDE	; ScopeRecord.FilterFunc
		dd offset loc_10013EEC	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF48	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10013F01+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10013F01
		dd 0FFFFFFBCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10013FF0	; ScopeRecord.FilterFunc
		dd offset loc_10013FFE	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF68	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10014126+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10014126
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100141A5	; ScopeRecord.FilterFunc
		dd offset loc_100141A9	; ScopeRecord.HandlerFunc
		align 8
stru_1002DF88	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtCreateEvent(x,x,x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016C33
		dd 0FFFFFF84h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10016D63	; ScopeRecord.FilterFunc
		dd offset loc_10016D67	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFA8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: TargetNtOpenEvent(x,x,x,x)+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10016D7E
		dd 0FFFFFF80h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_10016EA2	; ScopeRecord.FilterFunc
		dd offset loc_10016EA6	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFC8	dd 0FFFFFFFEh		; GSCookieOffset ; DATA	XREF: sub_10018DA5+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10018DA5
		dd 0FFFFFFCCh		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset loc_10018E42	; ScopeRecord.HandlerFunc
		align 8
stru_1002DFE8	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: ___DllMainCRTStartup+2o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 100190DC
		dd 0FFFFFFD0h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd 0			; ScopeRecord.FilterFunc
		dd offset $LN18		; ScopeRecord.HandlerFunc
		dd 0			; ScopeRecord.EnclosingLevel
		dd offset $LN22		; ScopeRecord.FilterFunc
		dd offset $LN23		; ScopeRecord.HandlerFunc
stru_1002E010	dd 0FFFFFFFEh		; GSCookieOffset
					; DATA XREF: __IsNonwritableInCurrentImage+5o
		dd 0			; GSCookieXOROffset ; SEH scope	table for function 10019440
		dd 0FFFFFFD8h		; EHCookieOffset
		dd 0			; EHCookieXOROffset
		dd 0FFFFFFFEh		; ScopeRecord.EnclosingLevel
		dd offset loc_100194C9	; ScopeRecord.FilterFunc
		dd offset loc_100194DC	; ScopeRecord.HandlerFunc
		align 10h
;
; Export directory for sandboxbroker.dll
;
		dd 0			; Characteristics
		dd 5632BAABh		; TimeDateStamp: Fri Oct 30 00:32:43 2015
		dw 0			; MajorVersion
		dw 0			; MinorVersion
		dd rva aSandboxbroker_	; Name
		dd 1			; Base
		dd 32h			; NumberOfFunctions
		dd 32h			; NumberOfNames
		dd rva off_1002E058	; AddressOfFunctions
		dd rva off_1002E120	; AddressOfNames
		dd rva word_1002E1E8	; AddressOfNameOrdinals
;
; Export Address Table for sandboxbroker.dll
;
off_1002E058	dd rva ??0SandboxBroker@mozilla@@QAE@ABV01@@Z, rva ??0SandboxBroker@mozilla@@QAE@XZ
					; DATA XREF: .rdata:1002E04Co
		dd rva ??1SandboxBroker@mozilla@@UAE@XZ, rva ??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z ; mozilla::SandboxBroker::SandboxBroker(mozilla::SandboxBroker	const &)
		dd rva ??_7SandboxBroker@mozilla@@6B@, rva ?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z
		dd rva ?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z
		dd rva ?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z
		dd rva ?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z
		dd rva ?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QAE_NXZ
		dd rva ?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z
		dd rva ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		dd rva IsSandboxedProcess, rva _TargetCreateNamedPipeW@36
		dd rva _TargetCreateProcessA@44, rva _TargetCreateProcessW@44
		dd rva _TargetGdiDllInitialize@12, rva _TargetGetStockObject@8
		dd rva _TargetNtCreateEvent@24,	rva _TargetNtCreateFile@48
		dd rva _TargetNtCreateKey@32, rva _TargetNtMapViewOfSection@44
		dd rva _TargetNtOpenEvent@16, rva _TargetNtOpenFile@28
		dd rva _TargetNtOpenKey@16, rva	_TargetNtOpenKeyEx@20
		dd rva _TargetNtOpenProcess@20,	rva _TargetNtOpenProcessToken@16
		dd rva _TargetNtOpenProcessTokenEx@20, rva _TargetNtOpenThread@20
		dd rva _TargetNtOpenThreadToken@20, rva	_TargetNtOpenThreadTokenEx@24
		dd rva _TargetNtQueryAttributesFile@12,	rva _TargetNtQueryFullAttributesFile@12
		dd rva _TargetNtSetInformationFile@24, rva _TargetNtSetInformationThread@20
		dd rva _TargetNtUnmapViewOfSection@12, rva _TargetRegisterClassW@8
		dd rva g_handles_to_close, rva g_interceptions,	rva g_nt
		dd rva g_originals, rva	g_shared_IPC_size, rva g_shared_delayed_integrity_level
		dd rva g_shared_delayed_mitigations, rva g_shared_policy_size
		dd rva g_shared_section
;
; Export Names Table for sandboxbroker.dll
;
off_1002E120	dd rva a??0sandboxbrok,	rva a??0sandboxbr_0, rva a??1sandboxbrok
					; DATA XREF: .rdata:1002E050o
		dd rva a??4sandboxbrok,	rva a??_7sandboxbro, rva a?addtargetpeer ; "??0SandboxBroker@mozilla@@QAE@ABV01@@Z"
		dd rva a?allowdirector,	rva a?allowreadfile, rva a?allowreadwrit
		dd rva a?launchapp@san,	rva a?providelogfun, rva a?setsecurityle
		dd rva a?setsecurity_0,	rva a?setsecurity_1, rva a?sbrokerservic
		dd rva aIssandboxedpro,	rva a_targetcreaten, rva a_targetcreatep
		dd rva a_targetcreat_0,	rva a_targetgdidlli, rva a_targetgetstoc
		dd rva a_targetntcreat,	rva a_targetntcre_0, rva a_targetntcre_1
		dd rva a_targetntmapvi,	rva a_targetntopene, rva a_targetntopenf
		dd rva a_targetntopenk,	rva a_targetntope_0, rva a_targetntopenp
		dd rva a_targetntope_1,	rva a_targetntope_2, rva a_targetntopent
		dd rva a_targetntope_3,	rva a_targetntope_4, rva a_targetntquery
		dd rva a_targetntque_0,	rva a_targetntsetin, rva a_targetntset_0
		dd rva a_targetntunmap,	rva a_targetregiste, rva aG_handles_to_c
		dd rva aG_interception,	rva aG_nt, rva aG_originals, rva aG_shared_ipc_s
		dd rva aG_shared_delay,	rva aG_shared_del_0, rva aG_shared_polic
		dd rva aG_shared_secti
;
; Export Ordinals Table	for sandboxbroker.dll
;
word_1002E1E8	dw 0, 1, 2, 3, 4, 5, 6,	7, 8, 9, 0Ah, 0Bh, 0Ch,	0Dh, 0Eh
					; DATA XREF: .rdata:1002E054o
		dw 0Fh,	10h, 11h, 12h, 13h, 14h, 15h, 16h, 17h,	18h, 19h
		dw 1Ah,	1Bh, 1Ch, 1Dh, 1Eh, 1Fh, 20h, 21h, 22h,	23h, 24h
		dw 25h,	26h, 27h, 28h, 29h, 2Ah, 2Bh, 2Ch, 2Dh,	2Eh, 2Fh
		dw 30h,	31h
aSandboxbroker_	db 'sandboxbroker.dll',0 ; DATA XREF: .rdata:1002E03Co
a??0sandboxbrok	db '??0SandboxBroker@mozilla@@QAE@ABV01@@Z',0
					; DATA XREF: .rdata:off_1002E120o
a??0sandboxbr_0	db '??0SandboxBroker@mozilla@@QAE@XZ',0 ; DATA XREF: .rdata:off_1002E120o
a??1sandboxbrok	db '??1SandboxBroker@mozilla@@UAE@XZ',0 ; DATA XREF: .rdata:off_1002E120o
a??4sandboxbrok	db '??4SandboxBroker@mozilla@@QAEAAV01@ABV01@@Z',0
					; DATA XREF: .rdata:off_1002E120o
a??_7sandboxbro	db '??_7SandboxBroker@mozilla@@6B@',0 ; DATA XREF: .rdata:off_1002E120o
a?addtargetpeer	db '?AddTargetPeer@SandboxBroker@mozilla@@QAE_NPAX@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowdirector	db '?AllowDirectory@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowreadfile	db '?AllowReadFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?allowreadwrit	db '?AllowReadWriteFile@SandboxBroker@mozilla@@QAE_NPB_W@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?launchapp@san	db '?LaunchApp@SandboxBroker@mozilla@@QAE_NPB_W0_NPAPAX@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?providelogfun	db '?ProvideLogFunction@sandboxing@mozilla@@YAXP6AXPBD00_NI@Z@Z',0
					; DATA XREF: .rdata:off_1002E120o
a?setsecurityle	db '?SetSecurityLevelForGMPlugin@SandboxBroker@mozilla@@QAE_NXZ',0
					; DATA XREF: .rdata:off_1002E120o
a?setsecurity_0	db '?SetSecurityLevelForIPDLUnitTestProcess@SandboxBroker@mozilla@@QA'
					; DATA XREF: .rdata:off_1002E120o
		db 'E_NXZ',0
a?setsecurity_1	db '?SetSecurityLevelForPluginProcess@SandboxBroker@mozilla@@QAE_NH@Z'
					; DATA XREF: .rdata:off_1002E120o
		db 0
a?sbrokerservic	db '?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox'
					; DATA XREF: .rdata:off_1002E120o
		db '@@A',0
aIssandboxedpro	db 'IsSandboxedProcess',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreaten	db '_TargetCreateNamedPipeW@36',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreatep	db '_TargetCreateProcessA@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetcreat_0	db '_TargetCreateProcessW@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetgdidlli	db '_TargetGdiDllInitialize@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetgetstoc	db '_TargetGetStockObject@8',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcreat	db '_TargetNtCreateEvent@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcre_0	db '_TargetNtCreateFile@48',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntcre_1	db '_TargetNtCreateKey@32',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntmapvi	db '_TargetNtMapViewOfSection@44',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopene	db '_TargetNtOpenEvent@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenf	db '_TargetNtOpenFile@28',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenk	db '_TargetNtOpenKey@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_0	db '_TargetNtOpenKeyEx@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopenp	db '_TargetNtOpenProcess@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_1	db '_TargetNtOpenProcessToken@16',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_2	db '_TargetNtOpenProcessTokenEx@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntopent	db '_TargetNtOpenThread@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_3	db '_TargetNtOpenThreadToken@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntope_4	db '_TargetNtOpenThreadTokenEx@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntquery	db '_TargetNtQueryAttributesFile@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntque_0	db '_TargetNtQueryFullAttributesFile@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntsetin	db '_TargetNtSetInformationFile@24',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntset_0	db '_TargetNtSetInformationThread@20',0 ; DATA XREF: .rdata:off_1002E120o
a_targetntunmap	db '_TargetNtUnmapViewOfSection@12',0 ; DATA XREF: .rdata:off_1002E120o
a_targetregiste	db '_TargetRegisterClassW@8',0 ; DATA XREF: .rdata:off_1002E120o
aG_handles_to_c	db 'g_handles_to_close',0 ; DATA XREF: .rdata:off_1002E120o
aG_interception	db 'g_interceptions',0  ; DATA XREF: .rdata:off_1002E120o
aG_nt		db 'g_nt',0             ; DATA XREF: .rdata:off_1002E120o
aG_originals	db 'g_originals',0      ; DATA XREF: .rdata:off_1002E120o
aG_shared_ipc_s	db 'g_shared_IPC_size',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_delay	db 'g_shared_delayed_integrity_level',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_del_0	db 'g_shared_delayed_mitigations',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_polic	db 'g_shared_policy_size',0 ; DATA XREF: .rdata:off_1002E120o
aG_shared_secti	db 'g_shared_section',0 ; DATA XREF: .rdata:off_1002E120o
		align 10h
__IMPORT_DESCRIPTOR_KERNEL32 dd	rva off_1002E9A0 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aKernel32_dll	; DLL Name
		dd rva QueryPerformanceCounter ; Import	Address	Table
__IMPORT_DESCRIPTOR_USER32 dd rva off_1002EC7C ; Import	Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aUser32_dll	; DLL Name
		dd rva CreateWindowStationW ; Import Address Table
__IMPORT_DESCRIPTOR_WINMM dd rva off_1002ECA0 ;	Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aWinmm_dll	; DLL Name
		dd rva __imp_timeGetTime ; Import Address Table
__IMPORT_DESCRIPTOR_ADVAPI32 dd	rva off_1002E93C ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aAdvapi32_dll	; DLL Name
		dd rva CopySid		; Import Address Table
__IMPORT_DESCRIPTOR_MSVCP120 dd	rva off_1002EAE8 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcp120_dll	; DLL Name
		dd rva __imp_?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ ; Import Address Table
__IMPORT_DESCRIPTOR_MSVCR120 dd	rva off_1002EBE4 ; Import Name Table
		dd 0			; Time stamp
		dd 0			; Forwarder Chain
		dd rva aMsvcr120_dll	; DLL Name
		dd rva __imp__amsg_exit	; Import Address Table
		dd 5 dup(0)
;
; Import names for ADVAPI32.dll
;
off_1002E93C	dd rva word_1002F50E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_ADVAPI32o
		dd rva word_1002F578
		dd rva word_1002F56A
		dd rva word_1002F55A
		dd rva word_1002F54A
		dd rva word_1002F52E
		dd rva word_1002F518
		dd rva word_1002F4FE
		dd rva word_1002F4E2
		dd rva word_1002F4AA
		dd rva word_1002F492
		dd rva word_1002F480
		dd rva word_1002F468
		dd rva word_1002F45C
		dd rva word_1002F444
		dd rva word_1002F430
		dd rva word_1002F41C
		dd rva word_1002F40A
		dd rva word_1002F3F0
		dd rva word_1002F3DC
		dd rva word_1002F3CA
		dd rva word_1002F3B8
		dd rva word_1002F3A2
		dd rva word_1002F38C
		dd 0
;
; Import names for KERNEL32.dll
;
off_1002E9A0	dd rva word_1002EE1E	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_KERNEL32o
		dd rva word_1002EE38
		dd rva word_1002EE52
		dd rva word_1002EE6E
		dd rva word_1002EE82
		dd rva word_1002EE98
		dd rva word_1002EEA8
		dd rva word_1002EEBA
		dd rva word_1002EEC6
		dd rva word_1002EEDA
		dd rva word_1002EEF0
		dd rva word_1002EF06
		dd rva word_1002EF18
		dd rva word_1002EF26
		dd rva word_1002EF36
		dd rva word_1002EF4C
		dd rva word_1002EF5C
		dd rva word_1002EF68
		dd rva word_1002EF82
		dd rva word_1002EF9E
		dd rva word_1002EFBA
		dd rva word_1002EFCA
		dd rva word_1002EFE8
		dd rva word_1002F006
		dd rva word_1002F020
		dd rva word_1002F036
		dd rva word_1002F04A
		dd rva word_1002F05A
		dd rva word_1002F072
		dd rva word_1002F080
		dd rva word_1002F098
		dd rva word_1002F0A6
		dd rva word_1002F0BC
		dd rva word_1002F0CA
		dd rva word_1002F0EE
		dd rva word_1002F102
		dd rva word_1002F11E
		dd rva word_1002F132
		dd rva word_1002F13E
		dd rva word_1002F14C
		dd rva word_1002F15E
		dd rva word_1002F172
		dd rva word_1002F188
		dd rva word_1002F196
		dd rva word_1002F1AE
		dd rva word_1002F1C2
		dd rva word_1002F1D2
		dd rva word_1002F1E0
		dd rva word_1002F1F6
		dd rva word_1002F206
		dd rva word_1002F218
		dd rva word_1002F230
		dd rva word_1002F244
		dd rva word_1002F254
		dd rva word_1002F26A
		dd rva word_1002F280
		dd rva word_1002F294
		dd rva word_1002ECA8
		dd rva word_10030682
		dd rva word_10030666
		dd rva word_10030656
		dd rva word_10030646
		dd rva word_1002ECB8
		dd rva word_1002ECC6
		dd rva word_1002ECD6
		dd rva word_1002ECE6
		dd rva word_1002ECF6
		dd rva word_1002ED0C
		dd rva word_1002ED1E
		dd rva word_1002ED46
		dd rva word_1002ED5E
		dd rva word_1002EE0E
		dd rva word_1002EDFC
		dd rva word_1002EDE6
		dd rva word_1002EDD2
		dd rva word_1002EDC0
		dd rva word_1002EDB8
		dd rva word_1002EDA2
		dd rva word_1002ED8E
		dd rva word_1002ED76
		dd rva word_1002F0DA
		dd 0
;
; Import names for MSVCP120.dll
;
off_1002EAE8	dd rva word_10030316	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCP120o
		dd rva word_10030358
		dd rva word_10030396
		dd rva word_1002F80A
		dd rva word_100303C0
		dd rva word_100303FC
		dd rva word_1003041E
		dd rva word_100302D2
		dd rva word_1002F598
		dd rva word_1002F5B8
		dd rva word_1002F5D8
		dd rva word_1002F5F2
		dd rva word_1002F612
		dd rva word_1002F632
		dd rva word_1002F648
		dd rva word_1002F688
		dd rva word_1002F6C8
		dd rva word_1002F70E
		dd rva word_1002F74C
		dd rva word_1002F78C
		dd rva word_1002F7CE
		dd rva word_1003028C
		dd rva word_1002F840
		dd rva word_1002F882
		dd rva word_1002F8BC
		dd rva word_1002F926
		dd rva word_1002F966
		dd rva word_1002F99C
		dd rva word_1002F9E8
		dd rva word_1002FA26
		dd rva word_1002FA70
		dd rva word_1002FAB6
		dd rva word_1002FAFC
		dd rva word_1002FB3C
		dd rva word_1002FB80
		dd rva word_1002FBC2
		dd rva word_1002FC02
		dd rva word_1002FC3E
		dd rva word_1002FC62
		dd rva word_1002FC7C
		dd rva word_1002FC96
		dd rva word_1002FCCA
		dd rva word_1002FD12
		dd rva word_1002FD56
		dd rva word_1002FD9A
		dd rva word_1002FDDA
		dd rva word_1002FE18
		dd rva word_1002FE86
		dd rva word_1002FEBE
		dd rva word_1002FF04
		dd rva word_1002FF46
		dd rva word_1002FF88
		dd rva word_1002FFC4
		dd rva word_10030006
		dd rva word_10030060
		dd rva word_100300A2
		dd rva word_100300DA
		dd rva word_10030128
		dd rva word_10030168
		dd rva word_100301B6
		dd rva word_10030200
		dd rva word_1003024A
		dd 0
;
; Import names for MSVCR120.dll
;
off_1002EBE4	dd rva word_1003058A	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_MSVCR120o
		dd rva word_10030598
		dd rva word_100305A6
		dd rva word_100305B2
		dd rva word_100305C0
		dd rva word_100305D6
		dd rva word_100305F0
		dd rva word_10030608
		dd rva word_10030622
		dd rva word_1003069E
		dd rva word_100306A8
		dd rva word_100306B2
		dd rva word_10030448
		dd rva word_10030452
		dd rva word_1003045E
		dd rva word_1003046E
		dd rva word_1003047E
		dd rva word_1003048A
		dd rva word_1003049A
		dd rva word_100304AA
		dd rva word_100304B2
		dd rva word_100304BC
		dd rva word_100304CC
		dd rva word_100304D4
		dd rva word_100304DE
		dd rva word_100304E8
		dd rva word_100304F4
		dd rva word_10030500
		dd rva word_1003050A
		dd rva word_10030516
		dd rva word_10030522
		dd rva word_10030540
		dd rva word_10030548
		dd rva word_10030552
		dd rva word_10030560
		dd rva word_1003056E
		dd rva word_10030578
		dd 0
;
; Import names for USER32.dll
;
off_1002EC7C	dd rva word_1002F310	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_USER32o
		dd rva word_1002F2B4
		dd rva word_1002F2C4
		dd rva word_1002F356
		dd rva word_1002F33C
		dd rva word_1002F328
		dd rva word_1002F2DA
		dd rva word_1002F2F6
		dd 0
;
; Import names for WINMM.dll
;
off_1002ECA0	dd rva word_1002F374	; DATA XREF: .rdata:__IMPORT_DESCRIPTOR_WINMMo
		dd 0
word_1002ECA8	dw 2C0h			; DATA XREF: .rdata:1002EA84o
		db 'GetStdHandle',0
		align 4
word_1002ECB8	dw 7Fh			; DATA XREF: .rdata:1002EA98o
		db 'CloseHandle',0
word_1002ECC6	dw 4A7h			; DATA XREF: .rdata:1002EA9Co
		db 'ResumeThread',0
		align 2
word_1002ECD6	dw 250h			; DATA XREF: .rdata:1002EAA0o
		db 'GetLastError',0
		align 2
word_1002ECE6	dw 50Ah			; DATA XREF: .rdata:1002EAA4o
		db 'SetLastError',0
		align 2
word_1002ECF6	dw 266h			; DATA XREF: .rdata:1002EAA8o
		db 'GetModuleHandleExW',0
		align 4
word_1002ED0C	dw 29Dh			; DATA XREF: .rdata:1002EAACo
		db 'GetProcAddress',0
		align 2
word_1002ED1E	dw 348h			; DATA XREF: .rdata:1002EAB0o
		db 'InitializeCriticalSectionAndSpinCount',0
word_1002ED46	dw 3A2h			; DATA XREF: .rdata:1002EAB4o
		db 'LeaveCriticalSection',0
		align 2
word_1002ED5E	dw 125h			; DATA XREF: .rdata:1002EAB8o
		db 'EnterCriticalSection',0
		align 2
word_1002ED76	dw 105h			; DATA XREF: .rdata:1002EADCo
		db 'DeleteCriticalSection',0
word_1002ED8E	dw 209h			; DATA XREF: .rdata:1002EAD8o
		db 'GetCurrentProcess',0
word_1002EDA2	dw 5A9h			; DATA XREF: .rdata:1002EAD4o
		db 'WaitForSingleObject',0
word_1002EDB8	dw 550h			; DATA XREF: .rdata:1002EAD0o
		db 'Sleep',0
word_1002EDC0	dw 43Fh			; DATA XREF: .rdata:1002EACCo
		db 'RaiseException',0
		align 2
word_1002EDD2	dw 367h			; DATA XREF: .rdata:1002EAC8o
		db 'IsDebuggerPresent',0
word_1002EDE6	dw 20Eh			; DATA XREF: .rdata:1002EAC4o
		db 'GetCurrentThreadId',0
		align 4
word_1002EDFC	dw 11Fh			; DATA XREF: .rdata:1002EAC0o
		db 'DuplicateHandle',0
word_1002EE0E	dw 0E8h			; DATA XREF: .rdata:1002EABCo
		db 'CreateThread',0
		align 2
word_1002EE1E	dw 42Dh			; DATA XREF: .rdata:off_1002E9A0o
		db 'QueryPerformanceCounter',0
word_1002EE38	dw 2D6h			; DATA XREF: .rdata:1002E9A4o
		db 'GetSystemTimeAsFileTime',0
word_1002EE52	dw 42Eh			; DATA XREF: .rdata:1002E9A8o
		db 'QueryPerformanceFrequency',0
word_1002EE6E	dw 267h			; DATA XREF: .rdata:1002E9ACo
		db 'GetModuleHandleW',0
		align 2
word_1002EE82	dw 274h			; DATA XREF: .rdata:1002E9B0o
		db 'GetNativeSystemInfo',0
word_1002EE98	dw 305h			; DATA XREF: .rdata:1002E9B4o
		db 'GetVersionExW',0
word_1002EEA8	dw 0DBh			; DATA XREF: .rdata:1002E9B8o
		db 'CreateProcessW',0
		align 2
word_1002EEBA	dw 4EFh			; DATA XREF: .rdata:1002E9BCo
		db 'SetEvent',0
		align 2
word_1002EEC6	dw 452h			; DATA XREF: .rdata:1002E9C0o
		db 'ReadProcessMemory',0
word_1002EEDA	dw 22Ch			; DATA XREF: .rdata:1002E9C4o
		db 'GetExitCodeProcess',0
		align 10h
word_1002EEF0	dw 263h			; DATA XREF: .rdata:1002E9C8o
		db 'GetModuleFileNameW',0
		align 2
word_1002EF06	dw 59Ah			; DATA XREF: .rdata:1002E9CCo
		db 'VirtualAllocEx',0
		align 4
word_1002EF18	dw 4A1h			; DATA XREF: .rdata:1002E9D0o
		db 'ResetEvent',0
		align 2
word_1002EF26	dw 0B6h			; DATA XREF: .rdata:1002E9D4o
		db 'CreateEventW',0
		align 2
word_1002EF36	dw 5E8h			; DATA XREF: .rdata:1002E9D8o
		db 'WriteProcessMemory',0
		align 4
word_1002EF4C	dw 558h			; DATA XREF: .rdata:1002E9DCo
		db 'SuspendThread',0
word_1002EF5C	dw 3B2h			; DATA XREF: .rdata:1002E9E0o
		db 'LocalFree',0
word_1002EF68	dw 508h			; DATA XREF: .rdata:1002E9E4o
		db 'SetInformationJobObject',0
word_1002EF82	dw 2B8h			; DATA XREF: .rdata:1002E9E8o
		db 'GetQueuedCompletionStatus',0
word_1002EF9E	dw 347h			; DATA XREF: .rdata:1002E9ECo
		db 'InitializeCriticalSection',0
word_1002EFBA	dw 2A4h			; DATA XREF: .rdata:1002E9F0o
		db 'GetProcessId',0
		align 2
word_1002EFCA	dw 484h			; DATA XREF: .rdata:1002E9F4o
		db 'RegisterWaitForSingleObject',0
word_1002EFE8	dw 404h			; DATA XREF: .rdata:1002E9F8o
		db 'PostQueuedCompletionStatus',0
		align 2
word_1002F006	dw 0C7h			; DATA XREF: .rdata:1002E9FCo
		db 'CreateIoCompletionPort',0
		align 10h
word_1002F020	dw 55Eh			; DATA XREF: .rdata:1002EA00o
		db 'TerminateJobObject',0
		align 2
word_1002F036	dw 58Ah			; DATA XREF: .rdata:1002EA04o
		db 'UnregisterWaitEx',0
		align 2
word_1002F04A	dw 59Dh			; DATA XREF: .rdata:1002EA08o
		db 'VirtualFreeEx',0
word_1002F05A	dw 507h			; DATA XREF: .rdata:1002EA0Co
		db 'SetHandleInformation',0
		align 2
word_1002F072	dw 59Ch			; DATA XREF: .rdata:1002EA10o
		db 'VirtualFree',0
word_1002F080	dw 2A1h			; DATA XREF: .rdata:1002EA14o
		db 'GetProcessHandleCount',0
word_1002F098	dw 3EEh			; DATA XREF: .rdata:1002EA18o
		db 'OpenProcess',0
word_1002F0A6	dw 20Ah			; DATA XREF: .rdata:1002EA1Co
		db 'GetCurrentProcessId',0
word_1002F0BC	dw 19Eh			; DATA XREF: .rdata:1002EA20o
		db 'FreeLibrary',0
word_1002F0CA	dw 3A8h			; DATA XREF: .rdata:1002EA24o
		db 'LoadLibraryW',0
		align 2
word_1002F0DA	dw 5A0h			; DATA XREF: .rdata:1002EAE0o
		db 'VirtualProtectEx',0
		align 2
word_1002F0EE	dw 0C9h			; DATA XREF: .rdata:1002EA28o
		db 'CreateJobObjectW',0
		align 2
word_1002F102	dw 1Ch			; DATA XREF: .rdata:1002EA2Co
		db 'AssignProcessToJobObject',0
		align 2
word_1002F11E	dw 0D3h			; DATA XREF: .rdata:1002EA30o
		db 'CreateNamedPipeW',0
		align 2
word_1002F132	dw 609h			; DATA XREF: .rdata:1002EA34o
		db 'lstrlenW',0
		align 2
word_1002F13E	dw 0FBh			; DATA XREF: .rdata:1002EA38o
		db 'DebugBreak',0
		align 4
word_1002F14C	dw 5A2h			; DATA XREF: .rdata:1002EA3Co
		db 'VirtualQueryEx',0
		align 2
word_1002F15E	dw 264h			; DATA XREF: .rdata:1002EA40o
		db 'GetModuleHandleA',0
		align 2
word_1002F172	dw 337h			; DATA XREF: .rdata:1002EA44o
		db 'HeapSetInformation',0
		align 4
word_1002F188	dw 4B1h			; DATA XREF: .rdata:1002EA48o
		db 'SearchPathW',0
word_1002F196	dw 203h			; DATA XREF: .rdata:1002EA4Co
		db 'GetCurrentDirectoryW',0
		align 2
word_1002F1AE	dw 55Fh			; DATA XREF: .rdata:1002EA50o
		db 'TerminateProcess',0
		align 2
word_1002F1C2	dw 2F2h			; DATA XREF: .rdata:1002EA54o
		db 'GetTickCount',0
		align 2
word_1002F1D2	dw 23Eh			; DATA XREF: .rdata:1002EA58o
		db 'GetFileType',0
word_1002F1E0	dw 54Eh			; DATA XREF: .rdata:1002EA5Co
		db 'SignalObjectAndWait',0
word_1002F1F6	dw 0D1h			; DATA XREF: .rdata:1002EA60o
		db 'CreateMutexW',0
		align 2
word_1002F206	dw 583h			; DATA XREF: .rdata:1002EA64o
		db 'UnmapViewOfFile',0
word_1002F218	dw 410h			; DATA XREF: .rdata:1002EA68o
		db 'ProcessIdToSessionId',0
		align 10h
word_1002F230	dw 2E4h			; DATA XREF: .rdata:1002EA6Co
		db 'GetThreadContext',0
		align 4
word_1002F244	dw 3C0h			; DATA XREF: .rdata:1002EA70o
		db 'MapViewOfFile',0
word_1002F254	dw 0BFh			; DATA XREF: .rdata:1002EA74o
		db 'CreateFileMappingW',0
		align 2
word_1002F26A	dw 235h			; DATA XREF: .rdata:1002EA78o
		db 'GetFileAttributesW',0
		align 10h
word_1002F280	dw 25Dh			; DATA XREF: .rdata:1002EA7Co
		db 'GetLongPathNameW',0
		align 4
word_1002F294	dw 426h			; DATA XREF: .rdata:1002EA80o
		db 'QueryDosDeviceW',0
aKernel32_dll	db 'KERNEL32.dll',0     ; DATA XREF: .rdata:1002E8BCo
		align 4
word_1002F2B4	dw 4Ch			; DATA XREF: .rdata:1002EC80o
		db 'CloseDesktop',0
		align 4
word_1002F2C4	dw 50h			; DATA XREF: .rdata:1002EC84o
		db 'CloseWindowStation',0
		align 2
word_1002F2DA	dw 1B8h			; DATA XREF: .rdata:1002EC94o
		db 'GetUserObjectInformationW',0
word_1002F2F6	dw 193h			; DATA XREF: .rdata:1002EC98o
		db 'GetProcessWindowStation',0
word_1002F310	dw 75h			; DATA XREF: .rdata:off_1002EC7Co
		db 'CreateWindowStationW',0
		align 4
word_1002F328	dw 1AEh			; DATA XREF: .rdata:1002EC90o
		db 'GetThreadDesktop',0
		align 4
word_1002F33C	dw 2EFh			; DATA XREF: .rdata:1002EC8Co
		db 'SetProcessWindowStation',0
word_1002F356	dw 61h			; DATA XREF: .rdata:1002EC88o
		db 'CreateDesktopW',0
		align 4
aUser32_dll	db 'USER32.dll',0       ; DATA XREF: .rdata:1002E8D0o
		align 4
word_1002F374	dw 94h			; DATA XREF: .rdata:off_1002ECA0o
		db 'timeGetTime',0
aWinmm_dll	db 'WINMM.dll',0        ; DATA XREF: .rdata:1002E8E4o
word_1002F38C	dw 16Fh			; DATA XREF: .rdata:1002E998o
		db 'GetTokenInformation',0
word_1002F3A2	dw 2EBh			; DATA XREF: .rdata:1002E994o
		db 'SetTokenInformation',0
word_1002F3B8	dw 162h			; DATA XREF: .rdata:1002E990o
		db 'GetSecurityInfo',0
word_1002F3CA	dw 2E4h			; DATA XREF: .rdata:1002E98Co
		db 'SetSecurityInfo',0
word_1002F3DC	dw 2CFh			; DATA XREF: .rdata:1002E988o
		db 'SetEntriesInAclW',0
		align 10h
word_1002F3F0	dw 83h			; DATA XREF: .rdata:1002E984o
		db 'ConvertStringSidToSidW',0
		align 2
word_1002F40A	dw 0EEh			; DATA XREF: .rdata:1002E980o
		db 'DuplicateToken',0
		align 4
word_1002F41C	dw 0EFh			; DATA XREF: .rdata:1002E97Co
		db 'DuplicateTokenEx',0
		align 10h
word_1002F430	dw 212h			; DATA XREF: .rdata:1002E978o
		db 'OpenProcessToken',0
		align 4
word_1002F444	dw 8Eh			; DATA XREF: .rdata:1002E974o
		db 'CreateRestrictedToken',0
word_1002F45C	dw 118h			; DATA XREF: .rdata:1002E970o
		db 'EqualSid',0
		align 4
word_1002F468	dw 1ADh			; DATA XREF: .rdata:1002E96Co
		db 'LookupPrivilegeValueW',0
word_1002F480	dw 2EAh			; DATA XREF: .rdata:1002E968o
		db 'SetThreadToken',0
		align 2
word_1002F492	dw 8Bh			; DATA XREF: .rdata:1002E964o
		db 'CreateProcessAsUserW',0
		align 2
word_1002F4AA	dw 81h			; DATA XREF: .rdata:1002E960o
		db 'ConvertStringSecurityDescriptorToSecurityDescriptorW',0
		align 2
word_1002F4E2	dw 161h			; DATA XREF: .rdata:1002E95Co
		db 'GetSecurityDescriptorSacl',0
word_1002F4FE	dw 14Ah			; DATA XREF: .rdata:1002E958o
		db 'GetLengthSid',0
		align 2
word_1002F50E	dw 85h			; DATA XREF: .rdata:off_1002E93Co
		db 'CopySid',0
word_1002F518	dw 92h			; DATA XREF: .rdata:1002E954o
		db 'CreateWellKnownSid',0
		align 2
word_1002F52E	dw 26Dh			; DATA XREF: .rdata:1002E950o
		db 'RegDisablePredefinedCache',0
word_1002F54A	dw 2B8h			; DATA XREF: .rdata:1002E94Co
		db 'RevertToSelf',0
		align 2
word_1002F55A	dw 285h			; DATA XREF: .rdata:1002E948o
		db 'RegOpenKeyExW',0
word_1002F56A	dw 254h			; DATA XREF: .rdata:1002E944o
		db 'RegCloseKey',0
word_1002F578	dw 25Dh			; DATA XREF: .rdata:1002E940o
		db 'RegCreateKeyExW',0
aAdvapi32_dll	db 'ADVAPI32.dll',0     ; DATA XREF: .rdata:1002E8F8o
		align 4
word_1002F598	dw 2C5h			; DATA XREF: .rdata:1002EB08o
		db '?_Winerror_map@std@@YAPBDH@Z',0
		align 4
word_1002F5B8	dw 2B0h			; DATA XREF: .rdata:1002EB0Co
		db '?_Syserror_map@std@@YAPBDH@Z',0
		align 4
word_1002F5D8	dw 2C9h			; DATA XREF: .rdata:1002EB10o
		db '?_Xbad_alloc@std@@YAXXZ',0
word_1002F5F2	dw 2CDh			; DATA XREF: .rdata:1002EB14o
		db '?_Xout_of_range@std@@YAXPBD@Z',0
word_1002F612	dw 2CCh			; DATA XREF: .rdata:1002EB18o
		db '?_Xlength_error@std@@YAXPBD@Z',0
word_1002F632	dw 1A7h			; DATA XREF: .rdata:1002EB1Co
		db '?_BADOFF@std@@3_JB',0
		align 4
word_1002F648	dw 0FFh			; DATA XREF: .rdata:1002EB20o
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@I@Z',0
		align 4
word_1002F688	dw 0FEh			; DATA XREF: .rdata:1002EB24o
		db '??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@H@Z',0
		align 4
word_1002F6C8	dw 502h			; DATA XREF: .rdata:1002EB28o
		db '?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@'
		db 'Z',0
		align 2
word_1002F70E	dw 276h			; DATA XREF: .rdata:1002EB2Co
		db '?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ',0
		align 4
word_1002F74C	dw 4FFh			; DATA XREF: .rdata:1002EB30o
		db '?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z',0
word_1002F78C	dw 38Eh			; DATA XREF: .rdata:1002EB34o
		db '?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ',0
word_1002F7CE	dw 2Ah			; DATA XREF: .rdata:1002EB38o
		db '??0?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAE@XZ',0
		align 2
word_1002F80A	dw 7			; DATA XREF: .rdata:1002EAF4o
		db '??0?$basic_ios@DU?$char_traits@D@std@@@std@@IAE@XZ',0
		align 10h
word_1002F840	dw 27Ch			; DATA XREF: .rdata:1002EB40o
		db '?_Pninc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@IAEPADXZ',0
word_1002F882	dw 84h			; DATA XREF: .rdata:1002EB44o
		db '??1?$basic_ostream@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 4
word_1002F8BC	dw 20h			; DATA XREF: .rdata:1002EB48o
		db '??0?$basic_ostream@DU?$char_traits@D@std@@@std@@QAE@PAV?$basic_st'
		db 'reambuf@DU?$char_traits@D@std@@@1@_N@Z',0
word_1002F926	dw 4E6h			; DATA XREF: .rdata:1002EB4Co
		db '?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z',0
		align 2
word_1002F966	dw 7Bh			; DATA XREF: .rdata:1002EB50o
		db '??1?$basic_ios@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 4
word_1002F99C	dw 41Ch			; DATA XREF: .rdata:1002EB54o
		db '?imbue@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEXABVloca'
		db 'le@2@@Z',0
		align 4
word_1002F9E8	dw 521h			; DATA XREF: .rdata:1002EB58o
		db '?sync@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
word_1002FA26	dw 4D6h			; DATA XREF: .rdata:1002EB5Co
		db '?setbuf@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEPAV12@P'
		db 'AD_J@Z',0
word_1002FA70	dw 56Eh			; DATA XREF: .rdata:1002EB60o
		db '?xsputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPBD_J'
		db '@Z',0
word_1002FAB6	dw 56Bh			; DATA XREF: .rdata:1002EB64o
		db '?xsgetn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JPAD_J'
		db '@Z',0
word_1002FAFC	dw 540h			; DATA XREF: .rdata:1002EB68o
		db '?uflow@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAEHXZ',0
		align 4
word_1002FB3C	dw 4F6h			; DATA XREF: .rdata:1002EB6Co
		db '?showmanyc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@MAE_JXZ'
		db 0
word_1002FB80	dw 2BFh			; DATA XREF: .rdata:1002EB70o
		db '?_Unlock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 2
word_1002FBC2	dw 258h			; DATA XREF: .rdata:1002EB74o
		db '?_Lock@?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAEXXZ',0
		align 2
word_1002FC02	dw 87h			; DATA XREF: .rdata:1002EB78o
		db '??1?$basic_streambuf@DU?$char_traits@D@std@@@std@@UAE@XZ',0
		align 2
word_1002FC3E	dw 3F7h			; DATA XREF: .rdata:1002EB7Co
		db '?id@?$ctype@_W@std@@2V0locale@2@A',0
word_1002FC62	dw 0A5h			; DATA XREF: .rdata:1002EB80o
		db '??1_Lockit@std@@QAE@XZ',0
		align 4
word_1002FC7C	dw 66h			; DATA XREF: .rdata:1002EB84o
		db '??0_Lockit@std@@QAE@H@Z',0
word_1002FC96	dw 1EDh			; DATA XREF: .rdata:1002EB88o
		db '?_Getgloballocale@locale@std@@CAPAV_Locimp@12@XZ',0
		align 2
word_1002FCCA	dw 504h			; DATA XREF: .rdata:1002EB8Co
		db '?sputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAE_JPB_W'
		db '_J@Z',0
word_1002FD12	dw 501h			; DATA XREF: .rdata:1002EB90o
		db '?sputc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@QAEG_W@Z',0
		align 2
word_1002FD56	dw 390h			; DATA XREF: .rdata:1002EB94o
		db '?flush@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV12@XZ'
		db 0
word_1002FD9A	dw 278h			; DATA XREF: .rdata:1002EB98o
		db '?_Osfx@?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEXXZ',0
		align 2
word_1002FDDA	dw 30h			; DATA XREF: .rdata:1002EB9Co
		db '??0?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAE@XZ',0
		align 4
word_1002FE18	dw 12h			; DATA XREF: .rdata:1002EBA0o
		db '??0?$basic_iostream@_WU?$char_traits@_W@std@@@std@@QAE@PAV?$basic'
		db '_streambuf@_WU?$char_traits@_W@std@@@1@@Z',0
		align 2
word_1002FE86	dw 0Bh			; DATA XREF: .rdata:1002EBA4o
		db '??0?$basic_ios@_WU?$char_traits@_W@std@@@std@@IAE@XZ',0
		align 2
word_1002FEBE	dw 27Eh			; DATA XREF: .rdata:1002EBA8o
		db '?_Pninc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEPA_WX'
		db 'Z',0
		align 4
word_1002FF04	dw 464h			; DATA XREF: .rdata:1002EBACo
		db '?pbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_1002FF46	dw 393h			; DATA XREF: .rdata:1002EBB0o
		db '?gbump@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@IAEXH@Z',0
word_1002FF88	dw 80h			; DATA XREF: .rdata:1002EBB4o
		db '??1?$basic_iostream@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
word_1002FFC4	dw 123h			; DATA XREF: .rdata:1002EBB8o
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@K@Z',0
		align 2
word_10030006	dw 129h			; DATA XREF: .rdata:1002EBBCo
		db '??6?$basic_ostream@_WU?$char_traits@_W@std@@@std@@QAEAAV01@P6AAAV'
		db 'ios_base@1@AAV21@@Z@Z',0
		align 10h
word_10030060	dw 4EAh			; DATA XREF: .rdata:1002EBC0o
		db '?setstate@?$basic_ios@_WU?$char_traits@_W@std@@@std@@QAEXH_N@Z',0
		align 2
word_100300A2	dw 7Dh			; DATA XREF: .rdata:1002EBC4o
		db '??1?$basic_ios@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
		align 2
word_100300DA	dw 41Eh			; DATA XREF: .rdata:1002EBC8o
		db '?imbue@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEXABVlo'
		db 'cale@2@@Z',0
		align 4
word_10030128	dw 523h			; DATA XREF: .rdata:1002EBCCo
		db '?sync@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEHXZ',0
word_10030168	dw 4D8h			; DATA XREF: .rdata:1002EBD0o
		db '?setbuf@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEPAV12'
		db '@PA_W_J@Z',0
		align 2
word_100301B6	dw 570h			; DATA XREF: .rdata:1002EBD4o
		db '?xsputn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPB_'
		db 'W_J@Z',0
		align 10h
word_10030200	dw 56Dh			; DATA XREF: .rdata:1002EBD8o
		db '?xsgetn@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_JPA_'
		db 'W_J@Z',0
		align 2
word_1003024A	dw 542h			; DATA XREF: .rdata:1002EBDCo
		db '?uflow@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAEGXZ',0
		align 4
word_1003028C	dw 4F8h			; DATA XREF: .rdata:1002EB3Co
		db '?showmanyc@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@MAE_J'
		db 'XZ',0
word_100302D2	dw 2C1h			; DATA XREF: .rdata:1002EB04o
		db '?_Unlock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 2
word_10030316	dw 25Ah			; DATA XREF: .rdata:off_1002EAE8o
		db '?_Lock@?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAEXXZ',0
		align 4
word_10030358	dw 89h			; DATA XREF: .rdata:1002EAECo
		db '??1?$basic_streambuf@_WU?$char_traits@_W@std@@@std@@UAE@XZ',0
		align 2
word_10030396	dw 3E9h			; DATA XREF: .rdata:1002EAF0o
		db '?getloc@ios_base@std@@QBE?AVlocale@2@XZ',0
word_100303C0	dw 1D0h			; DATA XREF: .rdata:1002EAF8o
		db '?_Getcat@?$ctype@_W@std@@SAIPAPBVfacet@locale@2@PBV42@@Z',0
		align 4
word_100303FC	dw 561h			; DATA XREF: .rdata:1002EAFCo
		db '?widen@?$ctype@_W@std@@QBE_WD@Z',0
word_1003041E	dw 130h			; DATA XREF: .rdata:1002EB00o
		db '??Bid@locale@std@@QAEIXZ',0
		align 2
aMsvcp120_dll	db 'MSVCP120.dll',0     ; DATA XREF: .rdata:1002E90Co
		align 4
word_10030448	dw 6E8h			; DATA XREF: .rdata:1002EC14o
		db 'memmove',0
word_10030452	dw 449h			; DATA XREF: .rdata:1002EC18o
		db '_purecall',0
word_1003045E	dw 72h			; DATA XREF: .rdata:1002EC1Co
		db '??3@YAXPAX@Z',0
		align 2
word_1003046E	dw 70h			; DATA XREF: .rdata:1002EC20o
		db '??2@YAPAXI@Z',0
		align 2
word_1003047E	dw 4BCh			; DATA XREF: .rdata:1002EC24o
		db '_strnicmp',0
word_1003048A	dw 527h			; DATA XREF: .rdata:1002EC28o
		db '_vscwprintf_p',0
word_1003049A	dw 53Bh			; DATA XREF: .rdata:1002EC2Co
		db '_vswprintf_p',0
		align 2
word_100304AA	dw 683h			; DATA XREF: .rdata:1002EC30o
		db 'free',0
		align 2
word_100304B2	dw 6DBh			; DATA XREF: .rdata:1002EC34o
		db 'malloc',0
		align 4
word_100304BC	dw 89h			; DATA XREF: .rdata:1002EC38o
		db '??_V@YAXPAX@Z',0
word_100304CC	dw 5DCh			; DATA XREF: .rdata:1002EC3Co
		db 'abort',0
word_100304D4	dw 54Dh			; DATA XREF: .rdata:1002EC40o
		db '_wcsdup',0
word_100304DE	dw 693h			; DATA XREF: .rdata:1002EC44o
		db 'getenv',0
		align 4
word_100304E8	dw 55Bh			; DATA XREF: .rdata:1002EC48o
		db '_wcsnicmp',0
word_100304F4	dw 7A8h			; DATA XREF: .rdata:1002EC4Co
		db 'wmemcpy_s',0
word_10030500	dw 708h			; DATA XREF: .rdata:1002EC50o
		db 'rand_s',0
		align 2
word_1003050A	dw 6E7h			; DATA XREF: .rdata:1002EC54o
		db 'memcpy_s',0
		align 2
word_10030516	dw 551h			; DATA XREF: .rdata:1002EC58o
		db '_wcsicmp',0
		align 2
word_10030522	dw 531h			; DATA XREF: .rdata:1002EC5Co
		db '_vsnwprintf_s',0
aMsvcr120_dll	db 'MSVCR120.dll',0     ; DATA XREF: .rdata:1002E920o
		align 10h
word_10030540	dw 394h			; DATA XREF: .rdata:1002EC60o
		db '_lock',0
word_10030548	dw 504h			; DATA XREF: .rdata:1002EC64o
		db '_unlock',0
word_10030552	dw 22Eh			; DATA XREF: .rdata:1002EC68o
		db '_calloc_crt',0
word_10030560	dw 1AEh			; DATA XREF: .rdata:1002EC6Co
		db '__dllonexit',0
word_1003056E	dw 43Ah			; DATA XREF: .rdata:1002EC70o
		db '_onexit',0
word_10030578	dw 16Fh			; DATA XREF: .rdata:1002EC74o
		db '__CppXcptFilter',0
word_1003058A	dw 217h			; DATA XREF: .rdata:off_1002EBE4o
		db '_amsg_exit',0
		align 4
word_10030598	dw 3A5h			; DATA XREF: .rdata:1002EBE8o
		db '_malloc_crt',0
word_100305A6	dw 30Ch			; DATA XREF: .rdata:1002EBECo
		db '_initterm',0
word_100305B2	dw 30Dh			; DATA XREF: .rdata:1002EBF0o
		db '_initterm_e',0
word_100305C0	dw 250h			; DATA XREF: .rdata:1002EBF4o
		db '_crt_debugger_hook',0
		align 2
word_100305D6	dw 1ACh			; DATA XREF: .rdata:1002EBF8o
		db '__crtUnhandledException',0
word_100305F0	dw 1ABh			; DATA XREF: .rdata:1002EBFCo
		db '__crtTerminateProcess',0
word_10030608	dw 27Ah			; DATA XREF: .rdata:1002EC00o
		db '_except_handler4_common',0
word_10030622	dw 18Ch			; DATA XREF: .rdata:1002EC04o
		db '__clean_type_info_names_internal',0
		align 2
word_10030646	dw 121h			; DATA XREF: .rdata:1002EA94o
		db 'EncodePointer',0
word_10030656	dw 0FEh			; DATA XREF: .rdata:1002EA90o
		db 'DecodePointer',0
word_10030666	dw 36Dh			; DATA XREF: .rdata:1002EA8Co
		db 'IsProcessorFeaturePresent',0
word_10030682	dw 113h			; DATA XREF: .rdata:1002EA88o
		db 'DisableThreadLibraryCalls',0
word_1003069E	dw 6E5h			; DATA XREF: .rdata:1002EC08o
		db 'memcmp',0
		align 4
word_100306A8	dw 6E6h			; DATA XREF: .rdata:1002EC0Co
		db 'memcpy',0
		align 2
word_100306B2	dw 6EAh			; DATA XREF: .rdata:1002EC10o
		db 'memset',0
		align 1000h
_rdata		ends

; Section 3. (virtual address 00031000)
; Virtual size			: 00000FBC (   4028.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 0002F600
; Flags	C0000040: Data Readable	Writable
; Alignment	: default
; ===========================================================================

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 10031000h
___security_cookie dd 0BB40E64Eh	; DATA XREF: sub_10001C05+6r
					; sub_1000279B+6r ...
dword_10031004	dd 44BF19B1h		; DATA XREF: ___report_gsfailure+E3r
					; sub_10019531+29w ...
		align 10h
dword_10031010	dd 0FFFFFFFFh		; DATA XREF: ___DllMainCRTStartup+1Cw
					; ___DllMainCRTStartup:$LN20w
off_10031014	dd offset sub_10005642	; DATA XREF: sub_10005642+Bo
; Exported entry  47. g_shared_delayed_integrity_level
		public g_shared_delayed_integrity_level
g_shared_delayed_integrity_level dd 7	; DATA XREF: sub_10014EC9+70o
					; sub_10014EC9+7Aw ...
off_1003101C	dd offset off_1001A8FC	; DATA XREF: sub_10001211:loc_10001231o
					; sub_100197D0w
off_10031020	dd offset off_1001A8E4	; DATA XREF: sub_10001211+17o
					; sub_100197E6w
off_10031024	dd offset off_1001A914	; DATA XREF: sub_100197DBw
		align 10h
; void *dword_10031030
dword_10031030	dd 0			; DATA XREF: std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void)+7w
					; std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(void):loc_10018CF0r ...
dword_10031034	dd 0			; DATA XREF: sub_100197FDo
dword_10031038	dd 0			; DATA XREF: sub_10018EC2+12r
					; sub_10018EC2+25w ...
		align 10h
dword_10031040	dd 0			; DATA XREF: ___report_gsfailure+9Fw
					; .rdata:off_1001A3F8o
dword_10031044	dd 0			; DATA XREF: ___report_gsfailure+A9w
		dd 0
dword_1003104C	dd 0			; DATA XREF: ___report_gsfailure+9Aw
dword_10031050	dd 0			; DATA XREF: ___report_gsfailure+B3w
dword_10031054	dd 0			; DATA XREF: ___report_gsfailure+C3w
		dd 0Eh dup(0)
dword_10031090	dd 0			; DATA XREF: ___report_gsfailure+8Bw
					; .rdata:1001A3FCo
		dd 22h dup(0)
word_1003111C	dw 0			; DATA XREF: ___report_gsfailure+5Fw
		align 10h
word_10031120	dw 0			; DATA XREF: ___report_gsfailure+58w
		align 4
word_10031124	dw 0			; DATA XREF: ___report_gsfailure+51w
		align 4
word_10031128	dw 0			; DATA XREF: ___report_gsfailure+4Aw
		align 4
dword_1003112C	dd 0			; DATA XREF: ___report_gsfailure+36w
dword_10031130	dd 0			; DATA XREF: ___report_gsfailure+30w
dword_10031134	dd 0			; DATA XREF: ___report_gsfailure+2Aw
dword_10031138	dd 0			; DATA XREF: ___report_gsfailure+24w
dword_1003113C	dd 0			; DATA XREF: ___report_gsfailure+1Ew
dword_10031140	dd 0			; DATA XREF: ___report_gsfailure:loc_10019265w
dword_10031144	dd 0			; DATA XREF: ___report_gsfailure+70w
dword_10031148	dd 0			; DATA XREF: ___report_gsfailure+78w
					; ___report_gsfailure+95r
word_1003114C	dw 0			; DATA XREF: ___report_gsfailure+43w
		align 10h
dword_10031150	dd 0			; DATA XREF: ___report_gsfailure+67w
dword_10031154	dd 0			; DATA XREF: ___report_gsfailure+80w
word_10031158	dw 0			; DATA XREF: ___report_gsfailure+3Cw
		align 4
		dd 29h dup(0)
		dd 57h dup(?)
dword_1003135C	dd ?			; DATA XREF: ___raise_securityfailure+Bw
					; ___raise_securityfailure+1Dr
dword_10031360	dd 4 dup(?)		; DATA XREF: sub_1001963Co
; Exported entry  15. ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
		public ?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A
; private: static class	sandbox::BrokerServices	* mozilla::SandboxBroker::sBrokerService
?sBrokerService@SandboxBroker@mozilla@@0PAVBrokerServices@sandbox@@A dd	?
					; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+9r
					; mozilla::SandboxBroker::SandboxBroker(void)+29w ...
dword_10031374	dd ?			; DATA XREF: sub_10014BCE+25r
dword_10031378	dd ?			; DATA XREF: mozilla::sandboxing::ProvideLogFunction(void (*)(char const *,char	const *,char const *,bool,uint))+4w
					; sub_100029E2r ...
		align 10h
dword_10031380	dd 24Bh	dup(?)		; DATA XREF: .rdata:1001AAB0o
dword_10031CAC	dd ?			; DATA XREF: sub_10005333+22r
					; sub_10005333+3Ew
dword_10031CB0	dd ?			; DATA XREF: sub_10005333+14r
					; sub_10005333+2Dw
dword_10031CB4	dd ?			; DATA XREF: sub_10005333+1Cr
					; sub_10005333+36w
byte_10031CB8	db ?			; DATA XREF: sub_10004646+34w
					; sub_10004646+41w
byte_10031CB9	db ?			; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+1Bw
					; sub_10013CCD+11w
		align 10h
dword_10031CC0	dd ?			; DATA XREF: sub_10005546+1r
					; sub_10005546+Do ...
		align 8
dword_10031CC8	dd 4 dup(?)		; DATA XREF: sub_10005546+1Bo
; Exported entry  42. g_handles_to_close
		public g_handles_to_close
; LPVOID g_handles_to_close
g_handles_to_close dd ?			; DATA XREF: sub_1000BEB1+7Eo
					; sub_1000BEB1+88w ...
		align 10h
dword_10031CE0	dd ?			; DATA XREF: sub_10005C05+1r
					; sub_10005C05+Fo ...
dword_10031CE4	dd ?			; DATA XREF: sub_10005C05+25w
					; sub_10005C05+38o ...
dword_10031CE8	dd ?			; DATA XREF: sub_10005C05+2Bw
dword_10031CEC	dd ?			; DATA XREF: sub_10005C05+4Cw
dword_10031CF0	dd ?			; DATA XREF: sub_10005C05+52w
dword_10031CF4	dd ?			; DATA XREF: sub_10005C05+58w
		align 10h
flt_10031D00	dd ?			; DATA XREF: sub_10005C05+46w
; Exported entry  43. g_interceptions
		public g_interceptions
g_interceptions	dd ?			; DATA XREF: sub_1000D979+5Ao
					; sub_1000D979+5Fw ...
; Exported entry  44. g_nt
		public g_nt
g_nt		dd ?			; DATA XREF: sub_1000EE56+4Cw
					; sub_1000EE56+269o ...
dword_10031D0C	dd ?			; DATA XREF: sub_1000EE56+66w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+E4r
dword_10031D10	dd ?			; DATA XREF: sub_1000EE56+80w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+B9r
dword_10031D14	dd ?			; DATA XREF: sub_1000EE56+9Aw
					; sub_10014324+34r
dword_10031D18	dd ?			; DATA XREF: sub_1000EE56+B4w
					; sub_10013D79+2Dr
dword_10031D1C	dd ?			; DATA XREF: sub_10009A2B+24r
					; sub_1000E52C+F0r ...
dword_10031D20	dd ?			; DATA XREF: sub_1000EE56+E8w
					; sub_1001402E+29r ...
dword_10031D24	dd ?			; DATA XREF: sub_1000EE56+102w
dword_10031D28	dd ?			; DATA XREF: sub_1000EE56+11Cw
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+D8r
dword_10031D2C	dd ?			; DATA XREF: sub_1000EE56+136w
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+158r
dword_10031D30	dd ?			; DATA XREF: sub_1000EE56+150w
					; sub_10013D79+52r ...
dword_10031D34	dd ?			; DATA XREF: sub_1000E4CB+33r
					; sub_1000E740+1Dr ...
dword_10031D38	dd ?			; DATA XREF: sub_1000EE56+184w
					; sub_100140A6+62r
dword_10031D3C	dd ?			; DATA XREF: sub_1000E52C+41r
					; sub_1000E52C+5Dr ...
dword_10031D40	dd ?			; DATA XREF: sub_1000EE56+1B8w
					; sub_10013DFD+12r
dword_10031D44	dd ?			; DATA XREF: sub_1000EE56+1D2w
dword_10031D48	dd ?			; DATA XREF: sub_1000EE56+1ECw
					; sub_10013DFD+35r
dword_10031D4C	dd ?			; DATA XREF: sub_1000EE56+206w
					; sub_10014324+11r
dword_10031D50	dd ?			; DATA XREF: sub_1000EE56+21Cw
dword_10031D54	dd ?			; DATA XREF: sub_1000E670+50r
					; sub_1000EE56+232w ...
dword_10031D58	dd ?			; DATA XREF: sub_1000E52C+18r
					; sub_1000EE56+248w ...
dword_10031D5C	dd ?			; DATA XREF: sub_1000EE56+25Ew
					; sub_10013EBD+16r
dword_10031D60	dd ?			; DATA XREF: sub_10005B09r
					; sub_10005B09+Do ...
; struct _RTL_CRITICAL_SECTION stru_10031D64
stru_10031D64	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10005B09+20o
		align 10h
; Exported entry  45. g_originals
		public g_originals
g_originals	dd ?			; DATA XREF: sub_1000DE85+111o
					; sub_1000DE85+17Ao ...
		dd 18h dup(?)
; Exported entry  50. g_shared_section
		public g_shared_section
g_shared_section dd ?			; DATA XREF: mozilla::SandboxBroker::SandboxBroker(void)+13r
					; sub_10013CCDr ...
; Exported entry  49. g_shared_policy_size
		public g_shared_policy_size
g_shared_policy_size dd	?		; DATA XREF: sub_10010168+31r
					; sub_10017B53+106o ...
dword_10031DEC	dd ?			; DATA XREF: sub_10010168+10r
					; sub_10010168+1Fr ...
dword_10031DF0	dd ?			; DATA XREF: sub_10013D79+7r
					; sub_10013D79+3Eo ...
; Exported entry  46. g_shared_IPC_size
		public g_shared_IPC_size
g_shared_IPC_size dd ?			; DATA XREF: sub_10013D79+5Dr
					; sub_10017B53+DDo ...
dword_10031DF8	dd ?			; DATA XREF: sub_1000E4CB+2Dr
					; sub_1000E740+17r ...
; HANDLE handle
handle		dd ?			; DATA XREF: sub_10013A85+19r
					; sub_10014818:loc_1001483Er ...
; HWINSTA hObj
hObj		dd ?			; DATA XREF: sub_10014818+3Br
					; sub_1001486D+24r ...
dword_10031E04	dd ?			; DATA XREF: sub_10014E0C+3Ar
					; sub_10014E0C+64w
; HANDLE hSourceHandle
hSourceHandle	dd ?			; DATA XREF: sub_10015AEE+39r
					; sub_10015AEE+4Do ...
		align 10h
; Exported entry  48. g_shared_delayed_mitigations
		public g_shared_delayed_mitigations
g_shared_delayed_mitigations dd	?	; DATA XREF: sub_1001028F+Cr
					; sub_10014EC9+CFw ...
dword_10031E14	dd ?			; DATA XREF: sub_1001028F+4r
					; sub_10014EC9+C8w ...
		dd 18h dup(?)
; struct _RTL_CRITICAL_SECTION CriticalSection
CriticalSection	_RTL_CRITICAL_SECTION <?> ; DATA XREF: sub_10001024+5o
					; sub_10005333+2o ...
		dd 24h dup(?)
		db 2 dup(?)
byte_10031F22	db ?			; DATA XREF: sub_100083E3+53Cr
byte_10031F23	db ?			; DATA XREF: sub_1000BC43+134r
					; sub_1000BC43+179r ...
dword_10031F24	dd ?			; DATA XREF: sub_1000469E+CFw
					; sub_1000469E:loc_10004774w ...
dword_10031F28	dd ?			; DATA XREF: sub_100062BD+31r
					; sub_100062BD+71w ...
dword_10031F2C	dd ?			; DATA XREF: sub_100062BD:loc_100062E3r
					; sub_100062BD+64w ...
dword_10031F30	dd ?			; DATA XREF: sub_100062BD+3Ar
					; sub_100062BD+78w ...
byte_10031F34	db ?			; DATA XREF: sub_1000C863+14Er
		align 4
dword_10031F38	dd ?			; DATA XREF: sub_10002E8B+9r
					; sub_10002E8B:loc_10002ED6w
dword_10031F3C	dd ?			; DATA XREF: sub_100047C7r
					; sub_100047C7+10o ...
dword_10031F40	dd ?			; DATA XREF: sub_10007384+16r
					; sub_10007384+83w
dword_10031F44	dd ?			; DATA XREF: sub_10007C21:loc_10007C47r
					; sub_10007C21:loc_10007C7Dw
dword_10031F48	dd ?			; DATA XREF: sub_10007CA5+40r
					; sub_10007CA5+A4w ...
dword_10031F4C	dd ?			; DATA XREF: sub_10007CA5+36r
					; sub_10007CA5+7Cw ...
dword_10031F50	dd ?			; DATA XREF: sub_10007B85:loc_10007BACr
					; sub_10007B85:loc_10007BE2w
dword_10031F54	dd ?			; DATA XREF: sub_1000C08E+Br
					; sub_1000C08E+20o ...
dword_10031F58	dd ?			; DATA XREF: sub_1000C7F7+10r
					; sub_1000C7F7+1Ao ...
dword_10031F5C	dd ?			; DATA XREF: sub_1000D2DF+14r
					; sub_1000D2DF+33o ...
dword_10031F60	dd ?			; DATA XREF: sub_1000D77Dr
					; sub_1000D77D+1Dw ...
dword_10031F64	dd ?			; DATA XREF: sub_1000E740:loc_1000E7B4r
					; sub_1000E740:loc_1000E7E3w
dword_10031F68	dd ?			; DATA XREF: sub_1000E740+3r
					; sub_1000E740+30w ...
dword_10031F6C	dd ?			; DATA XREF: sub_1000E4CB+1r
					; sub_1000E4CB+44w
dword_10031F70	dd ?			; DATA XREF: sub_1000E740:loc_1000E77Dr
					; sub_1000E740+67w ...
dword_10031F74	dd ?			; DATA XREF: sub_1001402E:loc_10014040r
					; sub_1001402E+3Cw ...
dword_10031F78	dd ?			; DATA XREF: sub_100171B6+19r
					; sub_100171B6+DAo ...
dword_10031F7C	dd ?			; DATA XREF: TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x)+39r
					; TargetNtMapViewOfSection(x,x,x,x,x,x,x,x,x,x,x):loc_10017586w ...
; HMODULE hModule
hModule		dd ?			; DATA XREF: sub_10018835+6r
					; sub_10018835:loc_1001886Fo ...
		dd 2 dup(?)
dword_10031F8C	dd ?			; DATA XREF: sub_100063D2r
					; sub_100063D2+26o ...
dword_10031F90	dd ?			; DATA XREF: sub_100083E3+6Bw
dword_10031F94	dd ?			; DATA XREF: sub_100083E3+54r
					; sub_100083E3+60w
dword_10031F98	dd ?			; DATA XREF: sub_10015438+8r
					; sub_10015438+2Ew
dword_10031F9C	dd ?			; DATA XREF: sub_10013CCD+1Fw
					; sub_10013CCD:loc_10013D02o
dword_10031FA0	dd ?			; DATA XREF: sub_10013CCD+29w
dword_10031FA4	dd ?			; DATA XREF: sub_10013CCD:loc_10013CD9r
					; sub_10013CCD+30w
dword_10031FA8	dd ?			; DATA XREF: sub_10018EC2+20o
					; sub_10018EC2+112o ...
dword_10031FAC	dd ?			; DATA XREF: sub_10018EC2:loc_10018F15r
					; sub_10018EC2:loc_10018FDEw ...
dword_10031FB0	dd ?			; DATA XREF: sub_10018EC2:loc_10019082r
					; sub_10018EC2+1C9o ...
; PVOID	dword_10031FB4
dword_10031FB4	dd ?			; DATA XREF: ___atonexitinit+27w
					; sub_10018DA5+49r ...
; PVOID	Ptr
Ptr		dd ?			; DATA XREF: ___atonexitinitr
					; ___atonexitinit+22w ...
		align 80h
_data		ends


		end DllEntryPoint
