?HandleData@nsUTF8Prober@@UAE?AW4nsProbingState@@PBDI@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['[ebp+var_4],', 'ecx']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_1B']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+arg_4]']
jnb ['short', 'loc_74']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '[ebp+var_8]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+4]']
call ['?NextState@nsCodingStateMachine@@QAE?AW4nsSMState@@D@Z']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_C],', '2']
jnz ['short', 'loc_4D']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '1']
jmp ['short', 'loc_74']
cmp ['[ebp+var_C],', '0']
jnz ['short', 'loc_72']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['?GetCurrentCharLen@nsCodingStateMachine@@QAEIXZ']
cmp ['eax,', '2']
jb ['short', 'loc_72']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+0Ch],', 'edx']
jmp ['short', 'loc_12']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+8],', '0']
jnz ['short', 'loc_A5']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+14h]']
call ['edx']
fstp ['[ebp+var_10]']
movss ['xmm0,', '[ebp+var_10]']
comiss ['xmm0,', 'ds:__real@3f733333']
jbe ['short', 'loc_A5']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+8]']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
?Reset@nsUTF8Prober@@UAEXXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['?Reset@nsCodingStateMachine@@QAEXXZ']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?GetConfidence@nsUTF8Prober@@UAEMXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['[ebp+var_C],', 'ecx']
movss ['xmm0,', 'ds:__real@3f7d70a4']
movss ['[ebp+var_8],', 'xmm0']
mov ['eax,', '[ebp+var_C]']
cmp ['dword', 'ptr', '[eax+0Ch],', '6']
jnb ['short', 'loc_159']
mov ['[ebp+var_4],', '0']
jmp ['short', 'loc_121']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '1']
mov ['[ebp+var_4],', 'ecx']
mov ['edx,', '[ebp+var_C]']
mov ['eax,', '[ebp+var_4]']
cmp ['eax,', '[edx+0Ch]']
jnb ['short', 'loc_140']
movss ['xmm0,', '[ebp+var_8]']
mulss ['xmm0,', '__real@3f000000']
movss ['[ebp+var_8],', 'xmm0']
jmp ['short', 'loc_118']
movss ['xmm0,', 'ds:__real@3f800000']
subss ['xmm0,', '[ebp+var_8]']
movss ['[ebp+var_10],', 'xmm0']
fld ['[ebp+var_10]']
jmp ['short', 'loc_15F']
jmp ['short', 'loc_15F']
fld ['ds:__real@3f7d70a4']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?GetCurrentCharLen@nsCodingStateMachine@@QAEIXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?NextState@nsCodingStateMachine@@QAE?AW4nsSMState@@D@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['edx,', '[eax+0Ch]']
movzx ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx]']
sar ['eax,', 'cl']
mov ['edx,', '[edx+10h]']
movzx ['esi,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
and ['esi,', '[ecx+4]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+8]']
shl ['esi,', 'cl']
mov ['edx,', '[edx+eax*4]']
mov ['ecx,', 'esi']
shr ['edx,', 'cl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
and ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_8],', 'edx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['short', 'loc_1EB']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx+2Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[eax+edx*4]']
mov ['[ecx+4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax]']
imul ['eax,', '[ecx+14h]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+18h]']
shr ['eax,', 'cl']
mov ['edx,', '[edx+28h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['esi,', '[ebp+var_4]']
mov ['esi,', '[esi]']
imul ['esi,', '[ecx+14h]']
add ['esi,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
and ['esi,', '[ecx+1Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+20h]']
shl ['esi,', 'cl']
mov ['edx,', '[edx+eax*4]']
mov ['ecx,', 'esi']
shr ['edx,', 'cl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
and ['edx,', '[ecx+24h]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+8],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx]']
pop ['esi']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['4']
endp
?Reset@nsCodingStateMachine@@QAEXXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
