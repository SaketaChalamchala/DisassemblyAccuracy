?HandleData@nsEUCJPProber@@UAE?AW4nsProbingState@@PBDI@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '14h']
push ['esi']
mov ['[ebp+var_4],', 'ecx']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_1C']
mov ['eax,', '[ebp+var_8]']
add ['eax,', '1']
mov ['[ebp+var_8],', 'eax']
mov ['ecx,', '[ebp+var_8]']
cmp ['ecx,', '[ebp+arg_4]']
jnb ['loc_F7']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '[ebp+var_8]']
movzx ['eax,', 'byte', 'ptr', '[edx]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+4]']
call ['?NextState@nsCodingStateMachine@@QAE?AW4nsSMState@@D@Z']
mov ['[ebp+var_10],', 'eax']
cmp ['[ebp+var_10],', '2']
jnz ['short', 'loc_55']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '1']
jmp ['loc_F7']
cmp ['[ebp+var_10],', '0']
jnz ['loc_F2']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['?GetCurrentCharLen@nsCodingStateMachine@@QAEIXZ']
mov ['[ebp+var_C],', 'eax']
cmp ['[ebp+var_8],', '0']
jnz ['short', 'loc_BE']
mov ['ecx,', '1']
imul ['edx,', 'ecx,', '0']
mov ['eax,', '1']
shl ['eax,', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['esi,', '[ebp+arg_0]']
mov ['dl,', '[esi+edx]']
mov ['[ecx+eax+5Ch],', 'dl']
mov ['eax,', '[ebp+var_C]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '5Ch']
push ['ecx']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
call ['?HandleOneChar@JapaneseContextAnalysis@@QAEXPBDI@Z']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_4]']
add ['eax,', '5Ch']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '3Ch']
call ['?HandleOneChar@CharDistributionAnalysis@@QAEXPBDI@Z']
jmp ['short', 'loc_F2']
mov ['ecx,', '[ebp+var_C]']
push ['ecx']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[ebp+arg_0]']
lea ['ecx,', '[eax+edx-1]']
push ['ecx']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
call ['?HandleOneChar@JapaneseContextAnalysis@@QAEXPBDI@Z']
mov ['edx,', '[ebp+var_C]']
push ['edx']
mov ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+arg_0]']
lea ['edx,', '[ecx+eax-1]']
push ['edx']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '3Ch']
call ['?HandleOneChar@CharDistributionAnalysis@@QAEXPBDI@Z']
jmp ['loc_13']
mov ['eax,', '1']
imul ['ecx,', 'eax,', '0']
mov ['edx,', '[ebp+arg_0]']
add ['edx,', '[ebp+arg_4]']
mov ['eax,', '[ebp+var_4]']
mov ['dl,', '[edx-1]']
mov ['[eax+ecx+5Ch],', 'dl']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+8],', '0']
jnz ['short', 'loc_152']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
call ['?GotEnoughData@JapaneseContextAnalysis@@QAE_NXZ']
movzx ['ecx,', 'al']
test ['ecx,', 'ecx']
jz ['short', 'loc_152']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax+14h]']
call ['edx']
fstp ['[ebp+var_14]']
movss ['xmm0,', '[ebp+var_14]']
comiss ['xmm0,', '__real@3f733333']
jbe ['short', 'loc_152']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx+8]']
pop ['esi']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
?Reset@nsEUCJPProber@@UAEXXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+4]']
call ['?Reset@nsCodingStateMachine@@QAEXXZ']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+8],', '0']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'byte', 'ptr', '[edx+5Eh]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
call ['?Reset@JapaneseContextAnalysis@@QAEX_N@Z']
mov ['ecx,', '[ebp+var_4]']
movzx ['edx,', 'byte', 'ptr', '[ecx+5Eh]']
push ['edx']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '3Ch']
call ['?Reset@CharDistributionAnalysis@@QAEX_N@Z']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?GetConfidence@nsEUCJPProber@@UAEMXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '10h']
mov ['[ebp+var_4],', 'ecx']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '0Ch']
call ['?GetConfidence@JapaneseContextAnalysis@@QAEMXZ']
fstp ['[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
add ['ecx,', '3Ch']
call ['?GetConfidence@CharDistributionAnalysis@@QAEMXZ']
fstp ['[ebp+var_C]']
movss ['xmm0,', '[ebp+var_8]']
comiss ['xmm0,', '[ebp+var_C]']
jbe ['short', 'loc_1EC']
movss ['xmm0,', '[ebp+var_8]']
movss ['[ebp+var_10],', 'xmm0']
jmp ['short', 'loc_1F6']
movss ['xmm0,', '[ebp+var_C]']
movss ['[ebp+var_10],', 'xmm0']
fld ['[ebp+var_10]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?GetCurrentCharLen@nsCodingStateMachine@@QAEIXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax+4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?GotEnoughData@JapaneseContextAnalysis@@QAE_NXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_8],', 'ecx']
mov ['eax,', '[ebp+var_8]']
cmp ['dword', 'ptr', '[eax+1Ch],', '64h']
jbe ['short', 'loc_22F']
mov ['[ebp+var_4],', '1']
jmp ['short', 'loc_236']
mov ['[ebp+var_4],', '0']
mov ['al,', 'byte', 'ptr', '[ebp+var_4]']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
?HandleOneChar@CharDistributionAnalysis@@QAEXPBDI@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_4],', 'ecx']
cmp ['[ebp+arg_4],', '2']
jnz ['short', 'loc_264']
mov ['eax,', '[ebp+arg_0]']
push ['eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx]']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
call ['eax']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_26B']
mov ['[ebp+var_C],', '0FFFFFFFFh']
mov ['ecx,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'ecx']
cmp ['[ebp+var_8],', '0']
jl ['short', 'loc_2B5']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+0Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+0Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[ebp+var_8]']
cmp ['eax,', '[edx+18h]']
jnb ['short', 'loc_2B5']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+14h]']
mov ['eax,', '[ebp+var_8]']
movsx ['ecx,', 'word', 'ptr', '[edx+eax*2]']
cmp ['ecx,', '200h']
jge ['short', 'loc_2B5']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+8]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+8],', 'eax']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
?HandleOneChar@JapaneseContextAnalysis@@QAEXPBDI@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '0Ch']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[eax+1Ch],', '3E8h']
jbe ['short', 'loc_2D8']
mov ['ecx,', '[ebp+var_4]']
mov ['byte', 'ptr', '[ecx+2Ch],', '1']
mov ['edx,', '[ebp+var_4]']
movzx ['eax,', 'byte', 'ptr', '[edx+2Ch]']
test ['eax,', 'eax']
jz ['short', 'loc_2E8']
jmp ['loc_36C']
cmp ['[ebp+arg_4],', '2']
jnz ['short', 'loc_303']
mov ['ecx,', '[ebp+arg_0]']
push ['ecx']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[eax]']
call ['edx']
mov ['[ebp+var_C],', 'eax']
jmp ['short', 'loc_30A']
mov ['[ebp+var_C],', '0FFFFFFFFh']
mov ['eax,', '[ebp+var_C]']
mov ['[ebp+var_8],', 'eax']
cmp ['[ebp+var_8],', '0FFFFFFFFh']
jz ['short', 'loc_363']
mov ['ecx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[ecx+24h],', '0FFFFFFFFh']
jz ['short', 'loc_363']
mov ['edx,', '[ebp+var_4]']
mov ['eax,', '[edx+1Ch]']
add ['eax,', '1']
mov ['ecx,', '[ebp+var_4]']
mov ['[ecx+1Ch],', 'eax']
mov ['edx,', '[ebp+var_4]']
imul ['eax,', '[edx+24h],', '53h']
mov ['ecx,', '[ebp+var_8]']
movzx ['edx,', 'byte', 'ptr', 'ds:?jp2CharContext@@3QAY0FD@$$CBEA[eax+ecx]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+edx*4+4]']
add ['ecx,', '1']
mov ['edx,', '[ebp+var_4]']
imul ['eax,', '[edx+24h],', '53h']
mov ['edx,', '[ebp+var_8]']
movzx ['eax,', 'byte', 'ptr', 'ds:?jp2CharContext@@3QAY0FD@$$CBEA[eax+edx]']
mov ['edx,', '[ebp+var_4]']
mov ['[edx+eax*4+4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[ebp+var_8]']
mov ['[eax+24h],', 'ecx']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['8']
endp
?NextState@nsCodingStateMachine@@QAE?AW4nsSMState@@D@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
push ['esi']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['edx,', '[eax+0Ch]']
movzx ['eax,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx]']
sar ['eax,', 'cl']
mov ['edx,', '[edx+10h]']
movzx ['esi,', '[ebp+arg_0]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
and ['esi,', '[ecx+4]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+8]']
shl ['esi,', 'cl']
mov ['edx,', '[edx+eax*4]']
mov ['ecx,', 'esi']
shr ['edx,', 'cl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
and ['edx,', '[ecx+0Ch]']
mov ['[ebp+var_8],', 'edx']
mov ['edx,', '[ebp+var_4]']
cmp ['dword', 'ptr', '[edx],', '0']
jnz ['short', 'loc_3E7']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax+8],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[edx+2Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_8]']
mov ['eax,', '[eax+edx*4]']
mov ['[ecx+4],', 'eax']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+0Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
mov ['eax,', '[ebp+var_4]']
mov ['eax,', '[eax]']
imul ['eax,', '[ecx+14h]']
add ['eax,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+18h]']
shr ['eax,', 'cl']
mov ['edx,', '[edx+28h]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['esi,', '[ebp+var_4]']
mov ['esi,', '[esi]']
imul ['esi,', '[ecx+14h]']
add ['esi,', '[ebp+var_8]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
and ['esi,', '[ecx+1Ch]']
mov ['ecx,', '[ebp+var_4]']
mov ['ecx,', '[ecx+0Ch]']
mov ['ecx,', '[ecx+20h]']
shl ['esi,', 'cl']
mov ['edx,', '[edx+eax*4]']
mov ['ecx,', 'esi']
shr ['edx,', 'cl']
mov ['eax,', '[ebp+var_4]']
mov ['ecx,', '[eax+0Ch]']
and ['edx,', '[ecx+24h]']
mov ['eax,', '[ebp+var_4]']
mov ['[eax],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ecx+8]']
add ['edx,', '1']
mov ['eax,', '[ebp+var_4]']
mov ['[eax+8],', 'edx']
mov ['ecx,', '[ebp+var_4]']
mov ['eax,', '[ecx]']
pop ['esi']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['4']
endp
?Reset@CharDistributionAnalysis@@QAEX_N@Z proc near
push ['ebp']
mov ['ebp,', 'esp']
sub ['esp,', '8']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['byte', 'ptr', '[eax+4],', '0']
mov ['ecx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[ecx+0Ch],', '0']
mov ['edx,', '[ebp+var_4]']
mov ['dword', 'ptr', '[edx+8],', '0']
movzx ['eax,', '[ebp+arg_0]']
test ['eax,', 'eax']
jz ['short', 'loc_499']
mov ['[ebp+var_8],', '0']
jmp ['short', 'loc_4A0']
mov ['[ebp+var_8],', '4']
mov ['ecx,', '[ebp+var_4]']
mov ['edx,', '[ebp+var_8]']
mov ['[ecx+10h],', 'edx']
mov ['esp,', 'ebp']
pop ['ebp']
retn ['4']
endp
?Reset@nsCodingStateMachine@@QAEXXZ proc near
push ['ebp']
mov ['ebp,', 'esp']
push ['ecx']
mov ['[ebp+var_4],', 'ecx']
mov ['eax,', '[ebp+var_4]']
mov ['dword', 'ptr', '[eax],', '0']
mov ['esp,', 'ebp']
pop ['ebp']
retn
endp
